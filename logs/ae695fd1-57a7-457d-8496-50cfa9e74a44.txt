====================================================================================================
import os
import sys
with open(sys.argv[0]) as f:
    code = f.read() # read the code of this file ASAP, for logging
import uuid
import glob
import time
from dataclasses import dataclass

import numpy as np
import torch
from torch import nn
import torch.nn.functional as F
import torch.distributed as dist
import torch._inductor.config as config
from torch.nn.parallel import DistributedDataParallel as DDP
# Use of FlexAttention contributed by @KoszarskyB
from torch.nn.attention.flex_attention import flex_attention, create_block_mask, BlockMask, _score_mod_signature
from torch._inductor.lowering import make_pointwise, register_lowering
# Some internal torch.compile details
from torch._inductor.virtualized import ops
from functools import partial
flex_attention = torch.compile(flex_attention, dynamic=False)
create_block_mask = torch.compile(create_block_mask, dynamic=False)

# -----------------------------------------------------------------------------
# Muon optimizer

def zeropower_via_svd(G, steps=None):
    U, S, V = G.svd()
    return U @ V.T

@torch.compile
def zeropower_via_newtonschulz5(G, steps=10, eps=1e-7):
    """
    Newton-Schulz iteration to compute the zeroth power / orthogonalization of G. We opt to use a
    quintic iteration whose coefficients are selected to maximize the slope at zero. For the purpose
    of minimizing steps, it turns out to be empirically effective to keep increasing the slope at
    zero even beyond the point where the iteration no longer converges all the way to one everywhere
    on the interval. This iteration therefore does not produce UV^T but rather something like US'V^T
    where S' is diagonal with S_{ii}' ~ Uniform(0.5, 1.5), which turns out not to hurt model
    performance at all relative to UV^T, where USV^T = G is the SVD.
    """
    assert len(G.shape) == 2
    a, b, c = (3.4445, -4.7750,  2.0315)
    X = G.bfloat16()
    X /= (X.norm() + eps) # ensure top singular value <= 1
    if G.size(0) > G.size(1):
        X = X.T
    for _ in range(steps):
        A = X @ X.T
        B = b * A + c * A @ A # adapted from suggestion by @jxbz, @leloykun, and @YouJiacheng
        X = a * X + B @ X
    if G.size(0) > G.size(1):
        X = X.T
    return X

zeropower_backends = dict(svd=zeropower_via_svd, newtonschulz5=zeropower_via_newtonschulz5)

class Muon(torch.optim.Optimizer):
    """
    Muon - MomentUm Orthogonalized by Newton-schulz

    Muon internally runs standard SGD-momentum, and then performs an orthogonalization post-
    processing step, in which each 2D parameter's update is replaced with the nearest orthogonal
    matrix. To efficiently orthogonalize each update, we use a Newton-Schulz iteration, which has
    the advantage that it can be stably run in bfloat16 on the GPU.

    Some warnings:
    - This optimizer assumes that all parameters passed in are 2D.
    - It should not be used for the embedding layer, the final fully connected layer, or any {0,1}-D
    parameters; those should all be optimized by a standard method (e.g., AdamW).
    - To use it with 4D convolutional filters, it works well to just flatten their last 3 dimensions.
    - We believe it is unlikely to work well for training with small batch size.
    - We believe it may not work well for finetuning pretrained models, but we haven't tested this.
    - We have not yet tried this optimizer for training scenarios larger than NanoGPT (124M).

    Arguments:
        lr: The learning rate used by the internal SGD.
        momentum: The momentum used by the internal SGD.
        nesterov: Whether to use Nesterov-style momentum in the internal SGD. (recommended)
        backend: The chosen backend for the orthogonalization step. (recommended: 'newtonschulz5')
        backend_steps: The number of iteration steps to use in the backend, if it is iterative.
    """
    def __init__(self, params, lr=0.02, momentum=0.95, nesterov=True,
                 backend='newtonschulz5', backend_steps=5):
        defaults = dict(lr=lr, momentum=momentum, nesterov=nesterov, backend=backend, backend_steps=backend_steps)
        super().__init__(params, defaults)

    def step(self):

        for group in self.param_groups:

            lr = group['lr']
            momentum = group['momentum']
            zeropower_backend = zeropower_backends[group['backend']]

            # generate weight updates in distributed fashion
            total_params = sum(p.numel() for p in group['params'])
            updates_flat = torch.zeros(total_params, device='cuda', dtype=torch.bfloat16)
            curr_idx = 0
            for i, p in enumerate(group['params']):
                # luckily this will perfectly distribute a transformer with multiple of 4 layers to 8 GPUs
                if i % int(os.environ['WORLD_SIZE']) == int(os.environ['RANK']):
                    g = p.grad
                    assert g is not None
                    state = self.state[p]
                    if 'momentum_buffer' not in state:
                        state['momentum_buffer'] = torch.zeros_like(g)
                    buf = state['momentum_buffer']
                    buf.mul_(momentum).add_(g)
                    if group['nesterov']:
                        g = g.add(buf, alpha=momentum)
                    g = zeropower_backend(g, steps=group['backend_steps'])
                    g *= max(1, g.size(0)/g.size(1))**0.5
                    updates_flat[curr_idx:curr_idx+p.numel()] = g.flatten()
                curr_idx += p.numel()

            # sync updates across devices. we are not memory-constrained so can do this simple deserialization
            dist.all_reduce(updates_flat, op=dist.ReduceOp.SUM)

            # deserialize and apply updates
            curr_idx = 0
            for p in group['params']:
                g = updates_flat[curr_idx:curr_idx+p.numel()].view_as(p.data).type_as(p.data)
                p.data.add_(g, alpha=-lr)
                curr_idx += p.numel()

# -----------------------------------------------------------------------------
# Attention Tanh softcapping

@torch.library.custom_op("approx::tanh", mutates_args=())
def _tanh_approx(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

@_tanh_approx.register_fake
def _(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

def _tanh_approx_lowering(inp):
    fn = partial(ops.inline_asm_elementwise, asm="tanh.approx.f32 $0, $1;")
    return make_pointwise(fn)(inp)

register_lowering(torch.ops.approx.tanh)(_tanh_approx_lowering)

class _TanhApprox(torch.autograd.Function):
    @staticmethod
    def forward(x):
        return torch.ops.approx.tanh(x)

    @staticmethod
    def setup_context(ctx, inputs, output):
        (x,) = inputs
        result = output
        ctx.save_for_backward(result)

    @staticmethod
    def backward(ctx, grad_output):
        (result,) = ctx.saved_tensors
        return grad_output * (1 - result * result)

    @staticmethod
    def vmap(info, in_dims, x):
        return torch.tanh(x), 0

_tanh_approx = _TanhApprox.apply

def generate_tanh_softcap(soft_cap: int, approx: bool=True) -> _score_mod_signature:
    tanh = _tanh_approx if approx else torch.tanh

    def tanh_softcap(score, b, h, q_idx, kv_idx):
        return soft_cap * tanh(score / soft_cap)

    prefix = "tanh_softcap_approx" if approx else "tanh_softcap"
    tanh_softcap.__name__ = f"{prefix}_{soft_cap}"

    return tanh_softcap

# -----------------------------------------------------------------------------
# PyTorch nn.Module definitions for the GPT-2 model

class Rotary(torch.nn.Module):

    def __init__(self, dim, base=10000):
        super().__init__()
        self.dim = dim
        self.base = base
        self.inv_freq = None
        self.seq_len_cached = None
        self.cos_cached = None
        self.sin_cached = None

    def forward(self, x):
        seq_len = x.shape[1]
        if seq_len != self.seq_len_cached:
            self.inv_freq = 1.0 / (self.base ** (torch.arange(0, self.dim, 2, device=x.device).float() / self.dim))
            self.seq_len_cached = seq_len
            t = torch.arange(seq_len, device=x.device).type_as(self.inv_freq)
            freqs = torch.outer(t, self.inv_freq)
            self.cos_cached = freqs.cos().bfloat16()
            self.sin_cached = freqs.sin().bfloat16()
        return self.cos_cached[None, :, None, :], self.sin_cached[None, :, None, :]

def apply_rotary_emb(x, cos, sin):
    assert x.ndim == 4 # multihead attention
    d = x.shape[3]//2
    x1 = x[..., :d]
    x2 = x[..., d:]
    y1 = x1 * cos + x2 * sin
    y2 = x1 * (-sin) + x2 * cos
    return torch.cat([y1, y2], 3).type_as(x)

class CastedLinear(nn.Linear):
    def forward(self, x):
        return F.linear(x, self.weight.to(x.dtype))

class CausalSelfAttention(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.n_head = config.n_head
        self.n_embd = config.n_embd
        self.head_dim = self.n_embd // self.n_head
        assert self.n_embd % self.n_head == 0
        self.c_q = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_k = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_v = CastedLinear(self.n_embd, self.n_embd, bias=False)
        # output projection
        self.c_proj = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977
        self.rotary = Rotary(self.head_dim)
        self.lamb = nn.Parameter(torch.tensor(0.5)) # @Grad62304977

    def forward(self, x, v1, block_mask: BlockMask, score_mod: _score_mod_signature):
        B, T, C = x.size() # batch size, sequence length, embedding dimensionality (n_embd)
        q = self.c_q(x).view(B, T, self.n_head, self.head_dim)
        k = self.c_k(x).view(B, T, self.n_head, self.head_dim)
        v = self.c_v(x).view(B, T, self.n_head, self.head_dim)
        if v1 is None:
            v1 = v # This happens if we are in the first block. v needs to be accessed by subsequent blocks
        v = (1 - self.lamb) * v + self.lamb * v1.view_as(v) # @Grad62304977
        cos, sin = self.rotary(q)
        q, k = F.rms_norm(q, (q.size(-1),)), F.rms_norm(k, (k.size(-1),)) # QK norm suggested by @Grad62304977
        q, k = apply_rotary_emb(q, cos, sin), apply_rotary_emb(k, cos, sin)
        y = flex_attention(q.transpose(1, 2), k.transpose(1, 2), v.transpose(1, 2), score_mod=score_mod, block_mask=block_mask)
        y = y.transpose(1, 2).contiguous().view_as(x) # re-assemble all head outputs side by side
        y = self.c_proj(y)
        return y, v1

class MLP(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.c_fc    = CastedLinear(config.n_embd, 4 * config.n_embd, bias=False)
        self.c_proj  = CastedLinear(4 * config.n_embd, config.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977

    def forward(self, x):
        x = self.c_fc(x)
        x = F.relu(x).square() # https://arxiv.org/abs/2109.08668v2; ~1-2% better than GELU; suggested by @SKYLINEZ007 and @Grad62304977
        x = self.c_proj(x)
        return x

class Block(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.attn = CausalSelfAttention(config)
        self.mlp = MLP(config)
        self.lambdas = nn.Parameter(torch.tensor([1., 0.]))

    def forward(self, x, v1, x0, block_mask: BlockMask, score_mod: _score_mod_signature):
        x = self.lambdas[0] * x + self.lambdas[1] * x0
        x1, v1 = self.attn(F.rms_norm(x, (x.size(-1),)), v1, block_mask, score_mod)
        x = x + x1
        x = x + self.mlp(F.rms_norm(x, (x.size(-1),)))
        return x, v1

# -----------------------------------------------------------------------------
# The main GPT-2 model

@dataclass
class GPTConfig:
    vocab_size : int = 50304
    n_layer : int = 12
    n_head : int = 6 # head dim 128 suggested by @Grad62304977
    n_embd : int = 768
    attention_soft_cap : int = 50
    lm_head_soft_cap : int = 30

class GPT(nn.Module):

    def __init__(self, config: GPTConfig):
        super().__init__()
        self.attention_soft_cap = config.attention_soft_cap
        self.lm_head_soft_cap = config.lm_head_soft_cap

        # U-net design by @brendanh0gan
        self.num_encoder_layers = config.n_layer // 2 # Half of the layers for encoder
        self.num_decoder_layers = config.n_layer - self.num_encoder_layers # Remaining for decoder
        # Add learnable skip connection weights for decoder layers
        self.skip_weights = nn.Parameter(torch.ones(self.num_decoder_layers))

        self.transformer = nn.ModuleDict(dict(
            wte = nn.Embedding(config.vocab_size, config.n_embd),
            h = nn.ModuleList([Block(config) for _ in range(config.n_layer)]),
        ))
        self.lm_head = CastedLinear(config.n_embd, config.vocab_size, bias=False)
        self.lm_head.weight.data.zero_() # @Grad62304977

    def forward(self, idx, target, attn_blocksize: int):

        docs = (idx == 50256).cumsum(0)
        def document_causal_mask(b, h, q_idx, kv_idx):
            causal_mask = q_idx >= kv_idx
            document_mask = docs[q_idx] == docs[kv_idx]
            window_mask = q_idx - kv_idx < attn_blocksize
            return causal_mask & document_mask & window_mask

        softcap_mod = generate_tanh_softcap(self.attention_soft_cap, approx=True)  # @leloykun

        S = len(idx)
        block_mask = create_block_mask(document_causal_mask, None, None, S, S, device="cuda", _compile=True)

        # forward the GPT model itself
        x = self.transformer.wte(idx[None]) # token embeddings of shape (b, t, n_embd)
        x = F.rms_norm(x, (x.size(-1),)) # @Grad62304977
        x0 = x
        v1 = None

        # Store outputs for U-Net skip connections
        skip_connections = []
        # Encoder pass - process only the first half of the blocks
        for i in range(self.num_encoder_layers):
            x, v1 = self.transformer.h[i](x, v1, x0, block_mask, softcap_mod)
            skip_connections.append(x)
        # Decoder pass - process the remaining blocks with weighted skip connections
        for i in range(self.num_decoder_layers):
            x = x + self.skip_weights[i] * skip_connections.pop()
            x, v1 = self.transformer.h[self.num_encoder_layers + i](x, v1, x0, block_mask, softcap_mod)

        x = F.rms_norm(x, (x.size(-1),))
        logits = self.lm_head(x)
        logits = self.lm_head_soft_cap * torch.tanh(logits / self.lm_head_soft_cap) # @Grad62304977
        logits = logits.float()
        loss = F.cross_entropy(logits.view(-1, logits.size(-1)), target.view(-1))
        return loss

# -----------------------------------------------------------------------------
# Our own simple Distributed Data Loader

def _peek_data_shard(filename):
    # only reads the header, returns header data
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
    if header[0] != 20240520:
        print("ERROR: magic number mismatch in the data .bin file!")
        print("---> HINT: Are you passing in a correct file with --input_bin?")
        print("---> HINT: Dataset encoding changed recently, re-run data prepro or refer again to README")
        print("---> HINT: For example re-run: `python dev/data/tinyshakespeare.py`, then re-try")
        exit(1)
    assert header[1] == 1, "unsupported version"
    ntok = header[2] # number of tokens (claimed)
    return ntok # for now just return the number of tokens

def _load_data_shard(filename):
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
        assert header[0] == 20240520, "magic number mismatch in the data .bin file"
        assert header[1] == 1, "unsupported version"
        ntok = header[2] # number of tokens (claimed)
        # the rest of it are tokens, stored as uint16
        tokens = np.frombuffer(f.read(), dtype=np.uint16)
    assert len(tokens) == ntok, "number of tokens read does not match header?"
    return tokens

class DistributedDataLoader:
    def __init__(self, filename_pattern, B, T, process_rank, num_processes):
        self.process_rank = process_rank
        self.num_processes = num_processes
        self.B = B
        self.T = T

        # glob files that match the pattern
        self.files = sorted(glob.glob(filename_pattern))
        assert len(self.files) > 0, f"did not find any files that match the pattern {filename_pattern}"

        # load and validate all data shards, count number of tokens in total
        ntok_total = 0
        for fname in self.files:
            shard_ntok = _peek_data_shard(fname)
            assert shard_ntok >= num_processes * B * T + 1
            ntok_total += int(shard_ntok)
        self.ntok_total = ntok_total

        self.reset()

    def reset(self):
        self.current_shard = -1
        self.advance()

    def advance(self): # advance to next data shard
        self.current_shard = (self.current_shard + 1) % len(self.files)
        self.current_position = self.process_rank * self.B * self.T
        self.tokens = _load_data_shard(self.files[self.current_shard])

    def next_batch(self):
        batch_size = self.B * self.T * self.num_processes
        buf = self.tokens[self.current_position:self.current_position+self.B*self.T+1]
        buf = torch.tensor(buf.astype(np.int32), dtype=torch.long)
        x = buf[:-1] # inputs
        y = buf[1:] # targets
        # advance current position and load next shard if necessary
        self.current_position += batch_size
        if self.current_position + batch_size >= len(self.tokens):
            self.advance()
        return x.cuda(), y.cuda()

# -----------------------------------------------------------------------------
# int main

@dataclass
class Hyperparameters:
    # data hyperparams
    input_bin : str = 'data/fineweb10B/fineweb_train_*.bin' # input .bin to train on
    input_val_bin : str = 'data/fineweb10B/fineweb_val_*.bin' # input .bin to eval validation loss on
    # optimization hyperparams
    batch_size : int = 8 # batch size, in sequences, across all devices
    device_batch_size : int = 1 # batch size, in sequences, per device
    sequence_length : int = 64*1024 # sequence length, in tokens
    num_iterations : int = 1750 # number of iterations to run
    warmup_iters : int = 0
    cooldown_iters : int = 640 # number of iterations of linear warmup/cooldown for triangular or trapezoidal schedule
    weight_decay : float = 0
    # evaluation and logging hyperparams
    val_loss_every : int = 125 # every how many steps to evaluate val loss? 0 for only at the end
    val_tokens : int = 10485760 # how many tokens of validation data? it's important to keep this fixed for consistent comparisons
    save_every : int = 0 # every how many steps to save the checkpoint? 0 for only at the end
args = Hyperparameters()

# set up DDP (distributed data parallel). torchrun sets this env variable
assert torch.cuda.is_available()
dist.init_process_group(backend='nccl')
ddp_rank = int(os.environ['RANK'])
ddp_local_rank = int(os.environ['LOCAL_RANK'])
ddp_world_size = int(os.environ['WORLD_SIZE'])
device = f'cuda:{ddp_local_rank}'
torch.cuda.set_device(device)
print(f"using device: {device}")
master_process = (ddp_rank == 0) # this process will do logging, checkpointing etc.

# begin logging
logfile = None
if master_process:
    run_id = str(uuid.uuid4())
    logdir = 'logs/%s/' % run_id
    os.makedirs(logdir, exist_ok=True)
    logfile = 'logs/%s.txt' % run_id
    # create the log file
    with open(logfile, "w") as f:
        # begin the log by printing this file (the Python code)
        f.write('='*100 + '\n')
        f.write(code)
        f.write('='*100 + '\n')
def print0(s, logonly=False):
    if master_process:
        with open(logfile, "a") as f:
            if not logonly:
                print(s)
            f.write(s+'\n')
# log information about the hardware/software environment this is running on
# and print the full `nvidia-smi` to file
print0(f"Running pytorch {torch.version.__version__} compiled for CUDA {torch.version.cuda}\nnvidia-smi:")
import subprocess
result = subprocess.run(['nvidia-smi'], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
print0(f'{result.stdout}', logonly=True)
print0('='*100, logonly=True)

# convenience variables
B, T = args.device_batch_size, args.sequence_length
# calculate the number of steps to take in the val loop.
assert args.val_tokens % (B * T * ddp_world_size) == 0
val_steps = args.val_tokens // (B * T * ddp_world_size)
# calculate the steps of gradient accumulation required to attain the desired global batch size.
assert args.batch_size % (B * ddp_world_size) == 0
train_accumulation_steps = args.batch_size // (B * ddp_world_size)

# load tokens
train_loader = DistributedDataLoader(args.input_bin, B, T, ddp_rank, ddp_world_size)
val_loader = DistributedDataLoader(args.input_val_bin, B, T, ddp_rank, ddp_world_size)
print0(f"Training DataLoader: total number of tokens: {train_loader.ntok_total} across {len(train_loader.files)} files")
print0(f"Validation DataLoader: total number of tokens: {val_loader.ntok_total} across {len(val_loader.files)} files")
print0('='*100, logonly=True)
x, y = train_loader.next_batch()

# there are only 50257 unique GPT-2 tokens; we extend to nearest multiple of 128 for efficiency. suggested to me by @Grad62304977.
# this originates from Karpathy's experiments.
num_vocab = 50304
model = GPT(GPTConfig(vocab_size=num_vocab, n_layer=12, n_head=6, n_embd=768))
model = model.cuda().bfloat16()
for m in model.modules():
    if isinstance(m, CastedLinear):
        m.float()
if hasattr(config, "coordinate_descent_tuning"):
    config.coordinate_descent_tuning = True # suggested by @Chillee
model = torch.compile(model)
# here we wrap model into DDP container
model = DDP(model, device_ids=[ddp_local_rank])
raw_model = model.module # always contains the "raw" unwrapped model

# CUDNN attention is ~4ms faster than Flash, but doesn't get selected by default in PyTorch 2.5.1
from torch.backends.cuda import enable_cudnn_sdp, enable_flash_sdp, enable_math_sdp, enable_mem_efficient_sdp
enable_cudnn_sdp(True)
enable_flash_sdp(False)
enable_mem_efficient_sdp(False)
enable_math_sdp(False)

# init the optimizer(s)
optimizer1 = torch.optim.Adam([raw_model.transformer.wte.weight], lr=0.6,   betas=(0.8, 0.95), fused=True)
optimizer2 = torch.optim.Adam([raw_model.lm_head.weight],         lr=0.008, betas=(0.8, 0.95), fused=True)
param_names = [name for name, _ in raw_model.named_parameters()]
params = list(raw_model.transformer.h.parameters())
qk_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and ("c_q" in n or "c_k" in n)]
matrix_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and "c_q" not in n and "c_k" not in n]
scalar_params = [p for p in params if p.ndim < 2] + [raw_model.skip_weights]
optimizer5 = Muon(qk_params, lr=0.08, momentum=0.95)
optimizer3 = Muon(matrix_params, lr=0.05, momentum=0.95)
optimizer4 = torch.optim.Adam(scalar_params, lr=0.04, betas=(0.8, 0.95), fused=True) # note that this learning rate is neither sensitive nor tuned
optimizers = [optimizer1, optimizer2, optimizer3, optimizer4, optimizer5]
# learning rate decay scheduler (linear warmup and cooldown)
def get_lr(it):
    assert it <= args.num_iterations
    # 1) linear warmup for warmup_iters steps
    if it < args.warmup_iters:
        return (it+1) / args.warmup_iters
    # 2) constant lr for a while
    elif it < args.num_iterations - args.cooldown_iters:
        return 1.0
    # 3) linear cooldown
    else:
        decay_ratio = (args.num_iterations - it) / args.cooldown_iters
        return decay_ratio
schedulers = [torch.optim.lr_scheduler.LambdaLR(opt, get_lr) for opt in optimizers]

# Start training loop
training_time_ms = 0
# start the clock
torch.cuda.synchronize()
t0 = time.time()
# begin training
for step in range(args.num_iterations + 1):
    last_step = (step == args.num_iterations)
    # Set the attention blocksize for the current step, in chunks of 64
    attn_blocksize = torch.tensor(64*((step/args.num_iterations * (1792 - 64) + 64)//64), dtype=torch.int, device='cuda')
    # This effectively ignores timing first 10 steps, which are slower for weird reasons.
    # Alternately, and slightly more correctly in terms of benchmarking, we could do 10
    # steps with dummy data first, and then re-initialize the model and reset the loader.
    if step == 10:
        training_time_ms = 0
        t0 = time.time()
    timed_steps = float('nan') if step <= 11 else (step - 10) + 1 # <= 11 to avoid bug in val

    # once in a while evaluate the validation dataset
    if (last_step or (args.val_loss_every > 0 and step % args.val_loss_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # run validation batches
        model.eval()
        val_loader.reset()
        val_loss = 0.0
        for _ in range(val_steps):
            with torch.no_grad():
                x_val, y_val = val_loader.next_batch()
                val_loss += model(x_val, y_val, attn_blocksize=attn_blocksize)
        dist.all_reduce(val_loss, op=dist.ReduceOp.AVG)
        val_loss /= val_steps
        # log val loss to console and to logfile
        print0(f'step:{step}/{args.num_iterations} val_loss:{val_loss:.4f} train_time:{training_time_ms:.0f}ms step_avg:{training_time_ms/(timed_steps-1):.2f}ms')
        if master_process:
            print("============== Weight norms: ==============")
            with open(logfile, "a") as f:
                f.write("============== Weight norms: ==============\n")
                for name, p in model.named_parameters():
                    if p.ndim != 2:
                        continue
                    if "transformer.wte" in name:
                        l1_to_l2_norm = torch.norm(p.data.float(), p=2, dim=1).mean().item()
                    frobenius_norm = torch.linalg.norm(p.data.float(), ord='fro').item()
                    spectral_norm = torch.linalg.matrix_norm(p.data.float(), ord=2).item()
                    nuclear_norm = torch.linalg.matrix_norm(p.data.float(), ord="nuc").item()
                    if "transformer.wte" in name:
                        print(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                    else:
                        print(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                f.write("===========================================\n")
            print("===========================================")
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    if master_process and (last_step or (args.save_every > 0 and step % args.save_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # save the state of the training process
        log = dict(step=step, code=code, model=raw_model.state_dict(), optimizers=[opt.state_dict() for opt in optimizers])
        torch.save(log, 'logs/%s/state_step%06d.pt' % (run_id, step))
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    # bit confusing: we want to make sure to eval on 0th iteration
    # but also after the very last iteration. so we loop for step <= num_iterations
    # instead of just < num_iterations (one extra due to <=), only to do
    # the validation/sampling one last time, and then we break right here as we're done.
    if last_step:
        break

    # --------------- TRAINING SECTION BEGIN -----------------
    model.train()
    for i in range(1, train_accumulation_steps+1):
        # forward pass
        loss = model(x, y, attn_blocksize=attn_blocksize)
        train_loss = loss.detach()
        # advance the dataset for the next batch
        x, y = train_loader.next_batch()
        # backward pass
        if i < train_accumulation_steps:
            with model.no_sync(): # there's no need to sync gradients every accumulation step
                loss.backward()
        else:
            loss.backward() # just sync on the last step
    for p in model.parameters():
        p.grad /= train_accumulation_steps
    # momentum warmup for Muon
    frac = min(step/300, 1)
    optimizer3.param_groups[0]['momentum'] = (1 - frac) * 0.85 + frac * 0.95
    # step the optimizers and schedulers
    for opt, sched in zip(optimizers, schedulers):
        opt.step()
        sched.step()
    # null the gradients
    model.zero_grad(set_to_none=True)
    # --------------- TRAINING SECTION END -------------------
    # everything that follows now is just diagnostics, prints, logging, etc.

    #dist.all_reduce(train_loss, op=dist.ReduceOp.AVG) # all-reducing the training loss would be more correct in terms of logging, but slower
    approx_time = training_time_ms + 1000 * (time.time() - t0)
    print0(f"step:{step+1}/{args.num_iterations} train_loss:{train_loss.item():.4f} train_time:{approx_time:.0f}ms step_avg:{approx_time/timed_steps:.2f}ms")

if master_process:
    print(f"peak memory consumption: {torch.cuda.max_memory_allocated() // 1024 // 1024} MiB")

# -------------------------------------------------------------------------
# clean up nice
dist.destroy_process_group()
====================================================================================================
Running pytorch 2.6.0.dev20241125+cu124 compiled for CUDA 12.4
nvidia-smi:
Mon Nov 25 15:32:02 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.12             Driver Version: 535.104.12   CUDA Version: 12.4     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  | 00000000:07:00.0 Off |                    0 |
| N/A   42C    P0              69W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  | 00000000:0A:00.0 Off |                    0 |
| N/A   33C    P0              64W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  | 00000000:45:00.0 Off |                    0 |
| N/A   33C    P0              71W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  | 00000000:4B:00.0 Off |                    0 |
| N/A   43C    P0              70W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   4  NVIDIA A100-SXM4-80GB          On  | 00000000:84:00.0 Off |                    0 |
| N/A   44C    P0              76W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   5  NVIDIA A100-SXM4-80GB          On  | 00000000:8A:00.0 Off |                    0 |
| N/A   33C    P0              70W / 400W |     24MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   6  NVIDIA A100-SXM4-80GB          On  | 00000000:C0:00.0 Off |                    0 |
| N/A   32C    P0              71W / 400W |     24MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   7  NVIDIA A100-SXM4-80GB          On  | 00000000:C3:00.0 Off |                    0 |
| N/A   43C    P0              76W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
+---------------------------------------------------------------------------------------+

====================================================================================================
Training DataLoader: total number of tokens: 1100000000 across 11 files
Validation DataLoader: total number of tokens: 100000000 across 1 files
====================================================================================================
step:0/1750 val_loss:10.8258 train_time:0ms step_avg:nanms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 27.69962 | frobenius_norm = 6214.62988 | spectral_norm = 251.83499 | nuclear_norm = 171918.71875
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 15.99684 | spectral_norm = 1.15138 | nuclear_norm = 376.34735
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 16.00217 | spectral_norm = 1.14047 | nuclear_norm = 376.67645
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 16.00022 | spectral_norm = 1.14051 | nuclear_norm = 376.38110
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 32.00511 | spectral_norm = 1.72787 | nuclear_norm = 858.41272
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 16.00091 | spectral_norm = 1.14164 | nuclear_norm = 376.37280
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 16.00644 | spectral_norm = 1.14710 | nuclear_norm = 376.44977
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 15.99548 | spectral_norm = 1.15322 | nuclear_norm = 376.22235
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 31.99744 | spectral_norm = 1.72883 | nuclear_norm = 858.10400
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 15.98121 | spectral_norm = 1.13724 | nuclear_norm = 376.19556
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 15.98137 | spectral_norm = 1.14751 | nuclear_norm = 375.90234
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 15.99081 | spectral_norm = 1.15546 | nuclear_norm = 376.19247
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 32.00968 | spectral_norm = 1.72681 | nuclear_norm = 858.45288
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 15.99760 | spectral_norm = 1.15117 | nuclear_norm = 376.44125
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 16.02013 | spectral_norm = 1.14207 | nuclear_norm = 376.99750
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 16.00011 | spectral_norm = 1.14874 | nuclear_norm = 376.48444
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 31.99636 | spectral_norm = 1.72437 | nuclear_norm = 858.18896
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 15.98820 | spectral_norm = 1.14863 | nuclear_norm = 375.96622
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 15.99477 | spectral_norm = 1.14359 | nuclear_norm = 376.20273
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 15.99791 | spectral_norm = 1.14829 | nuclear_norm = 376.46973
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 31.99036 | spectral_norm = 1.72013 | nuclear_norm = 857.94684
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 16.00348 | spectral_norm = 1.14771 | nuclear_norm = 376.55023
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 16.00484 | spectral_norm = 1.13748 | nuclear_norm = 376.49945
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 15.99207 | spectral_norm = 1.15768 | nuclear_norm = 376.14282
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 31.99717 | spectral_norm = 1.72203 | nuclear_norm = 858.17285
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 16.00937 | spectral_norm = 1.15115 | nuclear_norm = 376.79285
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 15.99685 | spectral_norm = 1.16022 | nuclear_norm = 376.23544
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 16.00315 | spectral_norm = 1.15385 | nuclear_norm = 376.67770
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 32.00400 | spectral_norm = 1.71805 | nuclear_norm = 858.37366
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 16.03267 | spectral_norm = 1.15169 | nuclear_norm = 377.19308
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 15.99312 | spectral_norm = 1.14866 | nuclear_norm = 376.46735
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 15.99067 | spectral_norm = 1.14988 | nuclear_norm = 376.11853
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 32.01305 | spectral_norm = 1.72901 | nuclear_norm = 858.68384
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 16.00737 | spectral_norm = 1.14378 | nuclear_norm = 376.60339
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 15.99730 | spectral_norm = 1.14218 | nuclear_norm = 376.35678
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 16.00533 | spectral_norm = 1.14463 | nuclear_norm = 376.77762
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 32.01336 | spectral_norm = 1.72439 | nuclear_norm = 858.57642
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 15.99768 | spectral_norm = 1.16295 | nuclear_norm = 376.40216
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 16.00034 | spectral_norm = 1.14459 | nuclear_norm = 376.41040
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 15.99455 | spectral_norm = 1.14907 | nuclear_norm = 376.23926
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 32.00082 | spectral_norm = 1.72648 | nuclear_norm = 858.37292
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 15.99477 | spectral_norm = 1.14132 | nuclear_norm = 376.20743
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 16.00466 | spectral_norm = 1.14281 | nuclear_norm = 376.57251
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 15.99940 | spectral_norm = 1.15092 | nuclear_norm = 376.23300
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 31.99441 | spectral_norm = 1.73010 | nuclear_norm = 858.16095
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 16.00988 | spectral_norm = 1.14451 | nuclear_norm = 376.56799
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 16.00222 | spectral_norm = 1.14686 | nuclear_norm = 376.28772
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 15.98551 | spectral_norm = 1.15203 | nuclear_norm = 376.22076
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 32.00565 | spectral_norm = 1.72303 | nuclear_norm = 858.34930
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
===========================================
step:1/1750 train_loss:10.8258 train_time:32113ms step_avg:nanms
step:2/1750 train_loss:10.0654 train_time:32910ms step_avg:nanms
step:3/1750 train_loss:8.3368 train_time:33251ms step_avg:nanms
step:4/1750 train_loss:7.5958 train_time:33582ms step_avg:nanms
step:5/1750 train_loss:7.4794 train_time:33914ms step_avg:nanms
step:6/1750 train_loss:6.9688 train_time:34245ms step_avg:nanms
step:7/1750 train_loss:7.1884 train_time:34575ms step_avg:nanms
step:8/1750 train_loss:6.7392 train_time:34905ms step_avg:nanms
step:9/1750 train_loss:6.6271 train_time:35236ms step_avg:nanms
step:10/1750 train_loss:6.5758 train_time:35566ms step_avg:nanms
step:11/1750 train_loss:6.5261 train_time:248ms step_avg:nanms
step:12/1750 train_loss:6.3613 train_time:581ms step_avg:nanms
step:13/1750 train_loss:6.2209 train_time:912ms step_avg:304.00ms
step:14/1750 train_loss:6.1783 train_time:1243ms step_avg:310.80ms
step:15/1750 train_loss:6.1312 train_time:1574ms step_avg:314.83ms
step:16/1750 train_loss:6.1125 train_time:1905ms step_avg:317.56ms
step:17/1750 train_loss:6.2088 train_time:2237ms step_avg:319.53ms
step:18/1750 train_loss:5.9994 train_time:2568ms step_avg:321.02ms
step:19/1750 train_loss:6.0352 train_time:2900ms step_avg:322.27ms
step:20/1750 train_loss:5.7226 train_time:3231ms step_avg:323.12ms
step:21/1750 train_loss:5.9901 train_time:3563ms step_avg:323.95ms
step:22/1750 train_loss:6.1905 train_time:3895ms step_avg:324.57ms
step:23/1750 train_loss:5.8924 train_time:4225ms step_avg:324.97ms
step:24/1750 train_loss:6.0624 train_time:4557ms step_avg:325.52ms
step:25/1750 train_loss:5.7563 train_time:4888ms step_avg:325.87ms
step:26/1750 train_loss:5.6620 train_time:5219ms step_avg:326.19ms
step:27/1750 train_loss:5.8230 train_time:5550ms step_avg:326.47ms
step:28/1750 train_loss:5.4616 train_time:5881ms step_avg:326.73ms
step:29/1750 train_loss:5.7286 train_time:6213ms step_avg:326.98ms
step:30/1750 train_loss:5.5235 train_time:6544ms step_avg:327.21ms
step:31/1750 train_loss:5.4937 train_time:6876ms step_avg:327.42ms
step:32/1750 train_loss:5.3289 train_time:7206ms step_avg:327.56ms
step:33/1750 train_loss:5.6284 train_time:7538ms step_avg:327.74ms
step:34/1750 train_loss:5.5441 train_time:7870ms step_avg:327.91ms
step:35/1750 train_loss:5.6633 train_time:8201ms step_avg:328.05ms
step:36/1750 train_loss:5.5766 train_time:8533ms step_avg:328.18ms
step:37/1750 train_loss:5.4937 train_time:8865ms step_avg:328.32ms
step:38/1750 train_loss:5.3451 train_time:9196ms step_avg:328.43ms
step:39/1750 train_loss:5.3707 train_time:9528ms step_avg:328.56ms
step:40/1750 train_loss:5.2876 train_time:9860ms step_avg:328.66ms
step:41/1750 train_loss:5.2708 train_time:10192ms step_avg:328.77ms
step:42/1750 train_loss:5.2043 train_time:10523ms step_avg:328.84ms
step:43/1750 train_loss:5.2895 train_time:10857ms step_avg:328.99ms
step:44/1750 train_loss:5.2662 train_time:11189ms step_avg:329.09ms
step:45/1750 train_loss:5.4268 train_time:11521ms step_avg:329.17ms
step:46/1750 train_loss:5.2178 train_time:11852ms step_avg:329.23ms
step:47/1750 train_loss:5.1461 train_time:12184ms step_avg:329.28ms
step:48/1750 train_loss:5.2728 train_time:12515ms step_avg:329.35ms
step:49/1750 train_loss:5.1861 train_time:12849ms step_avg:329.46ms
step:50/1750 train_loss:5.2849 train_time:13181ms step_avg:329.52ms
step:51/1750 train_loss:5.1907 train_time:13513ms step_avg:329.59ms
step:52/1750 train_loss:5.0767 train_time:13845ms step_avg:329.64ms
step:53/1750 train_loss:5.2066 train_time:14178ms step_avg:329.72ms
step:54/1750 train_loss:5.0456 train_time:14511ms step_avg:329.79ms
step:55/1750 train_loss:5.4428 train_time:14843ms step_avg:329.85ms
step:56/1750 train_loss:5.0652 train_time:15176ms step_avg:329.92ms
step:57/1750 train_loss:4.9305 train_time:15509ms step_avg:329.98ms
step:58/1750 train_loss:5.0344 train_time:15842ms step_avg:330.04ms
step:59/1750 train_loss:5.0475 train_time:16175ms step_avg:330.10ms
step:60/1750 train_loss:5.1685 train_time:16509ms step_avg:330.17ms
step:61/1750 train_loss:4.8915 train_time:16842ms step_avg:330.24ms
step:62/1750 train_loss:5.0203 train_time:17175ms step_avg:330.29ms
step:63/1750 train_loss:5.0094 train_time:17508ms step_avg:330.34ms
step:64/1750 train_loss:5.0503 train_time:17841ms step_avg:330.39ms
step:65/1750 train_loss:4.8491 train_time:18174ms step_avg:330.44ms
step:66/1750 train_loss:5.0038 train_time:18507ms step_avg:330.49ms
step:67/1750 train_loss:4.8665 train_time:18841ms step_avg:330.54ms
step:68/1750 train_loss:5.1067 train_time:19174ms step_avg:330.58ms
step:69/1750 train_loss:4.7778 train_time:19507ms step_avg:330.62ms
step:70/1750 train_loss:4.8628 train_time:19840ms step_avg:330.66ms
step:71/1750 train_loss:4.9886 train_time:20173ms step_avg:330.71ms
step:72/1750 train_loss:4.8981 train_time:20507ms step_avg:330.75ms
step:73/1750 train_loss:4.7824 train_time:20840ms step_avg:330.79ms
step:74/1750 train_loss:4.9366 train_time:21173ms step_avg:330.83ms
step:75/1750 train_loss:4.8916 train_time:21506ms step_avg:330.87ms
step:76/1750 train_loss:4.8235 train_time:21840ms step_avg:330.91ms
step:77/1750 train_loss:4.9276 train_time:22173ms step_avg:330.95ms
step:78/1750 train_loss:5.1267 train_time:22507ms step_avg:330.98ms
step:79/1750 train_loss:4.8341 train_time:22840ms step_avg:331.02ms
step:80/1750 train_loss:4.8560 train_time:23174ms step_avg:331.06ms
step:81/1750 train_loss:4.6589 train_time:23509ms step_avg:331.11ms
step:82/1750 train_loss:4.8235 train_time:23843ms step_avg:331.15ms
step:83/1750 train_loss:4.7987 train_time:24177ms step_avg:331.19ms
step:84/1750 train_loss:4.7774 train_time:24510ms step_avg:331.21ms
step:85/1750 train_loss:4.6152 train_time:24843ms step_avg:331.25ms
step:86/1750 train_loss:4.8286 train_time:25177ms step_avg:331.27ms
step:87/1750 train_loss:4.7578 train_time:25510ms step_avg:331.30ms
step:88/1750 train_loss:4.7254 train_time:25844ms step_avg:331.33ms
step:89/1750 train_loss:4.6907 train_time:26179ms step_avg:331.38ms
step:90/1750 train_loss:4.6500 train_time:26512ms step_avg:331.41ms
step:91/1750 train_loss:4.6231 train_time:26846ms step_avg:331.43ms
step:92/1750 train_loss:4.7793 train_time:27180ms step_avg:331.46ms
step:93/1750 train_loss:4.5969 train_time:27514ms step_avg:331.49ms
step:94/1750 train_loss:4.6307 train_time:27848ms step_avg:331.52ms
step:95/1750 train_loss:4.6689 train_time:28182ms step_avg:331.55ms
step:96/1750 train_loss:4.5800 train_time:28516ms step_avg:331.58ms
step:97/1750 train_loss:4.6315 train_time:28849ms step_avg:331.60ms
step:98/1750 train_loss:4.5734 train_time:29184ms step_avg:331.63ms
step:99/1750 train_loss:4.6610 train_time:29517ms step_avg:331.65ms
step:100/1750 train_loss:4.6614 train_time:29853ms step_avg:331.70ms
step:101/1750 train_loss:4.5191 train_time:30184ms step_avg:331.70ms
step:102/1750 train_loss:4.7105 train_time:30518ms step_avg:331.72ms
step:103/1750 train_loss:4.5823 train_time:30852ms step_avg:331.74ms
step:104/1750 train_loss:4.5309 train_time:31186ms step_avg:331.77ms
step:105/1750 train_loss:4.5525 train_time:31520ms step_avg:331.79ms
step:106/1750 train_loss:4.5713 train_time:31854ms step_avg:331.81ms
step:107/1750 train_loss:4.5031 train_time:32188ms step_avg:331.83ms
step:108/1750 train_loss:4.3534 train_time:32522ms step_avg:331.86ms
step:109/1750 train_loss:4.4852 train_time:32858ms step_avg:331.90ms
step:110/1750 train_loss:4.4576 train_time:33194ms step_avg:331.94ms
step:111/1750 train_loss:4.4140 train_time:33529ms step_avg:331.97ms
step:112/1750 train_loss:4.5801 train_time:33863ms step_avg:331.99ms
step:113/1750 train_loss:4.4839 train_time:34198ms step_avg:332.02ms
step:114/1750 train_loss:4.3482 train_time:34531ms step_avg:332.03ms
step:115/1750 train_loss:4.4887 train_time:34866ms step_avg:332.05ms
step:116/1750 train_loss:4.4662 train_time:35199ms step_avg:332.07ms
step:117/1750 train_loss:4.3763 train_time:35535ms step_avg:332.10ms
step:118/1750 train_loss:4.6001 train_time:35870ms step_avg:332.13ms
step:119/1750 train_loss:4.4580 train_time:36206ms step_avg:332.17ms
step:120/1750 train_loss:4.3718 train_time:36541ms step_avg:332.19ms
step:121/1750 train_loss:4.3123 train_time:36876ms step_avg:332.22ms
step:122/1750 train_loss:4.4468 train_time:37211ms step_avg:332.24ms
step:123/1750 train_loss:4.3023 train_time:37544ms step_avg:332.25ms
step:124/1750 train_loss:4.6164 train_time:37878ms step_avg:332.26ms
step:125/1750 train_loss:4.4743 train_time:38213ms step_avg:332.29ms
step:125/1750 val_loss:4.4146 train_time:38298ms step_avg:333.02ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 118.73223 | frobenius_norm = 27069.20312 | spectral_norm = 6704.55029 | nuclear_norm = 658170.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 38.42076 | spectral_norm = 3.20232 | nuclear_norm = 904.77917
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 37.06633 | spectral_norm = 4.43844 | nuclear_norm = 870.43976
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 83.56300 | spectral_norm = 5.65459 | nuclear_norm = 1954.30811
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 85.32595 | spectral_norm = 8.78298 | nuclear_norm = 2033.41565
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 77.77906 | spectral_norm = 5.42259 | nuclear_norm = 2066.70264
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 41.67988 | spectral_norm = 2.80027 | nuclear_norm = 1107.57886
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 36.21929 | spectral_norm = 3.12358 | nuclear_norm = 850.89868
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 35.37440 | spectral_norm = 4.02962 | nuclear_norm = 829.88525
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 89.23926 | spectral_norm = 7.12973 | nuclear_norm = 2065.19043
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 94.96775 | spectral_norm = 8.78619 | nuclear_norm = 2265.98145
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 84.05667 | spectral_norm = 5.42956 | nuclear_norm = 2235.35889
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 43.58636 | spectral_norm = 2.98892 | nuclear_norm = 1157.39722
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 35.76600 | spectral_norm = 3.01730 | nuclear_norm = 840.27332
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 35.75943 | spectral_norm = 3.43319 | nuclear_norm = 839.06171
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 92.14509 | spectral_norm = 8.17606 | nuclear_norm = 2093.07080
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 93.83839 | spectral_norm = 8.60396 | nuclear_norm = 2233.22363
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 85.95725 | spectral_norm = 5.38102 | nuclear_norm = 2285.31250
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 44.07399 | spectral_norm = 3.09333 | nuclear_norm = 1168.95728
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 35.24796 | spectral_norm = 2.93734 | nuclear_norm = 820.25146
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 35.47636 | spectral_norm = 3.09874 | nuclear_norm = 827.82800
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 90.91761 | spectral_norm = 8.71882 | nuclear_norm = 2015.90710
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 91.36931 | spectral_norm = 8.28683 | nuclear_norm = 2165.54980
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 85.20701 | spectral_norm = 5.40736 | nuclear_norm = 2261.35474
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 43.80357 | spectral_norm = 3.05729 | nuclear_norm = 1158.73474
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 34.40686 | spectral_norm = 2.97009 | nuclear_norm = 804.42761
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 34.89904 | spectral_norm = 3.27121 | nuclear_norm = 816.06299
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 80.48477 | spectral_norm = 7.70040 | nuclear_norm = 1789.79565
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 87.38313 | spectral_norm = 8.12380 | nuclear_norm = 2057.12231
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 85.15990 | spectral_norm = 5.30091 | nuclear_norm = 2258.06909
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 43.40768 | spectral_norm = 3.10764 | nuclear_norm = 1146.74500
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 34.83481 | spectral_norm = 2.77591 | nuclear_norm = 812.19550
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 35.14711 | spectral_norm = 2.87365 | nuclear_norm = 821.17511
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 93.17527 | spectral_norm = 9.01982 | nuclear_norm = 2006.06494
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 84.32291 | spectral_norm = 7.86346 | nuclear_norm = 1996.85339
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 82.80472 | spectral_norm = 5.21294 | nuclear_norm = 2193.36670
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 42.62074 | spectral_norm = 3.05567 | nuclear_norm = 1124.38428
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 33.39778 | spectral_norm = 2.91647 | nuclear_norm = 775.33655
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 34.22337 | spectral_norm = 2.87361 | nuclear_norm = 796.33270
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 78.45699 | spectral_norm = 7.38021 | nuclear_norm = 1733.43091
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 87.28277 | spectral_norm = 7.98119 | nuclear_norm = 2072.68994
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 82.35281 | spectral_norm = 5.41632 | nuclear_norm = 2175.68604
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 42.01078 | spectral_norm = 2.98092 | nuclear_norm = 1105.00085
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 33.45804 | spectral_norm = 2.90730 | nuclear_norm = 776.01709
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 34.23789 | spectral_norm = 2.93911 | nuclear_norm = 795.48914
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 77.80975 | spectral_norm = 7.02804 | nuclear_norm = 1718.39465
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 87.65372 | spectral_norm = 8.18111 | nuclear_norm = 2079.60205
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 82.20291 | spectral_norm = 5.66797 | nuclear_norm = 2171.05322
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 41.74077 | spectral_norm = 2.88981 | nuclear_norm = 1097.56250
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 33.79813 | spectral_norm = 2.82556 | nuclear_norm = 779.00830
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 34.60206 | spectral_norm = 2.78401 | nuclear_norm = 798.31592
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 101.87885 | spectral_norm = 8.43415 | nuclear_norm = 2324.99854
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 92.42301 | spectral_norm = 8.19681 | nuclear_norm = 2219.69434
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 81.64568 | spectral_norm = 5.65505 | nuclear_norm = 2155.29639
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 41.26862 | spectral_norm = 2.86106 | nuclear_norm = 1084.35645
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 33.41004 | spectral_norm = 2.88259 | nuclear_norm = 770.89380
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 33.91882 | spectral_norm = 2.83890 | nuclear_norm = 783.84216
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 97.98087 | spectral_norm = 8.27010 | nuclear_norm = 2230.04956
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 93.30437 | spectral_norm = 8.05695 | nuclear_norm = 2238.93726
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 83.17957 | spectral_norm = 5.82778 | nuclear_norm = 2199.69092
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 41.61252 | spectral_norm = 2.84931 | nuclear_norm = 1093.90198
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 34.14686 | spectral_norm = 2.95587 | nuclear_norm = 787.84961
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 34.66203 | spectral_norm = 2.97571 | nuclear_norm = 799.42505
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 81.60533 | spectral_norm = 7.13466 | nuclear_norm = 1824.42212
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 93.18456 | spectral_norm = 7.51307 | nuclear_norm = 2237.59180
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 83.35013 | spectral_norm = 6.11791 | nuclear_norm = 2205.01123
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 41.31785 | spectral_norm = 2.86334 | nuclear_norm = 1085.01746
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 34.12300 | spectral_norm = 2.98447 | nuclear_norm = 788.95862
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 34.54839 | spectral_norm = 3.00341 | nuclear_norm = 797.62622
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 81.07458 | spectral_norm = 7.21346 | nuclear_norm = 1819.69873
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 90.35140 | spectral_norm = 6.96129 | nuclear_norm = 2170.16724
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 81.79890 | spectral_norm = 6.35517 | nuclear_norm = 2162.13037
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 40.08798 | spectral_norm = 2.84760 | nuclear_norm = 1047.85339
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 386.02689 | spectral_norm = 132.24226 | nuclear_norm = 9212.54297
===========================================
step:126/1750 train_loss:4.4253 train_time:38546ms step_avg:332.29ms
step:127/1750 train_loss:4.4560 train_time:38877ms step_avg:332.28ms
step:128/1750 train_loss:4.3920 train_time:39212ms step_avg:332.31ms
step:129/1750 train_loss:4.7127 train_time:39543ms step_avg:332.30ms
step:130/1750 train_loss:4.3975 train_time:39876ms step_avg:332.30ms
step:131/1750 train_loss:4.4332 train_time:40213ms step_avg:332.34ms
step:132/1750 train_loss:4.3522 train_time:40556ms step_avg:332.43ms
step:133/1750 train_loss:4.4584 train_time:40899ms step_avg:332.51ms
step:134/1750 train_loss:4.2733 train_time:41243ms step_avg:332.61ms
step:135/1750 train_loss:4.4413 train_time:41587ms step_avg:332.70ms
step:136/1750 train_loss:4.2092 train_time:41931ms step_avg:332.79ms
step:137/1750 train_loss:4.3747 train_time:42275ms step_avg:332.87ms
step:138/1750 train_loss:4.2937 train_time:42619ms step_avg:332.96ms
step:139/1750 train_loss:4.3846 train_time:42965ms step_avg:333.06ms
step:140/1750 train_loss:4.4772 train_time:43311ms step_avg:333.16ms
step:141/1750 train_loss:4.3018 train_time:43655ms step_avg:333.25ms
step:142/1750 train_loss:4.2901 train_time:44000ms step_avg:333.34ms
step:143/1750 train_loss:4.2474 train_time:44345ms step_avg:333.42ms
step:144/1750 train_loss:4.3363 train_time:44689ms step_avg:333.50ms
step:145/1750 train_loss:4.3008 train_time:45033ms step_avg:333.57ms
step:146/1750 train_loss:4.1764 train_time:45378ms step_avg:333.66ms
step:147/1750 train_loss:4.3189 train_time:45722ms step_avg:333.74ms
step:148/1750 train_loss:4.3500 train_time:46067ms step_avg:333.82ms
step:149/1750 train_loss:4.2912 train_time:46414ms step_avg:333.92ms
step:150/1750 train_loss:4.4386 train_time:46759ms step_avg:334.00ms
step:151/1750 train_loss:4.2645 train_time:47103ms step_avg:334.06ms
step:152/1750 train_loss:4.2601 train_time:47447ms step_avg:334.13ms
step:153/1750 train_loss:4.3592 train_time:47793ms step_avg:334.22ms
step:154/1750 train_loss:4.3547 train_time:48137ms step_avg:334.28ms
step:155/1750 train_loss:4.2571 train_time:48480ms step_avg:334.35ms
step:156/1750 train_loss:4.3349 train_time:48824ms step_avg:334.41ms
step:157/1750 train_loss:4.3969 train_time:49169ms step_avg:334.48ms
step:158/1750 train_loss:4.2494 train_time:49514ms step_avg:334.56ms
step:159/1750 train_loss:4.3222 train_time:49858ms step_avg:334.62ms
step:160/1750 train_loss:4.1155 train_time:50202ms step_avg:334.68ms
step:161/1750 train_loss:4.3436 train_time:50545ms step_avg:334.74ms
step:162/1750 train_loss:4.3634 train_time:50890ms step_avg:334.80ms
step:163/1750 train_loss:4.3386 train_time:51235ms step_avg:334.87ms
step:164/1750 train_loss:4.1842 train_time:51578ms step_avg:334.92ms
step:165/1750 train_loss:4.2755 train_time:51923ms step_avg:334.99ms
step:166/1750 train_loss:4.3415 train_time:52267ms step_avg:335.04ms
step:167/1750 train_loss:4.1960 train_time:52612ms step_avg:335.11ms
step:168/1750 train_loss:4.2873 train_time:52956ms step_avg:335.16ms
step:169/1750 train_loss:4.1538 train_time:53300ms step_avg:335.22ms
step:170/1750 train_loss:4.0210 train_time:53645ms step_avg:335.28ms
step:171/1750 train_loss:4.1976 train_time:53990ms step_avg:335.34ms
step:172/1750 train_loss:4.2190 train_time:54336ms step_avg:335.41ms
step:173/1750 train_loss:4.2765 train_time:54681ms step_avg:335.47ms
step:174/1750 train_loss:4.4264 train_time:55026ms step_avg:335.53ms
step:175/1750 train_loss:4.2482 train_time:55370ms step_avg:335.58ms
step:176/1750 train_loss:4.1061 train_time:55714ms step_avg:335.63ms
step:177/1750 train_loss:4.0769 train_time:56059ms step_avg:335.68ms
step:178/1750 train_loss:4.1964 train_time:56403ms step_avg:335.73ms
step:179/1750 train_loss:4.1353 train_time:56749ms step_avg:335.79ms
step:180/1750 train_loss:4.1190 train_time:57094ms step_avg:335.85ms
step:181/1750 train_loss:4.3036 train_time:57438ms step_avg:335.89ms
step:182/1750 train_loss:4.1685 train_time:57782ms step_avg:335.94ms
step:183/1750 train_loss:4.1294 train_time:58127ms step_avg:335.99ms
step:184/1750 train_loss:4.1314 train_time:58473ms step_avg:336.05ms
step:185/1750 train_loss:4.2122 train_time:58819ms step_avg:336.11ms
step:186/1750 train_loss:4.1840 train_time:59163ms step_avg:336.15ms
step:187/1750 train_loss:4.2435 train_time:59509ms step_avg:336.21ms
step:188/1750 train_loss:4.1794 train_time:59902ms step_avg:336.53ms
step:189/1750 train_loss:4.1270 train_time:60466ms step_avg:337.80ms
step:190/1750 train_loss:4.2193 train_time:60833ms step_avg:337.96ms
step:191/1750 train_loss:4.0976 train_time:61179ms step_avg:338.00ms
step:192/1750 train_loss:4.0508 train_time:61524ms step_avg:338.05ms
step:193/1750 train_loss:4.2561 train_time:61870ms step_avg:338.09ms
step:194/1750 train_loss:4.1814 train_time:62216ms step_avg:338.13ms
step:195/1750 train_loss:4.3631 train_time:62563ms step_avg:338.18ms
step:196/1750 train_loss:4.1811 train_time:62907ms step_avg:338.21ms
step:197/1750 train_loss:4.0483 train_time:63250ms step_avg:338.24ms
step:198/1750 train_loss:4.1851 train_time:63594ms step_avg:338.26ms
step:199/1750 train_loss:4.0297 train_time:63936ms step_avg:338.29ms
step:200/1750 train_loss:4.1196 train_time:64282ms step_avg:338.33ms
step:201/1750 train_loss:4.0079 train_time:64624ms step_avg:338.35ms
step:202/1750 train_loss:4.2543 train_time:64969ms step_avg:338.38ms
step:203/1750 train_loss:4.0685 train_time:65311ms step_avg:338.40ms
step:204/1750 train_loss:4.1969 train_time:65654ms step_avg:338.42ms
step:205/1750 train_loss:4.2400 train_time:65996ms step_avg:338.44ms
step:206/1750 train_loss:3.9441 train_time:66339ms step_avg:338.47ms
step:207/1750 train_loss:4.0832 train_time:66681ms step_avg:338.48ms
step:208/1750 train_loss:4.0954 train_time:67023ms step_avg:338.50ms
step:209/1750 train_loss:4.2435 train_time:67367ms step_avg:338.53ms
step:210/1750 train_loss:4.1746 train_time:67709ms step_avg:338.55ms
step:211/1750 train_loss:4.0573 train_time:68052ms step_avg:338.57ms
step:212/1750 train_loss:4.1036 train_time:68397ms step_avg:338.60ms
step:213/1750 train_loss:4.0394 train_time:68741ms step_avg:338.63ms
step:214/1750 train_loss:4.1173 train_time:69085ms step_avg:338.65ms
step:215/1750 train_loss:3.9412 train_time:69429ms step_avg:338.68ms
step:216/1750 train_loss:3.9992 train_time:69773ms step_avg:338.70ms
step:217/1750 train_loss:4.0037 train_time:70115ms step_avg:338.72ms
step:218/1750 train_loss:4.0776 train_time:70458ms step_avg:338.74ms
step:219/1750 train_loss:4.0707 train_time:70802ms step_avg:338.76ms
step:220/1750 train_loss:4.0714 train_time:71145ms step_avg:338.79ms
step:221/1750 train_loss:4.0915 train_time:71489ms step_avg:338.81ms
step:222/1750 train_loss:3.9858 train_time:71833ms step_avg:338.83ms
step:223/1750 train_loss:3.9781 train_time:72177ms step_avg:338.86ms
step:224/1750 train_loss:4.2952 train_time:72520ms step_avg:338.88ms
step:225/1750 train_loss:3.9101 train_time:72863ms step_avg:338.90ms
step:226/1750 train_loss:3.9948 train_time:73206ms step_avg:338.92ms
step:227/1750 train_loss:3.9849 train_time:73549ms step_avg:338.94ms
step:228/1750 train_loss:4.1392 train_time:73893ms step_avg:338.96ms
step:229/1750 train_loss:3.9210 train_time:74237ms step_avg:338.98ms
step:230/1750 train_loss:4.0492 train_time:74580ms step_avg:339.00ms
step:231/1750 train_loss:3.8958 train_time:74925ms step_avg:339.03ms
step:232/1750 train_loss:3.9745 train_time:75268ms step_avg:339.04ms
step:233/1750 train_loss:4.0904 train_time:75611ms step_avg:339.06ms
step:234/1750 train_loss:4.0426 train_time:75954ms step_avg:339.08ms
step:235/1750 train_loss:3.9097 train_time:76298ms step_avg:339.10ms
step:236/1750 train_loss:4.0908 train_time:76642ms step_avg:339.12ms
step:237/1750 train_loss:4.0792 train_time:76986ms step_avg:339.15ms
step:238/1750 train_loss:3.9422 train_time:77331ms step_avg:339.17ms
step:239/1750 train_loss:4.0777 train_time:77673ms step_avg:339.19ms
step:240/1750 train_loss:4.1202 train_time:78018ms step_avg:339.21ms
step:241/1750 train_loss:3.9727 train_time:78361ms step_avg:339.23ms
step:242/1750 train_loss:4.1505 train_time:78705ms step_avg:339.24ms
step:243/1750 train_loss:4.0145 train_time:79047ms step_avg:339.26ms
step:244/1750 train_loss:4.0849 train_time:79390ms step_avg:339.28ms
step:245/1750 train_loss:4.1462 train_time:79734ms step_avg:339.29ms
step:246/1750 train_loss:4.0601 train_time:80079ms step_avg:339.32ms
step:247/1750 train_loss:4.0004 train_time:80422ms step_avg:339.33ms
step:248/1750 train_loss:4.1133 train_time:80765ms step_avg:339.35ms
step:249/1750 train_loss:3.9275 train_time:81108ms step_avg:339.37ms
step:250/1750 train_loss:3.9832 train_time:81452ms step_avg:339.38ms
step:250/1750 val_loss:4.0146 train_time:81538ms step_avg:339.74ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 157.40401 | frobenius_norm = 35962.32812 | spectral_norm = 7489.67139 | nuclear_norm = 885463.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 59.39082 | spectral_norm = 6.54165 | nuclear_norm = 1390.48901
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 57.67781 | spectral_norm = 8.35595 | nuclear_norm = 1344.83496
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 126.36480 | spectral_norm = 8.25843 | nuclear_norm = 3002.14429
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 119.16223 | spectral_norm = 10.72555 | nuclear_norm = 2806.69067
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 122.00712 | spectral_norm = 9.06313 | nuclear_norm = 3240.16309
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 63.55173 | spectral_norm = 4.64502 | nuclear_norm = 1685.76831
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 57.56316 | spectral_norm = 5.10063 | nuclear_norm = 1348.11694
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 56.40429 | spectral_norm = 6.65452 | nuclear_norm = 1320.60535
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 137.34943 | spectral_norm = 11.12530 | nuclear_norm = 3193.12817
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 138.00661 | spectral_norm = 11.20236 | nuclear_norm = 3258.49268
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 131.64395 | spectral_norm = 8.99007 | nuclear_norm = 3498.10986
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 66.24693 | spectral_norm = 5.25049 | nuclear_norm = 1753.51819
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 57.24738 | spectral_norm = 4.98291 | nuclear_norm = 1342.85022
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 56.65179 | spectral_norm = 5.36518 | nuclear_norm = 1326.42334
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 140.82669 | spectral_norm = 11.61572 | nuclear_norm = 3247.15918
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 140.06689 | spectral_norm = 10.97194 | nuclear_norm = 3301.61816
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 133.70045 | spectral_norm = 8.69785 | nuclear_norm = 3556.38184
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 66.94719 | spectral_norm = 5.26129 | nuclear_norm = 1770.33154
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 56.69807 | spectral_norm = 4.89041 | nuclear_norm = 1311.52356
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 56.47623 | spectral_norm = 4.78446 | nuclear_norm = 1308.19580
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 136.65349 | spectral_norm = 11.86736 | nuclear_norm = 3111.05176
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 139.85982 | spectral_norm = 10.89818 | nuclear_norm = 3300.76611
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 134.75430 | spectral_norm = 9.23379 | nuclear_norm = 3581.29004
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 66.79705 | spectral_norm = 5.13777 | nuclear_norm = 1762.52100
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 56.01070 | spectral_norm = 5.07663 | nuclear_norm = 1308.69739
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 55.51698 | spectral_norm = 5.32936 | nuclear_norm = 1298.17090
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 132.44786 | spectral_norm = 10.84892 | nuclear_norm = 3020.97266
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 137.30444 | spectral_norm = 10.44076 | nuclear_norm = 3216.62549
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 137.27776 | spectral_norm = 8.85506 | nuclear_norm = 3644.90137
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 67.46077 | spectral_norm = 5.31724 | nuclear_norm = 1779.65210
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 57.16781 | spectral_norm = 4.71933 | nuclear_norm = 1328.92285
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 57.29318 | spectral_norm = 4.62945 | nuclear_norm = 1333.78735
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 137.75726 | spectral_norm = 12.59104 | nuclear_norm = 3109.19385
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 132.09195 | spectral_norm = 9.99179 | nuclear_norm = 3119.81641
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 134.38197 | spectral_norm = 8.70852 | nuclear_norm = 3571.25098
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 66.51770 | spectral_norm = 5.38106 | nuclear_norm = 1755.41699
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 54.89688 | spectral_norm = 4.99478 | nuclear_norm = 1276.46509
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 54.98453 | spectral_norm = 4.80051 | nuclear_norm = 1279.96570
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 132.97853 | spectral_norm = 11.26124 | nuclear_norm = 3035.20410
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 137.96208 | spectral_norm = 10.38319 | nuclear_norm = 3260.03076
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 133.46123 | spectral_norm = 9.18584 | nuclear_norm = 3539.72974
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 66.06624 | spectral_norm = 5.28219 | nuclear_norm = 1740.03625
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 55.18559 | spectral_norm = 4.90252 | nuclear_norm = 1281.29248
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 55.54177 | spectral_norm = 4.83753 | nuclear_norm = 1292.07129
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 132.22237 | spectral_norm = 10.76578 | nuclear_norm = 3015.37695
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 136.94781 | spectral_norm = 10.19798 | nuclear_norm = 3225.77100
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 134.79269 | spectral_norm = 9.65124 | nuclear_norm = 3572.30249
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 66.06910 | spectral_norm = 5.14515 | nuclear_norm = 1741.99243
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 56.04449 | spectral_norm = 5.21494 | nuclear_norm = 1283.21240
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 56.59668 | spectral_norm = 4.62823 | nuclear_norm = 1293.62366
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 156.95390 | spectral_norm = 12.39571 | nuclear_norm = 3641.12915
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 149.00218 | spectral_norm = 10.13284 | nuclear_norm = 3558.06909
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 131.51714 | spectral_norm = 9.44353 | nuclear_norm = 3486.14062
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 65.09013 | spectral_norm = 5.13597 | nuclear_norm = 1717.54187
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 56.36186 | spectral_norm = 4.80226 | nuclear_norm = 1301.49084
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 55.99631 | spectral_norm = 4.79111 | nuclear_norm = 1293.66821
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 152.26924 | spectral_norm = 11.80682 | nuclear_norm = 3528.40381
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 145.29214 | spectral_norm = 10.05682 | nuclear_norm = 3456.04932
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 132.66103 | spectral_norm = 9.39461 | nuclear_norm = 3520.17847
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 65.92059 | spectral_norm = 5.30889 | nuclear_norm = 1741.45764
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 56.40351 | spectral_norm = 5.17331 | nuclear_norm = 1298.46533
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 56.50229 | spectral_norm = 5.08795 | nuclear_norm = 1298.49805
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 136.38239 | spectral_norm = 10.99083 | nuclear_norm = 3124.78320
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 147.34068 | spectral_norm = 10.01651 | nuclear_norm = 3506.21387
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 135.15686 | spectral_norm = 9.40967 | nuclear_norm = 3588.89795
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 66.77779 | spectral_norm = 5.37767 | nuclear_norm = 1763.97119
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 56.66407 | spectral_norm = 5.46175 | nuclear_norm = 1305.87537
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 56.45149 | spectral_norm = 5.19305 | nuclear_norm = 1297.48169
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 133.27222 | spectral_norm = 10.51179 | nuclear_norm = 3073.07422
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 145.77576 | spectral_norm = 9.87329 | nuclear_norm = 3464.17383
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 133.95235 | spectral_norm = 9.53395 | nuclear_norm = 3556.04883
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 65.68037 | spectral_norm = 5.48547 | nuclear_norm = 1727.78345
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 551.97076 | spectral_norm = 149.22475 | nuclear_norm = 13777.68555
===========================================
step:251/1750 train_loss:4.0807 train_time:81791ms step_avg:339.38ms
step:252/1750 train_loss:4.1812 train_time:82133ms step_avg:339.39ms
step:253/1750 train_loss:3.9384 train_time:82473ms step_avg:339.39ms
step:254/1750 train_loss:3.8819 train_time:82813ms step_avg:339.40ms
step:255/1750 train_loss:4.0762 train_time:83153ms step_avg:339.40ms
step:256/1750 train_loss:3.9804 train_time:83495ms step_avg:339.41ms
step:257/1750 train_loss:3.9836 train_time:83837ms step_avg:339.42ms
step:258/1750 train_loss:3.9827 train_time:84178ms step_avg:339.43ms
step:259/1750 train_loss:4.0271 train_time:84522ms step_avg:339.45ms
step:260/1750 train_loss:4.0607 train_time:84866ms step_avg:339.46ms
step:261/1750 train_loss:4.0240 train_time:85214ms step_avg:339.50ms
step:262/1750 train_loss:4.0026 train_time:85566ms step_avg:339.55ms
step:263/1750 train_loss:3.8954 train_time:85918ms step_avg:339.60ms
step:264/1750 train_loss:3.9835 train_time:86272ms step_avg:339.65ms
step:265/1750 train_loss:3.8676 train_time:86624ms step_avg:339.70ms
step:266/1750 train_loss:3.9220 train_time:86975ms step_avg:339.75ms
step:267/1750 train_loss:3.9314 train_time:87329ms step_avg:339.80ms
step:268/1750 train_loss:3.9579 train_time:87682ms step_avg:339.85ms
step:269/1750 train_loss:3.8510 train_time:88035ms step_avg:339.90ms
step:270/1750 train_loss:4.0911 train_time:88388ms step_avg:339.95ms
step:271/1750 train_loss:3.9674 train_time:88740ms step_avg:340.00ms
step:272/1750 train_loss:3.9257 train_time:89092ms step_avg:340.04ms
step:273/1750 train_loss:3.9472 train_time:89441ms step_avg:340.08ms
step:274/1750 train_loss:4.0357 train_time:89794ms step_avg:340.13ms
step:275/1750 train_loss:4.0513 train_time:90145ms step_avg:340.17ms
step:276/1750 train_loss:4.2111 train_time:90497ms step_avg:340.21ms
step:277/1750 train_loss:4.0367 train_time:90848ms step_avg:340.26ms
step:278/1750 train_loss:4.0891 train_time:91201ms step_avg:340.30ms
step:279/1750 train_loss:4.0011 train_time:91552ms step_avg:340.34ms
step:280/1750 train_loss:4.1865 train_time:91907ms step_avg:340.40ms
step:281/1750 train_loss:3.9696 train_time:92262ms step_avg:340.45ms
step:282/1750 train_loss:3.9380 train_time:92616ms step_avg:340.50ms
step:283/1750 train_loss:3.9145 train_time:92968ms step_avg:340.54ms
step:284/1750 train_loss:4.0447 train_time:93319ms step_avg:340.58ms
step:285/1750 train_loss:4.0667 train_time:93669ms step_avg:340.62ms
step:286/1750 train_loss:4.0918 train_time:94021ms step_avg:340.66ms
step:287/1750 train_loss:3.9104 train_time:94374ms step_avg:340.70ms
step:288/1750 train_loss:4.0148 train_time:94728ms step_avg:340.75ms
step:289/1750 train_loss:3.8830 train_time:95079ms step_avg:340.79ms
step:290/1750 train_loss:3.8575 train_time:95432ms step_avg:340.83ms
step:291/1750 train_loss:3.9107 train_time:95785ms step_avg:340.87ms
step:292/1750 train_loss:3.8613 train_time:96135ms step_avg:340.90ms
step:293/1750 train_loss:3.9031 train_time:96487ms step_avg:340.94ms
step:294/1750 train_loss:3.9405 train_time:96838ms step_avg:340.98ms
step:295/1750 train_loss:3.8327 train_time:97192ms step_avg:341.02ms
step:296/1750 train_loss:3.8613 train_time:97546ms step_avg:341.07ms
step:297/1750 train_loss:3.8724 train_time:97899ms step_avg:341.11ms
step:298/1750 train_loss:3.9792 train_time:98250ms step_avg:341.14ms
step:299/1750 train_loss:3.8209 train_time:98602ms step_avg:341.18ms
step:300/1750 train_loss:3.9629 train_time:98957ms step_avg:341.23ms
step:301/1750 train_loss:3.9694 train_time:99306ms step_avg:341.26ms
step:302/1750 train_loss:3.9359 train_time:99657ms step_avg:341.29ms
step:303/1750 train_loss:3.9777 train_time:100008ms step_avg:341.32ms
step:304/1750 train_loss:3.9708 train_time:100359ms step_avg:341.36ms
step:305/1750 train_loss:4.4699 train_time:100710ms step_avg:341.39ms
step:306/1750 train_loss:3.9378 train_time:101063ms step_avg:341.43ms
step:307/1750 train_loss:3.8391 train_time:101414ms step_avg:341.46ms
step:308/1750 train_loss:3.9871 train_time:101767ms step_avg:341.50ms
step:309/1750 train_loss:3.8784 train_time:102118ms step_avg:341.53ms
step:310/1750 train_loss:4.1015 train_time:102471ms step_avg:341.57ms
step:311/1750 train_loss:3.9303 train_time:102826ms step_avg:341.61ms
step:312/1750 train_loss:3.8627 train_time:103178ms step_avg:341.65ms
step:313/1750 train_loss:3.9519 train_time:103532ms step_avg:341.69ms
step:314/1750 train_loss:4.0644 train_time:103885ms step_avg:341.73ms
step:315/1750 train_loss:3.9463 train_time:104235ms step_avg:341.75ms
step:316/1750 train_loss:3.8010 train_time:104587ms step_avg:341.79ms
step:317/1750 train_loss:3.8815 train_time:104940ms step_avg:341.82ms
step:318/1750 train_loss:3.9198 train_time:105291ms step_avg:341.85ms
step:319/1750 train_loss:3.8881 train_time:105642ms step_avg:341.88ms
step:320/1750 train_loss:4.0189 train_time:105995ms step_avg:341.92ms
step:321/1750 train_loss:3.9628 train_time:106346ms step_avg:341.95ms
step:322/1750 train_loss:3.9409 train_time:106701ms step_avg:341.99ms
step:323/1750 train_loss:4.0017 train_time:107052ms step_avg:342.02ms
step:324/1750 train_loss:3.9528 train_time:107405ms step_avg:342.05ms
step:325/1750 train_loss:4.0131 train_time:107756ms step_avg:342.08ms
step:326/1750 train_loss:3.8880 train_time:108108ms step_avg:342.11ms
step:327/1750 train_loss:4.3833 train_time:108458ms step_avg:342.14ms
step:328/1750 train_loss:4.0782 train_time:108811ms step_avg:342.17ms
step:329/1750 train_loss:3.7991 train_time:109160ms step_avg:342.19ms
step:330/1750 train_loss:3.7424 train_time:109512ms step_avg:342.22ms
step:331/1750 train_loss:3.9739 train_time:109862ms step_avg:342.25ms
step:332/1750 train_loss:3.9031 train_time:110213ms step_avg:342.27ms
step:333/1750 train_loss:3.8757 train_time:110562ms step_avg:342.30ms
step:334/1750 train_loss:3.8401 train_time:110911ms step_avg:342.32ms
step:335/1750 train_loss:4.0055 train_time:111261ms step_avg:342.34ms
step:336/1750 train_loss:3.9538 train_time:111611ms step_avg:342.36ms
step:337/1750 train_loss:4.4219 train_time:111960ms step_avg:342.38ms
step:338/1750 train_loss:3.9430 train_time:112308ms step_avg:342.40ms
step:339/1750 train_loss:3.8627 train_time:112659ms step_avg:342.43ms
step:340/1750 train_loss:3.9237 train_time:113010ms step_avg:342.45ms
step:341/1750 train_loss:3.8556 train_time:113360ms step_avg:342.48ms
step:342/1750 train_loss:3.8081 train_time:113710ms step_avg:342.50ms
step:343/1750 train_loss:3.8356 train_time:114060ms step_avg:342.52ms
step:344/1750 train_loss:3.9968 train_time:114411ms step_avg:342.55ms
step:345/1750 train_loss:3.8096 train_time:114762ms step_avg:342.57ms
step:346/1750 train_loss:3.7706 train_time:115112ms step_avg:342.60ms
step:347/1750 train_loss:3.7979 train_time:115465ms step_avg:342.62ms
step:348/1750 train_loss:3.8521 train_time:115815ms step_avg:342.65ms
step:349/1750 train_loss:3.8334 train_time:116167ms step_avg:342.67ms
step:350/1750 train_loss:3.5693 train_time:116516ms step_avg:342.69ms
step:351/1750 train_loss:3.8258 train_time:116866ms step_avg:342.71ms
step:352/1750 train_loss:4.1800 train_time:117214ms step_avg:342.73ms
step:353/1750 train_loss:3.6574 train_time:117564ms step_avg:342.75ms
step:354/1750 train_loss:3.9344 train_time:117912ms step_avg:342.77ms
step:355/1750 train_loss:3.7855 train_time:118261ms step_avg:342.79ms
step:356/1750 train_loss:3.8813 train_time:118609ms step_avg:342.80ms
step:357/1750 train_loss:3.7665 train_time:118960ms step_avg:342.82ms
step:358/1750 train_loss:3.8598 train_time:119311ms step_avg:342.85ms
step:359/1750 train_loss:3.8027 train_time:119664ms step_avg:342.88ms
step:360/1750 train_loss:3.4290 train_time:120014ms step_avg:342.90ms
step:361/1750 train_loss:4.0201 train_time:120365ms step_avg:342.92ms
step:362/1750 train_loss:3.9202 train_time:120714ms step_avg:342.94ms
step:363/1750 train_loss:3.8431 train_time:121061ms step_avg:342.95ms
step:364/1750 train_loss:3.7454 train_time:121410ms step_avg:342.97ms
step:365/1750 train_loss:3.9191 train_time:121760ms step_avg:342.99ms
step:366/1750 train_loss:3.8711 train_time:122111ms step_avg:343.01ms
step:367/1750 train_loss:3.8631 train_time:122461ms step_avg:343.03ms
step:368/1750 train_loss:3.8531 train_time:122809ms step_avg:343.04ms
step:369/1750 train_loss:3.7437 train_time:123159ms step_avg:343.06ms
step:370/1750 train_loss:3.8899 train_time:123508ms step_avg:343.08ms
step:371/1750 train_loss:3.7399 train_time:123859ms step_avg:343.10ms
step:372/1750 train_loss:3.6971 train_time:124209ms step_avg:343.12ms
step:373/1750 train_loss:3.9242 train_time:124557ms step_avg:343.13ms
step:374/1750 train_loss:3.8370 train_time:124907ms step_avg:343.15ms
step:375/1750 train_loss:3.8062 train_time:125257ms step_avg:343.17ms
step:375/1750 val_loss:3.8325 train_time:125348ms step_avg:343.42ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 185.12868 | frobenius_norm = 42384.16797 | spectral_norm = 8188.79102 | nuclear_norm = 1049847.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 84.80067 | spectral_norm = 10.83465 | nuclear_norm = 1983.43677
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 82.43663 | spectral_norm = 12.41290 | nuclear_norm = 1918.56189
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 163.79564 | spectral_norm = 10.44504 | nuclear_norm = 3914.92505
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 147.37318 | spectral_norm = 13.01942 | nuclear_norm = 3457.69653
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 174.82814 | spectral_norm = 13.13183 | nuclear_norm = 4646.34375
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 90.33880 | spectral_norm = 6.62046 | nuclear_norm = 2397.86450
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 82.84678 | spectral_norm = 7.49320 | nuclear_norm = 1939.28369
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 81.69228 | spectral_norm = 9.29722 | nuclear_norm = 1911.79016
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 169.80769 | spectral_norm = 14.67916 | nuclear_norm = 3939.26611
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 170.07748 | spectral_norm = 12.89982 | nuclear_norm = 4001.00781
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 183.45255 | spectral_norm = 12.85969 | nuclear_norm = 4874.91309
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 91.49699 | spectral_norm = 7.77145 | nuclear_norm = 2416.14209
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 82.81306 | spectral_norm = 7.37558 | nuclear_norm = 1940.73950
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 81.88625 | spectral_norm = 7.63683 | nuclear_norm = 1916.54163
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 176.25435 | spectral_norm = 14.82355 | nuclear_norm = 4059.01636
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 175.01137 | spectral_norm = 13.14752 | nuclear_norm = 4108.52002
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 185.66400 | spectral_norm = 12.57543 | nuclear_norm = 4941.44336
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 92.98217 | spectral_norm = 7.72542 | nuclear_norm = 2454.88184
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 81.65733 | spectral_norm = 7.09305 | nuclear_norm = 1881.75391
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 81.28297 | spectral_norm = 6.82815 | nuclear_norm = 1875.08154
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 172.30124 | spectral_norm = 15.42460 | nuclear_norm = 3923.11230
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 176.44266 | spectral_norm = 13.76891 | nuclear_norm = 4150.41016
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 187.72217 | spectral_norm = 13.39033 | nuclear_norm = 4995.69336
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 91.67896 | spectral_norm = 7.46323 | nuclear_norm = 2414.06836
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 81.60806 | spectral_norm = 7.69007 | nuclear_norm = 1906.05481
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 80.41967 | spectral_norm = 7.79309 | nuclear_norm = 1883.21606
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 169.49634 | spectral_norm = 14.32693 | nuclear_norm = 3857.27832
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 173.60315 | spectral_norm = 13.59067 | nuclear_norm = 4036.85449
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 192.27907 | spectral_norm = 12.68032 | nuclear_norm = 5110.46387
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 93.89192 | spectral_norm = 7.74567 | nuclear_norm = 2473.82251
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 82.80913 | spectral_norm = 6.89911 | nuclear_norm = 1923.20117
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 82.78290 | spectral_norm = 6.85380 | nuclear_norm = 1924.26514
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 172.84956 | spectral_norm = 15.40219 | nuclear_norm = 3921.57812
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 167.36566 | spectral_norm = 12.99192 | nuclear_norm = 3946.25806
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 192.67346 | spectral_norm = 12.76043 | nuclear_norm = 5130.51465
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 93.30662 | spectral_norm = 7.60920 | nuclear_norm = 2459.58887
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 79.88807 | spectral_norm = 7.43414 | nuclear_norm = 1853.11353
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 79.50614 | spectral_norm = 7.03577 | nuclear_norm = 1848.68921
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 173.25842 | spectral_norm = 14.65762 | nuclear_norm = 3958.98828
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 176.39470 | spectral_norm = 13.35635 | nuclear_norm = 4144.14893
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 187.90683 | spectral_norm = 13.04544 | nuclear_norm = 4997.03125
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 92.25479 | spectral_norm = 7.72157 | nuclear_norm = 2428.53662
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 80.18462 | spectral_norm = 7.26804 | nuclear_norm = 1861.64062
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 79.94673 | spectral_norm = 7.02244 | nuclear_norm = 1859.64661
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 170.98923 | spectral_norm = 14.05274 | nuclear_norm = 3902.49780
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 172.00484 | spectral_norm = 13.44052 | nuclear_norm = 4010.37769
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 191.24843 | spectral_norm = 14.25204 | nuclear_norm = 5080.06445
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 93.10715 | spectral_norm = 7.44567 | nuclear_norm = 2456.41162
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 81.44428 | spectral_norm = 7.76179 | nuclear_norm = 1855.36755
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 82.01412 | spectral_norm = 7.04311 | nuclear_norm = 1856.90332
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 198.18355 | spectral_norm = 15.69046 | nuclear_norm = 4582.51270
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 192.62357 | spectral_norm = 12.95503 | nuclear_norm = 4578.38525
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 183.91660 | spectral_norm = 13.91170 | nuclear_norm = 4887.93604
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 92.13354 | spectral_norm = 7.56393 | nuclear_norm = 2438.78809
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 83.15290 | spectral_norm = 7.32181 | nuclear_norm = 1918.85535
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 82.02953 | spectral_norm = 7.36492 | nuclear_norm = 1890.00684
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 192.01549 | spectral_norm = 15.52822 | nuclear_norm = 4447.16260
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 183.34343 | spectral_norm = 12.85494 | nuclear_norm = 4342.81250
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 186.24496 | spectral_norm = 13.70077 | nuclear_norm = 4953.38232
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 92.54729 | spectral_norm = 8.08794 | nuclear_norm = 2449.74072
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 82.66499 | spectral_norm = 7.79111 | nuclear_norm = 1898.11853
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 82.20300 | spectral_norm = 7.44785 | nuclear_norm = 1881.96509
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 174.51094 | spectral_norm = 14.77819 | nuclear_norm = 3996.30396
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 185.48865 | spectral_norm = 13.14691 | nuclear_norm = 4385.85645
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 191.37573 | spectral_norm = 13.09598 | nuclear_norm = 5096.44873
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 92.97227 | spectral_norm = 8.45517 | nuclear_norm = 2460.40649
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 83.42539 | spectral_norm = 8.42020 | nuclear_norm = 1925.26501
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 82.10868 | spectral_norm = 7.91197 | nuclear_norm = 1885.79236
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 169.97324 | spectral_norm = 14.30939 | nuclear_norm = 3921.67578
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 185.39497 | spectral_norm = 13.29535 | nuclear_norm = 4374.65967
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 193.41100 | spectral_norm = 13.81382 | nuclear_norm = 5147.74561
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 94.36435 | spectral_norm = 8.54357 | nuclear_norm = 2488.41943
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 692.62549 | spectral_norm = 158.79143 | nuclear_norm = 17607.77930
===========================================
step:376/1750 train_loss:3.8702 train_time:125605ms step_avg:343.18ms
step:377/1750 train_loss:3.8016 train_time:125971ms step_avg:343.25ms
step:378/1750 train_loss:3.8497 train_time:126447ms step_avg:343.61ms
step:379/1750 train_loss:3.8660 train_time:126930ms step_avg:343.98ms
step:380/1750 train_loss:3.9577 train_time:127309ms step_avg:344.08ms
step:381/1750 train_loss:3.8470 train_time:127656ms step_avg:344.09ms
step:382/1750 train_loss:3.8131 train_time:128003ms step_avg:344.09ms
step:383/1750 train_loss:3.8023 train_time:128354ms step_avg:344.11ms
step:384/1750 train_loss:3.8689 train_time:128702ms step_avg:344.12ms
step:385/1750 train_loss:3.7954 train_time:129052ms step_avg:344.14ms
step:386/1750 train_loss:3.8979 train_time:129399ms step_avg:344.15ms
step:387/1750 train_loss:4.0659 train_time:129747ms step_avg:344.16ms
step:388/1750 train_loss:3.7982 train_time:130097ms step_avg:344.17ms
step:389/1750 train_loss:3.7974 train_time:130447ms step_avg:344.19ms
step:390/1750 train_loss:3.8993 train_time:130803ms step_avg:344.22ms
step:391/1750 train_loss:3.8133 train_time:131160ms step_avg:344.25ms
step:392/1750 train_loss:3.9191 train_time:131513ms step_avg:344.28ms
step:393/1750 train_loss:3.7612 train_time:131870ms step_avg:344.31ms
step:394/1750 train_loss:3.8850 train_time:132229ms step_avg:344.35ms
step:395/1750 train_loss:3.6303 train_time:132589ms step_avg:344.39ms
step:396/1750 train_loss:3.8410 train_time:132948ms step_avg:344.42ms
step:397/1750 train_loss:3.8651 train_time:133306ms step_avg:344.46ms
step:398/1750 train_loss:3.8757 train_time:133662ms step_avg:344.49ms
step:399/1750 train_loss:3.7701 train_time:134016ms step_avg:344.51ms
step:400/1750 train_loss:3.8198 train_time:134377ms step_avg:344.56ms
step:401/1750 train_loss:3.9114 train_time:134730ms step_avg:344.58ms
step:402/1750 train_loss:3.8395 train_time:135088ms step_avg:344.61ms
step:403/1750 train_loss:3.9570 train_time:135444ms step_avg:344.64ms
step:404/1750 train_loss:3.6806 train_time:135800ms step_avg:344.67ms
step:405/1750 train_loss:3.7883 train_time:136157ms step_avg:344.70ms
step:406/1750 train_loss:4.0988 train_time:136513ms step_avg:344.73ms
step:407/1750 train_loss:3.7808 train_time:136869ms step_avg:344.76ms
step:408/1750 train_loss:3.8155 train_time:137224ms step_avg:344.78ms
step:409/1750 train_loss:3.8644 train_time:137582ms step_avg:344.82ms
step:410/1750 train_loss:3.7617 train_time:137939ms step_avg:344.85ms
step:411/1750 train_loss:3.7636 train_time:138297ms step_avg:344.88ms
step:412/1750 train_loss:4.1915 train_time:138654ms step_avg:344.91ms
step:413/1750 train_loss:3.6443 train_time:139009ms step_avg:344.94ms
step:414/1750 train_loss:4.0153 train_time:139364ms step_avg:344.96ms
step:415/1750 train_loss:3.7575 train_time:139719ms step_avg:344.98ms
step:416/1750 train_loss:3.7704 train_time:140077ms step_avg:345.02ms
step:417/1750 train_loss:3.9583 train_time:140437ms step_avg:345.05ms
step:418/1750 train_loss:3.6879 train_time:140793ms step_avg:345.08ms
step:419/1750 train_loss:3.8117 train_time:141150ms step_avg:345.11ms
step:420/1750 train_loss:3.7080 train_time:141510ms step_avg:345.15ms
step:421/1750 train_loss:3.6582 train_time:141868ms step_avg:345.18ms
step:422/1750 train_loss:3.7908 train_time:142224ms step_avg:345.20ms
step:423/1750 train_loss:3.8733 train_time:142580ms step_avg:345.23ms
step:424/1750 train_loss:3.6133 train_time:142938ms step_avg:345.26ms
step:425/1750 train_loss:3.7950 train_time:143296ms step_avg:345.29ms
step:426/1750 train_loss:3.6696 train_time:143652ms step_avg:345.32ms
step:427/1750 train_loss:3.8933 train_time:144010ms step_avg:345.35ms
step:428/1750 train_loss:3.8151 train_time:144369ms step_avg:345.38ms
step:429/1750 train_loss:3.7643 train_time:144727ms step_avg:345.41ms
step:430/1750 train_loss:3.7158 train_time:145083ms step_avg:345.44ms
step:431/1750 train_loss:3.6211 train_time:145439ms step_avg:345.46ms
step:432/1750 train_loss:3.7760 train_time:145794ms step_avg:345.48ms
step:433/1750 train_loss:3.8210 train_time:146152ms step_avg:345.51ms
step:434/1750 train_loss:3.7745 train_time:146510ms step_avg:345.54ms
step:435/1750 train_loss:3.8200 train_time:146868ms step_avg:345.57ms
step:436/1750 train_loss:3.8399 train_time:147227ms step_avg:345.60ms
step:437/1750 train_loss:3.7245 train_time:147585ms step_avg:345.63ms
step:438/1750 train_loss:3.7092 train_time:147940ms step_avg:345.65ms
step:439/1750 train_loss:3.7186 train_time:148298ms step_avg:345.68ms
step:440/1750 train_loss:3.9052 train_time:148653ms step_avg:345.71ms
step:441/1750 train_loss:3.7629 train_time:149011ms step_avg:345.73ms
step:442/1750 train_loss:3.7369 train_time:149368ms step_avg:345.76ms
step:443/1750 train_loss:3.6253 train_time:149725ms step_avg:345.79ms
step:444/1750 train_loss:3.9303 train_time:150084ms step_avg:345.81ms
step:445/1750 train_loss:3.8523 train_time:150442ms step_avg:345.84ms
step:446/1750 train_loss:3.8380 train_time:150801ms step_avg:345.87ms
step:447/1750 train_loss:3.7550 train_time:151159ms step_avg:345.90ms
step:448/1750 train_loss:3.8577 train_time:151519ms step_avg:345.93ms
step:449/1750 train_loss:3.6933 train_time:151879ms step_avg:345.97ms
step:450/1750 train_loss:3.7287 train_time:152236ms step_avg:345.99ms
step:451/1750 train_loss:3.5874 train_time:152594ms step_avg:346.02ms
step:452/1750 train_loss:3.7171 train_time:152951ms step_avg:346.04ms
step:453/1750 train_loss:3.6806 train_time:153308ms step_avg:346.07ms
step:454/1750 train_loss:3.6440 train_time:153666ms step_avg:346.10ms
step:455/1750 train_loss:3.8386 train_time:154023ms step_avg:346.12ms
step:456/1750 train_loss:3.7274 train_time:154379ms step_avg:346.14ms
step:457/1750 train_loss:3.7859 train_time:154735ms step_avg:346.16ms
step:458/1750 train_loss:3.8347 train_time:155091ms step_avg:346.18ms
step:459/1750 train_loss:3.6427 train_time:155449ms step_avg:346.21ms
step:460/1750 train_loss:3.7933 train_time:155803ms step_avg:346.23ms
step:461/1750 train_loss:3.6929 train_time:156159ms step_avg:346.25ms
step:462/1750 train_loss:3.7412 train_time:156515ms step_avg:346.27ms
step:463/1750 train_loss:3.7785 train_time:156869ms step_avg:346.29ms
step:464/1750 train_loss:3.7151 train_time:157223ms step_avg:346.31ms
step:465/1750 train_loss:3.7271 train_time:157579ms step_avg:346.33ms
step:466/1750 train_loss:3.8084 train_time:157934ms step_avg:346.35ms
step:467/1750 train_loss:3.8303 train_time:158290ms step_avg:346.37ms
step:468/1750 train_loss:3.8020 train_time:158645ms step_avg:346.39ms
step:469/1750 train_loss:3.6885 train_time:159001ms step_avg:346.41ms
step:470/1750 train_loss:3.7701 train_time:159355ms step_avg:346.42ms
step:471/1750 train_loss:3.8200 train_time:159710ms step_avg:346.44ms
step:472/1750 train_loss:3.7848 train_time:160066ms step_avg:346.46ms
step:473/1750 train_loss:3.7283 train_time:160420ms step_avg:346.48ms
step:474/1750 train_loss:3.5994 train_time:160774ms step_avg:346.50ms
step:475/1750 train_loss:4.0115 train_time:161129ms step_avg:346.51ms
step:476/1750 train_loss:3.7664 train_time:161485ms step_avg:346.53ms
step:477/1750 train_loss:3.5962 train_time:161842ms step_avg:346.56ms
step:478/1750 train_loss:3.8299 train_time:162198ms step_avg:346.58ms
step:479/1750 train_loss:3.7783 train_time:162555ms step_avg:346.60ms
step:480/1750 train_loss:3.9219 train_time:162912ms step_avg:346.62ms
step:481/1750 train_loss:3.7271 train_time:163269ms step_avg:346.64ms
step:482/1750 train_loss:3.5383 train_time:163625ms step_avg:346.66ms
step:483/1750 train_loss:3.8195 train_time:163981ms step_avg:346.68ms
step:484/1750 train_loss:3.6697 train_time:164340ms step_avg:346.71ms
step:485/1750 train_loss:3.6698 train_time:164697ms step_avg:346.73ms
step:486/1750 train_loss:3.5816 train_time:165053ms step_avg:346.75ms
step:487/1750 train_loss:3.6851 train_time:165408ms step_avg:346.77ms
step:488/1750 train_loss:3.8916 train_time:165763ms step_avg:346.79ms
step:489/1750 train_loss:3.7226 train_time:166119ms step_avg:346.80ms
step:490/1750 train_loss:3.5944 train_time:166476ms step_avg:346.82ms
step:491/1750 train_loss:3.6152 train_time:166830ms step_avg:346.84ms
step:492/1750 train_loss:3.7349 train_time:167188ms step_avg:346.86ms
step:493/1750 train_loss:3.5811 train_time:167547ms step_avg:346.89ms
step:494/1750 train_loss:3.7106 train_time:167904ms step_avg:346.91ms
step:495/1750 train_loss:3.6679 train_time:168261ms step_avg:346.93ms
step:496/1750 train_loss:3.5304 train_time:168618ms step_avg:346.95ms
step:497/1750 train_loss:3.7420 train_time:168972ms step_avg:346.96ms
step:498/1750 train_loss:3.7988 train_time:169328ms step_avg:346.98ms
step:499/1750 train_loss:3.8252 train_time:169685ms step_avg:347.00ms
step:500/1750 train_loss:3.7367 train_time:170045ms step_avg:347.03ms
step:500/1750 val_loss:3.7106 train_time:170135ms step_avg:347.21ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 207.09097 | frobenius_norm = 47494.49609 | spectral_norm = 8793.62793 | nuclear_norm = 1181232.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 106.19234 | spectral_norm = 14.93506 | nuclear_norm = 2472.93848
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 102.80024 | spectral_norm = 16.39965 | nuclear_norm = 2380.77979
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 199.33153 | spectral_norm = 12.66356 | nuclear_norm = 4785.23584
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 172.84064 | spectral_norm = 15.71355 | nuclear_norm = 4046.64307
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 219.79539 | spectral_norm = 17.01603 | nuclear_norm = 5841.06299
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 113.99213 | spectral_norm = 8.83833 | nuclear_norm = 3026.00024
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 104.24259 | spectral_norm = 9.73882 | nuclear_norm = 2430.80615
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 103.31535 | spectral_norm = 11.34841 | nuclear_norm = 2410.00537
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 197.76013 | spectral_norm = 17.59588 | nuclear_norm = 4578.87598
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 198.38005 | spectral_norm = 15.20639 | nuclear_norm = 4658.91797
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 227.07426 | spectral_norm = 16.16005 | nuclear_norm = 6035.78418
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 113.41504 | spectral_norm = 10.30973 | nuclear_norm = 2991.91162
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 104.18232 | spectral_norm = 9.53570 | nuclear_norm = 2432.27246
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 102.84831 | spectral_norm = 9.62689 | nuclear_norm = 2400.60107
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 206.84584 | spectral_norm = 17.52409 | nuclear_norm = 4753.07227
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 206.05473 | spectral_norm = 15.55607 | nuclear_norm = 4828.47363
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 229.21588 | spectral_norm = 16.24925 | nuclear_norm = 6100.06885
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 115.70569 | spectral_norm = 10.19812 | nuclear_norm = 3053.06177
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 102.30408 | spectral_norm = 9.09380 | nuclear_norm = 2336.36230
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 101.85004 | spectral_norm = 8.60813 | nuclear_norm = 2330.11865
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 204.10101 | spectral_norm = 18.52246 | nuclear_norm = 4638.70605
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 209.39622 | spectral_norm = 16.41130 | nuclear_norm = 4914.91992
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 232.24983 | spectral_norm = 17.30571 | nuclear_norm = 6184.09473
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 113.27518 | spectral_norm = 9.64001 | nuclear_norm = 2979.78296
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 102.67625 | spectral_norm = 10.03715 | nuclear_norm = 2386.17358
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 101.04403 | spectral_norm = 9.92154 | nuclear_norm = 2357.21338
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 201.64696 | spectral_norm = 17.01038 | nuclear_norm = 4577.11816
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 205.46564 | spectral_norm = 16.55687 | nuclear_norm = 4762.13281
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 237.44931 | spectral_norm = 16.25848 | nuclear_norm = 6311.63184
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 116.48719 | spectral_norm = 10.03439 | nuclear_norm = 3067.91992
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 103.75771 | spectral_norm = 8.81257 | nuclear_norm = 2397.03052
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 103.42268 | spectral_norm = 8.80706 | nuclear_norm = 2391.69238
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 206.21443 | spectral_norm = 19.33670 | nuclear_norm = 4669.85254
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 197.37228 | spectral_norm = 15.08911 | nuclear_norm = 4659.16016
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 242.67203 | spectral_norm = 16.46125 | nuclear_norm = 6465.80664
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 116.74364 | spectral_norm = 9.61278 | nuclear_norm = 3074.59863
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 100.45762 | spectral_norm = 9.65918 | nuclear_norm = 2314.48218
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 99.68811 | spectral_norm = 9.15657 | nuclear_norm = 2306.39014
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 208.19971 | spectral_norm = 17.73468 | nuclear_norm = 4759.16211
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 210.47745 | spectral_norm = 15.90278 | nuclear_norm = 4933.68652
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 232.95346 | spectral_norm = 16.53751 | nuclear_norm = 6200.56152
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 114.52090 | spectral_norm = 9.72497 | nuclear_norm = 3014.05615
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 100.89875 | spectral_norm = 9.53543 | nuclear_norm = 2325.29126
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 100.11581 | spectral_norm = 9.16382 | nuclear_norm = 2318.91675
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 203.87576 | spectral_norm = 16.73514 | nuclear_norm = 4651.30957
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 202.45050 | spectral_norm = 16.23954 | nuclear_norm = 4687.47021
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 238.19543 | spectral_norm = 17.97258 | nuclear_norm = 6330.57178
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 116.30717 | spectral_norm = 9.57971 | nuclear_norm = 3069.44727
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 102.43564 | spectral_norm = 10.14271 | nuclear_norm = 2314.17041
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 102.93307 | spectral_norm = 9.12595 | nuclear_norm = 2303.86133
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 234.07664 | spectral_norm = 19.66640 | nuclear_norm = 5383.34277
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 229.87729 | spectral_norm = 15.44500 | nuclear_norm = 5457.24707
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 227.47260 | spectral_norm = 17.76763 | nuclear_norm = 6050.36914
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 115.87470 | spectral_norm = 10.08503 | nuclear_norm = 3072.30762
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 105.36791 | spectral_norm = 9.66262 | nuclear_norm = 2415.96191
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 103.80680 | spectral_norm = 9.83501 | nuclear_norm = 2373.89404
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 227.28448 | spectral_norm = 18.81999 | nuclear_norm = 5251.76758
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 216.78874 | spectral_norm = 15.14121 | nuclear_norm = 5127.79590
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 230.95911 | spectral_norm = 17.74876 | nuclear_norm = 6145.78809
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 115.92461 | spectral_norm = 10.66295 | nuclear_norm = 3071.93896
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 104.28684 | spectral_norm = 10.35946 | nuclear_norm = 2375.49756
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 103.35057 | spectral_norm = 9.79268 | nuclear_norm = 2344.27173
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 206.93777 | spectral_norm = 18.60269 | nuclear_norm = 4722.62646
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 219.70087 | spectral_norm = 15.74709 | nuclear_norm = 5179.61230
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 239.62379 | spectral_norm = 16.87391 | nuclear_norm = 6386.05127
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 115.04218 | spectral_norm = 11.45232 | nuclear_norm = 3045.25415
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 105.76208 | spectral_norm = 11.36024 | nuclear_norm = 2427.13599
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 103.51712 | spectral_norm = 10.62019 | nuclear_norm = 2363.38916
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 202.32762 | spectral_norm = 18.19317 | nuclear_norm = 4661.65234
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 220.86319 | spectral_norm = 16.19636 | nuclear_norm = 5193.64746
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 244.00859 | spectral_norm = 17.78113 | nuclear_norm = 6497.35889
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 118.09173 | spectral_norm = 11.74530 | nuclear_norm = 3112.43823
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 812.51740 | spectral_norm = 165.55316 | nuclear_norm = 20871.02734
===========================================
step:501/1750 train_loss:3.8078 train_time:170394ms step_avg:347.04ms
step:502/1750 train_loss:3.7516 train_time:170744ms step_avg:347.04ms
step:503/1750 train_loss:3.7842 train_time:171098ms step_avg:347.05ms
step:504/1750 train_loss:3.7376 train_time:171450ms step_avg:347.06ms
step:505/1750 train_loss:3.8173 train_time:171804ms step_avg:347.08ms
step:506/1750 train_loss:3.6724 train_time:172157ms step_avg:347.09ms
step:507/1750 train_loss:3.7650 train_time:172510ms step_avg:347.10ms
step:508/1750 train_loss:3.8378 train_time:172866ms step_avg:347.12ms
step:509/1750 train_loss:3.7764 train_time:173218ms step_avg:347.13ms
step:510/1750 train_loss:3.5886 train_time:173571ms step_avg:347.14ms
step:511/1750 train_loss:3.7853 train_time:173926ms step_avg:347.16ms
step:512/1750 train_loss:3.7354 train_time:174285ms step_avg:347.18ms
step:513/1750 train_loss:3.6714 train_time:174641ms step_avg:347.20ms
step:514/1750 train_loss:3.8390 train_time:174997ms step_avg:347.22ms
step:515/1750 train_loss:3.7481 train_time:175350ms step_avg:347.23ms
step:516/1750 train_loss:4.0830 train_time:175706ms step_avg:347.24ms
step:517/1750 train_loss:3.6901 train_time:176061ms step_avg:347.26ms
step:518/1750 train_loss:3.7784 train_time:176417ms step_avg:347.28ms
step:519/1750 train_loss:3.6647 train_time:176772ms step_avg:347.29ms
step:520/1750 train_loss:3.6913 train_time:177132ms step_avg:347.32ms
step:521/1750 train_loss:3.6662 train_time:177494ms step_avg:347.35ms
step:522/1750 train_loss:3.6574 train_time:177859ms step_avg:347.38ms
step:523/1750 train_loss:4.2892 train_time:178221ms step_avg:347.41ms
step:524/1750 train_loss:3.7447 train_time:178581ms step_avg:347.43ms
step:525/1750 train_loss:3.6836 train_time:178944ms step_avg:347.46ms
step:526/1750 train_loss:3.7009 train_time:179307ms step_avg:347.49ms
step:527/1750 train_loss:3.6693 train_time:179669ms step_avg:347.52ms
step:528/1750 train_loss:3.6377 train_time:180030ms step_avg:347.55ms
step:529/1750 train_loss:3.8577 train_time:180395ms step_avg:347.58ms
step:530/1750 train_loss:3.6477 train_time:180758ms step_avg:347.61ms
step:531/1750 train_loss:3.9281 train_time:181122ms step_avg:347.64ms
step:532/1750 train_loss:3.7398 train_time:181482ms step_avg:347.67ms
step:533/1750 train_loss:3.6627 train_time:181844ms step_avg:347.69ms
step:534/1750 train_loss:3.6769 train_time:182204ms step_avg:347.72ms
step:535/1750 train_loss:3.6080 train_time:182568ms step_avg:347.75ms
step:536/1750 train_loss:3.7617 train_time:182933ms step_avg:347.78ms
step:537/1750 train_loss:3.7388 train_time:183297ms step_avg:347.81ms
step:538/1750 train_loss:3.6311 train_time:183664ms step_avg:347.85ms
step:539/1750 train_loss:4.1190 train_time:184031ms step_avg:347.89ms
step:540/1750 train_loss:3.6841 train_time:184394ms step_avg:347.91ms
step:541/1750 train_loss:3.7943 train_time:184757ms step_avg:347.94ms
step:542/1750 train_loss:3.6044 train_time:185120ms step_avg:347.97ms
step:543/1750 train_loss:3.5943 train_time:185483ms step_avg:348.00ms
step:544/1750 train_loss:3.6541 train_time:185845ms step_avg:348.02ms
step:545/1750 train_loss:3.6013 train_time:186208ms step_avg:348.05ms
step:546/1750 train_loss:3.6362 train_time:186571ms step_avg:348.08ms
step:547/1750 train_loss:3.6534 train_time:186934ms step_avg:348.11ms
step:548/1750 train_loss:3.6220 train_time:187297ms step_avg:348.14ms
step:549/1750 train_loss:3.7368 train_time:187661ms step_avg:348.16ms
step:550/1750 train_loss:3.6275 train_time:188025ms step_avg:348.19ms
step:551/1750 train_loss:3.6458 train_time:188385ms step_avg:348.22ms
step:552/1750 train_loss:3.9458 train_time:188747ms step_avg:348.24ms
step:553/1750 train_loss:3.7635 train_time:189109ms step_avg:348.27ms
step:554/1750 train_loss:3.7171 train_time:189469ms step_avg:348.29ms
step:555/1750 train_loss:3.6363 train_time:189832ms step_avg:348.32ms
step:556/1750 train_loss:3.7079 train_time:190191ms step_avg:348.34ms
step:557/1750 train_loss:3.3211 train_time:190554ms step_avg:348.36ms
step:558/1750 train_loss:3.6176 train_time:190915ms step_avg:348.39ms
step:559/1750 train_loss:3.6596 train_time:191275ms step_avg:348.41ms
step:560/1750 train_loss:3.7028 train_time:191637ms step_avg:348.43ms
step:561/1750 train_loss:3.6224 train_time:191998ms step_avg:348.45ms
step:562/1750 train_loss:3.5645 train_time:192360ms step_avg:348.48ms
step:563/1750 train_loss:3.7671 train_time:192726ms step_avg:348.51ms
step:564/1750 train_loss:3.5812 train_time:193092ms step_avg:348.54ms
step:565/1750 train_loss:3.6901 train_time:193452ms step_avg:348.56ms
step:566/1750 train_loss:3.6297 train_time:193835ms step_avg:348.62ms
step:567/1750 train_loss:3.6093 train_time:194306ms step_avg:348.84ms
step:568/1750 train_loss:3.7020 train_time:194671ms step_avg:348.87ms
step:569/1750 train_loss:3.6583 train_time:195161ms step_avg:349.13ms
step:570/1750 train_loss:3.6958 train_time:195528ms step_avg:349.16ms
step:571/1750 train_loss:3.7675 train_time:195886ms step_avg:349.17ms
step:572/1750 train_loss:3.7326 train_time:196248ms step_avg:349.20ms
step:573/1750 train_loss:3.7469 train_time:196614ms step_avg:349.22ms
step:574/1750 train_loss:3.7924 train_time:196981ms step_avg:349.26ms
step:575/1750 train_loss:3.7364 train_time:197343ms step_avg:349.28ms
step:576/1750 train_loss:3.7716 train_time:197703ms step_avg:349.30ms
step:577/1750 train_loss:3.6818 train_time:198064ms step_avg:349.32ms
step:578/1750 train_loss:3.6846 train_time:198427ms step_avg:349.34ms
step:579/1750 train_loss:3.6836 train_time:198788ms step_avg:349.36ms
step:580/1750 train_loss:3.6047 train_time:199152ms step_avg:349.39ms
step:581/1750 train_loss:3.6424 train_time:199515ms step_avg:349.41ms
step:582/1750 train_loss:3.8637 train_time:199878ms step_avg:349.44ms
step:583/1750 train_loss:3.6390 train_time:200241ms step_avg:349.46ms
step:584/1750 train_loss:3.5927 train_time:200605ms step_avg:349.49ms
step:585/1750 train_loss:3.7963 train_time:200965ms step_avg:349.50ms
step:586/1750 train_loss:3.5219 train_time:201328ms step_avg:349.53ms
step:587/1750 train_loss:3.6740 train_time:201688ms step_avg:349.55ms
step:588/1750 train_loss:3.6624 train_time:202049ms step_avg:349.57ms
step:589/1750 train_loss:4.0069 train_time:202411ms step_avg:349.59ms
step:590/1750 train_loss:3.7908 train_time:202770ms step_avg:349.60ms
step:591/1750 train_loss:3.5266 train_time:203131ms step_avg:349.62ms
step:592/1750 train_loss:3.5462 train_time:203495ms step_avg:349.65ms
step:593/1750 train_loss:3.5095 train_time:203860ms step_avg:349.67ms
step:594/1750 train_loss:3.5610 train_time:204220ms step_avg:349.69ms
step:595/1750 train_loss:3.9279 train_time:204582ms step_avg:349.71ms
step:596/1750 train_loss:3.6512 train_time:204945ms step_avg:349.74ms
step:597/1750 train_loss:3.5936 train_time:205305ms step_avg:349.75ms
step:598/1750 train_loss:3.6717 train_time:205665ms step_avg:349.77ms
step:599/1750 train_loss:3.4866 train_time:206025ms step_avg:349.79ms
step:600/1750 train_loss:3.6111 train_time:206390ms step_avg:349.81ms
step:601/1750 train_loss:3.6554 train_time:206751ms step_avg:349.83ms
step:602/1750 train_loss:3.6757 train_time:207112ms step_avg:349.85ms
step:603/1750 train_loss:3.7904 train_time:207475ms step_avg:349.87ms
step:604/1750 train_loss:3.6187 train_time:207835ms step_avg:349.89ms
step:605/1750 train_loss:3.6192 train_time:208195ms step_avg:349.91ms
step:606/1750 train_loss:3.5904 train_time:208557ms step_avg:349.93ms
step:607/1750 train_loss:3.8482 train_time:208916ms step_avg:349.94ms
step:608/1750 train_loss:3.6548 train_time:209277ms step_avg:349.96ms
step:609/1750 train_loss:3.6229 train_time:209638ms step_avg:349.98ms
step:610/1750 train_loss:3.7151 train_time:209995ms step_avg:349.99ms
step:611/1750 train_loss:3.6141 train_time:210356ms step_avg:350.01ms
step:612/1750 train_loss:3.5861 train_time:210716ms step_avg:350.03ms
step:613/1750 train_loss:3.7700 train_time:211079ms step_avg:350.05ms
step:614/1750 train_loss:3.7205 train_time:211442ms step_avg:350.07ms
step:615/1750 train_loss:3.7018 train_time:211803ms step_avg:350.09ms
step:616/1750 train_loss:3.6418 train_time:212164ms step_avg:350.11ms
step:617/1750 train_loss:3.5667 train_time:212525ms step_avg:350.12ms
step:618/1750 train_loss:3.7001 train_time:212885ms step_avg:350.14ms
step:619/1750 train_loss:3.5660 train_time:213246ms step_avg:350.16ms
step:620/1750 train_loss:3.5959 train_time:213608ms step_avg:350.18ms
step:621/1750 train_loss:3.9401 train_time:213971ms step_avg:350.20ms
step:622/1750 train_loss:3.5793 train_time:214336ms step_avg:350.22ms
step:623/1750 train_loss:3.6174 train_time:214700ms step_avg:350.25ms
step:624/1750 train_loss:3.7082 train_time:215060ms step_avg:350.26ms
step:625/1750 train_loss:3.7191 train_time:215422ms step_avg:350.28ms
step:625/1750 val_loss:3.6344 train_time:215518ms step_avg:350.44ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 225.53697 | frobenius_norm = 51799.70312 | spectral_norm = 9332.69141 | nuclear_norm = 1292489.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 123.51769 | spectral_norm = 18.71732 | nuclear_norm = 2866.90674
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 119.19218 | spectral_norm = 20.23906 | nuclear_norm = 2747.92041
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 229.63779 | spectral_norm = 14.51677 | nuclear_norm = 5532.94434
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 193.00690 | spectral_norm = 17.95372 | nuclear_norm = 4511.91016
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 257.06302 | spectral_norm = 20.52476 | nuclear_norm = 6833.74561
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 133.20660 | spectral_norm = 10.89671 | nuclear_norm = 3534.62329
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 122.00591 | spectral_norm = 11.56609 | nuclear_norm = 2836.59277
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 121.01344 | spectral_norm = 12.96778 | nuclear_norm = 2816.77441
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 222.52219 | spectral_norm = 20.14714 | nuclear_norm = 5146.28027
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 222.95108 | spectral_norm = 17.26270 | nuclear_norm = 5233.12061
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 263.59412 | spectral_norm = 19.06891 | nuclear_norm = 7010.31641
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 131.67589 | spectral_norm = 12.62922 | nuclear_norm = 3470.86279
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 122.10646 | spectral_norm = 11.53920 | nuclear_norm = 2838.37939
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 119.95343 | spectral_norm = 11.25692 | nuclear_norm = 2789.26025
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 234.40948 | spectral_norm = 19.99313 | nuclear_norm = 5379.23340
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 233.90785 | spectral_norm = 17.82890 | nuclear_norm = 5476.22754
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 265.48233 | spectral_norm = 19.63689 | nuclear_norm = 7065.57617
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 134.65651 | spectral_norm = 12.35408 | nuclear_norm = 3551.43506
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 118.99565 | spectral_norm = 10.85295 | nuclear_norm = 2698.60425
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 118.43032 | spectral_norm = 10.13829 | nuclear_norm = 2689.63892
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 233.35199 | spectral_norm = 21.43850 | nuclear_norm = 5293.94482
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 239.21867 | spectral_norm = 18.86752 | nuclear_norm = 5608.65820
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 269.40408 | spectral_norm = 20.83434 | nuclear_norm = 7176.51025
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 131.26854 | spectral_norm = 11.58608 | nuclear_norm = 3450.59180
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 119.55931 | spectral_norm = 12.13041 | nuclear_norm = 2765.85107
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 117.78585 | spectral_norm = 11.74705 | nuclear_norm = 2739.47290
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 231.26939 | spectral_norm = 19.55080 | nuclear_norm = 5241.33887
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 234.80173 | spectral_norm = 19.12436 | nuclear_norm = 5432.65039
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 275.15192 | spectral_norm = 19.46464 | nuclear_norm = 7314.62598
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 135.23779 | spectral_norm = 12.06599 | nuclear_norm = 3560.68872
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 120.58139 | spectral_norm = 10.42298 | nuclear_norm = 2774.65186
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 120.04691 | spectral_norm = 10.44373 | nuclear_norm = 2763.31934
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 237.25194 | spectral_norm = 22.61646 | nuclear_norm = 5359.13525
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 223.47678 | spectral_norm = 16.78463 | nuclear_norm = 5278.93896
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 284.53604 | spectral_norm = 19.62670 | nuclear_norm = 7583.37695
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 136.49747 | spectral_norm = 11.61992 | nuclear_norm = 3593.21924
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 117.23145 | spectral_norm = 11.62192 | nuclear_norm = 2686.33740
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 116.01090 | spectral_norm = 10.96034 | nuclear_norm = 2672.05591
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 239.83153 | spectral_norm = 20.49706 | nuclear_norm = 5481.80664
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 241.06377 | spectral_norm = 18.18417 | nuclear_norm = 5643.41162
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 270.75912 | spectral_norm = 19.69345 | nuclear_norm = 7210.44580
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 132.99860 | spectral_norm = 11.67663 | nuclear_norm = 3499.40576
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 117.73656 | spectral_norm = 11.34683 | nuclear_norm = 2698.62695
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 116.44276 | spectral_norm = 10.97416 | nuclear_norm = 2685.90723
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 233.32716 | spectral_norm = 19.12702 | nuclear_norm = 5322.16650
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 229.80589 | spectral_norm = 18.66903 | nuclear_norm = 5299.43799
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 277.66620 | spectral_norm = 21.16121 | nuclear_norm = 7379.25977
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 135.52475 | spectral_norm = 11.89900 | nuclear_norm = 3575.24219
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 119.57022 | spectral_norm = 12.19218 | nuclear_norm = 2680.15991
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 120.18758 | spectral_norm = 10.95100 | nuclear_norm = 2666.69922
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 265.81915 | spectral_norm = 23.64664 | nuclear_norm = 6085.99316
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 261.57617 | spectral_norm = 17.61993 | nuclear_norm = 6205.91553
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 263.37601 | spectral_norm = 21.08290 | nuclear_norm = 7005.02441
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 135.38005 | spectral_norm = 12.45005 | nuclear_norm = 3591.04102
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 123.40244 | spectral_norm = 11.76806 | nuclear_norm = 2815.30615
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 121.49495 | spectral_norm = 12.00303 | nuclear_norm = 2763.04907
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 258.77609 | spectral_norm = 21.99182 | nuclear_norm = 5965.24707
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 246.24754 | spectral_norm = 17.24565 | nuclear_norm = 5821.92773
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 268.51263 | spectral_norm = 21.18828 | nuclear_norm = 7144.83789
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 135.49680 | spectral_norm = 13.00314 | nuclear_norm = 3592.85156
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 121.76122 | spectral_norm = 12.54847 | nuclear_norm = 2752.16846
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 120.61555 | spectral_norm = 11.88716 | nuclear_norm = 2715.55518
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 235.95552 | spectral_norm = 21.78801 | nuclear_norm = 5368.20801
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 249.94250 | spectral_norm = 18.06015 | nuclear_norm = 5879.28125
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 280.01245 | spectral_norm = 20.33060 | nuclear_norm = 7464.45508
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 133.33939 | spectral_norm = 14.15396 | nuclear_norm = 3529.62158
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 123.96233 | spectral_norm = 13.86774 | nuclear_norm = 2827.57373
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 120.82648 | spectral_norm = 12.97226 | nuclear_norm = 2743.93115
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 232.02408 | spectral_norm = 21.67982 | nuclear_norm = 5337.58691
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 252.98260 | spectral_norm = 18.50454 | nuclear_norm = 5937.82812
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 286.04529 | spectral_norm = 21.18747 | nuclear_norm = 7616.38623
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 137.69446 | spectral_norm = 14.66827 | nuclear_norm = 3626.20264
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 917.42340 | spectral_norm = 169.56451 | nuclear_norm = 23732.12891
===========================================
step:626/1750 train_loss:3.7562 train_time:215781ms step_avg:350.29ms
step:627/1750 train_loss:3.7342 train_time:216138ms step_avg:350.30ms
step:628/1750 train_loss:3.7781 train_time:216494ms step_avg:350.31ms
step:629/1750 train_loss:3.6043 train_time:216853ms step_avg:350.33ms
step:630/1750 train_loss:3.7362 train_time:217211ms step_avg:350.34ms
step:631/1750 train_loss:3.7536 train_time:217570ms step_avg:350.35ms
step:632/1750 train_loss:3.6649 train_time:217931ms step_avg:350.37ms
step:633/1750 train_loss:3.6115 train_time:218292ms step_avg:350.39ms
step:634/1750 train_loss:3.7118 train_time:218649ms step_avg:350.40ms
step:635/1750 train_loss:3.9637 train_time:219008ms step_avg:350.41ms
step:636/1750 train_loss:3.5537 train_time:219367ms step_avg:350.43ms
step:637/1750 train_loss:3.3695 train_time:219729ms step_avg:350.45ms
step:638/1750 train_loss:3.6031 train_time:220089ms step_avg:350.46ms
step:639/1750 train_loss:3.6433 train_time:220446ms step_avg:350.47ms
step:640/1750 train_loss:3.5758 train_time:220806ms step_avg:350.49ms
step:641/1750 train_loss:3.5956 train_time:221165ms step_avg:350.50ms
step:642/1750 train_loss:3.6410 train_time:221524ms step_avg:350.51ms
step:643/1750 train_loss:3.6165 train_time:221884ms step_avg:350.53ms
step:644/1750 train_loss:3.5657 train_time:222244ms step_avg:350.54ms
step:645/1750 train_loss:3.7909 train_time:222607ms step_avg:350.56ms
step:646/1750 train_loss:3.6886 train_time:222969ms step_avg:350.58ms
step:647/1750 train_loss:3.6823 train_time:223330ms step_avg:350.60ms
step:648/1750 train_loss:3.7198 train_time:223694ms step_avg:350.62ms
step:649/1750 train_loss:3.7770 train_time:224054ms step_avg:350.63ms
step:650/1750 train_loss:3.6293 train_time:224421ms step_avg:350.66ms
step:651/1750 train_loss:3.7801 train_time:224790ms step_avg:350.69ms
step:652/1750 train_loss:3.5869 train_time:225159ms step_avg:350.71ms
step:653/1750 train_loss:3.6755 train_time:225527ms step_avg:350.74ms
step:654/1750 train_loss:3.4405 train_time:225897ms step_avg:350.77ms
step:655/1750 train_loss:3.5891 train_time:226260ms step_avg:350.79ms
step:656/1750 train_loss:3.5909 train_time:226624ms step_avg:350.81ms
step:657/1750 train_loss:3.5166 train_time:226989ms step_avg:350.83ms
step:658/1750 train_loss:3.7023 train_time:227355ms step_avg:350.86ms
step:659/1750 train_loss:3.5952 train_time:227721ms step_avg:350.88ms
step:660/1750 train_loss:3.7047 train_time:228085ms step_avg:350.90ms
step:661/1750 train_loss:3.7557 train_time:228455ms step_avg:350.93ms
step:662/1750 train_loss:3.6827 train_time:228819ms step_avg:350.95ms
step:663/1750 train_loss:3.5629 train_time:229185ms step_avg:350.97ms
step:664/1750 train_loss:3.6255 train_time:229553ms step_avg:351.00ms
step:665/1750 train_loss:3.5073 train_time:229921ms step_avg:351.02ms
step:666/1750 train_loss:3.7975 train_time:230287ms step_avg:351.05ms
step:667/1750 train_loss:3.6234 train_time:230655ms step_avg:351.07ms
step:668/1750 train_loss:3.6611 train_time:231025ms step_avg:351.10ms
step:669/1750 train_loss:3.4970 train_time:231397ms step_avg:351.13ms
step:670/1750 train_loss:3.6132 train_time:231763ms step_avg:351.16ms
step:671/1750 train_loss:3.5667 train_time:232134ms step_avg:351.19ms
step:672/1750 train_loss:3.5743 train_time:232501ms step_avg:351.21ms
step:673/1750 train_loss:3.8577 train_time:232868ms step_avg:351.23ms
step:674/1750 train_loss:3.6402 train_time:233235ms step_avg:351.26ms
step:675/1750 train_loss:3.7219 train_time:233603ms step_avg:351.28ms
step:676/1750 train_loss:3.5008 train_time:233970ms step_avg:351.31ms
step:677/1750 train_loss:3.6079 train_time:234337ms step_avg:351.33ms
step:678/1750 train_loss:3.5643 train_time:234705ms step_avg:351.36ms
step:679/1750 train_loss:3.6878 train_time:235074ms step_avg:351.38ms
step:680/1750 train_loss:3.6023 train_time:235442ms step_avg:351.41ms
step:681/1750 train_loss:3.6246 train_time:235812ms step_avg:351.43ms
step:682/1750 train_loss:3.6761 train_time:236185ms step_avg:351.47ms
step:683/1750 train_loss:3.7480 train_time:236550ms step_avg:351.49ms
step:684/1750 train_loss:3.6609 train_time:236914ms step_avg:351.50ms
step:685/1750 train_loss:3.7014 train_time:237281ms step_avg:351.53ms
step:686/1750 train_loss:3.6471 train_time:237646ms step_avg:351.55ms
step:687/1750 train_loss:3.6832 train_time:238010ms step_avg:351.57ms
step:688/1750 train_loss:3.2036 train_time:238382ms step_avg:351.60ms
step:689/1750 train_loss:3.4155 train_time:238754ms step_avg:351.63ms
step:690/1750 train_loss:3.5567 train_time:239125ms step_avg:351.65ms
step:691/1750 train_loss:3.4262 train_time:239489ms step_avg:351.67ms
step:692/1750 train_loss:3.6343 train_time:239856ms step_avg:351.70ms
step:693/1750 train_loss:3.6619 train_time:240224ms step_avg:351.72ms
step:694/1750 train_loss:3.5616 train_time:240590ms step_avg:351.74ms
step:695/1750 train_loss:3.5503 train_time:240951ms step_avg:351.75ms
step:696/1750 train_loss:3.8647 train_time:241317ms step_avg:351.77ms
step:697/1750 train_loss:3.6077 train_time:241684ms step_avg:351.80ms
step:698/1750 train_loss:3.6598 train_time:242050ms step_avg:351.82ms
step:699/1750 train_loss:3.7806 train_time:242417ms step_avg:351.84ms
step:700/1750 train_loss:3.5853 train_time:242786ms step_avg:351.86ms
step:701/1750 train_loss:3.5637 train_time:243150ms step_avg:351.88ms
step:702/1750 train_loss:3.5274 train_time:243519ms step_avg:351.91ms
step:703/1750 train_loss:3.5069 train_time:243886ms step_avg:351.93ms
step:704/1750 train_loss:3.5835 train_time:244252ms step_avg:351.95ms
step:705/1750 train_loss:3.5731 train_time:244627ms step_avg:351.98ms
step:706/1750 train_loss:3.6022 train_time:245001ms step_avg:352.01ms
step:707/1750 train_loss:3.6625 train_time:245367ms step_avg:352.03ms
step:708/1750 train_loss:3.6143 train_time:245731ms step_avg:352.05ms
step:709/1750 train_loss:3.5955 train_time:246097ms step_avg:352.07ms
step:710/1750 train_loss:3.5574 train_time:246465ms step_avg:352.09ms
step:711/1750 train_loss:3.6062 train_time:246837ms step_avg:352.12ms
step:712/1750 train_loss:3.6590 train_time:247209ms step_avg:352.15ms
step:713/1750 train_loss:3.6640 train_time:247579ms step_avg:352.18ms
step:714/1750 train_loss:3.5708 train_time:247944ms step_avg:352.19ms
step:715/1750 train_loss:3.5866 train_time:248307ms step_avg:352.21ms
step:716/1750 train_loss:3.5992 train_time:248672ms step_avg:352.23ms
step:717/1750 train_loss:3.7224 train_time:249040ms step_avg:352.25ms
step:718/1750 train_loss:3.6184 train_time:249403ms step_avg:352.26ms
step:719/1750 train_loss:3.6894 train_time:249767ms step_avg:352.28ms
step:720/1750 train_loss:3.8679 train_time:250136ms step_avg:352.30ms
step:721/1750 train_loss:3.4792 train_time:250501ms step_avg:352.32ms
step:722/1750 train_loss:3.7453 train_time:250865ms step_avg:352.34ms
step:723/1750 train_loss:3.7840 train_time:251229ms step_avg:352.36ms
step:724/1750 train_loss:3.5777 train_time:251596ms step_avg:352.38ms
step:725/1750 train_loss:3.6592 train_time:251961ms step_avg:352.39ms
step:726/1750 train_loss:3.5503 train_time:252329ms step_avg:352.41ms
step:727/1750 train_loss:3.5842 train_time:252698ms step_avg:352.44ms
step:728/1750 train_loss:3.7502 train_time:253066ms step_avg:352.46ms
step:729/1750 train_loss:3.6803 train_time:253433ms step_avg:352.48ms
step:730/1750 train_loss:3.6730 train_time:253800ms step_avg:352.50ms
step:731/1750 train_loss:3.5723 train_time:254164ms step_avg:352.52ms
step:732/1750 train_loss:3.6107 train_time:254527ms step_avg:352.53ms
step:733/1750 train_loss:3.8490 train_time:254897ms step_avg:352.55ms
step:734/1750 train_loss:3.5743 train_time:255267ms step_avg:352.58ms
step:735/1750 train_loss:3.6216 train_time:255632ms step_avg:352.60ms
step:736/1750 train_loss:3.7516 train_time:255997ms step_avg:352.61ms
step:737/1750 train_loss:3.6882 train_time:256358ms step_avg:352.62ms
step:738/1750 train_loss:3.6132 train_time:256721ms step_avg:352.64ms
step:739/1750 train_loss:3.5205 train_time:257088ms step_avg:352.66ms
step:740/1750 train_loss:4.1242 train_time:257463ms step_avg:352.69ms
step:741/1750 train_loss:3.5026 train_time:257828ms step_avg:352.71ms
step:742/1750 train_loss:3.5656 train_time:258190ms step_avg:352.72ms
step:743/1750 train_loss:3.5932 train_time:258554ms step_avg:352.73ms
step:744/1750 train_loss:3.6586 train_time:258921ms step_avg:352.75ms
step:745/1750 train_loss:3.6033 train_time:259289ms step_avg:352.77ms
step:746/1750 train_loss:3.6079 train_time:259652ms step_avg:352.79ms
step:747/1750 train_loss:3.6595 train_time:260023ms step_avg:352.81ms
step:748/1750 train_loss:3.5860 train_time:260397ms step_avg:352.84ms
step:749/1750 train_loss:3.5759 train_time:260762ms step_avg:352.86ms
step:750/1750 train_loss:3.6206 train_time:261126ms step_avg:352.87ms
step:750/1750 val_loss:3.5797 train_time:261221ms step_avg:353.00ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 241.63152 | frobenius_norm = 55559.84375 | spectral_norm = 9828.63965 | nuclear_norm = 1390023.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 138.55316 | spectral_norm = 22.36501 | nuclear_norm = 3207.25098
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 133.50471 | spectral_norm = 24.12128 | nuclear_norm = 3069.19580
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 254.75024 | spectral_norm = 16.20001 | nuclear_norm = 6156.53857
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 206.66394 | spectral_norm = 19.61275 | nuclear_norm = 4823.25000
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 289.40094 | spectral_norm = 23.67352 | nuclear_norm = 7695.25537
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 150.11887 | spectral_norm = 12.75154 | nuclear_norm = 3982.65454
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 137.50165 | spectral_norm = 13.26665 | nuclear_norm = 3188.88281
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 136.68506 | spectral_norm = 14.16685 | nuclear_norm = 3174.58301
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 244.24657 | spectral_norm = 22.36609 | nuclear_norm = 5647.53320
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 244.37624 | spectral_norm = 19.02369 | nuclear_norm = 5733.53223
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 295.22263 | spectral_norm = 21.42333 | nuclear_norm = 7855.31494
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 147.66496 | spectral_norm = 14.70226 | nuclear_norm = 3890.79858
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 137.34331 | spectral_norm = 13.36604 | nuclear_norm = 3184.18555
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 134.93257 | spectral_norm = 12.68184 | nuclear_norm = 3131.99072
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 258.82001 | spectral_norm = 22.20940 | nuclear_norm = 5936.73926
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 258.21469 | spectral_norm = 19.84985 | nuclear_norm = 6042.62305
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 297.01578 | spectral_norm = 22.86114 | nuclear_norm = 7904.85449
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 151.26186 | spectral_norm = 14.29202 | nuclear_norm = 3988.20557
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 133.61215 | spectral_norm = 12.34631 | nuclear_norm = 3009.53174
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 132.84148 | spectral_norm = 11.47939 | nuclear_norm = 3001.03760
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 259.72501 | spectral_norm = 24.09846 | nuclear_norm = 5887.31104
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 265.87540 | spectral_norm = 21.13954 | nuclear_norm = 6228.77002
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 301.38550 | spectral_norm = 24.22482 | nuclear_norm = 8029.45312
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 146.94270 | spectral_norm = 13.33434 | nuclear_norm = 3861.09839
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 134.18236 | spectral_norm = 14.06884 | nuclear_norm = 3092.26807
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 132.31160 | spectral_norm = 13.21961 | nuclear_norm = 3070.62500
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 258.12936 | spectral_norm = 21.85711 | nuclear_norm = 5848.57715
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 261.29813 | spectral_norm = 21.45223 | nuclear_norm = 6041.69141
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 307.13730 | spectral_norm = 22.39040 | nuclear_norm = 8164.34326
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 151.54523 | spectral_norm = 13.82540 | nuclear_norm = 3989.73608
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 135.16881 | spectral_norm = 11.83515 | nuclear_norm = 3099.01758
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 134.30681 | spectral_norm = 11.99941 | nuclear_norm = 3082.18066
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 265.44229 | spectral_norm = 25.43430 | nuclear_norm = 5985.19678
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 246.85451 | spectral_norm = 18.27779 | nuclear_norm = 5840.10791
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 321.07111 | spectral_norm = 22.25550 | nuclear_norm = 8559.48438
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 153.80266 | spectral_norm = 13.44177 | nuclear_norm = 4048.77539
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 131.59792 | spectral_norm = 13.44369 | nuclear_norm = 3000.55225
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 130.11447 | spectral_norm = 12.53735 | nuclear_norm = 2986.87500
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 268.28726 | spectral_norm = 22.71373 | nuclear_norm = 6136.37598
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 268.67657 | spectral_norm = 20.21729 | nuclear_norm = 6287.09424
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 303.18835 | spectral_norm = 22.54548 | nuclear_norm = 8077.15039
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 149.03824 | spectral_norm = 13.58073 | nuclear_norm = 3920.76514
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 132.21968 | spectral_norm = 13.18919 | nuclear_norm = 3018.61401
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 130.59779 | spectral_norm = 12.67226 | nuclear_norm = 3002.08838
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 259.40588 | spectral_norm = 21.00423 | nuclear_norm = 5915.15820
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 254.02956 | spectral_norm = 20.70221 | nuclear_norm = 5842.17090
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 312.00735 | spectral_norm = 23.79145 | nuclear_norm = 8289.90430
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 152.24698 | spectral_norm = 14.18492 | nuclear_norm = 4014.38232
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 134.18893 | spectral_norm = 13.99949 | nuclear_norm = 2988.57031
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 135.08904 | spectral_norm = 12.54821 | nuclear_norm = 2972.10596
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 293.98538 | spectral_norm = 27.29566 | nuclear_norm = 6706.65332
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 289.86047 | spectral_norm = 19.51221 | nuclear_norm = 6875.77637
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 295.21310 | spectral_norm = 24.17214 | nuclear_norm = 7849.62695
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 152.35574 | spectral_norm = 14.63999 | nuclear_norm = 4042.58057
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 138.83220 | spectral_norm = 13.75325 | nuclear_norm = 3153.22803
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 136.75276 | spectral_norm = 13.93458 | nuclear_norm = 3094.11670
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 287.19351 | spectral_norm = 25.03660 | nuclear_norm = 6605.21143
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 272.85815 | spectral_norm = 18.95307 | nuclear_norm = 6450.68945
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 301.91782 | spectral_norm = 24.37155 | nuclear_norm = 8029.83887
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 152.69604 | spectral_norm = 15.24113 | nuclear_norm = 4050.19092
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 136.68935 | spectral_norm = 14.48284 | nuclear_norm = 3069.21094
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 135.67636 | spectral_norm = 13.64767 | nuclear_norm = 3037.10010
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 261.77493 | spectral_norm = 24.75830 | nuclear_norm = 5938.47852
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 277.19434 | spectral_norm = 20.02897 | nuclear_norm = 6514.25781
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 315.74826 | spectral_norm = 23.29334 | nuclear_norm = 8417.39258
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 149.67871 | spectral_norm = 16.72771 | nuclear_norm = 3962.27832
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 139.63664 | spectral_norm = 16.08617 | nuclear_norm = 3168.22534
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 135.67093 | spectral_norm = 15.04763 | nuclear_norm = 3066.95483
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 259.31604 | spectral_norm = 24.84484 | nuclear_norm = 5957.00000
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 281.89130 | spectral_norm = 20.52086 | nuclear_norm = 6606.76123
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 323.00403 | spectral_norm = 24.24223 | nuclear_norm = 8599.90332
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 154.87784 | spectral_norm = 17.21386 | nuclear_norm = 4076.02539
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1010.72662 | spectral_norm = 171.44992 | nuclear_norm = 26286.66016
===========================================
step:751/1750 train_loss:3.5789 train_time:261488ms step_avg:352.89ms
step:752/1750 train_loss:3.6302 train_time:261847ms step_avg:352.89ms
step:753/1750 train_loss:3.6377 train_time:262211ms step_avg:352.91ms
step:754/1750 train_loss:3.6063 train_time:262576ms step_avg:352.92ms
step:755/1750 train_loss:3.6950 train_time:262989ms step_avg:353.01ms
step:756/1750 train_loss:3.4807 train_time:263436ms step_avg:353.13ms
step:757/1750 train_loss:3.7381 train_time:263802ms step_avg:353.15ms
step:758/1750 train_loss:3.6660 train_time:264165ms step_avg:353.16ms
step:759/1750 train_loss:3.6033 train_time:264649ms step_avg:353.34ms
step:760/1750 train_loss:3.7153 train_time:265044ms step_avg:353.39ms
step:761/1750 train_loss:3.4159 train_time:265410ms step_avg:353.41ms
step:762/1750 train_loss:3.5635 train_time:265775ms step_avg:353.42ms
step:763/1750 train_loss:3.6858 train_time:266139ms step_avg:353.44ms
step:764/1750 train_loss:3.3275 train_time:266504ms step_avg:353.45ms
step:765/1750 train_loss:3.7481 train_time:266871ms step_avg:353.47ms
step:766/1750 train_loss:3.5886 train_time:267241ms step_avg:353.49ms
step:767/1750 train_loss:3.5791 train_time:267604ms step_avg:353.51ms
step:768/1750 train_loss:3.5946 train_time:267972ms step_avg:353.52ms
step:769/1750 train_loss:3.6029 train_time:268340ms step_avg:353.54ms
step:770/1750 train_loss:3.6575 train_time:268705ms step_avg:353.56ms
step:771/1750 train_loss:3.8943 train_time:269069ms step_avg:353.57ms
step:772/1750 train_loss:3.4645 train_time:269432ms step_avg:353.59ms
step:773/1750 train_loss:3.6480 train_time:269795ms step_avg:353.60ms
step:774/1750 train_loss:3.6638 train_time:270157ms step_avg:353.61ms
step:775/1750 train_loss:3.6208 train_time:270520ms step_avg:353.62ms
step:776/1750 train_loss:3.4164 train_time:270887ms step_avg:353.64ms
step:777/1750 train_loss:3.4104 train_time:271254ms step_avg:353.66ms
step:778/1750 train_loss:3.5005 train_time:271616ms step_avg:353.67ms
step:779/1750 train_loss:3.5967 train_time:271986ms step_avg:353.69ms
step:780/1750 train_loss:3.6034 train_time:272359ms step_avg:353.71ms
step:781/1750 train_loss:3.6837 train_time:272728ms step_avg:353.73ms
step:782/1750 train_loss:3.6036 train_time:273099ms step_avg:353.75ms
step:783/1750 train_loss:3.5851 train_time:273468ms step_avg:353.77ms
step:784/1750 train_loss:3.6100 train_time:273842ms step_avg:353.80ms
step:785/1750 train_loss:3.5813 train_time:274209ms step_avg:353.82ms
step:786/1750 train_loss:3.4517 train_time:274579ms step_avg:353.84ms
step:787/1750 train_loss:3.7801 train_time:274953ms step_avg:353.86ms
step:788/1750 train_loss:3.5034 train_time:275328ms step_avg:353.89ms
step:789/1750 train_loss:3.5682 train_time:275696ms step_avg:353.91ms
step:790/1750 train_loss:3.6378 train_time:276071ms step_avg:353.94ms
step:791/1750 train_loss:3.7893 train_time:276447ms step_avg:353.96ms
step:792/1750 train_loss:3.7783 train_time:276816ms step_avg:353.98ms
step:793/1750 train_loss:3.4913 train_time:277182ms step_avg:354.00ms
step:794/1750 train_loss:3.6103 train_time:277553ms step_avg:354.02ms
step:795/1750 train_loss:3.6853 train_time:277926ms step_avg:354.05ms
step:796/1750 train_loss:3.7327 train_time:278303ms step_avg:354.07ms
step:797/1750 train_loss:3.5343 train_time:278674ms step_avg:354.10ms
step:798/1750 train_loss:3.6588 train_time:279051ms step_avg:354.13ms
step:799/1750 train_loss:3.5585 train_time:279431ms step_avg:354.16ms
step:800/1750 train_loss:3.5414 train_time:279804ms step_avg:354.18ms
step:801/1750 train_loss:3.6480 train_time:280172ms step_avg:354.20ms
step:802/1750 train_loss:3.5062 train_time:280546ms step_avg:354.22ms
step:803/1750 train_loss:3.5193 train_time:280913ms step_avg:354.24ms
step:804/1750 train_loss:3.6393 train_time:281285ms step_avg:354.26ms
step:805/1750 train_loss:3.5373 train_time:281660ms step_avg:354.29ms
step:806/1750 train_loss:3.5721 train_time:282027ms step_avg:354.31ms
step:807/1750 train_loss:3.6622 train_time:282398ms step_avg:354.33ms
step:808/1750 train_loss:3.5651 train_time:282769ms step_avg:354.35ms
step:809/1750 train_loss:3.5086 train_time:283137ms step_avg:354.36ms
step:810/1750 train_loss:3.5821 train_time:283504ms step_avg:354.38ms
step:811/1750 train_loss:3.6017 train_time:283874ms step_avg:354.40ms
step:812/1750 train_loss:3.6147 train_time:284240ms step_avg:354.41ms
step:813/1750 train_loss:3.6409 train_time:284605ms step_avg:354.43ms
step:814/1750 train_loss:3.5874 train_time:284976ms step_avg:354.45ms
step:815/1750 train_loss:3.5810 train_time:285347ms step_avg:354.47ms
step:816/1750 train_loss:3.7010 train_time:285722ms step_avg:354.49ms
step:817/1750 train_loss:3.7882 train_time:286091ms step_avg:354.51ms
step:818/1750 train_loss:3.5391 train_time:286460ms step_avg:354.53ms
step:819/1750 train_loss:3.7396 train_time:286835ms step_avg:354.55ms
step:820/1750 train_loss:3.5168 train_time:287208ms step_avg:354.58ms
step:821/1750 train_loss:3.5733 train_time:287578ms step_avg:354.60ms
step:822/1750 train_loss:3.7069 train_time:287950ms step_avg:354.62ms
step:823/1750 train_loss:3.5944 train_time:288323ms step_avg:354.64ms
step:824/1750 train_loss:3.5231 train_time:288694ms step_avg:354.66ms
step:825/1750 train_loss:3.6306 train_time:289068ms step_avg:354.69ms
step:826/1750 train_loss:3.4923 train_time:289443ms step_avg:354.71ms
step:827/1750 train_loss:3.7505 train_time:289815ms step_avg:354.73ms
step:828/1750 train_loss:3.6387 train_time:290188ms step_avg:354.75ms
step:829/1750 train_loss:3.6556 train_time:290562ms step_avg:354.78ms
step:830/1750 train_loss:3.5451 train_time:290933ms step_avg:354.80ms
step:831/1750 train_loss:3.6099 train_time:291300ms step_avg:354.81ms
step:832/1750 train_loss:3.5266 train_time:291669ms step_avg:354.83ms
step:833/1750 train_loss:3.6690 train_time:292040ms step_avg:354.85ms
step:834/1750 train_loss:3.4916 train_time:292413ms step_avg:354.87ms
step:835/1750 train_loss:3.4727 train_time:292787ms step_avg:354.89ms
step:836/1750 train_loss:3.7379 train_time:293164ms step_avg:354.92ms
step:837/1750 train_loss:3.4162 train_time:293536ms step_avg:354.94ms
step:838/1750 train_loss:3.6045 train_time:293904ms step_avg:354.96ms
step:839/1750 train_loss:3.4326 train_time:294274ms step_avg:354.97ms
step:840/1750 train_loss:3.4857 train_time:294643ms step_avg:354.99ms
step:841/1750 train_loss:3.5755 train_time:295015ms step_avg:355.01ms
step:842/1750 train_loss:3.5955 train_time:295388ms step_avg:355.03ms
step:843/1750 train_loss:3.5829 train_time:295756ms step_avg:355.05ms
step:844/1750 train_loss:3.4495 train_time:296128ms step_avg:355.07ms
step:845/1750 train_loss:3.6740 train_time:296497ms step_avg:355.09ms
step:846/1750 train_loss:3.5340 train_time:296867ms step_avg:355.10ms
step:847/1750 train_loss:3.5083 train_time:297240ms step_avg:355.13ms
step:848/1750 train_loss:3.6550 train_time:297612ms step_avg:355.15ms
step:849/1750 train_loss:3.5133 train_time:297983ms step_avg:355.16ms
step:850/1750 train_loss:3.4494 train_time:298354ms step_avg:355.18ms
step:851/1750 train_loss:3.7479 train_time:298724ms step_avg:355.20ms
step:852/1750 train_loss:3.4630 train_time:299090ms step_avg:355.21ms
step:853/1750 train_loss:3.5822 train_time:299458ms step_avg:355.23ms
step:854/1750 train_loss:3.6690 train_time:299830ms step_avg:355.25ms
step:855/1750 train_loss:3.5378 train_time:300197ms step_avg:355.26ms
step:856/1750 train_loss:3.5589 train_time:300564ms step_avg:355.28ms
step:857/1750 train_loss:3.6230 train_time:300937ms step_avg:355.30ms
step:858/1750 train_loss:3.4837 train_time:301312ms step_avg:355.32ms
step:859/1750 train_loss:3.5774 train_time:301682ms step_avg:355.34ms
step:860/1750 train_loss:3.6105 train_time:302047ms step_avg:355.35ms
step:861/1750 train_loss:3.6480 train_time:302424ms step_avg:355.37ms
step:862/1750 train_loss:3.6172 train_time:302802ms step_avg:355.40ms
step:863/1750 train_loss:3.5854 train_time:303175ms step_avg:355.42ms
step:864/1750 train_loss:3.4002 train_time:303547ms step_avg:355.44ms
step:865/1750 train_loss:3.6154 train_time:303913ms step_avg:355.45ms
step:866/1750 train_loss:3.8883 train_time:304288ms step_avg:355.48ms
step:867/1750 train_loss:3.4730 train_time:304656ms step_avg:355.49ms
step:868/1750 train_loss:3.6592 train_time:305024ms step_avg:355.51ms
step:869/1750 train_loss:3.6298 train_time:305397ms step_avg:355.53ms
step:870/1750 train_loss:3.4659 train_time:305767ms step_avg:355.54ms
step:871/1750 train_loss:3.4321 train_time:306135ms step_avg:355.56ms
step:872/1750 train_loss:3.6673 train_time:306505ms step_avg:355.57ms
step:873/1750 train_loss:3.4747 train_time:306872ms step_avg:355.59ms
step:874/1750 train_loss:3.2364 train_time:307249ms step_avg:355.61ms
step:875/1750 train_loss:3.6534 train_time:307618ms step_avg:355.63ms
step:875/1750 val_loss:3.5379 train_time:307715ms step_avg:355.74ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 255.89990 | frobenius_norm = 58901.66016 | spectral_norm = 10303.46680 | nuclear_norm = 1476916.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 151.96999 | spectral_norm = 25.87087 | nuclear_norm = 3507.35547
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 146.68050 | spectral_norm = 27.96740 | nuclear_norm = 3364.55908
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 277.22284 | spectral_norm = 17.77695 | nuclear_norm = 6718.16748
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 217.96225 | spectral_norm = 21.27496 | nuclear_norm = 5074.49414
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 319.98108 | spectral_norm = 26.66577 | nuclear_norm = 8512.98633
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 165.25797 | spectral_norm = 14.42061 | nuclear_norm = 4383.14355
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 151.44287 | spectral_norm = 14.72130 | nuclear_norm = 3503.90674
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 151.11926 | spectral_norm = 15.21618 | nuclear_norm = 3503.14209
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 264.83087 | spectral_norm = 24.49524 | nuclear_norm = 6120.83496
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 264.55588 | spectral_norm = 20.72912 | nuclear_norm = 6205.88525
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 324.41486 | spectral_norm = 23.50006 | nuclear_norm = 8636.37109
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 162.24100 | spectral_norm = 16.60101 | nuclear_norm = 4273.43115
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 151.26088 | spectral_norm = 15.20986 | nuclear_norm = 3497.82080
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 148.66061 | spectral_norm = 14.08253 | nuclear_norm = 3445.48022
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 281.71603 | spectral_norm = 24.27532 | nuclear_norm = 6457.01660
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 280.95474 | spectral_norm = 21.45395 | nuclear_norm = 6576.42139
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 326.05002 | spectral_norm = 25.95917 | nuclear_norm = 8679.97949
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 166.26544 | spectral_norm = 16.03657 | nuclear_norm = 4382.51270
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 146.70711 | spectral_norm = 13.62688 | nuclear_norm = 3287.55151
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 145.87164 | spectral_norm = 12.78524 | nuclear_norm = 3282.77344
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 284.53992 | spectral_norm = 26.57867 | nuclear_norm = 6445.35645
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 290.66946 | spectral_norm = 23.35534 | nuclear_norm = 6809.70605
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 331.17548 | spectral_norm = 27.43319 | nuclear_norm = 8824.64062
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 161.24094 | spectral_norm = 14.87556 | nuclear_norm = 4236.13965
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 147.55075 | spectral_norm = 15.79380 | nuclear_norm = 3388.65918
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 145.54016 | spectral_norm = 14.66998 | nuclear_norm = 3369.82617
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 283.65231 | spectral_norm = 24.16665 | nuclear_norm = 6425.93506
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 286.37000 | spectral_norm = 23.48143 | nuclear_norm = 6619.31445
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 336.31827 | spectral_norm = 25.13598 | nuclear_norm = 8940.85156
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 166.29652 | spectral_norm = 15.40443 | nuclear_norm = 4377.33984
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 148.32875 | spectral_norm = 13.25311 | nuclear_norm = 3390.02539
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 147.35617 | spectral_norm = 13.40504 | nuclear_norm = 3370.47852
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 292.39850 | spectral_norm = 28.04906 | nuclear_norm = 6581.78271
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 268.85745 | spectral_norm = 19.77250 | nuclear_norm = 6369.51465
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 354.42395 | spectral_norm = 24.62276 | nuclear_norm = 9452.74121
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 169.66516 | spectral_norm = 15.05233 | nuclear_norm = 4467.26074
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 144.62378 | spectral_norm = 15.09490 | nuclear_norm = 3284.02979
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 143.05916 | spectral_norm = 13.97785 | nuclear_norm = 3276.26416
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 295.21561 | spectral_norm = 24.82380 | nuclear_norm = 6756.24756
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 294.62363 | spectral_norm = 22.13833 | nuclear_norm = 6891.05078
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 333.03888 | spectral_norm = 25.22162 | nuclear_norm = 8876.10742
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 163.61612 | spectral_norm = 15.36879 | nuclear_norm = 4304.48486
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 145.27979 | spectral_norm = 14.82696 | nuclear_norm = 3303.18164
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 143.51743 | spectral_norm = 14.09246 | nuclear_norm = 3291.33252
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 283.70450 | spectral_norm = 23.17797 | nuclear_norm = 6474.70605
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 276.62436 | spectral_norm = 22.61353 | nuclear_norm = 6350.57715
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 343.73264 | spectral_norm = 26.42361 | nuclear_norm = 9131.36328
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 167.37503 | spectral_norm = 16.35858 | nuclear_norm = 4411.08838
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 147.45198 | spectral_norm = 15.56061 | nuclear_norm = 3266.17041
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 148.65298 | spectral_norm = 13.97195 | nuclear_norm = 3249.69727
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 319.89828 | spectral_norm = 30.62423 | nuclear_norm = 7276.88574
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 315.65710 | spectral_norm = 21.38562 | nuclear_norm = 7486.42969
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 324.73721 | spectral_norm = 27.08864 | nuclear_norm = 8632.36523
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 167.69592 | spectral_norm = 16.66618 | nuclear_norm = 4449.99902
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 152.77335 | spectral_norm = 15.45545 | nuclear_norm = 3455.55859
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 150.56700 | spectral_norm = 15.62294 | nuclear_norm = 3391.96582
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 313.78796 | spectral_norm = 28.45722 | nuclear_norm = 7202.95508
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 297.71982 | spectral_norm = 20.57351 | nuclear_norm = 7037.30957
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 332.91077 | spectral_norm = 27.52645 | nuclear_norm = 8850.79590
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 168.54863 | spectral_norm = 17.21063 | nuclear_norm = 4472.01562
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 150.36104 | spectral_norm = 16.39320 | nuclear_norm = 3358.53467
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 149.32748 | spectral_norm = 15.31710 | nuclear_norm = 3323.25928
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 286.25256 | spectral_norm = 27.98372 | nuclear_norm = 6475.49951
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 302.80841 | spectral_norm = 22.09665 | nuclear_norm = 7109.24756
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 348.40903 | spectral_norm = 26.01387 | nuclear_norm = 9287.54883
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 165.04443 | spectral_norm = 19.25270 | nuclear_norm = 4368.97754
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 153.81676 | spectral_norm = 18.16662 | nuclear_norm = 3473.12744
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 149.13937 | spectral_norm = 16.94432 | nuclear_norm = 3357.37256
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 285.35565 | spectral_norm = 27.80359 | nuclear_norm = 6543.90332
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 309.06775 | spectral_norm = 22.36359 | nuclear_norm = 7238.34473
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 357.06207 | spectral_norm = 27.04989 | nuclear_norm = 9504.43457
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 170.40857 | spectral_norm = 19.64107 | nuclear_norm = 4481.80371
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1094.78833 | spectral_norm = 172.35539 | nuclear_norm = 28590.46875
===========================================
step:876/1750 train_loss:3.4558 train_time:307978ms step_avg:355.63ms
step:877/1750 train_loss:3.6337 train_time:308338ms step_avg:355.64ms
step:878/1750 train_loss:3.4824 train_time:308704ms step_avg:355.65ms
step:879/1750 train_loss:3.6631 train_time:309073ms step_avg:355.66ms
step:880/1750 train_loss:3.3249 train_time:309438ms step_avg:355.68ms
step:881/1750 train_loss:3.5016 train_time:309805ms step_avg:355.69ms
step:882/1750 train_loss:3.7132 train_time:310174ms step_avg:355.70ms
step:883/1750 train_loss:3.8571 train_time:310541ms step_avg:355.72ms
step:884/1750 train_loss:3.5844 train_time:310911ms step_avg:355.73ms
step:885/1750 train_loss:3.5093 train_time:311282ms step_avg:355.75ms
step:886/1750 train_loss:3.5898 train_time:311651ms step_avg:355.77ms
step:887/1750 train_loss:4.1132 train_time:312020ms step_avg:355.78ms
step:888/1750 train_loss:3.8492 train_time:312399ms step_avg:355.81ms
step:889/1750 train_loss:3.5444 train_time:312769ms step_avg:355.82ms
step:890/1750 train_loss:3.5491 train_time:313134ms step_avg:355.83ms
step:891/1750 train_loss:3.3822 train_time:313503ms step_avg:355.85ms
step:892/1750 train_loss:3.7349 train_time:313872ms step_avg:355.86ms
step:893/1750 train_loss:3.4450 train_time:314238ms step_avg:355.88ms
step:894/1750 train_loss:3.6555 train_time:314612ms step_avg:355.90ms
step:895/1750 train_loss:3.7003 train_time:314983ms step_avg:355.91ms
step:896/1750 train_loss:3.5217 train_time:315352ms step_avg:355.93ms
step:897/1750 train_loss:3.5576 train_time:315723ms step_avg:355.94ms
step:898/1750 train_loss:3.6118 train_time:316092ms step_avg:355.96ms
step:899/1750 train_loss:3.5010 train_time:316459ms step_avg:355.97ms
step:900/1750 train_loss:3.4338 train_time:316832ms step_avg:355.99ms
step:901/1750 train_loss:3.6386 train_time:317198ms step_avg:356.00ms
step:902/1750 train_loss:3.6534 train_time:317566ms step_avg:356.02ms
step:903/1750 train_loss:3.5518 train_time:317939ms step_avg:356.03ms
step:904/1750 train_loss:3.5188 train_time:318310ms step_avg:356.05ms
step:905/1750 train_loss:3.5234 train_time:318675ms step_avg:356.06ms
step:906/1750 train_loss:3.7283 train_time:319048ms step_avg:356.08ms
step:907/1750 train_loss:3.5257 train_time:319420ms step_avg:356.10ms
step:908/1750 train_loss:3.5874 train_time:319788ms step_avg:356.11ms
step:909/1750 train_loss:3.4701 train_time:320168ms step_avg:356.14ms
step:910/1750 train_loss:3.5445 train_time:320553ms step_avg:356.17ms
step:911/1750 train_loss:3.6638 train_time:320925ms step_avg:356.19ms
step:912/1750 train_loss:3.6136 train_time:321302ms step_avg:356.21ms
step:913/1750 train_loss:3.4758 train_time:321682ms step_avg:356.24ms
step:914/1750 train_loss:3.7650 train_time:322063ms step_avg:356.26ms
step:915/1750 train_loss:3.5504 train_time:322444ms step_avg:356.29ms
step:916/1750 train_loss:3.6427 train_time:322821ms step_avg:356.31ms
step:917/1750 train_loss:3.6193 train_time:323197ms step_avg:356.34ms
step:918/1750 train_loss:4.8334 train_time:323580ms step_avg:356.37ms
step:919/1750 train_loss:3.5066 train_time:323962ms step_avg:356.39ms
step:920/1750 train_loss:3.6010 train_time:324334ms step_avg:356.41ms
step:921/1750 train_loss:3.5635 train_time:324713ms step_avg:356.44ms
step:922/1750 train_loss:3.6025 train_time:325094ms step_avg:356.46ms
step:923/1750 train_loss:3.6295 train_time:325465ms step_avg:356.48ms
step:924/1750 train_loss:3.6950 train_time:325841ms step_avg:356.50ms
step:925/1750 train_loss:3.6675 train_time:326216ms step_avg:356.52ms
step:926/1750 train_loss:3.5748 train_time:326588ms step_avg:356.54ms
step:927/1750 train_loss:3.5712 train_time:326959ms step_avg:356.55ms
step:928/1750 train_loss:3.7949 train_time:327336ms step_avg:356.57ms
step:929/1750 train_loss:3.6262 train_time:327712ms step_avg:356.60ms
step:930/1750 train_loss:3.4216 train_time:328089ms step_avg:356.62ms
step:931/1750 train_loss:3.5160 train_time:328458ms step_avg:356.63ms
step:932/1750 train_loss:3.6699 train_time:328834ms step_avg:356.65ms
step:933/1750 train_loss:3.4146 train_time:329210ms step_avg:356.67ms
step:934/1750 train_loss:3.6037 train_time:329587ms step_avg:356.70ms
step:935/1750 train_loss:3.4626 train_time:329965ms step_avg:356.72ms
step:936/1750 train_loss:3.5368 train_time:330343ms step_avg:356.74ms
step:937/1750 train_loss:3.6413 train_time:330723ms step_avg:356.77ms
step:938/1750 train_loss:3.5609 train_time:331096ms step_avg:356.78ms
step:939/1750 train_loss:3.6862 train_time:331481ms step_avg:356.81ms
step:940/1750 train_loss:3.4966 train_time:331857ms step_avg:356.84ms
step:941/1750 train_loss:3.5645 train_time:332230ms step_avg:356.85ms
step:942/1750 train_loss:3.3764 train_time:332604ms step_avg:356.87ms
step:943/1750 train_loss:3.7324 train_time:332985ms step_avg:356.90ms
step:944/1750 train_loss:3.4269 train_time:333392ms step_avg:356.95ms
step:945/1750 train_loss:3.4419 train_time:333878ms step_avg:357.09ms
step:946/1750 train_loss:5.0995 train_time:334261ms step_avg:357.12ms
step:947/1750 train_loss:3.6156 train_time:334638ms step_avg:357.14ms
step:948/1750 train_loss:3.5025 train_time:335012ms step_avg:357.16ms
step:949/1750 train_loss:3.3991 train_time:335517ms step_avg:357.31ms
step:950/1750 train_loss:3.4539 train_time:335910ms step_avg:357.35ms
step:951/1750 train_loss:3.4240 train_time:336288ms step_avg:357.37ms
step:952/1750 train_loss:3.4982 train_time:336661ms step_avg:357.39ms
step:953/1750 train_loss:3.5896 train_time:337041ms step_avg:357.41ms
step:954/1750 train_loss:3.4625 train_time:337424ms step_avg:357.44ms
step:955/1750 train_loss:3.4980 train_time:337793ms step_avg:357.45ms
step:956/1750 train_loss:3.4640 train_time:338169ms step_avg:357.47ms
step:957/1750 train_loss:3.5206 train_time:338555ms step_avg:357.50ms
step:958/1750 train_loss:3.5272 train_time:338938ms step_avg:357.53ms
step:959/1750 train_loss:3.5309 train_time:339312ms step_avg:357.55ms
step:960/1750 train_loss:3.4262 train_time:339687ms step_avg:357.57ms
step:961/1750 train_loss:3.6683 train_time:340062ms step_avg:357.58ms
step:962/1750 train_loss:3.6264 train_time:340434ms step_avg:357.60ms
step:963/1750 train_loss:3.7632 train_time:340812ms step_avg:357.62ms
step:964/1750 train_loss:3.4497 train_time:341191ms step_avg:357.64ms
step:965/1750 train_loss:3.5007 train_time:341561ms step_avg:357.66ms
step:966/1750 train_loss:3.7349 train_time:341933ms step_avg:357.67ms
step:967/1750 train_loss:3.5433 train_time:342305ms step_avg:357.69ms
step:968/1750 train_loss:3.5507 train_time:342680ms step_avg:357.70ms
step:969/1750 train_loss:3.6088 train_time:343057ms step_avg:357.72ms
step:970/1750 train_loss:3.3965 train_time:343431ms step_avg:357.74ms
step:971/1750 train_loss:3.5641 train_time:343804ms step_avg:357.76ms
step:972/1750 train_loss:3.5052 train_time:344175ms step_avg:357.77ms
step:973/1750 train_loss:3.5612 train_time:344547ms step_avg:357.78ms
step:974/1750 train_loss:3.6164 train_time:344922ms step_avg:357.80ms
step:975/1750 train_loss:3.5009 train_time:345295ms step_avg:357.82ms
step:976/1750 train_loss:3.6948 train_time:345666ms step_avg:357.83ms
step:977/1750 train_loss:3.5993 train_time:346037ms step_avg:357.85ms
step:978/1750 train_loss:3.3900 train_time:346409ms step_avg:357.86ms
step:979/1750 train_loss:3.6577 train_time:346784ms step_avg:357.88ms
step:980/1750 train_loss:3.4421 train_time:347163ms step_avg:357.90ms
step:981/1750 train_loss:3.6026 train_time:347542ms step_avg:357.92ms
step:982/1750 train_loss:3.5767 train_time:347915ms step_avg:357.94ms
step:983/1750 train_loss:3.5521 train_time:348290ms step_avg:357.95ms
step:984/1750 train_loss:3.5241 train_time:348664ms step_avg:357.97ms
step:985/1750 train_loss:3.6049 train_time:349042ms step_avg:357.99ms
step:986/1750 train_loss:3.4438 train_time:349413ms step_avg:358.01ms
step:987/1750 train_loss:3.5188 train_time:349782ms step_avg:358.02ms
step:988/1750 train_loss:3.5486 train_time:350152ms step_avg:358.03ms
step:989/1750 train_loss:3.4462 train_time:350521ms step_avg:358.04ms
step:990/1750 train_loss:3.6852 train_time:350896ms step_avg:358.06ms
step:991/1750 train_loss:3.4986 train_time:351271ms step_avg:358.07ms
step:992/1750 train_loss:3.4665 train_time:351659ms step_avg:358.11ms
step:993/1750 train_loss:3.5368 train_time:352045ms step_avg:358.13ms
step:994/1750 train_loss:3.6280 train_time:352416ms step_avg:358.15ms
step:995/1750 train_loss:3.5687 train_time:352785ms step_avg:358.16ms
step:996/1750 train_loss:3.4867 train_time:353152ms step_avg:358.17ms
step:997/1750 train_loss:3.8081 train_time:353524ms step_avg:358.18ms
step:998/1750 train_loss:3.4779 train_time:353894ms step_avg:358.19ms
step:999/1750 train_loss:3.6227 train_time:354267ms step_avg:358.21ms
step:1000/1750 train_loss:3.4743 train_time:354645ms step_avg:358.23ms
step:1000/1750 val_loss:3.4997 train_time:354741ms step_avg:358.32ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 268.74133 | frobenius_norm = 61914.27734 | spectral_norm = 10752.43164 | nuclear_norm = 1555412.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 164.29221 | spectral_norm = 29.12265 | nuclear_norm = 3784.00146
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 158.73343 | spectral_norm = 31.43417 | nuclear_norm = 3634.21484
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 298.62363 | spectral_norm = 19.25630 | nuclear_norm = 7254.82373
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 228.12779 | spectral_norm = 22.96926 | nuclear_norm = 5301.40576
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 348.06378 | spectral_norm = 29.42307 | nuclear_norm = 9262.92383
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 179.37274 | spectral_norm = 15.99128 | nuclear_norm = 4757.06982
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 164.35312 | spectral_norm = 16.01658 | nuclear_norm = 3796.78125
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 164.40691 | spectral_norm = 16.16691 | nuclear_norm = 3805.48560
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 284.02216 | spectral_norm = 26.42814 | nuclear_norm = 6559.37305
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 283.49338 | spectral_norm = 22.35822 | nuclear_norm = 6650.56006
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 351.17560 | spectral_norm = 25.43136 | nuclear_norm = 9353.70312
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 175.52579 | spectral_norm = 18.35410 | nuclear_norm = 4621.16895
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 164.04765 | spectral_norm = 16.85219 | nuclear_norm = 3786.45459
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 161.41667 | spectral_norm = 15.37691 | nuclear_norm = 3736.90918
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 303.00882 | spectral_norm = 26.30570 | nuclear_norm = 6939.49316
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 302.18436 | spectral_norm = 23.21275 | nuclear_norm = 7075.33887
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 352.23828 | spectral_norm = 29.03459 | nuclear_norm = 9376.15430
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 179.95224 | spectral_norm = 17.60807 | nuclear_norm = 4741.45361
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 158.73166 | spectral_norm = 14.86233 | nuclear_norm = 3542.40430
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 157.87939 | spectral_norm = 13.86435 | nuclear_norm = 3541.26660
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 307.57285 | spectral_norm = 28.70896 | nuclear_norm = 6962.31201
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 313.56183 | spectral_norm = 25.46292 | nuclear_norm = 7343.62549
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 357.97791 | spectral_norm = 30.64268 | nuclear_norm = 9539.18750
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 174.30821 | spectral_norm = 16.40487 | nuclear_norm = 4578.49121
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 159.83348 | spectral_norm = 17.39281 | nuclear_norm = 3660.21240
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 157.64845 | spectral_norm = 16.05816 | nuclear_norm = 3642.90771
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 307.57449 | spectral_norm = 26.19689 | nuclear_norm = 6970.54541
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 309.92432 | spectral_norm = 25.35123 | nuclear_norm = 7163.34180
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 363.06049 | spectral_norm = 27.86083 | nuclear_norm = 9651.23633
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 179.90091 | spectral_norm = 16.91054 | nuclear_norm = 4735.34521
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 160.31586 | spectral_norm = 14.28240 | nuclear_norm = 3653.86572
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 159.11723 | spectral_norm = 14.63147 | nuclear_norm = 3628.63647
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 317.67569 | spectral_norm = 30.50691 | nuclear_norm = 7142.46094
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 289.08759 | spectral_norm = 20.99764 | nuclear_norm = 6851.17236
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 385.02518 | spectral_norm = 26.72085 | nuclear_norm = 10272.29297
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 184.21725 | spectral_norm = 16.58386 | nuclear_norm = 4851.35352
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 156.72928 | spectral_norm = 16.69061 | nuclear_norm = 3545.87598
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 154.70847 | spectral_norm = 15.32874 | nuclear_norm = 3532.99170
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 320.27838 | spectral_norm = 26.88306 | nuclear_norm = 7336.36816
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 318.65768 | spectral_norm = 23.85690 | nuclear_norm = 7451.05225
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 360.39203 | spectral_norm = 27.78727 | nuclear_norm = 9607.34961
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 177.01213 | spectral_norm = 17.05485 | nuclear_norm = 4656.50195
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 157.34146 | spectral_norm = 16.23637 | nuclear_norm = 3566.38647
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 155.40370 | spectral_norm = 15.48043 | nuclear_norm = 3554.50732
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 306.13821 | spectral_norm = 25.21771 | nuclear_norm = 6988.45020
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 297.33978 | spectral_norm = 24.54953 | nuclear_norm = 6816.40186
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 373.19547 | spectral_norm = 29.20097 | nuclear_norm = 9910.46191
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 181.25169 | spectral_norm = 18.47252 | nuclear_norm = 4773.15918
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 159.63289 | spectral_norm = 17.05142 | nuclear_norm = 3518.60645
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 161.13286 | spectral_norm = 15.18166 | nuclear_norm = 3503.29736
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 344.09332 | spectral_norm = 33.56258 | nuclear_norm = 7805.27539
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 339.79816 | spectral_norm = 23.11268 | nuclear_norm = 8059.68848
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 352.55884 | spectral_norm = 29.91851 | nuclear_norm = 9367.13477
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 181.85707 | spectral_norm = 18.58374 | nuclear_norm = 4825.23145
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 165.62633 | spectral_norm = 17.04971 | nuclear_norm = 3734.79663
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 163.20265 | spectral_norm = 17.36272 | nuclear_norm = 3664.61914
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 338.83884 | spectral_norm = 32.10463 | nuclear_norm = 7766.20215
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 321.23285 | spectral_norm = 22.27795 | nuclear_norm = 7592.85449
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 361.66690 | spectral_norm = 30.34245 | nuclear_norm = 9611.27441
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 183.06206 | spectral_norm = 19.09558 | nuclear_norm = 4857.22461
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 162.82672 | spectral_norm = 18.14244 | nuclear_norm = 3618.91797
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 161.71602 | spectral_norm = 16.91631 | nuclear_norm = 3581.06885
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 309.53635 | spectral_norm = 30.66453 | nuclear_norm = 6984.11670
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 328.02438 | spectral_norm = 23.95999 | nuclear_norm = 7698.34521
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 379.19446 | spectral_norm = 28.79303 | nuclear_norm = 10108.05078
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 179.62848 | spectral_norm = 21.62807 | nuclear_norm = 4754.76465
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 166.76981 | spectral_norm = 20.19572 | nuclear_norm = 3747.87646
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 161.49409 | spectral_norm = 18.72898 | nuclear_norm = 3619.45996
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 309.53418 | spectral_norm = 30.27914 | nuclear_norm = 7090.53369
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 335.81519 | spectral_norm = 24.24671 | nuclear_norm = 7859.87158
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 388.64938 | spectral_norm = 29.75147 | nuclear_norm = 10343.75879
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 184.71733 | spectral_norm = 21.97820 | nuclear_norm = 4854.89014
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1172.22839 | spectral_norm = 172.59157 | nuclear_norm = 30713.41797
===========================================
step:1001/1750 train_loss:3.5344 train_time:355009ms step_avg:358.23ms
step:1002/1750 train_loss:3.4132 train_time:355373ms step_avg:358.24ms
step:1003/1750 train_loss:3.5924 train_time:355750ms step_avg:358.26ms
step:1004/1750 train_loss:3.6411 train_time:356124ms step_avg:358.27ms
step:1005/1750 train_loss:3.4217 train_time:356495ms step_avg:358.29ms
step:1006/1750 train_loss:3.5009 train_time:356869ms step_avg:358.30ms
step:1007/1750 train_loss:3.4703 train_time:357242ms step_avg:358.32ms
step:1008/1750 train_loss:3.5930 train_time:357618ms step_avg:358.33ms
step:1009/1750 train_loss:3.6984 train_time:358000ms step_avg:358.36ms
step:1010/1750 train_loss:3.5930 train_time:358369ms step_avg:358.37ms
step:1011/1750 train_loss:3.5672 train_time:358740ms step_avg:358.38ms
step:1012/1750 train_loss:3.4235 train_time:359110ms step_avg:358.39ms
step:1013/1750 train_loss:3.5680 train_time:359485ms step_avg:358.41ms
step:1014/1750 train_loss:3.6583 train_time:359862ms step_avg:358.43ms
step:1015/1750 train_loss:3.3613 train_time:360239ms step_avg:358.45ms
step:1016/1750 train_loss:3.4482 train_time:360609ms step_avg:358.46ms
step:1017/1750 train_loss:3.4416 train_time:360986ms step_avg:358.48ms
step:1018/1750 train_loss:3.4276 train_time:361363ms step_avg:358.50ms
step:1019/1750 train_loss:3.5550 train_time:361737ms step_avg:358.51ms
step:1020/1750 train_loss:3.4292 train_time:362110ms step_avg:358.53ms
step:1021/1750 train_loss:3.3918 train_time:362481ms step_avg:358.54ms
step:1022/1750 train_loss:3.5132 train_time:362854ms step_avg:358.55ms
step:1023/1750 train_loss:3.5419 train_time:363228ms step_avg:358.57ms
step:1024/1750 train_loss:3.5121 train_time:363601ms step_avg:358.58ms
step:1025/1750 train_loss:3.5171 train_time:363974ms step_avg:358.60ms
step:1026/1750 train_loss:3.6680 train_time:364343ms step_avg:358.61ms
step:1027/1750 train_loss:3.3607 train_time:364711ms step_avg:358.61ms
step:1028/1750 train_loss:3.4293 train_time:365088ms step_avg:358.63ms
step:1029/1750 train_loss:3.3541 train_time:365467ms step_avg:358.65ms
step:1030/1750 train_loss:3.5745 train_time:365839ms step_avg:358.67ms
step:1031/1750 train_loss:3.5514 train_time:366214ms step_avg:358.68ms
step:1032/1750 train_loss:3.7369 train_time:366593ms step_avg:358.70ms
step:1033/1750 train_loss:3.5322 train_time:366962ms step_avg:358.71ms
step:1034/1750 train_loss:3.4493 train_time:367335ms step_avg:358.73ms
step:1035/1750 train_loss:3.4836 train_time:367707ms step_avg:358.74ms
step:1036/1750 train_loss:3.5262 train_time:368078ms step_avg:358.75ms
step:1037/1750 train_loss:3.8276 train_time:368448ms step_avg:358.76ms
step:1038/1750 train_loss:3.6636 train_time:368822ms step_avg:358.78ms
step:1039/1750 train_loss:3.5515 train_time:369202ms step_avg:358.80ms
step:1040/1750 train_loss:3.4504 train_time:369581ms step_avg:358.82ms
step:1041/1750 train_loss:3.5258 train_time:369958ms step_avg:358.83ms
step:1042/1750 train_loss:3.5654 train_time:370328ms step_avg:358.84ms
step:1043/1750 train_loss:3.4822 train_time:370701ms step_avg:358.86ms
step:1044/1750 train_loss:3.4945 train_time:371080ms step_avg:358.88ms
step:1045/1750 train_loss:3.5596 train_time:371458ms step_avg:358.90ms
step:1046/1750 train_loss:3.4689 train_time:371835ms step_avg:358.91ms
step:1047/1750 train_loss:3.6839 train_time:372212ms step_avg:358.93ms
step:1048/1750 train_loss:3.5428 train_time:372592ms step_avg:358.95ms
step:1049/1750 train_loss:3.4442 train_time:372973ms step_avg:358.97ms
step:1050/1750 train_loss:3.4351 train_time:373357ms step_avg:359.00ms
step:1051/1750 train_loss:3.5467 train_time:373740ms step_avg:359.02ms
step:1052/1750 train_loss:3.4005 train_time:374122ms step_avg:359.04ms
step:1053/1750 train_loss:3.7373 train_time:374502ms step_avg:359.06ms
step:1054/1750 train_loss:3.5877 train_time:374883ms step_avg:359.08ms
step:1055/1750 train_loss:3.4203 train_time:375259ms step_avg:359.10ms
step:1056/1750 train_loss:3.5471 train_time:375636ms step_avg:359.12ms
step:1057/1750 train_loss:3.6248 train_time:376017ms step_avg:359.14ms
step:1058/1750 train_loss:3.3505 train_time:376398ms step_avg:359.16ms
step:1059/1750 train_loss:3.4095 train_time:376783ms step_avg:359.18ms
step:1060/1750 train_loss:3.4825 train_time:377161ms step_avg:359.20ms
step:1061/1750 train_loss:3.4677 train_time:377537ms step_avg:359.22ms
step:1062/1750 train_loss:3.4292 train_time:377914ms step_avg:359.23ms
step:1063/1750 train_loss:3.5158 train_time:378288ms step_avg:359.25ms
step:1064/1750 train_loss:3.4277 train_time:378660ms step_avg:359.26ms
step:1065/1750 train_loss:3.4029 train_time:379044ms step_avg:359.28ms
step:1066/1750 train_loss:3.4564 train_time:379427ms step_avg:359.31ms
step:1067/1750 train_loss:3.3245 train_time:379807ms step_avg:359.33ms
step:1068/1750 train_loss:3.4767 train_time:380188ms step_avg:359.35ms
step:1069/1750 train_loss:3.3528 train_time:380576ms step_avg:359.37ms
step:1070/1750 train_loss:3.6130 train_time:380953ms step_avg:359.39ms
step:1071/1750 train_loss:3.5580 train_time:381336ms step_avg:359.41ms
step:1072/1750 train_loss:3.4904 train_time:381708ms step_avg:359.42ms
step:1073/1750 train_loss:3.5768 train_time:382079ms step_avg:359.43ms
step:1074/1750 train_loss:3.4879 train_time:382456ms step_avg:359.45ms
step:1075/1750 train_loss:3.4441 train_time:382833ms step_avg:359.47ms
step:1076/1750 train_loss:3.8428 train_time:383206ms step_avg:359.48ms
step:1077/1750 train_loss:3.4877 train_time:383582ms step_avg:359.50ms
step:1078/1750 train_loss:3.1404 train_time:383979ms step_avg:359.53ms
step:1079/1750 train_loss:3.5812 train_time:384364ms step_avg:359.55ms
step:1080/1750 train_loss:3.4753 train_time:384744ms step_avg:359.57ms
step:1081/1750 train_loss:3.5622 train_time:385116ms step_avg:359.59ms
step:1082/1750 train_loss:3.6433 train_time:385493ms step_avg:359.60ms
step:1083/1750 train_loss:3.5487 train_time:385867ms step_avg:359.62ms
step:1084/1750 train_loss:3.5222 train_time:386247ms step_avg:359.63ms
step:1085/1750 train_loss:3.4842 train_time:386625ms step_avg:359.65ms
step:1086/1750 train_loss:3.6871 train_time:387006ms step_avg:359.67ms
step:1087/1750 train_loss:3.5694 train_time:387385ms step_avg:359.69ms
step:1088/1750 train_loss:3.4168 train_time:387769ms step_avg:359.71ms
step:1089/1750 train_loss:3.4321 train_time:388160ms step_avg:359.74ms
step:1090/1750 train_loss:3.5414 train_time:388547ms step_avg:359.77ms
step:1091/1750 train_loss:3.3343 train_time:388929ms step_avg:359.79ms
step:1092/1750 train_loss:3.5448 train_time:389313ms step_avg:359.81ms
step:1093/1750 train_loss:3.6625 train_time:389692ms step_avg:359.83ms
step:1094/1750 train_loss:3.4973 train_time:390067ms step_avg:359.84ms
step:1095/1750 train_loss:3.4713 train_time:390448ms step_avg:359.86ms
step:1096/1750 train_loss:3.4821 train_time:390833ms step_avg:359.88ms
step:1097/1750 train_loss:3.5439 train_time:391216ms step_avg:359.90ms
step:1098/1750 train_loss:3.6202 train_time:391594ms step_avg:359.92ms
step:1099/1750 train_loss:3.5783 train_time:391973ms step_avg:359.94ms
step:1100/1750 train_loss:3.4928 train_time:392362ms step_avg:359.97ms
step:1101/1750 train_loss:3.3431 train_time:392741ms step_avg:359.98ms
step:1102/1750 train_loss:3.3730 train_time:393127ms step_avg:360.01ms
step:1103/1750 train_loss:3.5072 train_time:393512ms step_avg:360.03ms
step:1104/1750 train_loss:3.3691 train_time:393887ms step_avg:360.04ms
step:1105/1750 train_loss:4.1226 train_time:394265ms step_avg:360.06ms
step:1106/1750 train_loss:3.2821 train_time:394640ms step_avg:360.07ms
step:1107/1750 train_loss:3.6223 train_time:395016ms step_avg:360.09ms
step:1108/1750 train_loss:3.3978 train_time:395390ms step_avg:360.10ms
step:1109/1750 train_loss:3.5560 train_time:395766ms step_avg:360.12ms
step:1110/1750 train_loss:3.4901 train_time:396142ms step_avg:360.13ms
step:1111/1750 train_loss:3.5425 train_time:396520ms step_avg:360.15ms
step:1112/1750 train_loss:3.6210 train_time:396905ms step_avg:360.17ms
step:1113/1750 train_loss:3.4940 train_time:397295ms step_avg:360.20ms
step:1114/1750 train_loss:3.4269 train_time:397675ms step_avg:360.21ms
step:1115/1750 train_loss:3.3097 train_time:398054ms step_avg:360.23ms
step:1116/1750 train_loss:3.4812 train_time:398428ms step_avg:360.24ms
step:1117/1750 train_loss:3.6475 train_time:398812ms step_avg:360.26ms
step:1118/1750 train_loss:3.6851 train_time:399194ms step_avg:360.28ms
step:1119/1750 train_loss:3.5419 train_time:399569ms step_avg:360.30ms
step:1120/1750 train_loss:3.5493 train_time:399947ms step_avg:360.31ms
step:1121/1750 train_loss:3.4491 train_time:400327ms step_avg:360.33ms
step:1122/1750 train_loss:3.5172 train_time:400702ms step_avg:360.34ms
step:1123/1750 train_loss:3.6459 train_time:401078ms step_avg:360.36ms
step:1124/1750 train_loss:3.4057 train_time:401457ms step_avg:360.37ms
step:1125/1750 train_loss:3.2799 train_time:401835ms step_avg:360.39ms
step:1125/1750 val_loss:3.4725 train_time:401935ms step_avg:360.48ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 280.47717 | frobenius_norm = 64669.58203 | spectral_norm = 11175.76270 | nuclear_norm = 1627473.62500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 175.62735 | spectral_norm = 32.24902 | nuclear_norm = 4038.36304
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 169.93175 | spectral_norm = 34.76234 | nuclear_norm = 3885.97778
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 317.80334 | spectral_norm = 20.70964 | nuclear_norm = 7736.91992
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 237.50351 | spectral_norm = 24.41405 | nuclear_norm = 5509.49707
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 375.18805 | spectral_norm = 32.25078 | nuclear_norm = 9988.04199
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 192.47839 | spectral_norm = 17.42760 | nuclear_norm = 5104.25391
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 176.41469 | spectral_norm = 17.35902 | nuclear_norm = 4070.41016
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 176.63181 | spectral_norm = 17.06355 | nuclear_norm = 4084.61182
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 302.22977 | spectral_norm = 28.22543 | nuclear_norm = 6976.29297
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 301.41122 | spectral_norm = 23.92875 | nuclear_norm = 7070.53809
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 376.23328 | spectral_norm = 27.41154 | nuclear_norm = 10025.73340
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 188.02612 | spectral_norm = 19.91010 | nuclear_norm = 4949.06152
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 175.79395 | spectral_norm = 18.47777 | nuclear_norm = 4051.24219
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 173.21361 | spectral_norm = 16.57256 | nuclear_norm = 4003.67285
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 323.38864 | spectral_norm = 28.30800 | nuclear_norm = 7401.75781
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 322.48932 | spectral_norm = 24.68946 | nuclear_norm = 7551.22510
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 376.67813 | spectral_norm = 31.86983 | nuclear_norm = 10026.00977
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 192.75284 | spectral_norm = 19.10241 | nuclear_norm = 5077.84766
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 169.88902 | spectral_norm = 16.03886 | nuclear_norm = 3778.90625
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 169.12555 | spectral_norm = 15.00705 | nuclear_norm = 3782.27856
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 329.33585 | spectral_norm = 30.69467 | nuclear_norm = 7451.69775
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 335.35635 | spectral_norm = 27.41409 | nuclear_norm = 7854.00098
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 382.81812 | spectral_norm = 33.52135 | nuclear_norm = 10202.31738
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 186.49661 | spectral_norm = 17.80086 | nuclear_norm = 4898.30273
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 171.21916 | spectral_norm = 18.89827 | nuclear_norm = 3912.82666
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 168.96321 | spectral_norm = 17.26592 | nuclear_norm = 3898.74805
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 330.72025 | spectral_norm = 28.16972 | nuclear_norm = 7495.44971
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 332.44641 | spectral_norm = 27.16880 | nuclear_norm = 7687.26465
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 387.82181 | spectral_norm = 30.48806 | nuclear_norm = 10308.64355
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 192.57936 | spectral_norm = 18.32228 | nuclear_norm = 5068.43164
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 171.44008 | spectral_norm = 15.57352 | nuclear_norm = 3897.97510
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 170.05797 | spectral_norm = 15.80252 | nuclear_norm = 3869.83838
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 341.78653 | spectral_norm = 32.86621 | nuclear_norm = 7677.46240
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 308.05798 | spectral_norm = 22.38750 | nuclear_norm = 7305.52881
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 413.21326 | spectral_norm = 28.79875 | nuclear_norm = 11026.21484
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 197.83542 | spectral_norm = 18.04914 | nuclear_norm = 5211.36523
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 168.10281 | spectral_norm = 18.17036 | nuclear_norm = 3793.77905
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 165.70505 | spectral_norm = 16.61571 | nuclear_norm = 3777.02271
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 343.92426 | spectral_norm = 28.85632 | nuclear_norm = 7882.38818
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 341.17368 | spectral_norm = 25.46502 | nuclear_norm = 7976.56738
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 385.79669 | spectral_norm = 30.37246 | nuclear_norm = 10286.01562
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 189.41785 | spectral_norm = 18.66512 | nuclear_norm = 4982.26465
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 168.70531 | spectral_norm = 17.61098 | nuclear_norm = 3812.52637
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 166.44989 | spectral_norm = 16.81438 | nuclear_norm = 3801.83594
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 327.42178 | spectral_norm = 27.24500 | nuclear_norm = 7478.88379
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 317.00873 | spectral_norm = 26.23260 | nuclear_norm = 7258.91016
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 400.90460 | spectral_norm = 32.01569 | nuclear_norm = 10642.41602
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 194.25777 | spectral_norm = 20.44821 | nuclear_norm = 5112.27930
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 170.85133 | spectral_norm = 18.49848 | nuclear_norm = 3750.73975
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 172.80930 | spectral_norm = 16.39270 | nuclear_norm = 3742.27539
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 366.30948 | spectral_norm = 36.39264 | nuclear_norm = 8291.11816
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 361.85855 | spectral_norm = 24.81290 | nuclear_norm = 8582.32227
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 378.55826 | spectral_norm = 32.77713 | nuclear_norm = 10053.13965
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 195.05594 | spectral_norm = 20.38669 | nuclear_norm = 5174.49609
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 177.75870 | spectral_norm = 18.66642 | nuclear_norm = 3996.86108
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 175.16620 | spectral_norm = 18.78038 | nuclear_norm = 3920.18652
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 362.22339 | spectral_norm = 35.79415 | nuclear_norm = 8289.19727
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 343.05109 | spectral_norm = 24.06678 | nuclear_norm = 8106.17578
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 388.68674 | spectral_norm = 33.06554 | nuclear_norm = 10326.37695
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 196.67357 | spectral_norm = 20.92636 | nuclear_norm = 5218.69287
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 174.49634 | spectral_norm = 19.83775 | nuclear_norm = 3861.13672
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 173.27011 | spectral_norm = 18.40587 | nuclear_norm = 3822.05591
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 331.89163 | spectral_norm = 33.46209 | nuclear_norm = 7474.14746
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 351.74680 | spectral_norm = 25.63635 | nuclear_norm = 8249.42578
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 407.74533 | spectral_norm = 31.32167 | nuclear_norm = 10868.00586
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 193.13339 | spectral_norm = 23.83130 | nuclear_norm = 5111.60596
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 179.23528 | spectral_norm = 22.13240 | nuclear_norm = 4014.74976
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 173.22188 | spectral_norm = 20.43383 | nuclear_norm = 3873.45923
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 333.14493 | spectral_norm = 33.00739 | nuclear_norm = 7623.67969
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 360.18283 | spectral_norm = 25.80503 | nuclear_norm = 8425.65430
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 417.55844 | spectral_norm = 32.01806 | nuclear_norm = 11110.97656
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 197.91765 | spectral_norm = 24.21602 | nuclear_norm = 5198.21680
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1243.32617 | spectral_norm = 171.99477 | nuclear_norm = 32671.22070
===========================================
step:1126/1750 train_loss:3.5358 train_time:402203ms step_avg:360.40ms
step:1127/1750 train_loss:3.7426 train_time:402569ms step_avg:360.40ms
step:1128/1750 train_loss:3.2922 train_time:402944ms step_avg:360.41ms
step:1129/1750 train_loss:3.6242 train_time:403322ms step_avg:360.43ms
step:1130/1750 train_loss:3.4426 train_time:403701ms step_avg:360.45ms
step:1131/1750 train_loss:3.4610 train_time:404087ms step_avg:360.47ms
step:1132/1750 train_loss:3.4246 train_time:404456ms step_avg:360.48ms
step:1133/1750 train_loss:3.5527 train_time:404885ms step_avg:360.54ms
step:1134/1750 train_loss:3.5136 train_time:405330ms step_avg:360.61ms
step:1135/1750 train_loss:3.5821 train_time:405705ms step_avg:360.63ms
step:1136/1750 train_loss:3.6211 train_time:406079ms step_avg:360.64ms
step:1137/1750 train_loss:3.5267 train_time:406453ms step_avg:360.65ms
step:1138/1750 train_loss:3.4142 train_time:406830ms step_avg:360.67ms
step:1139/1750 train_loss:3.7157 train_time:407332ms step_avg:360.79ms
step:1140/1750 train_loss:3.5243 train_time:407729ms step_avg:360.82ms
step:1141/1750 train_loss:3.6580 train_time:408112ms step_avg:360.84ms
step:1142/1750 train_loss:3.5163 train_time:408493ms step_avg:360.86ms
step:1143/1750 train_loss:3.4262 train_time:408876ms step_avg:360.88ms
step:1144/1750 train_loss:3.5096 train_time:409252ms step_avg:360.89ms
step:1145/1750 train_loss:3.6578 train_time:409624ms step_avg:360.90ms
step:1146/1750 train_loss:3.6168 train_time:410004ms step_avg:360.92ms
step:1147/1750 train_loss:3.5518 train_time:410382ms step_avg:360.93ms
step:1148/1750 train_loss:3.5620 train_time:410755ms step_avg:360.94ms
step:1149/1750 train_loss:3.3959 train_time:411131ms step_avg:360.96ms
step:1150/1750 train_loss:3.4301 train_time:411503ms step_avg:360.97ms
step:1151/1750 train_loss:3.3817 train_time:411881ms step_avg:360.98ms
step:1152/1750 train_loss:3.4691 train_time:412263ms step_avg:361.00ms
step:1153/1750 train_loss:3.4961 train_time:412644ms step_avg:361.02ms
step:1154/1750 train_loss:3.5868 train_time:413017ms step_avg:361.03ms
step:1155/1750 train_loss:3.3875 train_time:413398ms step_avg:361.05ms
step:1156/1750 train_loss:3.6034 train_time:413784ms step_avg:361.07ms
step:1157/1750 train_loss:3.5610 train_time:414165ms step_avg:361.09ms
step:1158/1750 train_loss:3.3221 train_time:414541ms step_avg:361.10ms
step:1159/1750 train_loss:3.4066 train_time:414916ms step_avg:361.11ms
step:1160/1750 train_loss:3.3954 train_time:415285ms step_avg:361.12ms
step:1161/1750 train_loss:3.1463 train_time:415664ms step_avg:361.13ms
step:1162/1750 train_loss:3.4843 train_time:416039ms step_avg:361.15ms
step:1163/1750 train_loss:3.4479 train_time:416416ms step_avg:361.16ms
step:1164/1750 train_loss:3.3508 train_time:416791ms step_avg:361.17ms
step:1165/1750 train_loss:3.3158 train_time:417164ms step_avg:361.18ms
step:1166/1750 train_loss:3.4445 train_time:417541ms step_avg:361.19ms
step:1167/1750 train_loss:3.4604 train_time:417915ms step_avg:361.21ms
step:1168/1750 train_loss:3.7860 train_time:418292ms step_avg:361.22ms
step:1169/1750 train_loss:3.4383 train_time:418673ms step_avg:361.24ms
step:1170/1750 train_loss:3.4463 train_time:419055ms step_avg:361.25ms
step:1171/1750 train_loss:3.4126 train_time:419436ms step_avg:361.27ms
step:1172/1750 train_loss:3.4840 train_time:419815ms step_avg:361.29ms
step:1173/1750 train_loss:3.6007 train_time:420205ms step_avg:361.31ms
step:1174/1750 train_loss:3.4452 train_time:420604ms step_avg:361.34ms
step:1175/1750 train_loss:3.4353 train_time:420988ms step_avg:361.36ms
step:1176/1750 train_loss:3.4830 train_time:421383ms step_avg:361.39ms
step:1177/1750 train_loss:3.5147 train_time:421776ms step_avg:361.42ms
step:1178/1750 train_loss:3.5619 train_time:422154ms step_avg:361.43ms
step:1179/1750 train_loss:3.4691 train_time:422536ms step_avg:361.45ms
step:1180/1750 train_loss:3.4171 train_time:422938ms step_avg:361.49ms
step:1181/1750 train_loss:3.3995 train_time:423321ms step_avg:361.50ms
step:1182/1750 train_loss:3.4578 train_time:423703ms step_avg:361.52ms
step:1183/1750 train_loss:3.3946 train_time:424084ms step_avg:361.54ms
step:1184/1750 train_loss:3.5742 train_time:424466ms step_avg:361.56ms
step:1185/1750 train_loss:3.6065 train_time:424854ms step_avg:361.58ms
step:1186/1750 train_loss:3.4211 train_time:425242ms step_avg:361.60ms
step:1187/1750 train_loss:3.4769 train_time:425642ms step_avg:361.63ms
step:1188/1750 train_loss:3.5076 train_time:426020ms step_avg:361.65ms
step:1189/1750 train_loss:3.3381 train_time:426406ms step_avg:361.67ms
step:1190/1750 train_loss:3.5042 train_time:426792ms step_avg:361.69ms
step:1191/1750 train_loss:3.6513 train_time:427183ms step_avg:361.71ms
step:1192/1750 train_loss:3.4612 train_time:427563ms step_avg:361.73ms
step:1193/1750 train_loss:3.3362 train_time:427944ms step_avg:361.74ms
step:1194/1750 train_loss:3.6234 train_time:428326ms step_avg:361.76ms
step:1195/1750 train_loss:3.4384 train_time:428720ms step_avg:361.79ms
step:1196/1750 train_loss:3.4470 train_time:429127ms step_avg:361.83ms
step:1197/1750 train_loss:3.3578 train_time:429516ms step_avg:361.85ms
step:1198/1750 train_loss:3.3663 train_time:429912ms step_avg:361.88ms
step:1199/1750 train_loss:3.4015 train_time:430297ms step_avg:361.90ms
step:1200/1750 train_loss:3.5088 train_time:430682ms step_avg:361.92ms
step:1201/1750 train_loss:3.5445 train_time:431063ms step_avg:361.93ms
step:1202/1750 train_loss:3.7019 train_time:431471ms step_avg:361.97ms
step:1203/1750 train_loss:3.4705 train_time:431862ms step_avg:362.00ms
step:1204/1750 train_loss:3.3700 train_time:432248ms step_avg:362.02ms
step:1205/1750 train_loss:3.4887 train_time:432630ms step_avg:362.03ms
step:1206/1750 train_loss:3.5379 train_time:433010ms step_avg:362.05ms
step:1207/1750 train_loss:3.5863 train_time:433389ms step_avg:362.06ms
step:1208/1750 train_loss:3.4658 train_time:433763ms step_avg:362.07ms
step:1209/1750 train_loss:3.3027 train_time:434150ms step_avg:362.09ms
step:1210/1750 train_loss:3.3679 train_time:434538ms step_avg:362.12ms
step:1211/1750 train_loss:3.4625 train_time:434917ms step_avg:362.13ms
step:1212/1750 train_loss:3.4564 train_time:435296ms step_avg:362.14ms
step:1213/1750 train_loss:3.4833 train_time:435682ms step_avg:362.16ms
step:1214/1750 train_loss:3.3219 train_time:436070ms step_avg:362.18ms
step:1215/1750 train_loss:3.4560 train_time:436449ms step_avg:362.20ms
step:1216/1750 train_loss:3.3934 train_time:436831ms step_avg:362.21ms
step:1217/1750 train_loss:3.3889 train_time:437213ms step_avg:362.23ms
step:1218/1750 train_loss:3.4822 train_time:437599ms step_avg:362.25ms
step:1219/1750 train_loss:3.3278 train_time:437993ms step_avg:362.28ms
step:1220/1750 train_loss:3.5338 train_time:438373ms step_avg:362.29ms
step:1221/1750 train_loss:3.5673 train_time:438753ms step_avg:362.31ms
step:1222/1750 train_loss:3.5066 train_time:439133ms step_avg:362.32ms
step:1223/1750 train_loss:3.3527 train_time:439515ms step_avg:362.34ms
step:1224/1750 train_loss:3.3182 train_time:439904ms step_avg:362.36ms
step:1225/1750 train_loss:3.4343 train_time:440289ms step_avg:362.38ms
step:1226/1750 train_loss:3.3894 train_time:440677ms step_avg:362.40ms
step:1227/1750 train_loss:3.3333 train_time:441063ms step_avg:362.42ms
step:1228/1750 train_loss:3.5083 train_time:441441ms step_avg:362.43ms
step:1229/1750 train_loss:3.4348 train_time:441826ms step_avg:362.45ms
step:1230/1750 train_loss:3.4590 train_time:442220ms step_avg:362.48ms
step:1231/1750 train_loss:3.6415 train_time:442609ms step_avg:362.50ms
step:1232/1750 train_loss:3.5553 train_time:442996ms step_avg:362.52ms
step:1233/1750 train_loss:3.4846 train_time:443372ms step_avg:362.53ms
step:1234/1750 train_loss:3.6513 train_time:443752ms step_avg:362.54ms
step:1235/1750 train_loss:3.3924 train_time:444138ms step_avg:362.56ms
step:1236/1750 train_loss:3.3541 train_time:444517ms step_avg:362.58ms
step:1237/1750 train_loss:3.3334 train_time:444897ms step_avg:362.59ms
step:1238/1750 train_loss:3.3525 train_time:445290ms step_avg:362.61ms
step:1239/1750 train_loss:3.3938 train_time:445671ms step_avg:362.63ms
step:1240/1750 train_loss:3.4464 train_time:446057ms step_avg:362.65ms
step:1241/1750 train_loss:3.4897 train_time:446441ms step_avg:362.67ms
step:1242/1750 train_loss:3.3582 train_time:446818ms step_avg:362.68ms
step:1243/1750 train_loss:3.4733 train_time:447200ms step_avg:362.69ms
step:1244/1750 train_loss:3.4710 train_time:447575ms step_avg:362.70ms
step:1245/1750 train_loss:3.4813 train_time:447953ms step_avg:362.72ms
step:1246/1750 train_loss:3.3003 train_time:448336ms step_avg:362.73ms
step:1247/1750 train_loss:3.4380 train_time:448714ms step_avg:362.74ms
step:1248/1750 train_loss:3.4967 train_time:449090ms step_avg:362.75ms
step:1249/1750 train_loss:3.4847 train_time:449468ms step_avg:362.77ms
step:1250/1750 train_loss:3.3633 train_time:449847ms step_avg:362.78ms
step:1250/1750 val_loss:3.4193 train_time:449950ms step_avg:362.86ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 288.91263 | frobenius_norm = 66656.23438 | spectral_norm = 11495.79297 | nuclear_norm = 1679805.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 183.99706 | spectral_norm = 34.94368 | nuclear_norm = 4221.92578
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 178.38264 | spectral_norm = 37.51183 | nuclear_norm = 4071.63232
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 332.04184 | spectral_norm = 21.76753 | nuclear_norm = 8100.70117
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 243.48228 | spectral_norm = 25.49864 | nuclear_norm = 5637.59473
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 395.91217 | spectral_norm = 34.53206 | nuclear_norm = 10539.13281
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 202.54855 | spectral_norm = 18.61870 | nuclear_norm = 5371.33691
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 185.73239 | spectral_norm = 18.40041 | nuclear_norm = 4280.50879
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 186.12325 | spectral_norm = 17.89597 | nuclear_norm = 4301.63086
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 316.03732 | spectral_norm = 29.61939 | nuclear_norm = 7295.00586
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 315.01559 | spectral_norm = 25.00834 | nuclear_norm = 7391.87354
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 395.22733 | spectral_norm = 29.14053 | nuclear_norm = 10534.52637
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 197.69229 | spectral_norm = 21.16785 | nuclear_norm = 5202.61914
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 184.80057 | spectral_norm = 19.79216 | nuclear_norm = 4252.73438
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 182.28409 | spectral_norm = 17.55567 | nuclear_norm = 4209.86084
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 339.39392 | spectral_norm = 29.87862 | nuclear_norm = 7769.19238
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 338.28534 | spectral_norm = 26.02026 | nuclear_norm = 7922.20459
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 395.22079 | spectral_norm = 34.21204 | nuclear_norm = 10517.88867
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 202.51086 | spectral_norm = 20.24516 | nuclear_norm = 5332.87500
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 178.32463 | spectral_norm = 16.98339 | nuclear_norm = 3952.98389
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 177.57251 | spectral_norm = 15.89723 | nuclear_norm = 3956.36792
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 346.65021 | spectral_norm = 32.29021 | nuclear_norm = 7847.90723
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 352.52328 | spectral_norm = 28.95825 | nuclear_norm = 8260.07617
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 401.48441 | spectral_norm = 35.81217 | nuclear_norm = 10698.60742
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 195.91534 | spectral_norm = 18.84172 | nuclear_norm = 5145.04980
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 179.94295 | spectral_norm = 19.99149 | nuclear_norm = 4102.79248
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 177.38664 | spectral_norm = 18.31819 | nuclear_norm = 4087.30640
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 349.17419 | spectral_norm = 29.74735 | nuclear_norm = 7919.49268
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 350.29086 | spectral_norm = 28.61892 | nuclear_norm = 8102.63086
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 406.27200 | spectral_norm = 32.55700 | nuclear_norm = 10797.10938
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 202.31929 | spectral_norm = 19.41945 | nuclear_norm = 5324.34961
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 179.88429 | spectral_norm = 16.59171 | nuclear_norm = 4080.15918
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 178.41112 | spectral_norm = 16.74339 | nuclear_norm = 4052.66333
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 361.34088 | spectral_norm = 34.81254 | nuclear_norm = 8114.19434
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 322.68613 | spectral_norm = 23.23195 | nuclear_norm = 7655.49609
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 434.67609 | spectral_norm = 30.37243 | nuclear_norm = 11599.63477
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 208.44135 | spectral_norm = 19.23786 | nuclear_norm = 5492.45410
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 176.81470 | spectral_norm = 19.31175 | nuclear_norm = 3980.86084
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 174.17720 | spectral_norm = 17.67421 | nuclear_norm = 3963.55762
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 362.45700 | spectral_norm = 30.46748 | nuclear_norm = 8314.95410
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 358.75446 | spectral_norm = 26.88318 | nuclear_norm = 8387.41699
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 404.84653 | spectral_norm = 32.22775 | nuclear_norm = 10794.14453
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 198.98474 | spectral_norm = 20.04045 | nuclear_norm = 5233.34082
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 177.23515 | spectral_norm = 18.70800 | nuclear_norm = 3994.57520
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 174.78275 | spectral_norm = 17.83519 | nuclear_norm = 3986.01904
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 344.04660 | spectral_norm = 28.78107 | nuclear_norm = 7868.79883
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 332.06717 | spectral_norm = 27.59688 | nuclear_norm = 7601.18359
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 422.09891 | spectral_norm = 34.27596 | nuclear_norm = 11200.19043
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 204.22713 | spectral_norm = 22.06779 | nuclear_norm = 5371.04541
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 179.30766 | spectral_norm = 19.63282 | nuclear_norm = 3920.74390
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 181.59773 | spectral_norm = 17.33850 | nuclear_norm = 3914.47192
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 384.42307 | spectral_norm = 38.76348 | nuclear_norm = 8687.40430
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 378.79572 | spectral_norm = 26.33531 | nuclear_norm = 8983.18848
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 398.39658 | spectral_norm = 35.09110 | nuclear_norm = 10573.82715
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 205.10442 | spectral_norm = 21.80754 | nuclear_norm = 5440.47559
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 186.88931 | spectral_norm = 19.84684 | nuclear_norm = 4191.69531
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 184.22057 | spectral_norm = 19.99586 | nuclear_norm = 4111.71680
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 381.37814 | spectral_norm = 38.76226 | nuclear_norm = 8721.38867
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 359.82986 | spectral_norm = 25.21369 | nuclear_norm = 8501.07324
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 409.06677 | spectral_norm = 35.30841 | nuclear_norm = 10862.16699
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 207.22791 | spectral_norm = 22.37365 | nuclear_norm = 5499.10059
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 183.33878 | spectral_norm = 21.33607 | nuclear_norm = 4040.05762
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 181.88179 | spectral_norm = 19.64001 | nuclear_norm = 3992.95117
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 350.59976 | spectral_norm = 35.90321 | nuclear_norm = 7886.54102
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 370.03314 | spectral_norm = 26.92381 | nuclear_norm = 8675.72656
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 428.13766 | spectral_norm = 32.93782 | nuclear_norm = 11410.00586
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 203.03789 | spectral_norm = 25.46174 | nuclear_norm = 5372.13086
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 188.38055 | spectral_norm = 23.61987 | nuclear_norm = 4206.03711
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 181.93918 | spectral_norm = 21.91462 | nuclear_norm = 4058.08984
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 353.22159 | spectral_norm = 34.75668 | nuclear_norm = 8079.53223
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 379.28171 | spectral_norm = 27.31904 | nuclear_norm = 8868.37207
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 438.94003 | spectral_norm = 33.72854 | nuclear_norm = 11676.68359
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 207.85738 | spectral_norm = 25.89084 | nuclear_norm = 5456.03906
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1293.71484 | spectral_norm = 170.64178 | nuclear_norm = 34072.91016
===========================================
step:1251/1750 train_loss:3.5572 train_time:450232ms step_avg:362.80ms
step:1252/1750 train_loss:3.4290 train_time:450604ms step_avg:362.81ms
step:1253/1750 train_loss:3.3677 train_time:450977ms step_avg:362.81ms
step:1254/1750 train_loss:3.4757 train_time:451358ms step_avg:362.83ms
step:1255/1750 train_loss:3.5782 train_time:451753ms step_avg:362.85ms
step:1256/1750 train_loss:3.3702 train_time:452137ms step_avg:362.87ms
step:1257/1750 train_loss:3.4304 train_time:452514ms step_avg:362.88ms
step:1258/1750 train_loss:3.4087 train_time:452901ms step_avg:362.90ms
step:1259/1750 train_loss:3.3976 train_time:453278ms step_avg:362.91ms
step:1260/1750 train_loss:3.2719 train_time:453653ms step_avg:362.92ms
step:1261/1750 train_loss:3.3596 train_time:454036ms step_avg:362.94ms
step:1262/1750 train_loss:3.3893 train_time:454425ms step_avg:362.96ms
step:1263/1750 train_loss:3.2916 train_time:454810ms step_avg:362.98ms
step:1264/1750 train_loss:3.5119 train_time:455184ms step_avg:362.99ms
step:1265/1750 train_loss:3.4968 train_time:455559ms step_avg:363.00ms
step:1266/1750 train_loss:3.5032 train_time:455936ms step_avg:363.01ms
step:1267/1750 train_loss:3.4307 train_time:456313ms step_avg:363.02ms
step:1268/1750 train_loss:3.4675 train_time:456692ms step_avg:363.03ms
step:1269/1750 train_loss:3.3213 train_time:457079ms step_avg:363.05ms
step:1270/1750 train_loss:3.1613 train_time:457457ms step_avg:363.06ms
step:1271/1750 train_loss:3.4688 train_time:457837ms step_avg:363.07ms
step:1272/1750 train_loss:3.4180 train_time:458214ms step_avg:363.09ms
step:1273/1750 train_loss:3.4508 train_time:458600ms step_avg:363.10ms
step:1274/1750 train_loss:3.4173 train_time:458983ms step_avg:363.12ms
step:1275/1750 train_loss:3.4980 train_time:459357ms step_avg:363.13ms
step:1276/1750 train_loss:3.5418 train_time:459728ms step_avg:363.13ms
step:1277/1750 train_loss:3.4750 train_time:460107ms step_avg:363.15ms
step:1278/1750 train_loss:3.4664 train_time:460480ms step_avg:363.15ms
step:1279/1750 train_loss:3.3233 train_time:460861ms step_avg:363.17ms
step:1280/1750 train_loss:3.4344 train_time:461252ms step_avg:363.19ms
step:1281/1750 train_loss:3.4848 train_time:461630ms step_avg:363.20ms
step:1282/1750 train_loss:3.5327 train_time:462003ms step_avg:363.21ms
step:1283/1750 train_loss:3.4007 train_time:462388ms step_avg:363.23ms
step:1284/1750 train_loss:3.4324 train_time:462770ms step_avg:363.24ms
step:1285/1750 train_loss:3.4189 train_time:463149ms step_avg:363.25ms
step:1286/1750 train_loss:3.4006 train_time:463528ms step_avg:363.27ms
step:1287/1750 train_loss:3.5515 train_time:463907ms step_avg:363.28ms
step:1288/1750 train_loss:3.3645 train_time:464290ms step_avg:363.29ms
step:1289/1750 train_loss:3.4479 train_time:464681ms step_avg:363.32ms
step:1290/1750 train_loss:3.5215 train_time:465072ms step_avg:363.34ms
step:1291/1750 train_loss:3.4458 train_time:465455ms step_avg:363.35ms
step:1292/1750 train_loss:3.5375 train_time:465839ms step_avg:363.37ms
step:1293/1750 train_loss:3.5749 train_time:466223ms step_avg:363.38ms
step:1294/1750 train_loss:3.5237 train_time:466606ms step_avg:363.40ms
step:1295/1750 train_loss:3.3518 train_time:466985ms step_avg:363.41ms
step:1296/1750 train_loss:3.4366 train_time:467369ms step_avg:363.43ms
step:1297/1750 train_loss:3.3410 train_time:467749ms step_avg:363.44ms
step:1298/1750 train_loss:3.3374 train_time:468133ms step_avg:363.46ms
step:1299/1750 train_loss:3.4529 train_time:468513ms step_avg:363.47ms
step:1300/1750 train_loss:3.4743 train_time:468898ms step_avg:363.49ms
step:1301/1750 train_loss:3.4662 train_time:469278ms step_avg:363.50ms
step:1302/1750 train_loss:3.6372 train_time:469673ms step_avg:363.52ms
step:1303/1750 train_loss:3.3666 train_time:470067ms step_avg:363.55ms
step:1304/1750 train_loss:3.5763 train_time:470455ms step_avg:363.57ms
step:1305/1750 train_loss:3.3286 train_time:470836ms step_avg:363.58ms
step:1306/1750 train_loss:3.5107 train_time:471229ms step_avg:363.60ms
step:1307/1750 train_loss:3.5190 train_time:471606ms step_avg:363.61ms
step:1308/1750 train_loss:3.3566 train_time:471988ms step_avg:363.63ms
step:1309/1750 train_loss:3.3672 train_time:472379ms step_avg:363.65ms
step:1310/1750 train_loss:3.3722 train_time:472763ms step_avg:363.66ms
step:1311/1750 train_loss:3.3543 train_time:473147ms step_avg:363.68ms
step:1312/1750 train_loss:3.4490 train_time:473537ms step_avg:363.70ms
step:1313/1750 train_loss:3.4071 train_time:473919ms step_avg:363.71ms
step:1314/1750 train_loss:3.0972 train_time:474311ms step_avg:363.74ms
step:1315/1750 train_loss:3.3431 train_time:474693ms step_avg:363.75ms
step:1316/1750 train_loss:3.4510 train_time:475068ms step_avg:363.76ms
step:1317/1750 train_loss:3.4821 train_time:475447ms step_avg:363.77ms
step:1318/1750 train_loss:3.3561 train_time:475843ms step_avg:363.79ms
step:1319/1750 train_loss:3.4893 train_time:476235ms step_avg:363.82ms
step:1320/1750 train_loss:3.5141 train_time:476627ms step_avg:363.84ms
step:1321/1750 train_loss:3.4226 train_time:477015ms step_avg:363.86ms
step:1322/1750 train_loss:3.3837 train_time:477451ms step_avg:363.91ms
step:1323/1750 train_loss:3.3888 train_time:477912ms step_avg:363.98ms
step:1324/1750 train_loss:3.4934 train_time:478302ms step_avg:364.00ms
step:1325/1750 train_loss:3.5589 train_time:478700ms step_avg:364.03ms
step:1326/1750 train_loss:3.2841 train_time:479089ms step_avg:364.05ms
step:1327/1750 train_loss:3.2249 train_time:479469ms step_avg:364.06ms
step:1328/1750 train_loss:3.5518 train_time:479862ms step_avg:364.08ms
step:1329/1750 train_loss:3.3559 train_time:480398ms step_avg:364.21ms
step:1330/1750 train_loss:3.4889 train_time:480792ms step_avg:364.24ms
step:1331/1750 train_loss:3.3976 train_time:481170ms step_avg:364.25ms
step:1332/1750 train_loss:3.8145 train_time:481557ms step_avg:364.26ms
step:1333/1750 train_loss:3.5318 train_time:481947ms step_avg:364.28ms
step:1334/1750 train_loss:3.4291 train_time:482330ms step_avg:364.30ms
step:1335/1750 train_loss:3.3612 train_time:482714ms step_avg:364.31ms
step:1336/1750 train_loss:3.3479 train_time:483110ms step_avg:364.34ms
step:1337/1750 train_loss:3.6146 train_time:483499ms step_avg:364.36ms
step:1338/1750 train_loss:3.5802 train_time:483887ms step_avg:364.37ms
step:1339/1750 train_loss:3.3997 train_time:484279ms step_avg:364.39ms
step:1340/1750 train_loss:3.3443 train_time:484667ms step_avg:364.41ms
step:1341/1750 train_loss:3.6571 train_time:485051ms step_avg:364.43ms
step:1342/1750 train_loss:3.4212 train_time:485437ms step_avg:364.44ms
step:1343/1750 train_loss:3.4216 train_time:485816ms step_avg:364.45ms
step:1344/1750 train_loss:3.4770 train_time:486206ms step_avg:364.47ms
step:1345/1750 train_loss:3.4478 train_time:486603ms step_avg:364.50ms
step:1346/1750 train_loss:3.3594 train_time:486986ms step_avg:364.51ms
step:1347/1750 train_loss:3.3305 train_time:487370ms step_avg:364.52ms
step:1348/1750 train_loss:3.4057 train_time:487755ms step_avg:364.54ms
step:1349/1750 train_loss:3.3337 train_time:488142ms step_avg:364.56ms
step:1350/1750 train_loss:3.4515 train_time:488532ms step_avg:364.58ms
step:1351/1750 train_loss:3.3000 train_time:488910ms step_avg:364.59ms
step:1352/1750 train_loss:3.3633 train_time:489294ms step_avg:364.60ms
step:1353/1750 train_loss:3.4734 train_time:489686ms step_avg:364.62ms
step:1354/1750 train_loss:3.3127 train_time:490073ms step_avg:364.64ms
step:1355/1750 train_loss:3.2539 train_time:490456ms step_avg:364.65ms
step:1356/1750 train_loss:3.5749 train_time:490846ms step_avg:364.67ms
step:1357/1750 train_loss:3.4870 train_time:491236ms step_avg:364.69ms
step:1358/1750 train_loss:3.2402 train_time:491622ms step_avg:364.71ms
step:1359/1750 train_loss:3.5066 train_time:492011ms step_avg:364.72ms
step:1360/1750 train_loss:3.4152 train_time:492398ms step_avg:364.74ms
step:1361/1750 train_loss:3.1975 train_time:492789ms step_avg:364.76ms
step:1362/1750 train_loss:3.4533 train_time:493177ms step_avg:364.78ms
step:1363/1750 train_loss:3.3384 train_time:493570ms step_avg:364.80ms
step:1364/1750 train_loss:3.3686 train_time:493950ms step_avg:364.81ms
step:1365/1750 train_loss:3.3696 train_time:494331ms step_avg:364.82ms
step:1366/1750 train_loss:3.4849 train_time:494719ms step_avg:364.84ms
step:1367/1750 train_loss:3.4616 train_time:495102ms step_avg:364.85ms
step:1368/1750 train_loss:3.4076 train_time:495489ms step_avg:364.87ms
step:1369/1750 train_loss:3.3274 train_time:495888ms step_avg:364.89ms
step:1370/1750 train_loss:3.6660 train_time:496276ms step_avg:364.91ms
step:1371/1750 train_loss:3.3805 train_time:496665ms step_avg:364.93ms
step:1372/1750 train_loss:3.4294 train_time:497053ms step_avg:364.94ms
step:1373/1750 train_loss:3.4262 train_time:497433ms step_avg:364.95ms
step:1374/1750 train_loss:3.2185 train_time:497819ms step_avg:364.97ms
step:1375/1750 train_loss:3.6053 train_time:498199ms step_avg:364.98ms
step:1375/1750 val_loss:3.3726 train_time:498300ms step_avg:365.05ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 293.55057 | frobenius_norm = 67753.57031 | spectral_norm = 11690.81641 | nuclear_norm = 1709249.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 188.64214 | spectral_norm = 36.89338 | nuclear_norm = 4320.47949
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 183.07368 | spectral_norm = 39.38101 | nuclear_norm = 4171.63672
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 340.48660 | spectral_norm = 22.37248 | nuclear_norm = 8320.76367
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 246.44307 | spectral_norm = 26.24953 | nuclear_norm = 5695.26953
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 408.66708 | spectral_norm = 35.97447 | nuclear_norm = 10878.74023
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 208.69205 | spectral_norm = 19.38293 | nuclear_norm = 5534.87988
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 191.51593 | spectral_norm = 19.02513 | nuclear_norm = 4411.70947
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 191.90471 | spectral_norm = 18.49088 | nuclear_norm = 4434.14307
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 324.86905 | spectral_norm = 30.42409 | nuclear_norm = 7499.51074
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 323.63159 | spectral_norm = 25.74450 | nuclear_norm = 7599.81055
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 406.80368 | spectral_norm = 30.24469 | nuclear_norm = 10846.01758
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 203.57536 | spectral_norm = 21.91732 | nuclear_norm = 5358.08740
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 190.33757 | spectral_norm = 20.65550 | nuclear_norm = 4375.22949
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 187.66945 | spectral_norm = 18.20057 | nuclear_norm = 4331.77344
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 349.60843 | spectral_norm = 30.82518 | nuclear_norm = 8009.09131
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 348.35229 | spectral_norm = 26.76095 | nuclear_norm = 8162.59131
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 406.44244 | spectral_norm = 35.66268 | nuclear_norm = 10814.79883
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 208.37640 | spectral_norm = 20.95535 | nuclear_norm = 5485.32715
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 183.37291 | spectral_norm = 17.56138 | nuclear_norm = 4052.28516
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 182.50340 | spectral_norm = 16.52515 | nuclear_norm = 4053.88281
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 357.82495 | spectral_norm = 33.33922 | nuclear_norm = 8108.10254
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 363.46216 | spectral_norm = 30.02942 | nuclear_norm = 8521.96777
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 412.66913 | spectral_norm = 37.32288 | nuclear_norm = 10996.01758
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 201.67473 | spectral_norm = 19.53281 | nuclear_norm = 5296.74121
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 185.08324 | spectral_norm = 20.78173 | nuclear_norm = 4211.59082
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 182.55177 | spectral_norm = 19.02522 | nuclear_norm = 4201.79248
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 361.38156 | spectral_norm = 30.81916 | nuclear_norm = 8207.39453
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 362.01376 | spectral_norm = 29.49347 | nuclear_norm = 8381.42969
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 417.25482 | spectral_norm = 33.80240 | nuclear_norm = 11086.71094
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 208.22263 | spectral_norm = 20.10987 | nuclear_norm = 5479.19922
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 184.87912 | spectral_norm = 17.17785 | nuclear_norm = 4184.81592
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 183.33820 | spectral_norm = 17.33804 | nuclear_norm = 4157.35742
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 374.50009 | spectral_norm = 35.98079 | nuclear_norm = 8406.84668
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 331.42166 | spectral_norm = 23.78100 | nuclear_norm = 7866.60352
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 447.80237 | spectral_norm = 31.33355 | nuclear_norm = 11950.45703
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 215.06177 | spectral_norm = 19.98891 | nuclear_norm = 5669.24707
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 182.02905 | spectral_norm = 20.12684 | nuclear_norm = 4087.32300
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 179.19315 | spectral_norm = 18.29871 | nuclear_norm = 4071.56836
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 374.47614 | spectral_norm = 31.53558 | nuclear_norm = 8599.31836
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 370.18939 | spectral_norm = 27.70733 | nuclear_norm = 8658.33691
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 416.19672 | spectral_norm = 33.52241 | nuclear_norm = 11096.03516
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 204.80869 | spectral_norm = 20.93369 | nuclear_norm = 5386.20801
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 182.44986 | spectral_norm = 19.50511 | nuclear_norm = 4101.92627
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 179.89980 | spectral_norm = 18.46139 | nuclear_norm = 4095.92480
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 354.81088 | spectral_norm = 29.82246 | nuclear_norm = 8128.68799
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 341.66867 | spectral_norm = 28.56913 | nuclear_norm = 7821.55078
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 435.02359 | spectral_norm = 35.64168 | nuclear_norm = 11537.98145
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 210.26479 | spectral_norm = 23.08721 | nuclear_norm = 5526.75879
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 184.37488 | spectral_norm = 20.31859 | nuclear_norm = 4015.39917
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 186.96550 | spectral_norm = 18.01573 | nuclear_norm = 4014.50195
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 396.12735 | spectral_norm = 40.24165 | nuclear_norm = 8945.37695
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 389.14835 | spectral_norm = 27.16288 | nuclear_norm = 9227.31152
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 410.10986 | spectral_norm = 36.65091 | nuclear_norm = 10878.38281
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 211.03531 | spectral_norm = 22.65065 | nuclear_norm = 5597.70898
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 192.33739 | spectral_norm = 20.59958 | nuclear_norm = 4303.25195
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 189.58112 | spectral_norm = 20.72519 | nuclear_norm = 4217.98145
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 394.03375 | spectral_norm = 40.81908 | nuclear_norm = 9005.81836
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 370.25009 | spectral_norm = 26.10277 | nuclear_norm = 8743.27539
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 421.02951 | spectral_norm = 36.61902 | nuclear_norm = 11174.93457
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 213.73413 | spectral_norm = 23.25451 | nuclear_norm = 5671.95117
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 188.39095 | spectral_norm = 22.26466 | nuclear_norm = 4135.17969
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 186.88347 | spectral_norm = 20.45506 | nuclear_norm = 4086.47852
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 363.55264 | spectral_norm = 37.39930 | nuclear_norm = 8172.82910
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 381.44855 | spectral_norm = 27.88941 | nuclear_norm = 8940.58398
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 439.42105 | spectral_norm = 34.07128 | nuclear_norm = 11707.87109
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 208.63693 | spectral_norm = 26.47539 | nuclear_norm = 5518.94189
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 193.78113 | spectral_norm = 24.69040 | nuclear_norm = 4313.20801
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 187.02460 | spectral_norm = 22.92322 | nuclear_norm = 4160.02881
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 367.83871 | spectral_norm = 35.90958 | nuclear_norm = 8411.78320
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 391.02487 | spectral_norm = 28.20598 | nuclear_norm = 9138.91797
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 450.39270 | spectral_norm = 34.71146 | nuclear_norm = 11977.96777
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 213.64185 | spectral_norm = 26.87910 | nuclear_norm = 5605.39746
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1318.47595 | spectral_norm = 168.22650 | nuclear_norm = 34794.71484
===========================================
step:1376/1750 train_loss:3.4010 train_time:498572ms step_avg:364.99ms
step:1377/1750 train_loss:3.5382 train_time:498947ms step_avg:364.99ms
step:1378/1750 train_loss:3.5361 train_time:499327ms step_avg:365.01ms
step:1379/1750 train_loss:3.1724 train_time:499713ms step_avg:365.02ms
step:1380/1750 train_loss:3.3698 train_time:500094ms step_avg:365.03ms
step:1381/1750 train_loss:3.7786 train_time:500483ms step_avg:365.05ms
step:1382/1750 train_loss:3.2793 train_time:500864ms step_avg:365.06ms
step:1383/1750 train_loss:3.4566 train_time:501250ms step_avg:365.08ms
step:1384/1750 train_loss:3.5424 train_time:501636ms step_avg:365.09ms
step:1385/1750 train_loss:3.4664 train_time:502012ms step_avg:365.10ms
step:1386/1750 train_loss:3.4043 train_time:502397ms step_avg:365.11ms
step:1387/1750 train_loss:3.2542 train_time:502781ms step_avg:365.13ms
step:1388/1750 train_loss:3.4078 train_time:503159ms step_avg:365.14ms
step:1389/1750 train_loss:3.3794 train_time:503544ms step_avg:365.15ms
step:1390/1750 train_loss:3.6317 train_time:503922ms step_avg:365.16ms
step:1391/1750 train_loss:3.3561 train_time:504304ms step_avg:365.17ms
step:1392/1750 train_loss:3.3501 train_time:504686ms step_avg:365.19ms
step:1393/1750 train_loss:3.3016 train_time:505063ms step_avg:365.19ms
step:1394/1750 train_loss:3.5765 train_time:505441ms step_avg:365.20ms
step:1395/1750 train_loss:3.4598 train_time:505822ms step_avg:365.21ms
step:1396/1750 train_loss:3.4662 train_time:506202ms step_avg:365.23ms
step:1397/1750 train_loss:3.3646 train_time:506577ms step_avg:365.23ms
step:1398/1750 train_loss:3.3155 train_time:506956ms step_avg:365.24ms
step:1399/1750 train_loss:3.3923 train_time:507342ms step_avg:365.26ms
step:1400/1750 train_loss:3.3738 train_time:507738ms step_avg:365.28ms
step:1401/1750 train_loss:3.4042 train_time:508108ms step_avg:365.28ms
step:1402/1750 train_loss:3.3574 train_time:508487ms step_avg:365.29ms
step:1403/1750 train_loss:3.5597 train_time:508878ms step_avg:365.31ms
step:1404/1750 train_loss:3.3384 train_time:509257ms step_avg:365.32ms
step:1405/1750 train_loss:3.3692 train_time:509639ms step_avg:365.33ms
step:1406/1750 train_loss:3.3657 train_time:510022ms step_avg:365.35ms
step:1407/1750 train_loss:3.2371 train_time:510399ms step_avg:365.35ms
step:1408/1750 train_loss:3.3656 train_time:510784ms step_avg:365.37ms
step:1409/1750 train_loss:3.3540 train_time:511186ms step_avg:365.39ms
step:1410/1750 train_loss:3.3487 train_time:511566ms step_avg:365.40ms
step:1411/1750 train_loss:3.4280 train_time:511941ms step_avg:365.41ms
step:1412/1750 train_loss:3.3869 train_time:512320ms step_avg:365.42ms
step:1413/1750 train_loss:3.4154 train_time:512704ms step_avg:365.43ms
step:1414/1750 train_loss:3.3919 train_time:513088ms step_avg:365.45ms
step:1415/1750 train_loss:3.4696 train_time:513484ms step_avg:365.47ms
step:1416/1750 train_loss:3.2838 train_time:513890ms step_avg:365.50ms
step:1417/1750 train_loss:3.3408 train_time:514278ms step_avg:365.51ms
step:1418/1750 train_loss:3.4494 train_time:514662ms step_avg:365.53ms
step:1419/1750 train_loss:3.4027 train_time:515050ms step_avg:365.54ms
step:1420/1750 train_loss:3.4173 train_time:515439ms step_avg:365.56ms
step:1421/1750 train_loss:3.4274 train_time:515823ms step_avg:365.57ms
step:1422/1750 train_loss:3.3991 train_time:516201ms step_avg:365.58ms
step:1423/1750 train_loss:3.3756 train_time:516581ms step_avg:365.59ms
step:1424/1750 train_loss:3.3882 train_time:516973ms step_avg:365.61ms
step:1425/1750 train_loss:3.2412 train_time:517371ms step_avg:365.63ms
step:1426/1750 train_loss:3.3845 train_time:517753ms step_avg:365.64ms
step:1427/1750 train_loss:3.3352 train_time:518142ms step_avg:365.66ms
step:1428/1750 train_loss:3.4361 train_time:518525ms step_avg:365.67ms
step:1429/1750 train_loss:3.4194 train_time:518906ms step_avg:365.68ms
step:1430/1750 train_loss:3.3193 train_time:519295ms step_avg:365.70ms
step:1431/1750 train_loss:3.3783 train_time:519689ms step_avg:365.72ms
step:1432/1750 train_loss:3.3961 train_time:520086ms step_avg:365.74ms
step:1433/1750 train_loss:3.1927 train_time:520487ms step_avg:365.77ms
step:1434/1750 train_loss:3.3460 train_time:520888ms step_avg:365.79ms
step:1435/1750 train_loss:3.1785 train_time:521277ms step_avg:365.81ms
step:1436/1750 train_loss:3.2836 train_time:521663ms step_avg:365.82ms
step:1437/1750 train_loss:3.4694 train_time:522044ms step_avg:365.83ms
step:1438/1750 train_loss:3.4387 train_time:522430ms step_avg:365.85ms
step:1439/1750 train_loss:3.3762 train_time:522820ms step_avg:365.86ms
step:1440/1750 train_loss:3.2446 train_time:523201ms step_avg:365.87ms
step:1441/1750 train_loss:3.4061 train_time:523588ms step_avg:365.89ms
step:1442/1750 train_loss:3.4450 train_time:523983ms step_avg:365.91ms
step:1443/1750 train_loss:3.5327 train_time:524388ms step_avg:365.94ms
step:1444/1750 train_loss:3.5012 train_time:524771ms step_avg:365.95ms
step:1445/1750 train_loss:3.3876 train_time:525159ms step_avg:365.96ms
step:1446/1750 train_loss:3.2624 train_time:525554ms step_avg:365.98ms
step:1447/1750 train_loss:3.3498 train_time:525947ms step_avg:366.00ms
step:1448/1750 train_loss:3.3525 train_time:526330ms step_avg:366.02ms
step:1449/1750 train_loss:3.4559 train_time:526714ms step_avg:366.03ms
step:1450/1750 train_loss:3.4508 train_time:527101ms step_avg:366.04ms
step:1451/1750 train_loss:3.2600 train_time:527486ms step_avg:366.06ms
step:1452/1750 train_loss:3.3890 train_time:527874ms step_avg:366.07ms
step:1453/1750 train_loss:3.3113 train_time:528252ms step_avg:366.08ms
step:1454/1750 train_loss:3.3442 train_time:528636ms step_avg:366.09ms
step:1455/1750 train_loss:3.3867 train_time:529027ms step_avg:366.11ms
step:1456/1750 train_loss:3.3323 train_time:529410ms step_avg:366.12ms
step:1457/1750 train_loss:3.2162 train_time:529794ms step_avg:366.13ms
step:1458/1750 train_loss:3.4766 train_time:530180ms step_avg:366.15ms
step:1459/1750 train_loss:3.3244 train_time:530571ms step_avg:366.16ms
step:1460/1750 train_loss:3.3697 train_time:530957ms step_avg:366.18ms
step:1461/1750 train_loss:3.4884 train_time:531342ms step_avg:366.19ms
step:1462/1750 train_loss:3.3135 train_time:531724ms step_avg:366.20ms
step:1463/1750 train_loss:3.5206 train_time:532118ms step_avg:366.22ms
step:1464/1750 train_loss:3.4200 train_time:532507ms step_avg:366.24ms
step:1465/1750 train_loss:3.4125 train_time:532894ms step_avg:366.25ms
step:1466/1750 train_loss:3.3433 train_time:533279ms step_avg:366.26ms
step:1467/1750 train_loss:3.4486 train_time:533670ms step_avg:366.28ms
step:1468/1750 train_loss:3.3383 train_time:534054ms step_avg:366.29ms
step:1469/1750 train_loss:3.3206 train_time:534444ms step_avg:366.31ms
step:1470/1750 train_loss:3.3885 train_time:534842ms step_avg:366.33ms
step:1471/1750 train_loss:3.3059 train_time:535246ms step_avg:366.36ms
step:1472/1750 train_loss:3.2911 train_time:535645ms step_avg:366.38ms
step:1473/1750 train_loss:3.4874 train_time:536029ms step_avg:366.39ms
step:1474/1750 train_loss:3.3663 train_time:536426ms step_avg:366.41ms
step:1475/1750 train_loss:3.1978 train_time:536824ms step_avg:366.43ms
step:1476/1750 train_loss:3.3158 train_time:537209ms step_avg:366.45ms
step:1477/1750 train_loss:3.2928 train_time:537605ms step_avg:366.47ms
step:1478/1750 train_loss:3.3621 train_time:538001ms step_avg:366.49ms
step:1479/1750 train_loss:3.4495 train_time:538389ms step_avg:366.50ms
step:1480/1750 train_loss:3.3303 train_time:538771ms step_avg:366.51ms
step:1481/1750 train_loss:3.5029 train_time:539160ms step_avg:366.53ms
step:1482/1750 train_loss:3.4163 train_time:539563ms step_avg:366.55ms
step:1483/1750 train_loss:3.3310 train_time:539972ms step_avg:366.58ms
step:1484/1750 train_loss:3.3137 train_time:540368ms step_avg:366.60ms
step:1485/1750 train_loss:3.3277 train_time:540753ms step_avg:366.61ms
step:1486/1750 train_loss:3.2723 train_time:541146ms step_avg:366.63ms
step:1487/1750 train_loss:3.3918 train_time:541539ms step_avg:366.65ms
step:1488/1750 train_loss:3.2883 train_time:541934ms step_avg:366.67ms
step:1489/1750 train_loss:3.3689 train_time:542323ms step_avg:366.68ms
step:1490/1750 train_loss:3.3057 train_time:542715ms step_avg:366.70ms
step:1491/1750 train_loss:3.2173 train_time:543102ms step_avg:366.71ms
step:1492/1750 train_loss:3.3182 train_time:543487ms step_avg:366.73ms
step:1493/1750 train_loss:3.4892 train_time:543867ms step_avg:366.73ms
step:1494/1750 train_loss:3.3494 train_time:544247ms step_avg:366.74ms
step:1495/1750 train_loss:3.0800 train_time:544638ms step_avg:366.76ms
step:1496/1750 train_loss:3.4092 train_time:545027ms step_avg:366.77ms
step:1497/1750 train_loss:3.3619 train_time:545418ms step_avg:366.79ms
step:1498/1750 train_loss:3.3902 train_time:545815ms step_avg:366.81ms
step:1499/1750 train_loss:3.3633 train_time:546215ms step_avg:366.83ms
step:1500/1750 train_loss:3.3428 train_time:546627ms step_avg:366.86ms
step:1500/1750 val_loss:3.3287 train_time:546733ms step_avg:366.93ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 295.59760 | frobenius_norm = 68239.59375 | spectral_norm = 11781.15137 | nuclear_norm = 1722744.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 190.81488 | spectral_norm = 38.18771 | nuclear_norm = 4362.98486
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 185.43353 | spectral_norm = 40.49908 | nuclear_norm = 4219.73242
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 345.07059 | spectral_norm = 22.69916 | nuclear_norm = 8442.97656
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 247.74379 | spectral_norm = 26.73140 | nuclear_norm = 5717.75977
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 415.69485 | spectral_norm = 36.83025 | nuclear_norm = 11066.81641
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 212.03375 | spectral_norm = 19.81677 | nuclear_norm = 5624.45508
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 194.44168 | spectral_norm = 19.39331 | nuclear_norm = 4476.38135
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 194.88702 | spectral_norm = 18.93333 | nuclear_norm = 4500.44775
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 329.81134 | spectral_norm = 30.84151 | nuclear_norm = 7614.98877
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 328.47888 | spectral_norm = 26.14643 | nuclear_norm = 7717.68604
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 413.19205 | spectral_norm = 30.78161 | nuclear_norm = 11018.95898
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 206.77534 | spectral_norm = 22.35183 | nuclear_norm = 5442.91455
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 193.22264 | spectral_norm = 21.15195 | nuclear_norm = 4437.83301
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 190.63228 | spectral_norm = 18.59516 | nuclear_norm = 4397.61035
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 355.48819 | spectral_norm = 31.46279 | nuclear_norm = 8147.64453
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 354.02103 | spectral_norm = 27.26765 | nuclear_norm = 8298.56445
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 412.65701 | spectral_norm = 36.48311 | nuclear_norm = 10979.61816
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 211.51527 | spectral_norm = 21.39223 | nuclear_norm = 5566.80957
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 185.90306 | spectral_norm = 17.89965 | nuclear_norm = 4097.96582
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 185.12190 | spectral_norm = 16.82940 | nuclear_norm = 4102.67529
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 364.32825 | spectral_norm = 33.90123 | nuclear_norm = 8260.70898
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 369.79596 | spectral_norm = 30.63024 | nuclear_norm = 8673.99023
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 418.88446 | spectral_norm = 38.17494 | nuclear_norm = 11161.17383
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 204.77475 | spectral_norm = 19.91131 | nuclear_norm = 5378.63281
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 187.74477 | spectral_norm = 21.20203 | nuclear_norm = 4265.17773
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 185.19946 | spectral_norm = 19.38490 | nuclear_norm = 4259.70312
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 368.63049 | spectral_norm = 31.45073 | nuclear_norm = 8381.74609
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 368.87180 | spectral_norm = 30.02455 | nuclear_norm = 8546.79883
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 422.91608 | spectral_norm = 34.52413 | nuclear_norm = 11235.87500
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 211.29398 | spectral_norm = 20.46375 | nuclear_norm = 5559.70557
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 187.32661 | spectral_norm = 17.53631 | nuclear_norm = 4232.79883
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 185.90596 | spectral_norm = 17.67321 | nuclear_norm = 4210.00195
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 382.77039 | spectral_norm = 36.74295 | nuclear_norm = 8594.57227
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 336.11447 | spectral_norm = 24.06699 | nuclear_norm = 7982.05859
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 454.89450 | spectral_norm = 31.89761 | nuclear_norm = 12140.95508
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 218.65440 | spectral_norm = 20.40019 | nuclear_norm = 5766.23926
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 184.68925 | spectral_norm = 20.59448 | nuclear_norm = 4139.14941
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 181.83659 | spectral_norm = 18.65362 | nuclear_norm = 4125.87061
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 381.60358 | spectral_norm = 32.00498 | nuclear_norm = 8772.14844
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 376.92337 | spectral_norm = 28.07078 | nuclear_norm = 8819.18164
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 422.21002 | spectral_norm = 34.16569 | nuclear_norm = 11256.26562
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 207.87627 | spectral_norm = 21.46574 | nuclear_norm = 5466.99609
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 185.06224 | spectral_norm = 19.96532 | nuclear_norm = 4152.90283
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 182.52560 | spectral_norm = 18.80110 | nuclear_norm = 4151.55225
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 361.10406 | spectral_norm = 30.23120 | nuclear_norm = 8284.08691
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 347.23593 | spectral_norm = 29.00534 | nuclear_norm = 7949.78223
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 442.02463 | spectral_norm = 36.45668 | nuclear_norm = 11718.95508
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 213.41327 | spectral_norm = 23.65818 | nuclear_norm = 5607.08838
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 186.94319 | spectral_norm = 20.60863 | nuclear_norm = 4058.34717
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 189.63841 | spectral_norm = 18.41977 | nuclear_norm = 4055.41895
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 402.99509 | spectral_norm = 41.19672 | nuclear_norm = 9094.91406
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 394.86301 | spectral_norm = 27.77586 | nuclear_norm = 9361.88477
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 416.19180 | spectral_norm = 37.53292 | nuclear_norm = 11034.65234
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 214.09534 | spectral_norm = 23.13411 | nuclear_norm = 5678.51123
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 195.06242 | spectral_norm = 21.06843 | nuclear_norm = 4353.73438
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 192.41342 | spectral_norm = 21.08689 | nuclear_norm = 4270.76904
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 401.51993 | spectral_norm = 42.10066 | nuclear_norm = 9173.45801
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 376.08133 | spectral_norm = 26.51235 | nuclear_norm = 8877.08203
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 427.13654 | spectral_norm = 37.34264 | nuclear_norm = 11332.68652
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 217.13898 | spectral_norm = 23.70164 | nuclear_norm = 5762.77930
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 190.97478 | spectral_norm = 22.85025 | nuclear_norm = 4177.39355
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 189.39064 | spectral_norm = 20.91127 | nuclear_norm = 4126.10400
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 371.55106 | spectral_norm = 38.34204 | nuclear_norm = 8351.10547
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 387.89468 | spectral_norm = 28.46116 | nuclear_norm = 9089.83984
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 444.76602 | spectral_norm = 34.68816 | nuclear_norm = 11848.35352
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 211.54987 | spectral_norm = 26.93064 | nuclear_norm = 5595.28809
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 196.43785 | spectral_norm = 25.29267 | nuclear_norm = 4360.13477
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 189.44498 | spectral_norm = 23.56804 | nuclear_norm = 4201.05371
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 377.26346 | spectral_norm = 36.58096 | nuclear_norm = 8626.51758
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 398.00189 | spectral_norm = 28.86702 | nuclear_norm = 9296.51562
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 455.62033 | spectral_norm = 35.12902 | nuclear_norm = 12115.08887
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 216.66701 | spectral_norm = 27.34016 | nuclear_norm = 5683.09863
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1326.66235 | spectral_norm = 165.29048 | nuclear_norm = 35068.07031
===========================================
step:1501/1750 train_loss:3.1361 train_time:547010ms step_avg:366.87ms
step:1502/1750 train_loss:3.4101 train_time:547386ms step_avg:366.88ms
step:1503/1750 train_loss:3.2919 train_time:547766ms step_avg:366.89ms
step:1504/1750 train_loss:3.2992 train_time:548149ms step_avg:366.90ms
step:1505/1750 train_loss:3.2625 train_time:548530ms step_avg:366.91ms
step:1506/1750 train_loss:3.3277 train_time:548917ms step_avg:366.92ms
step:1507/1750 train_loss:3.2211 train_time:549326ms step_avg:366.95ms
step:1508/1750 train_loss:3.5338 train_time:549715ms step_avg:366.97ms
step:1509/1750 train_loss:3.3217 train_time:550095ms step_avg:366.97ms
step:1510/1750 train_loss:3.3237 train_time:550480ms step_avg:366.99ms
step:1511/1750 train_loss:3.4535 train_time:550885ms step_avg:367.01ms
step:1512/1750 train_loss:3.4703 train_time:551398ms step_avg:367.11ms
step:1513/1750 train_loss:3.3152 train_time:551787ms step_avg:367.12ms
step:1514/1750 train_loss:3.1368 train_time:552177ms step_avg:367.14ms
step:1515/1750 train_loss:3.2836 train_time:552564ms step_avg:367.15ms
step:1516/1750 train_loss:3.2956 train_time:552960ms step_avg:367.17ms
step:1517/1750 train_loss:3.3485 train_time:553347ms step_avg:367.18ms
step:1518/1750 train_loss:3.2589 train_time:553737ms step_avg:367.20ms
step:1519/1750 train_loss:3.5507 train_time:554240ms step_avg:367.29ms
step:1520/1750 train_loss:3.1764 train_time:554632ms step_avg:367.31ms
step:1521/1750 train_loss:3.2542 train_time:555015ms step_avg:367.32ms
step:1522/1750 train_loss:3.3980 train_time:555407ms step_avg:367.33ms
step:1523/1750 train_loss:3.2697 train_time:555790ms step_avg:367.34ms
step:1524/1750 train_loss:3.3937 train_time:556176ms step_avg:367.36ms
step:1525/1750 train_loss:3.3775 train_time:556578ms step_avg:367.38ms
step:1526/1750 train_loss:3.3219 train_time:556986ms step_avg:367.40ms
step:1527/1750 train_loss:3.3330 train_time:557373ms step_avg:367.42ms
step:1528/1750 train_loss:3.4546 train_time:557758ms step_avg:367.43ms
step:1529/1750 train_loss:3.4543 train_time:558137ms step_avg:367.44ms
step:1530/1750 train_loss:3.2798 train_time:558518ms step_avg:367.45ms
step:1531/1750 train_loss:3.2353 train_time:558905ms step_avg:367.46ms
step:1532/1750 train_loss:3.3887 train_time:559290ms step_avg:367.47ms
step:1533/1750 train_loss:3.3186 train_time:559689ms step_avg:367.49ms
step:1534/1750 train_loss:3.3256 train_time:560087ms step_avg:367.51ms
step:1535/1750 train_loss:3.3235 train_time:560476ms step_avg:367.53ms
step:1536/1750 train_loss:3.2744 train_time:560868ms step_avg:367.54ms
step:1537/1750 train_loss:3.3180 train_time:561256ms step_avg:367.55ms
step:1538/1750 train_loss:3.4682 train_time:561658ms step_avg:367.58ms
step:1539/1750 train_loss:3.4447 train_time:562052ms step_avg:367.59ms
step:1540/1750 train_loss:3.3163 train_time:562440ms step_avg:367.61ms
step:1541/1750 train_loss:3.2705 train_time:562831ms step_avg:367.62ms
step:1542/1750 train_loss:3.2892 train_time:563223ms step_avg:367.64ms
step:1543/1750 train_loss:3.1922 train_time:563609ms step_avg:367.65ms
step:1544/1750 train_loss:3.3361 train_time:563990ms step_avg:367.66ms
step:1545/1750 train_loss:3.3106 train_time:564381ms step_avg:367.67ms
step:1546/1750 train_loss:3.3016 train_time:564785ms step_avg:367.70ms
step:1547/1750 train_loss:3.2613 train_time:565178ms step_avg:367.72ms
step:1548/1750 train_loss:3.3095 train_time:565577ms step_avg:367.74ms
step:1549/1750 train_loss:3.3792 train_time:565959ms step_avg:367.74ms
step:1550/1750 train_loss:3.3366 train_time:566340ms step_avg:367.75ms
step:1551/1750 train_loss:3.2475 train_time:566730ms step_avg:367.77ms
step:1552/1750 train_loss:3.2682 train_time:567120ms step_avg:367.78ms
step:1553/1750 train_loss:3.2707 train_time:567502ms step_avg:367.79ms
step:1554/1750 train_loss:3.3990 train_time:567891ms step_avg:367.81ms
step:1555/1750 train_loss:3.3789 train_time:568283ms step_avg:367.82ms
step:1556/1750 train_loss:3.3247 train_time:568664ms step_avg:367.83ms
step:1557/1750 train_loss:3.3674 train_time:569044ms step_avg:367.84ms
step:1558/1750 train_loss:3.3015 train_time:569433ms step_avg:367.85ms
step:1559/1750 train_loss:3.1759 train_time:569838ms step_avg:367.87ms
step:1560/1750 train_loss:3.4721 train_time:570221ms step_avg:367.88ms
step:1561/1750 train_loss:3.2646 train_time:570609ms step_avg:367.90ms
step:1562/1750 train_loss:3.2543 train_time:570990ms step_avg:367.91ms
step:1563/1750 train_loss:3.3674 train_time:571377ms step_avg:367.92ms
step:1564/1750 train_loss:3.1954 train_time:571778ms step_avg:367.94ms
step:1565/1750 train_loss:3.2123 train_time:572176ms step_avg:367.96ms
step:1566/1750 train_loss:3.4093 train_time:572567ms step_avg:367.97ms
step:1567/1750 train_loss:3.2741 train_time:572954ms step_avg:367.99ms
step:1568/1750 train_loss:3.2811 train_time:573355ms step_avg:368.01ms
step:1569/1750 train_loss:3.3725 train_time:573776ms step_avg:368.04ms
step:1570/1750 train_loss:3.3257 train_time:574181ms step_avg:368.07ms
step:1571/1750 train_loss:3.2031 train_time:574580ms step_avg:368.08ms
step:1572/1750 train_loss:3.2412 train_time:574969ms step_avg:368.10ms
step:1573/1750 train_loss:3.3604 train_time:575361ms step_avg:368.11ms
step:1574/1750 train_loss:3.2129 train_time:575745ms step_avg:368.12ms
step:1575/1750 train_loss:3.3732 train_time:576131ms step_avg:368.13ms
step:1576/1750 train_loss:3.2718 train_time:576518ms step_avg:368.15ms
step:1577/1750 train_loss:3.3285 train_time:576915ms step_avg:368.17ms
step:1578/1750 train_loss:3.3151 train_time:577307ms step_avg:368.18ms
step:1579/1750 train_loss:3.2873 train_time:577703ms step_avg:368.20ms
step:1580/1750 train_loss:3.2456 train_time:578090ms step_avg:368.21ms
step:1581/1750 train_loss:3.4436 train_time:578487ms step_avg:368.23ms
step:1582/1750 train_loss:3.2602 train_time:578897ms step_avg:368.25ms
step:1583/1750 train_loss:3.4235 train_time:579303ms step_avg:368.28ms
step:1584/1750 train_loss:3.2367 train_time:579690ms step_avg:368.29ms
step:1585/1750 train_loss:3.4128 train_time:580086ms step_avg:368.31ms
step:1586/1750 train_loss:3.1894 train_time:580475ms step_avg:368.32ms
step:1587/1750 train_loss:3.3933 train_time:580860ms step_avg:368.33ms
step:1588/1750 train_loss:3.2670 train_time:581257ms step_avg:368.35ms
step:1589/1750 train_loss:3.4366 train_time:581647ms step_avg:368.36ms
step:1590/1750 train_loss:3.2797 train_time:582035ms step_avg:368.38ms
step:1591/1750 train_loss:3.2945 train_time:582427ms step_avg:368.39ms
step:1592/1750 train_loss:3.3573 train_time:582816ms step_avg:368.40ms
step:1593/1750 train_loss:3.3272 train_time:583220ms step_avg:368.43ms
step:1594/1750 train_loss:3.3045 train_time:583610ms step_avg:368.44ms
step:1595/1750 train_loss:3.4551 train_time:584001ms step_avg:368.46ms
step:1596/1750 train_loss:3.1526 train_time:584404ms step_avg:368.48ms
step:1597/1750 train_loss:3.3257 train_time:584806ms step_avg:368.50ms
step:1598/1750 train_loss:3.3783 train_time:585208ms step_avg:368.52ms
step:1599/1750 train_loss:3.4433 train_time:585615ms step_avg:368.54ms
step:1600/1750 train_loss:3.2679 train_time:586014ms step_avg:368.56ms
step:1601/1750 train_loss:3.5711 train_time:586400ms step_avg:368.57ms
step:1602/1750 train_loss:3.4513 train_time:586799ms step_avg:368.59ms
step:1603/1750 train_loss:3.2205 train_time:587205ms step_avg:368.62ms
step:1604/1750 train_loss:3.2672 train_time:587598ms step_avg:368.63ms
step:1605/1750 train_loss:3.1548 train_time:588009ms step_avg:368.66ms
step:1606/1750 train_loss:3.4673 train_time:588416ms step_avg:368.68ms
step:1607/1750 train_loss:3.3024 train_time:588809ms step_avg:368.70ms
step:1608/1750 train_loss:3.3025 train_time:589205ms step_avg:368.71ms
step:1609/1750 train_loss:3.2381 train_time:589602ms step_avg:368.73ms
step:1610/1750 train_loss:3.7461 train_time:590016ms step_avg:368.76ms
step:1611/1750 train_loss:3.4969 train_time:590419ms step_avg:368.78ms
step:1612/1750 train_loss:3.3927 train_time:590826ms step_avg:368.81ms
step:1613/1750 train_loss:3.2596 train_time:591242ms step_avg:368.83ms
step:1614/1750 train_loss:3.2934 train_time:591636ms step_avg:368.85ms
step:1615/1750 train_loss:3.3066 train_time:592040ms step_avg:368.87ms
step:1616/1750 train_loss:3.2763 train_time:592471ms step_avg:368.91ms
step:1617/1750 train_loss:3.3512 train_time:592886ms step_avg:368.94ms
step:1618/1750 train_loss:3.2789 train_time:593269ms step_avg:368.95ms
step:1619/1750 train_loss:3.1832 train_time:593662ms step_avg:368.96ms
step:1620/1750 train_loss:3.4609 train_time:594052ms step_avg:368.98ms
step:1621/1750 train_loss:3.3813 train_time:594453ms step_avg:369.00ms
step:1622/1750 train_loss:3.1531 train_time:594846ms step_avg:369.01ms
step:1623/1750 train_loss:3.2535 train_time:595239ms step_avg:369.03ms
step:1624/1750 train_loss:3.2064 train_time:595621ms step_avg:369.03ms
step:1625/1750 train_loss:3.3134 train_time:596003ms step_avg:369.04ms
step:1625/1750 val_loss:3.2938 train_time:596107ms step_avg:369.11ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.09909 | frobenius_norm = 68358.61719 | spectral_norm = 11814.92773 | nuclear_norm = 1726390.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 191.43159 | spectral_norm = 38.85442 | nuclear_norm = 4371.86133
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 186.17433 | spectral_norm = 41.06087 | nuclear_norm = 4232.80371
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 347.10461 | spectral_norm = 22.78916 | nuclear_norm = 8499.25586
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 247.94504 | spectral_norm = 26.86300 | nuclear_norm = 5718.10645
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 418.57092 | spectral_norm = 37.20950 | nuclear_norm = 11144.58301
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 213.43213 | spectral_norm = 19.98243 | nuclear_norm = 5662.56055
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 195.57304 | spectral_norm = 19.52421 | nuclear_norm = 4501.13623
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 196.08563 | spectral_norm = 19.23640 | nuclear_norm = 4526.89600
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 331.99994 | spectral_norm = 30.96426 | nuclear_norm = 7665.69336
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 330.53510 | spectral_norm = 26.34928 | nuclear_norm = 7769.33203
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 415.76477 | spectral_norm = 31.04467 | nuclear_norm = 11089.22266
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 208.08629 | spectral_norm = 22.50806 | nuclear_norm = 5477.99609
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 194.33603 | spectral_norm = 21.31424 | nuclear_norm = 4460.86670
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 191.78477 | spectral_norm = 18.73649 | nuclear_norm = 4423.42969
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 358.02121 | spectral_norm = 31.74937 | nuclear_norm = 8207.29785
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 356.45743 | spectral_norm = 27.42706 | nuclear_norm = 8358.61914
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 415.23132 | spectral_norm = 36.74802 | nuclear_norm = 11047.50391
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 212.77272 | spectral_norm = 21.58028 | nuclear_norm = 5599.16943
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 186.84685 | spectral_norm = 18.02801 | nuclear_norm = 4112.37207
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 186.04311 | spectral_norm = 16.99422 | nuclear_norm = 4116.44385
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 367.26282 | spectral_norm = 34.10550 | nuclear_norm = 8331.06836
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 372.61832 | spectral_norm = 30.91228 | nuclear_norm = 8744.00586
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 421.37054 | spectral_norm = 38.52522 | nuclear_norm = 11226.82715
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 206.03038 | spectral_norm = 20.08620 | nuclear_norm = 5412.07910
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 188.76505 | spectral_norm = 21.40578 | nuclear_norm = 4283.85156
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 186.20436 | spectral_norm = 19.59443 | nuclear_norm = 4280.39355
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 372.12830 | spectral_norm = 31.71795 | nuclear_norm = 8468.39258
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 372.12704 | spectral_norm = 30.21108 | nuclear_norm = 8627.27344
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 425.15155 | spectral_norm = 34.80640 | nuclear_norm = 11294.43848
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 212.49324 | spectral_norm = 20.65126 | nuclear_norm = 5590.83887
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 188.24365 | spectral_norm = 17.67466 | nuclear_norm = 4247.47754
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 186.82625 | spectral_norm = 17.79525 | nuclear_norm = 4226.47168
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 386.98404 | spectral_norm = 37.15468 | nuclear_norm = 8689.47266
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 338.05707 | spectral_norm = 24.18352 | nuclear_norm = 8030.31104
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 457.85275 | spectral_norm = 32.09499 | nuclear_norm = 12220.33984
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 220.17937 | spectral_norm = 20.57634 | nuclear_norm = 5807.86670
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 185.62593 | spectral_norm = 20.83394 | nuclear_norm = 4154.23730
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 182.81180 | spectral_norm = 18.82293 | nuclear_norm = 4144.38037
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 384.98932 | spectral_norm = 32.29968 | nuclear_norm = 8855.30371
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 380.08694 | spectral_norm = 28.24836 | nuclear_norm = 8896.53125
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 424.67468 | spectral_norm = 34.44477 | nuclear_norm = 11321.69824
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 209.08946 | spectral_norm = 21.66776 | nuclear_norm = 5498.91309
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 186.10051 | spectral_norm = 20.17916 | nuclear_norm = 4169.97705
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 183.44107 | spectral_norm = 18.98137 | nuclear_norm = 4169.37695
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 364.09830 | spectral_norm = 30.45178 | nuclear_norm = 8360.33984
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 349.83508 | spectral_norm = 29.23895 | nuclear_norm = 8010.00586
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 445.11462 | spectral_norm = 36.78273 | nuclear_norm = 11797.77344
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 214.65524 | spectral_norm = 23.91597 | nuclear_norm = 5638.09082
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 187.85896 | spectral_norm = 20.72703 | nuclear_norm = 4067.33789
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 190.64449 | spectral_norm = 18.53834 | nuclear_norm = 4064.87695
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 406.41992 | spectral_norm = 41.56715 | nuclear_norm = 9168.16895
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 397.59473 | spectral_norm = 28.05635 | nuclear_norm = 9424.54102
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 418.55817 | spectral_norm = 37.88779 | nuclear_norm = 11093.40820
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 215.25253 | spectral_norm = 23.31306 | nuclear_norm = 5709.06836
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 196.08180 | spectral_norm = 21.32125 | nuclear_norm = 4368.45020
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 193.45703 | spectral_norm = 21.28156 | nuclear_norm = 4285.77441
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 405.12418 | spectral_norm = 42.78265 | nuclear_norm = 9253.63672
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 378.69113 | spectral_norm = 26.77094 | nuclear_norm = 8936.84668
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 429.52463 | spectral_norm = 37.70662 | nuclear_norm = 11393.19824
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 218.47229 | spectral_norm = 23.85183 | nuclear_norm = 5798.19678
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 191.81958 | spectral_norm = 23.18724 | nuclear_norm = 4185.15430
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 190.28810 | spectral_norm = 21.14858 | nuclear_norm = 4134.27783
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 375.48846 | spectral_norm = 38.86335 | nuclear_norm = 8438.21875
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 390.95959 | spectral_norm = 28.72715 | nuclear_norm = 9159.95898
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 446.61182 | spectral_norm = 34.85112 | nuclear_norm = 11896.20020
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 212.72655 | spectral_norm = 27.04573 | nuclear_norm = 5626.13574
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 197.39412 | spectral_norm = 25.62580 | nuclear_norm = 4372.73145
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 190.27798 | spectral_norm = 23.88465 | nuclear_norm = 4210.77832
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 381.99289 | spectral_norm = 36.88791 | nuclear_norm = 8733.04590
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 401.26337 | spectral_norm = 29.23521 | nuclear_norm = 9367.79688
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 457.25665 | spectral_norm = 35.22913 | nuclear_norm = 12156.98730
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 217.88062 | spectral_norm = 27.50189 | nuclear_norm = 5713.74805
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1325.40442 | spectral_norm = 162.52570 | nuclear_norm = 35077.78516
===========================================
step:1626/1750 train_loss:3.2336 train_time:596389ms step_avg:369.05ms
step:1627/1750 train_loss:3.2379 train_time:596768ms step_avg:369.06ms
step:1628/1750 train_loss:3.3544 train_time:597156ms step_avg:369.07ms
step:1629/1750 train_loss:3.2423 train_time:597545ms step_avg:369.08ms
step:1630/1750 train_loss:3.3184 train_time:597942ms step_avg:369.10ms
step:1631/1750 train_loss:3.1718 train_time:598365ms step_avg:369.13ms
step:1632/1750 train_loss:3.1470 train_time:598752ms step_avg:369.14ms
step:1633/1750 train_loss:3.2957 train_time:599138ms step_avg:369.15ms
step:1634/1750 train_loss:3.3064 train_time:599520ms step_avg:369.16ms
step:1635/1750 train_loss:3.2459 train_time:599924ms step_avg:369.18ms
step:1636/1750 train_loss:3.3280 train_time:600315ms step_avg:369.20ms
step:1637/1750 train_loss:3.3774 train_time:600702ms step_avg:369.21ms
step:1638/1750 train_loss:3.3982 train_time:601094ms step_avg:369.22ms
step:1639/1750 train_loss:3.5704 train_time:601495ms step_avg:369.24ms
step:1640/1750 train_loss:3.3480 train_time:601890ms step_avg:369.26ms
step:1641/1750 train_loss:3.2936 train_time:602285ms step_avg:369.27ms
step:1642/1750 train_loss:3.4052 train_time:602675ms step_avg:369.29ms
step:1643/1750 train_loss:3.2701 train_time:603078ms step_avg:369.31ms
step:1644/1750 train_loss:3.3114 train_time:603468ms step_avg:369.32ms
step:1645/1750 train_loss:3.3127 train_time:603852ms step_avg:369.33ms
step:1646/1750 train_loss:3.0657 train_time:604241ms step_avg:369.34ms
step:1647/1750 train_loss:3.3197 train_time:604626ms step_avg:369.35ms
step:1648/1750 train_loss:3.2130 train_time:605017ms step_avg:369.36ms
step:1649/1750 train_loss:3.2802 train_time:605401ms step_avg:369.37ms
step:1650/1750 train_loss:3.2675 train_time:605786ms step_avg:369.38ms
step:1651/1750 train_loss:3.3443 train_time:606171ms step_avg:369.39ms
step:1652/1750 train_loss:3.2558 train_time:606559ms step_avg:369.40ms
step:1653/1750 train_loss:3.3898 train_time:606959ms step_avg:369.42ms
step:1654/1750 train_loss:3.3826 train_time:607348ms step_avg:369.43ms
step:1655/1750 train_loss:3.1777 train_time:607747ms step_avg:369.45ms
step:1656/1750 train_loss:3.3262 train_time:608157ms step_avg:369.48ms
step:1657/1750 train_loss:3.2422 train_time:608557ms step_avg:369.49ms
step:1658/1750 train_loss:3.2178 train_time:608943ms step_avg:369.50ms
step:1659/1750 train_loss:3.3073 train_time:609332ms step_avg:369.52ms
step:1660/1750 train_loss:3.3384 train_time:609719ms step_avg:369.53ms
step:1661/1750 train_loss:3.2472 train_time:610111ms step_avg:369.54ms
step:1662/1750 train_loss:3.3569 train_time:610495ms step_avg:369.55ms
step:1663/1750 train_loss:3.3463 train_time:610899ms step_avg:369.57ms
step:1664/1750 train_loss:3.4046 train_time:611322ms step_avg:369.60ms
step:1665/1750 train_loss:3.3247 train_time:611719ms step_avg:369.62ms
step:1666/1750 train_loss:3.4994 train_time:612111ms step_avg:369.63ms
step:1667/1750 train_loss:3.1951 train_time:612507ms step_avg:369.65ms
step:1668/1750 train_loss:3.2921 train_time:612903ms step_avg:369.66ms
step:1669/1750 train_loss:3.2035 train_time:613291ms step_avg:369.68ms
step:1670/1750 train_loss:3.2186 train_time:613684ms step_avg:369.69ms
step:1671/1750 train_loss:3.3680 train_time:614078ms step_avg:369.70ms
step:1672/1750 train_loss:3.5740 train_time:614469ms step_avg:369.72ms
step:1673/1750 train_loss:3.2718 train_time:614861ms step_avg:369.73ms
step:1674/1750 train_loss:3.2570 train_time:615250ms step_avg:369.74ms
step:1675/1750 train_loss:3.1218 train_time:615653ms step_avg:369.76ms
step:1676/1750 train_loss:3.3514 train_time:616054ms step_avg:369.78ms
step:1677/1750 train_loss:3.2796 train_time:616447ms step_avg:369.79ms
step:1678/1750 train_loss:3.2945 train_time:616839ms step_avg:369.81ms
step:1679/1750 train_loss:3.2969 train_time:617230ms step_avg:369.82ms
step:1680/1750 train_loss:3.0835 train_time:617646ms step_avg:369.85ms
step:1681/1750 train_loss:3.2961 train_time:618044ms step_avg:369.86ms
step:1682/1750 train_loss:3.2851 train_time:618445ms step_avg:369.88ms
step:1683/1750 train_loss:3.3007 train_time:618836ms step_avg:369.90ms
step:1684/1750 train_loss:3.3371 train_time:619224ms step_avg:369.91ms
step:1685/1750 train_loss:3.2352 train_time:619611ms step_avg:369.92ms
step:1686/1750 train_loss:3.3695 train_time:620008ms step_avg:369.93ms
step:1687/1750 train_loss:3.2402 train_time:620401ms step_avg:369.95ms
step:1688/1750 train_loss:3.3092 train_time:620810ms step_avg:369.97ms
step:1689/1750 train_loss:3.2211 train_time:621210ms step_avg:369.99ms
step:1690/1750 train_loss:3.0694 train_time:621612ms step_avg:370.01ms
step:1691/1750 train_loss:3.3073 train_time:622003ms step_avg:370.02ms
step:1692/1750 train_loss:3.2952 train_time:622391ms step_avg:370.03ms
step:1693/1750 train_loss:3.2063 train_time:622779ms step_avg:370.04ms
step:1694/1750 train_loss:3.6064 train_time:623182ms step_avg:370.06ms
step:1695/1750 train_loss:3.3311 train_time:623584ms step_avg:370.08ms
step:1696/1750 train_loss:3.3294 train_time:623978ms step_avg:370.09ms
step:1697/1750 train_loss:3.2501 train_time:624361ms step_avg:370.10ms
step:1698/1750 train_loss:3.1211 train_time:624751ms step_avg:370.11ms
step:1699/1750 train_loss:3.2287 train_time:625144ms step_avg:370.13ms
step:1700/1750 train_loss:3.2436 train_time:625578ms step_avg:370.16ms
step:1701/1750 train_loss:3.3192 train_time:626051ms step_avg:370.23ms
step:1702/1750 train_loss:3.2358 train_time:626437ms step_avg:370.23ms
step:1703/1750 train_loss:3.4081 train_time:626819ms step_avg:370.24ms
step:1704/1750 train_loss:3.2108 train_time:627206ms step_avg:370.25ms
step:1705/1750 train_loss:3.4312 train_time:627591ms step_avg:370.26ms
step:1706/1750 train_loss:3.2496 train_time:627973ms step_avg:370.27ms
step:1707/1750 train_loss:3.0496 train_time:628369ms step_avg:370.28ms
step:1708/1750 train_loss:3.3870 train_time:628758ms step_avg:370.29ms
step:1709/1750 train_loss:3.2926 train_time:629261ms step_avg:370.37ms
step:1710/1750 train_loss:3.2800 train_time:629692ms step_avg:370.41ms
step:1711/1750 train_loss:3.2831 train_time:630091ms step_avg:370.42ms
step:1712/1750 train_loss:3.3167 train_time:630486ms step_avg:370.44ms
step:1713/1750 train_loss:3.3357 train_time:630879ms step_avg:370.45ms
step:1714/1750 train_loss:3.2231 train_time:631282ms step_avg:370.47ms
step:1715/1750 train_loss:3.2842 train_time:631703ms step_avg:370.50ms
step:1716/1750 train_loss:3.0938 train_time:632088ms step_avg:370.51ms
step:1717/1750 train_loss:3.2405 train_time:632471ms step_avg:370.52ms
step:1718/1750 train_loss:3.2598 train_time:632859ms step_avg:370.53ms
step:1719/1750 train_loss:3.2150 train_time:633256ms step_avg:370.54ms
step:1720/1750 train_loss:3.3740 train_time:633666ms step_avg:370.56ms
step:1721/1750 train_loss:3.1599 train_time:634098ms step_avg:370.60ms
step:1722/1750 train_loss:3.3136 train_time:634493ms step_avg:370.62ms
step:1723/1750 train_loss:3.4024 train_time:634905ms step_avg:370.64ms
step:1724/1750 train_loss:3.2585 train_time:635300ms step_avg:370.65ms
step:1725/1750 train_loss:3.4878 train_time:635707ms step_avg:370.67ms
step:1726/1750 train_loss:3.2545 train_time:636115ms step_avg:370.70ms
step:1727/1750 train_loss:3.3281 train_time:636499ms step_avg:370.70ms
step:1728/1750 train_loss:3.2927 train_time:636891ms step_avg:370.72ms
step:1729/1750 train_loss:3.2747 train_time:637293ms step_avg:370.73ms
step:1730/1750 train_loss:3.6496 train_time:637692ms step_avg:370.75ms
step:1731/1750 train_loss:3.2936 train_time:638084ms step_avg:370.76ms
step:1732/1750 train_loss:3.4304 train_time:638478ms step_avg:370.78ms
step:1733/1750 train_loss:3.2030 train_time:638859ms step_avg:370.78ms
step:1734/1750 train_loss:3.2393 train_time:639248ms step_avg:370.79ms
step:1735/1750 train_loss:3.2677 train_time:639646ms step_avg:370.81ms
step:1736/1750 train_loss:3.2525 train_time:640045ms step_avg:370.83ms
step:1737/1750 train_loss:3.3807 train_time:640445ms step_avg:370.84ms
step:1738/1750 train_loss:3.2152 train_time:640865ms step_avg:370.87ms
step:1739/1750 train_loss:3.2863 train_time:641272ms step_avg:370.89ms
step:1740/1750 train_loss:3.3675 train_time:641671ms step_avg:370.91ms
step:1741/1750 train_loss:3.1611 train_time:642064ms step_avg:370.92ms
step:1742/1750 train_loss:3.0594 train_time:642460ms step_avg:370.94ms
step:1743/1750 train_loss:2.9577 train_time:642870ms step_avg:370.96ms
step:1744/1750 train_loss:3.2910 train_time:643259ms step_avg:370.97ms
step:1745/1750 train_loss:3.3094 train_time:643643ms step_avg:370.98ms
step:1746/1750 train_loss:3.2624 train_time:644030ms step_avg:370.99ms
step:1747/1750 train_loss:3.2976 train_time:644434ms step_avg:371.00ms
step:1748/1750 train_loss:3.4964 train_time:644858ms step_avg:371.03ms
step:1749/1750 train_loss:3.2249 train_time:645255ms step_avg:371.05ms
step:1750/1750 train_loss:3.2784 train_time:645661ms step_avg:371.07ms
step:1750/1750 val_loss:3.2727 train_time:645777ms step_avg:371.14ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.12338 | frobenius_norm = 68364.39062 | spectral_norm = 11820.42969 | nuclear_norm = 1726659.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 191.37529 | spectral_norm = 39.09531 | nuclear_norm = 4368.35840
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 186.21120 | spectral_norm = 41.21254 | nuclear_norm = 4232.41797
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 347.56351 | spectral_norm = 22.79265 | nuclear_norm = 8512.84961
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 247.85985 | spectral_norm = 26.86057 | nuclear_norm = 5714.63086
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 419.18875 | spectral_norm = 37.31536 | nuclear_norm = 11161.54590
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 213.72707 | spectral_norm = 20.02824 | nuclear_norm = 5670.82568
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 195.75539 | spectral_norm = 19.54653 | nuclear_norm = 4504.96094
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 196.30722 | spectral_norm = 19.29901 | nuclear_norm = 4531.75488
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 332.49591 | spectral_norm = 30.97614 | nuclear_norm = 7678.02979
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 330.99963 | spectral_norm = 26.38511 | nuclear_norm = 7781.73340
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 416.32489 | spectral_norm = 31.08073 | nuclear_norm = 11104.91602
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 208.34065 | spectral_norm = 22.54698 | nuclear_norm = 5484.94238
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 194.54475 | spectral_norm = 21.36541 | nuclear_norm = 4464.72656
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 192.02179 | spectral_norm = 18.76793 | nuclear_norm = 4428.65918
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 358.62619 | spectral_norm = 31.81202 | nuclear_norm = 8222.40430
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 357.04892 | spectral_norm = 27.47672 | nuclear_norm = 8374.04883
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 415.75952 | spectral_norm = 36.81141 | nuclear_norm = 11061.47461
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 213.00964 | spectral_norm = 21.62743 | nuclear_norm = 5605.16797
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 186.96577 | spectral_norm = 18.06445 | nuclear_norm = 4112.58057
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 186.20006 | spectral_norm = 17.03147 | nuclear_norm = 4117.46729
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 367.96579 | spectral_norm = 34.11761 | nuclear_norm = 8348.90234
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 373.30542 | spectral_norm = 30.99965 | nuclear_norm = 8761.61133
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 421.86783 | spectral_norm = 38.60694 | nuclear_norm = 11239.98047
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 206.26498 | spectral_norm = 20.12460 | nuclear_norm = 5418.37354
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 188.93726 | spectral_norm = 21.43987 | nuclear_norm = 4286.19824
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 186.36792 | spectral_norm = 19.64753 | nuclear_norm = 4283.48242
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 373.04276 | spectral_norm = 31.79689 | nuclear_norm = 8491.70312
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 372.97531 | spectral_norm = 30.26660 | nuclear_norm = 8648.59570
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 425.56482 | spectral_norm = 34.87343 | nuclear_norm = 11304.94238
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 212.69470 | spectral_norm = 20.68742 | nuclear_norm = 5595.93750
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 188.37662 | spectral_norm = 17.71320 | nuclear_norm = 4248.20312
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 186.96719 | spectral_norm = 17.81127 | nuclear_norm = 4227.42285
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 388.24203 | spectral_norm = 37.27830 | nuclear_norm = 8717.78320
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 338.42950 | spectral_norm = 24.21981 | nuclear_norm = 8040.23096
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 458.47617 | spectral_norm = 32.13565 | nuclear_norm = 12237.27148
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 220.48584 | spectral_norm = 20.60779 | nuclear_norm = 5816.55713
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 185.76350 | spectral_norm = 20.91425 | nuclear_norm = 4154.74023
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 182.97464 | spectral_norm = 18.87697 | nuclear_norm = 4146.58594
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 385.85873 | spectral_norm = 32.36080 | nuclear_norm = 8877.00195
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 380.90915 | spectral_norm = 28.29528 | nuclear_norm = 8916.71875
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 425.15344 | spectral_norm = 34.50120 | nuclear_norm = 11334.38184
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 209.29596 | spectral_norm = 21.71648 | nuclear_norm = 5504.15039
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 186.25394 | spectral_norm = 20.24926 | nuclear_norm = 4171.09326
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 183.58476 | spectral_norm = 19.01971 | nuclear_norm = 4171.24463
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 364.83942 | spectral_norm = 30.49560 | nuclear_norm = 8379.88965
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 350.47214 | spectral_norm = 29.30812 | nuclear_norm = 8025.31494
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 445.78595 | spectral_norm = 36.85832 | nuclear_norm = 11814.24219
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 214.86566 | spectral_norm = 23.97572 | nuclear_norm = 5642.96680
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 187.98911 | spectral_norm = 20.77261 | nuclear_norm = 4065.62402
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 190.78427 | spectral_norm = 18.58672 | nuclear_norm = 4062.53809
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 407.30069 | spectral_norm = 41.69987 | nuclear_norm = 9186.32617
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 398.27985 | spectral_norm = 28.13380 | nuclear_norm = 9439.87695
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 418.95944 | spectral_norm = 37.98783 | nuclear_norm = 11102.60156
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 215.43098 | spectral_norm = 23.34221 | nuclear_norm = 5713.68115
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 196.23613 | spectral_norm = 21.39135 | nuclear_norm = 4368.51172
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 193.61865 | spectral_norm = 21.31685 | nuclear_norm = 4285.98438
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 406.05826 | spectral_norm = 42.98098 | nuclear_norm = 9273.73047
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 379.32669 | spectral_norm = 26.85040 | nuclear_norm = 8950.79883
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 429.93512 | spectral_norm = 37.80603 | nuclear_norm = 11402.83789
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 218.70663 | spectral_norm = 23.87424 | nuclear_norm = 5804.34766
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 191.89723 | spectral_norm = 23.27411 | nuclear_norm = 4182.37109
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 190.39421 | spectral_norm = 21.21513 | nuclear_norm = 4132.05615
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 376.53757 | spectral_norm = 39.01500 | nuclear_norm = 8461.02344
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 391.75797 | spectral_norm = 28.81132 | nuclear_norm = 9177.77246
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 446.86777 | spectral_norm = 34.89832 | nuclear_norm = 11902.50781
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 212.93774 | spectral_norm = 27.04377 | nuclear_norm = 5631.55273
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 197.54648 | spectral_norm = 25.71579 | nuclear_norm = 4372.75879
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 190.39905 | spectral_norm = 23.97302 | nuclear_norm = 4209.99805
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 383.29672 | spectral_norm = 36.99533 | nuclear_norm = 8762.21484
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 402.14407 | spectral_norm = 29.34359 | nuclear_norm = 9386.14355
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 457.44131 | spectral_norm = 35.22684 | nuclear_norm = 12161.48438
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 218.10236 | spectral_norm = 27.49554 | nuclear_norm = 5719.22314
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1323.00183 | spectral_norm = 161.14032 | nuclear_norm = 35031.57812
===========================================

import os
import sys
with open(sys.argv[0]) as f:
    code = f.read() # read the code of this file ASAP, for logging
import uuid
import time
import contextlib
from dataclasses import dataclass
from pathlib import Path

import torch
from torch import nn
import torch.nn.functional as F
import torch.distributed as dist
import torch._inductor.config as config
from torch.nn.parallel import DistributedDataParallel as DDP
# Use of FlexAttention contributed by @KoszarskyB
from torch.nn.attention.flex_attention import BlockMask, flex_attention
from liger_kernel.ops.fused_linear_cross_entropy import LigerFusedLinearCrossEntropyFunction


class LigerFusedLinearCrossEntropyLoss(torch.nn.Module):
    def __init__(
        self,
        ignore_index: int = -100,
        lse_square_scale: float = 0.0,
        label_smoothing: float = 0.0,
        reduction: str = "mean",
        softcap: float | None = None,
    ):
        super().__init__()
        assert (label_smoothing >= 0) and (
            label_smoothing <= 1
        ), f"label_smoothing must be between 0.0 and 1.0. Got: {label_smoothing}"
        assert reduction in {
            "mean",
            "sum",
            "none",
        }, f"reduction must be one of 'mean', 'sum', or 'none'. Got: {reduction}"
        assert (
            softcap is None or softcap > 0
        ), f"softcap must greater than 0.0 or None. Got: {softcap}"
        self.ignore_index = ignore_index
        self.lse_square_scale = lse_square_scale
        self.label_smoothing = label_smoothing
        self.reduction = reduction
        self.softcap = softcap

    def forward(self, lin_weight, _input, target, bias=None):
        return LigerFusedLinearCrossEntropyFunction.apply(
            _input,
            lin_weight,
            target,
            bias,
            self.ignore_index,
            self.lse_square_scale,
            self.label_smoothing,
            self.reduction,
            self.softcap,
        )

# -----------------------------------------------------------------------------
# Muon optimizer

@torch.compile
def zeropower_via_newtonschulz5(G, steps=10, eps=1e-7):
    """
    Newton-Schulz iteration to compute the zeroth power / orthogonalization of G. We opt to use a
    quintic iteration whose coefficients are selected to maximize the slope at zero. For the purpose
    of minimizing steps, it turns out to be empirically effective to keep increasing the slope at
    zero even beyond the point where the iteration no longer converges all the way to one everywhere
    on the interval. This iteration therefore does not produce UV^T but rather something like US'V^T
    where S' is diagonal with S_{ii}' ~ Uniform(0.5, 1.5), which turns out not to hurt model
    performance at all relative to UV^T, where USV^T = G is the SVD.
    """
    assert len(G.shape) == 2
    a, b, c = (3.4445, -4.7750,  2.0315)
    X = G.bfloat16()
    X /= (X.norm() + eps) # ensure top singular value <= 1
    if G.size(0) > G.size(1):
        X = X.T
    for _ in range(steps):
        A = X @ X.T
        B = b * A + c * A @ A # adapted from suggestion by @jxbz, @leloykun, and @YouJiacheng
        X = a * X + B @ X
    if G.size(0) > G.size(1):
        X = X.T
    return X

class Muon(torch.optim.Optimizer):
    """
    Muon - MomentUm Orthogonalized by Newton-schulz

    Muon internally runs standard SGD-momentum, and then performs an orthogonalization post-
    processing step, in which each 2D parameter's update is replaced with the nearest orthogonal
    matrix. To efficiently orthogonalize each update, we use a Newton-Schulz iteration, which has
    the advantage that it can be stably run in bfloat16 on the GPU.

    Some warnings:
    - This optimizer assumes that all parameters passed in are 2D.
    - It should not be used for the embedding layer, the final fully connected layer, or any {0,1}-D
    parameters; those should all be optimized by a standard method (e.g., AdamW).
    - To use it with 4D convolutional filters, it works well to just flatten their last 3 dimensions.
    - We believe it is unlikely to work well for training with small batch size.
    - We believe it may not work well for finetuning pretrained models, but we haven't tested this.
    - We have not yet tried this optimizer for training scenarios larger than NanoGPT (124M).

    Arguments:
        lr: The learning rate used by the internal SGD.
        momentum: The momentum used by the internal SGD.
        nesterov: Whether to use Nesterov-style momentum in the internal SGD. (recommended)
        ns_steps: The number of Newton-Schulz iteration steps to use.
    """
    def __init__(self, params, lr=0.02, momentum=0.95, nesterov=True, ns_steps=5):
        self.world_size = int(os.environ['WORLD_SIZE'])
        self.rank = int(os.environ['RANK'])
        defaults = dict(lr=lr, momentum=momentum, nesterov=nesterov, ns_steps=ns_steps)
        params = list(params)
        assert all(isinstance(p, torch.Tensor) for p in params)
        sizes = {p.numel() for p in params}
        param_groups = [
            {
                'params': [p for p in params if p.numel() == size],
                'update_buffer': [
                    torch.empty(size, device='cuda', dtype=torch.bfloat16)
                    for _ in range(self.world_size)
                ],
            }
            for size in sizes
        ]
        super().__init__(param_groups, defaults)

    def step(self):

        for group in self.param_groups:

            lr = group['lr']
            momentum = group['momentum']
            nesterov = group['nesterov']
            ns_steps = group['ns_steps']
            update_buffers = group['update_buffer']
            # generate weight updates in distributed fashion
            params = group['params']
            assert len(params) % self.world_size == 0
            handle = None
            params_world = None
            def update_prev():
                if params_world is None:
                    return
                assert handle is not None
                handle.wait()
                for p_world, g_world in zip(params_world, update_buffers):
                    p_world.data.add_(
                        g_world.view_as(p_world),
                        alpha=-lr * max(1, p_world.size(0) / p_world.size(1)) ** 0.5,
                    )
            for base_i in range(len(params))[::self.world_size]:
                p = params[base_i + self.rank]
                g = p.grad
                assert g is not None
                state = self.state[p]
                if 'momentum_buffer' not in state:
                    state['momentum_buffer'] = torch.zeros_like(g)
                buf = state['momentum_buffer']
                buf.lerp_(g, 1 - momentum)
                g = g.lerp_(buf, momentum) if nesterov else buf
                g = zeropower_via_newtonschulz5(g, steps=ns_steps).flatten()
                update_prev()
                handle = dist.all_gather(update_buffers, g, async_op=True)
                params_world = params[base_i : base_i + self.world_size]
            update_prev()

# -----------------------------------------------------------------------------
# PyTorch nn.Module definitions for the GPT-2 model

def norm(x):
    return F.rms_norm(x, (x.size(-1),))

class CastedLinear(nn.Linear):

    def __init__(self, in_features, out_features):
        super().__init__(in_features, out_features, bias=False)

    def forward(self, x):
        return F.linear(x, self.weight.to(x.dtype))

class Rotary(torch.nn.Module):

    def __init__(self, dim, base=10000):
        super().__init__()
        self.register_buffer('inv_freq', (1 / base) ** (torch.arange(0, dim, 2) / dim))
        self.seq_len_cached = None
        self.cos_cached = None
        self.sin_cached = None

    def forward(self, x):
        seq_len = x.shape[1]
        if seq_len != self.seq_len_cached:
            t = torch.arange(seq_len, device=x.device)
            freqs = torch.outer(t, self.inv_freq)
            self.seq_len_cached = seq_len
            self.cos_cached = freqs.cos()
            self.sin_cached = freqs.sin()
        cos, sin = self.cos_cached[None, :, None, :], self.sin_cached[None, :, None, :]
        # apply_rotary_emb(x, cos, sin)
        x1, x2 = x.chunk(2, dim=3)
        y1 = x1 * cos + x2 * sin
        y2 = x1 * (-sin) + x2 * cos
        return torch.cat((y1, y2), 3).type_as(x)

class CausalSelfAttention(nn.Module):

    def __init__(self, dim, num_heads):
        super().__init__()
        assert dim % num_heads == 0
        self.num_heads = num_heads
        self.c_q = CastedLinear(dim, dim)
        self.c_k = CastedLinear(dim, dim)
        self.c_v = CastedLinear(dim, dim)
        self.lambdas = nn.Parameter(torch.tensor([0.5, 0.5]))
        self.rotary = Rotary(dim // num_heads) # dim // num_heads = head_dim
        self.c_proj = CastedLinear(dim, dim)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977

    def forward(self, x, vi, block_mask):
        B, T = x.size(0), x.size(1) # batch size, sequence length
        assert B == 1, "Must use batch size = 1 for FlexAttention"
        q = self.c_q(x).view(B, T, self.num_heads, -1)
        k = self.c_k(x).view(B, T, self.num_heads, -1)
        v = self.c_v(x).view(B, T, self.num_heads, -1)
        v = self.lambdas[0] * v + self.lambdas[1] * vi.view_as(v) # @KoszarskyB & @Grad62304977
        q, k = norm(q), norm(k) # QK norm @Grad62304977
        q, k = self.rotary(q), self.rotary(k)
        y = flex_attention(q.transpose(1, 2), k.transpose(1, 2), v.transpose(1, 2), block_mask=block_mask)
        y = y.transpose(1, 2).contiguous().view_as(x) # re-assemble all head outputs side by side
        y = self.c_proj(y)
        return y

class MLP(nn.Module):

    def __init__(self, dim):
        super().__init__()
        self.c_fc   = CastedLinear(dim, 4 * dim)
        self.c_proj = CastedLinear(4 * dim, dim)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977

    def forward(self, x):
        x = self.c_fc(x)
        x = F.relu(x).square() # https://arxiv.org/abs/2109.08668v2; ~1-2% better than GELU; suggested by @SKYLINEZ007 and @Grad62304977
        x = self.c_proj(x)
        return x

class Block(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.attn = CausalSelfAttention(config.model_dim, config.num_heads)
        self.mlp = MLP(config.model_dim)
        self.lambdas = nn.Parameter(torch.tensor([1., 0.]))

    def forward(self, x, vi, x0, block_mask):
        x = self.lambdas[0] * x + self.lambdas[1] * x0
        x = x + self.attn(norm(x), vi, block_mask)
        x = x + self.mlp(norm(x))
        return x

# -----------------------------------------------------------------------------
# The main GPT-2 model

@dataclass
class GPTConfig:
    vocab_size : int = 50304
    num_layers : int = 12
    num_heads : int = 6 # head dim 128 suggested by @Grad62304977
    model_dim : int = 768

class GPT(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.num_layers = config.num_layers

        # U-net design by @brendanh0gan
        self.num_encoder_layers = config.num_layers // 2 # Half of the layers for encoder
        self.num_decoder_layers = config.num_layers - self.num_encoder_layers # Remaining for decoder
        # Add learnable skip connection weights for decoder layers
        self.skip_weights = nn.Parameter(torch.ones(self.num_decoder_layers))

        self.embed = nn.Embedding(config.vocab_size, config.model_dim)
        self.blocks = nn.ModuleList([Block(config) for _ in range(config.num_layers)])
        # token value embeddings by @KoszarskyB - inspired by @Grad62304977's value residual learning
        # U-net structure on token value embeddings by @leloykun
        self.value_embeds = nn.Embedding(config.vocab_size, config.model_dim*self.num_encoder_layers)
        self.lm_head = CastedLinear(config.model_dim, config.vocab_size)
        self.lm_head.weight.data.zero_() # @Grad62304977

    def forward(self, inputs, targets, sliding_window_size):

        BLOCK_SIZE = 128
        assert inputs.ndim == 1
        docs = (inputs == 50256).cumsum(0)
        docs_low = docs.reshape(-1, BLOCK_SIZE)[:, 0].contiguous()
        docs_high = docs.reshape(-1, BLOCK_SIZE)[:, -1].contiguous()
        def document_sliding_window_causal(b, h, q_idx, kv_idx):
            causal_mask = q_idx >= kv_idx
            document_mask = docs[q_idx] == docs[kv_idx]
            window_mask = q_idx - kv_idx < sliding_window_size
            return causal_mask & document_mask & window_mask

        S = len(inputs)
        def create_sliding_window_causal_mask(S, sliding_window_size):
            kv_idx = block_idx = torch.arange(S // BLOCK_SIZE, dtype=torch.int32, device="cuda")
            q_idx = block_idx[:, None]
            causal_mask = q_idx >= kv_idx
            document_mask = (docs_low[q_idx] <= docs_high[kv_idx]) & (docs_low[kv_idx] <= docs_high[q_idx])
            window_mask = q_idx - kv_idx < ((sliding_window_size + BLOCK_SIZE - 1) // BLOCK_SIZE)
            dense_mask = causal_mask & document_mask & window_mask
            dense_mask = dense_mask.to(torch.int32)
            num_blocks = dense_mask.sum(dim=-1).to(torch.int32)
            indices = torch.argsort(dense_mask, dim=-1, descending=True, stable=True).to(torch.int32)
            num_blocks = num_blocks[None, None, :].contiguous()
            indices = indices[None, None, :].contiguous()
            return BlockMask.from_kv_blocks(num_blocks, indices, BLOCK_SIZE=BLOCK_SIZE, mask_mod=document_sliding_window_causal)
        block_mask = create_sliding_window_causal_mask(S, sliding_window_size)

        # forward the GPT model itself
        x = self.embed(inputs[None]) # token embeddings of shape (b, t, model_dim)
        x = norm(x) # @Grad62304977
        x0 = x
        vi = self.value_embeds(inputs[None]).chunk(self.num_encoder_layers, dim=-1)

        # Store outputs for U-Net skip connections
        skip_connections = []
        # Encoder pass - process only the first half of the blocks
        for i in range(self.num_encoder_layers):
            x = self.blocks[i](x, vi[i], x0, block_mask)
            skip_connections.append(x)
        # Decoder pass - process the remaining blocks with weighted skip connections
        for i in range(self.num_decoder_layers):
            x = x + self.skip_weights[i] * skip_connections.pop()
            # U-net structure on token value embeddings by @leloykun
            x = self.blocks[self.num_encoder_layers + i](x, vi[self.num_encoder_layers-1-i], x0, block_mask)

        x = norm(x)
        logits = self.lm_head(x)
        logits = 30 * torch.tanh(logits / 30) # @Grad62304977
        logits = logits.float()
        loss = F.cross_entropy(logits.view(-1, logits.size(-1)), targets.view(-1))
        # loss_fn = LigerFusedLinearCrossEntropyLoss(ignore_index=50256, softcap=30.0)
        # loss = loss_fn(self.lm_head.weight, x, targets)
        return loss

# -----------------------------------------------------------------------------
# Our own simple Distributed Data Loader

def _peek_data_shard(file: Path):
    # only reads the header, returns header data
    # header is 256 int32
    header = torch.from_file(f"{file}", False, 256, dtype=torch.int32)
    assert header[0] == 20240520, "magic number mismatch in the data .bin file"
    assert header[1] == 1, "unsupported version"
    return int(header[2]) # number of tokens (claimed)

def _load_data_shard(path, num_tokens):
    with path.open("rb") as f:
        tokens = torch.empty(num_tokens, dtype=torch.uint16, pin_memory=True)
        f.seek(256 * 4)
        nbytes = f.readinto(tokens.numpy())
        assert nbytes == 2 * num_tokens, "number of tokens read does not match header?"
    return tokens

class DistributedDataLoader:
    def __init__(self, filename_pattern, seq_len, process_rank, num_processes):
        self.process_rank = process_rank
        self.num_processes = num_processes
        self.seq_len = seq_len

        # glob files that match the pattern
        self.files = sorted(Path.cwd().glob(filename_pattern))
        assert len(self.files) > 0, f"did not find any files that match the pattern {filename_pattern}"

        # load and validate all data shards, count number of tokens in total
        self.files_num_tokens = [_peek_data_shard(file) for file in self.files]
        assert min(self.files_num_tokens) >= num_processes * seq_len + 1
        self.total_num_tokens = sum(self.files_num_tokens)

        self.reset()

    def reset(self):
        self.current_shard = -1
        self.advance()

    def advance(self): # advance to next data shard
        self.current_shard = (self.current_shard + 1) % len(self.files)
        self.current_position = self.process_rank * self.seq_len
        self.tokens = _load_data_shard(self.files[self.current_shard], self.files_num_tokens[self.current_shard])

    def next_batch(self):
        batch_size = self.seq_len * self.num_processes
        buf = self.tokens[self.current_position:self.current_position+self.seq_len+1]
        # host side async is sufficient;
        # no performance improvement was observed when introducing a separate stream.
        inputs = buf[:-1].to(device="cuda", dtype=torch.int32, non_blocking=True) # inputs
        targets = buf[1:].to(device="cuda", dtype=torch.int64, non_blocking=True) # targets
        # advance current position and load next shard if necessary
        self.current_position += batch_size
        if self.current_position + batch_size + 1 >= len(self.tokens):
            self.advance()
        return inputs, targets

# -----------------------------------------------------------------------------
# int main

@dataclass
class Hyperparameters:
    # data hyperparams
    input_bin : str = 'data/fineweb10B/fineweb_train_*.bin' # input .bin to train on
    input_val_bin : str = 'data/fineweb10B/fineweb_val_*.bin' # input .bin to eval validation loss on
    # optimization hyperparams
    batch_size : int = 8 # batch size, in sequences, across all devices
    sequence_length : int = 64*1024 # sequence length, in tokens
    num_iterations : int = 1480 # number of iterations to run
    warmup_iters : int = 0
    cooldown_iters : int = 600 # number of iterations of linear warmup/cooldown for triangular or trapezoidal schedule
    weight_decay : float = 0
    # evaluation and logging hyperparams
    val_loss_every : int = 125 # every how many steps to evaluate val loss? 0 for only at the end
    val_tokens : int = 10485760 # how many tokens of validation data? it's important to keep this fixed for consistent comparisons
    save_every : int = 0 # every how many steps to save the checkpoint? 0 for only at the end
    log_norms: bool = True # log the norms of the weights and gradients
args = Hyperparameters()

# set up DDP (distributed data parallel). torchrun sets this env variable
assert torch.cuda.is_available()
dist.init_process_group(backend='nccl')
ddp_rank = int(os.environ['RANK'])
ddp_local_rank = int(os.environ['LOCAL_RANK'])
ddp_world_size = int(os.environ['WORLD_SIZE'])
device = f'cuda:{ddp_local_rank}'
torch.cuda.set_device(device)
print(f"using device: {device}")
master_process = (ddp_rank == 0) # this process will do logging, checkpointing etc.

# begin logging
logfile = None
if master_process:
    run_id = str(uuid.uuid4())
    logdir = 'logs/%s/' % run_id
    os.makedirs(logdir, exist_ok=True)
    logfile = 'logs/%s.txt' % run_id
    # create the log file
    with open(logfile, "w") as f:
        # begin the log by printing this file (the Python code)
        f.write(code)
        f.write('='*100 + '\n')
def print0(s, logonly=False):
    if master_process:
        with open(logfile, "a") as f:
            if not logonly:
                print(s)
            f.write(s+'\n')
# log information about the hardware/software environment this is running on
# and print the full `nvidia-smi` to file
print0(f"Running python {sys.version}")
print0(f"Running pytorch {torch.version.__version__} compiled for CUDA {torch.version.cuda}\nnvidia-smi:")
import subprocess
result = subprocess.run(['nvidia-smi'], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
print0(f'{result.stdout}', logonly=True)
print0('='*100, logonly=True)

# calculate the number of steps to take in the val loop.
assert args.val_tokens % (args.sequence_length * ddp_world_size) == 0
val_steps = args.val_tokens // (args.sequence_length * ddp_world_size)
# calculate the steps of gradient accumulation required to attain the desired global batch size.
assert args.batch_size % (ddp_world_size) == 0
train_accumulation_steps = args.batch_size // ddp_world_size

# load tokens
train_loader = DistributedDataLoader(args.input_bin, args.sequence_length, ddp_rank, ddp_world_size)
val_loader = DistributedDataLoader(args.input_val_bin, args.sequence_length, ddp_rank, ddp_world_size)
print0(f"Training DataLoader: total number of tokens: {train_loader.total_num_tokens} across {len(train_loader.files)} files")
print0(f"Validation DataLoader: total number of tokens: {val_loader.total_num_tokens} across {len(val_loader.files)} files")
print0('='*100, logonly=True)
inputs_train, targets_train = train_loader.next_batch()

# there are only 50257 unique GPT-2 tokens; we extend to nearest multiple of 128 for efficiency. suggested to me by @Grad62304977.
# this originates from Karpathy's experiments.
num_vocab = 50304
model = GPT(GPTConfig(vocab_size=num_vocab, num_layers=12, num_heads=6, model_dim=768))
model = model.cuda().bfloat16()
for m in model.modules():
    if isinstance(m, CastedLinear):
        m.float()
if hasattr(config, "coordinate_descent_tuning"):
    config.coordinate_descent_tuning = True # suggested by @Chillee
model = torch.compile(model)
# here we wrap model into DDP container
model = DDP(model, device_ids=[ddp_local_rank])
raw_model = model.module # always contains the "raw" unwrapped model

# init the optimizer(s)
optimizer1 = torch.optim.Adam([raw_model.embed.weight, raw_model.value_embeds.weight], lr=0.6, betas=(0.8, 0.95), fused=True)
optimizer2 = torch.optim.Adam([raw_model.lm_head.weight], lr=0.008, betas=(0.8, 0.95), fused=True)
params = list(raw_model.blocks.parameters())
matrix_params = [p for p in params if p.ndim == 2]
scalar_params = [p for p in params if p.ndim < 2] + [raw_model.skip_weights]
optimizer3 = Muon(matrix_params, lr=0.05, momentum=0.95)
optimizer4 = torch.optim.Adam(scalar_params, lr=0.04, betas=(0.8, 0.95), fused=True)
optimizers = [optimizer1, optimizer2, optimizer3, optimizer4]
# learning rate decay scheduler (linear warmup and cooldown)
def get_lr(it):
    assert it <= args.num_iterations
    # 1) linear warmup for warmup_iters steps
    if it < args.warmup_iters:
        return (it+1) / args.warmup_iters
    # 2) constant lr for a while
    elif it < args.num_iterations - args.cooldown_iters:
        return 1.0
    # 3) linear cooldown
    else:
        decay_ratio = (args.num_iterations - it) / args.cooldown_iters
        return decay_ratio
schedulers = [torch.optim.lr_scheduler.LambdaLR(opt, get_lr) for opt in optimizers]

sliding_window_size = torch.tensor(64, dtype=torch.int32, device="cuda")
sw_size_prev = 64
# Start training loop
training_time_ms = 0
# start the clock
torch.cuda.synchronize()
t0 = time.perf_counter()
# begin training
for step in range(args.num_iterations + 1):
    last_step = (step == args.num_iterations)
    # This effectively ignores timing first 10 steps, which are slower for weird reasons.
    # Alternately, and slightly more correctly in terms of benchmarking, we could do 10
    # steps with dummy data first, and then re-initialize the model and reset the loader.
    if step == 10:
        training_time_ms = 0
        t0 = time.perf_counter()
    timed_steps = float('nan') if step <= 11 else (step - 10) + 1 # <= 11 to avoid bug in val

    # Linearly increase the sliding window size over training in chunks of 64 from 64 -> 1792. By @fernbear.bsky.social
    frac_done = step / args.num_iterations # training progress
    sw_size = 64 * (((1 - frac_done) * 64 + frac_done * 1792) // 64)
    if sw_size != sw_size_prev:
        sliding_window_size.copy_(sw_size, non_blocking=True)
        sw_size_prev = sw_size

    # once in a while evaluate the validation dataset
    if (last_step or (args.val_loss_every > 0 and step % args.val_loss_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.perf_counter() - t0)
        # run validation batches
        model.eval()
        val_loader.reset()
        val_loss = 0.0
        for _ in range(val_steps):
            with torch.no_grad():
                inputs_val, targets_val = val_loader.next_batch()
                val_loss += model(inputs_val, targets_val, sliding_window_size)
        dist.all_reduce(val_loss, op=dist.ReduceOp.AVG)
        val_loss /= val_steps
        # log val loss to console and to logfile
        print0(f'step:{step}/{args.num_iterations} val_loss:{val_loss:.4f} train_time:{training_time_ms:.0f}ms step_avg:{training_time_ms/(timed_steps-1):.2f}ms')
        if args.log_norms and master_process:
            print0("============== Weight norms: ==============")
            for name, p in model.named_parameters():
                if p.ndim != 2:
                    continue
                if "embed" in name:
                    l1_to_l2_norm = torch.norm(p.data.float(), p=2, dim=1).mean().item()
                    print0(f"W {name = } | {l1_to_l2_norm = :.7f}")
                else:
                    frobenius_norm = torch.linalg.norm(p.data.float(), ord='fro').item()
                    spectral_norm = torch.linalg.matrix_norm(p.data.float(), ord=2).item()
                    median_sv = torch.median(p.data.float().svd(compute_uv=False).S).item() + 1e-8
                    print0(f"W {name = } | {median_sv = :.7f} | {spectral_norm = :.7f} | {frobenius_norm = :.7f}")
            print0("===========================================")
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.perf_counter()

    # if master_process and (last_step or (args.save_every > 0 and step % args.save_every == 0)):
    #     # stop the clock
    #     torch.cuda.synchronize()
    #     training_time_ms += 1000 * (time.perf_counter() - t0)
    #     # save the state of the training process
    #     log = dict(step=step, code=code, model=raw_model.state_dict(), optimizers=[opt.state_dict() for opt in optimizers])
    #     torch.save(log, 'logs/%s/state_step%06d.pt' % (run_id, step))
    #     # start the clock again
    #     torch.cuda.synchronize()
    #     t0 = time.perf_counter()

    # bit confusing: we want to make sure to eval on 0th iteration
    # but also after the very last iteration. so we loop for step <= num_iterations
    # instead of just < num_iterations (one extra due to <=), only to do
    # the validation/sampling one last time, and then we break right here as we're done.
    if last_step:
        break

    # --------------- TRAINING SECTION BEGIN -----------------
    model.train()
    for i in range(1, train_accumulation_steps+1):
        ctx = model.no_sync() if i < train_accumulation_steps else contextlib.nullcontext()
        with ctx: # there's no need to sync gradients every accumulation step
            loss = model(inputs_train, targets_train, sliding_window_size)
            loss.backward()
            del loss
            inputs_train, targets_train = train_loader.next_batch()
    if train_accumulation_steps != 1:
        for p in model.parameters():
            p.grad /= train_accumulation_steps
    if args.log_norms and master_process and step != 0 and (last_step or (args.val_loss_every > 0 and step % args.val_loss_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.perf_counter() - t0)
        print0("============== Gradient norms: ==============")
        log = dict()
        for name, p in model.named_parameters():
            if p.ndim != 2:
                continue
            if p.grad is None:
                continue
            if "embed" in name:
                l1_to_l2_norm = torch.norm(p.grad.float(), p=2, dim=1).mean().item()
                print0(f"G {name = } | {l1_to_l2_norm = :.7f}")
            else:
                frobenius_norm = torch.linalg.norm(p.grad.float(), ord='fro').item()
                spectral_norm = torch.linalg.matrix_norm(p.grad.float(), ord=2).item()
                S = p.grad.float().svd(compute_uv=False).S
                log[name] = S
                median_sv = torch.median(S).item() + 1e-8
                gram1 = p.grad.float() if p.size(0) <= p.size(1) else p.grad.float().T
                gram2 = gram1 @ gram1.T
                frobenius_norm2 = torch.linalg.norm(gram2, ord='fro').item()
                spectral_norm_est_t2 = frobenius_norm2 ** (0.5)
                gram4 = gram2 @ gram2.T
                frobenius_norm4 = torch.linalg.norm(gram4, ord='fro').item()
                spectral_norm_est_t4 = frobenius_norm4 ** (0.25)
                print0(f"G {name = } | {median_sv = :.7f} | {spectral_norm = :.7f} | {frobenius_norm = :.7f} | {spectral_norm_est_t2 = :.7f} | {spectral_norm_est_t4 = :.7f}")
        torch.save(log, "logs/%s/grad_state_step%06d.pt" % (run_id, step))
        print0("saved grads to logs/%s/grad_state_step%06d.pt" % (run_id, step))
        print0("===========================================")
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.perf_counter()
    # momentum warmup for Muon
    frac = min(step/300, 1)
    for group in optimizer3.param_groups:
        group['momentum'] = (1 - frac) * 0.85 + frac * 0.95
    # step the optimizers and schedulers
    for opt, sched in zip(optimizers, schedulers):
        opt.step()
        sched.step()
    # null the gradients
    model.zero_grad(set_to_none=True)
    # --------------- TRAINING SECTION END -------------------
    # everything that follows now is just diagnostics, prints, logging, etc.
    approx_time = training_time_ms + 1000 * (time.perf_counter() - t0)
    print0(f"step:{step+1}/{args.num_iterations} train_time:{approx_time:.0f}ms step_avg:{approx_time/timed_steps:.2f}ms")

print0(f"peak memory consumption: {torch.cuda.max_memory_allocated() // 1024 // 1024} MiB")

# -------------------------------------------------------------------------
# clean up nice
dist.destroy_process_group()
====================================================================================================
Running python 3.10.12 (main, Sep 11 2024, 15:47:36) [GCC 11.4.0]
Running pytorch 2.6.0.dev20241203+cu124 compiled for CUDA 12.4
nvidia-smi:
Wed Dec 11 14:34:19 2024       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 560.35.03              Driver Version: 560.35.03      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H100 80GB HBM3          On  |   00000000:0A:00.0 Off |                    0 |
| N/A   23C    P0             69W /  700W |       4MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA H100 80GB HBM3          On  |   00000000:0F:00.0 Off |                    0 |
| N/A   23C    P0             82W /  700W |      23MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA H100 80GB HBM3          On  |   00000000:10:00.0 Off |                    0 |
| N/A   23C    P0             76W /  700W |      23MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA H100 80GB HBM3          On  |   00000000:11:00.0 Off |                    0 |
| N/A   24C    P0             85W /  700W |      23MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
+-----------------------------------------------------------------------------------------+

====================================================================================================
Training DataLoader: total number of tokens: 900000000 across 9 files
Validation DataLoader: total number of tokens: 100000000 across 1 files
====================================================================================================
step:0/1480 val_loss:10.8258 train_time:0ms step_avg:nanms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 27.7048492
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 0.4659798 | spectral_norm = 1.1528020 | frobenius_norm = 15.9970598
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 0.4664021 | spectral_norm = 1.1406485 | frobenius_norm = 16.0039310
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 0.4667232 | spectral_norm = 1.1570581 | frobenius_norm = 15.9997463
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 1.1057316 | spectral_norm = 1.7294513 | frobenius_norm = 32.0131950
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 0.4666883 | spectral_norm = 1.1479228 | frobenius_norm = 16.0175476
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 0.4668983 | spectral_norm = 1.1481255 | frobenius_norm = 16.0075321
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 0.4666663 | spectral_norm = 1.1438590 | frobenius_norm = 15.9813519
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 1.1068062 | spectral_norm = 1.7318592 | frobenius_norm = 32.0057526
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 0.4658037 | spectral_norm = 1.1431326 | frobenius_norm = 16.0001392
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 0.4663929 | spectral_norm = 1.1498477 | frobenius_norm = 16.0125084
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 0.4675128 | spectral_norm = 1.1391181 | frobenius_norm = 16.0082130
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 1.1031516 | spectral_norm = 1.7199546 | frobenius_norm = 32.0009613
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 0.4660843 | spectral_norm = 1.1469418 | frobenius_norm = 15.9908915
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 0.4659975 | spectral_norm = 1.1521078 | frobenius_norm = 15.9877758
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 0.4658088 | spectral_norm = 1.1390430 | frobenius_norm = 16.0032959
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 1.1050390 | spectral_norm = 1.7379873 | frobenius_norm = 32.0061951
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 0.4672275 | spectral_norm = 1.1499859 | frobenius_norm = 16.0149574
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 0.4662328 | spectral_norm = 1.1350530 | frobenius_norm = 16.0086517
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 0.4672491 | spectral_norm = 1.1396073 | frobenius_norm = 16.0075607
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 1.1039091 | spectral_norm = 1.7266896 | frobenius_norm = 32.0003853
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 0.4656476 | spectral_norm = 1.1498835 | frobenius_norm = 15.9830580
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 0.4654225 | spectral_norm = 1.1451546 | frobenius_norm = 15.9934549
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 0.4677319 | spectral_norm = 1.1447750 | frobenius_norm = 16.0198975
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 1.1054295 | spectral_norm = 1.7236252 | frobenius_norm = 31.9996033
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 0.4651812 | spectral_norm = 1.1545438 | frobenius_norm = 15.9938278
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 0.4661483 | spectral_norm = 1.1470234 | frobenius_norm = 16.0046024
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 0.4658745 | spectral_norm = 1.1438569 | frobenius_norm = 15.9990349
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 1.1075070 | spectral_norm = 1.7333637 | frobenius_norm = 32.0188675
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 0.4654107 | spectral_norm = 1.1511899 | frobenius_norm = 16.0064983
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 0.4653058 | spectral_norm = 1.1433733 | frobenius_norm = 16.0121307
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 0.4660176 | spectral_norm = 1.1544520 | frobenius_norm = 16.0152245
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 1.1037908 | spectral_norm = 1.7325349 | frobenius_norm = 32.0035706
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 0.4691461 | spectral_norm = 1.1569440 | frobenius_norm = 16.0047512
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 0.4637561 | spectral_norm = 1.1568495 | frobenius_norm = 15.9817123
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 0.4651510 | spectral_norm = 1.1573124 | frobenius_norm = 15.9909306
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 1.1066146 | spectral_norm = 1.7269949 | frobenius_norm = 32.0007858
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 0.4658159 | spectral_norm = 1.1389570 | frobenius_norm = 15.9875383
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 0.4662949 | spectral_norm = 1.1438944 | frobenius_norm = 16.0080452
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 0.4667253 | spectral_norm = 1.1505997 | frobenius_norm = 16.0094948
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 1.1046192 | spectral_norm = 1.7259482 | frobenius_norm = 31.9892693
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 0.4663324 | spectral_norm = 1.1528729 | frobenius_norm = 16.0043888
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 0.4646106 | spectral_norm = 1.1370538 | frobenius_norm = 15.9852457
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 0.4658431 | spectral_norm = 1.1491776 | frobenius_norm = 15.9893942
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 1.1053419 | spectral_norm = 1.7305599 | frobenius_norm = 31.9979496
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 0.4646469 | spectral_norm = 1.1618242 | frobenius_norm = 15.9998178
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 0.4655768 | spectral_norm = 1.1498022 | frobenius_norm = 16.0131607
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 0.4650176 | spectral_norm = 1.1454324 | frobenius_norm = 16.0012035
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 1.1060492 | spectral_norm = 1.7293037 | frobenius_norm = 32.0110283
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 0.0000000 | spectral_norm = 0.0000000 | frobenius_norm = 0.0000000
W name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 67.8829117
W name = 'module._orig_mod.lm_head.weight' | median_sv = 0.0000000 | spectral_norm = -0.0000000 | frobenius_norm = 0.0000000
===========================================
step:1/1480 train_time:28000ms step_avg:nanms
step:2/1480 train_time:28269ms step_avg:nanms
step:3/1480 train_time:28542ms step_avg:nanms
step:4/1480 train_time:28816ms step_avg:nanms
step:5/1480 train_time:29091ms step_avg:nanms
step:6/1480 train_time:29368ms step_avg:nanms
step:7/1480 train_time:29643ms step_avg:nanms
step:8/1480 train_time:29917ms step_avg:nanms
step:9/1480 train_time:30192ms step_avg:nanms
step:10/1480 train_time:30468ms step_avg:nanms
step:11/1480 train_time:276ms step_avg:nanms
step:12/1480 train_time:551ms step_avg:nanms
step:13/1480 train_time:826ms step_avg:275.48ms
step:14/1480 train_time:1103ms step_avg:275.81ms
step:15/1480 train_time:1380ms step_avg:276.03ms
step:16/1480 train_time:1657ms step_avg:276.19ms
step:17/1480 train_time:1932ms step_avg:276.02ms
step:18/1480 train_time:2209ms step_avg:276.10ms
step:19/1480 train_time:2484ms step_avg:275.95ms
step:20/1480 train_time:2759ms step_avg:275.93ms
step:21/1480 train_time:3034ms step_avg:275.81ms
step:22/1480 train_time:3309ms step_avg:275.75ms
step:23/1480 train_time:3585ms step_avg:275.77ms
step:24/1480 train_time:3863ms step_avg:275.91ms
step:25/1480 train_time:4141ms step_avg:276.07ms
step:26/1480 train_time:4417ms step_avg:276.03ms
step:27/1480 train_time:4694ms step_avg:276.10ms
step:28/1480 train_time:4968ms step_avg:276.01ms
step:29/1480 train_time:5243ms step_avg:275.94ms
step:30/1480 train_time:5519ms step_avg:275.97ms
step:31/1480 train_time:5795ms step_avg:275.98ms
step:32/1480 train_time:6070ms step_avg:275.92ms
step:33/1480 train_time:6346ms step_avg:275.93ms
step:34/1480 train_time:6622ms step_avg:275.92ms
step:35/1480 train_time:6898ms step_avg:275.92ms
step:36/1480 train_time:7172ms step_avg:275.85ms
step:37/1480 train_time:7449ms step_avg:275.88ms
step:38/1480 train_time:7723ms step_avg:275.82ms
step:39/1480 train_time:8001ms step_avg:275.88ms
step:40/1480 train_time:8278ms step_avg:275.94ms
step:41/1480 train_time:8553ms step_avg:275.91ms
step:42/1480 train_time:8832ms step_avg:275.99ms
step:43/1480 train_time:9105ms step_avg:275.90ms
step:44/1480 train_time:9383ms step_avg:275.96ms
step:45/1480 train_time:9659ms step_avg:275.98ms
step:46/1480 train_time:9933ms step_avg:275.93ms
step:47/1480 train_time:10207ms step_avg:275.86ms
step:48/1480 train_time:10483ms step_avg:275.86ms
step:49/1480 train_time:10758ms step_avg:275.85ms
step:50/1480 train_time:11033ms step_avg:275.83ms
step:51/1480 train_time:11309ms step_avg:275.83ms
step:52/1480 train_time:11583ms step_avg:275.79ms
step:53/1480 train_time:11862ms step_avg:275.85ms
step:54/1480 train_time:12136ms step_avg:275.83ms
step:55/1480 train_time:12415ms step_avg:275.89ms
step:56/1480 train_time:12691ms step_avg:275.88ms
step:57/1480 train_time:12966ms step_avg:275.87ms
step:58/1480 train_time:13242ms step_avg:275.88ms
step:59/1480 train_time:13521ms step_avg:275.93ms
step:60/1480 train_time:13797ms step_avg:275.94ms
step:61/1480 train_time:14073ms step_avg:275.94ms
step:62/1480 train_time:14350ms step_avg:275.96ms
step:63/1480 train_time:14625ms step_avg:275.94ms
step:64/1480 train_time:14901ms step_avg:275.94ms
step:65/1480 train_time:15177ms step_avg:275.94ms
step:66/1480 train_time:15454ms step_avg:275.97ms
step:67/1480 train_time:15729ms step_avg:275.95ms
step:68/1480 train_time:16004ms step_avg:275.94ms
step:69/1480 train_time:16281ms step_avg:275.94ms
step:70/1480 train_time:16558ms step_avg:275.97ms
step:71/1480 train_time:16833ms step_avg:275.96ms
step:72/1480 train_time:17108ms step_avg:275.94ms
step:73/1480 train_time:17383ms step_avg:275.92ms
step:74/1480 train_time:17659ms step_avg:275.92ms
step:75/1480 train_time:17935ms step_avg:275.92ms
step:76/1480 train_time:18210ms step_avg:275.91ms
step:77/1480 train_time:18486ms step_avg:275.92ms
step:78/1480 train_time:18762ms step_avg:275.91ms
step:79/1480 train_time:19039ms step_avg:275.93ms
step:80/1480 train_time:19318ms step_avg:275.97ms
step:81/1480 train_time:19594ms step_avg:275.97ms
step:82/1480 train_time:19868ms step_avg:275.95ms
step:83/1480 train_time:20144ms step_avg:275.95ms
step:84/1480 train_time:20422ms step_avg:275.97ms
step:85/1480 train_time:20698ms step_avg:275.97ms
step:86/1480 train_time:20973ms step_avg:275.96ms
step:87/1480 train_time:21249ms step_avg:275.96ms
step:88/1480 train_time:21526ms step_avg:275.97ms
step:89/1480 train_time:21803ms step_avg:275.99ms
step:90/1480 train_time:22080ms step_avg:276.00ms
step:91/1480 train_time:22356ms step_avg:276.00ms
step:92/1480 train_time:22632ms step_avg:276.00ms
step:93/1480 train_time:22907ms step_avg:275.98ms
step:94/1480 train_time:23183ms step_avg:275.98ms
step:95/1480 train_time:23460ms step_avg:276.00ms
step:96/1480 train_time:23737ms step_avg:276.01ms
step:97/1480 train_time:24013ms step_avg:276.02ms
step:98/1480 train_time:24287ms step_avg:275.99ms
step:99/1480 train_time:24562ms step_avg:275.98ms
step:100/1480 train_time:24839ms step_avg:275.99ms
step:101/1480 train_time:25116ms step_avg:276.00ms
step:102/1480 train_time:25391ms step_avg:275.99ms
step:103/1480 train_time:25665ms step_avg:275.97ms
step:104/1480 train_time:25941ms step_avg:275.97ms
step:105/1480 train_time:26219ms step_avg:275.98ms
step:106/1480 train_time:26495ms step_avg:275.99ms
step:107/1480 train_time:26769ms step_avg:275.97ms
step:108/1480 train_time:27046ms step_avg:275.98ms
step:109/1480 train_time:27322ms step_avg:275.98ms
step:110/1480 train_time:27599ms step_avg:275.99ms
step:111/1480 train_time:27884ms step_avg:276.08ms
step:112/1480 train_time:28168ms step_avg:276.16ms
step:113/1480 train_time:28454ms step_avg:276.25ms
step:114/1480 train_time:28739ms step_avg:276.33ms
step:115/1480 train_time:29023ms step_avg:276.41ms
step:116/1480 train_time:29307ms step_avg:276.48ms
step:117/1480 train_time:29591ms step_avg:276.55ms
step:118/1480 train_time:29875ms step_avg:276.62ms
step:119/1480 train_time:30159ms step_avg:276.69ms
step:120/1480 train_time:30447ms step_avg:276.79ms
step:121/1480 train_time:30731ms step_avg:276.86ms
step:122/1480 train_time:31017ms step_avg:276.94ms
step:123/1480 train_time:31301ms step_avg:277.00ms
step:124/1480 train_time:31586ms step_avg:277.07ms
step:125/1480 train_time:31870ms step_avg:277.13ms
step:125/1480 val_loss:4.4083 train_time:31884ms step_avg:277.25ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 110.3288040
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 1.0647993 | spectral_norm = 3.6505501 | frobenius_norm = 36.6034126
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 0.9685424 | spectral_norm = 4.5011511 | frobenius_norm = 34.2348976
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 0.9822439 | spectral_norm = 3.0771492 | frobenius_norm = 35.7306061
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 1.0871075 | spectral_norm = 2.5842481 | frobenius_norm = 36.0957069
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 2.3737376 | spectral_norm = 5.6517553 | frobenius_norm = 70.4213791
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 1.3032308 | spectral_norm = 2.8542533 | frobenius_norm = 38.8441162
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 0.9995599 | spectral_norm = 3.2951851 | frobenius_norm = 34.8742981
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 0.9709250 | spectral_norm = 3.5932195 | frobenius_norm = 34.0238953
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 0.9463788 | spectral_norm = 3.4887686 | frobenius_norm = 36.5140114
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 1.1430252 | spectral_norm = 2.6142581 | frobenius_norm = 37.7830620
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 2.6359632 | spectral_norm = 5.5451012 | frobenius_norm = 77.7149811
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 1.4164337 | spectral_norm = 2.9766703 | frobenius_norm = 41.9375038
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 0.9619044 | spectral_norm = 2.9432480 | frobenius_norm = 34.4444733
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 0.9678621 | spectral_norm = 3.0339565 | frobenius_norm = 34.5862083
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 0.9603114 | spectral_norm = 3.6415832 | frobenius_norm = 37.5335999
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 1.1755869 | spectral_norm = 2.7431419 | frobenius_norm = 39.2628479
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 2.7129378 | spectral_norm = 5.4680862 | frobenius_norm = 80.0682373
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 1.4351240 | spectral_norm = 3.0857155 | frobenius_norm = 42.5319519
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 0.9648145 | spectral_norm = 3.2153676 | frobenius_norm = 34.0900497
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 0.9646394 | spectral_norm = 3.1013958 | frobenius_norm = 34.0721550
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 0.9341458 | spectral_norm = 3.6731577 | frobenius_norm = 37.3063698
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 1.1242064 | spectral_norm = 2.7234378 | frobenius_norm = 37.9352188
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 2.7132306 | spectral_norm = 5.3835206 | frobenius_norm = 80.1923523
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 1.4297239 | spectral_norm = 3.0665970 | frobenius_norm = 42.5565453
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 0.9311400 | spectral_norm = 2.9090080 | frobenius_norm = 33.3963356
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 0.9537056 | spectral_norm = 2.9659498 | frobenius_norm = 34.3970413
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 0.8874425 | spectral_norm = 3.6009367 | frobenius_norm = 36.8151894
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 1.0984624 | spectral_norm = 2.8318851 | frobenius_norm = 38.0405846
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 2.7392042 | spectral_norm = 5.4176784 | frobenius_norm = 81.2226791
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 1.4302678 | spectral_norm = 3.0611367 | frobenius_norm = 42.6724243
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 0.9401265 | spectral_norm = 3.0195715 | frobenius_norm = 33.4950829
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 0.9516341 | spectral_norm = 2.8962924 | frobenius_norm = 34.0166588
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 0.9016523 | spectral_norm = 3.6930807 | frobenius_norm = 36.8507233
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 1.1090053 | spectral_norm = 2.8208990 | frobenius_norm = 37.9430389
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 2.7421510 | spectral_norm = 5.5827537 | frobenius_norm = 81.5918045
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 1.4075350 | spectral_norm = 2.9727225 | frobenius_norm = 42.2332077
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 0.9289141 | spectral_norm = 2.9330790 | frobenius_norm = 33.1869507
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 0.9331287 | spectral_norm = 2.9307294 | frobenius_norm = 33.7173729
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 0.8592538 | spectral_norm = 3.4743919 | frobenius_norm = 35.8110580
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 1.0530939 | spectral_norm = 2.9507735 | frobenius_norm = 36.9635506
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 2.7501543 | spectral_norm = 5.7080760 | frobenius_norm = 82.3601761
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 1.3797907 | spectral_norm = 2.9330397 | frobenius_norm = 41.8727760
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 0.9434513 | spectral_norm = 3.0390093 | frobenius_norm = 33.6919594
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 0.9590561 | spectral_norm = 2.8777373 | frobenius_norm = 34.4258652
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 0.8329132 | spectral_norm = 3.5396900 | frobenius_norm = 35.2472382
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 1.0848055 | spectral_norm = 2.9914496 | frobenius_norm = 37.6351547
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 2.7515609 | spectral_norm = 5.8062472 | frobenius_norm = 82.3830185
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 1.3730046 | spectral_norm = 2.9147353 | frobenius_norm = 41.6332436
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 0.9271175 | spectral_norm = 3.0445971 | frobenius_norm = 33.4379959
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 0.9395904 | spectral_norm = 2.9753134 | frobenius_norm = 33.9661827
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 0.8406555 | spectral_norm = 3.3524947 | frobenius_norm = 34.8709641
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 1.0963477 | spectral_norm = 2.7585850 | frobenius_norm = 37.6455193
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 2.7340667 | spectral_norm = 5.9571271 | frobenius_norm = 81.9154816
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 1.3494461 | spectral_norm = 2.9230201 | frobenius_norm = 41.0820618
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 0.9345611 | spectral_norm = 3.0184412 | frobenius_norm = 33.5817375
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 0.9608170 | spectral_norm = 3.0449147 | frobenius_norm = 34.4003716
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 0.8622487 | spectral_norm = 3.3614860 | frobenius_norm = 35.2967110
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 1.1385653 | spectral_norm = 2.7843215 | frobenius_norm = 38.7224045
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 2.7075088 | spectral_norm = 5.9648137 | frobenius_norm = 81.1247253
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 1.3288090 | spectral_norm = 2.9204221 | frobenius_norm = 40.5746994
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 0.8926183 | spectral_norm = 2.9740839 | frobenius_norm = 32.9644547
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 0.8972519 | spectral_norm = 3.0509481 | frobenius_norm = 33.3170052
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 0.8448082 | spectral_norm = 3.2885742 | frobenius_norm = 34.5938416
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 1.1823646 | spectral_norm = 2.8495603 | frobenius_norm = 40.5706635
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 2.6955628 | spectral_norm = 5.9963746 | frobenius_norm = 80.5750656
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 1.3051407 | spectral_norm = 2.9128582 | frobenius_norm = 39.7798805
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 0.9122385 | spectral_norm = 3.0996246 | frobenius_norm = 32.9625168
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 0.9158748 | spectral_norm = 3.2572601 | frobenius_norm = 33.5537529
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 0.8314505 | spectral_norm = 3.0678358 | frobenius_norm = 33.8165665
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 1.1372163 | spectral_norm = 2.7602897 | frobenius_norm = 39.0466118
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 2.6427121 | spectral_norm = 6.0381331 | frobenius_norm = 79.2588806
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 1.2561846 | spectral_norm = 2.9056215 | frobenius_norm = 38.6568718
W name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 144.6612244
W name = 'module._orig_mod.lm_head.weight' | median_sv = 10.4866600 | spectral_norm = 131.8448181 | frobenius_norm = 386.4027100
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 0.0000004
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 0.0000329 | spectral_norm = 0.0049282 | frobenius_norm = 0.0064047 | spectral_norm_est_t2 = 0.0049704 | spectral_norm_est_t4 = 0.0049283
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 0.0000355 | spectral_norm = 0.0045493 | frobenius_norm = 0.0068542 | spectral_norm_est_t2 = 0.0047033 | spectral_norm_est_t4 = 0.0045527
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 0.0000278 | spectral_norm = 0.0266530 | frobenius_norm = 0.0276607 | spectral_norm_est_t2 = 0.0266640 | spectral_norm_est_t4 = 0.0266513
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 0.0000782 | spectral_norm = 0.0395106 | frobenius_norm = 0.0415830 | spectral_norm_est_t2 = 0.0395237 | spectral_norm_est_t4 = 0.0395118
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 0.0001176 | spectral_norm = 0.0119420 | frobenius_norm = 0.0143394 | spectral_norm_est_t2 = 0.0119648 | spectral_norm_est_t4 = 0.0119421
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 0.0001825 | spectral_norm = 0.0231980 | frobenius_norm = 0.0263960 | spectral_norm_est_t2 = 0.0232185 | spectral_norm_est_t4 = 0.0231998
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 0.0000289 | spectral_norm = 0.0070290 | frobenius_norm = 0.0081911 | spectral_norm_est_t2 = 0.0070429 | spectral_norm_est_t4 = 0.0070287
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 0.0000322 | spectral_norm = 0.0038995 | frobenius_norm = 0.0072070 | spectral_norm_est_t2 = 0.0044939 | spectral_norm_est_t4 = 0.0040168
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 0.0000350 | spectral_norm = 0.0413652 | frobenius_norm = 0.0424112 | spectral_norm_est_t2 = 0.0413711 | spectral_norm_est_t4 = 0.0413649
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 0.0000751 | spectral_norm = 0.0203368 | frobenius_norm = 0.0242586 | spectral_norm_est_t2 = 0.0203997 | spectral_norm_est_t4 = 0.0203364
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 0.0000883 | spectral_norm = 0.0121682 | frobenius_norm = 0.0146927 | spectral_norm_est_t2 = 0.0121934 | spectral_norm_est_t4 = 0.0121700
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 0.0001475 | spectral_norm = 0.0205950 | frobenius_norm = 0.0236840 | spectral_norm_est_t2 = 0.0206155 | spectral_norm_est_t4 = 0.0205963
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 0.0000351 | spectral_norm = 0.0089638 | frobenius_norm = 0.0104070 | spectral_norm_est_t2 = 0.0089783 | spectral_norm_est_t4 = 0.0089634
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 0.0000379 | spectral_norm = 0.0048223 | frobenius_norm = 0.0087516 | spectral_norm_est_t2 = 0.0054917 | spectral_norm_est_t4 = 0.0049444
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 0.0000211 | spectral_norm = 0.0297308 | frobenius_norm = 0.0302099 | spectral_norm_est_t2 = 0.0297314 | spectral_norm_est_t4 = 0.0297306
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 0.0000657 | spectral_norm = 0.0157796 | frobenius_norm = 0.0189574 | spectral_norm_est_t2 = 0.0158631 | spectral_norm_est_t4 = 0.0157797
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 0.0000777 | spectral_norm = 0.0118861 | frobenius_norm = 0.0141093 | spectral_norm_est_t2 = 0.0119116 | spectral_norm_est_t4 = 0.0118880
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 0.0001282 | spectral_norm = 0.0182409 | frobenius_norm = 0.0212360 | spectral_norm_est_t2 = 0.0182670 | spectral_norm_est_t4 = 0.0182440
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 0.0000259 | spectral_norm = 0.0055111 | frobenius_norm = 0.0066520 | spectral_norm_est_t2 = 0.0055272 | spectral_norm_est_t4 = 0.0055109
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 0.0000280 | spectral_norm = 0.0029755 | frobenius_norm = 0.0063874 | spectral_norm_est_t2 = 0.0037560 | spectral_norm_est_t4 = 0.0032064
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 0.0000198 | spectral_norm = 0.0251169 | frobenius_norm = 0.0258522 | spectral_norm_est_t2 = 0.0251203 | spectral_norm_est_t4 = 0.0251167
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 0.0000498 | spectral_norm = 0.0114911 | frobenius_norm = 0.0147243 | spectral_norm_est_t2 = 0.0115781 | spectral_norm_est_t4 = 0.0114912
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 0.0000672 | spectral_norm = 0.0114449 | frobenius_norm = 0.0137885 | spectral_norm_est_t2 = 0.0114794 | spectral_norm_est_t4 = 0.0114462
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 0.0001126 | spectral_norm = 0.0170433 | frobenius_norm = 0.0199342 | spectral_norm_est_t2 = 0.0170716 | spectral_norm_est_t4 = 0.0170460
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 0.0000294 | spectral_norm = 0.0096288 | frobenius_norm = 0.0106823 | spectral_norm_est_t2 = 0.0096410 | spectral_norm_est_t4 = 0.0096285
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 0.0000313 | spectral_norm = 0.0050102 | frobenius_norm = 0.0080177 | spectral_norm_est_t2 = 0.0053780 | spectral_norm_est_t4 = 0.0050462
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 0.0000127 | spectral_norm = 0.0181491 | frobenius_norm = 0.0185771 | spectral_norm_est_t2 = 0.0181501 | spectral_norm_est_t4 = 0.0181490
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 0.0000395 | spectral_norm = 0.0098308 | frobenius_norm = 0.0122341 | spectral_norm_est_t2 = 0.0098868 | spectral_norm_est_t4 = 0.0098313
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 0.0000564 | spectral_norm = 0.0098871 | frobenius_norm = 0.0119106 | spectral_norm_est_t2 = 0.0099115 | spectral_norm_est_t4 = 0.0098872
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 0.0000967 | spectral_norm = 0.0145505 | frobenius_norm = 0.0171914 | spectral_norm_est_t2 = 0.0145746 | spectral_norm_est_t4 = 0.0145514
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 0.0000222 | spectral_norm = 0.0059581 | frobenius_norm = 0.0070040 | spectral_norm_est_t2 = 0.0059721 | spectral_norm_est_t4 = 0.0059580
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 0.0000241 | spectral_norm = 0.0038269 | frobenius_norm = 0.0067741 | spectral_norm_est_t2 = 0.0042770 | spectral_norm_est_t4 = 0.0038696
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 0.0000107 | spectral_norm = 0.0136145 | frobenius_norm = 0.0140800 | spectral_norm_est_t2 = 0.0136173 | spectral_norm_est_t4 = 0.0136147
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 0.0000324 | spectral_norm = 0.0075322 | frobenius_norm = 0.0098268 | spectral_norm_est_t2 = 0.0076149 | spectral_norm_est_t4 = 0.0075327
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 0.0000462 | spectral_norm = 0.0084458 | frobenius_norm = 0.0103145 | spectral_norm_est_t2 = 0.0084718 | spectral_norm_est_t4 = 0.0084460
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 0.0000816 | spectral_norm = 0.0126710 | frobenius_norm = 0.0148569 | spectral_norm_est_t2 = 0.0126905 | spectral_norm_est_t4 = 0.0126730
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 0.0000172 | spectral_norm = 0.0045873 | frobenius_norm = 0.0054045 | spectral_norm_est_t2 = 0.0046010 | spectral_norm_est_t4 = 0.0045873
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 0.0000179 | spectral_norm = 0.0032282 | frobenius_norm = 0.0053659 | spectral_norm_est_t2 = 0.0036096 | spectral_norm_est_t4 = 0.0032928
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 0.0000049 | spectral_norm = 0.0073606 | frobenius_norm = 0.0076031 | spectral_norm_est_t2 = 0.0073621 | spectral_norm_est_t4 = 0.0073606
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 0.0000221 | spectral_norm = 0.0055273 | frobenius_norm = 0.0066699 | spectral_norm_est_t2 = 0.0055518 | spectral_norm_est_t4 = 0.0055275
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 0.0000321 | spectral_norm = 0.0060428 | frobenius_norm = 0.0072939 | spectral_norm_est_t2 = 0.0060606 | spectral_norm_est_t4 = 0.0060436
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 0.0000578 | spectral_norm = 0.0105980 | frobenius_norm = 0.0122579 | spectral_norm_est_t2 = 0.0106152 | spectral_norm_est_t4 = 0.0106007
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 0.0000144 | spectral_norm = 0.0028458 | frobenius_norm = 0.0036719 | spectral_norm_est_t2 = 0.0028664 | spectral_norm_est_t4 = 0.0028458
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 0.0000153 | spectral_norm = 0.0020489 | frobenius_norm = 0.0036203 | spectral_norm_est_t2 = 0.0022314 | spectral_norm_est_t4 = 0.0020599
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 0.0000055 | spectral_norm = 0.0090304 | frobenius_norm = 0.0092758 | spectral_norm_est_t2 = 0.0090317 | spectral_norm_est_t4 = 0.0090305
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 0.0000228 | spectral_norm = 0.0061379 | frobenius_norm = 0.0070011 | spectral_norm_est_t2 = 0.0061485 | spectral_norm_est_t4 = 0.0061380
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 0.0000324 | spectral_norm = 0.0063117 | frobenius_norm = 0.0075143 | spectral_norm_est_t2 = 0.0063283 | spectral_norm_est_t4 = 0.0063117
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 0.0000598 | spectral_norm = 0.0116126 | frobenius_norm = 0.0131992 | spectral_norm_est_t2 = 0.0116277 | spectral_norm_est_t4 = 0.0116149
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 0.0000196 | spectral_norm = 0.0049505 | frobenius_norm = 0.0061080 | spectral_norm_est_t2 = 0.0050031 | spectral_norm_est_t4 = 0.0049512
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 0.0000207 | spectral_norm = 0.0032166 | frobenius_norm = 0.0055578 | spectral_norm_est_t2 = 0.0035647 | spectral_norm_est_t4 = 0.0032588
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 0.0000052 | spectral_norm = 0.0076467 | frobenius_norm = 0.0079009 | spectral_norm_est_t2 = 0.0076481 | spectral_norm_est_t4 = 0.0076467
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 0.0000310 | spectral_norm = 0.0091007 | frobenius_norm = 0.0104794 | spectral_norm_est_t2 = 0.0091344 | spectral_norm_est_t4 = 0.0091008
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 0.0000355 | spectral_norm = 0.0072294 | frobenius_norm = 0.0084519 | spectral_norm_est_t2 = 0.0072451 | spectral_norm_est_t4 = 0.0072295
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 0.0000650 | spectral_norm = 0.0142720 | frobenius_norm = 0.0159555 | spectral_norm_est_t2 = 0.0142877 | spectral_norm_est_t4 = 0.0142742
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 0.0000197 | spectral_norm = 0.0048528 | frobenius_norm = 0.0057839 | spectral_norm_est_t2 = 0.0048729 | spectral_norm_est_t4 = 0.0048528
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 0.0000208 | spectral_norm = 0.0031671 | frobenius_norm = 0.0050915 | spectral_norm_est_t2 = 0.0033702 | spectral_norm_est_t4 = 0.0031792
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 0.0000058 | spectral_norm = 0.0081033 | frobenius_norm = 0.0083016 | spectral_norm_est_t2 = 0.0081042 | spectral_norm_est_t4 = 0.0081034
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 0.0000371 | spectral_norm = 0.0128954 | frobenius_norm = 0.0135661 | spectral_norm_est_t2 = 0.0128983 | spectral_norm_est_t4 = 0.0128957
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 0.0000404 | spectral_norm = 0.0082264 | frobenius_norm = 0.0095329 | spectral_norm_est_t2 = 0.0082446 | spectral_norm_est_t4 = 0.0082285
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 0.0000721 | spectral_norm = 0.0175391 | frobenius_norm = 0.0194011 | spectral_norm_est_t2 = 0.0175563 | spectral_norm_est_t4 = 0.0175417
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 0.0000417 | spectral_norm = 0.0119951 | frobenius_norm = 0.0136054 | spectral_norm_est_t2 = 0.0120166 | spectral_norm_est_t4 = 0.0119949
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 0.0000462 | spectral_norm = 0.0067049 | frobenius_norm = 0.0106224 | spectral_norm_est_t2 = 0.0070941 | spectral_norm_est_t4 = 0.0067294
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 0.0000089 | spectral_norm = 0.0124951 | frobenius_norm = 0.0127644 | spectral_norm_est_t2 = 0.0124959 | spectral_norm_est_t4 = 0.0124952
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 0.0000644 | spectral_norm = 0.0311419 | frobenius_norm = 0.0320697 | spectral_norm_est_t2 = 0.0311432 | spectral_norm_est_t4 = 0.0311409
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 0.0000621 | spectral_norm = 0.0151725 | frobenius_norm = 0.0168428 | spectral_norm_est_t2 = 0.0151882 | spectral_norm_est_t4 = 0.0151728
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 0.0001074 | spectral_norm = 0.0348525 | frobenius_norm = 0.0377997 | spectral_norm_est_t2 = 0.0348870 | spectral_norm_est_t4 = 0.0348588
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 0.0000363 | spectral_norm = 0.0120886 | frobenius_norm = 0.0130748 | spectral_norm_est_t2 = 0.0121004 | spectral_norm_est_t4 = 0.0120887
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 0.0000396 | spectral_norm = 0.0054026 | frobenius_norm = 0.0086766 | spectral_norm_est_t2 = 0.0059988 | spectral_norm_est_t4 = 0.0055345
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 0.0000101 | spectral_norm = 0.0157591 | frobenius_norm = 0.0160198 | spectral_norm_est_t2 = 0.0157602 | spectral_norm_est_t4 = 0.0157594
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 0.0000546 | spectral_norm = 0.0461732 | frobenius_norm = 0.0467030 | spectral_norm_est_t2 = 0.0461759 | spectral_norm_est_t4 = 0.0461752
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 0.0000776 | spectral_norm = 0.0236908 | frobenius_norm = 0.0256372 | spectral_norm_est_t2 = 0.0237090 | spectral_norm_est_t4 = 0.0236910
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 0.0001283 | spectral_norm = 0.0606808 | frobenius_norm = 0.0639195 | spectral_norm_est_t2 = 0.0607129 | spectral_norm_est_t4 = 0.0606916
G name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 0.0000004
G name = 'module._orig_mod.lm_head.weight' | median_sv = 0.0005228 | spectral_norm = 0.1939544 | frobenius_norm = 0.2172057 | spectral_norm_est_t2 = 0.1947593 | spectral_norm_est_t4 = 0.1939621
saved grads to logs/1ef9fb63-cc79-4219-bbf9-a03b83709afa/grad_state_step000125.pt
===========================================
step:126/1480 train_time:32179ms step_avg:277.41ms
step:127/1480 train_time:32447ms step_avg:277.32ms
step:128/1480 train_time:32731ms step_avg:277.38ms
step:129/1480 train_time:33013ms step_avg:277.42ms
step:130/1480 train_time:33300ms step_avg:277.50ms
step:131/1480 train_time:33583ms step_avg:277.55ms
step:132/1480 train_time:33867ms step_avg:277.60ms
step:133/1480 train_time:34150ms step_avg:277.64ms
step:134/1480 train_time:34437ms step_avg:277.71ms
step:135/1480 train_time:34721ms step_avg:277.77ms
step:136/1480 train_time:35005ms step_avg:277.82ms
step:137/1480 train_time:35288ms step_avg:277.86ms
step:138/1480 train_time:35573ms step_avg:277.91ms
step:139/1480 train_time:35857ms step_avg:277.96ms
step:140/1480 train_time:36141ms step_avg:278.00ms
step:141/1480 train_time:36424ms step_avg:278.05ms
step:142/1480 train_time:36708ms step_avg:278.09ms
step:143/1480 train_time:36992ms step_avg:278.14ms
step:144/1480 train_time:37277ms step_avg:278.19ms
step:145/1480 train_time:37562ms step_avg:278.24ms
step:146/1480 train_time:37845ms step_avg:278.27ms
step:147/1480 train_time:38128ms step_avg:278.31ms
step:148/1480 train_time:38414ms step_avg:278.36ms
step:149/1480 train_time:38701ms step_avg:278.43ms
step:150/1480 train_time:38984ms step_avg:278.45ms
step:151/1480 train_time:39268ms step_avg:278.50ms
step:152/1480 train_time:39553ms step_avg:278.54ms
step:153/1480 train_time:39839ms step_avg:278.59ms
step:154/1480 train_time:40123ms step_avg:278.63ms
step:155/1480 train_time:40406ms step_avg:278.66ms
step:156/1480 train_time:40690ms step_avg:278.70ms
step:157/1480 train_time:40975ms step_avg:278.74ms
step:158/1480 train_time:41259ms step_avg:278.78ms
step:159/1480 train_time:41543ms step_avg:278.81ms
step:160/1480 train_time:41826ms step_avg:278.84ms
step:161/1480 train_time:42112ms step_avg:278.89ms
step:162/1480 train_time:42396ms step_avg:278.92ms
step:163/1480 train_time:42679ms step_avg:278.95ms
step:164/1480 train_time:42966ms step_avg:279.00ms
step:165/1480 train_time:43250ms step_avg:279.03ms
step:166/1480 train_time:43535ms step_avg:279.07ms
step:167/1480 train_time:43819ms step_avg:279.10ms
step:168/1480 train_time:44103ms step_avg:279.14ms
step:169/1480 train_time:44387ms step_avg:279.16ms
step:170/1480 train_time:44673ms step_avg:279.21ms
step:171/1480 train_time:44958ms step_avg:279.24ms
step:172/1480 train_time:45243ms step_avg:279.28ms
step:173/1480 train_time:45527ms step_avg:279.30ms
step:174/1480 train_time:45813ms step_avg:279.35ms
step:175/1480 train_time:46098ms step_avg:279.38ms
step:176/1480 train_time:46382ms step_avg:279.41ms
step:177/1480 train_time:46665ms step_avg:279.43ms
step:178/1480 train_time:46950ms step_avg:279.46ms
step:179/1480 train_time:47235ms step_avg:279.49ms
step:180/1480 train_time:47520ms step_avg:279.53ms
step:181/1480 train_time:47804ms step_avg:279.56ms
step:182/1480 train_time:48088ms step_avg:279.58ms
step:183/1480 train_time:48375ms step_avg:279.62ms
step:184/1480 train_time:48661ms step_avg:279.66ms
step:185/1480 train_time:48945ms step_avg:279.69ms
step:186/1480 train_time:49228ms step_avg:279.71ms
step:187/1480 train_time:49513ms step_avg:279.73ms
step:188/1480 train_time:49798ms step_avg:279.76ms
step:189/1480 train_time:50083ms step_avg:279.79ms
step:190/1480 train_time:50366ms step_avg:279.81ms
step:191/1480 train_time:50650ms step_avg:279.84ms
step:192/1480 train_time:50935ms step_avg:279.86ms
step:193/1480 train_time:51221ms step_avg:279.90ms
step:194/1480 train_time:51506ms step_avg:279.93ms
step:195/1480 train_time:51791ms step_avg:279.95ms
step:196/1480 train_time:52076ms step_avg:279.98ms
step:197/1480 train_time:52361ms step_avg:280.01ms
step:198/1480 train_time:52645ms step_avg:280.03ms
step:199/1480 train_time:52930ms step_avg:280.05ms
step:200/1480 train_time:53215ms step_avg:280.08ms
step:201/1480 train_time:53500ms step_avg:280.11ms
step:202/1480 train_time:53784ms step_avg:280.13ms
step:203/1480 train_time:54068ms step_avg:280.14ms
step:204/1480 train_time:54354ms step_avg:280.17ms
step:205/1480 train_time:54640ms step_avg:280.21ms
step:206/1480 train_time:54925ms step_avg:280.23ms
step:207/1480 train_time:55209ms step_avg:280.25ms
step:208/1480 train_time:55493ms step_avg:280.27ms
step:209/1480 train_time:55777ms step_avg:280.29ms
step:210/1480 train_time:56062ms step_avg:280.31ms
step:211/1480 train_time:56347ms step_avg:280.33ms
step:212/1480 train_time:56631ms step_avg:280.35ms
step:213/1480 train_time:56918ms step_avg:280.38ms
step:214/1480 train_time:57203ms step_avg:280.41ms
step:215/1480 train_time:57487ms step_avg:280.42ms
step:216/1480 train_time:57771ms step_avg:280.44ms
step:217/1480 train_time:58058ms step_avg:280.47ms
step:218/1480 train_time:58342ms step_avg:280.49ms
step:219/1480 train_time:58626ms step_avg:280.51ms
step:220/1480 train_time:58913ms step_avg:280.54ms
step:221/1480 train_time:59206ms step_avg:280.60ms
step:222/1480 train_time:59501ms step_avg:280.67ms
step:223/1480 train_time:59793ms step_avg:280.72ms
step:224/1480 train_time:60086ms step_avg:280.78ms
step:225/1480 train_time:60382ms step_avg:280.85ms
step:226/1480 train_time:60672ms step_avg:280.89ms
step:227/1480 train_time:60965ms step_avg:280.94ms
step:228/1480 train_time:61258ms step_avg:281.00ms
step:229/1480 train_time:61553ms step_avg:281.06ms
step:230/1480 train_time:61844ms step_avg:281.11ms
step:231/1480 train_time:62136ms step_avg:281.16ms
step:232/1480 train_time:62428ms step_avg:281.21ms
step:233/1480 train_time:62722ms step_avg:281.26ms
step:234/1480 train_time:63015ms step_avg:281.32ms
step:235/1480 train_time:63307ms step_avg:281.36ms
step:236/1480 train_time:63599ms step_avg:281.41ms
step:237/1480 train_time:63891ms step_avg:281.46ms
step:238/1480 train_time:64184ms step_avg:281.51ms
step:239/1480 train_time:64478ms step_avg:281.57ms
step:240/1480 train_time:64769ms step_avg:281.61ms
step:241/1480 train_time:65063ms step_avg:281.66ms
step:242/1480 train_time:65360ms step_avg:281.72ms
step:243/1480 train_time:65651ms step_avg:281.77ms
step:244/1480 train_time:65944ms step_avg:281.81ms
step:245/1480 train_time:66237ms step_avg:281.86ms
step:246/1480 train_time:66529ms step_avg:281.90ms
step:247/1480 train_time:66825ms step_avg:281.96ms
step:248/1480 train_time:67120ms step_avg:282.01ms
step:249/1480 train_time:67412ms step_avg:282.06ms
step:250/1480 train_time:67705ms step_avg:282.10ms
step:250/1480 val_loss:3.9828 train_time:67720ms step_avg:282.17ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 143.0942535
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 1.6693283 | spectral_norm = 6.3664284 | frobenius_norm = 58.0284576
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 1.5068584 | spectral_norm = 8.7662935 | frobenius_norm = 54.0010109
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 1.5925086 | spectral_norm = 4.8817196 | frobenius_norm = 56.8431702
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 1.6966890 | spectral_norm = 4.3275337 | frobenius_norm = 57.2730331
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 3.7200258 | spectral_norm = 8.3606224 | frobenius_norm = 110.4001541
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 1.9756479 | spectral_norm = 4.7472849 | frobenius_norm = 59.6769028
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 1.6088168 | spectral_norm = 5.4254441 | frobenius_norm = 56.5933571
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 1.5566987 | spectral_norm = 6.1070971 | frobenius_norm = 54.7220688
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 1.4364032 | spectral_norm = 5.2589922 | frobenius_norm = 56.3899155
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 1.7517426 | spectral_norm = 4.2997694 | frobenius_norm = 59.9881287
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 4.2251768 | spectral_norm = 8.7766943 | frobenius_norm = 124.5469666
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 2.1520937 | spectral_norm = 5.3396840 | frobenius_norm = 64.7262650
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 1.5574962 | spectral_norm = 4.7545543 | frobenius_norm = 56.6190605
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 1.5771535 | spectral_norm = 4.6876287 | frobenius_norm = 56.6016769
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 1.5103252 | spectral_norm = 5.9063487 | frobenius_norm = 60.3456039
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 1.8896352 | spectral_norm = 4.6570768 | frobenius_norm = 63.9297180
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 4.3713083 | spectral_norm = 8.9312706 | frobenius_norm = 128.6984253
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 2.1703172 | spectral_norm = 5.3630352 | frobenius_norm = 65.1386032
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 1.5853715 | spectral_norm = 5.4843836 | frobenius_norm = 56.2914162
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 1.5671750 | spectral_norm = 5.1684833 | frobenius_norm = 55.1968269
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 1.5162200 | spectral_norm = 5.9231095 | frobenius_norm = 61.6019402
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 1.7979198 | spectral_norm = 4.6135840 | frobenius_norm = 61.6978836
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 4.4309707 | spectral_norm = 8.9559364 | frobenius_norm = 130.4732971
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 2.2091758 | spectral_norm = 5.2980852 | frobenius_norm = 66.2455673
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 1.5426515 | spectral_norm = 4.9368682 | frobenius_norm = 55.6232834
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 1.5616012 | spectral_norm = 4.8419380 | frobenius_norm = 56.1376991
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 1.5296651 | spectral_norm = 6.0926423 | frobenius_norm = 62.5294685
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 1.8512228 | spectral_norm = 4.7037077 | frobenius_norm = 63.5359688
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 4.5003166 | spectral_norm = 9.0537853 | frobenius_norm = 132.3245392
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 2.2088142 | spectral_norm = 5.3253226 | frobenius_norm = 66.3516006
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 1.5734905 | spectral_norm = 5.1973343 | frobenius_norm = 55.9161453
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 1.5700107 | spectral_norm = 4.8423753 | frobenius_norm = 55.8156395
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 1.5659083 | spectral_norm = 6.3161683 | frobenius_norm = 62.6359215
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 1.8474112 | spectral_norm = 4.6815009 | frobenius_norm = 62.7218399
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 4.5297976 | spectral_norm = 9.1577711 | frobenius_norm = 133.2791290
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 2.2050202 | spectral_norm = 5.2065711 | frobenius_norm = 66.3323059
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 1.5851610 | spectral_norm = 4.9997845 | frobenius_norm = 56.1557274
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 1.5866168 | spectral_norm = 4.7587175 | frobenius_norm = 56.1287460
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 1.5266360 | spectral_norm = 6.3076053 | frobenius_norm = 62.4429169
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 1.8222027 | spectral_norm = 4.6650176 | frobenius_norm = 62.1681519
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 4.5367975 | spectral_norm = 9.6398287 | frobenius_norm = 134.1928101
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 2.1996024 | spectral_norm = 5.3865070 | frobenius_norm = 66.5515594
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 1.6123382 | spectral_norm = 5.3730874 | frobenius_norm = 56.6538124
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 1.6099582 | spectral_norm = 4.8277087 | frobenius_norm = 56.8520393
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 1.4844688 | spectral_norm = 6.1857934 | frobenius_norm = 61.3796158
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 1.8468071 | spectral_norm = 4.8193741 | frobenius_norm = 63.1674347
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 4.5660062 | spectral_norm = 9.4487162 | frobenius_norm = 135.3545380
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 2.2060025 | spectral_norm = 5.4023442 | frobenius_norm = 66.5740662
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 1.5957140 | spectral_norm = 5.0184612 | frobenius_norm = 56.6746445
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 1.5798777 | spectral_norm = 4.9796185 | frobenius_norm = 56.5090675
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 1.5150222 | spectral_norm = 6.3233237 | frobenius_norm = 60.9901886
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 1.8668763 | spectral_norm = 4.7264214 | frobenius_norm = 62.7993660
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 4.5496464 | spectral_norm = 9.7034435 | frobenius_norm = 134.8903198
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 2.1915164 | spectral_norm = 5.4009824 | frobenius_norm = 66.2165222
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 1.6246377 | spectral_norm = 5.0704641 | frobenius_norm = 57.6339455
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 1.6315678 | spectral_norm = 5.3576970 | frobenius_norm = 57.6825294
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 1.5602948 | spectral_norm = 5.6539240 | frobenius_norm = 61.0260277
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 1.9235189 | spectral_norm = 4.5111523 | frobenius_norm = 64.2803497
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 4.5548992 | spectral_norm = 9.4852552 | frobenius_norm = 134.7669373
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 2.1972289 | spectral_norm = 5.6059265 | frobenius_norm = 66.0983429
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 1.4900438 | spectral_norm = 5.3380461 | frobenius_norm = 55.9096069
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 1.4391666 | spectral_norm = 5.3713484 | frobenius_norm = 55.6836319
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 1.4973611 | spectral_norm = 5.7010784 | frobenius_norm = 58.8023491
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 1.9836871 | spectral_norm = 4.7700305 | frobenius_norm = 68.5466766
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 4.5207262 | spectral_norm = 9.4927425 | frobenius_norm = 133.0261078
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 2.1735668 | spectral_norm = 5.7081761 | frobenius_norm = 65.1859741
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 1.6027300 | spectral_norm = 5.3293056 | frobenius_norm = 57.0929375
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 1.5376846 | spectral_norm = 5.6230969 | frobenius_norm = 56.3102264
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 1.4641552 | spectral_norm = 5.4479518 | frobenius_norm = 57.0327072
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 1.9340340 | spectral_norm = 4.7138267 | frobenius_norm = 66.1713486
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 4.4879193 | spectral_norm = 9.9753637 | frobenius_norm = 132.3330383
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 2.1414394 | spectral_norm = 5.6524272 | frobenius_norm = 64.8283539
W name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 204.1575165
W name = 'module._orig_mod.lm_head.weight' | median_sv = 16.2632618 | spectral_norm = 150.5301361 | frobenius_norm = 558.7553101
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 0.0000003
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 0.0000224 | spectral_norm = 0.0020376 | frobenius_norm = 0.0029339 | spectral_norm_est_t2 = 0.0020615 | spectral_norm_est_t4 = 0.0020376
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 0.0000229 | spectral_norm = 0.0015689 | frobenius_norm = 0.0028602 | spectral_norm_est_t2 = 0.0016921 | spectral_norm_est_t4 = 0.0015777
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 0.0000181 | spectral_norm = 0.0084380 | frobenius_norm = 0.0089254 | spectral_norm_est_t2 = 0.0084431 | spectral_norm_est_t4 = 0.0084376
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 0.0000493 | spectral_norm = 0.0179844 | frobenius_norm = 0.0187339 | spectral_norm_est_t2 = 0.0179854 | spectral_norm_est_t4 = 0.0179838
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 0.0000824 | spectral_norm = 0.0069500 | frobenius_norm = 0.0083312 | spectral_norm_est_t2 = 0.0069571 | spectral_norm_est_t4 = 0.0069498
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 0.0001358 | spectral_norm = 0.0070959 | frobenius_norm = 0.0100361 | spectral_norm_est_t2 = 0.0071288 | spectral_norm_est_t4 = 0.0070980
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 0.0000140 | spectral_norm = 0.0047718 | frobenius_norm = 0.0051347 | spectral_norm_est_t2 = 0.0047753 | spectral_norm_est_t4 = 0.0047717
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 0.0000155 | spectral_norm = 0.0024896 | frobenius_norm = 0.0036966 | spectral_norm_est_t2 = 0.0027055 | spectral_norm_est_t4 = 0.0025301
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 0.0000257 | spectral_norm = 0.0206049 | frobenius_norm = 0.0210715 | spectral_norm_est_t2 = 0.0206062 | spectral_norm_est_t4 = 0.0206047
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 0.0000464 | spectral_norm = 0.0093353 | frobenius_norm = 0.0113673 | spectral_norm_est_t2 = 0.0093719 | spectral_norm_est_t4 = 0.0093351
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 0.0000599 | spectral_norm = 0.0064678 | frobenius_norm = 0.0078081 | spectral_norm_est_t2 = 0.0064765 | spectral_norm_est_t4 = 0.0064677
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 0.0001098 | spectral_norm = 0.0068105 | frobenius_norm = 0.0095527 | spectral_norm_est_t2 = 0.0068649 | spectral_norm_est_t4 = 0.0068113
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 0.0000215 | spectral_norm = 0.0117831 | frobenius_norm = 0.0123244 | spectral_norm_est_t2 = 0.0117848 | spectral_norm_est_t4 = 0.0117826
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 0.0000227 | spectral_norm = 0.0037966 | frobenius_norm = 0.0059276 | spectral_norm_est_t2 = 0.0041417 | spectral_norm_est_t4 = 0.0038586
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 0.0000189 | spectral_norm = 0.0191578 | frobenius_norm = 0.0195661 | spectral_norm_est_t2 = 0.0191593 | spectral_norm_est_t4 = 0.0191582
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 0.0000475 | spectral_norm = 0.0084215 | frobenius_norm = 0.0103525 | spectral_norm_est_t2 = 0.0084717 | spectral_norm_est_t4 = 0.0084214
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 0.0000654 | spectral_norm = 0.0091571 | frobenius_norm = 0.0104805 | spectral_norm_est_t2 = 0.0091665 | spectral_norm_est_t4 = 0.0091575
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 0.0001196 | spectral_norm = 0.0089844 | frobenius_norm = 0.0117584 | spectral_norm_est_t2 = 0.0090236 | spectral_norm_est_t4 = 0.0089851
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 0.0000159 | spectral_norm = 0.0030697 | frobenius_norm = 0.0035984 | spectral_norm_est_t2 = 0.0030738 | spectral_norm_est_t4 = 0.0030696
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 0.0000173 | spectral_norm = 0.0016529 | frobenius_norm = 0.0029197 | spectral_norm_est_t2 = 0.0017853 | spectral_norm_est_t4 = 0.0016631
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 0.0000211 | spectral_norm = 0.0187611 | frobenius_norm = 0.0192798 | spectral_norm_est_t2 = 0.0187634 | spectral_norm_est_t4 = 0.0187615
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 0.0000373 | spectral_norm = 0.0068087 | frobenius_norm = 0.0084955 | spectral_norm_est_t2 = 0.0068358 | spectral_norm_est_t4 = 0.0068086
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 0.0000584 | spectral_norm = 0.0071534 | frobenius_norm = 0.0085834 | spectral_norm_est_t2 = 0.0071651 | spectral_norm_est_t4 = 0.0071545
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 0.0001079 | spectral_norm = 0.0078989 | frobenius_norm = 0.0104712 | spectral_norm_est_t2 = 0.0079357 | spectral_norm_est_t4 = 0.0078994
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 0.0000193 | spectral_norm = 0.0036529 | frobenius_norm = 0.0043036 | spectral_norm_est_t2 = 0.0036598 | spectral_norm_est_t4 = 0.0036528
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 0.0000211 | spectral_norm = 0.0020599 | frobenius_norm = 0.0036785 | spectral_norm_est_t2 = 0.0022687 | spectral_norm_est_t4 = 0.0020872
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 0.0000160 | spectral_norm = 0.0140925 | frobenius_norm = 0.0144571 | spectral_norm_est_t2 = 0.0140934 | spectral_norm_est_t4 = 0.0140926
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 0.0000346 | spectral_norm = 0.0063777 | frobenius_norm = 0.0077801 | spectral_norm_est_t2 = 0.0063976 | spectral_norm_est_t4 = 0.0063774
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 0.0000563 | spectral_norm = 0.0074018 | frobenius_norm = 0.0088309 | spectral_norm_est_t2 = 0.0074140 | spectral_norm_est_t4 = 0.0074019
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 0.0001052 | spectral_norm = 0.0075727 | frobenius_norm = 0.0102043 | spectral_norm_est_t2 = 0.0076129 | spectral_norm_est_t4 = 0.0075736
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 0.0000151 | spectral_norm = 0.0021635 | frobenius_norm = 0.0028394 | spectral_norm_est_t2 = 0.0021796 | spectral_norm_est_t4 = 0.0021635
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 0.0000164 | spectral_norm = 0.0014721 | frobenius_norm = 0.0027862 | spectral_norm_est_t2 = 0.0016556 | spectral_norm_est_t4 = 0.0014929
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 0.0000153 | spectral_norm = 0.0124441 | frobenius_norm = 0.0128523 | spectral_norm_est_t2 = 0.0124457 | spectral_norm_est_t4 = 0.0124441
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 0.0000285 | spectral_norm = 0.0055650 | frobenius_norm = 0.0068603 | spectral_norm_est_t2 = 0.0055901 | spectral_norm_est_t4 = 0.0055648
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 0.0000477 | spectral_norm = 0.0060050 | frobenius_norm = 0.0073405 | spectral_norm_est_t2 = 0.0060181 | spectral_norm_est_t4 = 0.0060052
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 0.0000927 | spectral_norm = 0.0059464 | frobenius_norm = 0.0083740 | spectral_norm_est_t2 = 0.0059888 | spectral_norm_est_t4 = 0.0059476
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 0.0000137 | spectral_norm = 0.0029027 | frobenius_norm = 0.0033932 | spectral_norm_est_t2 = 0.0029106 | spectral_norm_est_t4 = 0.0029026
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 0.0000145 | spectral_norm = 0.0017908 | frobenius_norm = 0.0033071 | spectral_norm_est_t2 = 0.0021095 | spectral_norm_est_t4 = 0.0018570
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 0.0000070 | spectral_norm = 0.0065976 | frobenius_norm = 0.0067898 | spectral_norm_est_t2 = 0.0065984 | spectral_norm_est_t4 = 0.0065977
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 0.0000251 | spectral_norm = 0.0036904 | frobenius_norm = 0.0045444 | spectral_norm_est_t2 = 0.0037035 | spectral_norm_est_t4 = 0.0036905
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 0.0000409 | spectral_norm = 0.0046761 | frobenius_norm = 0.0057261 | spectral_norm_est_t2 = 0.0046858 | spectral_norm_est_t4 = 0.0046761
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 0.0000797 | spectral_norm = 0.0052773 | frobenius_norm = 0.0073694 | spectral_norm_est_t2 = 0.0053214 | spectral_norm_est_t4 = 0.0052783
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 0.0000119 | spectral_norm = 0.0018653 | frobenius_norm = 0.0023048 | spectral_norm_est_t2 = 0.0018715 | spectral_norm_est_t4 = 0.0018653
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 0.0000125 | spectral_norm = 0.0012425 | frobenius_norm = 0.0021752 | spectral_norm_est_t2 = 0.0013657 | spectral_norm_est_t4 = 0.0012548
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 0.0000101 | spectral_norm = 0.0081734 | frobenius_norm = 0.0084528 | spectral_norm_est_t2 = 0.0081747 | spectral_norm_est_t4 = 0.0081735
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 0.0000263 | spectral_norm = 0.0047242 | frobenius_norm = 0.0055335 | spectral_norm_est_t2 = 0.0047311 | spectral_norm_est_t4 = 0.0047244
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 0.0000403 | spectral_norm = 0.0047175 | frobenius_norm = 0.0057543 | spectral_norm_est_t2 = 0.0047271 | spectral_norm_est_t4 = 0.0047175
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 0.0000816 | spectral_norm = 0.0053017 | frobenius_norm = 0.0074662 | spectral_norm_est_t2 = 0.0053529 | spectral_norm_est_t4 = 0.0053029
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 0.0000173 | spectral_norm = 0.0031634 | frobenius_norm = 0.0037445 | spectral_norm_est_t2 = 0.0031706 | spectral_norm_est_t4 = 0.0031633
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 0.0000182 | spectral_norm = 0.0026330 | frobenius_norm = 0.0038151 | spectral_norm_est_t2 = 0.0027311 | spectral_norm_est_t4 = 0.0026371
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 0.0000062 | spectral_norm = 0.0049770 | frobenius_norm = 0.0051459 | spectral_norm_est_t2 = 0.0049777 | spectral_norm_est_t4 = 0.0049771
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 0.0000367 | spectral_norm = 0.0063981 | frobenius_norm = 0.0072334 | spectral_norm_est_t2 = 0.0064035 | spectral_norm_est_t4 = 0.0063980
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 0.0000435 | spectral_norm = 0.0052581 | frobenius_norm = 0.0062719 | spectral_norm_est_t2 = 0.0052669 | spectral_norm_est_t4 = 0.0052581
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 0.0000872 | spectral_norm = 0.0060166 | frobenius_norm = 0.0082302 | spectral_norm_est_t2 = 0.0060667 | spectral_norm_est_t4 = 0.0060175
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 0.0000160 | spectral_norm = 0.0026730 | frobenius_norm = 0.0031623 | spectral_norm_est_t2 = 0.0026783 | spectral_norm_est_t4 = 0.0026729
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 0.0000169 | spectral_norm = 0.0017553 | frobenius_norm = 0.0028747 | spectral_norm_est_t2 = 0.0018850 | spectral_norm_est_t4 = 0.0017666
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 0.0000057 | spectral_norm = 0.0043379 | frobenius_norm = 0.0044602 | spectral_norm_est_t2 = 0.0043383 | spectral_norm_est_t4 = 0.0043379
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 0.0000452 | spectral_norm = 0.0090158 | frobenius_norm = 0.0095693 | spectral_norm_est_t2 = 0.0090163 | spectral_norm_est_t4 = 0.0090153
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 0.0000471 | spectral_norm = 0.0059857 | frobenius_norm = 0.0069458 | spectral_norm_est_t2 = 0.0059929 | spectral_norm_est_t4 = 0.0059857
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 0.0000909 | spectral_norm = 0.0067379 | frobenius_norm = 0.0091631 | spectral_norm_est_t2 = 0.0068089 | spectral_norm_est_t4 = 0.0067390
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 0.0000302 | spectral_norm = 0.0092257 | frobenius_norm = 0.0102490 | spectral_norm_est_t2 = 0.0092450 | spectral_norm_est_t4 = 0.0092255
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 0.0000347 | spectral_norm = 0.0049714 | frobenius_norm = 0.0072532 | spectral_norm_est_t2 = 0.0051422 | spectral_norm_est_t4 = 0.0049767
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 0.0000077 | spectral_norm = 0.0074189 | frobenius_norm = 0.0075867 | spectral_norm_est_t2 = 0.0074193 | spectral_norm_est_t4 = 0.0074189
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 0.0000622 | spectral_norm = 0.0274816 | frobenius_norm = 0.0279769 | spectral_norm_est_t2 = 0.0274819 | spectral_norm_est_t4 = 0.0274814
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 0.0000625 | spectral_norm = 0.0126694 | frobenius_norm = 0.0135658 | spectral_norm_est_t2 = 0.0126734 | spectral_norm_est_t4 = 0.0126692
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 0.0001116 | spectral_norm = 0.0120820 | frobenius_norm = 0.0150910 | spectral_norm_est_t2 = 0.0121674 | spectral_norm_est_t4 = 0.0120841
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 0.0000263 | spectral_norm = 0.0117770 | frobenius_norm = 0.0121618 | spectral_norm_est_t2 = 0.0117783 | spectral_norm_est_t4 = 0.0117768
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 0.0000285 | spectral_norm = 0.0063216 | frobenius_norm = 0.0075613 | spectral_norm_est_t2 = 0.0063964 | spectral_norm_est_t4 = 0.0063230
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 0.0000098 | spectral_norm = 0.0100386 | frobenius_norm = 0.0101886 | spectral_norm_est_t2 = 0.0100389 | spectral_norm_est_t4 = 0.0100387
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 0.0000563 | spectral_norm = 0.0349008 | frobenius_norm = 0.0352918 | spectral_norm_est_t2 = 0.0349016 | spectral_norm_est_t4 = 0.0349013
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 0.0000759 | spectral_norm = 0.0222263 | frobenius_norm = 0.0233081 | spectral_norm_est_t2 = 0.0222334 | spectral_norm_est_t4 = 0.0222262
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 0.0001357 | spectral_norm = 0.0253729 | frobenius_norm = 0.0289369 | spectral_norm_est_t2 = 0.0254402 | spectral_norm_est_t4 = 0.0253778
G name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 0.0000003
G name = 'module._orig_mod.lm_head.weight' | median_sv = 0.0004046 | spectral_norm = 0.2302675 | frobenius_norm = 0.2383341 | spectral_norm_est_t2 = 0.2303600 | spectral_norm_est_t4 = 0.2302691
saved grads to logs/1ef9fb63-cc79-4219-bbf9-a03b83709afa/grad_state_step000250.pt
===========================================
step:251/1480 train_time:68022ms step_avg:282.25ms
step:252/1480 train_time:68304ms step_avg:282.25ms
step:253/1480 train_time:68594ms step_avg:282.28ms
step:254/1480 train_time:68886ms step_avg:282.32ms
step:255/1480 train_time:69176ms step_avg:282.35ms
step:256/1480 train_time:69470ms step_avg:282.40ms
step:257/1480 train_time:69763ms step_avg:282.44ms
step:258/1480 train_time:70054ms step_avg:282.47ms
step:259/1480 train_time:70348ms step_avg:282.52ms
step:260/1480 train_time:70642ms step_avg:282.57ms
step:261/1480 train_time:70933ms step_avg:282.60ms
step:262/1480 train_time:71227ms step_avg:282.65ms
step:263/1480 train_time:71520ms step_avg:282.69ms
step:264/1480 train_time:71813ms step_avg:282.73ms
step:265/1480 train_time:72104ms step_avg:282.76ms
step:266/1480 train_time:72394ms step_avg:282.79ms
step:267/1480 train_time:72687ms step_avg:282.83ms
step:268/1480 train_time:72978ms step_avg:282.86ms
step:269/1480 train_time:73271ms step_avg:282.90ms
step:270/1480 train_time:73564ms step_avg:282.94ms
step:271/1480 train_time:73856ms step_avg:282.97ms
step:272/1480 train_time:74147ms step_avg:283.00ms
step:273/1480 train_time:74439ms step_avg:283.04ms
step:274/1480 train_time:74731ms step_avg:283.07ms
step:275/1480 train_time:75027ms step_avg:283.12ms
step:276/1480 train_time:75319ms step_avg:283.16ms
step:277/1480 train_time:75611ms step_avg:283.19ms
step:278/1480 train_time:75903ms step_avg:283.22ms
step:279/1480 train_time:76196ms step_avg:283.26ms
step:280/1480 train_time:76488ms step_avg:283.29ms
step:281/1480 train_time:76782ms step_avg:283.33ms
step:282/1480 train_time:77073ms step_avg:283.36ms
step:283/1480 train_time:77366ms step_avg:283.39ms
step:284/1480 train_time:77658ms step_avg:283.42ms
step:285/1480 train_time:77951ms step_avg:283.46ms
step:286/1480 train_time:78245ms step_avg:283.50ms
step:287/1480 train_time:78536ms step_avg:283.52ms
step:288/1480 train_time:78830ms step_avg:283.56ms
step:289/1480 train_time:79124ms step_avg:283.60ms
step:290/1480 train_time:79415ms step_avg:283.63ms
step:291/1480 train_time:79711ms step_avg:283.67ms
step:292/1480 train_time:80000ms step_avg:283.69ms
step:293/1480 train_time:80292ms step_avg:283.72ms
step:294/1480 train_time:80586ms step_avg:283.75ms
step:295/1480 train_time:80881ms step_avg:283.79ms
step:296/1480 train_time:81173ms step_avg:283.82ms
step:297/1480 train_time:81466ms step_avg:283.85ms
step:298/1480 train_time:81757ms step_avg:283.88ms
step:299/1480 train_time:82050ms step_avg:283.91ms
step:300/1480 train_time:82344ms step_avg:283.94ms
step:301/1480 train_time:82638ms step_avg:283.98ms
step:302/1480 train_time:82928ms step_avg:284.00ms
step:303/1480 train_time:83219ms step_avg:284.02ms
step:304/1480 train_time:83512ms step_avg:284.05ms
step:305/1480 train_time:83806ms step_avg:284.09ms
step:306/1480 train_time:84099ms step_avg:284.12ms
step:307/1480 train_time:84390ms step_avg:284.14ms
step:308/1480 train_time:84684ms step_avg:284.17ms
step:309/1480 train_time:84974ms step_avg:284.19ms
step:310/1480 train_time:85269ms step_avg:284.23ms
step:311/1480 train_time:85563ms step_avg:284.26ms
step:312/1480 train_time:85856ms step_avg:284.29ms
step:313/1480 train_time:86148ms step_avg:284.32ms
step:314/1480 train_time:86441ms step_avg:284.34ms
step:315/1480 train_time:86733ms step_avg:284.37ms
step:316/1480 train_time:87026ms step_avg:284.40ms
step:317/1480 train_time:87319ms step_avg:284.43ms
step:318/1480 train_time:87611ms step_avg:284.45ms
step:319/1480 train_time:87905ms step_avg:284.48ms
step:320/1480 train_time:88196ms step_avg:284.50ms
step:321/1480 train_time:88489ms step_avg:284.53ms
step:322/1480 train_time:88784ms step_avg:284.57ms
step:323/1480 train_time:89078ms step_avg:284.59ms
step:324/1480 train_time:89368ms step_avg:284.61ms
step:325/1480 train_time:89661ms step_avg:284.64ms
step:326/1480 train_time:89953ms step_avg:284.66ms
step:327/1480 train_time:90247ms step_avg:284.69ms
step:328/1480 train_time:90540ms step_avg:284.72ms
step:329/1480 train_time:90833ms step_avg:284.74ms
step:330/1480 train_time:91136ms step_avg:284.80ms
step:331/1480 train_time:91436ms step_avg:284.85ms
step:332/1480 train_time:91736ms step_avg:284.89ms
step:333/1480 train_time:92035ms step_avg:284.94ms
step:334/1480 train_time:92334ms step_avg:284.98ms
step:335/1480 train_time:92636ms step_avg:285.03ms
step:336/1480 train_time:92936ms step_avg:285.08ms
step:337/1480 train_time:93237ms step_avg:285.13ms
step:338/1480 train_time:93537ms step_avg:285.17ms
step:339/1480 train_time:93836ms step_avg:285.22ms
step:340/1480 train_time:94136ms step_avg:285.26ms
step:341/1480 train_time:94436ms step_avg:285.31ms
step:342/1480 train_time:94735ms step_avg:285.35ms
step:343/1480 train_time:95036ms step_avg:285.39ms
step:344/1480 train_time:95335ms step_avg:285.44ms
step:345/1480 train_time:95636ms step_avg:285.48ms
step:346/1480 train_time:95936ms step_avg:285.52ms
step:347/1480 train_time:96237ms step_avg:285.57ms
step:348/1480 train_time:96537ms step_avg:285.61ms
step:349/1480 train_time:96836ms step_avg:285.65ms
step:350/1480 train_time:97137ms step_avg:285.70ms
step:351/1480 train_time:97436ms step_avg:285.74ms
step:352/1480 train_time:97736ms step_avg:285.78ms
step:353/1480 train_time:98036ms step_avg:285.82ms
step:354/1480 train_time:98335ms step_avg:285.86ms
step:355/1480 train_time:98637ms step_avg:285.90ms
step:356/1480 train_time:98936ms step_avg:285.94ms
step:357/1480 train_time:99237ms step_avg:285.98ms
step:358/1480 train_time:99535ms step_avg:286.02ms
step:359/1480 train_time:99837ms step_avg:286.07ms
step:360/1480 train_time:100140ms step_avg:286.11ms
step:361/1480 train_time:100437ms step_avg:286.15ms
step:362/1480 train_time:100736ms step_avg:286.18ms
step:363/1480 train_time:101036ms step_avg:286.22ms
step:364/1480 train_time:101337ms step_avg:286.26ms
step:365/1480 train_time:101636ms step_avg:286.30ms
step:366/1480 train_time:101936ms step_avg:286.34ms
step:367/1480 train_time:102236ms step_avg:286.38ms
step:368/1480 train_time:102537ms step_avg:286.41ms
step:369/1480 train_time:102837ms step_avg:286.45ms
step:370/1480 train_time:103137ms step_avg:286.49ms
step:371/1480 train_time:103436ms step_avg:286.53ms
step:372/1480 train_time:103736ms step_avg:286.56ms
step:373/1480 train_time:104037ms step_avg:286.60ms
step:374/1480 train_time:104337ms step_avg:286.64ms
step:375/1480 train_time:104636ms step_avg:286.67ms
step:375/1480 val_loss:3.7982 train_time:104652ms step_avg:286.72ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 166.0495300
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 2.3857007 | spectral_norm = 9.7124777 | frobenius_norm = 83.2639389
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 2.1744247 | spectral_norm = 13.6057224 | frobenius_norm = 78.1223907
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 2.3612499 | spectral_norm = 7.4964113 | frobenius_norm = 81.9753571
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 2.3899851 | spectral_norm = 6.3804293 | frobenius_norm = 81.3784714
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 5.4726334 | spectral_norm = 11.5076208 | frobenius_norm = 162.5738678
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 2.8675454 | spectral_norm = 7.1552739 | frobenius_norm = 86.7196198
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 2.3523867 | spectral_norm = 8.0464697 | frobenius_norm = 82.7444000
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 2.2869361 | spectral_norm = 8.7733154 | frobenius_norm = 80.2015610
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 2.1155439 | spectral_norm = 7.4726491 | frobenius_norm = 80.9510956
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 2.4472315 | spectral_norm = 6.2229958 | frobenius_norm = 85.4254227
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 6.1003866 | spectral_norm = 12.7508707 | frobenius_norm = 180.1448517
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 3.0572701 | spectral_norm = 8.0940104 | frobenius_norm = 92.5819016
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 2.2774282 | spectral_norm = 6.9992805 | frobenius_norm = 82.8692551
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 2.2875788 | spectral_norm = 6.7427568 | frobenius_norm = 82.4020233
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 2.2838178 | spectral_norm = 8.6033840 | frobenius_norm = 88.7944870
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 2.7155173 | spectral_norm = 6.6481562 | frobenius_norm = 92.0015793
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 6.2894802 | spectral_norm = 13.0970688 | frobenius_norm = 184.9512024
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 3.0442264 | spectral_norm = 7.8138189 | frobenius_norm = 91.8847809
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 2.3324173 | spectral_norm = 8.2871943 | frobenius_norm = 82.5671768
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 2.2888424 | spectral_norm = 7.6978798 | frobenius_norm = 80.5392990
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 2.2954278 | spectral_norm = 8.2699776 | frobenius_norm = 89.2289505
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 2.5650563 | spectral_norm = 6.8024931 | frobenius_norm = 89.0003662
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 6.4007988 | spectral_norm = 13.1789780 | frobenius_norm = 188.3818512
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 3.1190338 | spectral_norm = 7.6763420 | frobenius_norm = 94.0673599
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 2.2501273 | spectral_norm = 7.5130267 | frobenius_norm = 81.3729019
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 2.2458541 | spectral_norm = 7.1846342 | frobenius_norm = 81.6591110
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 2.3352342 | spectral_norm = 8.5638704 | frobenius_norm = 91.5932999
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 2.7030110 | spectral_norm = 6.8100615 | frobenius_norm = 92.1460342
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 6.4980030 | spectral_norm = 13.2420225 | frobenius_norm = 190.6252289
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 3.0933364 | spectral_norm = 7.7274361 | frobenius_norm = 93.7688828
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 2.3097081 | spectral_norm = 7.6220636 | frobenius_norm = 81.9719696
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 2.3046336 | spectral_norm = 7.3305855 | frobenius_norm = 81.4361343
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 2.3888481 | spectral_norm = 8.7100611 | frobenius_norm = 91.2852707
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 2.6508248 | spectral_norm = 6.7716904 | frobenius_norm = 90.3016129
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 6.5472698 | spectral_norm = 13.1936941 | frobenius_norm = 191.9390411
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 3.1263416 | spectral_norm = 7.4303894 | frobenius_norm = 94.3645706
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 2.3395734 | spectral_norm = 7.3699627 | frobenius_norm = 82.7902832
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 2.3424227 | spectral_norm = 7.0373163 | frobenius_norm = 82.3056107
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 2.3667705 | spectral_norm = 8.9717560 | frobenius_norm = 92.7231140
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 2.6896145 | spectral_norm = 6.6869111 | frobenius_norm = 90.7078323
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 6.4743466 | spectral_norm = 14.0474100 | frobenius_norm = 190.5644226
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 3.1049047 | spectral_norm = 7.9410176 | frobenius_norm = 94.1067886
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 2.3668335 | spectral_norm = 7.9381618 | frobenius_norm = 83.1177063
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 2.3632174 | spectral_norm = 7.1960964 | frobenius_norm = 82.8185196
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 2.2760434 | spectral_norm = 8.3782930 | frobenius_norm = 89.9817047
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 2.6596480 | spectral_norm = 6.8265562 | frobenius_norm = 91.0636139
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 6.5496235 | spectral_norm = 14.1127434 | frobenius_norm = 193.2351074
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 3.1398726 | spectral_norm = 8.0194855 | frobenius_norm = 94.8972549
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 2.3523707 | spectral_norm = 7.2540584 | frobenius_norm = 83.9581680
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 2.3171175 | spectral_norm = 7.5138583 | frobenius_norm = 83.0855408
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 2.3669946 | spectral_norm = 9.8373032 | frobenius_norm = 92.2743607
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 2.7387049 | spectral_norm = 6.7896361 | frobenius_norm = 91.1207047
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 6.5290084 | spectral_norm = 14.4301519 | frobenius_norm = 193.0360260
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 3.1379757 | spectral_norm = 8.1469498 | frobenius_norm = 94.7077866
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 2.4372017 | spectral_norm = 7.4783158 | frobenius_norm = 86.0919952
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 2.3983781 | spectral_norm = 8.0665474 | frobenius_norm = 85.4171295
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 2.4529812 | spectral_norm = 8.4610195 | frobenius_norm = 91.8843994
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 2.7950947 | spectral_norm = 6.3738246 | frobenius_norm = 92.4142838
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 6.5424333 | spectral_norm = 13.8192835 | frobenius_norm = 193.2634888
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 3.1589868 | spectral_norm = 8.5533180 | frobenius_norm = 94.7003174
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 2.1548157 | spectral_norm = 8.4818954 | frobenius_norm = 82.0110397
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 2.0627110 | spectral_norm = 8.1249123 | frobenius_norm = 81.5800095
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 2.3100872 | spectral_norm = 8.3386402 | frobenius_norm = 87.4837723
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 2.8938489 | spectral_norm = 6.6677432 | frobenius_norm = 97.2883148
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 6.6294146 | spectral_norm = 13.2626133 | frobenius_norm = 193.5114594
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 3.0517073 | spectral_norm = 8.9404640 | frobenius_norm = 91.4133530
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 2.3565579 | spectral_norm = 8.3316536 | frobenius_norm = 84.8760986
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 2.2719228 | spectral_norm = 8.4096661 | frobenius_norm = 83.0668793
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 2.2349191 | spectral_norm = 8.4174242 | frobenius_norm = 84.4726028
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 2.8284202 | spectral_norm = 6.7603717 | frobenius_norm = 95.8339615
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 6.6628261 | spectral_norm = 15.2837534 | frobenius_norm = 195.1171875
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 3.0647283 | spectral_norm = 9.0229673 | frobenius_norm = 92.5111008
W name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 244.3684082
W name = 'module._orig_mod.lm_head.weight' | median_sv = 20.9798737 | spectral_norm = 162.0505829 | frobenius_norm = 703.1802368
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 0.0000002
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 0.0000155 | spectral_norm = 0.0007456 | frobenius_norm = 0.0015623 | spectral_norm_est_t2 = 0.0008310 | spectral_norm_est_t4 = 0.0007537
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 0.0000153 | spectral_norm = 0.0006657 | frobenius_norm = 0.0015704 | spectral_norm_est_t2 = 0.0007988 | spectral_norm_est_t4 = 0.0006839
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 0.0000132 | spectral_norm = 0.0055223 | frobenius_norm = 0.0059041 | spectral_norm_est_t2 = 0.0055284 | spectral_norm_est_t4 = 0.0055219
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 0.0000325 | spectral_norm = 0.0129748 | frobenius_norm = 0.0134057 | spectral_norm_est_t2 = 0.0129765 | spectral_norm_est_t4 = 0.0129752
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 0.0000542 | spectral_norm = 0.0059319 | frobenius_norm = 0.0065865 | spectral_norm_est_t2 = 0.0059338 | spectral_norm_est_t4 = 0.0059319
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 0.0000913 | spectral_norm = 0.0042094 | frobenius_norm = 0.0060844 | spectral_norm_est_t2 = 0.0042254 | spectral_norm_est_t4 = 0.0042094
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 0.0000076 | spectral_norm = 0.0020175 | frobenius_norm = 0.0022057 | spectral_norm_est_t2 = 0.0020187 | spectral_norm_est_t4 = 0.0020175
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 0.0000085 | spectral_norm = 0.0014336 | frobenius_norm = 0.0018111 | spectral_norm_est_t2 = 0.0014436 | spectral_norm_est_t4 = 0.0014336
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 0.0000172 | spectral_norm = 0.0150225 | frobenius_norm = 0.0152736 | spectral_norm_est_t2 = 0.0150230 | spectral_norm_est_t4 = 0.0150224
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 0.0000299 | spectral_norm = 0.0072213 | frobenius_norm = 0.0082435 | spectral_norm_est_t2 = 0.0072329 | spectral_norm_est_t4 = 0.0072213
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 0.0000400 | spectral_norm = 0.0045736 | frobenius_norm = 0.0053392 | spectral_norm_est_t2 = 0.0045789 | spectral_norm_est_t4 = 0.0045747
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 0.0000757 | spectral_norm = 0.0039567 | frobenius_norm = 0.0061590 | spectral_norm_est_t2 = 0.0041659 | spectral_norm_est_t4 = 0.0039788
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 0.0000133 | spectral_norm = 0.0038482 | frobenius_norm = 0.0042577 | spectral_norm_est_t2 = 0.0038511 | spectral_norm_est_t4 = 0.0038481
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 0.0000141 | spectral_norm = 0.0017494 | frobenius_norm = 0.0029690 | spectral_norm_est_t2 = 0.0019473 | spectral_norm_est_t4 = 0.0017846
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 0.0000135 | spectral_norm = 0.0137752 | frobenius_norm = 0.0139671 | spectral_norm_est_t2 = 0.0137757 | spectral_norm_est_t4 = 0.0137755
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 0.0000324 | spectral_norm = 0.0059613 | frobenius_norm = 0.0069239 | spectral_norm_est_t2 = 0.0059761 | spectral_norm_est_t4 = 0.0059611
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 0.0000486 | spectral_norm = 0.0062760 | frobenius_norm = 0.0072003 | spectral_norm_est_t2 = 0.0062846 | spectral_norm_est_t4 = 0.0062775
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 0.0000918 | spectral_norm = 0.0056083 | frobenius_norm = 0.0079010 | spectral_norm_est_t2 = 0.0056588 | spectral_norm_est_t4 = 0.0056088
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 0.0000098 | spectral_norm = 0.0025804 | frobenius_norm = 0.0028494 | spectral_norm_est_t2 = 0.0025820 | spectral_norm_est_t4 = 0.0025804
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 0.0000108 | spectral_norm = 0.0014744 | frobenius_norm = 0.0022378 | spectral_norm_est_t2 = 0.0015544 | spectral_norm_est_t4 = 0.0014800
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 0.0000166 | spectral_norm = 0.0158525 | frobenius_norm = 0.0161832 | spectral_norm_est_t2 = 0.0158536 | spectral_norm_est_t4 = 0.0158526
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 0.0000270 | spectral_norm = 0.0053797 | frobenius_norm = 0.0064369 | spectral_norm_est_t2 = 0.0053925 | spectral_norm_est_t4 = 0.0053797
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 0.0000438 | spectral_norm = 0.0059507 | frobenius_norm = 0.0068920 | spectral_norm_est_t2 = 0.0059581 | spectral_norm_est_t4 = 0.0059512
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 0.0000825 | spectral_norm = 0.0057974 | frobenius_norm = 0.0077144 | spectral_norm_est_t2 = 0.0058282 | spectral_norm_est_t4 = 0.0057981
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 0.0000129 | spectral_norm = 0.0021229 | frobenius_norm = 0.0026104 | spectral_norm_est_t2 = 0.0021298 | spectral_norm_est_t4 = 0.0021228
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 0.0000142 | spectral_norm = 0.0014960 | frobenius_norm = 0.0026519 | spectral_norm_est_t2 = 0.0016602 | spectral_norm_est_t4 = 0.0015174
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 0.0000144 | spectral_norm = 0.0131612 | frobenius_norm = 0.0134369 | spectral_norm_est_t2 = 0.0131617 | spectral_norm_est_t4 = 0.0131612
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 0.0000261 | spectral_norm = 0.0055559 | frobenius_norm = 0.0064957 | spectral_norm_est_t2 = 0.0055676 | spectral_norm_est_t4 = 0.0055560
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 0.0000436 | spectral_norm = 0.0065054 | frobenius_norm = 0.0074843 | spectral_norm_est_t2 = 0.0065143 | spectral_norm_est_t4 = 0.0065059
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 0.0000820 | spectral_norm = 0.0058539 | frobenius_norm = 0.0078637 | spectral_norm_est_t2 = 0.0058944 | spectral_norm_est_t4 = 0.0058548
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 0.0000103 | spectral_norm = 0.0020742 | frobenius_norm = 0.0023846 | spectral_norm_est_t2 = 0.0020772 | spectral_norm_est_t4 = 0.0020743
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 0.0000111 | spectral_norm = 0.0013120 | frobenius_norm = 0.0022524 | spectral_norm_est_t2 = 0.0014497 | spectral_norm_est_t4 = 0.0013311
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 0.0000141 | spectral_norm = 0.0118872 | frobenius_norm = 0.0122722 | spectral_norm_est_t2 = 0.0118889 | spectral_norm_est_t4 = 0.0118869
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 0.0000217 | spectral_norm = 0.0054362 | frobenius_norm = 0.0062919 | spectral_norm_est_t2 = 0.0054464 | spectral_norm_est_t4 = 0.0054363
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 0.0000374 | spectral_norm = 0.0056661 | frobenius_norm = 0.0065101 | spectral_norm_est_t2 = 0.0056720 | spectral_norm_est_t4 = 0.0056663
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 0.0000732 | spectral_norm = 0.0046481 | frobenius_norm = 0.0064394 | spectral_norm_est_t2 = 0.0046840 | spectral_norm_est_t4 = 0.0046485
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 0.0000099 | spectral_norm = 0.0023350 | frobenius_norm = 0.0026056 | spectral_norm_est_t2 = 0.0023371 | spectral_norm_est_t4 = 0.0023349
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 0.0000104 | spectral_norm = 0.0013338 | frobenius_norm = 0.0023298 | spectral_norm_est_t2 = 0.0015391 | spectral_norm_est_t4 = 0.0013903
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 0.0000076 | spectral_norm = 0.0078157 | frobenius_norm = 0.0079854 | spectral_norm_est_t2 = 0.0078164 | spectral_norm_est_t4 = 0.0078158
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 0.0000206 | spectral_norm = 0.0040959 | frobenius_norm = 0.0046647 | spectral_norm_est_t2 = 0.0041024 | spectral_norm_est_t4 = 0.0040957
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 0.0000352 | spectral_norm = 0.0049337 | frobenius_norm = 0.0056806 | spectral_norm_est_t2 = 0.0049397 | spectral_norm_est_t4 = 0.0049338
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 0.0000692 | spectral_norm = 0.0042874 | frobenius_norm = 0.0060208 | spectral_norm_est_t2 = 0.0043391 | spectral_norm_est_t4 = 0.0042884
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 0.0000086 | spectral_norm = 0.0018470 | frobenius_norm = 0.0021155 | spectral_norm_est_t2 = 0.0018493 | spectral_norm_est_t4 = 0.0018469
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 0.0000090 | spectral_norm = 0.0009568 | frobenius_norm = 0.0017704 | spectral_norm_est_t2 = 0.0011327 | spectral_norm_est_t4 = 0.0010178
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 0.0000118 | spectral_norm = 0.0105542 | frobenius_norm = 0.0108317 | spectral_norm_est_t2 = 0.0105554 | spectral_norm_est_t4 = 0.0105544
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 0.0000223 | spectral_norm = 0.0058629 | frobenius_norm = 0.0064661 | spectral_norm_est_t2 = 0.0058671 | spectral_norm_est_t4 = 0.0058629
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 0.0000339 | spectral_norm = 0.0047086 | frobenius_norm = 0.0054221 | spectral_norm_est_t2 = 0.0047139 | spectral_norm_est_t4 = 0.0047087
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 0.0000697 | spectral_norm = 0.0040856 | frobenius_norm = 0.0057180 | spectral_norm_est_t2 = 0.0041300 | spectral_norm_est_t4 = 0.0040865
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 0.0000124 | spectral_norm = 0.0029586 | frobenius_norm = 0.0033079 | spectral_norm_est_t2 = 0.0029619 | spectral_norm_est_t4 = 0.0029585
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 0.0000132 | spectral_norm = 0.0019698 | frobenius_norm = 0.0030699 | spectral_norm_est_t2 = 0.0021710 | spectral_norm_est_t4 = 0.0020119
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 0.0000058 | spectral_norm = 0.0054910 | frobenius_norm = 0.0056102 | spectral_norm_est_t2 = 0.0054914 | spectral_norm_est_t4 = 0.0054911
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 0.0000305 | spectral_norm = 0.0070108 | frobenius_norm = 0.0074170 | spectral_norm_est_t2 = 0.0070118 | spectral_norm_est_t4 = 0.0070107
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 0.0000375 | spectral_norm = 0.0050992 | frobenius_norm = 0.0057791 | spectral_norm_est_t2 = 0.0051032 | spectral_norm_est_t4 = 0.0050993
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 0.0000762 | spectral_norm = 0.0044146 | frobenius_norm = 0.0061293 | spectral_norm_est_t2 = 0.0044566 | spectral_norm_est_t4 = 0.0044153
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 0.0000111 | spectral_norm = 0.0021426 | frobenius_norm = 0.0024273 | spectral_norm_est_t2 = 0.0021449 | spectral_norm_est_t4 = 0.0021427
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 0.0000116 | spectral_norm = 0.0013789 | frobenius_norm = 0.0021094 | spectral_norm_est_t2 = 0.0014706 | spectral_norm_est_t4 = 0.0013899
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 0.0000046 | spectral_norm = 0.0041763 | frobenius_norm = 0.0042499 | spectral_norm_est_t2 = 0.0041766 | spectral_norm_est_t4 = 0.0041764
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 0.0000365 | spectral_norm = 0.0093734 | frobenius_norm = 0.0096227 | spectral_norm_est_t2 = 0.0093738 | spectral_norm_est_t4 = 0.0093737
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 0.0000397 | spectral_norm = 0.0054961 | frobenius_norm = 0.0061096 | spectral_norm_est_t2 = 0.0054990 | spectral_norm_est_t4 = 0.0054959
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 0.0000768 | spectral_norm = 0.0046388 | frobenius_norm = 0.0064142 | spectral_norm_est_t2 = 0.0046934 | spectral_norm_est_t4 = 0.0046398
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 0.0000203 | spectral_norm = 0.0060413 | frobenius_norm = 0.0065184 | spectral_norm_est_t2 = 0.0060443 | spectral_norm_est_t4 = 0.0060411
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 0.0000231 | spectral_norm = 0.0030203 | frobenius_norm = 0.0049572 | spectral_norm_est_t2 = 0.0035048 | spectral_norm_est_t4 = 0.0031973
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 0.0000058 | spectral_norm = 0.0068176 | frobenius_norm = 0.0069294 | spectral_norm_est_t2 = 0.0068181 | spectral_norm_est_t4 = 0.0068177
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 0.0000479 | spectral_norm = 0.0321728 | frobenius_norm = 0.0323582 | spectral_norm_est_t2 = 0.0321743 | spectral_norm_est_t4 = 0.0321742
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 0.0000504 | spectral_norm = 0.0109485 | frobenius_norm = 0.0114789 | spectral_norm_est_t2 = 0.0109499 | spectral_norm_est_t4 = 0.0109483
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 0.0000914 | spectral_norm = 0.0081783 | frobenius_norm = 0.0103248 | spectral_norm_est_t2 = 0.0082483 | spectral_norm_est_t4 = 0.0081796
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 0.0000168 | spectral_norm = 0.0061033 | frobenius_norm = 0.0064075 | spectral_norm_est_t2 = 0.0061060 | spectral_norm_est_t4 = 0.0061031
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 0.0000179 | spectral_norm = 0.0024412 | frobenius_norm = 0.0034674 | spectral_norm_est_t2 = 0.0025914 | spectral_norm_est_t4 = 0.0024599
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 0.0000071 | spectral_norm = 0.0093056 | frobenius_norm = 0.0093941 | spectral_norm_est_t2 = 0.0093062 | spectral_norm_est_t4 = 0.0093060
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 0.0000413 | spectral_norm = 0.0373422 | frobenius_norm = 0.0375605 | spectral_norm_est_t2 = 0.0373441 | spectral_norm_est_t4 = 0.0373438
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 0.0000580 | spectral_norm = 0.0203378 | frobenius_norm = 0.0209543 | spectral_norm_est_t2 = 0.0203407 | spectral_norm_est_t4 = 0.0203375
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 0.0001070 | spectral_norm = 0.0156617 | frobenius_norm = 0.0182136 | spectral_norm_est_t2 = 0.0157209 | spectral_norm_est_t4 = 0.0156642
G name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 0.0000003
G name = 'module._orig_mod.lm_head.weight' | median_sv = 0.0003060 | spectral_norm = 0.2283062 | frobenius_norm = 0.2306666 | spectral_norm_est_t2 = 0.2283131 | spectral_norm_est_t4 = 0.2283078
saved grads to logs/1ef9fb63-cc79-4219-bbf9-a03b83709afa/grad_state_step000375.pt
===========================================
step:376/1480 train_time:104964ms step_avg:286.79ms
step:377/1480 train_time:105251ms step_avg:286.79ms
step:378/1480 train_time:105551ms step_avg:286.82ms
step:379/1480 train_time:105850ms step_avg:286.86ms
step:380/1480 train_time:106148ms step_avg:286.89ms
step:381/1480 train_time:106449ms step_avg:286.92ms
step:382/1480 train_time:106749ms step_avg:286.96ms
step:383/1480 train_time:107048ms step_avg:286.99ms
step:384/1480 train_time:107347ms step_avg:287.02ms
step:385/1480 train_time:107646ms step_avg:287.06ms
step:386/1480 train_time:107944ms step_avg:287.09ms
step:387/1480 train_time:108243ms step_avg:287.12ms
step:388/1480 train_time:108542ms step_avg:287.15ms
step:389/1480 train_time:108839ms step_avg:287.17ms
step:390/1480 train_time:109137ms step_avg:287.20ms
step:391/1480 train_time:109437ms step_avg:287.23ms
step:392/1480 train_time:109737ms step_avg:287.27ms
step:393/1480 train_time:110036ms step_avg:287.30ms
step:394/1480 train_time:110336ms step_avg:287.33ms
step:395/1480 train_time:110635ms step_avg:287.36ms
step:396/1480 train_time:110936ms step_avg:287.40ms
step:397/1480 train_time:111238ms step_avg:287.44ms
step:398/1480 train_time:111537ms step_avg:287.47ms
step:399/1480 train_time:111836ms step_avg:287.50ms
step:400/1480 train_time:112136ms step_avg:287.53ms
step:401/1480 train_time:112437ms step_avg:287.56ms
step:402/1480 train_time:112737ms step_avg:287.59ms
step:403/1480 train_time:113037ms step_avg:287.63ms
step:404/1480 train_time:113336ms step_avg:287.66ms
step:405/1480 train_time:113636ms step_avg:287.68ms
step:406/1480 train_time:113935ms step_avg:287.72ms
step:407/1480 train_time:114235ms step_avg:287.75ms
step:408/1480 train_time:114536ms step_avg:287.78ms
step:409/1480 train_time:114835ms step_avg:287.81ms
step:410/1480 train_time:115136ms step_avg:287.84ms
step:411/1480 train_time:115436ms step_avg:287.87ms
step:412/1480 train_time:115735ms step_avg:287.90ms
step:413/1480 train_time:116035ms step_avg:287.93ms
step:414/1480 train_time:116336ms step_avg:287.96ms
step:415/1480 train_time:116636ms step_avg:287.99ms
step:416/1480 train_time:116936ms step_avg:288.02ms
step:417/1480 train_time:117236ms step_avg:288.05ms
step:418/1480 train_time:117537ms step_avg:288.08ms
step:419/1480 train_time:117837ms step_avg:288.11ms
step:420/1480 train_time:118138ms step_avg:288.14ms
step:421/1480 train_time:118436ms step_avg:288.17ms
step:422/1480 train_time:118736ms step_avg:288.19ms
step:423/1480 train_time:119037ms step_avg:288.23ms
step:424/1480 train_time:119338ms step_avg:288.26ms
step:425/1480 train_time:119637ms step_avg:288.28ms
step:426/1480 train_time:119937ms step_avg:288.31ms
step:427/1480 train_time:120238ms step_avg:288.34ms
step:428/1480 train_time:120538ms step_avg:288.37ms
step:429/1480 train_time:120837ms step_avg:288.39ms
step:430/1480 train_time:121139ms step_avg:288.43ms
step:431/1480 train_time:121439ms step_avg:288.45ms
step:432/1480 train_time:121738ms step_avg:288.48ms
step:433/1480 train_time:122037ms step_avg:288.50ms
step:434/1480 train_time:122337ms step_avg:288.53ms
step:435/1480 train_time:122638ms step_avg:288.56ms
step:436/1480 train_time:122941ms step_avg:288.59ms
step:437/1480 train_time:123236ms step_avg:288.61ms
step:438/1480 train_time:123535ms step_avg:288.63ms
step:439/1480 train_time:123835ms step_avg:288.66ms
step:440/1480 train_time:124142ms step_avg:288.70ms
step:441/1480 train_time:124447ms step_avg:288.74ms
step:442/1480 train_time:124754ms step_avg:288.78ms
step:443/1480 train_time:125059ms step_avg:288.82ms
step:444/1480 train_time:125364ms step_avg:288.86ms
step:445/1480 train_time:125670ms step_avg:288.90ms
step:446/1480 train_time:125974ms step_avg:288.93ms
step:447/1480 train_time:126279ms step_avg:288.97ms
step:448/1480 train_time:126586ms step_avg:289.01ms
step:449/1480 train_time:126893ms step_avg:289.05ms
step:450/1480 train_time:127198ms step_avg:289.09ms
step:451/1480 train_time:127504ms step_avg:289.13ms
step:452/1480 train_time:127811ms step_avg:289.16ms
step:453/1480 train_time:128115ms step_avg:289.20ms
step:454/1480 train_time:128427ms step_avg:289.25ms
step:455/1480 train_time:128728ms step_avg:289.28ms
step:456/1480 train_time:129035ms step_avg:289.32ms
step:457/1480 train_time:129339ms step_avg:289.35ms
step:458/1480 train_time:129646ms step_avg:289.39ms
step:459/1480 train_time:129951ms step_avg:289.42ms
step:460/1480 train_time:130259ms step_avg:289.46ms
step:461/1480 train_time:130563ms step_avg:289.50ms
step:462/1480 train_time:130871ms step_avg:289.54ms
step:463/1480 train_time:131176ms step_avg:289.57ms
step:464/1480 train_time:131480ms step_avg:289.60ms
step:465/1480 train_time:131786ms step_avg:289.64ms
step:466/1480 train_time:132093ms step_avg:289.68ms
step:467/1480 train_time:132397ms step_avg:289.71ms
step:468/1480 train_time:132705ms step_avg:289.75ms
step:469/1480 train_time:133010ms step_avg:289.78ms
step:470/1480 train_time:133315ms step_avg:289.82ms
step:471/1480 train_time:133625ms step_avg:289.86ms
step:472/1480 train_time:133932ms step_avg:289.90ms
step:473/1480 train_time:134237ms step_avg:289.93ms
step:474/1480 train_time:134545ms step_avg:289.97ms
step:475/1480 train_time:134850ms step_avg:290.00ms
step:476/1480 train_time:135155ms step_avg:290.03ms
step:477/1480 train_time:135460ms step_avg:290.06ms
step:478/1480 train_time:135767ms step_avg:290.10ms
step:479/1480 train_time:136071ms step_avg:290.13ms
step:480/1480 train_time:136378ms step_avg:290.17ms
step:481/1480 train_time:136684ms step_avg:290.20ms
step:482/1480 train_time:136989ms step_avg:290.23ms
step:483/1480 train_time:137295ms step_avg:290.26ms
step:484/1480 train_time:137601ms step_avg:290.30ms
step:485/1480 train_time:137908ms step_avg:290.33ms
step:486/1480 train_time:138215ms step_avg:290.37ms
step:487/1480 train_time:138519ms step_avg:290.40ms
step:488/1480 train_time:138824ms step_avg:290.43ms
step:489/1480 train_time:139129ms step_avg:290.46ms
step:490/1480 train_time:139437ms step_avg:290.49ms
step:491/1480 train_time:139743ms step_avg:290.53ms
step:492/1480 train_time:140047ms step_avg:290.55ms
step:493/1480 train_time:140352ms step_avg:290.58ms
step:494/1480 train_time:140660ms step_avg:290.62ms
step:495/1480 train_time:140967ms step_avg:290.65ms
step:496/1480 train_time:141274ms step_avg:290.69ms
step:497/1480 train_time:141583ms step_avg:290.72ms
step:498/1480 train_time:141885ms step_avg:290.75ms
step:499/1480 train_time:142189ms step_avg:290.78ms
step:500/1480 train_time:142495ms step_avg:290.81ms
step:500/1480 val_loss:3.6821 train_time:142509ms step_avg:290.84ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 183.6539459
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 2.9463170 | spectral_norm = 13.0911465 | frobenius_norm = 103.8981247
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 2.6665022 | spectral_norm = 17.8476715 | frobenius_norm = 96.9418030
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 2.9317911 | spectral_norm = 10.0337543 | frobenius_norm = 101.5289383
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 2.9241381 | spectral_norm = 8.0809088 | frobenius_norm = 100.5524139
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 6.9132161 | spectral_norm = 14.3786335 | frobenius_norm = 205.4194946
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 3.5845883 | spectral_norm = 9.4873486 | frobenius_norm = 108.8946533
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 2.8972459 | spectral_norm = 10.2408438 | frobenius_norm = 103.2365189
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 2.8190110 | spectral_norm = 10.9540024 | frobenius_norm = 100.3881073
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 2.6373799 | spectral_norm = 9.4200859 | frobenius_norm = 100.7516937
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 3.0217002 | spectral_norm = 7.8383088 | frobenius_norm = 106.3046494
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 7.6410751 | spectral_norm = 16.5519009 | frobenius_norm = 225.7638702
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 3.7996359 | spectral_norm = 10.6282759 | frobenius_norm = 115.5297394
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 2.8049171 | spectral_norm = 8.9018774 | frobenius_norm = 103.4789352
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 2.8177791 | spectral_norm = 8.6348572 | frobenius_norm = 102.7313309
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 2.9019463 | spectral_norm = 10.8770285 | frobenius_norm = 112.2712173
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 3.4076698 | spectral_norm = 8.2582874 | frobenius_norm = 115.2698441
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 7.8468557 | spectral_norm = 16.8635540 | frobenius_norm = 231.0999451
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 3.7679918 | spectral_norm = 10.0732498 | frobenius_norm = 114.3418579
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 2.8825746 | spectral_norm = 10.6879902 | frobenius_norm = 103.3933182
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 2.8298564 | spectral_norm = 9.8368597 | frobenius_norm = 100.7307281
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 2.8822177 | spectral_norm = 10.4240160 | frobenius_norm = 112.0774155
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 3.1701288 | spectral_norm = 8.5583782 | frobenius_norm = 111.5249863
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 7.9936981 | spectral_norm = 17.1745148 | frobenius_norm = 235.8031616
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 3.8818715 | spectral_norm = 9.8369322 | frobenius_norm = 117.3329163
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 2.7489812 | spectral_norm = 9.5941744 | frobenius_norm = 101.5346527
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 2.7530503 | spectral_norm = 9.1261120 | frobenius_norm = 101.5722504
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 2.9663780 | spectral_norm = 10.6578426 | frobenius_norm = 115.3097000
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 3.3806334 | spectral_norm = 8.5450096 | frobenius_norm = 115.5634079
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 8.1277266 | spectral_norm = 16.9259052 | frobenius_norm = 238.4110260
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 3.8406856 | spectral_norm = 9.6953154 | frobenius_norm = 116.6641235
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 2.8286750 | spectral_norm = 9.8586864 | frobenius_norm = 102.2880478
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 2.8253579 | spectral_norm = 9.5291777 | frobenius_norm = 101.3138123
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 3.0227592 | spectral_norm = 10.7599449 | frobenius_norm = 114.7590866
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 3.2915809 | spectral_norm = 8.5707588 | frobenius_norm = 113.0428085
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 8.1916561 | spectral_norm = 16.5168457 | frobenius_norm = 240.0426788
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 3.8888242 | spectral_norm = 9.4569187 | frobenius_norm = 117.7136078
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 2.8790300 | spectral_norm = 9.4180174 | frobenius_norm = 103.5283203
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 2.8687472 | spectral_norm = 9.0634537 | frobenius_norm = 102.5953598
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 2.9984834 | spectral_norm = 11.1386595 | frobenius_norm = 117.2982178
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 3.3901923 | spectral_norm = 8.3121328 | frobenius_norm = 114.2684555
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 8.0288982 | spectral_norm = 17.6286182 | frobenius_norm = 236.7575226
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 3.8535843 | spectral_norm = 10.0467854 | frobenius_norm = 117.1910858
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 2.9017410 | spectral_norm = 10.1318932 | frobenius_norm = 103.6663361
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 2.8956978 | spectral_norm = 9.4085808 | frobenius_norm = 102.9635010
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 2.8901050 | spectral_norm = 10.2038870 | frobenius_norm = 113.0113373
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 3.2818751 | spectral_norm = 8.4751091 | frobenius_norm = 113.5635834
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 8.1347513 | spectral_norm = 18.1739960 | frobenius_norm = 240.4418335
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 3.9239385 | spectral_norm = 10.1902246 | frobenius_norm = 118.6714859
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 2.8900340 | spectral_norm = 9.2246389 | frobenius_norm = 105.5747833
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 2.8578658 | spectral_norm = 9.7790060 | frobenius_norm = 104.2149353
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 3.0458446 | spectral_norm = 12.7623348 | frobenius_norm = 118.1556244
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 3.4618285 | spectral_norm = 8.5942516 | frobenius_norm = 114.7851257
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 8.1554566 | spectral_norm = 18.6198559 | frobenius_norm = 240.3628998
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 3.9490359 | spectral_norm = 10.4655409 | frobenius_norm = 118.8231659
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 3.0330179 | spectral_norm = 9.5075302 | frobenius_norm = 108.6445312
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 2.9675100 | spectral_norm = 10.5410137 | frobenius_norm = 107.4580841
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 3.1573126 | spectral_norm = 11.0445385 | frobenius_norm = 117.5333099
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 3.5106859 | spectral_norm = 7.8895755 | frobenius_norm = 115.5063934
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 8.1695347 | spectral_norm = 18.0692978 | frobenius_norm = 240.9645386
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 3.9804959 | spectral_norm = 11.0477791 | frobenius_norm = 119.2253952
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 2.6034856 | spectral_norm = 11.2524071 | frobenius_norm = 102.2008514
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 2.4611678 | spectral_norm = 10.6638298 | frobenius_norm = 102.1683884
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 2.9293251 | spectral_norm = 10.7000418 | frobenius_norm = 110.9040070
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 3.6553173 | spectral_norm = 8.1785364 | frobenius_norm = 120.9833527
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 8.3410187 | spectral_norm = 16.6833935 | frobenius_norm = 243.2322845
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 3.7685649 | spectral_norm = 12.1562567 | frobenius_norm = 112.9957047
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 2.8934527 | spectral_norm = 11.0680685 | frobenius_norm = 106.4811554
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 2.7905345 | spectral_norm = 10.9314232 | frobenius_norm = 103.7701721
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 2.8317421 | spectral_norm = 11.1494360 | frobenius_norm = 106.7680359
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 3.5434618 | spectral_norm = 8.3301697 | frobenius_norm = 119.9598541
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 8.3757296 | spectral_norm = 20.2324314 | frobenius_norm = 245.9498596
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 3.7703698 | spectral_norm = 12.2741890 | frobenius_norm = 114.4871063
W name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 275.2854614
W name = 'module._orig_mod.lm_head.weight' | median_sv = 24.9664841 | spectral_norm = 169.2093658 | frobenius_norm = 825.4257812
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 0.0000002
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 0.0000121 | spectral_norm = 0.0006801 | frobenius_norm = 0.0012386 | spectral_norm_est_t2 = 0.0007139 | spectral_norm_est_t4 = 0.0006812
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 0.0000119 | spectral_norm = 0.0005776 | frobenius_norm = 0.0012630 | spectral_norm_est_t2 = 0.0006675 | spectral_norm_est_t4 = 0.0005909
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 0.0000108 | spectral_norm = 0.0043295 | frobenius_norm = 0.0046182 | spectral_norm_est_t2 = 0.0043336 | spectral_norm_est_t4 = 0.0043292
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 0.0000255 | spectral_norm = 0.0104424 | frobenius_norm = 0.0107135 | spectral_norm_est_t2 = 0.0104431 | spectral_norm_est_t4 = 0.0104427
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 0.0000443 | spectral_norm = 0.0054284 | frobenius_norm = 0.0058886 | spectral_norm_est_t2 = 0.0054294 | spectral_norm_est_t4 = 0.0054286
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 0.0000759 | spectral_norm = 0.0032188 | frobenius_norm = 0.0048968 | spectral_norm_est_t2 = 0.0032366 | spectral_norm_est_t4 = 0.0032189
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 0.0000057 | spectral_norm = 0.0017416 | frobenius_norm = 0.0018930 | spectral_norm_est_t2 = 0.0017426 | spectral_norm_est_t4 = 0.0017416
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 0.0000063 | spectral_norm = 0.0010213 | frobenius_norm = 0.0014789 | spectral_norm_est_t2 = 0.0010673 | spectral_norm_est_t4 = 0.0010238
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 0.0000136 | spectral_norm = 0.0115950 | frobenius_norm = 0.0117759 | spectral_norm_est_t2 = 0.0115955 | spectral_norm_est_t4 = 0.0115952
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 0.0000243 | spectral_norm = 0.0056582 | frobenius_norm = 0.0064783 | spectral_norm_est_t2 = 0.0056683 | spectral_norm_est_t4 = 0.0056581
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 0.0000330 | spectral_norm = 0.0038753 | frobenius_norm = 0.0044771 | spectral_norm_est_t2 = 0.0038782 | spectral_norm_est_t4 = 0.0038755
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 0.0000637 | spectral_norm = 0.0030602 | frobenius_norm = 0.0049058 | spectral_norm_est_t2 = 0.0032150 | spectral_norm_est_t4 = 0.0030750
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 0.0000105 | spectral_norm = 0.0042302 | frobenius_norm = 0.0044945 | spectral_norm_est_t2 = 0.0042317 | spectral_norm_est_t4 = 0.0042300
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 0.0000111 | spectral_norm = 0.0016125 | frobenius_norm = 0.0025453 | spectral_norm_est_t2 = 0.0017889 | spectral_norm_est_t4 = 0.0016554
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 0.0000116 | spectral_norm = 0.0106214 | frobenius_norm = 0.0108002 | spectral_norm_est_t2 = 0.0106216 | spectral_norm_est_t4 = 0.0106213
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 0.0000260 | spectral_norm = 0.0048043 | frobenius_norm = 0.0056214 | spectral_norm_est_t2 = 0.0048204 | spectral_norm_est_t4 = 0.0048041
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 0.0000409 | spectral_norm = 0.0052828 | frobenius_norm = 0.0060368 | spectral_norm_est_t2 = 0.0052887 | spectral_norm_est_t4 = 0.0052828
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 0.0000782 | spectral_norm = 0.0043868 | frobenius_norm = 0.0065101 | spectral_norm_est_t2 = 0.0044465 | spectral_norm_est_t4 = 0.0043876
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 0.0000078 | spectral_norm = 0.0017900 | frobenius_norm = 0.0020586 | spectral_norm_est_t2 = 0.0017929 | spectral_norm_est_t4 = 0.0017899
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 0.0000085 | spectral_norm = 0.0008804 | frobenius_norm = 0.0016054 | spectral_norm_est_t2 = 0.0009806 | spectral_norm_est_t4 = 0.0008927
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 0.0000143 | spectral_norm = 0.0120159 | frobenius_norm = 0.0123023 | spectral_norm_est_t2 = 0.0120167 | spectral_norm_est_t4 = 0.0120159
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 0.0000225 | spectral_norm = 0.0042753 | frobenius_norm = 0.0052186 | spectral_norm_est_t2 = 0.0042887 | spectral_norm_est_t4 = 0.0042751
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 0.0000370 | spectral_norm = 0.0056306 | frobenius_norm = 0.0063376 | spectral_norm_est_t2 = 0.0056353 | spectral_norm_est_t4 = 0.0056318
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 0.0000705 | spectral_norm = 0.0045980 | frobenius_norm = 0.0063351 | spectral_norm_est_t2 = 0.0046295 | spectral_norm_est_t4 = 0.0045983
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 0.0000107 | spectral_norm = 0.0019291 | frobenius_norm = 0.0024310 | spectral_norm_est_t2 = 0.0019402 | spectral_norm_est_t4 = 0.0019291
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 0.0000118 | spectral_norm = 0.0013364 | frobenius_norm = 0.0024390 | spectral_norm_est_t2 = 0.0015244 | spectral_norm_est_t4 = 0.0013811
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 0.0000136 | spectral_norm = 0.0113460 | frobenius_norm = 0.0116074 | spectral_norm_est_t2 = 0.0113467 | spectral_norm_est_t4 = 0.0113462
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 0.0000227 | spectral_norm = 0.0046490 | frobenius_norm = 0.0054601 | spectral_norm_est_t2 = 0.0046578 | spectral_norm_est_t4 = 0.0046491
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 0.0000383 | spectral_norm = 0.0057058 | frobenius_norm = 0.0065174 | spectral_norm_est_t2 = 0.0057116 | spectral_norm_est_t4 = 0.0057068
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 0.0000726 | spectral_norm = 0.0050634 | frobenius_norm = 0.0071101 | spectral_norm_est_t2 = 0.0051180 | spectral_norm_est_t4 = 0.0050640
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 0.0000085 | spectral_norm = 0.0018923 | frobenius_norm = 0.0021911 | spectral_norm_est_t2 = 0.0018951 | spectral_norm_est_t4 = 0.0018923
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 0.0000090 | spectral_norm = 0.0010403 | frobenius_norm = 0.0019345 | spectral_norm_est_t2 = 0.0012139 | spectral_norm_est_t4 = 0.0010867
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 0.0000130 | spectral_norm = 0.0105624 | frobenius_norm = 0.0108986 | spectral_norm_est_t2 = 0.0105637 | spectral_norm_est_t4 = 0.0105625
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 0.0000186 | spectral_norm = 0.0048269 | frobenius_norm = 0.0055669 | spectral_norm_est_t2 = 0.0048350 | spectral_norm_est_t4 = 0.0048270
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 0.0000333 | spectral_norm = 0.0050960 | frobenius_norm = 0.0058510 | spectral_norm_est_t2 = 0.0051006 | spectral_norm_est_t4 = 0.0050962
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 0.0000645 | spectral_norm = 0.0041905 | frobenius_norm = 0.0060147 | spectral_norm_est_t2 = 0.0042380 | spectral_norm_est_t4 = 0.0041911
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 0.0000082 | spectral_norm = 0.0020888 | frobenius_norm = 0.0023475 | spectral_norm_est_t2 = 0.0020913 | spectral_norm_est_t4 = 0.0020888
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 0.0000087 | spectral_norm = 0.0014333 | frobenius_norm = 0.0023032 | spectral_norm_est_t2 = 0.0015680 | spectral_norm_est_t4 = 0.0014483
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 0.0000076 | spectral_norm = 0.0072618 | frobenius_norm = 0.0074303 | spectral_norm_est_t2 = 0.0072624 | spectral_norm_est_t4 = 0.0072619
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 0.0000179 | spectral_norm = 0.0039409 | frobenius_norm = 0.0044045 | spectral_norm_est_t2 = 0.0039446 | spectral_norm_est_t4 = 0.0039414
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 0.0000324 | spectral_norm = 0.0045622 | frobenius_norm = 0.0052007 | spectral_norm_est_t2 = 0.0045656 | spectral_norm_est_t4 = 0.0045625
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 0.0000633 | spectral_norm = 0.0039114 | frobenius_norm = 0.0054113 | spectral_norm_est_t2 = 0.0039344 | spectral_norm_est_t4 = 0.0039116
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 0.0000073 | spectral_norm = 0.0013940 | frobenius_norm = 0.0016752 | spectral_norm_est_t2 = 0.0013982 | spectral_norm_est_t4 = 0.0013939
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 0.0000076 | spectral_norm = 0.0007665 | frobenius_norm = 0.0014394 | spectral_norm_est_t2 = 0.0008710 | spectral_norm_est_t4 = 0.0007810
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 0.0000118 | spectral_norm = 0.0101162 | frobenius_norm = 0.0103704 | spectral_norm_est_t2 = 0.0101169 | spectral_norm_est_t4 = 0.0101163
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 0.0000197 | spectral_norm = 0.0055733 | frobenius_norm = 0.0060846 | spectral_norm_est_t2 = 0.0055756 | spectral_norm_est_t4 = 0.0055734
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 0.0000309 | spectral_norm = 0.0040253 | frobenius_norm = 0.0046404 | spectral_norm_est_t2 = 0.0040283 | spectral_norm_est_t4 = 0.0040255
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 0.0000640 | spectral_norm = 0.0033745 | frobenius_norm = 0.0048843 | spectral_norm_est_t2 = 0.0034053 | spectral_norm_est_t4 = 0.0033750
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 0.0000102 | spectral_norm = 0.0031766 | frobenius_norm = 0.0034395 | spectral_norm_est_t2 = 0.0031780 | spectral_norm_est_t4 = 0.0031766
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 0.0000110 | spectral_norm = 0.0022655 | frobenius_norm = 0.0033612 | spectral_norm_est_t2 = 0.0024476 | spectral_norm_est_t4 = 0.0022910
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 0.0000055 | spectral_norm = 0.0057122 | frobenius_norm = 0.0058277 | spectral_norm_est_t2 = 0.0057125 | spectral_norm_est_t4 = 0.0057122
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 0.0000263 | spectral_norm = 0.0071633 | frobenius_norm = 0.0074533 | spectral_norm_est_t2 = 0.0071636 | spectral_norm_est_t4 = 0.0071632
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 0.0000337 | spectral_norm = 0.0047084 | frobenius_norm = 0.0052508 | spectral_norm_est_t2 = 0.0047102 | spectral_norm_est_t4 = 0.0047084
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 0.0000688 | spectral_norm = 0.0037803 | frobenius_norm = 0.0052620 | spectral_norm_est_t2 = 0.0038026 | spectral_norm_est_t4 = 0.0037804
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 0.0000088 | spectral_norm = 0.0019718 | frobenius_norm = 0.0021752 | spectral_norm_est_t2 = 0.0019728 | spectral_norm_est_t4 = 0.0019717
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 0.0000093 | spectral_norm = 0.0013033 | frobenius_norm = 0.0019767 | spectral_norm_est_t2 = 0.0014394 | spectral_norm_est_t4 = 0.0013354
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 0.0000042 | spectral_norm = 0.0037783 | frobenius_norm = 0.0038507 | spectral_norm_est_t2 = 0.0037785 | spectral_norm_est_t4 = 0.0037783
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 0.0000315 | spectral_norm = 0.0094126 | frobenius_norm = 0.0095926 | spectral_norm_est_t2 = 0.0094130 | spectral_norm_est_t4 = 0.0094129
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 0.0000359 | spectral_norm = 0.0049555 | frobenius_norm = 0.0054276 | spectral_norm_est_t2 = 0.0049567 | spectral_norm_est_t4 = 0.0049554
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 0.0000701 | spectral_norm = 0.0039948 | frobenius_norm = 0.0054584 | spectral_norm_est_t2 = 0.0040185 | spectral_norm_est_t4 = 0.0039950
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 0.0000168 | spectral_norm = 0.0053271 | frobenius_norm = 0.0056856 | spectral_norm_est_t2 = 0.0053286 | spectral_norm_est_t4 = 0.0053272
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 0.0000191 | spectral_norm = 0.0027566 | frobenius_norm = 0.0042458 | spectral_norm_est_t2 = 0.0030297 | spectral_norm_est_t4 = 0.0028131
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 0.0000051 | spectral_norm = 0.0064383 | frobenius_norm = 0.0065380 | spectral_norm_est_t2 = 0.0064386 | spectral_norm_est_t4 = 0.0064384
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 0.0000420 | spectral_norm = 0.0340599 | frobenius_norm = 0.0342191 | spectral_norm_est_t2 = 0.0340615 | spectral_norm_est_t4 = 0.0340614
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 0.0000459 | spectral_norm = 0.0146612 | frobenius_norm = 0.0150235 | spectral_norm_est_t2 = 0.0146617 | spectral_norm_est_t4 = 0.0146613
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 0.0000834 | spectral_norm = 0.0103040 | frobenius_norm = 0.0117647 | spectral_norm_est_t2 = 0.0103243 | spectral_norm_est_t4 = 0.0103063
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 0.0000135 | spectral_norm = 0.0126470 | frobenius_norm = 0.0127460 | spectral_norm_est_t2 = 0.0126472 | spectral_norm_est_t4 = 0.0126471
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 0.0000143 | spectral_norm = 0.0053818 | frobenius_norm = 0.0061276 | spectral_norm_est_t2 = 0.0054345 | spectral_norm_est_t4 = 0.0053828
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 0.0000058 | spectral_norm = 0.0090560 | frobenius_norm = 0.0091207 | spectral_norm_est_t2 = 0.0090562 | spectral_norm_est_t4 = 0.0090561
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 0.0000348 | spectral_norm = 0.0349093 | frobenius_norm = 0.0351211 | spectral_norm_est_t2 = 0.0349108 | spectral_norm_est_t4 = 0.0349104
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 0.0000507 | spectral_norm = 0.0203784 | frobenius_norm = 0.0208222 | spectral_norm_est_t2 = 0.0203799 | spectral_norm_est_t4 = 0.0203784
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 0.0000966 | spectral_norm = 0.0154720 | frobenius_norm = 0.0177359 | spectral_norm_est_t2 = 0.0155205 | spectral_norm_est_t4 = 0.0154760
G name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 0.0000003
G name = 'module._orig_mod.lm_head.weight' | median_sv = 0.0002669 | spectral_norm = 0.1813305 | frobenius_norm = 0.1844769 | spectral_norm_est_t2 = 0.1813481 | spectral_norm_est_t4 = 0.1813293
saved grads to logs/1ef9fb63-cc79-4219-bbf9-a03b83709afa/grad_state_step000500.pt
===========================================
step:501/1480 train_time:142822ms step_avg:290.88ms
step:502/1480 train_time:143115ms step_avg:290.88ms
step:503/1480 train_time:143418ms step_avg:290.91ms
step:504/1480 train_time:143723ms step_avg:290.94ms
step:505/1480 train_time:144026ms step_avg:290.96ms
step:506/1480 train_time:144330ms step_avg:290.99ms
step:507/1480 train_time:144639ms step_avg:291.02ms
step:508/1480 train_time:144943ms step_avg:291.05ms
step:509/1480 train_time:145248ms step_avg:291.08ms
step:510/1480 train_time:145552ms step_avg:291.10ms
step:511/1480 train_time:145859ms step_avg:291.13ms
step:512/1480 train_time:146164ms step_avg:291.16ms
step:513/1480 train_time:146471ms step_avg:291.19ms
step:514/1480 train_time:146775ms step_avg:291.22ms
step:515/1480 train_time:147083ms step_avg:291.25ms
step:516/1480 train_time:147392ms step_avg:291.29ms
step:517/1480 train_time:147697ms step_avg:291.32ms
step:518/1480 train_time:148001ms step_avg:291.34ms
step:519/1480 train_time:148306ms step_avg:291.37ms
step:520/1480 train_time:148611ms step_avg:291.39ms
step:521/1480 train_time:148917ms step_avg:291.42ms
step:522/1480 train_time:149221ms step_avg:291.45ms
step:523/1480 train_time:149527ms step_avg:291.48ms
step:524/1480 train_time:149835ms step_avg:291.51ms
step:525/1480 train_time:150141ms step_avg:291.54ms
step:526/1480 train_time:150445ms step_avg:291.56ms
step:527/1480 train_time:150750ms step_avg:291.59ms
step:528/1480 train_time:151055ms step_avg:291.61ms
step:529/1480 train_time:151359ms step_avg:291.64ms
step:530/1480 train_time:151666ms step_avg:291.66ms
step:531/1480 train_time:151971ms step_avg:291.69ms
step:532/1480 train_time:152279ms step_avg:291.72ms
step:533/1480 train_time:152585ms step_avg:291.75ms
step:534/1480 train_time:152893ms step_avg:291.78ms
step:535/1480 train_time:153201ms step_avg:291.81ms
step:536/1480 train_time:153507ms step_avg:291.84ms
step:537/1480 train_time:153813ms step_avg:291.87ms
step:538/1480 train_time:154120ms step_avg:291.89ms
step:539/1480 train_time:154427ms step_avg:291.92ms
step:540/1480 train_time:154735ms step_avg:291.95ms
step:541/1480 train_time:155040ms step_avg:291.98ms
step:542/1480 train_time:155346ms step_avg:292.00ms
step:543/1480 train_time:155651ms step_avg:292.03ms
step:544/1480 train_time:155956ms step_avg:292.05ms
step:545/1480 train_time:156263ms step_avg:292.08ms
step:546/1480 train_time:156568ms step_avg:292.10ms
step:547/1480 train_time:156875ms step_avg:292.13ms
step:548/1480 train_time:157182ms step_avg:292.16ms
step:549/1480 train_time:157490ms step_avg:292.19ms
step:550/1480 train_time:157801ms step_avg:292.22ms
step:551/1480 train_time:158113ms step_avg:292.26ms
step:552/1480 train_time:158422ms step_avg:292.29ms
step:553/1480 train_time:158733ms step_avg:292.33ms
step:554/1480 train_time:159044ms step_avg:292.36ms
step:555/1480 train_time:159354ms step_avg:292.39ms
step:556/1480 train_time:159663ms step_avg:292.42ms
step:557/1480 train_time:159974ms step_avg:292.46ms
step:558/1480 train_time:160284ms step_avg:292.49ms
step:559/1480 train_time:160593ms step_avg:292.52ms
step:560/1480 train_time:160902ms step_avg:292.55ms
step:561/1480 train_time:161210ms step_avg:292.58ms
step:562/1480 train_time:161520ms step_avg:292.61ms
step:563/1480 train_time:161832ms step_avg:292.64ms
step:564/1480 train_time:162142ms step_avg:292.67ms
step:565/1480 train_time:162457ms step_avg:292.72ms
step:566/1480 train_time:162764ms step_avg:292.74ms
step:567/1480 train_time:163077ms step_avg:292.78ms
step:568/1480 train_time:163389ms step_avg:292.81ms
step:569/1480 train_time:163700ms step_avg:292.84ms
step:570/1480 train_time:164011ms step_avg:292.88ms
step:571/1480 train_time:164324ms step_avg:292.91ms
step:572/1480 train_time:164636ms step_avg:292.95ms
step:573/1480 train_time:164949ms step_avg:292.98ms
step:574/1480 train_time:165260ms step_avg:293.01ms
step:575/1480 train_time:165576ms step_avg:293.06ms
step:576/1480 train_time:165889ms step_avg:293.09ms
step:577/1480 train_time:166200ms step_avg:293.12ms
step:578/1480 train_time:166508ms step_avg:293.15ms
step:579/1480 train_time:166821ms step_avg:293.18ms
step:580/1480 train_time:167131ms step_avg:293.21ms
step:581/1480 train_time:167443ms step_avg:293.25ms
step:582/1480 train_time:167753ms step_avg:293.28ms
step:583/1480 train_time:168066ms step_avg:293.31ms
step:584/1480 train_time:168378ms step_avg:293.34ms
step:585/1480 train_time:168691ms step_avg:293.38ms
step:586/1480 train_time:169003ms step_avg:293.41ms
step:587/1480 train_time:169315ms step_avg:293.44ms
step:588/1480 train_time:169627ms step_avg:293.47ms
step:589/1480 train_time:169939ms step_avg:293.50ms
step:590/1480 train_time:170253ms step_avg:293.54ms
step:591/1480 train_time:170564ms step_avg:293.57ms
step:592/1480 train_time:170875ms step_avg:293.60ms
step:593/1480 train_time:171188ms step_avg:293.63ms
step:594/1480 train_time:171502ms step_avg:293.67ms
step:595/1480 train_time:171815ms step_avg:293.70ms
step:596/1480 train_time:172127ms step_avg:293.73ms
step:597/1480 train_time:172441ms step_avg:293.77ms
step:598/1480 train_time:172749ms step_avg:293.79ms
step:599/1480 train_time:173062ms step_avg:293.82ms
step:600/1480 train_time:173373ms step_avg:293.85ms
step:601/1480 train_time:173684ms step_avg:293.88ms
step:602/1480 train_time:173998ms step_avg:293.92ms
step:603/1480 train_time:174308ms step_avg:293.94ms
step:604/1480 train_time:174625ms step_avg:293.98ms
step:605/1480 train_time:174933ms step_avg:294.01ms
step:606/1480 train_time:175243ms step_avg:294.03ms
step:607/1480 train_time:175558ms step_avg:294.07ms
step:608/1480 train_time:175869ms step_avg:294.10ms
step:609/1480 train_time:176180ms step_avg:294.12ms
step:610/1480 train_time:176489ms step_avg:294.15ms
step:611/1480 train_time:176801ms step_avg:294.18ms
step:612/1480 train_time:177112ms step_avg:294.21ms
step:613/1480 train_time:177425ms step_avg:294.24ms
step:614/1480 train_time:177737ms step_avg:294.27ms
step:615/1480 train_time:178047ms step_avg:294.29ms
step:616/1480 train_time:178356ms step_avg:294.32ms
step:617/1480 train_time:178667ms step_avg:294.35ms
step:618/1480 train_time:178981ms step_avg:294.38ms
step:619/1480 train_time:179291ms step_avg:294.40ms
step:620/1480 train_time:179604ms step_avg:294.43ms
step:621/1480 train_time:179917ms step_avg:294.46ms
step:622/1480 train_time:180227ms step_avg:294.49ms
step:623/1480 train_time:180540ms step_avg:294.52ms
step:624/1480 train_time:180853ms step_avg:294.55ms
step:625/1480 train_time:181167ms step_avg:294.58ms
step:625/1480 val_loss:3.5993 train_time:181183ms step_avg:294.61ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 198.0983429
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 3.3866651 | spectral_norm = 16.2768936 | frobenius_norm = 120.9492264
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 3.0592370 | spectral_norm = 21.5762005 | frobenius_norm = 112.3205948
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 3.3567405 | spectral_norm = 12.2004862 | frobenius_norm = 117.0406342
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 3.3566635 | spectral_norm = 9.5487490 | frobenius_norm = 115.8822861
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 8.1034279 | spectral_norm = 16.9976578 | frobenius_norm = 240.6864929
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 4.1811581 | spectral_norm = 11.4945374 | frobenius_norm = 127.1432495
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 3.3273950 | spectral_norm = 12.1336985 | frobenius_norm = 120.0485229
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 3.2484799 | spectral_norm = 12.8746862 | frobenius_norm = 116.7682190
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 3.0684188 | spectral_norm = 10.9459305 | frobenius_norm = 116.9408188
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 3.4907909 | spectral_norm = 9.1701546 | frobenius_norm = 123.4622803
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 8.8909311 | spectral_norm = 19.8180389 | frobenius_norm = 263.1914368
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 4.4063635 | spectral_norm = 12.7292318 | frobenius_norm = 134.4333954
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 3.2003193 | spectral_norm = 10.4475698 | frobenius_norm = 120.2227478
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 3.2174523 | spectral_norm = 10.2351732 | frobenius_norm = 119.2072525
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 3.4231987 | spectral_norm = 12.7180262 | frobenius_norm = 131.7021790
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 3.9696052 | spectral_norm = 9.6693649 | frobenius_norm = 134.4727325
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 9.1329184 | spectral_norm = 20.3202000 | frobenius_norm = 268.9199219
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 4.3698564 | spectral_norm = 12.1407223 | frobenius_norm = 133.1036072
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 3.3120570 | spectral_norm = 12.7399025 | frobenius_norm = 120.3414078
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 3.2660561 | spectral_norm = 11.6590099 | frobenius_norm = 117.0327225
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 3.3991823 | spectral_norm = 12.1729956 | frobenius_norm = 130.6536713
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 3.7190402 | spectral_norm = 9.9630556 | frobenius_norm = 130.0948029
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 9.2985315 | spectral_norm = 20.8362389 | frobenius_norm = 275.6062622
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 4.5123115 | spectral_norm = 11.8526897 | frobenius_norm = 136.9754944
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 3.1318951 | spectral_norm = 11.2764673 | frobenius_norm = 117.7737122
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 3.1386662 | spectral_norm = 10.7576609 | frobenius_norm = 117.7300797
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 3.5057428 | spectral_norm = 12.4391232 | frobenius_norm = 135.1920929
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 3.9891124 | spectral_norm = 9.7684870 | frobenius_norm = 135.1056671
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 9.4657431 | spectral_norm = 20.3198872 | frobenius_norm = 278.1587830
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 4.4621086 | spectral_norm = 11.3478184 | frobenius_norm = 135.9441986
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 3.2548010 | spectral_norm = 11.8826103 | frobenius_norm = 118.8707428
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 3.2622151 | spectral_norm = 11.3418884 | frobenius_norm = 117.6843796
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 3.5651708 | spectral_norm = 12.3926287 | frobenius_norm = 134.3480072
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 3.8331771 | spectral_norm = 10.1234093 | frobenius_norm = 132.0400543
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 9.5447626 | spectral_norm = 19.3645687 | frobenius_norm = 280.0703735
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 4.5326405 | spectral_norm = 11.3943872 | frobenius_norm = 137.3744049
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 3.3085473 | spectral_norm = 11.0625896 | frobenius_norm = 120.3769455
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 3.2860410 | spectral_norm = 10.7753067 | frobenius_norm = 119.1023560
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 3.5593188 | spectral_norm = 12.8355598 | frobenius_norm = 137.9382629
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 3.9663606 | spectral_norm = 9.5974026 | frobenius_norm = 134.0206299
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 9.3201742 | spectral_norm = 20.5991344 | frobenius_norm = 275.2046509
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 4.4853006 | spectral_norm = 11.8121004 | frobenius_norm = 136.6621704
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 3.3197579 | spectral_norm = 11.9290180 | frobenius_norm = 120.3817368
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 3.3027907 | spectral_norm = 11.3585339 | frobenius_norm = 119.2348175
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 3.3913717 | spectral_norm = 11.7525606 | frobenius_norm = 132.2010498
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 3.7871120 | spectral_norm = 9.9165792 | frobenius_norm = 132.2071838
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 9.4628630 | spectral_norm = 21.4448547 | frobenius_norm = 279.7857056
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 4.5934515 | spectral_norm = 12.0788565 | frobenius_norm = 138.7254181
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 3.3406623 | spectral_norm = 11.1930342 | frobenius_norm = 123.2490463
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 3.2729056 | spectral_norm = 11.6340790 | frobenius_norm = 121.3889236
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 3.6240239 | spectral_norm = 15.2173595 | frobenius_norm = 139.9635315
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 4.0582681 | spectral_norm = 10.0424795 | frobenius_norm = 134.3493042
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 9.4791975 | spectral_norm = 22.0151711 | frobenius_norm = 279.5761719
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 4.6201692 | spectral_norm = 12.5215273 | frobenius_norm = 139.2491302
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 3.5102301 | spectral_norm = 11.1909666 | frobenius_norm = 126.9958649
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 3.4190724 | spectral_norm = 12.7156296 | frobenius_norm = 125.4550018
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 3.7417572 | spectral_norm = 13.2071772 | frobenius_norm = 138.9520264
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 4.0868764 | spectral_norm = 9.1196413 | frobenius_norm = 134.4680328
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 9.4940157 | spectral_norm = 21.8533173 | frobenius_norm = 280.3705139
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 4.6693187 | spectral_norm = 13.2288980 | frobenius_norm = 140.0316162
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 2.9176893 | spectral_norm = 13.7273951 | frobenius_norm = 118.2280960
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 2.7679327 | spectral_norm = 12.7568302 | frobenius_norm = 118.7662430
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 3.4391132 | spectral_norm = 12.6130838 | frobenius_norm = 130.1190338
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 4.2872229 | spectral_norm = 9.3241062 | frobenius_norm = 140.3625946
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 9.7643414 | spectral_norm = 19.5770817 | frobenius_norm = 284.2426453
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 4.3572178 | spectral_norm = 15.1003227 | frobenius_norm = 130.9205780
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 3.2968676 | spectral_norm = 13.5040159 | frobenius_norm = 124.0384903
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 3.1854665 | spectral_norm = 13.1101971 | frobenius_norm = 120.4174423
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 3.2965834 | spectral_norm = 13.5213680 | frobenius_norm = 124.6658249
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 4.1448240 | spectral_norm = 9.7991991 | frobenius_norm = 139.8664856
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 9.8266821 | spectral_norm = 24.3469734 | frobenius_norm = 288.6119995
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 4.3711467 | spectral_norm = 15.1468992 | frobenius_norm = 133.0717010
W name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 300.8204651
W name = 'module._orig_mod.lm_head.weight' | median_sv = 28.5341530 | spectral_norm = 174.5704041 | frobenius_norm = 932.6052246
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 0.0000002
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 0.0000103 | spectral_norm = 0.0004591 | frobenius_norm = 0.0009312 | spectral_norm_est_t2 = 0.0004845 | spectral_norm_est_t4 = 0.0004597
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 0.0000104 | spectral_norm = 0.0005071 | frobenius_norm = 0.0010143 | spectral_norm_est_t2 = 0.0005519 | spectral_norm_est_t4 = 0.0005106
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 0.0000099 | spectral_norm = 0.0026702 | frobenius_norm = 0.0029477 | spectral_norm_est_t2 = 0.0026762 | spectral_norm_est_t4 = 0.0026700
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 0.0000226 | spectral_norm = 0.0071297 | frobenius_norm = 0.0074017 | spectral_norm_est_t2 = 0.0071304 | spectral_norm_est_t4 = 0.0071298
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 0.0000373 | spectral_norm = 0.0045693 | frobenius_norm = 0.0049225 | spectral_norm_est_t2 = 0.0045700 | spectral_norm_est_t4 = 0.0045695
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 0.0000651 | spectral_norm = 0.0020225 | frobenius_norm = 0.0036215 | spectral_norm_est_t2 = 0.0020530 | spectral_norm_est_t4 = 0.0020226
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 0.0000046 | spectral_norm = 0.0011950 | frobenius_norm = 0.0013146 | spectral_norm_est_t2 = 0.0011956 | spectral_norm_est_t4 = 0.0011949
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 0.0000051 | spectral_norm = 0.0007434 | frobenius_norm = 0.0009917 | spectral_norm_est_t2 = 0.0007513 | spectral_norm_est_t4 = 0.0007434
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 0.0000119 | spectral_norm = 0.0081026 | frobenius_norm = 0.0082739 | spectral_norm_est_t2 = 0.0081030 | spectral_norm_est_t4 = 0.0081025
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 0.0000214 | spectral_norm = 0.0038141 | frobenius_norm = 0.0045306 | spectral_norm_est_t2 = 0.0038241 | spectral_norm_est_t4 = 0.0038142
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 0.0000289 | spectral_norm = 0.0030140 | frobenius_norm = 0.0035181 | spectral_norm_est_t2 = 0.0030161 | spectral_norm_est_t4 = 0.0030140
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 0.0000563 | spectral_norm = 0.0026404 | frobenius_norm = 0.0039706 | spectral_norm_est_t2 = 0.0026978 | spectral_norm_est_t4 = 0.0026425
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 0.0000092 | spectral_norm = 0.0017214 | frobenius_norm = 0.0021473 | spectral_norm_est_t2 = 0.0017427 | spectral_norm_est_t4 = 0.0017219
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 0.0000096 | spectral_norm = 0.0011399 | frobenius_norm = 0.0018245 | spectral_norm_est_t2 = 0.0012328 | spectral_norm_est_t4 = 0.0011541
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 0.0000107 | spectral_norm = 0.0070996 | frobenius_norm = 0.0072636 | spectral_norm_est_t2 = 0.0071003 | spectral_norm_est_t4 = 0.0070999
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 0.0000232 | spectral_norm = 0.0030818 | frobenius_norm = 0.0038444 | spectral_norm_est_t2 = 0.0031078 | spectral_norm_est_t4 = 0.0030820
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 0.0000368 | spectral_norm = 0.0038487 | frobenius_norm = 0.0044801 | spectral_norm_est_t2 = 0.0038531 | spectral_norm_est_t4 = 0.0038488
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 0.0000704 | spectral_norm = 0.0027063 | frobenius_norm = 0.0047051 | spectral_norm_est_t2 = 0.0028021 | spectral_norm_est_t4 = 0.0027107
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 0.0000069 | spectral_norm = 0.0013391 | frobenius_norm = 0.0015597 | spectral_norm_est_t2 = 0.0013413 | spectral_norm_est_t4 = 0.0013390
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 0.0000075 | spectral_norm = 0.0007921 | frobenius_norm = 0.0012637 | spectral_norm_est_t2 = 0.0008334 | spectral_norm_est_t4 = 0.0007947
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 0.0000136 | spectral_norm = 0.0083789 | frobenius_norm = 0.0086021 | spectral_norm_est_t2 = 0.0083797 | spectral_norm_est_t4 = 0.0083792
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 0.0000210 | spectral_norm = 0.0027994 | frobenius_norm = 0.0036933 | spectral_norm_est_t2 = 0.0028151 | spectral_norm_est_t4 = 0.0027992
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 0.0000340 | spectral_norm = 0.0038813 | frobenius_norm = 0.0045537 | spectral_norm_est_t2 = 0.0038863 | spectral_norm_est_t4 = 0.0038816
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 0.0000650 | spectral_norm = 0.0030765 | frobenius_norm = 0.0047323 | spectral_norm_est_t2 = 0.0031224 | spectral_norm_est_t4 = 0.0030773
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 0.0000098 | spectral_norm = 0.0019222 | frobenius_norm = 0.0022765 | spectral_norm_est_t2 = 0.0019303 | spectral_norm_est_t4 = 0.0019223
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 0.0000108 | spectral_norm = 0.0010283 | frobenius_norm = 0.0019894 | spectral_norm_est_t2 = 0.0012488 | spectral_norm_est_t4 = 0.0011032
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 0.0000135 | spectral_norm = 0.0078687 | frobenius_norm = 0.0081404 | spectral_norm_est_t2 = 0.0078696 | spectral_norm_est_t4 = 0.0078688
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 0.0000219 | spectral_norm = 0.0033028 | frobenius_norm = 0.0040863 | spectral_norm_est_t2 = 0.0033160 | spectral_norm_est_t4 = 0.0033028
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 0.0000362 | spectral_norm = 0.0042680 | frobenius_norm = 0.0050024 | spectral_norm_est_t2 = 0.0042743 | spectral_norm_est_t4 = 0.0042681
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 0.0000679 | spectral_norm = 0.0035518 | frobenius_norm = 0.0053641 | spectral_norm_est_t2 = 0.0036200 | spectral_norm_est_t4 = 0.0035537
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 0.0000079 | spectral_norm = 0.0013189 | frobenius_norm = 0.0015647 | spectral_norm_est_t2 = 0.0013211 | spectral_norm_est_t4 = 0.0013189
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 0.0000084 | spectral_norm = 0.0009090 | frobenius_norm = 0.0014764 | spectral_norm_est_t2 = 0.0009700 | spectral_norm_est_t4 = 0.0009129
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 0.0000133 | spectral_norm = 0.0077038 | frobenius_norm = 0.0079750 | spectral_norm_est_t2 = 0.0077046 | spectral_norm_est_t4 = 0.0077037
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 0.0000185 | spectral_norm = 0.0035758 | frobenius_norm = 0.0042267 | spectral_norm_est_t2 = 0.0035819 | spectral_norm_est_t4 = 0.0035759
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 0.0000315 | spectral_norm = 0.0038867 | frobenius_norm = 0.0045233 | spectral_norm_est_t2 = 0.0038904 | spectral_norm_est_t4 = 0.0038870
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 0.0000611 | spectral_norm = 0.0031449 | frobenius_norm = 0.0046645 | spectral_norm_est_t2 = 0.0031829 | spectral_norm_est_t4 = 0.0031454
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 0.0000077 | spectral_norm = 0.0014034 | frobenius_norm = 0.0016000 | spectral_norm_est_t2 = 0.0014044 | spectral_norm_est_t4 = 0.0014034
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 0.0000082 | spectral_norm = 0.0007370 | frobenius_norm = 0.0013117 | spectral_norm_est_t2 = 0.0008170 | spectral_norm_est_t4 = 0.0007454
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 0.0000080 | spectral_norm = 0.0052910 | frobenius_norm = 0.0054360 | spectral_norm_est_t2 = 0.0052915 | spectral_norm_est_t4 = 0.0052912
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 0.0000176 | spectral_norm = 0.0029956 | frobenius_norm = 0.0034241 | spectral_norm_est_t2 = 0.0029980 | spectral_norm_est_t4 = 0.0029957
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 0.0000320 | spectral_norm = 0.0039031 | frobenius_norm = 0.0044789 | spectral_norm_est_t2 = 0.0039056 | spectral_norm_est_t4 = 0.0039031
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 0.0000618 | spectral_norm = 0.0031330 | frobenius_norm = 0.0045929 | spectral_norm_est_t2 = 0.0031598 | spectral_norm_est_t4 = 0.0031332
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 0.0000068 | spectral_norm = 0.0014369 | frobenius_norm = 0.0016228 | spectral_norm_est_t2 = 0.0014381 | spectral_norm_est_t4 = 0.0014369
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 0.0000071 | spectral_norm = 0.0007488 | frobenius_norm = 0.0012746 | spectral_norm_est_t2 = 0.0008156 | spectral_norm_est_t4 = 0.0007542
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 0.0000120 | spectral_norm = 0.0085135 | frobenius_norm = 0.0087482 | spectral_norm_est_t2 = 0.0085142 | spectral_norm_est_t4 = 0.0085136
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 0.0000189 | spectral_norm = 0.0048915 | frobenius_norm = 0.0053619 | spectral_norm_est_t2 = 0.0048938 | spectral_norm_est_t4 = 0.0048915
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 0.0000304 | spectral_norm = 0.0038128 | frobenius_norm = 0.0043778 | spectral_norm_est_t2 = 0.0038156 | spectral_norm_est_t4 = 0.0038129
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 0.0000622 | spectral_norm = 0.0027143 | frobenius_norm = 0.0042193 | spectral_norm_est_t2 = 0.0027605 | spectral_norm_est_t4 = 0.0027150
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 0.0000093 | spectral_norm = 0.0034639 | frobenius_norm = 0.0036331 | spectral_norm_est_t2 = 0.0034644 | spectral_norm_est_t4 = 0.0034639
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 0.0000098 | spectral_norm = 0.0022803 | frobenius_norm = 0.0029678 | spectral_norm_est_t2 = 0.0023554 | spectral_norm_est_t4 = 0.0022849
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 0.0000056 | spectral_norm = 0.0047659 | frobenius_norm = 0.0048652 | spectral_norm_est_t2 = 0.0047662 | spectral_norm_est_t4 = 0.0047660
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 0.0000249 | spectral_norm = 0.0061453 | frobenius_norm = 0.0063916 | spectral_norm_est_t2 = 0.0061454 | spectral_norm_est_t4 = 0.0061451
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 0.0000330 | spectral_norm = 0.0044201 | frobenius_norm = 0.0049197 | spectral_norm_est_t2 = 0.0044217 | spectral_norm_est_t4 = 0.0044201
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 0.0000670 | spectral_norm = 0.0029033 | frobenius_norm = 0.0043677 | spectral_norm_est_t2 = 0.0029250 | spectral_norm_est_t4 = 0.0029034
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 0.0000077 | spectral_norm = 0.0017987 | frobenius_norm = 0.0019535 | spectral_norm_est_t2 = 0.0017993 | spectral_norm_est_t4 = 0.0017986
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 0.0000081 | spectral_norm = 0.0010143 | frobenius_norm = 0.0014648 | spectral_norm_est_t2 = 0.0010512 | spectral_norm_est_t4 = 0.0010159
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 0.0000039 | spectral_norm = 0.0031822 | frobenius_norm = 0.0032403 | spectral_norm_est_t2 = 0.0031824 | spectral_norm_est_t4 = 0.0031823
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 0.0000286 | spectral_norm = 0.0077776 | frobenius_norm = 0.0079285 | spectral_norm_est_t2 = 0.0077777 | spectral_norm_est_t4 = 0.0077777
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 0.0000348 | spectral_norm = 0.0049953 | frobenius_norm = 0.0054192 | spectral_norm_est_t2 = 0.0049961 | spectral_norm_est_t4 = 0.0049952
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 0.0000675 | spectral_norm = 0.0030690 | frobenius_norm = 0.0044990 | spectral_norm_est_t2 = 0.0030883 | spectral_norm_est_t4 = 0.0030689
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 0.0000136 | spectral_norm = 0.0060613 | frobenius_norm = 0.0062476 | spectral_norm_est_t2 = 0.0060616 | spectral_norm_est_t4 = 0.0060613
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 0.0000157 | spectral_norm = 0.0041759 | frobenius_norm = 0.0048574 | spectral_norm_est_t2 = 0.0042120 | spectral_norm_est_t4 = 0.0041764
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 0.0000045 | spectral_norm = 0.0049481 | frobenius_norm = 0.0050292 | spectral_norm_est_t2 = 0.0049485 | spectral_norm_est_t4 = 0.0049482
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 0.0000360 | spectral_norm = 0.0270726 | frobenius_norm = 0.0271788 | spectral_norm_est_t2 = 0.0270739 | spectral_norm_est_t4 = 0.0270739
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 0.0000416 | spectral_norm = 0.0149812 | frobenius_norm = 0.0152194 | spectral_norm_est_t2 = 0.0149817 | spectral_norm_est_t4 = 0.0149815
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 0.0000768 | spectral_norm = 0.0090556 | frobenius_norm = 0.0100768 | spectral_norm_est_t2 = 0.0090616 | spectral_norm_est_t4 = 0.0090561
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 0.0000112 | spectral_norm = 0.0115797 | frobenius_norm = 0.0116558 | spectral_norm_est_t2 = 0.0115800 | spectral_norm_est_t4 = 0.0115799
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 0.0000117 | spectral_norm = 0.0050300 | frobenius_norm = 0.0054554 | spectral_norm_est_t2 = 0.0050443 | spectral_norm_est_t4 = 0.0050300
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 0.0000050 | spectral_norm = 0.0067852 | frobenius_norm = 0.0068349 | spectral_norm_est_t2 = 0.0067853 | spectral_norm_est_t4 = 0.0067852
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 0.0000306 | spectral_norm = 0.0249089 | frobenius_norm = 0.0250959 | spectral_norm_est_t2 = 0.0249096 | spectral_norm_est_t4 = 0.0249091
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 0.0000454 | spectral_norm = 0.0172922 | frobenius_norm = 0.0176242 | spectral_norm_est_t2 = 0.0172932 | spectral_norm_est_t4 = 0.0172923
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 0.0000880 | spectral_norm = 0.0113238 | frobenius_norm = 0.0131778 | spectral_norm_est_t2 = 0.0113534 | spectral_norm_est_t4 = 0.0113247
G name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 0.0000002
G name = 'module._orig_mod.lm_head.weight' | median_sv = 0.0002368 | spectral_norm = 0.1261179 | frobenius_norm = 0.1280202 | spectral_norm_est_t2 = 0.1261244 | spectral_norm_est_t4 = 0.1261176
saved grads to logs/1ef9fb63-cc79-4219-bbf9-a03b83709afa/grad_state_step000625.pt
===========================================
step:626/1480 train_time:181500ms step_avg:294.64ms
step:627/1480 train_time:181797ms step_avg:294.65ms
step:628/1480 train_time:182109ms step_avg:294.67ms
step:629/1480 train_time:182417ms step_avg:294.70ms
step:630/1480 train_time:182729ms step_avg:294.72ms
step:631/1480 train_time:183038ms step_avg:294.75ms
step:632/1480 train_time:183347ms step_avg:294.77ms
step:633/1480 train_time:183658ms step_avg:294.80ms
step:634/1480 train_time:183969ms step_avg:294.82ms
step:635/1480 train_time:184281ms step_avg:294.85ms
step:636/1480 train_time:184592ms step_avg:294.88ms
step:637/1480 train_time:184901ms step_avg:294.90ms
step:638/1480 train_time:185214ms step_avg:294.93ms
step:639/1480 train_time:185523ms step_avg:294.95ms
step:640/1480 train_time:185833ms step_avg:294.97ms
step:641/1480 train_time:186141ms step_avg:294.99ms
step:642/1480 train_time:186452ms step_avg:295.02ms
step:643/1480 train_time:186762ms step_avg:295.04ms
step:644/1480 train_time:187074ms step_avg:295.07ms
step:645/1480 train_time:187382ms step_avg:295.09ms
step:646/1480 train_time:187694ms step_avg:295.12ms
step:647/1480 train_time:188005ms step_avg:295.14ms
step:648/1480 train_time:188315ms step_avg:295.17ms
step:649/1480 train_time:188631ms step_avg:295.20ms
step:650/1480 train_time:188943ms step_avg:295.22ms
step:651/1480 train_time:189258ms step_avg:295.25ms
step:652/1480 train_time:189569ms step_avg:295.28ms
step:653/1480 train_time:189880ms step_avg:295.30ms
step:654/1480 train_time:190191ms step_avg:295.33ms
step:655/1480 train_time:190503ms step_avg:295.35ms
step:656/1480 train_time:190812ms step_avg:295.37ms
step:657/1480 train_time:191121ms step_avg:295.40ms
step:658/1480 train_time:191432ms step_avg:295.42ms
step:659/1480 train_time:191748ms step_avg:295.45ms
step:660/1480 train_time:192065ms step_avg:295.48ms
step:661/1480 train_time:192381ms step_avg:295.52ms
step:662/1480 train_time:192702ms step_avg:295.56ms
step:663/1480 train_time:193018ms step_avg:295.59ms
step:664/1480 train_time:193334ms step_avg:295.62ms
step:665/1480 train_time:193653ms step_avg:295.65ms
step:666/1480 train_time:193969ms step_avg:295.68ms
step:667/1480 train_time:194282ms step_avg:295.71ms
step:668/1480 train_time:194603ms step_avg:295.75ms
step:669/1480 train_time:194920ms step_avg:295.78ms
step:670/1480 train_time:195236ms step_avg:295.81ms
step:671/1480 train_time:195553ms step_avg:295.84ms
step:672/1480 train_time:195869ms step_avg:295.87ms
step:673/1480 train_time:196183ms step_avg:295.90ms
step:674/1480 train_time:196499ms step_avg:295.93ms
step:675/1480 train_time:196819ms step_avg:295.97ms
step:676/1480 train_time:197135ms step_avg:296.00ms
step:677/1480 train_time:197451ms step_avg:296.03ms
step:678/1480 train_time:197766ms step_avg:296.06ms
step:679/1480 train_time:198080ms step_avg:296.08ms
step:680/1480 train_time:198401ms step_avg:296.12ms
step:681/1480 train_time:198721ms step_avg:296.16ms
step:682/1480 train_time:199037ms step_avg:296.19ms
step:683/1480 train_time:199357ms step_avg:296.22ms
step:684/1480 train_time:199676ms step_avg:296.25ms
step:685/1480 train_time:199995ms step_avg:296.29ms
step:686/1480 train_time:200312ms step_avg:296.32ms
step:687/1480 train_time:200627ms step_avg:296.35ms
step:688/1480 train_time:200947ms step_avg:296.38ms
step:689/1480 train_time:201272ms step_avg:296.42ms
step:690/1480 train_time:201584ms step_avg:296.45ms
step:691/1480 train_time:201903ms step_avg:296.48ms
step:692/1480 train_time:202217ms step_avg:296.51ms
step:693/1480 train_time:202533ms step_avg:296.53ms
step:694/1480 train_time:202850ms step_avg:296.56ms
step:695/1480 train_time:203163ms step_avg:296.59ms
step:696/1480 train_time:203477ms step_avg:296.61ms
step:697/1480 train_time:203792ms step_avg:296.64ms
step:698/1480 train_time:204109ms step_avg:296.67ms
step:699/1480 train_time:204424ms step_avg:296.70ms
step:700/1480 train_time:204742ms step_avg:296.73ms
step:701/1480 train_time:205055ms step_avg:296.75ms
step:702/1480 train_time:205369ms step_avg:296.78ms
step:703/1480 train_time:205686ms step_avg:296.81ms
step:704/1480 train_time:206001ms step_avg:296.83ms
step:705/1480 train_time:206323ms step_avg:296.87ms
step:706/1480 train_time:206639ms step_avg:296.90ms
step:707/1480 train_time:206959ms step_avg:296.93ms
step:708/1480 train_time:207278ms step_avg:296.96ms
step:709/1480 train_time:207597ms step_avg:296.99ms
step:710/1480 train_time:207915ms step_avg:297.02ms
step:711/1480 train_time:208232ms step_avg:297.05ms
step:712/1480 train_time:208549ms step_avg:297.08ms
step:713/1480 train_time:208866ms step_avg:297.11ms
step:714/1480 train_time:209186ms step_avg:297.14ms
step:715/1480 train_time:209502ms step_avg:297.17ms
step:716/1480 train_time:209819ms step_avg:297.19ms
step:717/1480 train_time:210134ms step_avg:297.22ms
step:718/1480 train_time:210451ms step_avg:297.25ms
step:719/1480 train_time:210765ms step_avg:297.27ms
step:720/1480 train_time:211080ms step_avg:297.30ms
step:721/1480 train_time:211399ms step_avg:297.33ms
step:722/1480 train_time:211713ms step_avg:297.35ms
step:723/1480 train_time:212030ms step_avg:297.38ms
step:724/1480 train_time:212343ms step_avg:297.40ms
step:725/1480 train_time:212658ms step_avg:297.42ms
step:726/1480 train_time:212979ms step_avg:297.46ms
step:727/1480 train_time:213296ms step_avg:297.48ms
step:728/1480 train_time:213613ms step_avg:297.51ms
step:729/1480 train_time:213928ms step_avg:297.54ms
step:730/1480 train_time:214244ms step_avg:297.56ms
step:731/1480 train_time:214565ms step_avg:297.59ms
step:732/1480 train_time:214882ms step_avg:297.62ms
step:733/1480 train_time:215194ms step_avg:297.64ms
step:734/1480 train_time:215512ms step_avg:297.67ms
step:735/1480 train_time:215827ms step_avg:297.69ms
step:736/1480 train_time:216148ms step_avg:297.72ms
step:737/1480 train_time:216466ms step_avg:297.75ms
step:738/1480 train_time:216779ms step_avg:297.77ms
step:739/1480 train_time:217094ms step_avg:297.80ms
step:740/1480 train_time:217410ms step_avg:297.82ms
step:741/1480 train_time:217732ms step_avg:297.86ms
step:742/1480 train_time:218047ms step_avg:297.88ms
step:743/1480 train_time:218364ms step_avg:297.90ms
step:744/1480 train_time:218682ms step_avg:297.93ms
step:745/1480 train_time:219000ms step_avg:297.96ms
step:746/1480 train_time:219317ms step_avg:297.98ms
step:747/1480 train_time:219630ms step_avg:298.01ms
step:748/1480 train_time:219945ms step_avg:298.03ms
step:749/1480 train_time:220263ms step_avg:298.06ms
step:750/1480 train_time:220583ms step_avg:298.09ms
step:750/1480 val_loss:3.5460 train_time:220600ms step_avg:298.11ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 210.4311066
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 3.7919371 | spectral_norm = 19.1725388 | frobenius_norm = 136.0297546
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 3.3846967 | spectral_norm = 25.0752506 | frobenius_norm = 125.7460175
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 3.7188876 | spectral_norm = 14.3773680 | frobenius_norm = 130.1647644
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 3.7024820 | spectral_norm = 10.8421192 | frobenius_norm = 128.9573669
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 9.1307869 | spectral_norm = 19.1164436 | frobenius_norm = 271.1765442
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 4.6838064 | spectral_norm = 13.2500420 | frobenius_norm = 142.8327332
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 3.7052031 | spectral_norm = 13.9476137 | frobenius_norm = 134.8619385
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 3.6411328 | spectral_norm = 14.4570312 | frobenius_norm = 131.4144287
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 3.4299426 | spectral_norm = 12.4061098 | frobenius_norm = 131.1928711
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 3.9138966 | spectral_norm = 10.2779160 | frobenius_norm = 138.5984192
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 9.9735098 | spectral_norm = 22.8095608 | frobenius_norm = 295.7492676
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 4.9302101 | spectral_norm = 14.5120459 | frobenius_norm = 150.6446838
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 3.5802486 | spectral_norm = 11.8517084 | frobenius_norm = 134.9443054
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 3.5906978 | spectral_norm = 11.6349182 | frobenius_norm = 133.7568512
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 3.8578651 | spectral_norm = 14.2214985 | frobenius_norm = 148.5526581
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 4.4710317 | spectral_norm = 10.7795782 | frobenius_norm = 150.9858856
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 10.2363949 | spectral_norm = 23.6423378 | frobenius_norm = 302.2440491
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 4.9037495 | spectral_norm = 13.9942436 | frobenius_norm = 149.6882629
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 3.6920021 | spectral_norm = 14.5505619 | frobenius_norm = 135.0833130
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 3.6368592 | spectral_norm = 13.2201605 | frobenius_norm = 131.4261169
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 3.8483222 | spectral_norm = 13.6909838 | frobenius_norm = 147.0355835
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 4.1906095 | spectral_norm = 11.1815958 | frobenius_norm = 146.3775787
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 10.4951153 | spectral_norm = 24.1619873 | frobenius_norm = 310.4578552
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 5.0735226 | spectral_norm = 13.6594410 | frobenius_norm = 154.3202972
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 3.4703062 | spectral_norm = 12.7616501 | frobenius_norm = 132.0358124
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 3.4666796 | spectral_norm = 12.2087917 | frobenius_norm = 131.8660126
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 3.9469257 | spectral_norm = 14.0464659 | frobenius_norm = 152.5719910
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 4.4920192 | spectral_norm = 10.8354282 | frobenius_norm = 152.0740356
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 10.6483431 | spectral_norm = 23.4584370 | frobenius_norm = 312.9257812
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 5.0162721 | spectral_norm = 12.9604683 | frobenius_norm = 152.8843689
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 3.6109693 | spectral_norm = 13.6209908 | frobenius_norm = 133.3112640
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 3.6196287 | spectral_norm = 13.0692263 | frobenius_norm = 131.9303284
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 4.0216918 | spectral_norm = 13.8827524 | frobenius_norm = 151.6179810
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 4.3333092 | spectral_norm = 11.5621710 | frobenius_norm = 148.7633820
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 10.7426758 | spectral_norm = 22.0476704 | frobenius_norm = 315.2279968
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 5.1171055 | spectral_norm = 13.0841360 | frobenius_norm = 154.6190491
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 3.6806212 | spectral_norm = 12.5912237 | frobenius_norm = 134.9938507
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 3.6695173 | spectral_norm = 12.3038931 | frobenius_norm = 133.3170929
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 4.0039477 | spectral_norm = 14.4489460 | frobenius_norm = 155.6082153
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 4.4798989 | spectral_norm = 10.6913042 | frobenius_norm = 151.0200806
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 10.4779940 | spectral_norm = 23.2202244 | frobenius_norm = 308.6883850
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 5.0568452 | spectral_norm = 13.3647451 | frobenius_norm = 153.7887268
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 3.6811960 | spectral_norm = 13.5183249 | frobenius_norm = 134.7858124
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 3.6855691 | spectral_norm = 13.0059175 | frobenius_norm = 133.3108521
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 3.8490489 | spectral_norm = 13.1680269 | frobenius_norm = 148.9113007
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 4.2204113 | spectral_norm = 11.1833467 | frobenius_norm = 148.3394318
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 10.6227779 | spectral_norm = 24.3788242 | frobenius_norm = 314.5106201
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 5.1836772 | spectral_norm = 13.8200836 | frobenius_norm = 156.4714508
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 3.7009611 | spectral_norm = 12.7070990 | frobenius_norm = 138.5737305
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 3.6244052 | spectral_norm = 13.2390203 | frobenius_norm = 136.2304382
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 4.0991011 | spectral_norm = 17.3939838 | frobenius_norm = 159.2293396
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 4.5927072 | spectral_norm = 11.2847281 | frobenius_norm = 151.3802490
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 10.6302214 | spectral_norm = 25.1980171 | frobenius_norm = 313.8626709
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 5.2389369 | spectral_norm = 14.4176388 | frobenius_norm = 157.2592621
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 3.8965943 | spectral_norm = 12.8821325 | frobenius_norm = 142.9579773
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 3.7976480 | spectral_norm = 14.5231209 | frobenius_norm = 141.0532990
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 4.2529931 | spectral_norm = 15.2465429 | frobenius_norm = 157.7004852
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 4.5907865 | spectral_norm = 10.2860241 | frobenius_norm = 151.0327301
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 10.6623430 | spectral_norm = 25.3808060 | frobenius_norm = 315.0935669
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 5.3002787 | spectral_norm = 15.2470808 | frobenius_norm = 158.5256653
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 3.2058563 | spectral_norm = 16.0596218 | frobenius_norm = 131.9776001
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 3.0097060 | spectral_norm = 14.6482830 | frobenius_norm = 133.0716705
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 3.8639107 | spectral_norm = 14.2573872 | frobenius_norm = 146.8259888
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 4.8636699 | spectral_norm = 10.3356142 | frobenius_norm = 157.1016235
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 11.0203972 | spectral_norm = 22.2744541 | frobenius_norm = 320.2218323
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 4.8786249 | spectral_norm = 17.7394428 | frobenius_norm = 146.8066254
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 3.6274905 | spectral_norm = 15.8124733 | frobenius_norm = 138.9620667
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 3.4851832 | spectral_norm = 15.1209879 | frobenius_norm = 134.6967163
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 3.7053695 | spectral_norm = 15.6550694 | frobenius_norm = 139.9632874
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 4.6742115 | spectral_norm = 10.9870539 | frobenius_norm = 157.3328400
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 11.0548658 | spectral_norm = 27.8938580 | frobenius_norm = 325.9053345
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 4.9069142 | spectral_norm = 17.7395020 | frobenius_norm = 149.6114807
W name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 322.9483032
W name = 'module._orig_mod.lm_head.weight' | median_sv = 31.7422180 | spectral_norm = 178.9548950 | frobenius_norm = 1028.3237305
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 0.0000002
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 0.0000096 | spectral_norm = 0.0005569 | frobenius_norm = 0.0009503 | spectral_norm_est_t2 = 0.0005706 | spectral_norm_est_t4 = 0.0005570
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 0.0000097 | spectral_norm = 0.0005412 | frobenius_norm = 0.0010009 | spectral_norm_est_t2 = 0.0005749 | spectral_norm_est_t4 = 0.0005426
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 0.0000097 | spectral_norm = 0.0025920 | frobenius_norm = 0.0028656 | spectral_norm_est_t2 = 0.0025990 | spectral_norm_est_t4 = 0.0025920
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 0.0000209 | spectral_norm = 0.0078305 | frobenius_norm = 0.0080288 | spectral_norm_est_t2 = 0.0078310 | spectral_norm_est_t4 = 0.0078308
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 0.0000350 | spectral_norm = 0.0049606 | frobenius_norm = 0.0052442 | spectral_norm_est_t2 = 0.0049611 | spectral_norm_est_t4 = 0.0049608
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 0.0000619 | spectral_norm = 0.0019228 | frobenius_norm = 0.0034001 | spectral_norm_est_t2 = 0.0019428 | spectral_norm_est_t4 = 0.0019228
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 0.0000040 | spectral_norm = 0.0011830 | frobenius_norm = 0.0012823 | spectral_norm_est_t2 = 0.0011834 | spectral_norm_est_t4 = 0.0011830
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 0.0000045 | spectral_norm = 0.0007623 | frobenius_norm = 0.0009614 | spectral_norm_est_t2 = 0.0007663 | spectral_norm_est_t4 = 0.0007623
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 0.0000110 | spectral_norm = 0.0084563 | frobenius_norm = 0.0085927 | spectral_norm_est_t2 = 0.0084565 | spectral_norm_est_t4 = 0.0084562
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 0.0000198 | spectral_norm = 0.0039279 | frobenius_norm = 0.0045284 | spectral_norm_est_t2 = 0.0039345 | spectral_norm_est_t4 = 0.0039279
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 0.0000272 | spectral_norm = 0.0031185 | frobenius_norm = 0.0035432 | spectral_norm_est_t2 = 0.0031199 | spectral_norm_est_t4 = 0.0031186
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 0.0000534 | spectral_norm = 0.0031010 | frobenius_norm = 0.0041777 | spectral_norm_est_t2 = 0.0031321 | spectral_norm_est_t4 = 0.0031015
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 0.0000083 | spectral_norm = 0.0018632 | frobenius_norm = 0.0021116 | spectral_norm_est_t2 = 0.0018650 | spectral_norm_est_t4 = 0.0018632
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 0.0000087 | spectral_norm = 0.0010970 | frobenius_norm = 0.0016317 | spectral_norm_est_t2 = 0.0011399 | spectral_norm_est_t4 = 0.0010993
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 0.0000099 | spectral_norm = 0.0078209 | frobenius_norm = 0.0079390 | spectral_norm_est_t2 = 0.0078213 | spectral_norm_est_t4 = 0.0078211
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 0.0000213 | spectral_norm = 0.0031158 | frobenius_norm = 0.0036757 | spectral_norm_est_t2 = 0.0031231 | spectral_norm_est_t4 = 0.0031157
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 0.0000343 | spectral_norm = 0.0038809 | frobenius_norm = 0.0044025 | spectral_norm_est_t2 = 0.0038833 | spectral_norm_est_t4 = 0.0038811
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 0.0000663 | spectral_norm = 0.0027751 | frobenius_norm = 0.0044148 | spectral_norm_est_t2 = 0.0028081 | spectral_norm_est_t4 = 0.0027754
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 0.0000063 | spectral_norm = 0.0010841 | frobenius_norm = 0.0012912 | spectral_norm_est_t2 = 0.0010860 | spectral_norm_est_t4 = 0.0010840
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 0.0000068 | spectral_norm = 0.0005571 | frobenius_norm = 0.0010428 | spectral_norm_est_t2 = 0.0006185 | spectral_norm_est_t4 = 0.0005639
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 0.0000130 | spectral_norm = 0.0089877 | frobenius_norm = 0.0091837 | spectral_norm_est_t2 = 0.0089884 | spectral_norm_est_t4 = 0.0089880
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 0.0000196 | spectral_norm = 0.0027590 | frobenius_norm = 0.0034912 | spectral_norm_est_t2 = 0.0027675 | spectral_norm_est_t4 = 0.0027588
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 0.0000319 | spectral_norm = 0.0037551 | frobenius_norm = 0.0043083 | spectral_norm_est_t2 = 0.0037574 | spectral_norm_est_t4 = 0.0037553
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 0.0000608 | spectral_norm = 0.0031557 | frobenius_norm = 0.0045245 | spectral_norm_est_t2 = 0.0031737 | spectral_norm_est_t4 = 0.0031558
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 0.0000087 | spectral_norm = 0.0012726 | frobenius_norm = 0.0015985 | spectral_norm_est_t2 = 0.0012784 | spectral_norm_est_t4 = 0.0012726
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 0.0000095 | spectral_norm = 0.0008493 | frobenius_norm = 0.0015621 | spectral_norm_est_t2 = 0.0009532 | spectral_norm_est_t4 = 0.0008678
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 0.0000130 | spectral_norm = 0.0079490 | frobenius_norm = 0.0081757 | spectral_norm_est_t2 = 0.0079496 | spectral_norm_est_t4 = 0.0079490
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 0.0000203 | spectral_norm = 0.0032969 | frobenius_norm = 0.0038922 | spectral_norm_est_t2 = 0.0033018 | spectral_norm_est_t4 = 0.0032969
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 0.0000343 | spectral_norm = 0.0040032 | frobenius_norm = 0.0046310 | spectral_norm_est_t2 = 0.0040069 | spectral_norm_est_t4 = 0.0040036
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 0.0000639 | spectral_norm = 0.0035265 | frobenius_norm = 0.0050462 | spectral_norm_est_t2 = 0.0035533 | spectral_norm_est_t4 = 0.0035268
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 0.0000072 | spectral_norm = 0.0009705 | frobenius_norm = 0.0012040 | spectral_norm_est_t2 = 0.0009724 | spectral_norm_est_t4 = 0.0009705
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 0.0000076 | spectral_norm = 0.0005397 | frobenius_norm = 0.0010888 | spectral_norm_est_t2 = 0.0006179 | spectral_norm_est_t4 = 0.0005510
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 0.0000128 | spectral_norm = 0.0077055 | frobenius_norm = 0.0079650 | spectral_norm_est_t2 = 0.0077066 | spectral_norm_est_t4 = 0.0077057
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 0.0000172 | spectral_norm = 0.0035214 | frobenius_norm = 0.0040762 | spectral_norm_est_t2 = 0.0035257 | spectral_norm_est_t4 = 0.0035215
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 0.0000296 | spectral_norm = 0.0038330 | frobenius_norm = 0.0043820 | spectral_norm_est_t2 = 0.0038357 | spectral_norm_est_t4 = 0.0038333
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 0.0000569 | spectral_norm = 0.0030093 | frobenius_norm = 0.0043458 | spectral_norm_est_t2 = 0.0030286 | spectral_norm_est_t4 = 0.0030092
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 0.0000070 | spectral_norm = 0.0011880 | frobenius_norm = 0.0014005 | spectral_norm_est_t2 = 0.0011903 | spectral_norm_est_t4 = 0.0011880
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 0.0000075 | spectral_norm = 0.0006927 | frobenius_norm = 0.0012937 | spectral_norm_est_t2 = 0.0008132 | spectral_norm_est_t4 = 0.0007247
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 0.0000081 | spectral_norm = 0.0055129 | frobenius_norm = 0.0056589 | spectral_norm_est_t2 = 0.0055133 | spectral_norm_est_t4 = 0.0055129
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 0.0000169 | spectral_norm = 0.0028235 | frobenius_norm = 0.0032208 | spectral_norm_est_t2 = 0.0028258 | spectral_norm_est_t4 = 0.0028234
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 0.0000306 | spectral_norm = 0.0035160 | frobenius_norm = 0.0040408 | spectral_norm_est_t2 = 0.0035184 | spectral_norm_est_t4 = 0.0035161
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 0.0000582 | spectral_norm = 0.0027512 | frobenius_norm = 0.0041471 | spectral_norm_est_t2 = 0.0027774 | spectral_norm_est_t4 = 0.0027513
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 0.0000064 | spectral_norm = 0.0009232 | frobenius_norm = 0.0011466 | spectral_norm_est_t2 = 0.0009257 | spectral_norm_est_t4 = 0.0009232
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 0.0000065 | spectral_norm = 0.0004796 | frobenius_norm = 0.0009553 | spectral_norm_est_t2 = 0.0005564 | spectral_norm_est_t4 = 0.0004976
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 0.0000119 | spectral_norm = 0.0073297 | frobenius_norm = 0.0075531 | spectral_norm_est_t2 = 0.0073301 | spectral_norm_est_t4 = 0.0073295
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 0.0000180 | spectral_norm = 0.0043199 | frobenius_norm = 0.0047670 | spectral_norm_est_t2 = 0.0043219 | spectral_norm_est_t4 = 0.0043199
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 0.0000288 | spectral_norm = 0.0034517 | frobenius_norm = 0.0039783 | spectral_norm_est_t2 = 0.0034541 | spectral_norm_est_t4 = 0.0034518
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 0.0000586 | spectral_norm = 0.0023374 | frobenius_norm = 0.0037771 | spectral_norm_est_t2 = 0.0023774 | spectral_norm_est_t4 = 0.0023380
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 0.0000086 | spectral_norm = 0.0020967 | frobenius_norm = 0.0023016 | spectral_norm_est_t2 = 0.0020977 | spectral_norm_est_t4 = 0.0020967
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 0.0000091 | spectral_norm = 0.0016155 | frobenius_norm = 0.0022188 | spectral_norm_est_t2 = 0.0016805 | spectral_norm_est_t4 = 0.0016203
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 0.0000056 | spectral_norm = 0.0044287 | frobenius_norm = 0.0045257 | spectral_norm_est_t2 = 0.0044289 | spectral_norm_est_t4 = 0.0044287
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 0.0000243 | spectral_norm = 0.0056865 | frobenius_norm = 0.0059294 | spectral_norm_est_t2 = 0.0056866 | spectral_norm_est_t4 = 0.0056862
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 0.0000314 | spectral_norm = 0.0040323 | frobenius_norm = 0.0044999 | spectral_norm_est_t2 = 0.0040338 | spectral_norm_est_t4 = 0.0040324
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 0.0000629 | spectral_norm = 0.0025463 | frobenius_norm = 0.0039875 | spectral_norm_est_t2 = 0.0025733 | spectral_norm_est_t4 = 0.0025464
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 0.0000072 | spectral_norm = 0.0014446 | frobenius_norm = 0.0016033 | spectral_norm_est_t2 = 0.0014454 | spectral_norm_est_t4 = 0.0014445
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 0.0000076 | spectral_norm = 0.0009355 | frobenius_norm = 0.0013458 | spectral_norm_est_t2 = 0.0009767 | spectral_norm_est_t4 = 0.0009384
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 0.0000039 | spectral_norm = 0.0031673 | frobenius_norm = 0.0032207 | spectral_norm_est_t2 = 0.0031675 | spectral_norm_est_t4 = 0.0031674
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 0.0000278 | spectral_norm = 0.0071229 | frobenius_norm = 0.0072658 | spectral_norm_est_t2 = 0.0071231 | spectral_norm_est_t4 = 0.0071230
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 0.0000336 | spectral_norm = 0.0046609 | frobenius_norm = 0.0050536 | spectral_norm_est_t2 = 0.0046616 | spectral_norm_est_t4 = 0.0046608
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 0.0000641 | spectral_norm = 0.0027836 | frobenius_norm = 0.0042507 | spectral_norm_est_t2 = 0.0028130 | spectral_norm_est_t4 = 0.0027838
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 0.0000128 | spectral_norm = 0.0036008 | frobenius_norm = 0.0038370 | spectral_norm_est_t2 = 0.0036014 | spectral_norm_est_t4 = 0.0036007
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 0.0000147 | spectral_norm = 0.0027252 | frobenius_norm = 0.0034846 | spectral_norm_est_t2 = 0.0027917 | spectral_norm_est_t4 = 0.0027283
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 0.0000042 | spectral_norm = 0.0051571 | frobenius_norm = 0.0052337 | spectral_norm_est_t2 = 0.0051575 | spectral_norm_est_t4 = 0.0051572
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 0.0000349 | spectral_norm = 0.0270779 | frobenius_norm = 0.0271650 | spectral_norm_est_t2 = 0.0270807 | spectral_norm_est_t4 = 0.0270807
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 0.0000395 | spectral_norm = 0.0138755 | frobenius_norm = 0.0140821 | spectral_norm_est_t2 = 0.0138758 | spectral_norm_est_t4 = 0.0138757
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 0.0000727 | spectral_norm = 0.0108398 | frobenius_norm = 0.0117449 | spectral_norm_est_t2 = 0.0108471 | spectral_norm_est_t4 = 0.0108417
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 0.0000103 | spectral_norm = 0.0076918 | frobenius_norm = 0.0077620 | spectral_norm_est_t2 = 0.0076921 | spectral_norm_est_t4 = 0.0076921
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 0.0000107 | spectral_norm = 0.0035268 | frobenius_norm = 0.0038738 | spectral_norm_est_t2 = 0.0035367 | spectral_norm_est_t4 = 0.0035267
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 0.0000048 | spectral_norm = 0.0076598 | frobenius_norm = 0.0077031 | spectral_norm_est_t2 = 0.0076601 | spectral_norm_est_t4 = 0.0076600
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 0.0000295 | spectral_norm = 0.0275463 | frobenius_norm = 0.0276803 | spectral_norm_est_t2 = 0.0275467 | spectral_norm_est_t4 = 0.0275465
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 0.0000429 | spectral_norm = 0.0206781 | frobenius_norm = 0.0209111 | spectral_norm_est_t2 = 0.0206786 | spectral_norm_est_t4 = 0.0206783
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 0.0000832 | spectral_norm = 0.0132226 | frobenius_norm = 0.0148967 | spectral_norm_est_t2 = 0.0132496 | spectral_norm_est_t4 = 0.0132248
G name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 0.0000002
G name = 'module._orig_mod.lm_head.weight' | median_sv = 0.0002199 | spectral_norm = 0.1710217 | frobenius_norm = 0.1731193 | spectral_norm_est_t2 = 0.1710341 | spectral_norm_est_t4 = 0.1710236
saved grads to logs/1ef9fb63-cc79-4219-bbf9-a03b83709afa/grad_state_step000750.pt
===========================================
step:751/1480 train_time:220921ms step_avg:298.14ms
step:752/1480 train_time:221221ms step_avg:298.14ms
step:753/1480 train_time:221535ms step_avg:298.16ms
step:754/1480 train_time:221851ms step_avg:298.19ms
step:755/1480 train_time:222162ms step_avg:298.20ms
step:756/1480 train_time:222477ms step_avg:298.23ms
step:757/1480 train_time:222794ms step_avg:298.25ms
step:758/1480 train_time:223114ms step_avg:298.28ms
step:759/1480 train_time:223426ms step_avg:298.30ms
step:760/1480 train_time:223741ms step_avg:298.32ms
step:761/1480 train_time:224054ms step_avg:298.34ms
step:762/1480 train_time:224370ms step_avg:298.36ms
step:763/1480 train_time:224687ms step_avg:298.39ms
step:764/1480 train_time:225006ms step_avg:298.42ms
step:765/1480 train_time:225324ms step_avg:298.44ms
step:766/1480 train_time:225638ms step_avg:298.46ms
step:767/1480 train_time:225958ms step_avg:298.49ms
step:768/1480 train_time:226274ms step_avg:298.51ms
step:769/1480 train_time:226591ms step_avg:298.54ms
step:770/1480 train_time:226912ms step_avg:298.57ms
step:771/1480 train_time:227233ms step_avg:298.60ms
step:772/1480 train_time:227555ms step_avg:298.63ms
step:773/1480 train_time:227879ms step_avg:298.66ms
step:774/1480 train_time:228198ms step_avg:298.69ms
step:775/1480 train_time:228516ms step_avg:298.71ms
step:776/1480 train_time:228836ms step_avg:298.74ms
step:777/1480 train_time:229155ms step_avg:298.77ms
step:778/1480 train_time:229479ms step_avg:298.80ms
step:779/1480 train_time:229798ms step_avg:298.83ms
step:780/1480 train_time:230117ms step_avg:298.85ms
step:781/1480 train_time:230444ms step_avg:298.89ms
step:782/1480 train_time:230760ms step_avg:298.91ms
step:783/1480 train_time:231079ms step_avg:298.94ms
step:784/1480 train_time:231400ms step_avg:298.97ms
step:785/1480 train_time:231721ms step_avg:298.99ms
step:786/1480 train_time:232043ms step_avg:299.02ms
step:787/1480 train_time:232359ms step_avg:299.05ms
step:788/1480 train_time:232680ms step_avg:299.07ms
step:789/1480 train_time:233001ms step_avg:299.10ms
step:790/1480 train_time:233319ms step_avg:299.13ms
step:791/1480 train_time:233640ms step_avg:299.15ms
step:792/1480 train_time:233962ms step_avg:299.18ms
step:793/1480 train_time:234281ms step_avg:299.21ms
step:794/1480 train_time:234605ms step_avg:299.24ms
step:795/1480 train_time:234930ms step_avg:299.27ms
step:796/1480 train_time:235254ms step_avg:299.31ms
step:797/1480 train_time:235573ms step_avg:299.33ms
step:798/1480 train_time:235897ms step_avg:299.36ms
step:799/1480 train_time:236218ms step_avg:299.39ms
step:800/1480 train_time:236543ms step_avg:299.42ms
step:801/1480 train_time:236863ms step_avg:299.45ms
step:802/1480 train_time:237182ms step_avg:299.47ms
step:803/1480 train_time:237501ms step_avg:299.50ms
step:804/1480 train_time:237826ms step_avg:299.53ms
step:805/1480 train_time:238149ms step_avg:299.56ms
step:806/1480 train_time:238475ms step_avg:299.59ms
step:807/1480 train_time:238796ms step_avg:299.62ms
step:808/1480 train_time:239112ms step_avg:299.64ms
step:809/1480 train_time:239437ms step_avg:299.67ms
step:810/1480 train_time:239757ms step_avg:299.70ms
step:811/1480 train_time:240076ms step_avg:299.72ms
step:812/1480 train_time:240396ms step_avg:299.75ms
step:813/1480 train_time:240715ms step_avg:299.77ms
step:814/1480 train_time:241034ms step_avg:299.79ms
step:815/1480 train_time:241356ms step_avg:299.82ms
step:816/1480 train_time:241675ms step_avg:299.84ms
step:817/1480 train_time:241992ms step_avg:299.87ms
step:818/1480 train_time:242313ms step_avg:299.89ms
step:819/1480 train_time:242634ms step_avg:299.92ms
step:820/1480 train_time:242951ms step_avg:299.94ms
step:821/1480 train_time:243272ms step_avg:299.97ms
step:822/1480 train_time:243591ms step_avg:299.99ms
step:823/1480 train_time:243907ms step_avg:300.01ms
step:824/1480 train_time:244229ms step_avg:300.04ms
step:825/1480 train_time:244551ms step_avg:300.06ms
step:826/1480 train_time:244871ms step_avg:300.09ms
step:827/1480 train_time:245193ms step_avg:300.11ms
step:828/1480 train_time:245514ms step_avg:300.14ms
step:829/1480 train_time:245834ms step_avg:300.16ms
step:830/1480 train_time:246151ms step_avg:300.18ms
step:831/1480 train_time:246472ms step_avg:300.21ms
step:832/1480 train_time:246795ms step_avg:300.24ms
step:833/1480 train_time:247117ms step_avg:300.26ms
step:834/1480 train_time:247436ms step_avg:300.29ms
step:835/1480 train_time:247756ms step_avg:300.31ms
step:836/1480 train_time:248077ms step_avg:300.34ms
step:837/1480 train_time:248396ms step_avg:300.36ms
step:838/1480 train_time:248713ms step_avg:300.38ms
step:839/1480 train_time:249034ms step_avg:300.40ms
step:840/1480 train_time:249351ms step_avg:300.42ms
step:841/1480 train_time:249672ms step_avg:300.45ms
step:842/1480 train_time:249992ms step_avg:300.47ms
step:843/1480 train_time:250315ms step_avg:300.50ms
step:844/1480 train_time:250634ms step_avg:300.52ms
step:845/1480 train_time:250955ms step_avg:300.54ms
step:846/1480 train_time:251276ms step_avg:300.57ms
step:847/1480 train_time:251594ms step_avg:300.59ms
step:848/1480 train_time:251918ms step_avg:300.62ms
step:849/1480 train_time:252245ms step_avg:300.65ms
step:850/1480 train_time:252564ms step_avg:300.67ms
step:851/1480 train_time:252889ms step_avg:300.70ms
step:852/1480 train_time:253214ms step_avg:300.73ms
step:853/1480 train_time:253530ms step_avg:300.75ms
step:854/1480 train_time:253848ms step_avg:300.77ms
step:855/1480 train_time:254166ms step_avg:300.79ms
step:856/1480 train_time:254484ms step_avg:300.81ms
step:857/1480 train_time:254809ms step_avg:300.84ms
step:858/1480 train_time:255139ms step_avg:300.87ms
step:859/1480 train_time:255469ms step_avg:300.91ms
step:860/1480 train_time:255789ms step_avg:300.93ms
step:861/1480 train_time:256112ms step_avg:300.95ms
step:862/1480 train_time:256427ms step_avg:300.97ms
step:863/1480 train_time:256752ms step_avg:301.00ms
step:864/1480 train_time:257079ms step_avg:301.03ms
step:865/1480 train_time:257407ms step_avg:301.06ms
step:866/1480 train_time:257730ms step_avg:301.09ms
step:867/1480 train_time:258048ms step_avg:301.11ms
step:868/1480 train_time:258374ms step_avg:301.13ms
step:869/1480 train_time:258694ms step_avg:301.16ms
step:870/1480 train_time:259017ms step_avg:301.18ms
step:871/1480 train_time:259337ms step_avg:301.20ms
step:872/1480 train_time:259656ms step_avg:301.23ms
step:873/1480 train_time:259978ms step_avg:301.25ms
step:874/1480 train_time:260296ms step_avg:301.27ms
step:875/1480 train_time:260617ms step_avg:301.29ms
step:875/1480 val_loss:3.4997 train_time:260633ms step_avg:301.31ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 221.1604614
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 4.1482596 | spectral_norm = 21.7818909 | frobenius_norm = 149.6298828
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 3.7092862 | spectral_norm = 28.3898926 | frobenius_norm = 138.1273193
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 4.0652061 | spectral_norm = 16.4785843 | frobenius_norm = 141.9725952
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 4.0429020 | spectral_norm = 12.0404434 | frobenius_norm = 140.9138184
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 10.1307726 | spectral_norm = 21.1033630 | frobenius_norm = 299.9641113
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 5.1293302 | spectral_norm = 14.7852516 | frobenius_norm = 156.8954163
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 4.0482264 | spectral_norm = 15.5364752 | frobenius_norm = 148.4758148
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 3.9773927 | spectral_norm = 16.0027294 | frobenius_norm = 144.9864502
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 3.7693541 | spectral_norm = 13.8089256 | frobenius_norm = 144.2285614
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 4.3071575 | spectral_norm = 11.4058514 | frobenius_norm = 152.4253540
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 10.9707270 | spectral_norm = 25.5038891 | frobenius_norm = 325.5004883
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 5.3971043 | spectral_norm = 16.1306381 | frobenius_norm = 165.1717682
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 3.8954108 | spectral_norm = 13.2839947 | frobenius_norm = 148.1330566
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 3.9350426 | spectral_norm = 12.8883944 | frobenius_norm = 146.9474640
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 4.2405157 | spectral_norm = 15.6332178 | frobenius_norm = 164.2332458
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 4.9172354 | spectral_norm = 11.8605986 | frobenius_norm = 166.0753326
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 11.2671404 | spectral_norm = 26.8379269 | frobenius_norm = 332.6032410
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 5.3975797 | spectral_norm = 15.6668177 | frobenius_norm = 164.7256470
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 4.0170207 | spectral_norm = 16.3026791 | frobenius_norm = 148.5353851
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 3.9779699 | spectral_norm = 14.7891254 | frobenius_norm = 144.5059662
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 4.2363920 | spectral_norm = 14.9602747 | frobenius_norm = 162.0136719
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 4.6106806 | spectral_norm = 12.2685776 | frobenius_norm = 161.1854248
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 11.5633612 | spectral_norm = 27.3556309 | frobenius_norm = 342.1285706
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 5.5893216 | spectral_norm = 15.2959557 | frobenius_norm = 170.0759125
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 3.7792163 | spectral_norm = 14.0636845 | frobenius_norm = 144.8254700
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 3.7473371 | spectral_norm = 13.4654284 | frobenius_norm = 144.6213226
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 4.3841066 | spectral_norm = 15.6619768 | frobenius_norm = 168.5862885
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 4.9726787 | spectral_norm = 11.9991503 | frobenius_norm = 167.5862274
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 11.7281389 | spectral_norm = 26.3247433 | frobenius_norm = 344.6897888
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 5.5172601 | spectral_norm = 14.4358501 | frobenius_norm = 168.3242950
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 3.9213929 | spectral_norm = 15.1843805 | frobenius_norm = 146.4348602
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 3.9393921 | spectral_norm = 14.6605330 | frobenius_norm = 144.9156494
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 4.4681902 | spectral_norm = 15.2621441 | frobenius_norm = 167.5340576
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 4.7899323 | spectral_norm = 12.7818766 | frobenius_norm = 164.2159729
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 11.8288260 | spectral_norm = 24.3883476 | frobenius_norm = 347.0448608
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 5.6397691 | spectral_norm = 14.6128445 | frobenius_norm = 170.3460999
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 4.0244365 | spectral_norm = 13.8858728 | frobenius_norm = 148.1728973
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 4.0001674 | spectral_norm = 13.7537680 | frobenius_norm = 146.3648987
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 4.4507394 | spectral_norm = 15.8883820 | frobenius_norm = 171.9187775
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 4.9547753 | spectral_norm = 11.7490797 | frobenius_norm = 166.6660309
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 11.5361195 | spectral_norm = 25.4921112 | frobenius_norm = 339.2308960
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 5.5740609 | spectral_norm = 14.7730894 | frobenius_norm = 169.3538971
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 4.0062242 | spectral_norm = 15.1198139 | frobenius_norm = 148.0503082
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 4.0131021 | spectral_norm = 14.5843105 | frobenius_norm = 146.2117004
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 4.2563953 | spectral_norm = 14.5001030 | frobenius_norm = 164.6024170
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 4.6476364 | spectral_norm = 12.4610291 | frobenius_norm = 163.3973389
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 11.6839399 | spectral_norm = 26.7901382 | frobenius_norm = 345.6593323
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 5.7158322 | spectral_norm = 15.4509172 | frobenius_norm = 172.4295807
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 4.0459871 | spectral_norm = 14.3372402 | frobenius_norm = 152.6959381
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 3.9572871 | spectral_norm = 14.8004093 | frobenius_norm = 149.8731232
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 4.5210829 | spectral_norm = 19.3327045 | frobenius_norm = 176.8854675
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 5.0696001 | spectral_norm = 12.4055071 | frobenius_norm = 166.7531891
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 11.7015410 | spectral_norm = 28.1099739 | frobenius_norm = 344.9707336
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 5.7865453 | spectral_norm = 16.1443157 | frobenius_norm = 173.5532379
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 4.2487655 | spectral_norm = 14.4182205 | frobenius_norm = 157.4524689
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 4.1568341 | spectral_norm = 16.2464104 | frobenius_norm = 155.2596130
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 4.6927233 | spectral_norm = 17.1563568 | frobenius_norm = 174.8329620
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 5.0835228 | spectral_norm = 11.3069258 | frobenius_norm = 165.9769745
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 11.7227507 | spectral_norm = 28.7086430 | frobenius_norm = 346.5104370
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 5.8729997 | spectral_norm = 17.1079159 | frobenius_norm = 175.2780457
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 3.4187696 | spectral_norm = 18.1958809 | frobenius_norm = 144.4953766
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 3.2432926 | spectral_norm = 16.4418354 | frobenius_norm = 145.9476624
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 4.2711377 | spectral_norm = 15.7827101 | frobenius_norm = 162.0589752
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 5.4026175 | spectral_norm = 11.4015551 | frobenius_norm = 173.1150970
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 12.1332178 | spectral_norm = 24.7641201 | frobenius_norm = 352.8055115
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 5.3688645 | spectral_norm = 20.1719437 | frobenius_norm = 161.2113190
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 3.9195409 | spectral_norm = 17.7904510 | frobenius_norm = 152.5097351
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 3.7762408 | spectral_norm = 16.9419155 | frobenius_norm = 147.5196075
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 4.0315728 | spectral_norm = 17.4491405 | frobenius_norm = 153.5579224
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 5.1582952 | spectral_norm = 12.0488863 | frobenius_norm = 172.9198761
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 12.2235804 | spectral_norm = 30.9329948 | frobenius_norm = 360.2971802
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 5.3993683 | spectral_norm = 20.1277046 | frobenius_norm = 164.8874054
W name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 342.6426086
W name = 'module._orig_mod.lm_head.weight' | median_sv = 34.7379532 | spectral_norm = 182.7218781 | frobenius_norm = 1115.3975830
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 0.0000001
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 0.0000086 | spectral_norm = 0.0005331 | frobenius_norm = 0.0008945 | spectral_norm_est_t2 = 0.0005479 | spectral_norm_est_t4 = 0.0005332
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 0.0000087 | spectral_norm = 0.0005467 | frobenius_norm = 0.0009787 | spectral_norm_est_t2 = 0.0005809 | spectral_norm_est_t4 = 0.0005480
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 0.0000089 | spectral_norm = 0.0025241 | frobenius_norm = 0.0027451 | spectral_norm_est_t2 = 0.0025269 | spectral_norm_est_t4 = 0.0025239
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 0.0000193 | spectral_norm = 0.0073219 | frobenius_norm = 0.0075072 | spectral_norm_est_t2 = 0.0073223 | spectral_norm_est_t4 = 0.0073221
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 0.0000323 | spectral_norm = 0.0051179 | frobenius_norm = 0.0053538 | spectral_norm_est_t2 = 0.0051184 | spectral_norm_est_t4 = 0.0051182
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 0.0000580 | spectral_norm = 0.0018259 | frobenius_norm = 0.0032117 | spectral_norm_est_t2 = 0.0018446 | spectral_norm_est_t4 = 0.0018259
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 0.0000037 | spectral_norm = 0.0011219 | frobenius_norm = 0.0012141 | spectral_norm_est_t2 = 0.0011223 | spectral_norm_est_t4 = 0.0011218
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 0.0000041 | spectral_norm = 0.0006633 | frobenius_norm = 0.0008629 | spectral_norm_est_t2 = 0.0006703 | spectral_norm_est_t4 = 0.0006634
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 0.0000099 | spectral_norm = 0.0080169 | frobenius_norm = 0.0081423 | spectral_norm_est_t2 = 0.0080172 | spectral_norm_est_t4 = 0.0080170
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 0.0000182 | spectral_norm = 0.0033464 | frobenius_norm = 0.0039710 | spectral_norm_est_t2 = 0.0033573 | spectral_norm_est_t4 = 0.0033463
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 0.0000256 | spectral_norm = 0.0030402 | frobenius_norm = 0.0034305 | spectral_norm_est_t2 = 0.0030414 | spectral_norm_est_t4 = 0.0030402
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 0.0000505 | spectral_norm = 0.0025686 | frobenius_norm = 0.0036825 | spectral_norm_est_t2 = 0.0026069 | spectral_norm_est_t4 = 0.0025696
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 0.0000075 | spectral_norm = 0.0034190 | frobenius_norm = 0.0035401 | spectral_norm_est_t2 = 0.0034191 | spectral_norm_est_t4 = 0.0034189
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 0.0000078 | spectral_norm = 0.0013221 | frobenius_norm = 0.0017679 | spectral_norm_est_t2 = 0.0013483 | spectral_norm_est_t4 = 0.0013228
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 0.0000093 | spectral_norm = 0.0072015 | frobenius_norm = 0.0073169 | spectral_norm_est_t2 = 0.0072018 | spectral_norm_est_t4 = 0.0072017
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 0.0000195 | spectral_norm = 0.0025578 | frobenius_norm = 0.0031530 | spectral_norm_est_t2 = 0.0025684 | spectral_norm_est_t4 = 0.0025577
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 0.0000323 | spectral_norm = 0.0036791 | frobenius_norm = 0.0041659 | spectral_norm_est_t2 = 0.0036813 | spectral_norm_est_t4 = 0.0036792
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 0.0000621 | spectral_norm = 0.0023588 | frobenius_norm = 0.0040014 | spectral_norm_est_t2 = 0.0023949 | spectral_norm_est_t4 = 0.0023589
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 0.0000057 | spectral_norm = 0.0012184 | frobenius_norm = 0.0013734 | spectral_norm_est_t2 = 0.0012192 | spectral_norm_est_t4 = 0.0012184
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 0.0000062 | spectral_norm = 0.0006428 | frobenius_norm = 0.0010751 | spectral_norm_est_t2 = 0.0007001 | spectral_norm_est_t4 = 0.0006512
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 0.0000123 | spectral_norm = 0.0077607 | frobenius_norm = 0.0079534 | spectral_norm_est_t2 = 0.0077614 | spectral_norm_est_t4 = 0.0077610
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 0.0000184 | spectral_norm = 0.0023773 | frobenius_norm = 0.0031567 | spectral_norm_est_t2 = 0.0023927 | spectral_norm_est_t4 = 0.0023773
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 0.0000299 | spectral_norm = 0.0033224 | frobenius_norm = 0.0038580 | spectral_norm_est_t2 = 0.0033255 | spectral_norm_est_t4 = 0.0033231
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 0.0000573 | spectral_norm = 0.0025942 | frobenius_norm = 0.0039810 | spectral_norm_est_t2 = 0.0026148 | spectral_norm_est_t4 = 0.0025944
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 0.0000080 | spectral_norm = 0.0015152 | frobenius_norm = 0.0017996 | spectral_norm_est_t2 = 0.0015196 | spectral_norm_est_t4 = 0.0015152
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 0.0000089 | spectral_norm = 0.0008165 | frobenius_norm = 0.0015058 | spectral_norm_est_t2 = 0.0009218 | spectral_norm_est_t4 = 0.0008359
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 0.0000123 | spectral_norm = 0.0068193 | frobenius_norm = 0.0070542 | spectral_norm_est_t2 = 0.0068198 | spectral_norm_est_t4 = 0.0068190
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 0.0000191 | spectral_norm = 0.0030240 | frobenius_norm = 0.0036134 | spectral_norm_est_t2 = 0.0030295 | spectral_norm_est_t4 = 0.0030238
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 0.0000326 | spectral_norm = 0.0039054 | frobenius_norm = 0.0044937 | spectral_norm_est_t2 = 0.0039095 | spectral_norm_est_t4 = 0.0039064
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 0.0000610 | spectral_norm = 0.0033104 | frobenius_norm = 0.0047861 | spectral_norm_est_t2 = 0.0033336 | spectral_norm_est_t4 = 0.0033105
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 0.0000067 | spectral_norm = 0.0010091 | frobenius_norm = 0.0012317 | spectral_norm_est_t2 = 0.0010113 | spectral_norm_est_t4 = 0.0010091
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 0.0000070 | spectral_norm = 0.0006825 | frobenius_norm = 0.0011496 | spectral_norm_est_t2 = 0.0007312 | spectral_norm_est_t4 = 0.0006868
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 0.0000123 | spectral_norm = 0.0070051 | frobenius_norm = 0.0072630 | spectral_norm_est_t2 = 0.0070058 | spectral_norm_est_t4 = 0.0070049
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 0.0000165 | spectral_norm = 0.0033163 | frobenius_norm = 0.0038519 | spectral_norm_est_t2 = 0.0033207 | spectral_norm_est_t4 = 0.0033162
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 0.0000288 | spectral_norm = 0.0035003 | frobenius_norm = 0.0040415 | spectral_norm_est_t2 = 0.0035032 | spectral_norm_est_t4 = 0.0035006
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 0.0000544 | spectral_norm = 0.0028780 | frobenius_norm = 0.0041846 | spectral_norm_est_t2 = 0.0028966 | spectral_norm_est_t4 = 0.0028782
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 0.0000067 | spectral_norm = 0.0011063 | frobenius_norm = 0.0013211 | spectral_norm_est_t2 = 0.0011089 | spectral_norm_est_t4 = 0.0011063
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 0.0000072 | spectral_norm = 0.0007713 | frobenius_norm = 0.0013110 | spectral_norm_est_t2 = 0.0008519 | spectral_norm_est_t4 = 0.0007810
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 0.0000080 | spectral_norm = 0.0055196 | frobenius_norm = 0.0056659 | spectral_norm_est_t2 = 0.0055200 | spectral_norm_est_t4 = 0.0055196
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 0.0000162 | spectral_norm = 0.0027297 | frobenius_norm = 0.0031284 | spectral_norm_est_t2 = 0.0027324 | spectral_norm_est_t4 = 0.0027298
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 0.0000295 | spectral_norm = 0.0032752 | frobenius_norm = 0.0037943 | spectral_norm_est_t2 = 0.0032778 | spectral_norm_est_t4 = 0.0032754
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 0.0000559 | spectral_norm = 0.0026910 | frobenius_norm = 0.0039975 | spectral_norm_est_t2 = 0.0027116 | spectral_norm_est_t4 = 0.0026911
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 0.0000061 | spectral_norm = 0.0009825 | frobenius_norm = 0.0011946 | spectral_norm_est_t2 = 0.0009851 | spectral_norm_est_t4 = 0.0009825
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 0.0000061 | spectral_norm = 0.0004805 | frobenius_norm = 0.0009560 | spectral_norm_est_t2 = 0.0005559 | spectral_norm_est_t4 = 0.0004923
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 0.0000115 | spectral_norm = 0.0071848 | frobenius_norm = 0.0073964 | spectral_norm_est_t2 = 0.0071855 | spectral_norm_est_t4 = 0.0071849
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 0.0000171 | spectral_norm = 0.0037557 | frobenius_norm = 0.0042059 | spectral_norm_est_t2 = 0.0037579 | spectral_norm_est_t4 = 0.0037557
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 0.0000282 | spectral_norm = 0.0029211 | frobenius_norm = 0.0034586 | spectral_norm_est_t2 = 0.0029236 | spectral_norm_est_t4 = 0.0029212
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 0.0000575 | spectral_norm = 0.0019530 | frobenius_norm = 0.0034500 | spectral_norm_est_t2 = 0.0019971 | spectral_norm_est_t4 = 0.0019535
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 0.0000081 | spectral_norm = 0.0018458 | frobenius_norm = 0.0020744 | spectral_norm_est_t2 = 0.0018476 | spectral_norm_est_t4 = 0.0018457
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 0.0000084 | spectral_norm = 0.0013626 | frobenius_norm = 0.0021974 | spectral_norm_est_t2 = 0.0015720 | spectral_norm_est_t4 = 0.0014339
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 0.0000056 | spectral_norm = 0.0042060 | frobenius_norm = 0.0043132 | spectral_norm_est_t2 = 0.0042063 | spectral_norm_est_t4 = 0.0042060
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 0.0000228 | spectral_norm = 0.0048774 | frobenius_norm = 0.0051198 | spectral_norm_est_t2 = 0.0048776 | spectral_norm_est_t4 = 0.0048773
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 0.0000305 | spectral_norm = 0.0034515 | frobenius_norm = 0.0039214 | spectral_norm_est_t2 = 0.0034529 | spectral_norm_est_t4 = 0.0034515
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 0.0000607 | spectral_norm = 0.0020658 | frobenius_norm = 0.0036408 | spectral_norm_est_t2 = 0.0021307 | spectral_norm_est_t4 = 0.0020679
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 0.0000066 | spectral_norm = 0.0014981 | frobenius_norm = 0.0016381 | spectral_norm_est_t2 = 0.0014988 | spectral_norm_est_t4 = 0.0014981
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 0.0000069 | spectral_norm = 0.0010165 | frobenius_norm = 0.0014999 | spectral_norm_est_t2 = 0.0011170 | spectral_norm_est_t4 = 0.0010392
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 0.0000038 | spectral_norm = 0.0031062 | frobenius_norm = 0.0031630 | spectral_norm_est_t2 = 0.0031064 | spectral_norm_est_t4 = 0.0031063
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 0.0000257 | spectral_norm = 0.0057645 | frobenius_norm = 0.0059242 | spectral_norm_est_t2 = 0.0057646 | spectral_norm_est_t4 = 0.0057646
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 0.0000321 | spectral_norm = 0.0037467 | frobenius_norm = 0.0041499 | spectral_norm_est_t2 = 0.0037474 | spectral_norm_est_t4 = 0.0037465
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 0.0000611 | spectral_norm = 0.0020970 | frobenius_norm = 0.0036882 | spectral_norm_est_t2 = 0.0021498 | spectral_norm_est_t4 = 0.0020976
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 0.0000114 | spectral_norm = 0.0050667 | frobenius_norm = 0.0052412 | spectral_norm_est_t2 = 0.0050672 | spectral_norm_est_t4 = 0.0050668
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 0.0000130 | spectral_norm = 0.0026130 | frobenius_norm = 0.0034875 | spectral_norm_est_t2 = 0.0027086 | spectral_norm_est_t4 = 0.0026183
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 0.0000040 | spectral_norm = 0.0041315 | frobenius_norm = 0.0042227 | spectral_norm_est_t2 = 0.0041321 | spectral_norm_est_t4 = 0.0041315
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 0.0000309 | spectral_norm = 0.0204076 | frobenius_norm = 0.0205110 | spectral_norm_est_t2 = 0.0204086 | spectral_norm_est_t4 = 0.0204086
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 0.0000362 | spectral_norm = 0.0081333 | frobenius_norm = 0.0084019 | spectral_norm_est_t2 = 0.0081337 | spectral_norm_est_t4 = 0.0081333
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 0.0000679 | spectral_norm = 0.0090555 | frobenius_norm = 0.0100392 | spectral_norm_est_t2 = 0.0090684 | spectral_norm_est_t4 = 0.0090562
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 0.0000090 | spectral_norm = 0.0058790 | frobenius_norm = 0.0059647 | spectral_norm_est_t2 = 0.0058791 | spectral_norm_est_t4 = 0.0058789
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 0.0000094 | spectral_norm = 0.0033422 | frobenius_norm = 0.0035541 | spectral_norm_est_t2 = 0.0033442 | spectral_norm_est_t4 = 0.0033421
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 0.0000044 | spectral_norm = 0.0063964 | frobenius_norm = 0.0064431 | spectral_norm_est_t2 = 0.0063965 | spectral_norm_est_t4 = 0.0063965
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 0.0000268 | spectral_norm = 0.0200425 | frobenius_norm = 0.0202384 | spectral_norm_est_t2 = 0.0200434 | spectral_norm_est_t4 = 0.0200426
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 0.0000390 | spectral_norm = 0.0153861 | frobenius_norm = 0.0156699 | spectral_norm_est_t2 = 0.0153868 | spectral_norm_est_t4 = 0.0153860
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 0.0000771 | spectral_norm = 0.0099802 | frobenius_norm = 0.0121434 | spectral_norm_est_t2 = 0.0100695 | spectral_norm_est_t4 = 0.0099815
G name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 0.0000002
G name = 'module._orig_mod.lm_head.weight' | median_sv = 0.0002010 | spectral_norm = 0.1639866 | frobenius_norm = 0.1659836 | spectral_norm_est_t2 = 0.1639970 | spectral_norm_est_t4 = 0.1639871
saved grads to logs/1ef9fb63-cc79-4219-bbf9-a03b83709afa/grad_state_step000875.pt
===========================================
step:876/1480 train_time:260970ms step_avg:301.35ms
step:877/1480 train_time:261278ms step_avg:301.36ms
step:878/1480 train_time:261597ms step_avg:301.38ms
step:879/1480 train_time:261923ms step_avg:301.41ms
step:880/1480 train_time:262247ms step_avg:301.43ms
step:881/1480 train_time:262569ms step_avg:301.46ms
step:882/1480 train_time:262889ms step_avg:301.48ms
step:883/1480 train_time:263214ms step_avg:301.51ms
step:884/1480 train_time:263538ms step_avg:301.53ms
step:885/1480 train_time:263861ms step_avg:301.56ms
step:886/1480 train_time:264190ms step_avg:301.59ms
step:887/1480 train_time:264519ms step_avg:301.62ms
step:888/1480 train_time:264839ms step_avg:301.64ms
step:889/1480 train_time:265164ms step_avg:301.67ms
step:890/1480 train_time:265502ms step_avg:301.71ms
step:891/1480 train_time:265821ms step_avg:301.73ms
step:892/1480 train_time:266145ms step_avg:301.75ms
step:893/1480 train_time:266476ms step_avg:301.78ms
step:894/1480 train_time:266800ms step_avg:301.81ms
step:895/1480 train_time:267120ms step_avg:301.83ms
step:896/1480 train_time:267454ms step_avg:301.87ms
step:897/1480 train_time:267782ms step_avg:301.90ms
step:898/1480 train_time:268110ms step_avg:301.93ms
step:899/1480 train_time:268437ms step_avg:301.95ms
step:900/1480 train_time:268760ms step_avg:301.98ms
step:901/1480 train_time:269079ms step_avg:302.00ms
step:902/1480 train_time:269406ms step_avg:302.02ms
step:903/1480 train_time:269727ms step_avg:302.05ms
step:904/1480 train_time:270055ms step_avg:302.07ms
step:905/1480 train_time:270382ms step_avg:302.10ms
step:906/1480 train_time:270707ms step_avg:302.13ms
step:907/1480 train_time:271027ms step_avg:302.15ms
step:908/1480 train_time:271364ms step_avg:302.19ms
step:909/1480 train_time:271686ms step_avg:302.21ms
step:910/1480 train_time:272009ms step_avg:302.23ms
step:911/1480 train_time:272346ms step_avg:302.27ms
step:912/1480 train_time:272667ms step_avg:302.29ms
step:913/1480 train_time:272990ms step_avg:302.31ms
step:914/1480 train_time:273320ms step_avg:302.35ms
step:915/1480 train_time:273644ms step_avg:302.37ms
step:916/1480 train_time:273979ms step_avg:302.40ms
step:917/1480 train_time:274301ms step_avg:302.43ms
step:918/1480 train_time:274632ms step_avg:302.46ms
step:919/1480 train_time:274964ms step_avg:302.49ms
step:920/1480 train_time:275296ms step_avg:302.52ms
step:921/1480 train_time:275627ms step_avg:302.55ms
step:922/1480 train_time:275956ms step_avg:302.58ms
step:923/1480 train_time:276277ms step_avg:302.60ms
step:924/1480 train_time:276600ms step_avg:302.63ms
step:925/1480 train_time:276923ms step_avg:302.65ms
step:926/1480 train_time:277253ms step_avg:302.68ms
step:927/1480 train_time:277579ms step_avg:302.70ms
step:928/1480 train_time:277905ms step_avg:302.73ms
step:929/1480 train_time:278225ms step_avg:302.75ms
step:930/1480 train_time:278550ms step_avg:302.77ms
step:931/1480 train_time:278874ms step_avg:302.79ms
step:932/1480 train_time:279199ms step_avg:302.82ms
step:933/1480 train_time:279524ms step_avg:302.84ms
step:934/1480 train_time:279852ms step_avg:302.87ms
step:935/1480 train_time:280174ms step_avg:302.89ms
step:936/1480 train_time:280501ms step_avg:302.92ms
step:937/1480 train_time:280839ms step_avg:302.95ms
step:938/1480 train_time:281164ms step_avg:302.98ms
step:939/1480 train_time:281489ms step_avg:303.00ms
step:940/1480 train_time:281811ms step_avg:303.02ms
step:941/1480 train_time:282143ms step_avg:303.05ms
step:942/1480 train_time:282471ms step_avg:303.08ms
step:943/1480 train_time:282805ms step_avg:303.11ms
step:944/1480 train_time:283130ms step_avg:303.14ms
step:945/1480 train_time:283457ms step_avg:303.16ms
step:946/1480 train_time:283790ms step_avg:303.19ms
step:947/1480 train_time:284110ms step_avg:303.21ms
step:948/1480 train_time:284439ms step_avg:303.24ms
step:949/1480 train_time:284763ms step_avg:303.26ms
step:950/1480 train_time:285096ms step_avg:303.29ms
step:951/1480 train_time:285421ms step_avg:303.32ms
step:952/1480 train_time:285746ms step_avg:303.34ms
step:953/1480 train_time:286064ms step_avg:303.36ms
step:954/1480 train_time:286392ms step_avg:303.38ms
step:955/1480 train_time:286727ms step_avg:303.42ms
step:956/1480 train_time:287058ms step_avg:303.44ms
step:957/1480 train_time:287378ms step_avg:303.46ms
step:958/1480 train_time:287706ms step_avg:303.49ms
step:959/1480 train_time:288039ms step_avg:303.52ms
step:960/1480 train_time:288370ms step_avg:303.55ms
step:961/1480 train_time:288697ms step_avg:303.57ms
step:962/1480 train_time:289030ms step_avg:303.60ms
step:963/1480 train_time:289358ms step_avg:303.63ms
step:964/1480 train_time:289681ms step_avg:303.65ms
step:965/1480 train_time:290008ms step_avg:303.67ms
step:966/1480 train_time:290337ms step_avg:303.70ms
step:967/1480 train_time:290657ms step_avg:303.72ms
step:968/1480 train_time:290983ms step_avg:303.74ms
step:969/1480 train_time:291306ms step_avg:303.76ms
step:970/1480 train_time:291627ms step_avg:303.78ms
step:971/1480 train_time:291958ms step_avg:303.81ms
step:972/1480 train_time:292284ms step_avg:303.83ms
step:973/1480 train_time:292613ms step_avg:303.86ms
step:974/1480 train_time:292933ms step_avg:303.87ms
step:975/1480 train_time:293256ms step_avg:303.89ms
step:976/1480 train_time:293581ms step_avg:303.91ms
step:977/1480 train_time:293906ms step_avg:303.94ms
step:978/1480 train_time:294228ms step_avg:303.95ms
step:979/1480 train_time:294550ms step_avg:303.97ms
step:980/1480 train_time:294876ms step_avg:304.00ms
step:981/1480 train_time:295199ms step_avg:304.02ms
step:982/1480 train_time:295519ms step_avg:304.03ms
step:983/1480 train_time:295838ms step_avg:304.05ms
step:984/1480 train_time:296163ms step_avg:304.07ms
step:985/1480 train_time:296497ms step_avg:304.10ms
step:986/1480 train_time:296824ms step_avg:304.12ms
step:987/1480 train_time:297147ms step_avg:304.14ms
step:988/1480 train_time:297478ms step_avg:304.17ms
step:989/1480 train_time:297804ms step_avg:304.19ms
step:990/1480 train_time:298130ms step_avg:304.21ms
step:991/1480 train_time:298465ms step_avg:304.25ms
step:992/1480 train_time:298804ms step_avg:304.28ms
step:993/1480 train_time:299127ms step_avg:304.30ms
step:994/1480 train_time:299452ms step_avg:304.32ms
step:995/1480 train_time:299800ms step_avg:304.37ms
step:996/1480 train_time:300123ms step_avg:304.38ms
step:997/1480 train_time:300443ms step_avg:304.40ms
step:998/1480 train_time:300769ms step_avg:304.42ms
step:999/1480 train_time:301095ms step_avg:304.44ms
step:1000/1480 train_time:301425ms step_avg:304.47ms
step:1000/1480 val_loss:3.4366 train_time:301441ms step_avg:304.49ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 229.0517426
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 4.4385491 | spectral_norm = 24.0830555 | frobenius_norm = 160.0901184
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 3.9583159 | spectral_norm = 31.1783562 | frobenius_norm = 147.9606934
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 4.3156238 | spectral_norm = 18.3383179 | frobenius_norm = 150.8787842
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 4.3047781 | spectral_norm = 13.0994720 | frobenius_norm = 150.0690155
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 10.8908463 | spectral_norm = 22.6803646 | frobenius_norm = 321.8706055
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 5.5035825 | spectral_norm = 16.0276089 | frobenius_norm = 167.9741058
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 4.3119207 | spectral_norm = 17.0001659 | frobenius_norm = 159.1026764
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 4.2639752 | spectral_norm = 17.2262993 | frobenius_norm = 155.6424255
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 4.0442133 | spectral_norm = 14.9773846 | frobenius_norm = 154.8356781
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 4.6204858 | spectral_norm = 12.2957354 | frobenius_norm = 163.6645050
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 11.7387877 | spectral_norm = 27.5944881 | frobenius_norm = 348.8308716
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 5.7763929 | spectral_norm = 17.3662872 | frobenius_norm = 176.6464539
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 4.1569948 | spectral_norm = 14.4154549 | frobenius_norm = 158.5174255
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 4.1843028 | spectral_norm = 14.0116844 | frobenius_norm = 157.2931976
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 4.6019802 | spectral_norm = 16.7467022 | frobenius_norm = 176.9279480
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 5.2961593 | spectral_norm = 12.9232550 | frobenius_norm = 178.2678986
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 12.0624056 | spectral_norm = 29.3628654 | frobenius_norm = 356.1983948
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 5.7895942 | spectral_norm = 16.9550362 | frobenius_norm = 176.6063995
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 4.2639961 | spectral_norm = 17.6476860 | frobenius_norm = 159.1012421
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 4.2496367 | spectral_norm = 16.0385990 | frobenius_norm = 154.8099213
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 4.5775209 | spectral_norm = 16.0929203 | frobenius_norm = 174.1464844
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 4.9730840 | spectral_norm = 13.1621847 | frobenius_norm = 173.1356964
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 12.3739290 | spectral_norm = 30.0824947 | frobenius_norm = 366.5187378
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 5.9946857 | spectral_norm = 16.6411247 | frobenius_norm = 182.5042725
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 3.9977717 | spectral_norm = 15.2581072 | frobenius_norm = 154.7595825
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 3.9675212 | spectral_norm = 14.5057878 | frobenius_norm = 154.5952759
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 4.7430143 | spectral_norm = 16.8735123 | frobenius_norm = 181.5314636
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 5.3527975 | spectral_norm = 12.7231836 | frobenius_norm = 180.0023193
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 12.5463305 | spectral_norm = 28.6876011 | frobenius_norm = 368.8236389
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 5.9248018 | spectral_norm = 15.6333113 | frobenius_norm = 180.3879547
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 4.1829620 | spectral_norm = 16.5247192 | frobenius_norm = 156.6374969
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 4.2053599 | spectral_norm = 15.9423895 | frobenius_norm = 154.9649353
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 4.8348112 | spectral_norm = 16.4263649 | frobenius_norm = 180.4387054
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 5.1438670 | spectral_norm = 13.7104445 | frobenius_norm = 176.6560516
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 12.6562605 | spectral_norm = 26.6237030 | frobenius_norm = 371.0749207
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 6.0436626 | spectral_norm = 15.8946495 | frobenius_norm = 182.6354370
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 4.2550874 | spectral_norm = 15.0006895 | frobenius_norm = 158.5642395
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 4.2569280 | spectral_norm = 14.8720703 | frobenius_norm = 156.4529572
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 4.7895789 | spectral_norm = 17.0100269 | frobenius_norm = 184.7899475
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 5.3286696 | spectral_norm = 12.5839262 | frobenius_norm = 178.9331512
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 12.3203869 | spectral_norm = 27.3229465 | frobenius_norm = 363.1719055
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 5.9705653 | spectral_norm = 16.0176125 | frobenius_norm = 181.7046204
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 4.2380357 | spectral_norm = 16.3280621 | frobenius_norm = 158.0798340
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 4.2408123 | spectral_norm = 15.7267075 | frobenius_norm = 156.1010742
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 4.5728822 | spectral_norm = 15.6202450 | frobenius_norm = 177.3055420
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 4.9920850 | spectral_norm = 13.4560976 | frobenius_norm = 175.4992828
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 12.5163593 | spectral_norm = 28.8249950 | frobenius_norm = 369.7249756
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 6.1386681 | spectral_norm = 16.8322334 | frobenius_norm = 184.9323120
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 4.2812848 | spectral_norm = 15.6426535 | frobenius_norm = 163.4797516
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 4.1974421 | spectral_norm = 16.0087872 | frobenius_norm = 160.4222870
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 4.8865352 | spectral_norm = 20.9891262 | frobenius_norm = 191.4123077
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 5.4652944 | spectral_norm = 13.2705059 | frobenius_norm = 179.1281738
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 12.5247440 | spectral_norm = 30.3524609 | frobenius_norm = 369.2362366
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 6.2165918 | spectral_norm = 17.6222839 | frobenius_norm = 186.3928833
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 4.5489440 | spectral_norm = 15.6450596 | frobenius_norm = 168.7034302
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 4.4431534 | spectral_norm = 17.8109875 | frobenius_norm = 166.4078827
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 5.0616884 | spectral_norm = 18.5871029 | frobenius_norm = 188.5692902
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 5.4215140 | spectral_norm = 12.1510315 | frobenius_norm = 177.6979370
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 12.5554228 | spectral_norm = 31.3302212 | frobenius_norm = 371.1007996
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 6.3100662 | spectral_norm = 18.6827106 | frobenius_norm = 188.4935150
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 3.5753934 | spectral_norm = 19.9798164 | frobenius_norm = 153.9318848
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 3.3649595 | spectral_norm = 17.9458218 | frobenius_norm = 155.9023590
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 4.6013317 | spectral_norm = 16.9381332 | frobenius_norm = 174.2542267
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 5.8573265 | spectral_norm = 12.0930557 | frobenius_norm = 186.0220642
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 12.9425001 | spectral_norm = 26.7564964 | frobenius_norm = 376.5292053
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 5.7367702 | spectral_norm = 22.2218971 | frobenius_norm = 172.3256989
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 4.1176949 | spectral_norm = 19.5371113 | frobenius_norm = 163.1881104
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 3.9901269 | spectral_norm = 18.5412807 | frobenius_norm = 157.7062073
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 4.3116460 | spectral_norm = 19.0014477 | frobenius_norm = 164.8720093
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 5.5506334 | spectral_norm = 12.8729687 | frobenius_norm = 185.7575073
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 13.0939217 | spectral_norm = 33.5712662 | frobenius_norm = 386.3529663
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 5.7921400 | spectral_norm = 22.1048889 | frobenius_norm = 176.8159027
W name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 357.3868103
W name = 'module._orig_mod.lm_head.weight' | median_sv = 36.9414978 | spectral_norm = 185.2919922 | frobenius_norm = 1180.7586670
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 0.0000001
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 0.0000082 | spectral_norm = 0.0005442 | frobenius_norm = 0.0008610 | spectral_norm_est_t2 = 0.0005548 | spectral_norm_est_t4 = 0.0005443
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 0.0000083 | spectral_norm = 0.0004768 | frobenius_norm = 0.0009242 | spectral_norm_est_t2 = 0.0005287 | spectral_norm_est_t4 = 0.0004824
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 0.0000087 | spectral_norm = 0.0025263 | frobenius_norm = 0.0027447 | spectral_norm_est_t2 = 0.0025298 | spectral_norm_est_t4 = 0.0025262
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 0.0000181 | spectral_norm = 0.0070791 | frobenius_norm = 0.0072416 | spectral_norm_est_t2 = 0.0070795 | spectral_norm_est_t4 = 0.0070793
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 0.0000305 | spectral_norm = 0.0051825 | frobenius_norm = 0.0053835 | spectral_norm_est_t2 = 0.0051827 | spectral_norm_est_t4 = 0.0051826
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 0.0000542 | spectral_norm = 0.0016580 | frobenius_norm = 0.0029329 | spectral_norm_est_t2 = 0.0016742 | spectral_norm_est_t4 = 0.0016580
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 0.0000034 | spectral_norm = 0.0013114 | frobenius_norm = 0.0013767 | spectral_norm_est_t2 = 0.0013116 | spectral_norm_est_t4 = 0.0013113
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 0.0000038 | spectral_norm = 0.0007444 | frobenius_norm = 0.0009009 | spectral_norm_est_t2 = 0.0007483 | spectral_norm_est_t4 = 0.0007444
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 0.0000094 | spectral_norm = 0.0078298 | frobenius_norm = 0.0079289 | spectral_norm_est_t2 = 0.0078299 | spectral_norm_est_t4 = 0.0078298
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 0.0000169 | spectral_norm = 0.0029244 | frobenius_norm = 0.0035047 | spectral_norm_est_t2 = 0.0029353 | spectral_norm_est_t4 = 0.0029245
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 0.0000240 | spectral_norm = 0.0028071 | frobenius_norm = 0.0031656 | spectral_norm_est_t2 = 0.0028083 | spectral_norm_est_t4 = 0.0028071
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 0.0000475 | spectral_norm = 0.0026845 | frobenius_norm = 0.0035968 | spectral_norm_est_t2 = 0.0027063 | spectral_norm_est_t4 = 0.0026848
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 0.0000068 | spectral_norm = 0.0037228 | frobenius_norm = 0.0038149 | spectral_norm_est_t2 = 0.0037230 | spectral_norm_est_t4 = 0.0037229
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 0.0000071 | spectral_norm = 0.0012947 | frobenius_norm = 0.0017203 | spectral_norm_est_t2 = 0.0013379 | spectral_norm_est_t4 = 0.0012976
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 0.0000088 | spectral_norm = 0.0068677 | frobenius_norm = 0.0069690 | spectral_norm_est_t2 = 0.0068678 | spectral_norm_est_t4 = 0.0068677
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 0.0000181 | spectral_norm = 0.0024641 | frobenius_norm = 0.0029683 | spectral_norm_est_t2 = 0.0024737 | spectral_norm_est_t4 = 0.0024639
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 0.0000308 | spectral_norm = 0.0039503 | frobenius_norm = 0.0043483 | spectral_norm_est_t2 = 0.0039517 | spectral_norm_est_t4 = 0.0039505
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 0.0000590 | spectral_norm = 0.0024541 | frobenius_norm = 0.0038074 | spectral_norm_est_t2 = 0.0024751 | spectral_norm_est_t4 = 0.0024541
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 0.0000053 | spectral_norm = 0.0009136 | frobenius_norm = 0.0010839 | spectral_norm_est_t2 = 0.0009153 | spectral_norm_est_t4 = 0.0009136
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 0.0000057 | spectral_norm = 0.0005812 | frobenius_norm = 0.0009042 | spectral_norm_est_t2 = 0.0006002 | spectral_norm_est_t4 = 0.0005817
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 0.0000118 | spectral_norm = 0.0076277 | frobenius_norm = 0.0077926 | spectral_norm_est_t2 = 0.0076282 | spectral_norm_est_t4 = 0.0076279
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 0.0000174 | spectral_norm = 0.0022640 | frobenius_norm = 0.0029035 | spectral_norm_est_t2 = 0.0022732 | spectral_norm_est_t4 = 0.0022639
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 0.0000283 | spectral_norm = 0.0031047 | frobenius_norm = 0.0035824 | spectral_norm_est_t2 = 0.0031069 | spectral_norm_est_t4 = 0.0031048
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 0.0000543 | spectral_norm = 0.0025232 | frobenius_norm = 0.0036756 | spectral_norm_est_t2 = 0.0025366 | spectral_norm_est_t4 = 0.0025233
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 0.0000074 | spectral_norm = 0.0012227 | frobenius_norm = 0.0014719 | spectral_norm_est_t2 = 0.0012249 | spectral_norm_est_t4 = 0.0012226
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 0.0000082 | spectral_norm = 0.0007636 | frobenius_norm = 0.0013603 | spectral_norm_est_t2 = 0.0008569 | spectral_norm_est_t4 = 0.0007849
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 0.0000118 | spectral_norm = 0.0064856 | frobenius_norm = 0.0066647 | spectral_norm_est_t2 = 0.0064859 | spectral_norm_est_t4 = 0.0064854
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 0.0000179 | spectral_norm = 0.0027985 | frobenius_norm = 0.0032537 | spectral_norm_est_t2 = 0.0028014 | spectral_norm_est_t4 = 0.0027986
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 0.0000311 | spectral_norm = 0.0036106 | frobenius_norm = 0.0041179 | spectral_norm_est_t2 = 0.0036131 | spectral_norm_est_t4 = 0.0036109
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 0.0000575 | spectral_norm = 0.0031380 | frobenius_norm = 0.0043120 | spectral_norm_est_t2 = 0.0031493 | spectral_norm_est_t4 = 0.0031380
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 0.0000063 | spectral_norm = 0.0007517 | frobenius_norm = 0.0009719 | spectral_norm_est_t2 = 0.0007540 | spectral_norm_est_t4 = 0.0007516
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 0.0000066 | spectral_norm = 0.0004183 | frobenius_norm = 0.0008643 | spectral_norm_est_t2 = 0.0004754 | spectral_norm_est_t4 = 0.0004251
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 0.0000120 | spectral_norm = 0.0059650 | frobenius_norm = 0.0061741 | spectral_norm_est_t2 = 0.0059654 | spectral_norm_est_t4 = 0.0059648
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 0.0000156 | spectral_norm = 0.0028791 | frobenius_norm = 0.0033060 | spectral_norm_est_t2 = 0.0028813 | spectral_norm_est_t4 = 0.0028790
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 0.0000277 | spectral_norm = 0.0031143 | frobenius_norm = 0.0035805 | spectral_norm_est_t2 = 0.0031162 | spectral_norm_est_t4 = 0.0031144
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 0.0000516 | spectral_norm = 0.0025600 | frobenius_norm = 0.0036552 | spectral_norm_est_t2 = 0.0025717 | spectral_norm_est_t4 = 0.0025600
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 0.0000064 | spectral_norm = 0.0008911 | frobenius_norm = 0.0010749 | spectral_norm_est_t2 = 0.0008924 | spectral_norm_est_t4 = 0.0008911
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 0.0000068 | spectral_norm = 0.0004911 | frobenius_norm = 0.0009752 | spectral_norm_est_t2 = 0.0005859 | spectral_norm_est_t4 = 0.0005178
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 0.0000082 | spectral_norm = 0.0049815 | frobenius_norm = 0.0050988 | spectral_norm_est_t2 = 0.0049817 | spectral_norm_est_t4 = 0.0049815
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 0.0000157 | spectral_norm = 0.0024333 | frobenius_norm = 0.0027684 | spectral_norm_est_t2 = 0.0024348 | spectral_norm_est_t4 = 0.0024334
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 0.0000281 | spectral_norm = 0.0029584 | frobenius_norm = 0.0034036 | spectral_norm_est_t2 = 0.0029602 | spectral_norm_est_t4 = 0.0029586
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 0.0000529 | spectral_norm = 0.0023158 | frobenius_norm = 0.0034597 | spectral_norm_est_t2 = 0.0023290 | spectral_norm_est_t4 = 0.0023159
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 0.0000058 | spectral_norm = 0.0009250 | frobenius_norm = 0.0011013 | spectral_norm_est_t2 = 0.0009268 | spectral_norm_est_t4 = 0.0009250
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 0.0000059 | spectral_norm = 0.0004779 | frobenius_norm = 0.0008538 | spectral_norm_est_t2 = 0.0005237 | spectral_norm_est_t4 = 0.0004837
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 0.0000113 | spectral_norm = 0.0061472 | frobenius_norm = 0.0063261 | spectral_norm_est_t2 = 0.0061474 | spectral_norm_est_t4 = 0.0061470
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 0.0000162 | spectral_norm = 0.0034313 | frobenius_norm = 0.0038168 | spectral_norm_est_t2 = 0.0034329 | spectral_norm_est_t4 = 0.0034313
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 0.0000269 | spectral_norm = 0.0029293 | frobenius_norm = 0.0033911 | spectral_norm_est_t2 = 0.0029313 | spectral_norm_est_t4 = 0.0029295
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 0.0000543 | spectral_norm = 0.0016108 | frobenius_norm = 0.0029501 | spectral_norm_est_t2 = 0.0016478 | spectral_norm_est_t4 = 0.0016115
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 0.0000074 | spectral_norm = 0.0013463 | frobenius_norm = 0.0015334 | spectral_norm_est_t2 = 0.0013472 | spectral_norm_est_t4 = 0.0013463
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 0.0000078 | spectral_norm = 0.0008875 | frobenius_norm = 0.0014321 | spectral_norm_est_t2 = 0.0009680 | spectral_norm_est_t4 = 0.0008997
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 0.0000052 | spectral_norm = 0.0034054 | frobenius_norm = 0.0034924 | spectral_norm_est_t2 = 0.0034057 | spectral_norm_est_t4 = 0.0034054
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 0.0000213 | spectral_norm = 0.0041408 | frobenius_norm = 0.0043402 | spectral_norm_est_t2 = 0.0041409 | spectral_norm_est_t4 = 0.0041407
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 0.0000287 | spectral_norm = 0.0032040 | frobenius_norm = 0.0036112 | spectral_norm_est_t2 = 0.0032050 | spectral_norm_est_t4 = 0.0032039
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 0.0000570 | spectral_norm = 0.0016160 | frobenius_norm = 0.0030011 | spectral_norm_est_t2 = 0.0016519 | spectral_norm_est_t4 = 0.0016165
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 0.0000060 | spectral_norm = 0.0017333 | frobenius_norm = 0.0018252 | spectral_norm_est_t2 = 0.0017336 | spectral_norm_est_t4 = 0.0017333
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 0.0000062 | spectral_norm = 0.0008912 | frobenius_norm = 0.0012070 | spectral_norm_est_t2 = 0.0009171 | spectral_norm_est_t4 = 0.0008923
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 0.0000035 | spectral_norm = 0.0023889 | frobenius_norm = 0.0024373 | spectral_norm_est_t2 = 0.0023891 | spectral_norm_est_t4 = 0.0023889
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 0.0000233 | spectral_norm = 0.0050083 | frobenius_norm = 0.0051386 | spectral_norm_est_t2 = 0.0050086 | spectral_norm_est_t4 = 0.0050085
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 0.0000298 | spectral_norm = 0.0036543 | frobenius_norm = 0.0039857 | spectral_norm_est_t2 = 0.0036548 | spectral_norm_est_t4 = 0.0036542
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 0.0000572 | spectral_norm = 0.0017503 | frobenius_norm = 0.0031140 | spectral_norm_est_t2 = 0.0017826 | spectral_norm_est_t4 = 0.0017506
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 0.0000105 | spectral_norm = 0.0035773 | frobenius_norm = 0.0037531 | spectral_norm_est_t2 = 0.0035777 | spectral_norm_est_t4 = 0.0035773
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 0.0000123 | spectral_norm = 0.0019807 | frobenius_norm = 0.0027271 | spectral_norm_est_t2 = 0.0020552 | spectral_norm_est_t4 = 0.0019845
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 0.0000037 | spectral_norm = 0.0036832 | frobenius_norm = 0.0037579 | spectral_norm_est_t2 = 0.0036838 | spectral_norm_est_t4 = 0.0036833
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 0.0000296 | spectral_norm = 0.0185247 | frobenius_norm = 0.0186114 | spectral_norm_est_t2 = 0.0185259 | spectral_norm_est_t4 = 0.0185259
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 0.0000344 | spectral_norm = 0.0072527 | frobenius_norm = 0.0074831 | spectral_norm_est_t2 = 0.0072529 | spectral_norm_est_t4 = 0.0072527
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 0.0000651 | spectral_norm = 0.0079310 | frobenius_norm = 0.0086083 | spectral_norm_est_t2 = 0.0079336 | spectral_norm_est_t4 = 0.0079314
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 0.0000085 | spectral_norm = 0.0039472 | frobenius_norm = 0.0040329 | spectral_norm_est_t2 = 0.0039473 | spectral_norm_est_t4 = 0.0039471
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 0.0000088 | spectral_norm = 0.0018048 | frobenius_norm = 0.0020832 | spectral_norm_est_t2 = 0.0018131 | spectral_norm_est_t4 = 0.0018048
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 0.0000039 | spectral_norm = 0.0055171 | frobenius_norm = 0.0055566 | spectral_norm_est_t2 = 0.0055174 | spectral_norm_est_t4 = 0.0055173
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 0.0000252 | spectral_norm = 0.0178866 | frobenius_norm = 0.0180021 | spectral_norm_est_t2 = 0.0178876 | spectral_norm_est_t4 = 0.0178875
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 0.0000366 | spectral_norm = 0.0142005 | frobenius_norm = 0.0143961 | spectral_norm_est_t2 = 0.0142008 | spectral_norm_est_t4 = 0.0142005
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 0.0000734 | spectral_norm = 0.0090261 | frobenius_norm = 0.0104237 | spectral_norm_est_t2 = 0.0090489 | spectral_norm_est_t4 = 0.0090274
G name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 0.0000002
G name = 'module._orig_mod.lm_head.weight' | median_sv = 0.0001882 | spectral_norm = 0.1340582 | frobenius_norm = 0.1354177 | spectral_norm_est_t2 = 0.1340670 | spectral_norm_est_t4 = 0.1340613
saved grads to logs/1ef9fb63-cc79-4219-bbf9-a03b83709afa/grad_state_step001000.pt
===========================================
step:1001/1480 train_time:301775ms step_avg:304.52ms
step:1002/1480 train_time:302086ms step_avg:304.52ms
step:1003/1480 train_time:302411ms step_avg:304.54ms
step:1004/1480 train_time:302739ms step_avg:304.57ms
step:1005/1480 train_time:303073ms step_avg:304.60ms
step:1006/1480 train_time:303412ms step_avg:304.63ms
step:1007/1480 train_time:303739ms step_avg:304.65ms
step:1008/1480 train_time:304068ms step_avg:304.68ms
step:1009/1480 train_time:304396ms step_avg:304.70ms
step:1010/1480 train_time:304724ms step_avg:304.72ms
step:1011/1480 train_time:305071ms step_avg:304.77ms
step:1012/1480 train_time:305400ms step_avg:304.79ms
step:1013/1480 train_time:305727ms step_avg:304.81ms
step:1014/1480 train_time:306054ms step_avg:304.83ms
step:1015/1480 train_time:306377ms step_avg:304.85ms
step:1016/1480 train_time:306704ms step_avg:304.87ms
step:1017/1480 train_time:307031ms step_avg:304.90ms
step:1018/1480 train_time:307363ms step_avg:304.92ms
step:1019/1480 train_time:307696ms step_avg:304.95ms
step:1020/1480 train_time:308021ms step_avg:304.97ms
step:1021/1480 train_time:308346ms step_avg:304.99ms
step:1022/1480 train_time:308674ms step_avg:305.01ms
step:1023/1480 train_time:309001ms step_avg:305.04ms
step:1024/1480 train_time:309329ms step_avg:305.06ms
step:1025/1480 train_time:309657ms step_avg:305.08ms
step:1026/1480 train_time:309989ms step_avg:305.11ms
step:1027/1480 train_time:310318ms step_avg:305.13ms
step:1028/1480 train_time:310642ms step_avg:305.15ms
step:1029/1480 train_time:310969ms step_avg:305.17ms
step:1030/1480 train_time:311309ms step_avg:305.20ms
step:1031/1480 train_time:311646ms step_avg:305.24ms
step:1032/1480 train_time:311971ms step_avg:305.26ms
step:1033/1480 train_time:312299ms step_avg:305.28ms
step:1034/1480 train_time:312635ms step_avg:305.31ms
step:1035/1480 train_time:312968ms step_avg:305.33ms
step:1036/1480 train_time:313299ms step_avg:305.36ms
step:1037/1480 train_time:313636ms step_avg:305.39ms
step:1038/1480 train_time:313965ms step_avg:305.41ms
step:1039/1480 train_time:314292ms step_avg:305.43ms
step:1040/1480 train_time:314617ms step_avg:305.45ms
step:1041/1480 train_time:314945ms step_avg:305.48ms
step:1042/1480 train_time:315274ms step_avg:305.50ms
step:1043/1480 train_time:315608ms step_avg:305.53ms
step:1044/1480 train_time:315940ms step_avg:305.55ms
step:1045/1480 train_time:316266ms step_avg:305.57ms
step:1046/1480 train_time:316594ms step_avg:305.59ms
step:1047/1480 train_time:316918ms step_avg:305.61ms
step:1048/1480 train_time:317247ms step_avg:305.63ms
step:1049/1480 train_time:317581ms step_avg:305.66ms
step:1050/1480 train_time:317913ms step_avg:305.69ms
step:1051/1480 train_time:318242ms step_avg:305.71ms
step:1052/1480 train_time:318568ms step_avg:305.73ms
step:1053/1480 train_time:318896ms step_avg:305.75ms
step:1054/1480 train_time:319226ms step_avg:305.77ms
step:1055/1480 train_time:319546ms step_avg:305.79ms
step:1056/1480 train_time:319878ms step_avg:305.81ms
step:1057/1480 train_time:320204ms step_avg:305.83ms
step:1058/1480 train_time:320535ms step_avg:305.85ms
step:1059/1480 train_time:320864ms step_avg:305.88ms
step:1060/1480 train_time:321196ms step_avg:305.90ms
step:1061/1480 train_time:321532ms step_avg:305.93ms
step:1062/1480 train_time:321860ms step_avg:305.95ms
step:1063/1480 train_time:322186ms step_avg:305.97ms
step:1064/1480 train_time:322513ms step_avg:305.99ms
step:1065/1480 train_time:322842ms step_avg:306.01ms
step:1066/1480 train_time:323167ms step_avg:306.03ms
step:1067/1480 train_time:323495ms step_avg:306.05ms
step:1068/1480 train_time:323829ms step_avg:306.08ms
step:1069/1480 train_time:324160ms step_avg:306.10ms
step:1070/1480 train_time:324484ms step_avg:306.12ms
step:1071/1480 train_time:324824ms step_avg:306.15ms
step:1072/1480 train_time:325147ms step_avg:306.17ms
step:1073/1480 train_time:325482ms step_avg:306.19ms
step:1074/1480 train_time:325814ms step_avg:306.22ms
step:1075/1480 train_time:326136ms step_avg:306.23ms
step:1076/1480 train_time:326468ms step_avg:306.26ms
step:1077/1480 train_time:326796ms step_avg:306.28ms
step:1078/1480 train_time:327124ms step_avg:306.30ms
step:1079/1480 train_time:327449ms step_avg:306.31ms
step:1080/1480 train_time:327798ms step_avg:306.35ms
step:1081/1480 train_time:328122ms step_avg:306.37ms
step:1082/1480 train_time:328455ms step_avg:306.39ms
step:1083/1480 train_time:328789ms step_avg:306.42ms
step:1084/1480 train_time:329121ms step_avg:306.44ms
step:1085/1480 train_time:329450ms step_avg:306.47ms
step:1086/1480 train_time:329775ms step_avg:306.48ms
step:1087/1480 train_time:330104ms step_avg:306.50ms
step:1088/1480 train_time:330437ms step_avg:306.53ms
step:1089/1480 train_time:330773ms step_avg:306.56ms
step:1090/1480 train_time:331100ms step_avg:306.57ms
step:1091/1480 train_time:331430ms step_avg:306.60ms
step:1092/1480 train_time:331758ms step_avg:306.62ms
step:1093/1480 train_time:332090ms step_avg:306.64ms
step:1094/1480 train_time:332413ms step_avg:306.65ms
step:1095/1480 train_time:332739ms step_avg:306.67ms
step:1096/1480 train_time:333070ms step_avg:306.69ms
step:1097/1480 train_time:333396ms step_avg:306.71ms
step:1098/1480 train_time:333732ms step_avg:306.74ms
step:1099/1480 train_time:334057ms step_avg:306.76ms
step:1100/1480 train_time:334398ms step_avg:306.79ms
step:1101/1480 train_time:334738ms step_avg:306.82ms
step:1102/1480 train_time:335079ms step_avg:306.85ms
step:1103/1480 train_time:335413ms step_avg:306.87ms
step:1104/1480 train_time:335752ms step_avg:306.90ms
step:1105/1480 train_time:336088ms step_avg:306.93ms
step:1106/1480 train_time:336416ms step_avg:306.95ms
step:1107/1480 train_time:336756ms step_avg:306.98ms
step:1108/1480 train_time:337092ms step_avg:307.01ms
step:1109/1480 train_time:337426ms step_avg:307.03ms
step:1110/1480 train_time:337755ms step_avg:307.05ms
step:1111/1480 train_time:338079ms step_avg:307.07ms
step:1112/1480 train_time:338408ms step_avg:307.09ms
step:1113/1480 train_time:338744ms step_avg:307.11ms
step:1114/1480 train_time:339076ms step_avg:307.13ms
step:1115/1480 train_time:339403ms step_avg:307.15ms
step:1116/1480 train_time:339737ms step_avg:307.18ms
step:1117/1480 train_time:340083ms step_avg:307.21ms
step:1118/1480 train_time:340413ms step_avg:307.23ms
step:1119/1480 train_time:340754ms step_avg:307.26ms
step:1120/1480 train_time:341085ms step_avg:307.28ms
step:1121/1480 train_time:341415ms step_avg:307.30ms
step:1122/1480 train_time:341746ms step_avg:307.33ms
step:1123/1480 train_time:342073ms step_avg:307.34ms
step:1124/1480 train_time:342396ms step_avg:307.36ms
step:1125/1480 train_time:342727ms step_avg:307.38ms
step:1125/1480 val_loss:3.3811 train_time:342748ms step_avg:307.40ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 233.2312927
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 4.5958305 | spectral_norm = 25.7141323 | frobenius_norm = 165.8722382
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 4.0860915 | spectral_norm = 32.9766350 | frobenius_norm = 153.3586731
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 4.4530592 | spectral_norm = 19.4895840 | frobenius_norm = 156.0308685
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 4.4428058 | spectral_norm = 13.7107439 | frobenius_norm = 155.5147552
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 11.3511629 | spectral_norm = 23.5293980 | frobenius_norm = 334.7918091
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 5.7097750 | spectral_norm = 16.7602959 | frobenius_norm = 174.5321655
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 4.4760404 | spectral_norm = 17.8577213 | frobenius_norm = 165.3637543
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 4.4048586 | spectral_norm = 18.0966854 | frobenius_norm = 161.7456055
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 4.2173815 | spectral_norm = 15.6795406 | frobenius_norm = 161.2219238
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 4.8033152 | spectral_norm = 12.8655100 | frobenius_norm = 170.3388062
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 12.2518444 | spectral_norm = 28.9035549 | frobenius_norm = 362.8231201
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 6.0128422 | spectral_norm = 18.1723652 | frobenius_norm = 183.4907990
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 4.2875028 | spectral_norm = 15.1405916 | frobenius_norm = 164.5036163
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 4.3294945 | spectral_norm = 14.6572313 | frobenius_norm = 163.3649445
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 4.8026266 | spectral_norm = 17.4202099 | frobenius_norm = 184.7451019
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 5.5161038 | spectral_norm = 13.5956573 | frobenius_norm = 185.6557465
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 12.5327368 | spectral_norm = 31.0329781 | frobenius_norm = 370.0491638
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 6.0219569 | spectral_norm = 17.7651558 | frobenius_norm = 183.6282501
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 4.3974233 | spectral_norm = 18.5005455 | frobenius_norm = 165.2294312
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 4.4120956 | spectral_norm = 16.7830067 | frobenius_norm = 160.8505096
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 4.7893009 | spectral_norm = 16.7921944 | frobenius_norm = 181.7774811
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 5.1817403 | spectral_norm = 13.7448950 | frobenius_norm = 180.5227509
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 12.8531466 | spectral_norm = 31.7008114 | frobenius_norm = 380.8483887
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 6.2313085 | spectral_norm = 17.5007553 | frobenius_norm = 189.8302460
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 4.1061115 | spectral_norm = 15.9882669 | frobenius_norm = 160.3446503
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 4.0817189 | spectral_norm = 15.1723452 | frobenius_norm = 160.1961517
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 4.9712610 | spectral_norm = 17.6923676 | frobenius_norm = 189.5708160
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 5.6171641 | spectral_norm = 13.1491756 | frobenius_norm = 187.7317047
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 13.0171652 | spectral_norm = 30.1037636 | frobenius_norm = 382.7116394
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 6.1553955 | spectral_norm = 16.3764019 | frobenius_norm = 187.4705658
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 4.2956395 | spectral_norm = 17.3437271 | frobenius_norm = 162.5934906
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 4.3432069 | spectral_norm = 16.6764755 | frobenius_norm = 160.8211212
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 5.0518141 | spectral_norm = 17.1973915 | frobenius_norm = 188.5418701
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 5.3750682 | spectral_norm = 14.3166904 | frobenius_norm = 184.4766693
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 13.1537724 | spectral_norm = 27.8159637 | frobenius_norm = 385.0530090
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 6.2885180 | spectral_norm = 16.7004108 | frobenius_norm = 189.8639069
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 4.3865743 | spectral_norm = 15.6902037 | frobenius_norm = 164.5121155
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 4.3957000 | spectral_norm = 15.5244188 | frobenius_norm = 162.3834534
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 5.0120177 | spectral_norm = 17.7082424 | frobenius_norm = 192.5119171
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 5.5678673 | spectral_norm = 13.0987358 | frobenius_norm = 186.4336548
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 12.8224354 | spectral_norm = 28.4701920 | frobenius_norm = 377.2277222
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 6.2154865 | spectral_norm = 16.7370300 | frobenius_norm = 188.9817047
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 4.3738771 | spectral_norm = 17.0837288 | frobenius_norm = 163.9338379
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 4.3903952 | spectral_norm = 16.4490738 | frobenius_norm = 161.8626862
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 4.7892175 | spectral_norm = 16.2567444 | frobenius_norm = 185.1658173
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 5.1728959 | spectral_norm = 14.1613731 | frobenius_norm = 182.9629364
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 12.9832602 | spectral_norm = 29.9823093 | frobenius_norm = 383.4932251
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 6.3647456 | spectral_norm = 17.6165657 | frobenius_norm = 192.1283417
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 4.3998804 | spectral_norm = 16.5247211 | frobenius_norm = 169.8119354
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 4.3180328 | spectral_norm = 16.7225666 | frobenius_norm = 166.5383301
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 5.1342087 | spectral_norm = 22.1397305 | frobenius_norm = 200.6460266
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 5.7137847 | spectral_norm = 13.8231106 | frobenius_norm = 186.8538818
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 12.9975443 | spectral_norm = 31.8805962 | frobenius_norm = 383.1809692
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 6.4588695 | spectral_norm = 18.4646111 | frobenius_norm = 193.8261871
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 4.6769896 | spectral_norm = 16.5312576 | frobenius_norm = 175.2297668
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 4.5764742 | spectral_norm = 18.7071819 | frobenius_norm = 172.8906097
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 5.3106175 | spectral_norm = 19.5813408 | frobenius_norm = 197.3243256
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 5.6277437 | spectral_norm = 12.6439743 | frobenius_norm = 184.7893372
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 13.0424709 | spectral_norm = 33.1039543 | frobenius_norm = 385.3951721
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 6.5844827 | spectral_norm = 19.6244297 | frobenius_norm = 196.2856445
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 3.6153786 | spectral_norm = 21.1777306 | frobenius_norm = 159.1895905
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 3.4163005 | spectral_norm = 18.9594173 | frobenius_norm = 161.4372711
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 4.8009014 | spectral_norm = 17.7324791 | frobenius_norm = 182.1875916
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 6.1084213 | spectral_norm = 12.5709534 | frobenius_norm = 193.5248718
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 13.3678093 | spectral_norm = 27.9711189 | frobenius_norm = 388.9888000
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 5.9525313 | spectral_norm = 23.4724712 | frobenius_norm = 178.9504395
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 4.2091079 | spectral_norm = 20.6651192 | frobenius_norm = 169.0826874
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 4.0758658 | spectral_norm = 19.5661964 | frobenius_norm = 163.2585602
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 4.5136385 | spectral_norm = 19.9502621 | frobenius_norm = 172.4959412
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 5.7896609 | spectral_norm = 13.4703417 | frobenius_norm = 193.2754059
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 13.5504570 | spectral_norm = 34.8969650 | frobenius_norm = 400.1199341
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 6.0180154 | spectral_norm = 23.2502937 | frobenius_norm = 183.9613190
W name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 365.4675293
W name = 'module._orig_mod.lm_head.weight' | median_sv = 38.1998825 | spectral_norm = 186.4225769 | frobenius_norm = 1214.4228516
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 0.0000001
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 0.0000078 | spectral_norm = 0.0003057 | frobenius_norm = 0.0007109 | spectral_norm_est_t2 = 0.0003413 | spectral_norm_est_t4 = 0.0003079
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 0.0000079 | spectral_norm = 0.0003738 | frobenius_norm = 0.0007811 | spectral_norm_est_t2 = 0.0004080 | spectral_norm_est_t4 = 0.0003752
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 0.0000087 | spectral_norm = 0.0017730 | frobenius_norm = 0.0019967 | spectral_norm_est_t2 = 0.0017769 | spectral_norm_est_t4 = 0.0017730
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 0.0000182 | spectral_norm = 0.0056651 | frobenius_norm = 0.0058479 | spectral_norm_est_t2 = 0.0056654 | spectral_norm_est_t4 = 0.0056652
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 0.0000303 | spectral_norm = 0.0048333 | frobenius_norm = 0.0050512 | spectral_norm_est_t2 = 0.0048337 | spectral_norm_est_t4 = 0.0048335
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 0.0000540 | spectral_norm = 0.0012661 | frobenius_norm = 0.0027542 | spectral_norm_est_t2 = 0.0013190 | spectral_norm_est_t4 = 0.0012678
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 0.0000033 | spectral_norm = 0.0007535 | frobenius_norm = 0.0008512 | spectral_norm_est_t2 = 0.0007541 | spectral_norm_est_t4 = 0.0007535
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 0.0000036 | spectral_norm = 0.0004737 | frobenius_norm = 0.0006455 | spectral_norm_est_t2 = 0.0004788 | spectral_norm_est_t4 = 0.0004737
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 0.0000092 | spectral_norm = 0.0063267 | frobenius_norm = 0.0064266 | spectral_norm_est_t2 = 0.0063268 | spectral_norm_est_t4 = 0.0063267
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 0.0000164 | spectral_norm = 0.0021759 | frobenius_norm = 0.0027515 | spectral_norm_est_t2 = 0.0021837 | spectral_norm_est_t4 = 0.0021758
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 0.0000241 | spectral_norm = 0.0024904 | frobenius_norm = 0.0028765 | spectral_norm_est_t2 = 0.0024919 | spectral_norm_est_t4 = 0.0024906
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 0.0000476 | spectral_norm = 0.0018697 | frobenius_norm = 0.0029358 | spectral_norm_est_t2 = 0.0018945 | spectral_norm_est_t4 = 0.0018701
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 0.0000068 | spectral_norm = 0.0015955 | frobenius_norm = 0.0017706 | spectral_norm_est_t2 = 0.0015962 | spectral_norm_est_t4 = 0.0015955
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 0.0000071 | spectral_norm = 0.0009606 | frobenius_norm = 0.0013232 | spectral_norm_est_t2 = 0.0009764 | spectral_norm_est_t4 = 0.0009609
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 0.0000089 | spectral_norm = 0.0045361 | frobenius_norm = 0.0046540 | spectral_norm_est_t2 = 0.0045364 | spectral_norm_est_t4 = 0.0045362
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 0.0000178 | spectral_norm = 0.0016687 | frobenius_norm = 0.0022542 | spectral_norm_est_t2 = 0.0016804 | spectral_norm_est_t4 = 0.0016687
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 0.0000305 | spectral_norm = 0.0027623 | frobenius_norm = 0.0032757 | spectral_norm_est_t2 = 0.0027653 | spectral_norm_est_t4 = 0.0027627
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 0.0000589 | spectral_norm = 0.0015331 | frobenius_norm = 0.0032613 | spectral_norm_est_t2 = 0.0016021 | spectral_norm_est_t4 = 0.0015351
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 0.0000054 | spectral_norm = 0.0008082 | frobenius_norm = 0.0009939 | spectral_norm_est_t2 = 0.0008099 | spectral_norm_est_t4 = 0.0008082
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 0.0000057 | spectral_norm = 0.0004657 | frobenius_norm = 0.0008038 | spectral_norm_est_t2 = 0.0004864 | spectral_norm_est_t4 = 0.0004662
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 0.0000120 | spectral_norm = 0.0053024 | frobenius_norm = 0.0054797 | spectral_norm_est_t2 = 0.0053027 | spectral_norm_est_t4 = 0.0053024
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 0.0000174 | spectral_norm = 0.0016538 | frobenius_norm = 0.0023802 | spectral_norm_est_t2 = 0.0016671 | spectral_norm_est_t4 = 0.0016538
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 0.0000287 | spectral_norm = 0.0023944 | frobenius_norm = 0.0029682 | spectral_norm_est_t2 = 0.0023978 | spectral_norm_est_t4 = 0.0023944
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 0.0000549 | spectral_norm = 0.0017540 | frobenius_norm = 0.0031972 | spectral_norm_est_t2 = 0.0017851 | spectral_norm_est_t4 = 0.0017542
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 0.0000073 | spectral_norm = 0.0008779 | frobenius_norm = 0.0012192 | spectral_norm_est_t2 = 0.0008863 | spectral_norm_est_t4 = 0.0008780
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 0.0000082 | spectral_norm = 0.0005691 | frobenius_norm = 0.0012081 | spectral_norm_est_t2 = 0.0006629 | spectral_norm_est_t4 = 0.0005837
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 0.0000122 | spectral_norm = 0.0049421 | frobenius_norm = 0.0051438 | spectral_norm_est_t2 = 0.0049425 | spectral_norm_est_t4 = 0.0049420
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 0.0000182 | spectral_norm = 0.0020329 | frobenius_norm = 0.0026051 | spectral_norm_est_t2 = 0.0020389 | spectral_norm_est_t4 = 0.0020328
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 0.0000318 | spectral_norm = 0.0027942 | frobenius_norm = 0.0033924 | spectral_norm_est_t2 = 0.0027977 | spectral_norm_est_t4 = 0.0027943
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 0.0000588 | spectral_norm = 0.0022398 | frobenius_norm = 0.0037574 | spectral_norm_est_t2 = 0.0022720 | spectral_norm_est_t4 = 0.0022401
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 0.0000065 | spectral_norm = 0.0007238 | frobenius_norm = 0.0009725 | spectral_norm_est_t2 = 0.0007273 | spectral_norm_est_t4 = 0.0007238
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 0.0000068 | spectral_norm = 0.0004148 | frobenius_norm = 0.0008973 | spectral_norm_est_t2 = 0.0004794 | spectral_norm_est_t4 = 0.0004214
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 0.0000126 | spectral_norm = 0.0048985 | frobenius_norm = 0.0051308 | spectral_norm_est_t2 = 0.0048990 | spectral_norm_est_t4 = 0.0048983
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 0.0000163 | spectral_norm = 0.0023547 | frobenius_norm = 0.0028662 | spectral_norm_est_t2 = 0.0023584 | spectral_norm_est_t4 = 0.0023546
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 0.0000287 | spectral_norm = 0.0028352 | frobenius_norm = 0.0033582 | spectral_norm_est_t2 = 0.0028375 | spectral_norm_est_t4 = 0.0028353
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 0.0000536 | spectral_norm = 0.0021232 | frobenius_norm = 0.0034027 | spectral_norm_est_t2 = 0.0021397 | spectral_norm_est_t4 = 0.0021232
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 0.0000065 | spectral_norm = 0.0008593 | frobenius_norm = 0.0010521 | spectral_norm_est_t2 = 0.0008608 | spectral_norm_est_t4 = 0.0008593
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 0.0000068 | spectral_norm = 0.0004885 | frobenius_norm = 0.0008969 | spectral_norm_est_t2 = 0.0005331 | spectral_norm_est_t4 = 0.0004931
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 0.0000087 | spectral_norm = 0.0037797 | frobenius_norm = 0.0039120 | spectral_norm_est_t2 = 0.0037799 | spectral_norm_est_t4 = 0.0037797
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 0.0000159 | spectral_norm = 0.0018844 | frobenius_norm = 0.0022767 | spectral_norm_est_t2 = 0.0018866 | spectral_norm_est_t4 = 0.0018843
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 0.0000293 | spectral_norm = 0.0025482 | frobenius_norm = 0.0030584 | spectral_norm_est_t2 = 0.0025504 | spectral_norm_est_t4 = 0.0025482
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 0.0000546 | spectral_norm = 0.0017808 | frobenius_norm = 0.0031773 | spectral_norm_est_t2 = 0.0018083 | spectral_norm_est_t4 = 0.0017809
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 0.0000058 | spectral_norm = 0.0008562 | frobenius_norm = 0.0010509 | spectral_norm_est_t2 = 0.0008587 | spectral_norm_est_t4 = 0.0008562
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 0.0000059 | spectral_norm = 0.0004527 | frobenius_norm = 0.0007967 | spectral_norm_est_t2 = 0.0004810 | spectral_norm_est_t4 = 0.0004540
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 0.0000119 | spectral_norm = 0.0045591 | frobenius_norm = 0.0047706 | spectral_norm_est_t2 = 0.0045595 | spectral_norm_est_t4 = 0.0045590
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 0.0000165 | spectral_norm = 0.0026112 | frobenius_norm = 0.0030910 | spectral_norm_est_t2 = 0.0026141 | spectral_norm_est_t4 = 0.0026112
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 0.0000280 | spectral_norm = 0.0025267 | frobenius_norm = 0.0030596 | spectral_norm_est_t2 = 0.0025291 | spectral_norm_est_t4 = 0.0025267
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 0.0000567 | spectral_norm = 0.0012815 | frobenius_norm = 0.0028521 | spectral_norm_est_t2 = 0.0013415 | spectral_norm_est_t4 = 0.0012829
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 0.0000075 | spectral_norm = 0.0012182 | frobenius_norm = 0.0014211 | spectral_norm_est_t2 = 0.0012195 | spectral_norm_est_t4 = 0.0012182
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 0.0000078 | spectral_norm = 0.0008701 | frobenius_norm = 0.0013736 | spectral_norm_est_t2 = 0.0009382 | spectral_norm_est_t4 = 0.0008793
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 0.0000056 | spectral_norm = 0.0026114 | frobenius_norm = 0.0027241 | spectral_norm_est_t2 = 0.0026119 | spectral_norm_est_t4 = 0.0026114
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 0.0000219 | spectral_norm = 0.0030675 | frobenius_norm = 0.0033563 | spectral_norm_est_t2 = 0.0030680 | spectral_norm_est_t4 = 0.0030674
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 0.0000299 | spectral_norm = 0.0029306 | frobenius_norm = 0.0033800 | spectral_norm_est_t2 = 0.0029319 | spectral_norm_est_t4 = 0.0029307
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 0.0000592 | spectral_norm = 0.0012252 | frobenius_norm = 0.0028651 | spectral_norm_est_t2 = 0.0012838 | spectral_norm_est_t4 = 0.0012261
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 0.0000060 | spectral_norm = 0.0010106 | frobenius_norm = 0.0011480 | spectral_norm_est_t2 = 0.0010112 | spectral_norm_est_t4 = 0.0010106
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 0.0000063 | spectral_norm = 0.0006329 | frobenius_norm = 0.0009512 | spectral_norm_est_t2 = 0.0006679 | spectral_norm_est_t4 = 0.0006367
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 0.0000036 | spectral_norm = 0.0018860 | frobenius_norm = 0.0019530 | spectral_norm_est_t2 = 0.0018863 | spectral_norm_est_t4 = 0.0018860
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 0.0000240 | spectral_norm = 0.0034771 | frobenius_norm = 0.0037177 | spectral_norm_est_t2 = 0.0034780 | spectral_norm_est_t4 = 0.0034773
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 0.0000311 | spectral_norm = 0.0032330 | frobenius_norm = 0.0036167 | spectral_norm_est_t2 = 0.0032337 | spectral_norm_est_t4 = 0.0032330
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 0.0000595 | spectral_norm = 0.0012843 | frobenius_norm = 0.0029193 | spectral_norm_est_t2 = 0.0013392 | spectral_norm_est_t4 = 0.0012851
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 0.0000103 | spectral_norm = 0.0022201 | frobenius_norm = 0.0024914 | spectral_norm_est_t2 = 0.0022219 | spectral_norm_est_t4 = 0.0022200
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 0.0000120 | spectral_norm = 0.0015623 | frobenius_norm = 0.0021860 | spectral_norm_est_t2 = 0.0015894 | spectral_norm_est_t4 = 0.0015627
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 0.0000038 | spectral_norm = 0.0030645 | frobenius_norm = 0.0031655 | spectral_norm_est_t2 = 0.0030656 | spectral_norm_est_t4 = 0.0030645
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 0.0000294 | spectral_norm = 0.0130903 | frobenius_norm = 0.0132542 | spectral_norm_est_t2 = 0.0130912 | spectral_norm_est_t4 = 0.0130911
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 0.0000353 | spectral_norm = 0.0070529 | frobenius_norm = 0.0073195 | spectral_norm_est_t2 = 0.0070531 | spectral_norm_est_t4 = 0.0070527
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 0.0000665 | spectral_norm = 0.0050095 | frobenius_norm = 0.0059698 | spectral_norm_est_t2 = 0.0050138 | spectral_norm_est_t4 = 0.0050095
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 0.0000083 | spectral_norm = 0.0038123 | frobenius_norm = 0.0039143 | spectral_norm_est_t2 = 0.0038124 | spectral_norm_est_t4 = 0.0038122
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 0.0000087 | spectral_norm = 0.0018170 | frobenius_norm = 0.0021516 | spectral_norm_est_t2 = 0.0018336 | spectral_norm_est_t4 = 0.0018172
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 0.0000037 | spectral_norm = 0.0041711 | frobenius_norm = 0.0042195 | spectral_norm_est_t2 = 0.0041714 | spectral_norm_est_t4 = 0.0041713
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 0.0000251 | spectral_norm = 0.0119439 | frobenius_norm = 0.0120980 | spectral_norm_est_t2 = 0.0119440 | spectral_norm_est_t4 = 0.0119438
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 0.0000376 | spectral_norm = 0.0107023 | frobenius_norm = 0.0109473 | spectral_norm_est_t2 = 0.0107027 | spectral_norm_est_t4 = 0.0107023
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 0.0000744 | spectral_norm = 0.0056890 | frobenius_norm = 0.0075438 | spectral_norm_est_t2 = 0.0057370 | spectral_norm_est_t4 = 0.0056896
G name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 0.0000002
G name = 'module._orig_mod.lm_head.weight' | median_sv = 0.0001855 | spectral_norm = 0.0869873 | frobenius_norm = 0.0882059 | spectral_norm_est_t2 = 0.0869917 | spectral_norm_est_t4 = 0.0869883
saved grads to logs/1ef9fb63-cc79-4219-bbf9-a03b83709afa/grad_state_step001125.pt
===========================================
step:1126/1480 train_time:343088ms step_avg:307.43ms
step:1127/1480 train_time:343409ms step_avg:307.44ms
step:1128/1480 train_time:343742ms step_avg:307.46ms
step:1129/1480 train_time:344074ms step_avg:307.48ms
step:1130/1480 train_time:344408ms step_avg:307.51ms
step:1131/1480 train_time:344748ms step_avg:307.54ms
step:1132/1480 train_time:345076ms step_avg:307.55ms
step:1133/1480 train_time:345407ms step_avg:307.58ms
step:1134/1480 train_time:345735ms step_avg:307.59ms
step:1135/1480 train_time:346083ms step_avg:307.63ms
step:1136/1480 train_time:346416ms step_avg:307.65ms
step:1137/1480 train_time:346744ms step_avg:307.67ms
step:1138/1480 train_time:347078ms step_avg:307.69ms
step:1139/1480 train_time:347409ms step_avg:307.71ms
step:1140/1480 train_time:347745ms step_avg:307.74ms
step:1141/1480 train_time:348078ms step_avg:307.76ms
step:1142/1480 train_time:348404ms step_avg:307.78ms
step:1143/1480 train_time:348734ms step_avg:307.80ms
step:1144/1480 train_time:349062ms step_avg:307.81ms
step:1145/1480 train_time:349402ms step_avg:307.84ms
step:1146/1480 train_time:349738ms step_avg:307.87ms
step:1147/1480 train_time:350071ms step_avg:307.89ms
step:1148/1480 train_time:350399ms step_avg:307.91ms
step:1149/1480 train_time:350728ms step_avg:307.93ms
step:1150/1480 train_time:351056ms step_avg:307.94ms
step:1151/1480 train_time:351387ms step_avg:307.96ms
step:1152/1480 train_time:351720ms step_avg:307.99ms
step:1153/1480 train_time:352061ms step_avg:308.01ms
step:1154/1480 train_time:352395ms step_avg:308.04ms
step:1155/1480 train_time:352732ms step_avg:308.06ms
step:1156/1480 train_time:353065ms step_avg:308.08ms
step:1157/1480 train_time:353390ms step_avg:308.10ms
step:1158/1480 train_time:353731ms step_avg:308.13ms
step:1159/1480 train_time:354068ms step_avg:308.15ms
step:1160/1480 train_time:354398ms step_avg:308.17ms
step:1161/1480 train_time:354728ms step_avg:308.19ms
step:1162/1480 train_time:355055ms step_avg:308.21ms
step:1163/1480 train_time:355386ms step_avg:308.23ms
step:1164/1480 train_time:355724ms step_avg:308.25ms
step:1165/1480 train_time:356056ms step_avg:308.27ms
step:1166/1480 train_time:356394ms step_avg:308.30ms
step:1167/1480 train_time:356723ms step_avg:308.32ms
step:1168/1480 train_time:357052ms step_avg:308.34ms
step:1169/1480 train_time:357381ms step_avg:308.35ms
step:1170/1480 train_time:357716ms step_avg:308.38ms
step:1171/1480 train_time:358044ms step_avg:308.39ms
step:1172/1480 train_time:358376ms step_avg:308.41ms
step:1173/1480 train_time:358715ms step_avg:308.44ms
step:1174/1480 train_time:359043ms step_avg:308.46ms
step:1175/1480 train_time:359370ms step_avg:308.47ms
step:1176/1480 train_time:359719ms step_avg:308.51ms
step:1177/1480 train_time:360056ms step_avg:308.53ms
step:1178/1480 train_time:360392ms step_avg:308.55ms
step:1179/1480 train_time:360736ms step_avg:308.58ms
step:1180/1480 train_time:361075ms step_avg:308.61ms
step:1181/1480 train_time:361405ms step_avg:308.63ms
step:1182/1480 train_time:361735ms step_avg:308.65ms
step:1183/1480 train_time:362074ms step_avg:308.67ms
step:1184/1480 train_time:362403ms step_avg:308.69ms
step:1185/1480 train_time:362736ms step_avg:308.71ms
step:1186/1480 train_time:363071ms step_avg:308.73ms
step:1187/1480 train_time:363405ms step_avg:308.76ms
step:1188/1480 train_time:363739ms step_avg:308.78ms
step:1189/1480 train_time:364089ms step_avg:308.81ms
step:1190/1480 train_time:364425ms step_avg:308.84ms
step:1191/1480 train_time:364756ms step_avg:308.85ms
step:1192/1480 train_time:365088ms step_avg:308.87ms
step:1193/1480 train_time:365420ms step_avg:308.89ms
step:1194/1480 train_time:365751ms step_avg:308.91ms
step:1195/1480 train_time:366078ms step_avg:308.93ms
step:1196/1480 train_time:366421ms step_avg:308.96ms
step:1197/1480 train_time:366758ms step_avg:308.98ms
step:1198/1480 train_time:367092ms step_avg:309.00ms
step:1199/1480 train_time:367420ms step_avg:309.02ms
step:1200/1480 train_time:367759ms step_avg:309.04ms
step:1201/1480 train_time:368110ms step_avg:309.08ms
step:1202/1480 train_time:368457ms step_avg:309.11ms
step:1203/1480 train_time:368784ms step_avg:309.12ms
step:1204/1480 train_time:369122ms step_avg:309.15ms
step:1205/1480 train_time:369468ms step_avg:309.18ms
step:1206/1480 train_time:369800ms step_avg:309.20ms
step:1207/1480 train_time:370143ms step_avg:309.23ms
step:1208/1480 train_time:370481ms step_avg:309.25ms
step:1209/1480 train_time:370819ms step_avg:309.27ms
step:1210/1480 train_time:371158ms step_avg:309.30ms
step:1211/1480 train_time:371496ms step_avg:309.32ms
step:1212/1480 train_time:371847ms step_avg:309.36ms
step:1213/1480 train_time:372179ms step_avg:309.38ms
step:1214/1480 train_time:372514ms step_avg:309.40ms
step:1215/1480 train_time:372851ms step_avg:309.42ms
step:1216/1480 train_time:373190ms step_avg:309.44ms
step:1217/1480 train_time:373531ms step_avg:309.47ms
step:1218/1480 train_time:373859ms step_avg:309.49ms
step:1219/1480 train_time:374195ms step_avg:309.51ms
step:1220/1480 train_time:374525ms step_avg:309.52ms
step:1221/1480 train_time:374859ms step_avg:309.54ms
step:1222/1480 train_time:375193ms step_avg:309.57ms
step:1223/1480 train_time:375524ms step_avg:309.58ms
step:1224/1480 train_time:375870ms step_avg:309.61ms
step:1225/1480 train_time:376219ms step_avg:309.65ms
step:1226/1480 train_time:376557ms step_avg:309.67ms
step:1227/1480 train_time:376896ms step_avg:309.69ms
step:1228/1480 train_time:377223ms step_avg:309.71ms
step:1229/1480 train_time:377559ms step_avg:309.73ms
step:1230/1480 train_time:377894ms step_avg:309.75ms
step:1231/1480 train_time:378228ms step_avg:309.77ms
step:1232/1480 train_time:378590ms step_avg:309.81ms
step:1233/1480 train_time:378925ms step_avg:309.83ms
step:1234/1480 train_time:379262ms step_avg:309.85ms
step:1235/1480 train_time:379598ms step_avg:309.88ms
step:1236/1480 train_time:379928ms step_avg:309.89ms
step:1237/1480 train_time:380268ms step_avg:309.92ms
step:1238/1480 train_time:380608ms step_avg:309.94ms
step:1239/1480 train_time:380942ms step_avg:309.96ms
step:1240/1480 train_time:381280ms step_avg:309.98ms
step:1241/1480 train_time:381628ms step_avg:310.01ms
step:1242/1480 train_time:381973ms step_avg:310.04ms
step:1243/1480 train_time:382313ms step_avg:310.07ms
step:1244/1480 train_time:382644ms step_avg:310.08ms
step:1245/1480 train_time:382977ms step_avg:310.10ms
step:1246/1480 train_time:383310ms step_avg:310.12ms
step:1247/1480 train_time:383640ms step_avg:310.14ms
step:1248/1480 train_time:383972ms step_avg:310.15ms
step:1249/1480 train_time:384304ms step_avg:310.17ms
step:1250/1480 train_time:384640ms step_avg:310.19ms
step:1250/1480 val_loss:3.3320 train_time:384657ms step_avg:310.21ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 234.9808197
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 4.6254206 | spectral_norm = 26.7587471 | frobenius_norm = 168.4725800
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 4.1388855 | spectral_norm = 33.9029503 | frobenius_norm = 155.9885712
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 4.5284357 | spectral_norm = 20.1691380 | frobenius_norm = 158.6544342
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 4.5370426 | spectral_norm = 14.0730410 | frobenius_norm = 158.3707581
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 11.5501118 | spectral_norm = 24.0158463 | frobenius_norm = 341.1892395
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 5.8258443 | spectral_norm = 17.1241722 | frobenius_norm = 177.8466949
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 4.5477376 | spectral_norm = 18.3417225 | frobenius_norm = 168.3958893
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 4.5104194 | spectral_norm = 18.5391769 | frobenius_norm = 164.8498840
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 4.3136549 | spectral_norm = 16.0822697 | frobenius_norm = 164.7169342
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 4.9098110 | spectral_norm = 13.1192760 | frobenius_norm = 173.9629974
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 12.4916992 | spectral_norm = 29.5312290 | frobenius_norm = 370.0330505
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 6.1236935 | spectral_norm = 18.6314793 | frobenius_norm = 187.0369415
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 4.3475833 | spectral_norm = 15.4700565 | frobenius_norm = 167.4299316
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 4.3984580 | spectral_norm = 15.0690002 | frobenius_norm = 166.3354492
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 4.9232073 | spectral_norm = 17.7646599 | frobenius_norm = 188.8839417
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 5.6663509 | spectral_norm = 13.8980112 | frobenius_norm = 189.4763947
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 12.7755461 | spectral_norm = 31.8957615 | frobenius_norm = 377.1568909
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 6.1272740 | spectral_norm = 18.1850338 | frobenius_norm = 187.2285156
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 4.4663868 | spectral_norm = 19.0043812 | frobenius_norm = 168.3242493
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 4.4759188 | spectral_norm = 17.1815910 | frobenius_norm = 163.8614349
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 4.9224596 | spectral_norm = 17.1416302 | frobenius_norm = 185.9894714
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 5.3179245 | spectral_norm = 14.0037060 | frobenius_norm = 184.5420685
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 13.1226568 | spectral_norm = 32.6557274 | frobenius_norm = 388.0346069
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 6.3578811 | spectral_norm = 17.9539814 | frobenius_norm = 193.5510254
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 4.1427593 | spectral_norm = 16.3110256 | frobenius_norm = 163.0716705
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 4.1296587 | spectral_norm = 15.4717627 | frobenius_norm = 162.9950867
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 5.0904913 | spectral_norm = 18.2066212 | frobenius_norm = 194.0609436
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 5.7634578 | spectral_norm = 13.4239569 | frobenius_norm = 191.9940033
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 13.2500477 | spectral_norm = 30.8297939 | frobenius_norm = 389.7290955
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 6.2778945 | spectral_norm = 16.8053226 | frobenius_norm = 191.0483551
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 4.3419991 | spectral_norm = 17.8363228 | frobenius_norm = 165.4938965
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 4.4051204 | spectral_norm = 17.1289959 | frobenius_norm = 163.7634430
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 5.2044230 | spectral_norm = 17.6226368 | frobenius_norm = 193.0980988
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 5.5238190 | spectral_norm = 14.5652103 | frobenius_norm = 188.8020782
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 13.3841944 | spectral_norm = 28.4816227 | frobenius_norm = 391.9439087
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 6.4132815 | spectral_norm = 17.0845852 | frobenius_norm = 193.4970856
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 4.4283586 | spectral_norm = 16.1452427 | frobenius_norm = 167.3678741
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 4.4652238 | spectral_norm = 15.9477272 | frobenius_norm = 165.3601837
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 5.1006127 | spectral_norm = 18.0198975 | frobenius_norm = 196.7035370
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 5.7054992 | spectral_norm = 13.3514786 | frobenius_norm = 190.4395599
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 13.0783024 | spectral_norm = 29.0878162 | frobenius_norm = 384.3955078
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 6.3305864 | spectral_norm = 17.1240406 | frobenius_norm = 192.6723175
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 4.4335795 | spectral_norm = 17.5150528 | frobenius_norm = 166.7938538
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 4.4600806 | spectral_norm = 16.8281956 | frobenius_norm = 164.6728210
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 4.9185028 | spectral_norm = 16.6244946 | frobenius_norm = 189.5537567
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 5.3160486 | spectral_norm = 14.5359449 | frobenius_norm = 187.1303406
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 13.2185907 | spectral_norm = 30.5898991 | frobenius_norm = 390.4055481
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 6.4832568 | spectral_norm = 18.0087910 | frobenius_norm = 195.6501617
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 4.4467540 | spectral_norm = 16.9768047 | frobenius_norm = 172.9502258
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 4.3706451 | spectral_norm = 17.0688648 | frobenius_norm = 169.6087341
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 5.2483225 | spectral_norm = 22.7235699 | frobenius_norm = 205.8517914
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 5.8558784 | spectral_norm = 14.1102257 | frobenius_norm = 190.8368225
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 13.2439375 | spectral_norm = 32.5940475 | frobenius_norm = 390.0085449
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 6.5923634 | spectral_norm = 18.8645000 | frobenius_norm = 197.4531555
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 4.7510357 | spectral_norm = 17.0985622 | frobenius_norm = 178.4153290
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 4.6366329 | spectral_norm = 19.2029457 | frobenius_norm = 176.1210480
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 5.4295473 | spectral_norm = 20.1579342 | frobenius_norm = 202.0948639
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 5.7525449 | spectral_norm = 12.8467875 | frobenius_norm = 188.5845490
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 13.2700272 | spectral_norm = 34.0489693 | frobenius_norm = 392.5963135
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 6.7100268 | spectral_norm = 20.0928555 | frobenius_norm = 200.1723938
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 3.6128421 | spectral_norm = 21.9009647 | frobenius_norm = 161.5294495
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 3.3772366 | spectral_norm = 19.4946384 | frobenius_norm = 163.9588013
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 4.8946300 | spectral_norm = 18.2430191 | frobenius_norm = 186.5225525
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 6.2508421 | spectral_norm = 12.8096046 | frobenius_norm = 197.3500671
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 13.5673981 | spectral_norm = 28.6164455 | frobenius_norm = 394.5697937
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 6.0780025 | spectral_norm = 23.9938393 | frobenius_norm = 182.4289703
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 4.2472167 | spectral_norm = 21.3398094 | frobenius_norm = 171.8145447
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 4.1026263 | spectral_norm = 20.2187538 | frobenius_norm = 165.8539581
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 4.6588454 | spectral_norm = 20.4822521 | frobenius_norm = 176.8963013
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 5.8951192 | spectral_norm = 13.8157930 | frobenius_norm = 197.2875061
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 13.7458220 | spectral_norm = 35.6282730 | frobenius_norm = 406.1264954
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 6.1387353 | spectral_norm = 23.7713165 | frobenius_norm = 187.7156830
W name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 369.0581360
W name = 'module._orig_mod.lm_head.weight' | median_sv = 38.7329140 | spectral_norm = 186.3996124 | frobenius_norm = 1227.1538086
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 0.0000001
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 0.0000077 | spectral_norm = 0.0002505 | frobenius_norm = 0.0006507 | spectral_norm_est_t2 = 0.0002896 | spectral_norm_est_t4 = 0.0002545
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 0.0000079 | spectral_norm = 0.0002720 | frobenius_norm = 0.0006978 | spectral_norm_est_t2 = 0.0003304 | spectral_norm_est_t4 = 0.0002812
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 0.0000090 | spectral_norm = 0.0013274 | frobenius_norm = 0.0016291 | spectral_norm_est_t2 = 0.0013433 | spectral_norm_est_t4 = 0.0013276
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 0.0000179 | spectral_norm = 0.0040304 | frobenius_norm = 0.0042437 | spectral_norm_est_t2 = 0.0040306 | spectral_norm_est_t4 = 0.0040303
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 0.0000305 | spectral_norm = 0.0039245 | frobenius_norm = 0.0041561 | spectral_norm_est_t2 = 0.0039248 | spectral_norm_est_t4 = 0.0039246
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 0.0000544 | spectral_norm = 0.0009118 | frobenius_norm = 0.0024484 | spectral_norm_est_t2 = 0.0009563 | spectral_norm_est_t4 = 0.0009121
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 0.0000034 | spectral_norm = 0.0007730 | frobenius_norm = 0.0008528 | spectral_norm_est_t2 = 0.0007733 | spectral_norm_est_t4 = 0.0007730
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 0.0000037 | spectral_norm = 0.0005379 | frobenius_norm = 0.0006732 | spectral_norm_est_t2 = 0.0005401 | spectral_norm_est_t4 = 0.0005379
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 0.0000095 | spectral_norm = 0.0044032 | frobenius_norm = 0.0045176 | spectral_norm_est_t2 = 0.0044033 | spectral_norm_est_t4 = 0.0044031
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 0.0000166 | spectral_norm = 0.0015998 | frobenius_norm = 0.0022416 | spectral_norm_est_t2 = 0.0016113 | spectral_norm_est_t4 = 0.0015997
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 0.0000244 | spectral_norm = 0.0020380 | frobenius_norm = 0.0024466 | spectral_norm_est_t2 = 0.0020395 | spectral_norm_est_t4 = 0.0020381
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 0.0000483 | spectral_norm = 0.0017700 | frobenius_norm = 0.0027332 | spectral_norm_est_t2 = 0.0017803 | spectral_norm_est_t4 = 0.0017700
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 0.0000068 | spectral_norm = 0.0017023 | frobenius_norm = 0.0018444 | spectral_norm_est_t2 = 0.0017027 | spectral_norm_est_t4 = 0.0017023
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 0.0000070 | spectral_norm = 0.0008716 | frobenius_norm = 0.0012172 | spectral_norm_est_t2 = 0.0008909 | spectral_norm_est_t4 = 0.0008722
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 0.0000091 | spectral_norm = 0.0035360 | frobenius_norm = 0.0036756 | spectral_norm_est_t2 = 0.0035365 | spectral_norm_est_t4 = 0.0035360
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 0.0000177 | spectral_norm = 0.0013473 | frobenius_norm = 0.0019004 | spectral_norm_est_t2 = 0.0013579 | spectral_norm_est_t4 = 0.0013474
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 0.0000308 | spectral_norm = 0.0023024 | frobenius_norm = 0.0028018 | spectral_norm_est_t2 = 0.0023045 | spectral_norm_est_t4 = 0.0023024
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 0.0000593 | spectral_norm = 0.0012278 | frobenius_norm = 0.0028638 | spectral_norm_est_t2 = 0.0012651 | spectral_norm_est_t4 = 0.0012279
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 0.0000053 | spectral_norm = 0.0006189 | frobenius_norm = 0.0008139 | spectral_norm_est_t2 = 0.0006210 | spectral_norm_est_t4 = 0.0006189
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 0.0000057 | spectral_norm = 0.0003461 | frobenius_norm = 0.0006745 | spectral_norm_est_t2 = 0.0003719 | spectral_norm_est_t4 = 0.0003476
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 0.0000123 | spectral_norm = 0.0040222 | frobenius_norm = 0.0042206 | spectral_norm_est_t2 = 0.0040226 | spectral_norm_est_t4 = 0.0040222
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 0.0000177 | spectral_norm = 0.0011995 | frobenius_norm = 0.0019986 | spectral_norm_est_t2 = 0.0012194 | spectral_norm_est_t4 = 0.0011996
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 0.0000291 | spectral_norm = 0.0020451 | frobenius_norm = 0.0026176 | spectral_norm_est_t2 = 0.0020482 | spectral_norm_est_t4 = 0.0020454
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 0.0000561 | spectral_norm = 0.0013410 | frobenius_norm = 0.0028112 | spectral_norm_est_t2 = 0.0013653 | spectral_norm_est_t4 = 0.0013411
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 0.0000073 | spectral_norm = 0.0007280 | frobenius_norm = 0.0010337 | spectral_norm_est_t2 = 0.0007328 | spectral_norm_est_t4 = 0.0007280
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 0.0000081 | spectral_norm = 0.0005224 | frobenius_norm = 0.0010378 | spectral_norm_est_t2 = 0.0005692 | spectral_norm_est_t4 = 0.0005257
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 0.0000126 | spectral_norm = 0.0034330 | frobenius_norm = 0.0036900 | spectral_norm_est_t2 = 0.0034343 | spectral_norm_est_t4 = 0.0034328
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 0.0000185 | spectral_norm = 0.0014627 | frobenius_norm = 0.0020855 | spectral_norm_est_t2 = 0.0014705 | spectral_norm_est_t4 = 0.0014626
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 0.0000324 | spectral_norm = 0.0021750 | frobenius_norm = 0.0028043 | spectral_norm_est_t2 = 0.0021785 | spectral_norm_est_t4 = 0.0021751
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 0.0000596 | spectral_norm = 0.0014091 | frobenius_norm = 0.0030727 | spectral_norm_est_t2 = 0.0014446 | spectral_norm_est_t4 = 0.0014092
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 0.0000065 | spectral_norm = 0.0005442 | frobenius_norm = 0.0008050 | spectral_norm_est_t2 = 0.0005486 | spectral_norm_est_t4 = 0.0005442
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 0.0000068 | spectral_norm = 0.0003117 | frobenius_norm = 0.0007207 | spectral_norm_est_t2 = 0.0003519 | spectral_norm_est_t4 = 0.0003143
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 0.0000132 | spectral_norm = 0.0030717 | frobenius_norm = 0.0033717 | spectral_norm_est_t2 = 0.0030728 | spectral_norm_est_t4 = 0.0030716
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 0.0000168 | spectral_norm = 0.0015614 | frobenius_norm = 0.0021963 | spectral_norm_est_t2 = 0.0015699 | spectral_norm_est_t4 = 0.0015615
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 0.0000293 | spectral_norm = 0.0020345 | frobenius_norm = 0.0026247 | spectral_norm_est_t2 = 0.0020376 | spectral_norm_est_t4 = 0.0020346
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 0.0000545 | spectral_norm = 0.0013126 | frobenius_norm = 0.0028180 | spectral_norm_est_t2 = 0.0013430 | spectral_norm_est_t4 = 0.0013128
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 0.0000066 | spectral_norm = 0.0005657 | frobenius_norm = 0.0008021 | spectral_norm_est_t2 = 0.0005683 | spectral_norm_est_t4 = 0.0005657
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 0.0000070 | spectral_norm = 0.0003874 | frobenius_norm = 0.0007747 | spectral_norm_est_t2 = 0.0004266 | spectral_norm_est_t4 = 0.0003917
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 0.0000093 | spectral_norm = 0.0024676 | frobenius_norm = 0.0026536 | spectral_norm_est_t2 = 0.0024682 | spectral_norm_est_t4 = 0.0024676
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 0.0000166 | spectral_norm = 0.0012158 | frobenius_norm = 0.0017431 | spectral_norm_est_t2 = 0.0012217 | spectral_norm_est_t4 = 0.0012157
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 0.0000301 | spectral_norm = 0.0018401 | frobenius_norm = 0.0024311 | spectral_norm_est_t2 = 0.0018433 | spectral_norm_est_t4 = 0.0018401
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 0.0000558 | spectral_norm = 0.0011386 | frobenius_norm = 0.0027173 | spectral_norm_est_t2 = 0.0011779 | spectral_norm_est_t4 = 0.0011388
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 0.0000060 | spectral_norm = 0.0005738 | frobenius_norm = 0.0007934 | spectral_norm_est_t2 = 0.0005767 | spectral_norm_est_t4 = 0.0005738
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 0.0000060 | spectral_norm = 0.0003783 | frobenius_norm = 0.0006766 | spectral_norm_est_t2 = 0.0003951 | spectral_norm_est_t4 = 0.0003789
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 0.0000121 | spectral_norm = 0.0027553 | frobenius_norm = 0.0030343 | spectral_norm_est_t2 = 0.0027564 | spectral_norm_est_t4 = 0.0027553
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 0.0000169 | spectral_norm = 0.0017293 | frobenius_norm = 0.0023206 | spectral_norm_est_t2 = 0.0017349 | spectral_norm_est_t4 = 0.0017293
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 0.0000286 | spectral_norm = 0.0019090 | frobenius_norm = 0.0025025 | spectral_norm_est_t2 = 0.0019121 | spectral_norm_est_t4 = 0.0019090
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 0.0000576 | spectral_norm = 0.0008272 | frobenius_norm = 0.0025088 | spectral_norm_est_t2 = 0.0009015 | spectral_norm_est_t4 = 0.0008285
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 0.0000073 | spectral_norm = 0.0008062 | frobenius_norm = 0.0010471 | spectral_norm_est_t2 = 0.0008081 | spectral_norm_est_t4 = 0.0008062
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 0.0000077 | spectral_norm = 0.0006265 | frobenius_norm = 0.0010627 | spectral_norm_est_t2 = 0.0006781 | spectral_norm_est_t4 = 0.0006339
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 0.0000056 | spectral_norm = 0.0018309 | frobenius_norm = 0.0019594 | spectral_norm_est_t2 = 0.0018317 | spectral_norm_est_t4 = 0.0018309
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 0.0000218 | spectral_norm = 0.0019943 | frobenius_norm = 0.0023447 | spectral_norm_est_t2 = 0.0019950 | spectral_norm_est_t4 = 0.0019942
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 0.0000302 | spectral_norm = 0.0022636 | frobenius_norm = 0.0027580 | spectral_norm_est_t2 = 0.0022650 | spectral_norm_est_t4 = 0.0022635
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 0.0000602 | spectral_norm = 0.0008168 | frobenius_norm = 0.0025632 | spectral_norm_est_t2 = 0.0008943 | spectral_norm_est_t4 = 0.0008178
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 0.0000059 | spectral_norm = 0.0007858 | frobenius_norm = 0.0009354 | spectral_norm_est_t2 = 0.0007866 | spectral_norm_est_t4 = 0.0007857
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 0.0000062 | spectral_norm = 0.0005291 | frobenius_norm = 0.0007778 | spectral_norm_est_t2 = 0.0005389 | spectral_norm_est_t4 = 0.0005293
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 0.0000039 | spectral_norm = 0.0014759 | frobenius_norm = 0.0015506 | spectral_norm_est_t2 = 0.0014763 | spectral_norm_est_t4 = 0.0014759
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 0.0000241 | spectral_norm = 0.0023653 | frobenius_norm = 0.0026247 | spectral_norm_est_t2 = 0.0023655 | spectral_norm_est_t4 = 0.0023653
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 0.0000315 | spectral_norm = 0.0025947 | frobenius_norm = 0.0030073 | spectral_norm_est_t2 = 0.0025955 | spectral_norm_est_t4 = 0.0025947
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 0.0000604 | spectral_norm = 0.0008690 | frobenius_norm = 0.0026239 | spectral_norm_est_t2 = 0.0009455 | spectral_norm_est_t4 = 0.0008701
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 0.0000098 | spectral_norm = 0.0020078 | frobenius_norm = 0.0022174 | spectral_norm_est_t2 = 0.0020083 | spectral_norm_est_t4 = 0.0020078
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 0.0000115 | spectral_norm = 0.0014570 | frobenius_norm = 0.0019064 | spectral_norm_est_t2 = 0.0014658 | spectral_norm_est_t4 = 0.0014570
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 0.0000037 | spectral_norm = 0.0024093 | frobenius_norm = 0.0025097 | spectral_norm_est_t2 = 0.0024107 | spectral_norm_est_t4 = 0.0024093
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 0.0000291 | spectral_norm = 0.0084544 | frobenius_norm = 0.0086046 | spectral_norm_est_t2 = 0.0084548 | spectral_norm_est_t4 = 0.0084548
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 0.0000358 | spectral_norm = 0.0047515 | frobenius_norm = 0.0050494 | spectral_norm_est_t2 = 0.0047517 | spectral_norm_est_t4 = 0.0047514
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 0.0000677 | spectral_norm = 0.0032836 | frobenius_norm = 0.0044349 | spectral_norm_est_t2 = 0.0032895 | spectral_norm_est_t4 = 0.0032836
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 0.0000080 | spectral_norm = 0.0021745 | frobenius_norm = 0.0022970 | spectral_norm_est_t2 = 0.0021748 | spectral_norm_est_t4 = 0.0021744
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 0.0000085 | spectral_norm = 0.0013197 | frobenius_norm = 0.0015160 | spectral_norm_est_t2 = 0.0013211 | spectral_norm_est_t4 = 0.0013197
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 0.0000037 | spectral_norm = 0.0031159 | frobenius_norm = 0.0031697 | spectral_norm_est_t2 = 0.0031162 | spectral_norm_est_t4 = 0.0031159
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 0.0000246 | spectral_norm = 0.0072225 | frobenius_norm = 0.0074038 | spectral_norm_est_t2 = 0.0072232 | spectral_norm_est_t4 = 0.0072227
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 0.0000381 | spectral_norm = 0.0074844 | frobenius_norm = 0.0077468 | spectral_norm_est_t2 = 0.0074848 | spectral_norm_est_t4 = 0.0074843
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 0.0000757 | spectral_norm = 0.0038695 | frobenius_norm = 0.0059041 | spectral_norm_est_t2 = 0.0039539 | spectral_norm_est_t4 = 0.0038715
G name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 0.0000002
G name = 'module._orig_mod.lm_head.weight' | median_sv = 0.0001865 | spectral_norm = 0.0530816 | frobenius_norm = 0.0546371 | spectral_norm_est_t2 = 0.0530908 | spectral_norm_est_t4 = 0.0530811
saved grads to logs/1ef9fb63-cc79-4219-bbf9-a03b83709afa/grad_state_step001250.pt
===========================================
step:1251/1480 train_time:384988ms step_avg:310.22ms
step:1252/1480 train_time:385307ms step_avg:310.23ms
step:1253/1480 train_time:385639ms step_avg:310.25ms
step:1254/1480 train_time:385990ms step_avg:310.28ms
step:1255/1480 train_time:386331ms step_avg:310.31ms
step:1256/1480 train_time:386657ms step_avg:310.32ms
step:1257/1480 train_time:386994ms step_avg:310.34ms
step:1258/1480 train_time:387332ms step_avg:310.36ms
step:1259/1480 train_time:387671ms step_avg:310.39ms
step:1260/1480 train_time:388001ms step_avg:310.40ms
step:1261/1480 train_time:388348ms step_avg:310.43ms
step:1262/1480 train_time:388683ms step_avg:310.45ms
step:1263/1480 train_time:389019ms step_avg:310.47ms
step:1264/1480 train_time:389357ms step_avg:310.49ms
step:1265/1480 train_time:389693ms step_avg:310.51ms
step:1266/1480 train_time:390031ms step_avg:310.53ms
step:1267/1480 train_time:390368ms step_avg:310.55ms
step:1268/1480 train_time:390707ms step_avg:310.58ms
step:1269/1480 train_time:391043ms step_avg:310.60ms
step:1270/1480 train_time:391379ms step_avg:310.62ms
step:1271/1480 train_time:391706ms step_avg:310.63ms
step:1272/1480 train_time:392050ms step_avg:310.66ms
step:1273/1480 train_time:392379ms step_avg:310.67ms
step:1274/1480 train_time:392718ms step_avg:310.69ms
step:1275/1480 train_time:393045ms step_avg:310.71ms
step:1276/1480 train_time:393376ms step_avg:310.72ms
step:1277/1480 train_time:393708ms step_avg:310.74ms
step:1278/1480 train_time:394040ms step_avg:310.76ms
step:1279/1480 train_time:394380ms step_avg:310.78ms
step:1280/1480 train_time:394729ms step_avg:310.81ms
step:1281/1480 train_time:395055ms step_avg:310.82ms
step:1282/1480 train_time:395394ms step_avg:310.84ms
step:1283/1480 train_time:395725ms step_avg:310.86ms
step:1284/1480 train_time:396065ms step_avg:310.88ms
step:1285/1480 train_time:396395ms step_avg:310.90ms
step:1286/1480 train_time:396743ms step_avg:310.93ms
step:1287/1480 train_time:397069ms step_avg:310.94ms
step:1288/1480 train_time:397398ms step_avg:310.95ms
step:1289/1480 train_time:397733ms step_avg:310.97ms
step:1290/1480 train_time:398081ms step_avg:311.00ms
step:1291/1480 train_time:398422ms step_avg:311.02ms
step:1292/1480 train_time:398768ms step_avg:311.05ms
step:1293/1480 train_time:399121ms step_avg:311.08ms
step:1294/1480 train_time:399447ms step_avg:311.10ms
step:1295/1480 train_time:399785ms step_avg:311.12ms
step:1296/1480 train_time:400133ms step_avg:311.15ms
step:1297/1480 train_time:400473ms step_avg:311.17ms
step:1298/1480 train_time:400801ms step_avg:311.18ms
step:1299/1480 train_time:401139ms step_avg:311.20ms
step:1300/1480 train_time:401467ms step_avg:311.21ms
step:1301/1480 train_time:401799ms step_avg:311.23ms
step:1302/1480 train_time:402136ms step_avg:311.25ms
step:1303/1480 train_time:402466ms step_avg:311.27ms
step:1304/1480 train_time:402796ms step_avg:311.28ms
step:1305/1480 train_time:403134ms step_avg:311.30ms
step:1306/1480 train_time:403485ms step_avg:311.33ms
step:1307/1480 train_time:403823ms step_avg:311.35ms
step:1308/1480 train_time:404153ms step_avg:311.37ms
step:1309/1480 train_time:404493ms step_avg:311.39ms
step:1310/1480 train_time:404821ms step_avg:311.40ms
step:1311/1480 train_time:405152ms step_avg:311.42ms
step:1312/1480 train_time:405490ms step_avg:311.44ms
step:1313/1480 train_time:405823ms step_avg:311.45ms
step:1314/1480 train_time:406157ms step_avg:311.47ms
step:1315/1480 train_time:406494ms step_avg:311.49ms
step:1316/1480 train_time:406826ms step_avg:311.51ms
step:1317/1480 train_time:407177ms step_avg:311.54ms
step:1318/1480 train_time:407512ms step_avg:311.55ms
step:1319/1480 train_time:407843ms step_avg:311.57ms
step:1320/1480 train_time:408173ms step_avg:311.58ms
step:1321/1480 train_time:408524ms step_avg:311.61ms
step:1322/1480 train_time:408857ms step_avg:311.63ms
step:1323/1480 train_time:409197ms step_avg:311.65ms
step:1324/1480 train_time:409543ms step_avg:311.68ms
step:1325/1480 train_time:409890ms step_avg:311.70ms
step:1326/1480 train_time:410233ms step_avg:311.73ms
step:1327/1480 train_time:410566ms step_avg:311.74ms
step:1328/1480 train_time:410904ms step_avg:311.76ms
step:1329/1480 train_time:411249ms step_avg:311.79ms
step:1330/1480 train_time:411592ms step_avg:311.81ms
step:1331/1480 train_time:411956ms step_avg:311.85ms
step:1332/1480 train_time:412296ms step_avg:311.87ms
step:1333/1480 train_time:412634ms step_avg:311.89ms
step:1334/1480 train_time:412962ms step_avg:311.90ms
step:1335/1480 train_time:413309ms step_avg:311.93ms
step:1336/1480 train_time:413648ms step_avg:311.95ms
step:1337/1480 train_time:413986ms step_avg:311.97ms
step:1338/1480 train_time:414324ms step_avg:311.99ms
step:1339/1480 train_time:414667ms step_avg:312.01ms
step:1340/1480 train_time:415013ms step_avg:312.04ms
step:1341/1480 train_time:415350ms step_avg:312.06ms
step:1342/1480 train_time:415690ms step_avg:312.08ms
step:1343/1480 train_time:416021ms step_avg:312.09ms
step:1344/1480 train_time:416366ms step_avg:312.12ms
step:1345/1480 train_time:416702ms step_avg:312.14ms
step:1346/1480 train_time:417039ms step_avg:312.15ms
step:1347/1480 train_time:417373ms step_avg:312.17ms
step:1348/1480 train_time:417708ms step_avg:312.19ms
step:1349/1480 train_time:418039ms step_avg:312.20ms
step:1350/1480 train_time:418375ms step_avg:312.22ms
step:1351/1480 train_time:418716ms step_avg:312.24ms
step:1352/1480 train_time:419063ms step_avg:312.27ms
step:1353/1480 train_time:419399ms step_avg:312.29ms
step:1354/1480 train_time:419730ms step_avg:312.30ms
step:1355/1480 train_time:420061ms step_avg:312.31ms
step:1356/1480 train_time:420402ms step_avg:312.33ms
step:1357/1480 train_time:420748ms step_avg:312.36ms
step:1358/1480 train_time:421082ms step_avg:312.38ms
step:1359/1480 train_time:421421ms step_avg:312.39ms
step:1360/1480 train_time:421757ms step_avg:312.41ms
step:1361/1480 train_time:422094ms step_avg:312.43ms
step:1362/1480 train_time:422437ms step_avg:312.45ms
step:1363/1480 train_time:422781ms step_avg:312.48ms
step:1364/1480 train_time:423130ms step_avg:312.50ms
step:1365/1480 train_time:423462ms step_avg:312.52ms
step:1366/1480 train_time:423812ms step_avg:312.55ms
step:1367/1480 train_time:424140ms step_avg:312.56ms
step:1368/1480 train_time:424479ms step_avg:312.58ms
step:1369/1480 train_time:424819ms step_avg:312.60ms
step:1370/1480 train_time:425154ms step_avg:312.61ms
step:1371/1480 train_time:425500ms step_avg:312.64ms
step:1372/1480 train_time:425854ms step_avg:312.67ms
step:1373/1480 train_time:426199ms step_avg:312.69ms
step:1374/1480 train_time:426531ms step_avg:312.71ms
step:1375/1480 train_time:426878ms step_avg:312.73ms
step:1375/1480 val_loss:3.2932 train_time:426889ms step_avg:312.74ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 235.3603058
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 4.6452861 | spectral_norm = 27.2935543 | frobenius_norm = 169.2050629
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 4.1511183 | spectral_norm = 34.3201981 | frobenius_norm = 156.8088379
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 4.5482779 | spectral_norm = 20.4003334 | frobenius_norm = 159.6955414
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 4.5770946 | spectral_norm = 14.1988039 | frobenius_norm = 159.6090088
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 11.6599970 | spectral_norm = 24.2123203 | frobenius_norm = 343.8435059
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 5.8622003 | spectral_norm = 17.2735538 | frobenius_norm = 179.1157990
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 4.5714336 | spectral_norm = 18.5668736 | frobenius_norm = 169.5107269
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 4.5017181 | spectral_norm = 18.7478008 | frobenius_norm = 166.0144653
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 4.3508444 | spectral_norm = 16.2366276 | frobenius_norm = 166.0740662
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 4.9802055 | spectral_norm = 13.2208023 | frobenius_norm = 175.4176331
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 12.5764122 | spectral_norm = 29.8093433 | frobenius_norm = 372.8893127
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 6.1672206 | spectral_norm = 18.8300667 | frobenius_norm = 188.3781738
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 4.3530760 | spectral_norm = 15.6757116 | frobenius_norm = 168.4197083
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 4.4235258 | spectral_norm = 15.2174129 | frobenius_norm = 167.4073029
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 4.9806695 | spectral_norm = 17.8519535 | frobenius_norm = 190.6529541
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 5.7210980 | spectral_norm = 14.0733223 | frobenius_norm = 191.0672913
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 12.8604317 | spectral_norm = 32.2539062 | frobenius_norm = 379.8757935
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 6.1810546 | spectral_norm = 18.3479385 | frobenius_norm = 188.5408173
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 4.4789438 | spectral_norm = 19.2511826 | frobenius_norm = 169.4462585
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 4.4973221 | spectral_norm = 17.3733978 | frobenius_norm = 164.9434509
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 4.9739871 | spectral_norm = 17.2864342 | frobenius_norm = 187.8405304
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 5.3762455 | spectral_norm = 14.1223202 | frobenius_norm = 186.2908783
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 13.2184200 | spectral_norm = 33.0140610 | frobenius_norm = 390.7837524
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 6.4110384 | spectral_norm = 18.1322021 | frobenius_norm = 194.9098206
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 4.1564159 | spectral_norm = 16.4770660 | frobenius_norm = 163.9848022
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 4.1357727 | spectral_norm = 15.6059198 | frobenius_norm = 163.9257355
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 5.1592040 | spectral_norm = 18.4491978 | frobenius_norm = 196.0010071
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 5.8245835 | spectral_norm = 13.5699167 | frobenius_norm = 193.8108521
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 13.3532696 | spectral_norm = 31.1289291 | frobenius_norm = 392.3517151
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 6.3219562 | spectral_norm = 16.9471378 | frobenius_norm = 192.3670349
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 4.3432565 | spectral_norm = 18.0947819 | frobenius_norm = 166.4838409
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 4.4244590 | spectral_norm = 17.3306904 | frobenius_norm = 164.8260193
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 5.2701540 | spectral_norm = 17.8185158 | frobenius_norm = 195.0968475
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 5.6108804 | spectral_norm = 14.6774397 | frobenius_norm = 190.7131348
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 13.4900217 | spectral_norm = 28.7419167 | frobenius_norm = 394.5198669
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 6.4605184 | spectral_norm = 17.2344990 | frobenius_norm = 194.8187714
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 4.4381075 | spectral_norm = 16.3081570 | frobenius_norm = 168.3822784
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 4.4733725 | spectral_norm = 16.1465130 | frobenius_norm = 166.4485168
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 5.1667056 | spectral_norm = 18.1345520 | frobenius_norm = 198.5356293
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 5.7609463 | spectral_norm = 13.4568682 | frobenius_norm = 192.1274109
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 13.1888275 | spectral_norm = 29.2941914 | frobenius_norm = 387.0976257
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 6.3710275 | spectral_norm = 17.2457352 | frobenius_norm = 194.0153809
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 4.4379668 | spectral_norm = 17.7230091 | frobenius_norm = 167.8081818
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 4.4732895 | spectral_norm = 16.9726849 | frobenius_norm = 165.6652069
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 4.9784370 | spectral_norm = 16.7575512 | frobenius_norm = 191.5025330
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 5.3653150 | spectral_norm = 14.7327013 | frobenius_norm = 188.9216156
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 13.3078804 | spectral_norm = 30.7989902 | frobenius_norm = 392.9463501
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 6.5315447 | spectral_norm = 18.1782551 | frobenius_norm = 196.8636932
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 4.4615955 | spectral_norm = 17.2186165 | frobenius_norm = 174.0532990
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 4.3721318 | spectral_norm = 17.2193089 | frobenius_norm = 170.6955872
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 5.2896671 | spectral_norm = 22.9945068 | frobenius_norm = 208.1824188
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 5.8862782 | spectral_norm = 14.2645531 | frobenius_norm = 192.4458160
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 13.3400059 | spectral_norm = 32.8926392 | frobenius_norm = 392.5371704
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 6.6261792 | spectral_norm = 19.0045261 | frobenius_norm = 198.7399139
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 4.7593436 | spectral_norm = 17.3365574 | frobenius_norm = 179.6748199
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 4.6445179 | spectral_norm = 19.4105339 | frobenius_norm = 177.3362732
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 5.4712067 | spectral_norm = 20.3571663 | frobenius_norm = 204.0848999
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 5.8152666 | spectral_norm = 12.9419594 | frobenius_norm = 190.0979614
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 13.3470383 | spectral_norm = 34.4285812 | frobenius_norm = 395.3725586
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 6.7605658 | spectral_norm = 20.2421169 | frobenius_norm = 201.6359863
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 3.5994167 | spectral_norm = 22.2465076 | frobenius_norm = 162.1867065
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 3.3387048 | spectral_norm = 19.8038177 | frobenius_norm = 164.7118683
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 4.9503436 | spectral_norm = 18.4652195 | frobenius_norm = 188.3738708
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 6.3091393 | spectral_norm = 12.8838148 | frobenius_norm = 198.9210510
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 13.6399002 | spectral_norm = 28.8952236 | frobenius_norm = 396.3594360
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 6.1233964 | spectral_norm = 24.1463070 | frobenius_norm = 183.7275543
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 4.2416439 | spectral_norm = 21.6735344 | frobenius_norm = 172.6542969
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 4.0880060 | spectral_norm = 20.5561409 | frobenius_norm = 166.6591949
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 4.7048235 | spectral_norm = 20.7061214 | frobenius_norm = 178.7805023
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 5.9369693 | spectral_norm = 14.0091314 | frobenius_norm = 199.0220184
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 13.8065319 | spectral_norm = 35.8954544 | frobenius_norm = 407.9570618
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 6.1772895 | spectral_norm = 23.9420757 | frobenius_norm = 189.1828156
W name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 369.9527283
W name = 'module._orig_mod.lm_head.weight' | median_sv = 38.8851585 | spectral_norm = 185.9450226 | frobenius_norm = 1228.0653076
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 0.0000001
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 0.0000080 | spectral_norm = 0.0002331 | frobenius_norm = 0.0006510 | spectral_norm_est_t2 = 0.0002777 | spectral_norm_est_t4 = 0.0002375
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 0.0000081 | spectral_norm = 0.0002470 | frobenius_norm = 0.0006912 | spectral_norm_est_t2 = 0.0003137 | spectral_norm_est_t4 = 0.0002606
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 0.0000089 | spectral_norm = 0.0010398 | frobenius_norm = 0.0013371 | spectral_norm_est_t2 = 0.0010544 | spectral_norm_est_t4 = 0.0010402
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 0.0000187 | spectral_norm = 0.0035367 | frobenius_norm = 0.0037759 | spectral_norm_est_t2 = 0.0035371 | spectral_norm_est_t4 = 0.0035367
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 0.0000316 | spectral_norm = 0.0038097 | frobenius_norm = 0.0040564 | spectral_norm_est_t2 = 0.0038100 | spectral_norm_est_t4 = 0.0038098
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 0.0000558 | spectral_norm = 0.0007813 | frobenius_norm = 0.0024312 | spectral_norm_est_t2 = 0.0008479 | spectral_norm_est_t4 = 0.0007818
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 0.0000034 | spectral_norm = 0.0006280 | frobenius_norm = 0.0007268 | spectral_norm_est_t2 = 0.0006287 | spectral_norm_est_t4 = 0.0006280
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 0.0000037 | spectral_norm = 0.0004681 | frobenius_norm = 0.0006211 | spectral_norm_est_t2 = 0.0004709 | spectral_norm_est_t4 = 0.0004681
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 0.0000096 | spectral_norm = 0.0037166 | frobenius_norm = 0.0038405 | spectral_norm_est_t2 = 0.0037166 | spectral_norm_est_t4 = 0.0037164
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 0.0000165 | spectral_norm = 0.0014146 | frobenius_norm = 0.0020756 | spectral_norm_est_t2 = 0.0014281 | spectral_norm_est_t4 = 0.0014146
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 0.0000253 | spectral_norm = 0.0019665 | frobenius_norm = 0.0023881 | spectral_norm_est_t2 = 0.0019680 | spectral_norm_est_t4 = 0.0019665
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 0.0000493 | spectral_norm = 0.0015763 | frobenius_norm = 0.0026016 | spectral_norm_est_t2 = 0.0015875 | spectral_norm_est_t4 = 0.0015763
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 0.0000067 | spectral_norm = 0.0009579 | frobenius_norm = 0.0012000 | spectral_norm_est_t2 = 0.0009605 | spectral_norm_est_t4 = 0.0009579
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 0.0000070 | spectral_norm = 0.0009402 | frobenius_norm = 0.0012229 | spectral_norm_est_t2 = 0.0009451 | spectral_norm_est_t4 = 0.0009402
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 0.0000093 | spectral_norm = 0.0029722 | frobenius_norm = 0.0031192 | spectral_norm_est_t2 = 0.0029726 | spectral_norm_est_t4 = 0.0029721
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 0.0000177 | spectral_norm = 0.0010475 | frobenius_norm = 0.0016766 | spectral_norm_est_t2 = 0.0010672 | spectral_norm_est_t4 = 0.0010477
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 0.0000314 | spectral_norm = 0.0021051 | frobenius_norm = 0.0026385 | spectral_norm_est_t2 = 0.0021077 | spectral_norm_est_t4 = 0.0021053
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 0.0000601 | spectral_norm = 0.0009464 | frobenius_norm = 0.0027337 | spectral_norm_est_t2 = 0.0010152 | spectral_norm_est_t4 = 0.0009471
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 0.0000053 | spectral_norm = 0.0006037 | frobenius_norm = 0.0007913 | spectral_norm_est_t2 = 0.0006054 | spectral_norm_est_t4 = 0.0006037
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 0.0000058 | spectral_norm = 0.0003449 | frobenius_norm = 0.0006637 | spectral_norm_est_t2 = 0.0003667 | spectral_norm_est_t4 = 0.0003457
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 0.0000126 | spectral_norm = 0.0030970 | frobenius_norm = 0.0033143 | spectral_norm_est_t2 = 0.0030974 | spectral_norm_est_t4 = 0.0030969
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 0.0000176 | spectral_norm = 0.0009508 | frobenius_norm = 0.0018118 | spectral_norm_est_t2 = 0.0009829 | spectral_norm_est_t4 = 0.0009511
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 0.0000295 | spectral_norm = 0.0017083 | frobenius_norm = 0.0023416 | spectral_norm_est_t2 = 0.0017123 | spectral_norm_est_t4 = 0.0017084
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 0.0000567 | spectral_norm = 0.0010475 | frobenius_norm = 0.0026450 | spectral_norm_est_t2 = 0.0010882 | spectral_norm_est_t4 = 0.0010476
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 0.0000074 | spectral_norm = 0.0006505 | frobenius_norm = 0.0009777 | spectral_norm_est_t2 = 0.0006573 | spectral_norm_est_t4 = 0.0006505
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 0.0000082 | spectral_norm = 0.0004951 | frobenius_norm = 0.0009757 | spectral_norm_est_t2 = 0.0005248 | spectral_norm_est_t4 = 0.0004958
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 0.0000129 | spectral_norm = 0.0028000 | frobenius_norm = 0.0030711 | spectral_norm_est_t2 = 0.0028015 | spectral_norm_est_t4 = 0.0028000
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 0.0000187 | spectral_norm = 0.0011749 | frobenius_norm = 0.0018606 | spectral_norm_est_t2 = 0.0011875 | spectral_norm_est_t4 = 0.0011749
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 0.0000331 | spectral_norm = 0.0019637 | frobenius_norm = 0.0026314 | spectral_norm_est_t2 = 0.0019678 | spectral_norm_est_t4 = 0.0019638
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 0.0000612 | spectral_norm = 0.0012843 | frobenius_norm = 0.0030104 | spectral_norm_est_t2 = 0.0013264 | spectral_norm_est_t4 = 0.0012846
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 0.0000066 | spectral_norm = 0.0005404 | frobenius_norm = 0.0007904 | spectral_norm_est_t2 = 0.0005438 | spectral_norm_est_t4 = 0.0005404
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 0.0000069 | spectral_norm = 0.0003363 | frobenius_norm = 0.0007159 | spectral_norm_est_t2 = 0.0003654 | spectral_norm_est_t4 = 0.0003376
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 0.0000133 | spectral_norm = 0.0025306 | frobenius_norm = 0.0028472 | spectral_norm_est_t2 = 0.0025319 | spectral_norm_est_t4 = 0.0025305
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 0.0000168 | spectral_norm = 0.0012978 | frobenius_norm = 0.0019697 | spectral_norm_est_t2 = 0.0013091 | spectral_norm_est_t4 = 0.0012977
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 0.0000300 | spectral_norm = 0.0018940 | frobenius_norm = 0.0025019 | spectral_norm_est_t2 = 0.0018973 | spectral_norm_est_t4 = 0.0018940
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 0.0000557 | spectral_norm = 0.0011089 | frobenius_norm = 0.0027132 | spectral_norm_est_t2 = 0.0011535 | spectral_norm_est_t4 = 0.0011092
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 0.0000068 | spectral_norm = 0.0005650 | frobenius_norm = 0.0007925 | spectral_norm_est_t2 = 0.0005672 | spectral_norm_est_t4 = 0.0005650
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 0.0000071 | spectral_norm = 0.0003325 | frobenius_norm = 0.0007098 | spectral_norm_est_t2 = 0.0003681 | spectral_norm_est_t4 = 0.0003365
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 0.0000097 | spectral_norm = 0.0020362 | frobenius_norm = 0.0022374 | spectral_norm_est_t2 = 0.0020368 | spectral_norm_est_t4 = 0.0020362
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 0.0000170 | spectral_norm = 0.0010509 | frobenius_norm = 0.0016078 | spectral_norm_est_t2 = 0.0010578 | spectral_norm_est_t4 = 0.0010508
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 0.0000308 | spectral_norm = 0.0017059 | frobenius_norm = 0.0023203 | spectral_norm_est_t2 = 0.0017094 | spectral_norm_est_t4 = 0.0017059
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 0.0000568 | spectral_norm = 0.0010044 | frobenius_norm = 0.0026574 | spectral_norm_est_t2 = 0.0010534 | spectral_norm_est_t4 = 0.0010046
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 0.0000061 | spectral_norm = 0.0004799 | frobenius_norm = 0.0007199 | spectral_norm_est_t2 = 0.0004836 | spectral_norm_est_t4 = 0.0004799
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 0.0000061 | spectral_norm = 0.0003396 | frobenius_norm = 0.0006326 | spectral_norm_est_t2 = 0.0003532 | spectral_norm_est_t4 = 0.0003398
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 0.0000126 | spectral_norm = 0.0025046 | frobenius_norm = 0.0027982 | spectral_norm_est_t2 = 0.0025057 | spectral_norm_est_t4 = 0.0025045
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 0.0000172 | spectral_norm = 0.0016392 | frobenius_norm = 0.0022412 | spectral_norm_est_t2 = 0.0016451 | spectral_norm_est_t4 = 0.0016392
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 0.0000291 | spectral_norm = 0.0019332 | frobenius_norm = 0.0025209 | spectral_norm_est_t2 = 0.0019361 | spectral_norm_est_t4 = 0.0019332
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 0.0000588 | spectral_norm = 0.0007566 | frobenius_norm = 0.0024802 | spectral_norm_est_t2 = 0.0008354 | spectral_norm_est_t4 = 0.0007576
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 0.0000073 | spectral_norm = 0.0007627 | frobenius_norm = 0.0010112 | spectral_norm_est_t2 = 0.0007648 | spectral_norm_est_t4 = 0.0007627
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 0.0000078 | spectral_norm = 0.0005355 | frobenius_norm = 0.0009411 | spectral_norm_est_t2 = 0.0005648 | spectral_norm_est_t4 = 0.0005372
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 0.0000058 | spectral_norm = 0.0016914 | frobenius_norm = 0.0018306 | spectral_norm_est_t2 = 0.0016925 | spectral_norm_est_t4 = 0.0016914
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 0.0000225 | spectral_norm = 0.0018399 | frobenius_norm = 0.0022125 | spectral_norm_est_t2 = 0.0018407 | spectral_norm_est_t4 = 0.0018399
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 0.0000308 | spectral_norm = 0.0022382 | frobenius_norm = 0.0027410 | spectral_norm_est_t2 = 0.0022397 | spectral_norm_est_t4 = 0.0022382
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 0.0000616 | spectral_norm = 0.0007349 | frobenius_norm = 0.0025469 | spectral_norm_est_t2 = 0.0008241 | spectral_norm_est_t4 = 0.0007361
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 0.0000060 | spectral_norm = 0.0007378 | frobenius_norm = 0.0008928 | spectral_norm_est_t2 = 0.0007388 | spectral_norm_est_t4 = 0.0007377
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 0.0000062 | spectral_norm = 0.0005149 | frobenius_norm = 0.0007520 | spectral_norm_est_t2 = 0.0005235 | spectral_norm_est_t4 = 0.0005150
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 0.0000040 | spectral_norm = 0.0013601 | frobenius_norm = 0.0014448 | spectral_norm_est_t2 = 0.0013608 | spectral_norm_est_t4 = 0.0013601
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 0.0000246 | spectral_norm = 0.0021534 | frobenius_norm = 0.0024366 | spectral_norm_est_t2 = 0.0021535 | spectral_norm_est_t4 = 0.0021533
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 0.0000320 | spectral_norm = 0.0025301 | frobenius_norm = 0.0029520 | spectral_norm_est_t2 = 0.0025309 | spectral_norm_est_t4 = 0.0025301
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 0.0000620 | spectral_norm = 0.0008066 | frobenius_norm = 0.0026042 | spectral_norm_est_t2 = 0.0008887 | spectral_norm_est_t4 = 0.0008077
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 0.0000101 | spectral_norm = 0.0020410 | frobenius_norm = 0.0022684 | spectral_norm_est_t2 = 0.0020416 | spectral_norm_est_t4 = 0.0020409
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 0.0000118 | spectral_norm = 0.0014727 | frobenius_norm = 0.0019304 | spectral_norm_est_t2 = 0.0014811 | spectral_norm_est_t4 = 0.0014727
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 0.0000038 | spectral_norm = 0.0021575 | frobenius_norm = 0.0022694 | spectral_norm_est_t2 = 0.0021595 | spectral_norm_est_t4 = 0.0021575
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 0.0000296 | spectral_norm = 0.0078418 | frobenius_norm = 0.0080080 | spectral_norm_est_t2 = 0.0078421 | spectral_norm_est_t4 = 0.0078420
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 0.0000363 | spectral_norm = 0.0046571 | frobenius_norm = 0.0049617 | spectral_norm_est_t2 = 0.0046573 | spectral_norm_est_t4 = 0.0046570
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 0.0000691 | spectral_norm = 0.0029134 | frobenius_norm = 0.0041421 | spectral_norm_est_t2 = 0.0029207 | spectral_norm_est_t4 = 0.0029135
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 0.0000080 | spectral_norm = 0.0023440 | frobenius_norm = 0.0024489 | spectral_norm_est_t2 = 0.0023442 | spectral_norm_est_t4 = 0.0023440
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 0.0000085 | spectral_norm = 0.0014192 | frobenius_norm = 0.0016229 | spectral_norm_est_t2 = 0.0014216 | spectral_norm_est_t4 = 0.0014191
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 0.0000036 | spectral_norm = 0.0029242 | frobenius_norm = 0.0029794 | spectral_norm_est_t2 = 0.0029245 | spectral_norm_est_t4 = 0.0029242
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 0.0000248 | spectral_norm = 0.0064855 | frobenius_norm = 0.0066728 | spectral_norm_est_t2 = 0.0064859 | spectral_norm_est_t4 = 0.0064855
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 0.0000388 | spectral_norm = 0.0070346 | frobenius_norm = 0.0072978 | spectral_norm_est_t2 = 0.0070349 | spectral_norm_est_t4 = 0.0070345
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 0.0000770 | spectral_norm = 0.0036425 | frobenius_norm = 0.0056064 | spectral_norm_est_t2 = 0.0037108 | spectral_norm_est_t4 = 0.0036438
G name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 0.0000002
G name = 'module._orig_mod.lm_head.weight' | median_sv = 0.0001874 | spectral_norm = 0.0445627 | frobenius_norm = 0.0461114 | spectral_norm_est_t2 = 0.0445718 | spectral_norm_est_t4 = 0.0445625
saved grads to logs/1ef9fb63-cc79-4219-bbf9-a03b83709afa/grad_state_step001375.pt
===========================================
step:1376/1480 train_time:427222ms step_avg:312.75ms
step:1377/1480 train_time:427544ms step_avg:312.76ms
step:1378/1480 train_time:427883ms step_avg:312.78ms
step:1379/1480 train_time:428212ms step_avg:312.79ms
step:1380/1480 train_time:428554ms step_avg:312.81ms
step:1381/1480 train_time:428897ms step_avg:312.84ms
step:1382/1480 train_time:429237ms step_avg:312.86ms
step:1383/1480 train_time:429582ms step_avg:312.88ms
step:1384/1480 train_time:429934ms step_avg:312.91ms
step:1385/1480 train_time:430269ms step_avg:312.92ms
step:1386/1480 train_time:430605ms step_avg:312.94ms
step:1387/1480 train_time:430945ms step_avg:312.96ms
step:1388/1480 train_time:431271ms step_avg:312.97ms
step:1389/1480 train_time:431606ms step_avg:312.99ms
step:1390/1480 train_time:431948ms step_avg:313.01ms
step:1391/1480 train_time:432285ms step_avg:313.02ms
step:1392/1480 train_time:432629ms step_avg:313.05ms
step:1393/1480 train_time:432958ms step_avg:313.06ms
step:1394/1480 train_time:433292ms step_avg:313.07ms
step:1395/1480 train_time:433633ms step_avg:313.09ms
step:1396/1480 train_time:433971ms step_avg:313.11ms
step:1397/1480 train_time:434305ms step_avg:313.13ms
step:1398/1480 train_time:434640ms step_avg:313.14ms
step:1399/1480 train_time:434976ms step_avg:313.16ms
step:1400/1480 train_time:435308ms step_avg:313.17ms
step:1401/1480 train_time:435641ms step_avg:313.19ms
step:1402/1480 train_time:435975ms step_avg:313.20ms
step:1403/1480 train_time:436326ms step_avg:313.23ms
step:1404/1480 train_time:436653ms step_avg:313.24ms
step:1405/1480 train_time:436990ms step_avg:313.25ms
step:1406/1480 train_time:437339ms step_avg:313.28ms
step:1407/1480 train_time:437660ms step_avg:313.29ms
step:1408/1480 train_time:438004ms step_avg:313.31ms
step:1409/1480 train_time:438341ms step_avg:313.32ms
step:1410/1480 train_time:438672ms step_avg:313.34ms
step:1411/1480 train_time:439001ms step_avg:313.35ms
step:1412/1480 train_time:439358ms step_avg:313.38ms
step:1413/1480 train_time:439690ms step_avg:313.39ms
step:1414/1480 train_time:440019ms step_avg:313.40ms
step:1415/1480 train_time:440355ms step_avg:313.42ms
step:1416/1480 train_time:440693ms step_avg:313.44ms
step:1417/1480 train_time:441023ms step_avg:313.45ms
step:1418/1480 train_time:441360ms step_avg:313.47ms
step:1419/1480 train_time:441720ms step_avg:313.50ms
step:1420/1480 train_time:442062ms step_avg:313.52ms
step:1421/1480 train_time:442395ms step_avg:313.53ms
step:1422/1480 train_time:442739ms step_avg:313.55ms
step:1423/1480 train_time:443082ms step_avg:313.58ms
step:1424/1480 train_time:443424ms step_avg:313.60ms
step:1425/1480 train_time:443765ms step_avg:313.61ms
step:1426/1480 train_time:444095ms step_avg:313.63ms
step:1427/1480 train_time:444436ms step_avg:313.65ms
step:1428/1480 train_time:444801ms step_avg:313.68ms
step:1429/1480 train_time:445136ms step_avg:313.70ms
step:1430/1480 train_time:445477ms step_avg:313.72ms
step:1431/1480 train_time:445815ms step_avg:313.73ms
step:1432/1480 train_time:446145ms step_avg:313.75ms
step:1433/1480 train_time:446487ms step_avg:313.76ms
step:1434/1480 train_time:446837ms step_avg:313.79ms
step:1435/1480 train_time:447179ms step_avg:313.81ms
step:1436/1480 train_time:447537ms step_avg:313.84ms
step:1437/1480 train_time:447888ms step_avg:313.87ms
step:1438/1480 train_time:448223ms step_avg:313.88ms
step:1439/1480 train_time:448563ms step_avg:313.90ms
step:1440/1480 train_time:448910ms step_avg:313.92ms
step:1441/1480 train_time:449250ms step_avg:313.94ms
step:1442/1480 train_time:449596ms step_avg:313.96ms
step:1443/1480 train_time:449933ms step_avg:313.98ms
step:1444/1480 train_time:450268ms step_avg:313.99ms
step:1445/1480 train_time:450619ms step_avg:314.02ms
step:1446/1480 train_time:450973ms step_avg:314.05ms
step:1447/1480 train_time:451309ms step_avg:314.06ms
step:1448/1480 train_time:451650ms step_avg:314.08ms
step:1449/1480 train_time:451993ms step_avg:314.10ms
step:1450/1480 train_time:452335ms step_avg:314.12ms
step:1451/1480 train_time:452679ms step_avg:314.14ms
step:1452/1480 train_time:453012ms step_avg:314.16ms
step:1453/1480 train_time:453348ms step_avg:314.17ms
step:1454/1480 train_time:453693ms step_avg:314.19ms
step:1455/1480 train_time:454034ms step_avg:314.21ms
step:1456/1480 train_time:454371ms step_avg:314.23ms
step:1457/1480 train_time:454711ms step_avg:314.24ms
step:1458/1480 train_time:455065ms step_avg:314.27ms
step:1459/1480 train_time:455403ms step_avg:314.29ms
step:1460/1480 train_time:455742ms step_avg:314.30ms
step:1461/1480 train_time:456079ms step_avg:314.32ms
step:1462/1480 train_time:456416ms step_avg:314.34ms
step:1463/1480 train_time:456758ms step_avg:314.36ms
step:1464/1480 train_time:457091ms step_avg:314.37ms
step:1465/1480 train_time:457430ms step_avg:314.38ms
step:1466/1480 train_time:457775ms step_avg:314.41ms
step:1467/1480 train_time:458108ms step_avg:314.42ms
step:1468/1480 train_time:458442ms step_avg:314.43ms
step:1469/1480 train_time:458781ms step_avg:314.45ms
step:1470/1480 train_time:459121ms step_avg:314.47ms
step:1471/1480 train_time:459459ms step_avg:314.48ms
step:1472/1480 train_time:459801ms step_avg:314.50ms
step:1473/1480 train_time:460141ms step_avg:314.52ms
step:1474/1480 train_time:460499ms step_avg:314.55ms
step:1475/1480 train_time:460857ms step_avg:314.58ms
step:1476/1480 train_time:461191ms step_avg:314.59ms
step:1477/1480 train_time:461530ms step_avg:314.61ms
step:1478/1480 train_time:461868ms step_avg:314.62ms
step:1479/1480 train_time:462211ms step_avg:314.64ms
step:1480/1480 train_time:462560ms step_avg:314.67ms
step:1480/1480 val_loss:3.2746 train_time:462588ms step_avg:314.69ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | l1_to_l2_norm = 235.3722992
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | median_sv = 4.6430960 | spectral_norm = 27.4233189 | frobenius_norm = 169.2215576
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | median_sv = 4.1449666 | spectral_norm = 34.3982201 | frobenius_norm = 156.8604889
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | median_sv = 4.5647578 | spectral_norm = 20.4146519 | frobenius_norm = 159.8684540
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | median_sv = 4.5838709 | spectral_norm = 14.2126741 | frobenius_norm = 159.8065033
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | median_sv = 11.6950970 | spectral_norm = 24.2371120 | frobenius_norm = 344.2514038
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | median_sv = 5.8676534 | spectral_norm = 17.3047447 | frobenius_norm = 179.3037567
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | median_sv = 4.5640721 | spectral_norm = 18.6089859 | frobenius_norm = 169.6521149
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | median_sv = 4.5150561 | spectral_norm = 18.7993889 | frobenius_norm = 166.1538696
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | median_sv = 4.3604751 | spectral_norm = 16.2564449 | frobenius_norm = 166.3115845
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | median_sv = 4.9812360 | spectral_norm = 13.2377729 | frobenius_norm = 175.6801453
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | median_sv = 12.5929957 | spectral_norm = 29.8386040 | frobenius_norm = 373.3516541
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | median_sv = 6.1690822 | spectral_norm = 18.8597813 | frobenius_norm = 188.5593414
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | median_sv = 4.3575206 | spectral_norm = 15.7338285 | frobenius_norm = 168.5171814
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | median_sv = 4.4272428 | spectral_norm = 15.2603521 | frobenius_norm = 167.5390625
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | median_sv = 4.9878345 | spectral_norm = 17.8672962 | frobenius_norm = 190.9858093
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | median_sv = 5.7321277 | spectral_norm = 14.1112337 | frobenius_norm = 191.3687897
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | median_sv = 12.8849459 | spectral_norm = 32.2956009 | frobenius_norm = 380.3188171
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | median_sv = 6.1861220 | spectral_norm = 18.3813858 | frobenius_norm = 188.7302551
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | median_sv = 4.4882379 | spectral_norm = 19.2931652 | frobenius_norm = 169.5986023
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | median_sv = 4.5015988 | spectral_norm = 17.4155788 | frobenius_norm = 165.0817261
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | median_sv = 4.9811330 | spectral_norm = 17.3183975 | frobenius_norm = 188.1956482
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | median_sv = 5.3757553 | spectral_norm = 14.1416311 | frobenius_norm = 186.6180267
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | median_sv = 13.2371473 | spectral_norm = 33.0659142 | frobenius_norm = 391.1980286
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | median_sv = 6.4214945 | spectral_norm = 18.1598587 | frobenius_norm = 195.0996399
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | median_sv = 4.1525564 | spectral_norm = 16.5000477 | frobenius_norm = 164.0742950
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | median_sv = 4.1351214 | spectral_norm = 15.6214657 | frobenius_norm = 164.0442657
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | median_sv = 5.1746554 | spectral_norm = 18.5013714 | frobenius_norm = 196.3986053
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | median_sv = 5.8444662 | spectral_norm = 13.5783701 | frobenius_norm = 194.1551361
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | median_sv = 13.3783941 | spectral_norm = 31.1625519 | frobenius_norm = 392.7519531
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | median_sv = 6.3338032 | spectral_norm = 16.9677868 | frobenius_norm = 192.5435486
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | median_sv = 4.3450770 | spectral_norm = 18.1285877 | frobenius_norm = 166.6044922
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | median_sv = 4.4281507 | spectral_norm = 17.3774948 | frobenius_norm = 164.9523621
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | median_sv = 5.2749353 | spectral_norm = 17.8502102 | frobenius_norm = 195.4943390
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | median_sv = 5.6268020 | spectral_norm = 14.7008924 | frobenius_norm = 191.0892334
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | median_sv = 13.5082989 | spectral_norm = 28.7783203 | frobenius_norm = 394.9107971
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | median_sv = 6.4653936 | spectral_norm = 17.2625332 | frobenius_norm = 194.9915924
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | median_sv = 4.4299317 | spectral_norm = 16.3367825 | frobenius_norm = 168.4812164
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | median_sv = 4.4879222 | spectral_norm = 16.1814022 | frobenius_norm = 166.5767059
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | median_sv = 5.1768122 | spectral_norm = 18.1644745 | frobenius_norm = 198.8968201
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | median_sv = 5.7783041 | spectral_norm = 13.4686852 | frobenius_norm = 192.4394073
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | median_sv = 13.1966744 | spectral_norm = 29.3221855 | frobenius_norm = 387.4965820
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | median_sv = 6.3751865 | spectral_norm = 17.2638016 | frobenius_norm = 194.1897278
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | median_sv = 4.4489184 | spectral_norm = 17.7660656 | frobenius_norm = 167.9162750
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | median_sv = 4.4758501 | spectral_norm = 16.9973946 | frobenius_norm = 165.7723236
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | median_sv = 4.9993939 | spectral_norm = 16.7813301 | frobenius_norm = 191.8648071
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | median_sv = 5.3722363 | spectral_norm = 14.7619915 | frobenius_norm = 189.2609558
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | median_sv = 13.3192721 | spectral_norm = 30.8338509 | frobenius_norm = 393.3183594
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | median_sv = 6.5272875 | spectral_norm = 18.2082462 | frobenius_norm = 197.0026245
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | median_sv = 4.4603233 | spectral_norm = 17.2826557 | frobenius_norm = 174.1918793
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | median_sv = 4.3758082 | spectral_norm = 17.2469578 | frobenius_norm = 170.8354187
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | median_sv = 5.3026400 | spectral_norm = 23.0823383 | frobenius_norm = 208.6978302
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | median_sv = 5.8944631 | spectral_norm = 14.2914782 | frobenius_norm = 192.7321014
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | median_sv = 13.3495207 | spectral_norm = 32.9445686 | frobenius_norm = 392.9023743
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | median_sv = 6.6358309 | spectral_norm = 19.0193825 | frobenius_norm = 198.9014740
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | median_sv = 4.7533045 | spectral_norm = 17.4038239 | frobenius_norm = 179.8294678
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | median_sv = 4.6439681 | spectral_norm = 19.4530926 | frobenius_norm = 177.4897766
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | median_sv = 5.4732199 | spectral_norm = 20.4131775 | frobenius_norm = 204.4989166
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | median_sv = 5.8190460 | spectral_norm = 12.9526577 | frobenius_norm = 190.3531647
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | median_sv = 13.3594208 | spectral_norm = 34.5057220 | frobenius_norm = 395.7722168
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | median_sv = 6.7646461 | spectral_norm = 20.2593746 | frobenius_norm = 201.8320007
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | median_sv = 3.5850701 | spectral_norm = 22.3197002 | frobenius_norm = 162.1878815
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | median_sv = 3.3286297 | spectral_norm = 19.8745899 | frobenius_norm = 164.7508545
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | median_sv = 4.9520173 | spectral_norm = 18.5355167 | frobenius_norm = 188.7130890
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | median_sv = 6.3251391 | spectral_norm = 12.9007530 | frobenius_norm = 199.1980286
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | median_sv = 13.6390514 | spectral_norm = 28.9304352 | frobenius_norm = 396.4716187
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | median_sv = 6.1243649 | spectral_norm = 24.1532249 | frobenius_norm = 183.8888550
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | median_sv = 4.2342177 | spectral_norm = 21.7533569 | frobenius_norm = 172.7057953
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | median_sv = 4.0752997 | spectral_norm = 20.6107368 | frobenius_norm = 166.7041016
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | median_sv = 4.7225905 | spectral_norm = 20.7524967 | frobenius_norm = 179.1206665
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | median_sv = 5.9511843 | spectral_norm = 14.0538206 | frobenius_norm = 199.3543854
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | median_sv = 13.8121920 | spectral_norm = 35.8941307 | frobenius_norm = 408.1502380
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | median_sv = 6.1904392 | spectral_norm = 23.9508457 | frobenius_norm = 189.4105225
W name = 'module._orig_mod.value_embeds.weight' | l1_to_l2_norm = 369.9924927
W name = 'module._orig_mod.lm_head.weight' | median_sv = 38.8658943 | spectral_norm = 185.6405792 | frobenius_norm = 1226.5708008
===========================================
peak memory consumption: 35399 MiB

====================================================================================================
import os
import sys
with open(sys.argv[0]) as f:
    code = f.read() # read the code of this file ASAP, for logging
import uuid
import glob
import time
from dataclasses import dataclass

import numpy as np
import torch
from torch import nn
import torch.nn.functional as F
import torch.distributed as dist
import torch._inductor.config as config
from torch.nn.parallel import DistributedDataParallel as DDP
# Use of FlexAttention contributed by @KoszarskyB
from torch.nn.attention.flex_attention import flex_attention, create_block_mask, BlockMask, _score_mod_signature
from torch._inductor.lowering import make_pointwise, register_lowering
# Some internal torch.compile details
from torch._inductor.virtualized import ops
from functools import partial
flex_attention = torch.compile(flex_attention, dynamic=False)
create_block_mask = torch.compile(create_block_mask, dynamic=False)

# -----------------------------------------------------------------------------
# Muon optimizer

def zeropower_via_svd(G, steps=None):
    U, S, V = G.svd()
    return U @ V.T

@torch.compile
def zeropower_via_newtonschulz5(G, steps=10, eps=1e-7):
    """
    Newton-Schulz iteration to compute the zeroth power / orthogonalization of G. We opt to use a
    quintic iteration whose coefficients are selected to maximize the slope at zero. For the purpose
    of minimizing steps, it turns out to be empirically effective to keep increasing the slope at
    zero even beyond the point where the iteration no longer converges all the way to one everywhere
    on the interval. This iteration therefore does not produce UV^T but rather something like US'V^T
    where S' is diagonal with S_{ii}' ~ Uniform(0.5, 1.5), which turns out not to hurt model
    performance at all relative to UV^T, where USV^T = G is the SVD.
    """
    assert len(G.shape) == 2
    a, b, c = (3.4445, -4.7750,  2.0315)
    X = G.bfloat16()
    X /= (X.norm() + eps) # ensure top singular value <= 1
    if G.size(0) > G.size(1):
        X = X.T
    for _ in range(steps):
        A = X @ X.T
        B = b * A + c * A @ A # adapted from suggestion by @jxbz, @leloykun, and @YouJiacheng
        X = a * X + B @ X
    if G.size(0) > G.size(1):
        X = X.T
    return X

zeropower_backends = dict(svd=zeropower_via_svd, newtonschulz5=zeropower_via_newtonschulz5)

class Muon(torch.optim.Optimizer):
    """
    Muon - MomentUm Orthogonalized by Newton-schulz

    Muon internally runs standard SGD-momentum, and then performs an orthogonalization post-
    processing step, in which each 2D parameter's update is replaced with the nearest orthogonal
    matrix. To efficiently orthogonalize each update, we use a Newton-Schulz iteration, which has
    the advantage that it can be stably run in bfloat16 on the GPU.

    Some warnings:
    - This optimizer assumes that all parameters passed in are 2D.
    - It should not be used for the embedding layer, the final fully connected layer, or any {0,1}-D
    parameters; those should all be optimized by a standard method (e.g., AdamW).
    - To use it with 4D convolutional filters, it works well to just flatten their last 3 dimensions.
    - We believe it is unlikely to work well for training with small batch size.
    - We believe it may not work well for finetuning pretrained models, but we haven't tested this.
    - We have not yet tried this optimizer for training scenarios larger than NanoGPT (124M).

    Arguments:
        lr: The learning rate used by the internal SGD.
        momentum: The momentum used by the internal SGD.
        nesterov: Whether to use Nesterov-style momentum in the internal SGD. (recommended)
        backend: The chosen backend for the orthogonalization step. (recommended: 'newtonschulz5')
        backend_steps: The number of iteration steps to use in the backend, if it is iterative.
    """
    def __init__(self, params, lr=0.02, momentum=0.95, nesterov=True,
                 backend='newtonschulz5', backend_steps=5):
        defaults = dict(lr=lr, momentum=momentum, nesterov=nesterov, backend=backend, backend_steps=backend_steps)
        super().__init__(params, defaults)

    def step(self):

        for group in self.param_groups:

            lr = group['lr']
            momentum = group['momentum']
            zeropower_backend = zeropower_backends[group['backend']]

            # generate weight updates in distributed fashion
            total_params = sum(p.numel() for p in group['params'])
            updates_flat = torch.zeros(total_params, device='cuda', dtype=torch.bfloat16)
            curr_idx = 0
            for i, p in enumerate(group['params']):
                # luckily this will perfectly distribute a transformer with multiple of 4 layers to 8 GPUs
                if i % int(os.environ['WORLD_SIZE']) == int(os.environ['RANK']):
                    g = p.grad
                    assert g is not None
                    state = self.state[p]
                    if 'momentum_buffer' not in state:
                        state['momentum_buffer'] = torch.zeros_like(g)
                    buf = state['momentum_buffer']
                    buf.mul_(momentum).add_(g)
                    if group['nesterov']:
                        g = g.add(buf, alpha=momentum)
                    g = zeropower_backend(g, steps=group['backend_steps'])
                    g *= max(1, g.size(0)/g.size(1))**0.5
                    updates_flat[curr_idx:curr_idx+p.numel()] = g.flatten()
                curr_idx += p.numel()

            # sync updates across devices. we are not memory-constrained so can do this simple deserialization
            dist.all_reduce(updates_flat, op=dist.ReduceOp.SUM)

            # deserialize and apply updates
            curr_idx = 0
            for p in group['params']:
                g = updates_flat[curr_idx:curr_idx+p.numel()].view_as(p.data).type_as(p.data)
                p.data.add_(g, alpha=-lr)
                curr_idx += p.numel()

# -----------------------------------------------------------------------------
# Attention Tanh softcapping

@torch.library.custom_op("approx::tanh", mutates_args=())
def _tanh_approx(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

@_tanh_approx.register_fake
def _(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

def _tanh_approx_lowering(inp):
    fn = partial(ops.inline_asm_elementwise, asm="tanh.approx.f32 $0, $1;")
    return make_pointwise(fn)(inp)

register_lowering(torch.ops.approx.tanh)(_tanh_approx_lowering)

class _TanhApprox(torch.autograd.Function):
    @staticmethod
    def forward(x):
        return torch.ops.approx.tanh(x)

    @staticmethod
    def setup_context(ctx, inputs, output):
        (x,) = inputs
        result = output
        ctx.save_for_backward(result)

    @staticmethod
    def backward(ctx, grad_output):
        (result,) = ctx.saved_tensors
        return grad_output * (1 - result * result)

    @staticmethod
    def vmap(info, in_dims, x):
        return torch.tanh(x), 0

_tanh_approx = _TanhApprox.apply

def generate_tanh_softcap(soft_cap: int, approx: bool=True) -> _score_mod_signature:
    tanh = _tanh_approx if approx else torch.tanh

    def tanh_softcap(score, b, h, q_idx, kv_idx):
        return soft_cap * tanh(score / soft_cap)

    prefix = "tanh_softcap_approx" if approx else "tanh_softcap"
    tanh_softcap.__name__ = f"{prefix}_{soft_cap}"

    return tanh_softcap

# -----------------------------------------------------------------------------
# PyTorch nn.Module definitions for the GPT-2 model

class Rotary(torch.nn.Module):

    def __init__(self, dim, base=10000):
        super().__init__()
        self.dim = dim
        self.base = base
        self.inv_freq = None
        self.seq_len_cached = None
        self.cos_cached = None
        self.sin_cached = None

    def forward(self, x):
        seq_len = x.shape[1]
        if seq_len != self.seq_len_cached:
            self.inv_freq = 1.0 / (self.base ** (torch.arange(0, self.dim, 2, device=x.device).float() / self.dim))
            self.seq_len_cached = seq_len
            t = torch.arange(seq_len, device=x.device).type_as(self.inv_freq)
            freqs = torch.outer(t, self.inv_freq)
            self.cos_cached = freqs.cos().bfloat16()
            self.sin_cached = freqs.sin().bfloat16()
        return self.cos_cached[None, :, None, :], self.sin_cached[None, :, None, :]

def apply_rotary_emb(x, cos, sin):
    assert x.ndim == 4 # multihead attention
    d = x.shape[3]//2
    x1 = x[..., :d]
    x2 = x[..., d:]
    y1 = x1 * cos + x2 * sin
    y2 = x1 * (-sin) + x2 * cos
    return torch.cat([y1, y2], 3).type_as(x)

class CastedLinear(nn.Linear):
    def forward(self, x):
        return F.linear(x, self.weight.to(x.dtype))

class CausalSelfAttention(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.n_head = config.n_head
        self.n_embd = config.n_embd
        self.head_dim = self.n_embd // self.n_head
        assert self.n_embd % self.n_head == 0
        self.c_q = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_k = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_v = CastedLinear(self.n_embd, self.n_embd, bias=False)
        # output projection
        self.c_proj = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977
        self.rotary = Rotary(self.head_dim)
        self.lamb = nn.Parameter(torch.tensor(0.5)) # @Grad62304977

    def forward(self, x, v1, block_mask: BlockMask, score_mod: _score_mod_signature):
        B, T, C = x.size() # batch size, sequence length, embedding dimensionality (n_embd)
        q = self.c_q(x).view(B, T, self.n_head, self.head_dim)
        k = self.c_k(x).view(B, T, self.n_head, self.head_dim)
        v = self.c_v(x).view(B, T, self.n_head, self.head_dim)
        if v1 is None:
            v1 = v # This happens if we are in the first block. v needs to be accessed by subsequent blocks
        v = (1 - self.lamb) * v + self.lamb * v1.view_as(v) # @Grad62304977
        cos, sin = self.rotary(q)
        q, k = F.rms_norm(q, (q.size(-1),)), F.rms_norm(k, (k.size(-1),)) # QK norm suggested by @Grad62304977
        q, k = apply_rotary_emb(q, cos, sin), apply_rotary_emb(k, cos, sin)
        y = flex_attention(q.transpose(1, 2), k.transpose(1, 2), v.transpose(1, 2), score_mod=score_mod, block_mask=block_mask)
        y = y.transpose(1, 2).contiguous().view_as(x) # re-assemble all head outputs side by side
        y = self.c_proj(y)
        return y, v1

class MLP(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.c_fc    = CastedLinear(config.n_embd, 4 * config.n_embd, bias=False)
        self.c_proj  = CastedLinear(4 * config.n_embd, config.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977

    def forward(self, x):
        x = self.c_fc(x)
        x = F.relu(x).square() # https://arxiv.org/abs/2109.08668v2; ~1-2% better than GELU; suggested by @SKYLINEZ007 and @Grad62304977
        x = self.c_proj(x)
        return x

class Block(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.attn = CausalSelfAttention(config)
        self.mlp = MLP(config)
        self.lambdas = nn.Parameter(torch.tensor([1., 0.]))

    def forward(self, x, v1, x0, block_mask: BlockMask, score_mod: _score_mod_signature):
        x = self.lambdas[0] * x + self.lambdas[1] * x0
        x1, v1 = self.attn(F.rms_norm(x, (x.size(-1),)), v1, block_mask, score_mod)
        x = x + x1
        x = x + self.mlp(F.rms_norm(x, (x.size(-1),)))
        return x, v1

# -----------------------------------------------------------------------------
# The main GPT-2 model

@dataclass
class GPTConfig:
    vocab_size : int = 50304
    n_layer : int = 12
    n_head : int = 6 # head dim 128 suggested by @Grad62304977
    n_embd : int = 768
    attention_soft_cap : int = 50
    lm_head_soft_cap : int = 30

class GPT(nn.Module):

    def __init__(self, config: GPTConfig):
        super().__init__()
        self.attention_soft_cap = config.attention_soft_cap
        self.lm_head_soft_cap = config.lm_head_soft_cap

        # U-net design by @brendanh0gan
        self.num_encoder_layers = config.n_layer // 2 # Half of the layers for encoder
        self.num_decoder_layers = config.n_layer - self.num_encoder_layers # Remaining for decoder
        # Add learnable skip connection weights for decoder layers
        self.skip_weights = nn.Parameter(torch.ones(self.num_decoder_layers))

        self.transformer = nn.ModuleDict(dict(
            wte = nn.Embedding(config.vocab_size, config.n_embd),
            h = nn.ModuleList([Block(config) for _ in range(config.n_layer)]),
        ))
        self.lm_head = CastedLinear(config.n_embd, config.vocab_size, bias=False)
        self.lm_head.weight.data.zero_() # @Grad62304977

    def forward(self, idx, target, attn_blocksize: int):

        docs = (idx == 50256).cumsum(0)
        def document_causal_mask(b, h, q_idx, kv_idx):
            causal_mask = q_idx >= kv_idx
            document_mask = docs[q_idx] == docs[kv_idx]
            window_mask = q_idx - kv_idx < attn_blocksize
            return causal_mask & document_mask & window_mask

        softcap_mod = generate_tanh_softcap(self.attention_soft_cap, approx=True)  # @leloykun

        S = len(idx)
        block_mask = create_block_mask(document_causal_mask, None, None, S, S, device="cuda", _compile=True)

        # forward the GPT model itself
        x = self.transformer.wte(idx[None]) # token embeddings of shape (b, t, n_embd)
        x = F.rms_norm(x, (x.size(-1),)) # @Grad62304977
        x0 = x
        v1 = None

        # Store outputs for U-Net skip connections
        skip_connections = []
        # Encoder pass - process only the first half of the blocks
        for i in range(self.num_encoder_layers):
            x, v1 = self.transformer.h[i](x, v1, x0, block_mask, softcap_mod)
            skip_connections.append(x)
        # Decoder pass - process the remaining blocks with weighted skip connections
        for i in range(self.num_decoder_layers):
            x = x + self.skip_weights[i] * skip_connections.pop()
            x, v1 = self.transformer.h[self.num_encoder_layers + i](x, v1, x0, block_mask, softcap_mod)

        x = F.rms_norm(x, (x.size(-1),))
        logits = self.lm_head(x)
        logits = self.lm_head_soft_cap * torch.tanh(logits / self.lm_head_soft_cap) # @Grad62304977
        logits = logits.float()
        loss = F.cross_entropy(logits.view(-1, logits.size(-1)), target.view(-1))
        return loss

# -----------------------------------------------------------------------------
# Our own simple Distributed Data Loader

def _peek_data_shard(filename):
    # only reads the header, returns header data
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
    if header[0] != 20240520:
        print("ERROR: magic number mismatch in the data .bin file!")
        print("---> HINT: Are you passing in a correct file with --input_bin?")
        print("---> HINT: Dataset encoding changed recently, re-run data prepro or refer again to README")
        print("---> HINT: For example re-run: `python dev/data/tinyshakespeare.py`, then re-try")
        exit(1)
    assert header[1] == 1, "unsupported version"
    ntok = header[2] # number of tokens (claimed)
    return ntok # for now just return the number of tokens

def _load_data_shard(filename):
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
        assert header[0] == 20240520, "magic number mismatch in the data .bin file"
        assert header[1] == 1, "unsupported version"
        ntok = header[2] # number of tokens (claimed)
        # the rest of it are tokens, stored as uint16
        tokens = np.frombuffer(f.read(), dtype=np.uint16)
    assert len(tokens) == ntok, "number of tokens read does not match header?"
    return tokens

class DistributedDataLoader:
    def __init__(self, filename_pattern, B, T, process_rank, num_processes):
        self.process_rank = process_rank
        self.num_processes = num_processes
        self.B = B
        self.T = T

        # glob files that match the pattern
        self.files = sorted(glob.glob(filename_pattern))
        assert len(self.files) > 0, f"did not find any files that match the pattern {filename_pattern}"

        # load and validate all data shards, count number of tokens in total
        ntok_total = 0
        for fname in self.files:
            shard_ntok = _peek_data_shard(fname)
            assert shard_ntok >= num_processes * B * T + 1
            ntok_total += int(shard_ntok)
        self.ntok_total = ntok_total

        self.reset()

    def reset(self):
        self.current_shard = -1
        self.advance()

    def advance(self): # advance to next data shard
        self.current_shard = (self.current_shard + 1) % len(self.files)
        self.current_position = self.process_rank * self.B * self.T
        self.tokens = _load_data_shard(self.files[self.current_shard])

    def next_batch(self):
        batch_size = self.B * self.T * self.num_processes
        buf = self.tokens[self.current_position:self.current_position+self.B*self.T+1]
        buf = torch.tensor(buf.astype(np.int32), dtype=torch.long)
        x = buf[:-1] # inputs
        y = buf[1:] # targets
        # advance current position and load next shard if necessary
        self.current_position += batch_size
        if self.current_position + batch_size >= len(self.tokens):
            self.advance()
        return x.cuda(), y.cuda()

# -----------------------------------------------------------------------------
# int main

@dataclass
class Hyperparameters:
    # data hyperparams
    input_bin : str = 'data/fineweb10B/fineweb_train_*.bin' # input .bin to train on
    input_val_bin : str = 'data/fineweb10B/fineweb_val_*.bin' # input .bin to eval validation loss on
    # optimization hyperparams
    batch_size : int = 8 # batch size, in sequences, across all devices
    device_batch_size : int = 1 # batch size, in sequences, per device
    sequence_length : int = 64*1024 # sequence length, in tokens
    num_iterations : int = 1750 # number of iterations to run
    warmup_iters : int = 0
    cooldown_iters : int = 640 # number of iterations of linear warmup/cooldown for triangular or trapezoidal schedule
    weight_decay : float = 0
    # evaluation and logging hyperparams
    val_loss_every : int = 125 # every how many steps to evaluate val loss? 0 for only at the end
    val_tokens : int = 10485760 # how many tokens of validation data? it's important to keep this fixed for consistent comparisons
    save_every : int = 0 # every how many steps to save the checkpoint? 0 for only at the end
args = Hyperparameters()

# set up DDP (distributed data parallel). torchrun sets this env variable
assert torch.cuda.is_available()
dist.init_process_group(backend='nccl')
ddp_rank = int(os.environ['RANK'])
ddp_local_rank = int(os.environ['LOCAL_RANK'])
ddp_world_size = int(os.environ['WORLD_SIZE'])
device = f'cuda:{ddp_local_rank}'
torch.cuda.set_device(device)
print(f"using device: {device}")
master_process = (ddp_rank == 0) # this process will do logging, checkpointing etc.

# begin logging
logfile = None
if master_process:
    run_id = str(uuid.uuid4())
    logdir = 'logs/%s/' % run_id
    os.makedirs(logdir, exist_ok=True)
    logfile = 'logs/%s.txt' % run_id
    # create the log file
    with open(logfile, "w") as f:
        # begin the log by printing this file (the Python code)
        f.write('='*100 + '\n')
        f.write(code)
        f.write('='*100 + '\n')
def print0(s, logonly=False):
    if master_process:
        with open(logfile, "a") as f:
            if not logonly:
                print(s)
            f.write(s+'\n')
# log information about the hardware/software environment this is running on
# and print the full `nvidia-smi` to file
print0(f"Running pytorch {torch.version.__version__} compiled for CUDA {torch.version.cuda}\nnvidia-smi:")
import subprocess
result = subprocess.run(['nvidia-smi'], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
print0(f'{result.stdout}', logonly=True)
print0('='*100, logonly=True)

# convenience variables
B, T = args.device_batch_size, args.sequence_length
# calculate the number of steps to take in the val loop.
assert args.val_tokens % (B * T * ddp_world_size) == 0
val_steps = args.val_tokens // (B * T * ddp_world_size)
# calculate the steps of gradient accumulation required to attain the desired global batch size.
assert args.batch_size % (B * ddp_world_size) == 0
train_accumulation_steps = args.batch_size // (B * ddp_world_size)

# load tokens
train_loader = DistributedDataLoader(args.input_bin, B, T, ddp_rank, ddp_world_size)
val_loader = DistributedDataLoader(args.input_val_bin, B, T, ddp_rank, ddp_world_size)
print0(f"Training DataLoader: total number of tokens: {train_loader.ntok_total} across {len(train_loader.files)} files")
print0(f"Validation DataLoader: total number of tokens: {val_loader.ntok_total} across {len(val_loader.files)} files")
print0('='*100, logonly=True)
x, y = train_loader.next_batch()

# there are only 50257 unique GPT-2 tokens; we extend to nearest multiple of 128 for efficiency. suggested to me by @Grad62304977.
# this originates from Karpathy's experiments.
num_vocab = 50304
model = GPT(GPTConfig(vocab_size=num_vocab, n_layer=12, n_head=6, n_embd=768))
model = model.cuda().bfloat16()
for m in model.modules():
    if isinstance(m, CastedLinear):
        m.float()
if hasattr(config, "coordinate_descent_tuning"):
    config.coordinate_descent_tuning = True # suggested by @Chillee
model = torch.compile(model)
# here we wrap model into DDP container
model = DDP(model, device_ids=[ddp_local_rank])
raw_model = model.module # always contains the "raw" unwrapped model

# CUDNN attention is ~4ms faster than Flash, but doesn't get selected by default in PyTorch 2.5.1
from torch.backends.cuda import enable_cudnn_sdp, enable_flash_sdp, enable_math_sdp, enable_mem_efficient_sdp
enable_cudnn_sdp(True)
enable_flash_sdp(False)
enable_mem_efficient_sdp(False)
enable_math_sdp(False)

# init the optimizer(s)
optimizer1 = torch.optim.Adam([raw_model.transformer.wte.weight], lr=0.6,   betas=(0.8, 0.95), fused=True)
optimizer2 = torch.optim.Adam([raw_model.lm_head.weight],         lr=0.008, betas=(0.8, 0.95), fused=True)
param_names = [name for name, _ in raw_model.named_parameters()]
params = list(raw_model.transformer.h.parameters())
qk_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and ("c_q" in n or "c_k" in n)]
matrix_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and "c_q" not in n and "c_k" not in n]
scalar_params = [p for p in params if p.ndim < 2] + [raw_model.skip_weights]
optimizer5 = Muon(qk_params, lr=0.08, momentum=0.95)
optimizer3 = Muon(matrix_params, lr=0.05, momentum=0.95)
optimizer4 = torch.optim.Adam(scalar_params, lr=0.04, betas=(0.8, 0.95), fused=True) # note that this learning rate is neither sensitive nor tuned
optimizers = [optimizer1, optimizer2, optimizer3, optimizer4, optimizer5]
# learning rate decay scheduler (linear warmup and cooldown)
def get_lr(it):
    assert it <= args.num_iterations
    # 1) linear warmup for warmup_iters steps
    if it < args.warmup_iters:
        return (it+1) / args.warmup_iters
    # 2) constant lr for a while
    elif it < args.num_iterations - args.cooldown_iters:
        return 1.0
    # 3) linear cooldown
    else:
        decay_ratio = (args.num_iterations - it) / args.cooldown_iters
        return decay_ratio
schedulers = [torch.optim.lr_scheduler.LambdaLR(opt, get_lr) for opt in optimizers]

# Start training loop
training_time_ms = 0
# start the clock
torch.cuda.synchronize()
t0 = time.time()
# begin training
for step in range(args.num_iterations + 1):
    last_step = (step == args.num_iterations)
    # Set the attention blocksize for the current step, in chunks of 64
    attn_blocksize = torch.tensor(64*((step/args.num_iterations * (1792 - 64) + 64)//64), dtype=torch.int, device='cuda')
    # This effectively ignores timing first 10 steps, which are slower for weird reasons.
    # Alternately, and slightly more correctly in terms of benchmarking, we could do 10
    # steps with dummy data first, and then re-initialize the model and reset the loader.
    if step == 10:
        training_time_ms = 0
        t0 = time.time()
    timed_steps = float('nan') if step <= 11 else (step - 10) + 1 # <= 11 to avoid bug in val

    # once in a while evaluate the validation dataset
    if (last_step or (args.val_loss_every > 0 and step % args.val_loss_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # run validation batches
        model.eval()
        val_loader.reset()
        val_loss = 0.0
        for _ in range(val_steps):
            with torch.no_grad():
                x_val, y_val = val_loader.next_batch()
                val_loss += model(x_val, y_val, attn_blocksize=attn_blocksize)
        dist.all_reduce(val_loss, op=dist.ReduceOp.AVG)
        val_loss /= val_steps
        # log val loss to console and to logfile
        print0(f'step:{step}/{args.num_iterations} val_loss:{val_loss:.4f} train_time:{training_time_ms:.0f}ms step_avg:{training_time_ms/(timed_steps-1):.2f}ms')
        if master_process:
            print("============== Weight norms: ==============")
            with open(logfile, "a") as f:
                f.write("============== Weight norms: ==============\n")
                for name, p in model.named_parameters():
                    if p.ndim != 2:
                        continue
                    if "transformer.wte" in name:
                        l1_to_l2_norm = torch.norm(p.data.float(), p=2, dim=1).mean().item()
                    frobenius_norm = torch.linalg.norm(p.data.float(), ord='fro').item()
                    spectral_norm = torch.linalg.matrix_norm(p.data.float(), ord=2).item()
                    nuclear_norm = torch.linalg.matrix_norm(p.data.float(), ord="nuc").item()
                    if "transformer.wte" in name:
                        print(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                    else:
                        print(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                f.write("===========================================\n")
            print("===========================================")
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    if master_process and (last_step or (args.save_every > 0 and step % args.save_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # save the state of the training process
        log = dict(step=step, code=code, model=raw_model.state_dict(), optimizers=[opt.state_dict() for opt in optimizers])
        torch.save(log, 'logs/%s/state_step%06d.pt' % (run_id, step))
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    # bit confusing: we want to make sure to eval on 0th iteration
    # but also after the very last iteration. so we loop for step <= num_iterations
    # instead of just < num_iterations (one extra due to <=), only to do
    # the validation/sampling one last time, and then we break right here as we're done.
    if last_step:
        break

    # --------------- TRAINING SECTION BEGIN -----------------
    model.train()
    for i in range(1, train_accumulation_steps+1):
        # forward pass
        loss = model(x, y, attn_blocksize=attn_blocksize)
        train_loss = loss.detach()
        # advance the dataset for the next batch
        x, y = train_loader.next_batch()
        # backward pass
        if i < train_accumulation_steps:
            with model.no_sync(): # there's no need to sync gradients every accumulation step
                loss.backward()
        else:
            loss.backward() # just sync on the last step
    for p in model.parameters():
        p.grad /= train_accumulation_steps
    # momentum warmup for Muon
    frac = min(step/300, 1)
    optimizer3.param_groups[0]['momentum'] = (1 - frac) * 0.85 + frac * 0.95
    # step the optimizers and schedulers
    for opt, sched in zip(optimizers, schedulers):
        opt.step()
        sched.step()
    # null the gradients
    model.zero_grad(set_to_none=True)
    # --------------- TRAINING SECTION END -------------------
    # everything that follows now is just diagnostics, prints, logging, etc.

    #dist.all_reduce(train_loss, op=dist.ReduceOp.AVG) # all-reducing the training loss would be more correct in terms of logging, but slower
    approx_time = training_time_ms + 1000 * (time.time() - t0)
    print0(f"step:{step+1}/{args.num_iterations} train_loss:{train_loss.item():.4f} train_time:{approx_time:.0f}ms step_avg:{approx_time/timed_steps:.2f}ms")

if master_process:
    print(f"peak memory consumption: {torch.cuda.max_memory_allocated() // 1024 // 1024} MiB")

# -------------------------------------------------------------------------
# clean up nice
dist.destroy_process_group()
====================================================================================================
Running pytorch 2.6.0.dev20241125+cu124 compiled for CUDA 12.4
nvidia-smi:
Mon Nov 25 13:43:01 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.12             Driver Version: 535.104.12   CUDA Version: 12.4     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  | 00000000:07:00.0 Off |                    0 |
| N/A   32C    P0              65W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  | 00000000:0A:00.0 Off |                    0 |
| N/A   29C    P0              68W / 400W |     24MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  | 00000000:45:00.0 Off |                    0 |
| N/A   29C    P0              71W / 400W |     24MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  | 00000000:4B:00.0 Off |                    0 |
| N/A   33C    P0              72W / 400W |    427MiB / 81920MiB |      2%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   4  NVIDIA A100-SXM4-80GB          On  | 00000000:84:00.0 Off |                    0 |
| N/A   33C    P0              72W / 400W |    427MiB / 81920MiB |      1%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   5  NVIDIA A100-SXM4-80GB          On  | 00000000:8A:00.0 Off |                    0 |
| N/A   29C    P0              69W / 400W |    427MiB / 81920MiB |      1%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   6  NVIDIA A100-SXM4-80GB          On  | 00000000:C0:00.0 Off |                    0 |
| N/A   28C    P0              69W / 400W |    427MiB / 81920MiB |      1%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   7  NVIDIA A100-SXM4-80GB          On  | 00000000:C3:00.0 Off |                    0 |
| N/A   32C    P0              71W / 400W |     37MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
+---------------------------------------------------------------------------------------+

====================================================================================================
Training DataLoader: total number of tokens: 1100000000 across 11 files
Validation DataLoader: total number of tokens: 100000000 across 1 files
====================================================================================================
step:0/1750 val_loss:10.8258 train_time:0ms step_avg:nanms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 27.70421 | frobenius_norm = 6215.68066 | spectral_norm = 251.86221 | nuclear_norm = 171946.31250
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 16.01282 | spectral_norm = 1.15385 | nuclear_norm = 376.59192
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 15.99122 | spectral_norm = 1.15580 | nuclear_norm = 376.14233
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 16.00250 | spectral_norm = 1.14432 | nuclear_norm = 376.35114
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 32.00616 | spectral_norm = 1.72866 | nuclear_norm = 858.32086
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 15.99930 | spectral_norm = 1.14027 | nuclear_norm = 376.48495
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 16.02324 | spectral_norm = 1.15431 | nuclear_norm = 376.81476
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 16.00224 | spectral_norm = 1.15890 | nuclear_norm = 376.27112
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 31.99170 | spectral_norm = 1.73157 | nuclear_norm = 857.98889
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 15.99156 | spectral_norm = 1.14651 | nuclear_norm = 376.20819
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 15.99995 | spectral_norm = 1.14525 | nuclear_norm = 376.44470
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 15.98006 | spectral_norm = 1.13903 | nuclear_norm = 376.16611
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 31.99701 | spectral_norm = 1.73252 | nuclear_norm = 858.15881
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 15.99982 | spectral_norm = 1.14321 | nuclear_norm = 376.30133
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 15.99028 | spectral_norm = 1.15247 | nuclear_norm = 376.24042
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 16.01178 | spectral_norm = 1.14817 | nuclear_norm = 376.60742
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 31.99301 | spectral_norm = 1.72767 | nuclear_norm = 857.98895
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 16.01112 | spectral_norm = 1.15429 | nuclear_norm = 376.68646
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 16.01033 | spectral_norm = 1.14067 | nuclear_norm = 376.81854
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 16.01506 | spectral_norm = 1.14952 | nuclear_norm = 376.54010
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 32.01192 | spectral_norm = 1.72142 | nuclear_norm = 858.56097
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 15.99023 | spectral_norm = 1.13885 | nuclear_norm = 376.19971
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 16.00481 | spectral_norm = 1.14795 | nuclear_norm = 376.38107
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 15.98547 | spectral_norm = 1.14519 | nuclear_norm = 376.10794
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 31.99067 | spectral_norm = 1.72853 | nuclear_norm = 857.94312
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 15.99174 | spectral_norm = 1.14769 | nuclear_norm = 376.38202
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 15.99778 | spectral_norm = 1.14866 | nuclear_norm = 376.42297
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 16.00172 | spectral_norm = 1.14537 | nuclear_norm = 376.59518
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 32.00183 | spectral_norm = 1.72192 | nuclear_norm = 858.35547
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 16.00488 | spectral_norm = 1.14829 | nuclear_norm = 376.32874
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 16.01148 | spectral_norm = 1.13841 | nuclear_norm = 376.81943
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 16.00895 | spectral_norm = 1.14435 | nuclear_norm = 376.51965
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 32.01246 | spectral_norm = 1.72044 | nuclear_norm = 858.73016
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 15.99489 | spectral_norm = 1.14366 | nuclear_norm = 376.18451
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 15.99921 | spectral_norm = 1.14744 | nuclear_norm = 376.65161
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 16.01240 | spectral_norm = 1.14913 | nuclear_norm = 376.82776
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 32.01029 | spectral_norm = 1.72431 | nuclear_norm = 858.54498
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 16.00258 | spectral_norm = 1.15952 | nuclear_norm = 376.59204
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 15.99804 | spectral_norm = 1.14855 | nuclear_norm = 376.25696
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 15.99959 | spectral_norm = 1.14838 | nuclear_norm = 376.40265
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 31.98501 | spectral_norm = 1.72470 | nuclear_norm = 857.74048
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 15.99946 | spectral_norm = 1.14124 | nuclear_norm = 376.38916
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 16.01002 | spectral_norm = 1.14220 | nuclear_norm = 376.65826
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 16.00179 | spectral_norm = 1.15440 | nuclear_norm = 376.37549
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 31.98894 | spectral_norm = 1.72684 | nuclear_norm = 857.99792
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 15.98582 | spectral_norm = 1.15554 | nuclear_norm = 376.06091
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 16.00780 | spectral_norm = 1.14493 | nuclear_norm = 376.80573
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 15.99751 | spectral_norm = 1.14401 | nuclear_norm = 376.56482
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 32.00476 | spectral_norm = 1.72270 | nuclear_norm = 858.48145
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
===========================================
step:1/1750 train_loss:10.8258 train_time:34565ms step_avg:nanms
step:2/1750 train_loss:10.0764 train_time:43834ms step_avg:nanms
step:3/1750 train_loss:8.3140 train_time:44159ms step_avg:nanms
step:4/1750 train_loss:7.6426 train_time:44489ms step_avg:nanms
step:5/1750 train_loss:7.5603 train_time:44819ms step_avg:nanms
step:6/1750 train_loss:7.0317 train_time:45150ms step_avg:nanms
step:7/1750 train_loss:7.2365 train_time:45480ms step_avg:nanms
step:8/1750 train_loss:6.7337 train_time:45811ms step_avg:nanms
step:9/1750 train_loss:6.6204 train_time:46141ms step_avg:nanms
step:10/1750 train_loss:6.4741 train_time:46471ms step_avg:nanms
step:11/1750 train_loss:6.4594 train_time:249ms step_avg:nanms
step:12/1750 train_loss:6.3606 train_time:579ms step_avg:nanms
step:13/1750 train_loss:6.2911 train_time:910ms step_avg:303.48ms
step:14/1750 train_loss:6.2274 train_time:1241ms step_avg:310.35ms
step:15/1750 train_loss:6.1767 train_time:1573ms step_avg:314.60ms
step:16/1750 train_loss:6.1052 train_time:1904ms step_avg:317.34ms
step:17/1750 train_loss:6.1633 train_time:2234ms step_avg:319.18ms
step:18/1750 train_loss:5.9570 train_time:2565ms step_avg:320.58ms
step:19/1750 train_loss:5.9804 train_time:2897ms step_avg:321.84ms
step:20/1750 train_loss:5.6723 train_time:3228ms step_avg:322.76ms
step:21/1750 train_loss:5.9955 train_time:3558ms step_avg:323.50ms
step:22/1750 train_loss:6.1668 train_time:3890ms step_avg:324.17ms
step:23/1750 train_loss:5.8856 train_time:4222ms step_avg:324.75ms
step:24/1750 train_loss:6.0693 train_time:4554ms step_avg:325.32ms
step:25/1750 train_loss:5.7506 train_time:4886ms step_avg:325.74ms
step:26/1750 train_loss:5.6417 train_time:5217ms step_avg:326.05ms
step:27/1750 train_loss:5.7964 train_time:5548ms step_avg:326.38ms
step:28/1750 train_loss:5.4392 train_time:5880ms step_avg:326.66ms
step:29/1750 train_loss:5.7208 train_time:6212ms step_avg:326.96ms
step:30/1750 train_loss:5.5051 train_time:6543ms step_avg:327.16ms
step:31/1750 train_loss:5.4890 train_time:6875ms step_avg:327.38ms
step:32/1750 train_loss:5.3330 train_time:7207ms step_avg:327.59ms
step:33/1750 train_loss:5.6265 train_time:7539ms step_avg:327.78ms
step:34/1750 train_loss:5.5223 train_time:7870ms step_avg:327.93ms
step:35/1750 train_loss:5.6408 train_time:8202ms step_avg:328.08ms
step:36/1750 train_loss:5.5827 train_time:8534ms step_avg:328.23ms
step:37/1750 train_loss:5.5074 train_time:8866ms step_avg:328.36ms
step:38/1750 train_loss:5.3407 train_time:9197ms step_avg:328.48ms
step:39/1750 train_loss:5.3731 train_time:9531ms step_avg:328.66ms
step:40/1750 train_loss:5.3029 train_time:9864ms step_avg:328.79ms
step:41/1750 train_loss:5.2915 train_time:10196ms step_avg:328.90ms
step:42/1750 train_loss:5.2101 train_time:10528ms step_avg:329.01ms
step:43/1750 train_loss:5.3054 train_time:10863ms step_avg:329.18ms
step:44/1750 train_loss:5.2736 train_time:11194ms step_avg:329.25ms
step:45/1750 train_loss:5.4139 train_time:11526ms step_avg:329.32ms
step:46/1750 train_loss:5.2278 train_time:11858ms step_avg:329.38ms
step:47/1750 train_loss:5.1208 train_time:12190ms step_avg:329.45ms
step:48/1750 train_loss:5.2792 train_time:12522ms step_avg:329.52ms
step:49/1750 train_loss:5.2086 train_time:12854ms step_avg:329.58ms
step:50/1750 train_loss:5.2992 train_time:13185ms step_avg:329.63ms
step:51/1750 train_loss:5.1811 train_time:13521ms step_avg:329.77ms
step:52/1750 train_loss:5.0708 train_time:13853ms step_avg:329.83ms
step:53/1750 train_loss:5.2095 train_time:14185ms step_avg:329.88ms
step:54/1750 train_loss:5.0681 train_time:14517ms step_avg:329.93ms
step:55/1750 train_loss:5.4571 train_time:14847ms step_avg:329.94ms
step:56/1750 train_loss:5.0774 train_time:15181ms step_avg:330.02ms
step:57/1750 train_loss:4.9309 train_time:15513ms step_avg:330.06ms
step:58/1750 train_loss:5.0592 train_time:15846ms step_avg:330.14ms
step:59/1750 train_loss:5.0495 train_time:16178ms step_avg:330.15ms
step:60/1750 train_loss:5.1721 train_time:16510ms step_avg:330.20ms
step:61/1750 train_loss:4.9276 train_time:16842ms step_avg:330.23ms
step:62/1750 train_loss:5.0397 train_time:17174ms step_avg:330.27ms
step:63/1750 train_loss:5.0226 train_time:17507ms step_avg:330.32ms
step:64/1750 train_loss:5.0731 train_time:17839ms step_avg:330.35ms
step:65/1750 train_loss:4.8674 train_time:18171ms step_avg:330.39ms
step:66/1750 train_loss:5.0259 train_time:18504ms step_avg:330.43ms
step:67/1750 train_loss:4.8777 train_time:18837ms step_avg:330.48ms
step:68/1750 train_loss:5.1465 train_time:19169ms step_avg:330.50ms
step:69/1750 train_loss:4.7720 train_time:19502ms step_avg:330.54ms
step:70/1750 train_loss:4.8681 train_time:19835ms step_avg:330.58ms
step:71/1750 train_loss:5.0099 train_time:20168ms step_avg:330.62ms
step:72/1750 train_loss:4.9326 train_time:20502ms step_avg:330.67ms
step:73/1750 train_loss:4.8028 train_time:20835ms step_avg:330.71ms
step:74/1750 train_loss:4.9438 train_time:21168ms step_avg:330.75ms
step:75/1750 train_loss:4.8918 train_time:21501ms step_avg:330.78ms
step:76/1750 train_loss:4.8350 train_time:21834ms step_avg:330.81ms
step:77/1750 train_loss:4.9316 train_time:22167ms step_avg:330.85ms
step:78/1750 train_loss:5.1406 train_time:22502ms step_avg:330.91ms
step:79/1750 train_loss:4.8502 train_time:22835ms step_avg:330.94ms
step:80/1750 train_loss:4.8734 train_time:23169ms step_avg:330.99ms
step:81/1750 train_loss:4.6641 train_time:23502ms step_avg:331.01ms
step:82/1750 train_loss:4.8394 train_time:23836ms step_avg:331.06ms
step:83/1750 train_loss:4.7957 train_time:24170ms step_avg:331.10ms
step:84/1750 train_loss:4.7849 train_time:24503ms step_avg:331.13ms
step:85/1750 train_loss:4.6311 train_time:24836ms step_avg:331.15ms
step:86/1750 train_loss:4.8478 train_time:25171ms step_avg:331.20ms
step:87/1750 train_loss:4.7514 train_time:25505ms step_avg:331.23ms
step:88/1750 train_loss:4.7521 train_time:25838ms step_avg:331.26ms
step:89/1750 train_loss:4.7208 train_time:26171ms step_avg:331.28ms
step:90/1750 train_loss:4.6767 train_time:26505ms step_avg:331.31ms
step:91/1750 train_loss:4.6438 train_time:26838ms step_avg:331.34ms
step:92/1750 train_loss:4.7902 train_time:27174ms step_avg:331.38ms
step:93/1750 train_loss:4.6034 train_time:27507ms step_avg:331.41ms
step:94/1750 train_loss:4.6465 train_time:27840ms step_avg:331.43ms
step:95/1750 train_loss:4.6881 train_time:28174ms step_avg:331.46ms
step:96/1750 train_loss:4.5980 train_time:28508ms step_avg:331.49ms
step:97/1750 train_loss:4.6403 train_time:28842ms step_avg:331.52ms
step:98/1750 train_loss:4.5872 train_time:29178ms step_avg:331.57ms
step:99/1750 train_loss:4.6703 train_time:29512ms step_avg:331.59ms
step:100/1750 train_loss:4.6845 train_time:29848ms step_avg:331.64ms
step:101/1750 train_loss:4.5290 train_time:30180ms step_avg:331.65ms
step:102/1750 train_loss:4.6987 train_time:30514ms step_avg:331.68ms
step:103/1750 train_loss:4.5661 train_time:30849ms step_avg:331.71ms
step:104/1750 train_loss:4.5434 train_time:31183ms step_avg:331.73ms
step:105/1750 train_loss:4.5472 train_time:31518ms step_avg:331.77ms
step:106/1750 train_loss:4.5727 train_time:31854ms step_avg:331.82ms
step:107/1750 train_loss:4.5139 train_time:32188ms step_avg:331.83ms
step:108/1750 train_loss:4.3682 train_time:32522ms step_avg:331.85ms
step:109/1750 train_loss:4.4880 train_time:32856ms step_avg:331.88ms
step:110/1750 train_loss:4.4849 train_time:33191ms step_avg:331.91ms
step:111/1750 train_loss:4.4278 train_time:33524ms step_avg:331.92ms
step:112/1750 train_loss:4.5893 train_time:33858ms step_avg:331.95ms
step:113/1750 train_loss:4.4838 train_time:34195ms step_avg:331.99ms
step:114/1750 train_loss:4.3634 train_time:34529ms step_avg:332.01ms
step:115/1750 train_loss:4.5047 train_time:34863ms step_avg:332.03ms
step:116/1750 train_loss:4.5007 train_time:35196ms step_avg:332.04ms
step:117/1750 train_loss:4.4000 train_time:35531ms step_avg:332.07ms
step:118/1750 train_loss:4.6111 train_time:35864ms step_avg:332.08ms
step:119/1750 train_loss:4.4799 train_time:36200ms step_avg:332.11ms
step:120/1750 train_loss:4.4078 train_time:36534ms step_avg:332.13ms
step:121/1750 train_loss:4.3372 train_time:36869ms step_avg:332.16ms
step:122/1750 train_loss:4.4738 train_time:37204ms step_avg:332.18ms
step:123/1750 train_loss:4.2991 train_time:37538ms step_avg:332.19ms
step:124/1750 train_loss:4.6131 train_time:37872ms step_avg:332.21ms
step:125/1750 train_loss:4.4959 train_time:38207ms step_avg:332.24ms
step:125/1750 val_loss:4.4369 train_time:38290ms step_avg:332.96ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 119.16565 | frobenius_norm = 27165.77734 | spectral_norm = 6863.98145 | nuclear_norm = 660464.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 38.11803 | spectral_norm = 3.35602 | nuclear_norm = 898.25616
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 36.15810 | spectral_norm = 4.75406 | nuclear_norm = 847.71277
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 83.00130 | spectral_norm = 5.63305 | nuclear_norm = 1936.76929
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 84.82391 | spectral_norm = 8.53472 | nuclear_norm = 2019.49548
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 78.44732 | spectral_norm = 5.31503 | nuclear_norm = 2084.86279
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 41.83453 | spectral_norm = 2.80520 | nuclear_norm = 1111.81055
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 35.86736 | spectral_norm = 3.07298 | nuclear_norm = 840.78528
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 35.03846 | spectral_norm = 3.90792 | nuclear_norm = 820.15765
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 89.35966 | spectral_norm = 7.52012 | nuclear_norm = 2056.48291
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 95.60560 | spectral_norm = 8.79492 | nuclear_norm = 2287.72705
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 83.64786 | spectral_norm = 5.51299 | nuclear_norm = 2224.46753
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 44.13990 | spectral_norm = 2.99428 | nuclear_norm = 1172.36694
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 35.27248 | spectral_norm = 2.91367 | nuclear_norm = 818.70941
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 35.50447 | spectral_norm = 3.32337 | nuclear_norm = 825.01440
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 91.17622 | spectral_norm = 7.65303 | nuclear_norm = 2085.52441
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 95.38638 | spectral_norm = 8.95898 | nuclear_norm = 2271.93188
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 85.46786 | spectral_norm = 5.49243 | nuclear_norm = 2271.03906
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 44.21398 | spectral_norm = 3.07117 | nuclear_norm = 1172.43579
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 35.17961 | spectral_norm = 2.90432 | nuclear_norm = 820.20190
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 35.43023 | spectral_norm = 3.11623 | nuclear_norm = 826.61865
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 89.40812 | spectral_norm = 8.14284 | nuclear_norm = 2002.29419
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 92.13445 | spectral_norm = 8.20168 | nuclear_norm = 2178.66870
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 85.23672 | spectral_norm = 5.37107 | nuclear_norm = 2262.47583
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 43.96274 | spectral_norm = 3.09666 | nuclear_norm = 1163.32544
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 34.70782 | spectral_norm = 3.08278 | nuclear_norm = 810.75073
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 35.01482 | spectral_norm = 3.02301 | nuclear_norm = 818.11255
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 92.07183 | spectral_norm = 8.43846 | nuclear_norm = 2034.41077
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 85.93300 | spectral_norm = 8.14980 | nuclear_norm = 2008.94434
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 86.28648 | spectral_norm = 5.49498 | nuclear_norm = 2286.62500
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 44.05511 | spectral_norm = 3.11440 | nuclear_norm = 1162.53918
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 34.17027 | spectral_norm = 2.96887 | nuclear_norm = 797.92517
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 34.54070 | spectral_norm = 3.37003 | nuclear_norm = 806.90161
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 74.81369 | spectral_norm = 7.23361 | nuclear_norm = 1634.95471
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 83.42659 | spectral_norm = 7.74756 | nuclear_norm = 1944.75610
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 83.78675 | spectral_norm = 5.32266 | nuclear_norm = 2216.81177
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 42.77884 | spectral_norm = 3.01099 | nuclear_norm = 1127.51892
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 34.10351 | spectral_norm = 2.85526 | nuclear_norm = 789.93018
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 34.78469 | spectral_norm = 2.83184 | nuclear_norm = 808.96521
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 85.56511 | spectral_norm = 8.13139 | nuclear_norm = 1879.91675
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 86.17467 | spectral_norm = 8.07366 | nuclear_norm = 2034.91943
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 82.23055 | spectral_norm = 5.45176 | nuclear_norm = 2172.00684
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 42.02353 | spectral_norm = 2.95118 | nuclear_norm = 1104.44116
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 34.03199 | spectral_norm = 2.90411 | nuclear_norm = 791.35864
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 34.84081 | spectral_norm = 2.82405 | nuclear_norm = 811.33569
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 96.81496 | spectral_norm = 8.47409 | nuclear_norm = 2150.64990
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 87.18763 | spectral_norm = 8.06132 | nuclear_norm = 2066.45703
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 82.78738 | spectral_norm = 5.54627 | nuclear_norm = 2188.63184
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 42.07603 | spectral_norm = 2.82247 | nuclear_norm = 1107.09863
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 33.99469 | spectral_norm = 2.88483 | nuclear_norm = 787.59882
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 34.71383 | spectral_norm = 2.81207 | nuclear_norm = 805.41156
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 83.75768 | spectral_norm = 7.67161 | nuclear_norm = 1860.06860
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 90.46497 | spectral_norm = 8.25954 | nuclear_norm = 2152.38843
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 82.52231 | spectral_norm = 5.70992 | nuclear_norm = 2180.85889
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 41.80118 | spectral_norm = 2.83972 | nuclear_norm = 1099.56360
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 33.73443 | spectral_norm = 2.86571 | nuclear_norm = 778.39502
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 34.52656 | spectral_norm = 2.93830 | nuclear_norm = 795.94012
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 85.15035 | spectral_norm = 7.48867 | nuclear_norm = 1903.17358
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 93.28736 | spectral_norm = 8.05737 | nuclear_norm = 2236.36865
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 82.41949 | spectral_norm = 5.78322 | nuclear_norm = 2178.81079
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 41.48937 | spectral_norm = 2.82068 | nuclear_norm = 1090.27808
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 33.84645 | spectral_norm = 2.90487 | nuclear_norm = 779.19214
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 34.36617 | spectral_norm = 3.02816 | nuclear_norm = 790.41022
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 89.89639 | spectral_norm = 7.52821 | nuclear_norm = 2043.86731
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 94.75550 | spectral_norm = 7.36612 | nuclear_norm = 2282.62061
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 81.09285 | spectral_norm = 6.00213 | nuclear_norm = 2144.83911
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 40.73385 | spectral_norm = 2.80324 | nuclear_norm = 1068.95312
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 34.24599 | spectral_norm = 2.88652 | nuclear_norm = 794.97882
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 34.43787 | spectral_norm = 3.09601 | nuclear_norm = 798.29944
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 80.24921 | spectral_norm = 7.21866 | nuclear_norm = 1803.47095
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 88.68661 | spectral_norm = 6.83882 | nuclear_norm = 2130.82568
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 81.32851 | spectral_norm = 6.26420 | nuclear_norm = 2151.44214
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 40.12686 | spectral_norm = 2.82658 | nuclear_norm = 1050.83777
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 385.09979 | spectral_norm = 134.31171 | nuclear_norm = 9179.54883
===========================================
step:126/1750 train_loss:4.4457 train_time:38541ms step_avg:332.25ms
step:127/1750 train_loss:4.4575 train_time:38873ms step_avg:332.25ms
step:128/1750 train_loss:4.3994 train_time:39205ms step_avg:332.25ms
step:129/1750 train_loss:4.6984 train_time:39538ms step_avg:332.25ms
step:130/1750 train_loss:4.3908 train_time:39871ms step_avg:332.26ms
step:131/1750 train_loss:4.4228 train_time:40211ms step_avg:332.32ms
step:132/1750 train_loss:4.3538 train_time:40554ms step_avg:332.41ms
step:133/1750 train_loss:4.4445 train_time:40897ms step_avg:332.49ms
step:134/1750 train_loss:4.2533 train_time:41242ms step_avg:332.60ms
step:135/1750 train_loss:4.4370 train_time:41584ms step_avg:332.68ms
step:136/1750 train_loss:4.2155 train_time:41927ms step_avg:332.76ms
step:137/1750 train_loss:4.3701 train_time:42269ms step_avg:332.83ms
step:138/1750 train_loss:4.2851 train_time:42614ms step_avg:332.92ms
step:139/1750 train_loss:4.3948 train_time:42958ms step_avg:333.01ms
step:140/1750 train_loss:4.4858 train_time:43303ms step_avg:333.10ms
step:141/1750 train_loss:4.2998 train_time:43648ms step_avg:333.19ms
step:142/1750 train_loss:4.2996 train_time:43991ms step_avg:333.27ms
step:143/1750 train_loss:4.2511 train_time:44335ms step_avg:333.35ms
step:144/1750 train_loss:4.3532 train_time:44681ms step_avg:333.44ms
step:145/1750 train_loss:4.3041 train_time:45023ms step_avg:333.51ms
step:146/1750 train_loss:4.1763 train_time:45368ms step_avg:333.59ms
step:147/1750 train_loss:4.3293 train_time:45712ms step_avg:333.66ms
step:148/1750 train_loss:4.3644 train_time:46057ms step_avg:333.75ms
step:149/1750 train_loss:4.3024 train_time:46404ms step_avg:333.84ms
step:150/1750 train_loss:4.4393 train_time:46748ms step_avg:333.91ms
step:151/1750 train_loss:4.2645 train_time:47093ms step_avg:333.99ms
step:152/1750 train_loss:4.2693 train_time:47437ms step_avg:334.06ms
step:153/1750 train_loss:4.3793 train_time:47784ms step_avg:334.15ms
step:154/1750 train_loss:4.3695 train_time:48128ms step_avg:334.22ms
step:155/1750 train_loss:4.2679 train_time:48472ms step_avg:334.29ms
step:156/1750 train_loss:4.3458 train_time:48817ms step_avg:334.36ms
step:157/1750 train_loss:4.4019 train_time:49161ms step_avg:334.43ms
step:158/1750 train_loss:4.2448 train_time:49504ms step_avg:334.49ms
step:159/1750 train_loss:4.3158 train_time:49848ms step_avg:334.55ms
step:160/1750 train_loss:4.1364 train_time:50193ms step_avg:334.62ms
step:161/1750 train_loss:4.3579 train_time:50538ms step_avg:334.69ms
step:162/1750 train_loss:4.3613 train_time:50883ms step_avg:334.76ms
step:163/1750 train_loss:4.3405 train_time:51228ms step_avg:334.82ms
step:164/1750 train_loss:4.1958 train_time:51573ms step_avg:334.89ms
step:165/1750 train_loss:4.2771 train_time:51920ms step_avg:334.97ms
step:166/1750 train_loss:4.3505 train_time:52264ms step_avg:335.02ms
step:167/1750 train_loss:4.2142 train_time:52610ms step_avg:335.10ms
step:168/1750 train_loss:4.2812 train_time:52955ms step_avg:335.16ms
step:169/1750 train_loss:4.1543 train_time:53300ms step_avg:335.22ms
step:170/1750 train_loss:4.0327 train_time:53644ms step_avg:335.27ms
step:171/1750 train_loss:4.2113 train_time:53989ms step_avg:335.34ms
step:172/1750 train_loss:4.2208 train_time:54334ms step_avg:335.39ms
step:173/1750 train_loss:4.2657 train_time:54680ms step_avg:335.46ms
step:174/1750 train_loss:4.4287 train_time:55026ms step_avg:335.52ms
step:175/1750 train_loss:4.2478 train_time:55370ms step_avg:335.57ms
step:176/1750 train_loss:4.1083 train_time:55714ms step_avg:335.63ms
step:177/1750 train_loss:4.0831 train_time:56060ms step_avg:335.69ms
step:178/1750 train_loss:4.2100 train_time:56407ms step_avg:335.75ms
step:179/1750 train_loss:4.1385 train_time:56752ms step_avg:335.81ms
step:180/1750 train_loss:4.1227 train_time:57096ms step_avg:335.86ms
step:181/1750 train_loss:4.3026 train_time:57440ms step_avg:335.91ms
step:182/1750 train_loss:4.1810 train_time:57784ms step_avg:335.96ms
step:183/1750 train_loss:4.1431 train_time:58130ms step_avg:336.01ms
step:184/1750 train_loss:4.1443 train_time:58474ms step_avg:336.06ms
step:185/1750 train_loss:4.2095 train_time:58820ms step_avg:336.11ms
step:186/1750 train_loss:4.1791 train_time:59164ms step_avg:336.16ms
step:187/1750 train_loss:4.2509 train_time:59510ms step_avg:336.22ms
step:188/1750 train_loss:4.1815 train_time:59903ms step_avg:336.53ms
step:189/1750 train_loss:4.1237 train_time:60478ms step_avg:337.87ms
step:190/1750 train_loss:4.2209 train_time:60823ms step_avg:337.90ms
step:191/1750 train_loss:4.0963 train_time:61166ms step_avg:337.93ms
step:192/1750 train_loss:4.0528 train_time:61512ms step_avg:337.98ms
step:193/1750 train_loss:4.2731 train_time:61858ms step_avg:338.02ms
step:194/1750 train_loss:4.1930 train_time:62202ms step_avg:338.06ms
step:195/1750 train_loss:4.3696 train_time:62546ms step_avg:338.09ms
step:196/1750 train_loss:4.1860 train_time:62890ms step_avg:338.12ms
step:197/1750 train_loss:4.0528 train_time:63232ms step_avg:338.14ms
step:198/1750 train_loss:4.1752 train_time:63574ms step_avg:338.16ms
step:199/1750 train_loss:4.0357 train_time:63917ms step_avg:338.18ms
step:200/1750 train_loss:4.1228 train_time:64263ms step_avg:338.23ms
step:201/1750 train_loss:4.0175 train_time:64603ms step_avg:338.24ms
step:202/1750 train_loss:4.2582 train_time:64945ms step_avg:338.26ms
step:203/1750 train_loss:4.0652 train_time:65289ms step_avg:338.28ms
step:204/1750 train_loss:4.1920 train_time:65633ms step_avg:338.31ms
step:205/1750 train_loss:4.2482 train_time:65975ms step_avg:338.33ms
step:206/1750 train_loss:3.9425 train_time:66318ms step_avg:338.36ms
step:207/1750 train_loss:4.0793 train_time:66660ms step_avg:338.38ms
step:208/1750 train_loss:4.0829 train_time:67003ms step_avg:338.40ms
step:209/1750 train_loss:4.2279 train_time:67347ms step_avg:338.43ms
step:210/1750 train_loss:4.1744 train_time:67690ms step_avg:338.45ms
step:211/1750 train_loss:4.0584 train_time:68034ms step_avg:338.48ms
step:212/1750 train_loss:4.1160 train_time:68378ms step_avg:338.51ms
step:213/1750 train_loss:4.0379 train_time:68723ms step_avg:338.54ms
step:214/1750 train_loss:4.1095 train_time:69067ms step_avg:338.56ms
step:215/1750 train_loss:3.9491 train_time:69411ms step_avg:338.59ms
step:216/1750 train_loss:4.0027 train_time:69756ms step_avg:338.62ms
step:217/1750 train_loss:4.0031 train_time:70099ms step_avg:338.64ms
step:218/1750 train_loss:4.0793 train_time:70443ms step_avg:338.67ms
step:219/1750 train_loss:4.0728 train_time:70787ms step_avg:338.69ms
step:220/1750 train_loss:4.0728 train_time:71131ms step_avg:338.72ms
step:221/1750 train_loss:4.0974 train_time:71474ms step_avg:338.74ms
step:222/1750 train_loss:3.9870 train_time:71819ms step_avg:338.77ms
step:223/1750 train_loss:3.9892 train_time:72163ms step_avg:338.79ms
step:224/1750 train_loss:4.3001 train_time:72507ms step_avg:338.82ms
step:225/1750 train_loss:3.8884 train_time:72851ms step_avg:338.84ms
step:226/1750 train_loss:3.9811 train_time:73195ms step_avg:338.86ms
step:227/1750 train_loss:3.9747 train_time:73538ms step_avg:338.89ms
step:228/1750 train_loss:4.1464 train_time:73883ms step_avg:338.91ms
step:229/1750 train_loss:3.9377 train_time:74228ms step_avg:338.94ms
step:230/1750 train_loss:4.0568 train_time:74571ms step_avg:338.96ms
step:231/1750 train_loss:3.9041 train_time:74914ms step_avg:338.98ms
step:232/1750 train_loss:3.9833 train_time:75257ms step_avg:338.99ms
step:233/1750 train_loss:4.1013 train_time:75601ms step_avg:339.02ms
step:234/1750 train_loss:4.0356 train_time:75946ms step_avg:339.04ms
step:235/1750 train_loss:3.9112 train_time:76291ms step_avg:339.07ms
step:236/1750 train_loss:4.0979 train_time:76635ms step_avg:339.09ms
step:237/1750 train_loss:4.0920 train_time:76979ms step_avg:339.11ms
step:238/1750 train_loss:3.9391 train_time:77322ms step_avg:339.13ms
step:239/1750 train_loss:4.0799 train_time:77664ms step_avg:339.15ms
step:240/1750 train_loss:4.1139 train_time:78008ms step_avg:339.17ms
step:241/1750 train_loss:3.9731 train_time:78353ms step_avg:339.19ms
step:242/1750 train_loss:4.1398 train_time:78695ms step_avg:339.20ms
step:243/1750 train_loss:4.0204 train_time:79037ms step_avg:339.22ms
step:244/1750 train_loss:4.0831 train_time:79382ms step_avg:339.24ms
step:245/1750 train_loss:4.1454 train_time:79727ms step_avg:339.26ms
step:246/1750 train_loss:4.0630 train_time:80072ms step_avg:339.29ms
step:247/1750 train_loss:4.0130 train_time:80415ms step_avg:339.30ms
step:248/1750 train_loss:4.1144 train_time:80759ms step_avg:339.32ms
step:249/1750 train_loss:3.9166 train_time:81102ms step_avg:339.34ms
step:250/1750 train_loss:3.9836 train_time:81444ms step_avg:339.35ms
step:250/1750 val_loss:4.0230 train_time:81532ms step_avg:339.72ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 157.80009 | frobenius_norm = 36051.26562 | spectral_norm = 7678.76416 | nuclear_norm = 886951.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 58.92308 | spectral_norm = 6.51155 | nuclear_norm = 1381.79370
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 56.67366 | spectral_norm = 8.68083 | nuclear_norm = 1320.49548
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 127.19133 | spectral_norm = 8.31019 | nuclear_norm = 3017.51001
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 118.65681 | spectral_norm = 10.22931 | nuclear_norm = 2794.54736
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 123.65676 | spectral_norm = 8.74935 | nuclear_norm = 3284.16309
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 63.71643 | spectral_norm = 4.58748 | nuclear_norm = 1688.93103
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 57.27066 | spectral_norm = 5.01961 | nuclear_norm = 1341.53296
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 55.48618 | spectral_norm = 6.40801 | nuclear_norm = 1298.35815
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 136.08865 | spectral_norm = 11.25559 | nuclear_norm = 3149.05322
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 138.73314 | spectral_norm = 10.86084 | nuclear_norm = 3267.53223
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 131.54398 | spectral_norm = 8.83252 | nuclear_norm = 3498.07178
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 67.10582 | spectral_norm = 5.07040 | nuclear_norm = 1777.04700
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 56.37365 | spectral_norm = 4.77620 | nuclear_norm = 1290.31592
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 56.37911 | spectral_norm = 5.21048 | nuclear_norm = 1296.40173
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 140.80785 | spectral_norm = 11.26161 | nuclear_norm = 3254.17261
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 143.42705 | spectral_norm = 11.24325 | nuclear_norm = 3395.55737
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 133.47664 | spectral_norm = 8.72935 | nuclear_norm = 3550.14648
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 66.99117 | spectral_norm = 5.23327 | nuclear_norm = 1772.45996
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 56.63189 | spectral_norm = 4.66411 | nuclear_norm = 1316.86609
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 56.59790 | spectral_norm = 5.06423 | nuclear_norm = 1316.27502
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 140.24789 | spectral_norm = 11.71243 | nuclear_norm = 3211.46216
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 140.43648 | spectral_norm = 10.76892 | nuclear_norm = 3314.14404
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 134.36720 | spectral_norm = 9.02887 | nuclear_norm = 3573.64722
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 67.10100 | spectral_norm = 5.24299 | nuclear_norm = 1774.57251
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 56.41665 | spectral_norm = 5.15004 | nuclear_norm = 1316.07715
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 56.20856 | spectral_norm = 4.86759 | nuclear_norm = 1313.45862
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 141.12428 | spectral_norm = 11.86995 | nuclear_norm = 3202.80786
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 135.00542 | spectral_norm = 10.40532 | nuclear_norm = 3175.94727
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 136.43144 | spectral_norm = 9.44077 | nuclear_norm = 3623.94751
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 67.44741 | spectral_norm = 5.24002 | nuclear_norm = 1777.88098
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 55.43504 | spectral_norm = 4.95179 | nuclear_norm = 1294.96826
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 55.18771 | spectral_norm = 5.57818 | nuclear_norm = 1288.85217
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 125.43385 | spectral_norm = 10.46944 | nuclear_norm = 2831.60498
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 131.55974 | spectral_norm = 9.97769 | nuclear_norm = 3056.70166
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 136.90993 | spectral_norm = 8.82137 | nuclear_norm = 3631.25391
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 66.68461 | spectral_norm = 5.18259 | nuclear_norm = 1758.50513
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 55.69416 | spectral_norm = 4.76685 | nuclear_norm = 1286.91382
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 56.06372 | spectral_norm = 4.58145 | nuclear_norm = 1301.91345
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 136.33186 | spectral_norm = 11.93556 | nuclear_norm = 3078.91089
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 139.69069 | spectral_norm = 10.78836 | nuclear_norm = 3292.49902
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 132.80847 | spectral_norm = 9.24367 | nuclear_norm = 3523.43921
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 65.60188 | spectral_norm = 5.36798 | nuclear_norm = 1728.62451
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 56.89036 | spectral_norm = 4.85224 | nuclear_norm = 1326.15552
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 57.17366 | spectral_norm = 4.80454 | nuclear_norm = 1334.88843
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 146.36145 | spectral_norm = 11.82523 | nuclear_norm = 3348.05225
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 137.62192 | spectral_norm = 9.94947 | nuclear_norm = 3257.86084
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 132.81702 | spectral_norm = 9.62320 | nuclear_norm = 3524.04907
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 66.06387 | spectral_norm = 5.20339 | nuclear_norm = 1743.08472
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 56.54789 | spectral_norm = 4.80374 | nuclear_norm = 1311.92444
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 56.78474 | spectral_norm = 4.57955 | nuclear_norm = 1317.54297
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 140.79416 | spectral_norm = 11.40714 | nuclear_norm = 3227.40356
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 142.07260 | spectral_norm = 10.92559 | nuclear_norm = 3371.13672
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 133.45490 | spectral_norm = 9.64860 | nuclear_norm = 3540.36841
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 66.03143 | spectral_norm = 5.15945 | nuclear_norm = 1743.33899
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 56.14406 | spectral_norm = 5.13425 | nuclear_norm = 1296.30469
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 56.54744 | spectral_norm = 4.73712 | nuclear_norm = 1301.42090
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 141.39119 | spectral_norm = 11.76753 | nuclear_norm = 3242.47266
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 147.76903 | spectral_norm = 10.48876 | nuclear_norm = 3529.21777
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 133.36113 | spectral_norm = 9.55121 | nuclear_norm = 3538.42847
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 66.16683 | spectral_norm = 5.33965 | nuclear_norm = 1747.56396
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 56.49557 | spectral_norm = 5.15551 | nuclear_norm = 1294.54102
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 56.50221 | spectral_norm = 5.02484 | nuclear_norm = 1288.82568
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 150.78337 | spectral_norm = 11.51332 | nuclear_norm = 3499.48193
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 152.43460 | spectral_norm = 10.13634 | nuclear_norm = 3636.23242
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 131.44217 | spectral_norm = 9.46784 | nuclear_norm = 3491.08667
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 65.64853 | spectral_norm = 5.31510 | nuclear_norm = 1733.35083
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 57.30069 | spectral_norm = 5.15836 | nuclear_norm = 1329.32605
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 56.59572 | spectral_norm = 5.29744 | nuclear_norm = 1306.44299
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 133.18925 | spectral_norm = 10.71777 | nuclear_norm = 3076.40283
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 144.89131 | spectral_norm = 9.87190 | nuclear_norm = 3450.49512
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 131.87578 | spectral_norm = 9.29935 | nuclear_norm = 3503.41260
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 65.19642 | spectral_norm = 5.35689 | nuclear_norm = 1715.20459
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 550.15839 | spectral_norm = 154.51776 | nuclear_norm = 13705.45312
===========================================
step:251/1750 train_loss:4.0929 train_time:81785ms step_avg:339.36ms
step:252/1750 train_loss:4.1754 train_time:82125ms step_avg:339.36ms
step:253/1750 train_loss:3.9367 train_time:82466ms step_avg:339.36ms
step:254/1750 train_loss:3.8801 train_time:82807ms step_avg:339.37ms
step:255/1750 train_loss:4.0818 train_time:83150ms step_avg:339.39ms
step:256/1750 train_loss:3.9941 train_time:83490ms step_avg:339.39ms
step:257/1750 train_loss:3.9952 train_time:83831ms step_avg:339.40ms
step:258/1750 train_loss:3.9859 train_time:84173ms step_avg:339.41ms
step:259/1750 train_loss:4.0341 train_time:84515ms step_avg:339.42ms
step:260/1750 train_loss:4.0662 train_time:84858ms step_avg:339.43ms
step:261/1750 train_loss:4.0220 train_time:85205ms step_avg:339.46ms
step:262/1750 train_loss:3.9880 train_time:85558ms step_avg:339.51ms
step:263/1750 train_loss:3.8960 train_time:85909ms step_avg:339.56ms
step:264/1750 train_loss:3.9970 train_time:86261ms step_avg:339.61ms
step:265/1750 train_loss:3.8638 train_time:86613ms step_avg:339.66ms
step:266/1750 train_loss:3.9153 train_time:86966ms step_avg:339.71ms
step:267/1750 train_loss:3.9238 train_time:87320ms step_avg:339.77ms
step:268/1750 train_loss:3.9597 train_time:87672ms step_avg:339.82ms
step:269/1750 train_loss:3.8535 train_time:88025ms step_avg:339.86ms
step:270/1750 train_loss:4.0930 train_time:88376ms step_avg:339.91ms
step:271/1750 train_loss:3.9643 train_time:88729ms step_avg:339.96ms
step:272/1750 train_loss:3.9220 train_time:89082ms step_avg:340.01ms
step:273/1750 train_loss:3.9433 train_time:89432ms step_avg:340.05ms
step:274/1750 train_loss:4.0353 train_time:89784ms step_avg:340.09ms
step:275/1750 train_loss:4.0537 train_time:90135ms step_avg:340.13ms
step:276/1750 train_loss:4.2203 train_time:90487ms step_avg:340.17ms
step:277/1750 train_loss:4.0370 train_time:90838ms step_avg:340.22ms
step:278/1750 train_loss:4.0908 train_time:91190ms step_avg:340.26ms
step:279/1750 train_loss:3.9918 train_time:91542ms step_avg:340.30ms
step:280/1750 train_loss:4.1683 train_time:91896ms step_avg:340.36ms
step:281/1750 train_loss:3.9618 train_time:92250ms step_avg:340.41ms
step:282/1750 train_loss:3.9391 train_time:92605ms step_avg:340.46ms
step:283/1750 train_loss:3.9141 train_time:92957ms step_avg:340.50ms
step:284/1750 train_loss:4.0553 train_time:93309ms step_avg:340.54ms
step:285/1750 train_loss:4.0690 train_time:93660ms step_avg:340.58ms
step:286/1750 train_loss:4.0956 train_time:94012ms step_avg:340.62ms
step:287/1750 train_loss:3.9094 train_time:94363ms step_avg:340.66ms
step:288/1750 train_loss:4.0135 train_time:94715ms step_avg:340.70ms
step:289/1750 train_loss:3.8766 train_time:95067ms step_avg:340.74ms
step:290/1750 train_loss:3.8536 train_time:95419ms step_avg:340.78ms
step:291/1750 train_loss:3.9156 train_time:95773ms step_avg:340.83ms
step:292/1750 train_loss:3.8610 train_time:96124ms step_avg:340.86ms
step:293/1750 train_loss:3.9043 train_time:96475ms step_avg:340.90ms
step:294/1750 train_loss:3.9555 train_time:96825ms step_avg:340.93ms
step:295/1750 train_loss:3.8414 train_time:97178ms step_avg:340.97ms
step:296/1750 train_loss:3.8706 train_time:97532ms step_avg:341.02ms
step:297/1750 train_loss:3.8668 train_time:97884ms step_avg:341.06ms
step:298/1750 train_loss:3.9774 train_time:98237ms step_avg:341.10ms
step:299/1750 train_loss:3.8187 train_time:98588ms step_avg:341.13ms
step:300/1750 train_loss:3.9637 train_time:98943ms step_avg:341.18ms
step:301/1750 train_loss:3.9725 train_time:99291ms step_avg:341.21ms
step:302/1750 train_loss:3.9328 train_time:99643ms step_avg:341.24ms
step:303/1750 train_loss:3.9809 train_time:99996ms step_avg:341.28ms
step:304/1750 train_loss:3.9649 train_time:100348ms step_avg:341.32ms
step:305/1750 train_loss:4.4562 train_time:100701ms step_avg:341.36ms
step:306/1750 train_loss:3.9354 train_time:101052ms step_avg:341.39ms
step:307/1750 train_loss:3.8390 train_time:101404ms step_avg:341.43ms
step:308/1750 train_loss:3.9838 train_time:101758ms step_avg:341.47ms
step:309/1750 train_loss:3.8779 train_time:102109ms step_avg:341.50ms
step:310/1750 train_loss:4.0850 train_time:102461ms step_avg:341.54ms
step:311/1750 train_loss:3.9308 train_time:102815ms step_avg:341.58ms
step:312/1750 train_loss:3.8714 train_time:103166ms step_avg:341.61ms
step:313/1750 train_loss:3.9400 train_time:103521ms step_avg:341.65ms
step:314/1750 train_loss:4.0673 train_time:103874ms step_avg:341.69ms
step:315/1750 train_loss:3.9469 train_time:104226ms step_avg:341.72ms
step:316/1750 train_loss:3.8045 train_time:104577ms step_avg:341.76ms
step:317/1750 train_loss:3.8815 train_time:104930ms step_avg:341.79ms
step:318/1750 train_loss:3.9253 train_time:105281ms step_avg:341.82ms
step:319/1750 train_loss:3.8910 train_time:105633ms step_avg:341.85ms
step:320/1750 train_loss:4.0191 train_time:105985ms step_avg:341.89ms
step:321/1750 train_loss:3.9591 train_time:106337ms step_avg:341.92ms
step:322/1750 train_loss:3.9372 train_time:106691ms step_avg:341.96ms
step:323/1750 train_loss:4.0179 train_time:107044ms step_avg:341.99ms
step:324/1750 train_loss:3.9571 train_time:107396ms step_avg:342.03ms
step:325/1750 train_loss:4.0151 train_time:107746ms step_avg:342.05ms
step:326/1750 train_loss:3.8923 train_time:108099ms step_avg:342.09ms
step:327/1750 train_loss:4.3940 train_time:108451ms step_avg:342.12ms
step:328/1750 train_loss:4.0749 train_time:108803ms step_avg:342.15ms
step:329/1750 train_loss:3.8012 train_time:109153ms step_avg:342.17ms
step:330/1750 train_loss:3.7418 train_time:109504ms step_avg:342.20ms
step:331/1750 train_loss:3.9800 train_time:109852ms step_avg:342.22ms
step:332/1750 train_loss:3.9115 train_time:110203ms step_avg:342.25ms
step:333/1750 train_loss:3.8787 train_time:110553ms step_avg:342.27ms
step:334/1750 train_loss:3.8473 train_time:110903ms step_avg:342.29ms
step:335/1750 train_loss:4.0086 train_time:111253ms step_avg:342.32ms
step:336/1750 train_loss:3.9550 train_time:111602ms step_avg:342.34ms
step:337/1750 train_loss:4.4076 train_time:111952ms step_avg:342.36ms
step:338/1750 train_loss:3.9436 train_time:112301ms step_avg:342.38ms
step:339/1750 train_loss:3.8611 train_time:112651ms step_avg:342.40ms
step:340/1750 train_loss:3.9355 train_time:113001ms step_avg:342.43ms
step:341/1750 train_loss:3.8579 train_time:113352ms step_avg:342.45ms
step:342/1750 train_loss:3.8061 train_time:113703ms step_avg:342.48ms
step:343/1750 train_loss:3.8356 train_time:114054ms step_avg:342.51ms
step:344/1750 train_loss:3.9910 train_time:114403ms step_avg:342.52ms
step:345/1750 train_loss:3.8134 train_time:114754ms step_avg:342.55ms
step:346/1750 train_loss:3.7679 train_time:115103ms step_avg:342.57ms
step:347/1750 train_loss:3.7948 train_time:115453ms step_avg:342.59ms
step:348/1750 train_loss:3.8574 train_time:115803ms step_avg:342.61ms
step:349/1750 train_loss:3.8326 train_time:116151ms step_avg:342.63ms
step:350/1750 train_loss:3.5681 train_time:116503ms step_avg:342.66ms
step:351/1750 train_loss:3.8317 train_time:116853ms step_avg:342.68ms
step:352/1750 train_loss:4.2038 train_time:117203ms step_avg:342.70ms
step:353/1750 train_loss:3.6621 train_time:117553ms step_avg:342.72ms
step:354/1750 train_loss:3.9327 train_time:117902ms step_avg:342.74ms
step:355/1750 train_loss:3.7827 train_time:118252ms step_avg:342.76ms
step:356/1750 train_loss:3.8795 train_time:118600ms step_avg:342.77ms
step:357/1750 train_loss:3.7612 train_time:118951ms step_avg:342.80ms
step:358/1750 train_loss:3.8556 train_time:119302ms step_avg:342.82ms
step:359/1750 train_loss:3.7935 train_time:119654ms step_avg:342.85ms
step:360/1750 train_loss:3.4223 train_time:120005ms step_avg:342.87ms
step:361/1750 train_loss:4.0275 train_time:120357ms step_avg:342.90ms
step:362/1750 train_loss:3.9238 train_time:120705ms step_avg:342.91ms
step:363/1750 train_loss:3.8397 train_time:121057ms step_avg:342.94ms
step:364/1750 train_loss:3.7390 train_time:121407ms step_avg:342.96ms
step:365/1750 train_loss:3.9186 train_time:121758ms step_avg:342.98ms
step:366/1750 train_loss:3.8633 train_time:122109ms step_avg:343.00ms
step:367/1750 train_loss:3.8552 train_time:122460ms step_avg:343.03ms
step:368/1750 train_loss:3.8462 train_time:122809ms step_avg:343.04ms
step:369/1750 train_loss:3.7436 train_time:123160ms step_avg:343.06ms
step:370/1750 train_loss:3.8899 train_time:123509ms step_avg:343.08ms
step:371/1750 train_loss:3.7379 train_time:123857ms step_avg:343.10ms
step:372/1750 train_loss:3.6952 train_time:124206ms step_avg:343.11ms
step:373/1750 train_loss:3.9206 train_time:124555ms step_avg:343.13ms
step:374/1750 train_loss:3.8294 train_time:124905ms step_avg:343.15ms
step:375/1750 train_loss:3.8019 train_time:125255ms step_avg:343.16ms
step:375/1750 val_loss:3.8294 train_time:125345ms step_avg:343.41ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 185.56100 | frobenius_norm = 42482.51953 | spectral_norm = 8417.80566 | nuclear_norm = 1051189.12500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 83.87251 | spectral_norm = 10.53658 | nuclear_norm = 1963.60400
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 81.21080 | spectral_norm = 12.94810 | nuclear_norm = 1887.54199
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 165.10567 | spectral_norm = 10.62411 | nuclear_norm = 3943.55713
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 146.66940 | spectral_norm = 12.39090 | nuclear_norm = 3440.93042
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 176.85524 | spectral_norm = 12.72425 | nuclear_norm = 4700.21973
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 90.05098 | spectral_norm = 6.71273 | nuclear_norm = 2385.70068
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 82.28384 | spectral_norm = 7.43944 | nuclear_norm = 1925.26416
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 80.30566 | spectral_norm = 9.06393 | nuclear_norm = 1879.40063
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 168.03809 | spectral_norm = 14.34222 | nuclear_norm = 3872.94043
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 170.84047 | spectral_norm = 12.64860 | nuclear_norm = 4000.24829
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 183.79715 | spectral_norm = 12.42029 | nuclear_norm = 4889.67383
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 92.67954 | spectral_norm = 7.69817 | nuclear_norm = 2448.16016
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 81.23795 | spectral_norm = 7.12146 | nuclear_norm = 1850.33301
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 81.02763 | spectral_norm = 7.23804 | nuclear_norm = 1854.74707
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 175.83342 | spectral_norm = 14.74356 | nuclear_norm = 4044.94653
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 178.83798 | spectral_norm = 13.44330 | nuclear_norm = 4217.33496
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 185.75468 | spectral_norm = 12.53810 | nuclear_norm = 4945.82617
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 92.31230 | spectral_norm = 7.77461 | nuclear_norm = 2438.68066
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 81.90278 | spectral_norm = 7.00081 | nuclear_norm = 1903.02576
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 81.66317 | spectral_norm = 7.19261 | nuclear_norm = 1895.15320
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 178.03221 | spectral_norm = 15.34571 | nuclear_norm = 4073.29614
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 177.53261 | spectral_norm = 12.98821 | nuclear_norm = 4179.73145
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 187.72882 | spectral_norm = 12.84425 | nuclear_norm = 4999.39697
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 92.48174 | spectral_norm = 7.72182 | nuclear_norm = 2442.30103
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 81.82756 | spectral_norm = 7.62259 | nuclear_norm = 1905.30359
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 81.23276 | spectral_norm = 7.21073 | nuclear_norm = 1896.11768
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 179.97763 | spectral_norm = 15.56591 | nuclear_norm = 4087.68311
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 174.47905 | spectral_norm = 13.08205 | nuclear_norm = 4091.75049
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 190.14352 | spectral_norm = 13.84981 | nuclear_norm = 5057.42090
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 92.49235 | spectral_norm = 7.39600 | nuclear_norm = 2432.19482
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 80.64641 | spectral_norm = 7.36226 | nuclear_norm = 1881.85828
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 79.76324 | spectral_norm = 7.93233 | nuclear_norm = 1863.87769
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 161.93344 | spectral_norm = 13.61394 | nuclear_norm = 3647.68115
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 167.54842 | spectral_norm = 13.16938 | nuclear_norm = 3864.59985
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 193.00162 | spectral_norm = 12.86867 | nuclear_norm = 5126.41162
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 93.03551 | spectral_norm = 7.49073 | nuclear_norm = 2449.69434
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 80.56934 | spectral_norm = 6.99306 | nuclear_norm = 1857.83887
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 80.53851 | spectral_norm = 6.83526 | nuclear_norm = 1862.33862
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 176.59993 | spectral_norm = 15.93356 | nuclear_norm = 3984.40015
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 179.90524 | spectral_norm = 14.58965 | nuclear_norm = 4218.06689
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 187.33015 | spectral_norm = 13.17633 | nuclear_norm = 4982.88574
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 91.89227 | spectral_norm = 7.65749 | nuclear_norm = 2424.07520
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 83.48232 | spectral_norm = 7.17869 | nuclear_norm = 1945.43909
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 83.04604 | spectral_norm = 7.37226 | nuclear_norm = 1935.12769
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 187.18851 | spectral_norm = 15.03602 | nuclear_norm = 4286.39062
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 176.09100 | spectral_norm = 13.04681 | nuclear_norm = 4150.86719
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 186.17792 | spectral_norm = 14.20100 | nuclear_norm = 4951.70166
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 93.20004 | spectral_norm = 7.76242 | nuclear_norm = 2463.06055
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 82.65299 | spectral_norm = 7.19701 | nuclear_norm = 1914.12720
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 82.27525 | spectral_norm = 6.87437 | nuclear_norm = 1901.68298
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 183.23068 | spectral_norm = 15.13656 | nuclear_norm = 4198.02490
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 180.27615 | spectral_norm = 14.22279 | nuclear_norm = 4255.94727
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 187.95370 | spectral_norm = 14.37153 | nuclear_norm = 4998.41992
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 93.03722 | spectral_norm = 7.61856 | nuclear_norm = 2460.17285
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 82.25353 | spectral_norm = 7.81738 | nuclear_norm = 1899.38513
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 82.02036 | spectral_norm = 7.09488 | nuclear_norm = 1885.22339
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 182.34354 | spectral_norm = 15.95982 | nuclear_norm = 4170.72754
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 186.04652 | spectral_norm = 13.51928 | nuclear_norm = 4422.90479
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 188.59001 | spectral_norm = 13.77993 | nuclear_norm = 5015.65625
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 92.57508 | spectral_norm = 8.33709 | nuclear_norm = 2448.46143
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 82.62939 | spectral_norm = 7.76836 | nuclear_norm = 1885.65564
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 82.15498 | spectral_norm = 7.44670 | nuclear_norm = 1861.74731
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 191.11621 | spectral_norm = 15.35109 | nuclear_norm = 4425.04395
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 191.95853 | spectral_norm = 13.04140 | nuclear_norm = 4552.76074
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 187.14647 | spectral_norm = 12.93441 | nuclear_norm = 4985.29102
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 91.22633 | spectral_norm = 8.40705 | nuclear_norm = 2413.12842
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 83.95290 | spectral_norm = 7.85175 | nuclear_norm = 1943.05676
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 82.61150 | spectral_norm = 7.85029 | nuclear_norm = 1900.56433
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 169.22658 | spectral_norm = 14.36067 | nuclear_norm = 3904.76440
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 185.46638 | spectral_norm = 13.27831 | nuclear_norm = 4383.50098
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 190.28502 | spectral_norm = 13.60455 | nuclear_norm = 5068.11670
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 93.31414 | spectral_norm = 8.30816 | nuclear_norm = 2460.46924
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 691.39563 | spectral_norm = 165.98917 | nuclear_norm = 17539.65234
===========================================
step:376/1750 train_loss:3.8736 train_time:125603ms step_avg:343.18ms
step:377/1750 train_loss:3.7957 train_time:125996ms step_avg:343.31ms
step:378/1750 train_loss:3.8600 train_time:126427ms step_avg:343.55ms
step:379/1750 train_loss:3.8682 train_time:126916ms step_avg:343.95ms
step:380/1750 train_loss:3.9592 train_time:127263ms step_avg:343.95ms
step:381/1750 train_loss:3.8447 train_time:127609ms step_avg:343.96ms
step:382/1750 train_loss:3.8119 train_time:127958ms step_avg:343.97ms
step:383/1750 train_loss:3.7966 train_time:128306ms step_avg:343.99ms
step:384/1750 train_loss:3.8736 train_time:128654ms step_avg:344.00ms
step:385/1750 train_loss:3.7976 train_time:129003ms step_avg:344.01ms
step:386/1750 train_loss:3.8914 train_time:129350ms step_avg:344.02ms
step:387/1750 train_loss:4.0606 train_time:129700ms step_avg:344.03ms
step:388/1750 train_loss:3.7978 train_time:130048ms step_avg:344.04ms
step:389/1750 train_loss:3.7905 train_time:130396ms step_avg:344.05ms
step:390/1750 train_loss:3.8971 train_time:130751ms step_avg:344.08ms
step:391/1750 train_loss:3.8169 train_time:131108ms step_avg:344.11ms
step:392/1750 train_loss:3.9235 train_time:131463ms step_avg:344.14ms
step:393/1750 train_loss:3.7582 train_time:131819ms step_avg:344.18ms
step:394/1750 train_loss:3.8917 train_time:132177ms step_avg:344.21ms
step:395/1750 train_loss:3.6209 train_time:132535ms step_avg:344.25ms
step:396/1750 train_loss:3.8406 train_time:132894ms step_avg:344.29ms
step:397/1750 train_loss:3.8696 train_time:133253ms step_avg:344.32ms
step:398/1750 train_loss:3.8926 train_time:133610ms step_avg:344.36ms
step:399/1750 train_loss:3.7824 train_time:133965ms step_avg:344.38ms
step:400/1750 train_loss:3.8319 train_time:134326ms step_avg:344.43ms
step:401/1750 train_loss:3.9226 train_time:134681ms step_avg:344.45ms
step:402/1750 train_loss:3.8454 train_time:135040ms step_avg:344.49ms
step:403/1750 train_loss:3.9602 train_time:135397ms step_avg:344.52ms
step:404/1750 train_loss:3.6855 train_time:135753ms step_avg:344.55ms
step:405/1750 train_loss:3.7861 train_time:136111ms step_avg:344.59ms
step:406/1750 train_loss:4.0934 train_time:136467ms step_avg:344.61ms
step:407/1750 train_loss:3.7843 train_time:136825ms step_avg:344.65ms
step:408/1750 train_loss:3.8212 train_time:137179ms step_avg:344.67ms
step:409/1750 train_loss:3.8646 train_time:137538ms step_avg:344.71ms
step:410/1750 train_loss:3.7612 train_time:137894ms step_avg:344.74ms
step:411/1750 train_loss:3.7661 train_time:138251ms step_avg:344.77ms
step:412/1750 train_loss:4.1862 train_time:138611ms step_avg:344.80ms
step:413/1750 train_loss:3.6503 train_time:138967ms step_avg:344.83ms
step:414/1750 train_loss:4.0157 train_time:139323ms step_avg:344.86ms
step:415/1750 train_loss:3.7543 train_time:139678ms step_avg:344.88ms
step:416/1750 train_loss:3.7700 train_time:140035ms step_avg:344.91ms
step:417/1750 train_loss:3.9535 train_time:140395ms step_avg:344.95ms
step:418/1750 train_loss:3.6900 train_time:140753ms step_avg:344.98ms
step:419/1750 train_loss:3.8107 train_time:141108ms step_avg:345.01ms
step:420/1750 train_loss:3.7087 train_time:141469ms step_avg:345.05ms
step:421/1750 train_loss:3.6517 train_time:141827ms step_avg:345.08ms
step:422/1750 train_loss:3.7891 train_time:142182ms step_avg:345.10ms
step:423/1750 train_loss:3.8767 train_time:142541ms step_avg:345.14ms
step:424/1750 train_loss:3.6164 train_time:142898ms step_avg:345.17ms
step:425/1750 train_loss:3.7986 train_time:143256ms step_avg:345.20ms
step:426/1750 train_loss:3.6757 train_time:143614ms step_avg:345.23ms
step:427/1750 train_loss:3.8946 train_time:143972ms step_avg:345.26ms
step:428/1750 train_loss:3.8220 train_time:144329ms step_avg:345.29ms
step:429/1750 train_loss:3.7656 train_time:144687ms step_avg:345.31ms
step:430/1750 train_loss:3.7150 train_time:145043ms step_avg:345.34ms
step:431/1750 train_loss:3.6292 train_time:145400ms step_avg:345.37ms
step:432/1750 train_loss:3.7734 train_time:145757ms step_avg:345.39ms
step:433/1750 train_loss:3.8254 train_time:146114ms step_avg:345.42ms
step:434/1750 train_loss:3.7781 train_time:146472ms step_avg:345.45ms
step:435/1750 train_loss:3.8183 train_time:146829ms step_avg:345.48ms
step:436/1750 train_loss:3.8357 train_time:147187ms step_avg:345.51ms
step:437/1750 train_loss:3.7254 train_time:147545ms step_avg:345.54ms
step:438/1750 train_loss:3.7153 train_time:147903ms step_avg:345.57ms
step:439/1750 train_loss:3.7143 train_time:148261ms step_avg:345.60ms
step:440/1750 train_loss:3.8934 train_time:148616ms step_avg:345.62ms
step:441/1750 train_loss:3.7612 train_time:148974ms step_avg:345.65ms
step:442/1750 train_loss:3.7397 train_time:149331ms step_avg:345.67ms
step:443/1750 train_loss:3.6268 train_time:149687ms step_avg:345.70ms
step:444/1750 train_loss:3.9305 train_time:150044ms step_avg:345.72ms
step:445/1750 train_loss:3.8499 train_time:150402ms step_avg:345.75ms
step:446/1750 train_loss:3.8388 train_time:150761ms step_avg:345.78ms
step:447/1750 train_loss:3.7576 train_time:151120ms step_avg:345.81ms
step:448/1750 train_loss:3.8552 train_time:151481ms step_avg:345.85ms
step:449/1750 train_loss:3.6952 train_time:151840ms step_avg:345.88ms
step:450/1750 train_loss:3.7376 train_time:152197ms step_avg:345.90ms
step:451/1750 train_loss:3.5881 train_time:152555ms step_avg:345.93ms
step:452/1750 train_loss:3.7200 train_time:152912ms step_avg:345.95ms
step:453/1750 train_loss:3.6817 train_time:153268ms step_avg:345.98ms
step:454/1750 train_loss:3.6404 train_time:153627ms step_avg:346.01ms
step:455/1750 train_loss:3.8467 train_time:153985ms step_avg:346.03ms
step:456/1750 train_loss:3.7288 train_time:154340ms step_avg:346.05ms
step:457/1750 train_loss:3.7876 train_time:154696ms step_avg:346.08ms
step:458/1750 train_loss:3.8342 train_time:155050ms step_avg:346.09ms
step:459/1750 train_loss:3.6396 train_time:155409ms step_avg:346.12ms
step:460/1750 train_loss:3.8057 train_time:155763ms step_avg:346.14ms
step:461/1750 train_loss:3.6980 train_time:156120ms step_avg:346.16ms
step:462/1750 train_loss:3.7452 train_time:156477ms step_avg:346.19ms
step:463/1750 train_loss:3.7827 train_time:156831ms step_avg:346.21ms
step:464/1750 train_loss:3.7186 train_time:157186ms step_avg:346.22ms
step:465/1750 train_loss:3.7274 train_time:157541ms step_avg:346.24ms
step:466/1750 train_loss:3.8110 train_time:157896ms step_avg:346.26ms
step:467/1750 train_loss:3.8268 train_time:158254ms step_avg:346.29ms
step:468/1750 train_loss:3.8039 train_time:158608ms step_avg:346.31ms
step:469/1750 train_loss:3.6864 train_time:158963ms step_avg:346.32ms
step:470/1750 train_loss:3.7752 train_time:159318ms step_avg:346.34ms
step:471/1750 train_loss:3.8228 train_time:159672ms step_avg:346.36ms
step:472/1750 train_loss:3.7854 train_time:160029ms step_avg:346.38ms
step:473/1750 train_loss:3.7221 train_time:160383ms step_avg:346.40ms
step:474/1750 train_loss:3.5964 train_time:160738ms step_avg:346.42ms
step:475/1750 train_loss:4.0175 train_time:161092ms step_avg:346.43ms
step:476/1750 train_loss:3.7715 train_time:161448ms step_avg:346.46ms
step:477/1750 train_loss:3.5990 train_time:161804ms step_avg:346.48ms
step:478/1750 train_loss:3.8333 train_time:162160ms step_avg:346.50ms
step:479/1750 train_loss:3.7725 train_time:162518ms step_avg:346.52ms
step:480/1750 train_loss:3.9239 train_time:162873ms step_avg:346.54ms
step:481/1750 train_loss:3.7303 train_time:163229ms step_avg:346.56ms
step:482/1750 train_loss:3.5244 train_time:163586ms step_avg:346.58ms
step:483/1750 train_loss:3.8190 train_time:163942ms step_avg:346.60ms
step:484/1750 train_loss:3.6738 train_time:164300ms step_avg:346.63ms
step:485/1750 train_loss:3.6734 train_time:164655ms step_avg:346.64ms
step:486/1750 train_loss:3.5837 train_time:165010ms step_avg:346.66ms
step:487/1750 train_loss:3.6854 train_time:165364ms step_avg:346.68ms
step:488/1750 train_loss:3.8878 train_time:165719ms step_avg:346.69ms
step:489/1750 train_loss:3.7130 train_time:166076ms step_avg:346.71ms
step:490/1750 train_loss:3.5998 train_time:166432ms step_avg:346.73ms
step:491/1750 train_loss:3.6134 train_time:166787ms step_avg:346.75ms
step:492/1750 train_loss:3.7381 train_time:167143ms step_avg:346.77ms
step:493/1750 train_loss:3.5827 train_time:167501ms step_avg:346.79ms
step:494/1750 train_loss:3.7079 train_time:167858ms step_avg:346.81ms
step:495/1750 train_loss:3.6667 train_time:168216ms step_avg:346.84ms
step:496/1750 train_loss:3.5242 train_time:168572ms step_avg:346.86ms
step:497/1750 train_loss:3.7382 train_time:168927ms step_avg:346.87ms
step:498/1750 train_loss:3.7975 train_time:169282ms step_avg:346.89ms
step:499/1750 train_loss:3.8316 train_time:169639ms step_avg:346.91ms
step:500/1750 train_loss:3.7373 train_time:169999ms step_avg:346.94ms
step:500/1750 val_loss:3.7132 train_time:170089ms step_avg:347.12ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 207.60562 | frobenius_norm = 47612.45312 | spectral_norm = 9078.95508 | nuclear_norm = 1182804.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 105.36577 | spectral_norm = 14.56113 | nuclear_norm = 2456.29712
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 101.67919 | spectral_norm = 16.91759 | nuclear_norm = 2353.52295
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 201.05153 | spectral_norm = 12.82373 | nuclear_norm = 4825.50830
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 171.27980 | spectral_norm = 15.01820 | nuclear_norm = 4008.01367
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 222.18735 | spectral_norm = 16.42264 | nuclear_norm = 5904.73828
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 113.21629 | spectral_norm = 8.91664 | nuclear_norm = 2997.46118
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 103.69394 | spectral_norm = 9.60723 | nuclear_norm = 2417.80176
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 101.41740 | spectral_norm = 11.43610 | nuclear_norm = 2364.39746
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 195.55138 | spectral_norm = 16.95145 | nuclear_norm = 4497.45996
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 199.26753 | spectral_norm = 14.97790 | nuclear_norm = 4655.67578
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 227.68414 | spectral_norm = 15.50004 | nuclear_norm = 6058.73291
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 114.78699 | spectral_norm = 10.29192 | nuclear_norm = 3028.63818
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 101.92969 | spectral_norm = 9.22876 | nuclear_norm = 2302.00342
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 101.61682 | spectral_norm = 9.00835 | nuclear_norm = 2306.09766
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 206.68344 | spectral_norm = 17.99316 | nuclear_norm = 4741.58398
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 210.62135 | spectral_norm = 16.11551 | nuclear_norm = 4957.44678
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 230.15469 | spectral_norm = 16.14269 | nuclear_norm = 6129.07129
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 114.58167 | spectral_norm = 10.17333 | nuclear_norm = 3024.75537
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 103.07903 | spectral_norm = 9.08240 | nuclear_norm = 2382.69165
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 102.64288 | spectral_norm = 9.19124 | nuclear_norm = 2369.60376
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 211.24635 | spectral_norm = 18.53348 | nuclear_norm = 4827.53711
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 210.86203 | spectral_norm = 15.57017 | nuclear_norm = 4960.07715
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 232.58905 | spectral_norm = 16.34245 | nuclear_norm = 6195.61621
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 114.56314 | spectral_norm = 10.02783 | nuclear_norm = 3024.17773
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 102.96981 | spectral_norm = 9.91086 | nuclear_norm = 2383.09619
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 101.82162 | spectral_norm = 9.37373 | nuclear_norm = 2366.11621
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 214.62605 | spectral_norm = 18.63570 | nuclear_norm = 4869.55762
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 209.80043 | spectral_norm = 15.74823 | nuclear_norm = 4917.86670
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 234.89458 | spectral_norm = 17.96038 | nuclear_norm = 6249.69043
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 113.85934 | spectral_norm = 9.51162 | nuclear_norm = 2989.62256
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 101.62463 | spectral_norm = 9.51354 | nuclear_norm = 2358.60205
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 100.34949 | spectral_norm = 10.02529 | nuclear_norm = 2335.68018
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 193.78992 | spectral_norm = 16.65452 | nuclear_norm = 4360.24707
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 199.57214 | spectral_norm = 15.92981 | nuclear_norm = 4591.57666
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 239.18616 | spectral_norm = 16.57332 | nuclear_norm = 6355.54980
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 115.58532 | spectral_norm = 9.90055 | nuclear_norm = 3040.92285
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 100.91336 | spectral_norm = 9.05862 | nuclear_norm = 2311.56689
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 100.67020 | spectral_norm = 8.88368 | nuclear_norm = 2311.82373
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 211.41135 | spectral_norm = 19.09285 | nuclear_norm = 4761.75391
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 214.62390 | spectral_norm = 17.55317 | nuclear_norm = 5022.86719
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 232.98511 | spectral_norm = 16.42551 | nuclear_norm = 6203.63086
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 114.72449 | spectral_norm = 9.74253 | nuclear_norm = 3028.55518
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 105.41711 | spectral_norm = 9.28732 | nuclear_norm = 2444.11816
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 104.47729 | spectral_norm = 9.83216 | nuclear_norm = 2421.83545
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 223.99837 | spectral_norm = 18.68277 | nuclear_norm = 5110.04199
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 211.07205 | spectral_norm = 15.53539 | nuclear_norm = 4969.04297
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 230.96567 | spectral_norm = 18.15138 | nuclear_norm = 6146.14355
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 116.85717 | spectral_norm = 10.00009 | nuclear_norm = 3091.45068
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 104.21900 | spectral_norm = 9.36731 | nuclear_norm = 2396.75391
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 103.37466 | spectral_norm = 9.00939 | nuclear_norm = 2371.13232
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 219.01878 | spectral_norm = 18.27690 | nuclear_norm = 5003.97656
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 214.43448 | spectral_norm = 17.10066 | nuclear_norm = 5050.86328
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 233.54366 | spectral_norm = 18.57010 | nuclear_norm = 6214.25342
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 116.85291 | spectral_norm = 9.91954 | nuclear_norm = 3094.19238
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 104.14359 | spectral_norm = 10.34499 | nuclear_norm = 2391.15674
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 103.29553 | spectral_norm = 9.20945 | nuclear_norm = 2359.21777
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 217.11267 | spectral_norm = 19.98029 | nuclear_norm = 4944.70947
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 219.22095 | spectral_norm = 16.05395 | nuclear_norm = 5199.73926
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 234.38432 | spectral_norm = 17.92068 | nuclear_norm = 6236.92969
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 115.47990 | spectral_norm = 11.17667 | nuclear_norm = 3056.87476
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 104.37794 | spectral_norm = 10.25783 | nuclear_norm = 2359.48877
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 103.89976 | spectral_norm = 9.77027 | nuclear_norm = 2328.30566
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 225.25258 | spectral_norm = 19.22788 | nuclear_norm = 5199.42383
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 226.23210 | spectral_norm = 15.40822 | nuclear_norm = 5347.90723
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 234.62654 | spectral_norm = 16.20137 | nuclear_norm = 6256.05078
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 113.06120 | spectral_norm = 11.54391 | nuclear_norm = 2991.97192
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 105.88612 | spectral_norm = 10.36986 | nuclear_norm = 2433.95166
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 104.33656 | spectral_norm = 10.26099 | nuclear_norm = 2381.55225
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 199.48943 | spectral_norm = 17.80087 | nuclear_norm = 4591.44629
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 219.86508 | spectral_norm = 16.15326 | nuclear_norm = 5175.29785
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 239.91592 | spectral_norm = 18.01848 | nuclear_norm = 6390.55518
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 115.93059 | spectral_norm = 11.51404 | nuclear_norm = 3055.59302
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 811.86121 | spectral_norm = 172.87454 | nuclear_norm = 20818.48047
===========================================
step:501/1750 train_loss:3.8118 train_time:170348ms step_avg:346.94ms
step:502/1750 train_loss:3.7558 train_time:170698ms step_avg:346.95ms
step:503/1750 train_loss:3.7840 train_time:171052ms step_avg:346.96ms
step:504/1750 train_loss:3.7395 train_time:171404ms step_avg:346.97ms
step:505/1750 train_loss:3.8089 train_time:171756ms step_avg:346.98ms
step:506/1750 train_loss:3.6579 train_time:172108ms step_avg:346.99ms
step:507/1750 train_loss:3.7716 train_time:172461ms step_avg:347.00ms
step:508/1750 train_loss:3.8385 train_time:172817ms step_avg:347.02ms
step:509/1750 train_loss:3.7801 train_time:173169ms step_avg:347.03ms
step:510/1750 train_loss:3.5877 train_time:173520ms step_avg:347.04ms
step:511/1750 train_loss:3.7870 train_time:173876ms step_avg:347.06ms
step:512/1750 train_loss:3.7397 train_time:174234ms step_avg:347.08ms
step:513/1750 train_loss:3.6799 train_time:174589ms step_avg:347.10ms
step:514/1750 train_loss:3.8145 train_time:174944ms step_avg:347.11ms
step:515/1750 train_loss:3.7468 train_time:175299ms step_avg:347.13ms
step:516/1750 train_loss:4.0859 train_time:175655ms step_avg:347.14ms
step:517/1750 train_loss:3.6961 train_time:176010ms step_avg:347.16ms
step:518/1750 train_loss:3.7861 train_time:176367ms step_avg:347.18ms
step:519/1750 train_loss:3.6708 train_time:176721ms step_avg:347.19ms
step:520/1750 train_loss:3.6908 train_time:177082ms step_avg:347.22ms
step:521/1750 train_loss:3.6685 train_time:177443ms step_avg:347.25ms
step:522/1750 train_loss:3.6601 train_time:177809ms step_avg:347.28ms
step:523/1750 train_loss:4.2902 train_time:178171ms step_avg:347.31ms
step:524/1750 train_loss:3.7430 train_time:178531ms step_avg:347.34ms
step:525/1750 train_loss:3.6836 train_time:178893ms step_avg:347.36ms
step:526/1750 train_loss:3.7074 train_time:179255ms step_avg:347.39ms
step:527/1750 train_loss:3.6704 train_time:179618ms step_avg:347.42ms
step:528/1750 train_loss:3.6425 train_time:179981ms step_avg:347.45ms
step:529/1750 train_loss:3.8555 train_time:180344ms step_avg:347.48ms
step:530/1750 train_loss:3.6480 train_time:180709ms step_avg:347.52ms
step:531/1750 train_loss:3.9302 train_time:181073ms step_avg:347.55ms
step:532/1750 train_loss:3.7411 train_time:181433ms step_avg:347.57ms
step:533/1750 train_loss:3.6655 train_time:181795ms step_avg:347.60ms
step:534/1750 train_loss:3.6826 train_time:182156ms step_avg:347.63ms
step:535/1750 train_loss:3.6162 train_time:182519ms step_avg:347.65ms
step:536/1750 train_loss:3.7631 train_time:182883ms step_avg:347.69ms
step:537/1750 train_loss:3.7353 train_time:183247ms step_avg:347.72ms
step:538/1750 train_loss:3.6301 train_time:183614ms step_avg:347.75ms
step:539/1750 train_loss:4.1151 train_time:183981ms step_avg:347.79ms
step:540/1750 train_loss:3.6828 train_time:184345ms step_avg:347.82ms
step:541/1750 train_loss:3.7958 train_time:184705ms step_avg:347.84ms
step:542/1750 train_loss:3.6040 train_time:185068ms step_avg:347.87ms
step:543/1750 train_loss:3.5904 train_time:185431ms step_avg:347.90ms
step:544/1750 train_loss:3.6456 train_time:185792ms step_avg:347.93ms
step:545/1750 train_loss:3.5982 train_time:186156ms step_avg:347.96ms
step:546/1750 train_loss:3.6295 train_time:186520ms step_avg:347.98ms
step:547/1750 train_loss:3.6557 train_time:186882ms step_avg:348.01ms
step:548/1750 train_loss:3.6254 train_time:187246ms step_avg:348.04ms
step:549/1750 train_loss:3.7316 train_time:187609ms step_avg:348.07ms
step:550/1750 train_loss:3.6279 train_time:187972ms step_avg:348.10ms
step:551/1750 train_loss:3.6395 train_time:188332ms step_avg:348.12ms
step:552/1750 train_loss:3.9599 train_time:188694ms step_avg:348.14ms
step:553/1750 train_loss:3.7642 train_time:189056ms step_avg:348.17ms
step:554/1750 train_loss:3.7211 train_time:189416ms step_avg:348.19ms
step:555/1750 train_loss:3.6380 train_time:189779ms step_avg:348.22ms
step:556/1750 train_loss:3.7040 train_time:190139ms step_avg:348.24ms
step:557/1750 train_loss:3.3245 train_time:190502ms step_avg:348.27ms
step:558/1750 train_loss:3.6175 train_time:190864ms step_avg:348.29ms
step:559/1750 train_loss:3.6601 train_time:191225ms step_avg:348.31ms
step:560/1750 train_loss:3.6965 train_time:191587ms step_avg:348.34ms
step:561/1750 train_loss:3.6128 train_time:191947ms step_avg:348.36ms
step:562/1750 train_loss:3.5642 train_time:192311ms step_avg:348.39ms
step:563/1750 train_loss:3.7672 train_time:192676ms step_avg:348.42ms
step:564/1750 train_loss:3.5880 train_time:193042ms step_avg:348.45ms
step:565/1750 train_loss:3.6923 train_time:193402ms step_avg:348.47ms
step:566/1750 train_loss:3.6347 train_time:193815ms step_avg:348.59ms
step:567/1750 train_loss:3.6156 train_time:194322ms step_avg:348.87ms
step:568/1750 train_loss:3.7016 train_time:194688ms step_avg:348.90ms
step:569/1750 train_loss:3.6583 train_time:195195ms step_avg:349.19ms
step:570/1750 train_loss:3.6992 train_time:195553ms step_avg:349.20ms
step:571/1750 train_loss:3.7704 train_time:195912ms step_avg:349.22ms
step:572/1750 train_loss:3.7346 train_time:196273ms step_avg:349.24ms
step:573/1750 train_loss:3.7389 train_time:196638ms step_avg:349.27ms
step:574/1750 train_loss:3.7863 train_time:197006ms step_avg:349.30ms
step:575/1750 train_loss:3.7368 train_time:197368ms step_avg:349.32ms
step:576/1750 train_loss:3.7673 train_time:197728ms step_avg:349.34ms
step:577/1750 train_loss:3.6801 train_time:198090ms step_avg:349.37ms
step:578/1750 train_loss:3.6844 train_time:198452ms step_avg:349.39ms
step:579/1750 train_loss:3.6801 train_time:198812ms step_avg:349.41ms
step:580/1750 train_loss:3.6007 train_time:199175ms step_avg:349.43ms
step:581/1750 train_loss:3.6442 train_time:199538ms step_avg:349.45ms
step:582/1750 train_loss:3.8579 train_time:199901ms step_avg:349.48ms
step:583/1750 train_loss:3.6375 train_time:200264ms step_avg:349.50ms
step:584/1750 train_loss:3.5976 train_time:200628ms step_avg:349.53ms
step:585/1750 train_loss:3.7941 train_time:200989ms step_avg:349.55ms
step:586/1750 train_loss:3.5260 train_time:201350ms step_avg:349.57ms
step:587/1750 train_loss:3.6803 train_time:201711ms step_avg:349.59ms
step:588/1750 train_loss:3.6565 train_time:202073ms step_avg:349.61ms
step:589/1750 train_loss:4.0035 train_time:202435ms step_avg:349.63ms
step:590/1750 train_loss:3.7870 train_time:202794ms step_avg:349.65ms
step:591/1750 train_loss:3.5249 train_time:203155ms step_avg:349.66ms
step:592/1750 train_loss:3.5448 train_time:203518ms step_avg:349.69ms
step:593/1750 train_loss:3.5042 train_time:203881ms step_avg:349.71ms
step:594/1750 train_loss:3.5690 train_time:204243ms step_avg:349.73ms
step:595/1750 train_loss:3.9370 train_time:204604ms step_avg:349.75ms
step:596/1750 train_loss:3.6529 train_time:204966ms step_avg:349.77ms
step:597/1750 train_loss:3.5943 train_time:205325ms step_avg:349.79ms
step:598/1750 train_loss:3.6732 train_time:205685ms step_avg:349.80ms
step:599/1750 train_loss:3.4792 train_time:206045ms step_avg:349.82ms
step:600/1750 train_loss:3.6078 train_time:206409ms step_avg:349.85ms
step:601/1750 train_loss:3.6523 train_time:206769ms step_avg:349.86ms
step:602/1750 train_loss:3.6731 train_time:207131ms step_avg:349.88ms
step:603/1750 train_loss:3.7950 train_time:207494ms step_avg:349.90ms
step:604/1750 train_loss:3.6182 train_time:207855ms step_avg:349.92ms
step:605/1750 train_loss:3.6230 train_time:208213ms step_avg:349.94ms
step:606/1750 train_loss:3.5851 train_time:208575ms step_avg:349.96ms
step:607/1750 train_loss:3.8472 train_time:208936ms step_avg:349.98ms
step:608/1750 train_loss:3.6481 train_time:209296ms step_avg:349.99ms
step:609/1750 train_loss:3.6228 train_time:209658ms step_avg:350.01ms
step:610/1750 train_loss:3.7162 train_time:210014ms step_avg:350.02ms
step:611/1750 train_loss:3.6149 train_time:210373ms step_avg:350.04ms
step:612/1750 train_loss:3.5750 train_time:210736ms step_avg:350.06ms
step:613/1750 train_loss:3.7713 train_time:211098ms step_avg:350.08ms
step:614/1750 train_loss:3.7121 train_time:211461ms step_avg:350.10ms
step:615/1750 train_loss:3.6982 train_time:211822ms step_avg:350.12ms
step:616/1750 train_loss:3.6456 train_time:212183ms step_avg:350.14ms
step:617/1750 train_loss:3.5557 train_time:212544ms step_avg:350.15ms
step:618/1750 train_loss:3.7037 train_time:212904ms step_avg:350.17ms
step:619/1750 train_loss:3.5693 train_time:213265ms step_avg:350.19ms
step:620/1750 train_loss:3.5871 train_time:213627ms step_avg:350.21ms
step:621/1750 train_loss:3.9327 train_time:213992ms step_avg:350.23ms
step:622/1750 train_loss:3.5806 train_time:214356ms step_avg:350.25ms
step:623/1750 train_loss:3.6225 train_time:214720ms step_avg:350.28ms
step:624/1750 train_loss:3.7033 train_time:215079ms step_avg:350.29ms
step:625/1750 train_loss:3.7225 train_time:215440ms step_avg:350.31ms
step:625/1750 val_loss:3.6338 train_time:215537ms step_avg:350.47ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 226.10313 | frobenius_norm = 51929.96094 | spectral_norm = 9661.65137 | nuclear_norm = 1294280.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 122.84206 | spectral_norm = 18.19006 | nuclear_norm = 2855.36133
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 118.43459 | spectral_norm = 20.76362 | nuclear_norm = 2731.66748
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 232.38062 | spectral_norm = 14.81621 | nuclear_norm = 5597.00049
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 191.40582 | spectral_norm = 17.40772 | nuclear_norm = 4471.35742
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 259.54974 | spectral_norm = 19.63433 | nuclear_norm = 6898.02344
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 132.42320 | spectral_norm = 10.94446 | nuclear_norm = 3503.25537
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 121.24181 | spectral_norm = 11.41973 | nuclear_norm = 2816.15820
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 118.56828 | spectral_norm = 13.36896 | nuclear_norm = 2755.11841
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 219.50255 | spectral_norm = 19.24338 | nuclear_norm = 5041.49170
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 223.83572 | spectral_norm = 17.01257 | nuclear_norm = 5226.53516
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 263.70224 | spectral_norm = 18.22613 | nuclear_norm = 7017.81494
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 132.78450 | spectral_norm = 12.53356 | nuclear_norm = 3499.34668
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 118.80911 | spectral_norm = 10.92021 | nuclear_norm = 2664.00391
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 118.17893 | spectral_norm = 10.44710 | nuclear_norm = 2664.06226
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 234.31163 | spectral_norm = 20.94508 | nuclear_norm = 5363.54004
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 238.88737 | spectral_norm = 18.56311 | nuclear_norm = 5616.17041
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 266.62448 | spectral_norm = 19.48487 | nuclear_norm = 7099.64111
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 133.08397 | spectral_norm = 12.29952 | nuclear_norm = 3512.27417
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 120.17545 | spectral_norm = 10.97200 | nuclear_norm = 2763.99048
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 119.41419 | spectral_norm = 10.87495 | nuclear_norm = 2743.53174
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 241.15359 | spectral_norm = 21.38771 | nuclear_norm = 5504.13086
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 240.73434 | spectral_norm = 17.80514 | nuclear_norm = 5661.39258
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 269.34125 | spectral_norm = 19.51614 | nuclear_norm = 7176.57617
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 132.90977 | spectral_norm = 12.01097 | nuclear_norm = 3508.49414
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 120.20298 | spectral_norm = 11.94124 | nuclear_norm = 2768.89185
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 118.53271 | spectral_norm = 11.17854 | nuclear_norm = 2746.46729
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 246.03450 | spectral_norm = 21.21536 | nuclear_norm = 5580.84375
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 241.28192 | spectral_norm = 18.02811 | nuclear_norm = 5655.51270
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 271.51425 | spectral_norm = 21.48712 | nuclear_norm = 7225.63721
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 131.58714 | spectral_norm = 11.38370 | nuclear_norm = 3452.00684
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 118.52715 | spectral_norm = 11.31052 | nuclear_norm = 2737.47070
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 116.98495 | spectral_norm = 11.87321 | nuclear_norm = 2713.76831
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 222.37671 | spectral_norm = 19.21772 | nuclear_norm = 5003.90039
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 228.37383 | spectral_norm = 18.17601 | nuclear_norm = 5251.67041
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 276.73010 | spectral_norm = 19.89442 | nuclear_norm = 7353.57715
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 134.03848 | spectral_norm = 12.18127 | nuclear_norm = 3523.90308
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 117.29608 | spectral_norm = 10.86514 | nuclear_norm = 2670.20459
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 116.78052 | spectral_norm = 10.60130 | nuclear_norm = 2665.26318
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 242.14850 | spectral_norm = 21.86546 | nuclear_norm = 5449.06348
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 244.67921 | spectral_norm = 20.01027 | nuclear_norm = 5720.43262
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 270.93582 | spectral_norm = 18.98480 | nuclear_norm = 7217.01562
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 133.57291 | spectral_norm = 12.17939 | nuclear_norm = 3526.22119
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 123.07938 | spectral_norm = 11.16768 | nuclear_norm = 2838.67725
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 121.79683 | spectral_norm = 11.94930 | nuclear_norm = 2807.66382
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 256.47864 | spectral_norm = 21.98059 | nuclear_norm = 5825.25488
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 242.04333 | spectral_norm = 18.09929 | nuclear_norm = 5694.13428
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 267.76306 | spectral_norm = 21.41098 | nuclear_norm = 7127.69141
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 136.38644 | spectral_norm = 11.86751 | nuclear_norm = 3609.40479
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 121.32018 | spectral_norm = 11.22800 | nuclear_norm = 2772.87427
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 120.39610 | spectral_norm = 10.76311 | nuclear_norm = 2745.21094
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 250.29758 | spectral_norm = 20.96834 | nuclear_norm = 5703.28857
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 244.51582 | spectral_norm = 19.67119 | nuclear_norm = 5747.73242
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 271.46341 | spectral_norm = 22.23261 | nuclear_norm = 7224.26855
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 136.70546 | spectral_norm = 12.04709 | nuclear_norm = 3621.37476
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 121.87585 | spectral_norm = 12.43767 | nuclear_norm = 2783.34521
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 120.50815 | spectral_norm = 10.99298 | nuclear_norm = 2737.02710
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 247.52260 | spectral_norm = 23.88860 | nuclear_norm = 5612.54004
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 248.41319 | spectral_norm = 18.37120 | nuclear_norm = 5882.48242
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 272.82236 | spectral_norm = 21.55559 | nuclear_norm = 7259.83105
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 134.64851 | spectral_norm = 13.73460 | nuclear_norm = 3565.21387
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 121.98750 | spectral_norm = 12.60740 | nuclear_norm = 2735.46265
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 121.60281 | spectral_norm = 11.83870 | nuclear_norm = 2698.15161
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 255.11034 | spectral_norm = 22.73330 | nuclear_norm = 5874.14551
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 256.64566 | spectral_norm = 17.63363 | nuclear_norm = 6054.83594
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 274.14587 | spectral_norm = 19.33263 | nuclear_norm = 7313.41211
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 131.05716 | spectral_norm = 14.39811 | nuclear_norm = 3468.31665
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 123.62051 | spectral_norm = 12.66765 | nuclear_norm = 2822.79639
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 121.91193 | spectral_norm = 12.49472 | nuclear_norm = 2764.89600
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 226.07974 | spectral_norm = 20.74658 | nuclear_norm = 5192.37598
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 250.18814 | spectral_norm = 18.45742 | nuclear_norm = 5874.72314
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 281.37659 | spectral_norm = 21.61809 | nuclear_norm = 7492.66846
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 134.36020 | spectral_norm = 14.46608 | nuclear_norm = 3538.36768
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 917.01251 | spectral_norm = 176.82773 | nuclear_norm = 23688.10938
===========================================
step:626/1750 train_loss:3.7551 train_time:215799ms step_avg:350.32ms
step:627/1750 train_loss:3.7296 train_time:216155ms step_avg:350.33ms
step:628/1750 train_loss:3.7773 train_time:216510ms step_avg:350.34ms
step:629/1750 train_loss:3.6040 train_time:216868ms step_avg:350.35ms
step:630/1750 train_loss:3.7315 train_time:217226ms step_avg:350.36ms
step:631/1750 train_loss:3.7541 train_time:217583ms step_avg:350.37ms
step:632/1750 train_loss:3.6681 train_time:217943ms step_avg:350.39ms
step:633/1750 train_loss:3.6132 train_time:218304ms step_avg:350.41ms
step:634/1750 train_loss:3.7098 train_time:218664ms step_avg:350.42ms
step:635/1750 train_loss:3.9591 train_time:219022ms step_avg:350.44ms
step:636/1750 train_loss:3.5526 train_time:219382ms step_avg:350.45ms
step:637/1750 train_loss:3.3632 train_time:219744ms step_avg:350.47ms
step:638/1750 train_loss:3.5999 train_time:220103ms step_avg:350.48ms
step:639/1750 train_loss:3.6454 train_time:220462ms step_avg:350.50ms
step:640/1750 train_loss:3.5754 train_time:220822ms step_avg:350.51ms
step:641/1750 train_loss:3.5905 train_time:221181ms step_avg:350.53ms
step:642/1750 train_loss:3.6441 train_time:221540ms step_avg:350.54ms
step:643/1750 train_loss:3.6183 train_time:221900ms step_avg:350.55ms
step:644/1750 train_loss:3.5677 train_time:222260ms step_avg:350.57ms
step:645/1750 train_loss:3.7918 train_time:222623ms step_avg:350.59ms
step:646/1750 train_loss:3.6874 train_time:222984ms step_avg:350.60ms
step:647/1750 train_loss:3.6795 train_time:223345ms step_avg:350.62ms
step:648/1750 train_loss:3.7256 train_time:223711ms step_avg:350.64ms
step:649/1750 train_loss:3.7729 train_time:224070ms step_avg:350.66ms
step:650/1750 train_loss:3.6269 train_time:224435ms step_avg:350.68ms
step:651/1750 train_loss:3.7808 train_time:224804ms step_avg:350.71ms
step:652/1750 train_loss:3.5920 train_time:225171ms step_avg:350.73ms
step:653/1750 train_loss:3.6685 train_time:225539ms step_avg:350.76ms
step:654/1750 train_loss:3.4376 train_time:225907ms step_avg:350.79ms
step:655/1750 train_loss:3.5910 train_time:226270ms step_avg:350.81ms
step:656/1750 train_loss:3.5836 train_time:226633ms step_avg:350.83ms
step:657/1750 train_loss:3.5116 train_time:226999ms step_avg:350.85ms
step:658/1750 train_loss:3.7010 train_time:227366ms step_avg:350.87ms
step:659/1750 train_loss:3.5969 train_time:227730ms step_avg:350.89ms
step:660/1750 train_loss:3.6899 train_time:228096ms step_avg:350.92ms
step:661/1750 train_loss:3.7582 train_time:228466ms step_avg:350.95ms
step:662/1750 train_loss:3.6776 train_time:228831ms step_avg:350.97ms
step:663/1750 train_loss:3.5605 train_time:229197ms step_avg:350.99ms
step:664/1750 train_loss:3.6222 train_time:229566ms step_avg:351.02ms
step:665/1750 train_loss:3.5030 train_time:229933ms step_avg:351.04ms
step:666/1750 train_loss:3.7947 train_time:230300ms step_avg:351.07ms
step:667/1750 train_loss:3.6180 train_time:230667ms step_avg:351.09ms
step:668/1750 train_loss:3.6543 train_time:231039ms step_avg:351.12ms
step:669/1750 train_loss:3.4940 train_time:231410ms step_avg:351.15ms
step:670/1750 train_loss:3.6128 train_time:231776ms step_avg:351.18ms
step:671/1750 train_loss:3.5701 train_time:232145ms step_avg:351.20ms
step:672/1750 train_loss:3.5806 train_time:232514ms step_avg:351.23ms
step:673/1750 train_loss:3.8552 train_time:232880ms step_avg:351.25ms
step:674/1750 train_loss:3.6342 train_time:233247ms step_avg:351.28ms
step:675/1750 train_loss:3.7265 train_time:233614ms step_avg:351.30ms
step:676/1750 train_loss:3.5014 train_time:233981ms step_avg:351.32ms
step:677/1750 train_loss:3.6127 train_time:234348ms step_avg:351.35ms
step:678/1750 train_loss:3.5627 train_time:234717ms step_avg:351.37ms
step:679/1750 train_loss:3.6865 train_time:235086ms step_avg:351.40ms
step:680/1750 train_loss:3.5964 train_time:235454ms step_avg:351.42ms
step:681/1750 train_loss:3.6239 train_time:235822ms step_avg:351.45ms
step:682/1750 train_loss:3.6812 train_time:236195ms step_avg:351.48ms
step:683/1750 train_loss:3.7457 train_time:236561ms step_avg:351.50ms
step:684/1750 train_loss:3.6588 train_time:236925ms step_avg:351.52ms
step:685/1750 train_loss:3.7033 train_time:237292ms step_avg:351.54ms
step:686/1750 train_loss:3.6487 train_time:237659ms step_avg:351.57ms
step:687/1750 train_loss:3.6826 train_time:238022ms step_avg:351.58ms
step:688/1750 train_loss:3.2006 train_time:238395ms step_avg:351.62ms
step:689/1750 train_loss:3.4113 train_time:238768ms step_avg:351.65ms
step:690/1750 train_loss:3.5611 train_time:239140ms step_avg:351.68ms
step:691/1750 train_loss:3.4318 train_time:239505ms step_avg:351.70ms
step:692/1750 train_loss:3.6404 train_time:239872ms step_avg:351.72ms
step:693/1750 train_loss:3.6634 train_time:240241ms step_avg:351.74ms
step:694/1750 train_loss:3.5621 train_time:240609ms step_avg:351.77ms
step:695/1750 train_loss:3.5469 train_time:240971ms step_avg:351.78ms
step:696/1750 train_loss:3.8688 train_time:241336ms step_avg:351.80ms
step:697/1750 train_loss:3.5995 train_time:241702ms step_avg:351.82ms
step:698/1750 train_loss:3.6581 train_time:242068ms step_avg:351.84ms
step:699/1750 train_loss:3.7784 train_time:242438ms step_avg:351.87ms
step:700/1750 train_loss:3.5799 train_time:242809ms step_avg:351.90ms
step:701/1750 train_loss:3.5572 train_time:243174ms step_avg:351.92ms
step:702/1750 train_loss:3.5304 train_time:243543ms step_avg:351.94ms
step:703/1750 train_loss:3.5111 train_time:243910ms step_avg:351.96ms
step:704/1750 train_loss:3.5840 train_time:244278ms step_avg:351.99ms
step:705/1750 train_loss:3.5728 train_time:244652ms step_avg:352.02ms
step:706/1750 train_loss:3.5969 train_time:245027ms step_avg:352.05ms
step:707/1750 train_loss:3.6617 train_time:245394ms step_avg:352.07ms
step:708/1750 train_loss:3.6115 train_time:245758ms step_avg:352.09ms
step:709/1750 train_loss:3.5920 train_time:246124ms step_avg:352.11ms
step:710/1750 train_loss:3.5569 train_time:246493ms step_avg:352.13ms
step:711/1750 train_loss:3.6036 train_time:246863ms step_avg:352.16ms
step:712/1750 train_loss:3.6594 train_time:247235ms step_avg:352.19ms
step:713/1750 train_loss:3.6675 train_time:247606ms step_avg:352.21ms
step:714/1750 train_loss:3.5720 train_time:247970ms step_avg:352.23ms
step:715/1750 train_loss:3.5826 train_time:248334ms step_avg:352.25ms
step:716/1750 train_loss:3.5987 train_time:248699ms step_avg:352.27ms
step:717/1750 train_loss:3.7247 train_time:249068ms step_avg:352.29ms
step:718/1750 train_loss:3.6136 train_time:249432ms step_avg:352.31ms
step:719/1750 train_loss:3.6929 train_time:249795ms step_avg:352.32ms
step:720/1750 train_loss:3.8623 train_time:250164ms step_avg:352.34ms
step:721/1750 train_loss:3.4836 train_time:250530ms step_avg:352.36ms
step:722/1750 train_loss:3.7435 train_time:250895ms step_avg:352.38ms
step:723/1750 train_loss:3.7826 train_time:251259ms step_avg:352.40ms
step:724/1750 train_loss:3.5788 train_time:251626ms step_avg:352.42ms
step:725/1750 train_loss:3.6660 train_time:251991ms step_avg:352.43ms
step:726/1750 train_loss:3.5423 train_time:252357ms step_avg:352.45ms
step:727/1750 train_loss:3.5844 train_time:252726ms step_avg:352.48ms
step:728/1750 train_loss:3.7476 train_time:253094ms step_avg:352.50ms
step:729/1750 train_loss:3.6818 train_time:253461ms step_avg:352.52ms
step:730/1750 train_loss:3.6780 train_time:253829ms step_avg:352.54ms
step:731/1750 train_loss:3.5702 train_time:254193ms step_avg:352.56ms
step:732/1750 train_loss:3.6058 train_time:254557ms step_avg:352.57ms
step:733/1750 train_loss:3.8431 train_time:254927ms step_avg:352.60ms
step:734/1750 train_loss:3.5696 train_time:255295ms step_avg:352.62ms
step:735/1750 train_loss:3.6161 train_time:255661ms step_avg:352.64ms
step:736/1750 train_loss:3.7479 train_time:256026ms step_avg:352.65ms
step:737/1750 train_loss:3.6912 train_time:256388ms step_avg:352.67ms
step:738/1750 train_loss:3.6085 train_time:256754ms step_avg:352.68ms
step:739/1750 train_loss:3.5095 train_time:257121ms step_avg:352.70ms
step:740/1750 train_loss:4.1293 train_time:257496ms step_avg:352.73ms
step:741/1750 train_loss:3.5069 train_time:257861ms step_avg:352.75ms
step:742/1750 train_loss:3.5692 train_time:258225ms step_avg:352.77ms
step:743/1750 train_loss:3.5903 train_time:258589ms step_avg:352.78ms
step:744/1750 train_loss:3.6647 train_time:258955ms step_avg:352.80ms
step:745/1750 train_loss:3.6000 train_time:259324ms step_avg:352.82ms
step:746/1750 train_loss:3.6048 train_time:259688ms step_avg:352.84ms
step:747/1750 train_loss:3.6586 train_time:260058ms step_avg:352.86ms
step:748/1750 train_loss:3.5848 train_time:260432ms step_avg:352.89ms
step:749/1750 train_loss:3.5732 train_time:260798ms step_avg:352.91ms
step:750/1750 train_loss:3.6222 train_time:261162ms step_avg:352.92ms
step:750/1750 val_loss:3.5800 train_time:261259ms step_avg:353.05ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 242.25374 | frobenius_norm = 55703.91016 | spectral_norm = 10195.97168 | nuclear_norm = 1392165.12500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 138.10913 | spectral_norm = 21.60333 | nuclear_norm = 3200.79712
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 133.16684 | spectral_norm = 24.69281 | nuclear_norm = 3064.83252
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 258.71082 | spectral_norm = 16.49081 | nuclear_norm = 6251.25000
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 205.54654 | spectral_norm = 19.16885 | nuclear_norm = 4788.42676
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 292.32358 | spectral_norm = 22.49127 | nuclear_norm = 7772.34766
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 149.04222 | spectral_norm = 12.78039 | nuclear_norm = 3940.22241
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 136.41289 | spectral_norm = 13.05907 | nuclear_norm = 3159.50024
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 133.97574 | spectral_norm = 14.78224 | nuclear_norm = 3105.20532
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 240.89111 | spectral_norm = 21.30425 | nuclear_norm = 5527.23730
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 245.50044 | spectral_norm = 18.77671 | nuclear_norm = 5727.19287
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 295.54187 | spectral_norm = 20.86548 | nuclear_norm = 7866.56445
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 148.38597 | spectral_norm = 14.50675 | nuclear_norm = 3907.59424
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 133.41083 | spectral_norm = 12.45856 | nuclear_norm = 2977.16699
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 132.55026 | spectral_norm = 11.94998 | nuclear_norm = 2971.59375
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 258.88632 | spectral_norm = 23.41805 | nuclear_norm = 5919.15332
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 263.77991 | spectral_norm = 20.56730 | nuclear_norm = 6199.47803
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 298.67911 | spectral_norm = 22.80416 | nuclear_norm = 7953.94727
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 149.26602 | spectral_norm = 14.25515 | nuclear_norm = 3938.17383
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 134.95282 | spectral_norm = 12.75230 | nuclear_norm = 3093.92676
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 133.93309 | spectral_norm = 12.20988 | nuclear_norm = 3066.36108
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 268.17584 | spectral_norm = 23.91360 | nuclear_norm = 6116.27197
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 267.47925 | spectral_norm = 19.88080 | nuclear_norm = 6292.60742
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 301.49802 | spectral_norm = 22.49535 | nuclear_norm = 8034.66797
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 148.93686 | spectral_norm = 13.75769 | nuclear_norm = 3931.68066
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 135.04884 | spectral_norm = 13.70338 | nuclear_norm = 3099.43774
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 132.94650 | spectral_norm = 12.84815 | nuclear_norm = 3070.10034
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 274.75082 | spectral_norm = 23.42932 | nuclear_norm = 6231.69727
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 269.87091 | spectral_norm = 20.35529 | nuclear_norm = 6326.68359
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 303.39618 | spectral_norm = 24.82752 | nuclear_norm = 8076.33008
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 147.08430 | spectral_norm = 13.09308 | nuclear_norm = 3857.28491
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 133.05811 | spectral_norm = 13.18349 | nuclear_norm = 3059.91553
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 131.30879 | spectral_norm = 13.59860 | nuclear_norm = 3038.44678
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 248.57721 | spectral_norm = 21.33455 | nuclear_norm = 5594.11475
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 254.96255 | spectral_norm = 20.22097 | nuclear_norm = 5864.00781
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 309.45825 | spectral_norm = 22.83042 | nuclear_norm = 8222.61816
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 150.07616 | spectral_norm = 14.19655 | nuclear_norm = 3943.14014
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 131.32576 | spectral_norm = 12.42550 | nuclear_norm = 2974.22559
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 130.50601 | spectral_norm = 12.17631 | nuclear_norm = 2965.43823
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 269.97461 | spectral_norm = 24.37885 | nuclear_norm = 6073.29883
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 271.56137 | spectral_norm = 22.21701 | nuclear_norm = 6349.50781
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 304.52640 | spectral_norm = 21.37557 | nuclear_norm = 8113.87109
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 150.00365 | spectral_norm = 14.41469 | nuclear_norm = 3959.24634
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 138.23518 | spectral_norm = 12.78549 | nuclear_norm = 3177.08276
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 136.75542 | spectral_norm = 13.76546 | nuclear_norm = 3141.28076
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 285.73105 | spectral_norm = 25.48996 | nuclear_norm = 6463.21875
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 269.75586 | spectral_norm = 20.05164 | nuclear_norm = 6348.50391
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 300.07736 | spectral_norm = 24.38577 | nuclear_norm = 7989.27637
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 153.41499 | spectral_norm = 13.72848 | nuclear_norm = 4060.33618
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 136.00703 | spectral_norm = 12.96048 | nuclear_norm = 3094.07007
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 135.16226 | spectral_norm = 12.35484 | nuclear_norm = 3068.17798
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 278.40692 | spectral_norm = 23.42892 | nuclear_norm = 6333.51562
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 271.47629 | spectral_norm = 21.82623 | nuclear_norm = 6372.66748
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 304.89078 | spectral_norm = 25.32642 | nuclear_norm = 8113.75684
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 154.14833 | spectral_norm = 14.09694 | nuclear_norm = 4084.59546
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 137.11349 | spectral_norm = 14.39155 | nuclear_norm = 3116.84912
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 135.60893 | spectral_norm = 12.62880 | nuclear_norm = 3067.84033
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 275.08542 | spectral_norm = 27.20446 | nuclear_norm = 6219.45605
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 274.50763 | spectral_norm = 20.26945 | nuclear_norm = 6495.00098
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 306.29428 | spectral_norm = 24.87862 | nuclear_norm = 8147.75293
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 151.58820 | spectral_norm = 16.03250 | nuclear_norm = 4013.84912
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 136.91214 | spectral_norm = 14.68611 | nuclear_norm = 3051.45410
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 136.73358 | spectral_norm = 13.68639 | nuclear_norm = 3009.54395
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 281.54492 | spectral_norm = 25.95891 | nuclear_norm = 6472.52051
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 283.66656 | spectral_norm = 19.40919 | nuclear_norm = 6684.21875
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 308.52942 | spectral_norm = 21.99111 | nuclear_norm = 8228.72266
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 146.92027 | spectral_norm = 16.89797 | nuclear_norm = 3887.53052
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 138.55804 | spectral_norm = 14.76046 | nuclear_norm = 3145.40405
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 136.88750 | spectral_norm = 14.40433 | nuclear_norm = 3087.06152
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 250.85966 | spectral_norm = 23.30716 | nuclear_norm = 5750.11035
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 277.94913 | spectral_norm = 20.47112 | nuclear_norm = 6515.89111
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 317.54407 | spectral_norm = 24.73463 | nuclear_norm = 8453.52441
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 150.54143 | spectral_norm = 17.07047 | nuclear_norm = 3961.53809
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1010.80377 | spectral_norm = 179.44684 | nuclear_norm = 26255.97852
===========================================
step:751/1750 train_loss:3.5816 train_time:261525ms step_avg:352.93ms
step:752/1750 train_loss:3.6292 train_time:261882ms step_avg:352.94ms
step:753/1750 train_loss:3.6309 train_time:262247ms step_avg:352.96ms
step:754/1750 train_loss:3.6030 train_time:262612ms step_avg:352.97ms
step:755/1750 train_loss:3.6973 train_time:263022ms step_avg:353.05ms
step:756/1750 train_loss:3.4706 train_time:263464ms step_avg:353.17ms
step:757/1750 train_loss:3.7395 train_time:263831ms step_avg:353.19ms
step:758/1750 train_loss:3.6662 train_time:264193ms step_avg:353.20ms
step:759/1750 train_loss:3.6118 train_time:264695ms step_avg:353.40ms
step:760/1750 train_loss:3.7157 train_time:265058ms step_avg:353.41ms
step:761/1750 train_loss:3.4128 train_time:265423ms step_avg:353.43ms
step:762/1750 train_loss:3.5613 train_time:265788ms step_avg:353.44ms
step:763/1750 train_loss:3.6766 train_time:266152ms step_avg:353.46ms
step:764/1750 train_loss:3.3301 train_time:266518ms step_avg:353.47ms
step:765/1750 train_loss:3.7480 train_time:266886ms step_avg:353.49ms
step:766/1750 train_loss:3.5822 train_time:267254ms step_avg:353.51ms
step:767/1750 train_loss:3.5762 train_time:267617ms step_avg:353.52ms
step:768/1750 train_loss:3.5906 train_time:267984ms step_avg:353.54ms
step:769/1750 train_loss:3.5998 train_time:268355ms step_avg:353.56ms
step:770/1750 train_loss:3.6567 train_time:268719ms step_avg:353.58ms
step:771/1750 train_loss:3.8893 train_time:269083ms step_avg:353.59ms
step:772/1750 train_loss:3.4678 train_time:269445ms step_avg:353.60ms
step:773/1750 train_loss:3.6504 train_time:269807ms step_avg:353.61ms
step:774/1750 train_loss:3.6566 train_time:270171ms step_avg:353.63ms
step:775/1750 train_loss:3.6164 train_time:270534ms step_avg:353.64ms
step:776/1750 train_loss:3.4181 train_time:270901ms step_avg:353.66ms
step:777/1750 train_loss:3.4013 train_time:271269ms step_avg:353.67ms
step:778/1750 train_loss:3.5000 train_time:271632ms step_avg:353.69ms
step:779/1750 train_loss:3.5926 train_time:272003ms step_avg:353.71ms
step:780/1750 train_loss:3.6027 train_time:272375ms step_avg:353.73ms
step:781/1750 train_loss:3.6788 train_time:272745ms step_avg:353.75ms
step:782/1750 train_loss:3.6046 train_time:273115ms step_avg:353.78ms
step:783/1750 train_loss:3.5806 train_time:273485ms step_avg:353.80ms
step:784/1750 train_loss:3.6143 train_time:273859ms step_avg:353.82ms
step:785/1750 train_loss:3.5760 train_time:274226ms step_avg:353.84ms
step:786/1750 train_loss:3.4542 train_time:274597ms step_avg:353.86ms
step:787/1750 train_loss:3.7583 train_time:274973ms step_avg:353.89ms
step:788/1750 train_loss:3.5114 train_time:275348ms step_avg:353.92ms
step:789/1750 train_loss:3.5646 train_time:275716ms step_avg:353.94ms
step:790/1750 train_loss:3.6422 train_time:276089ms step_avg:353.96ms
step:791/1750 train_loss:3.7896 train_time:276466ms step_avg:353.99ms
step:792/1750 train_loss:3.7733 train_time:276835ms step_avg:354.01ms
step:793/1750 train_loss:3.4775 train_time:277201ms step_avg:354.02ms
step:794/1750 train_loss:3.6100 train_time:277573ms step_avg:354.05ms
step:795/1750 train_loss:3.6817 train_time:277947ms step_avg:354.07ms
step:796/1750 train_loss:3.7365 train_time:278323ms step_avg:354.10ms
step:797/1750 train_loss:3.5365 train_time:278694ms step_avg:354.12ms
step:798/1750 train_loss:3.6694 train_time:279071ms step_avg:354.15ms
step:799/1750 train_loss:3.5541 train_time:279451ms step_avg:354.18ms
step:800/1750 train_loss:3.5468 train_time:279825ms step_avg:354.21ms
step:801/1750 train_loss:3.6446 train_time:280192ms step_avg:354.23ms
step:802/1750 train_loss:3.5049 train_time:280567ms step_avg:354.25ms
step:803/1750 train_loss:3.5126 train_time:280934ms step_avg:354.27ms
step:804/1750 train_loss:3.6433 train_time:281306ms step_avg:354.29ms
step:805/1750 train_loss:3.5419 train_time:281683ms step_avg:354.32ms
step:806/1750 train_loss:3.5739 train_time:282051ms step_avg:354.34ms
step:807/1750 train_loss:3.6608 train_time:282422ms step_avg:354.36ms
step:808/1750 train_loss:3.5640 train_time:282792ms step_avg:354.38ms
step:809/1750 train_loss:3.5077 train_time:283161ms step_avg:354.39ms
step:810/1750 train_loss:3.5826 train_time:283530ms step_avg:354.41ms
step:811/1750 train_loss:3.6060 train_time:283900ms step_avg:354.43ms
step:812/1750 train_loss:3.6129 train_time:284265ms step_avg:354.45ms
step:813/1750 train_loss:3.6410 train_time:284632ms step_avg:354.46ms
step:814/1750 train_loss:3.5878 train_time:285003ms step_avg:354.48ms
step:815/1750 train_loss:3.5753 train_time:285375ms step_avg:354.50ms
step:816/1750 train_loss:3.7015 train_time:285750ms step_avg:354.53ms
step:817/1750 train_loss:3.7808 train_time:286120ms step_avg:354.55ms
step:818/1750 train_loss:3.5410 train_time:286490ms step_avg:354.57ms
step:819/1750 train_loss:3.7411 train_time:286864ms step_avg:354.59ms
step:820/1750 train_loss:3.5143 train_time:287238ms step_avg:354.61ms
step:821/1750 train_loss:3.5769 train_time:287608ms step_avg:354.63ms
step:822/1750 train_loss:3.7151 train_time:287981ms step_avg:354.66ms
step:823/1750 train_loss:3.5889 train_time:288353ms step_avg:354.68ms
step:824/1750 train_loss:3.5240 train_time:288724ms step_avg:354.70ms
step:825/1750 train_loss:3.6327 train_time:289098ms step_avg:354.72ms
step:826/1750 train_loss:3.4938 train_time:289473ms step_avg:354.75ms
step:827/1750 train_loss:3.7483 train_time:289845ms step_avg:354.77ms
step:828/1750 train_loss:3.6278 train_time:290218ms step_avg:354.79ms
step:829/1750 train_loss:3.6453 train_time:290591ms step_avg:354.81ms
step:830/1750 train_loss:3.5423 train_time:290961ms step_avg:354.83ms
step:831/1750 train_loss:3.6100 train_time:291330ms step_avg:354.85ms
step:832/1750 train_loss:3.5309 train_time:291699ms step_avg:354.87ms
step:833/1750 train_loss:3.6700 train_time:292071ms step_avg:354.89ms
step:834/1750 train_loss:3.5011 train_time:292441ms step_avg:354.90ms
step:835/1750 train_loss:3.4753 train_time:292815ms step_avg:354.93ms
step:836/1750 train_loss:3.7315 train_time:293194ms step_avg:354.96ms
step:837/1750 train_loss:3.4196 train_time:293566ms step_avg:354.98ms
step:838/1750 train_loss:3.6001 train_time:293934ms step_avg:354.99ms
step:839/1750 train_loss:3.4306 train_time:294305ms step_avg:355.01ms
step:840/1750 train_loss:3.4897 train_time:294675ms step_avg:355.03ms
step:841/1750 train_loss:3.5823 train_time:295049ms step_avg:355.05ms
step:842/1750 train_loss:3.5984 train_time:295422ms step_avg:355.07ms
step:843/1750 train_loss:3.5806 train_time:295789ms step_avg:355.09ms
step:844/1750 train_loss:3.4472 train_time:296161ms step_avg:355.11ms
step:845/1750 train_loss:3.6713 train_time:296529ms step_avg:355.12ms
step:846/1750 train_loss:3.5325 train_time:296899ms step_avg:355.14ms
step:847/1750 train_loss:3.5077 train_time:297272ms step_avg:355.16ms
step:848/1750 train_loss:3.6536 train_time:297644ms step_avg:355.18ms
step:849/1750 train_loss:3.5135 train_time:298014ms step_avg:355.20ms
step:850/1750 train_loss:3.4522 train_time:298386ms step_avg:355.22ms
step:851/1750 train_loss:3.7506 train_time:298755ms step_avg:355.24ms
step:852/1750 train_loss:3.4616 train_time:299121ms step_avg:355.25ms
step:853/1750 train_loss:3.5793 train_time:299490ms step_avg:355.27ms
step:854/1750 train_loss:3.6668 train_time:299863ms step_avg:355.29ms
step:855/1750 train_loss:3.5363 train_time:300229ms step_avg:355.30ms
step:856/1750 train_loss:3.5575 train_time:300596ms step_avg:355.31ms
step:857/1750 train_loss:3.6226 train_time:300969ms step_avg:355.34ms
step:858/1750 train_loss:3.4808 train_time:301343ms step_avg:355.36ms
step:859/1750 train_loss:3.5849 train_time:301714ms step_avg:355.38ms
step:860/1750 train_loss:3.6029 train_time:302081ms step_avg:355.39ms
step:861/1750 train_loss:3.6478 train_time:302459ms step_avg:355.42ms
step:862/1750 train_loss:3.6150 train_time:302837ms step_avg:355.44ms
step:863/1750 train_loss:3.5933 train_time:303211ms step_avg:355.46ms
step:864/1750 train_loss:3.3985 train_time:303581ms step_avg:355.48ms
step:865/1750 train_loss:3.6129 train_time:303947ms step_avg:355.49ms
step:866/1750 train_loss:3.8888 train_time:304320ms step_avg:355.51ms
step:867/1750 train_loss:3.4688 train_time:304688ms step_avg:355.53ms
step:868/1750 train_loss:3.6587 train_time:305056ms step_avg:355.54ms
step:869/1750 train_loss:3.6288 train_time:305429ms step_avg:355.56ms
step:870/1750 train_loss:3.4678 train_time:305803ms step_avg:355.58ms
step:871/1750 train_loss:3.4247 train_time:306170ms step_avg:355.60ms
step:872/1750 train_loss:3.6715 train_time:306539ms step_avg:355.61ms
step:873/1750 train_loss:3.4720 train_time:306908ms step_avg:355.63ms
step:874/1750 train_loss:3.2337 train_time:307286ms step_avg:355.65ms
step:875/1750 train_loss:3.6525 train_time:307655ms step_avg:355.67ms
step:875/1750 val_loss:3.5374 train_time:307753ms step_avg:355.78ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 256.60068 | frobenius_norm = 59064.31641 | spectral_norm = 10704.32031 | nuclear_norm = 1479425.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 151.47534 | spectral_norm = 24.87761 | nuclear_norm = 3503.23193
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 146.45557 | spectral_norm = 28.31067 | nuclear_norm = 3364.43433
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 281.96359 | spectral_norm = 18.28151 | nuclear_norm = 6833.29248
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 217.18616 | spectral_norm = 20.87373 | nuclear_norm = 5047.02246
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 325.02496 | spectral_norm = 25.36840 | nuclear_norm = 8646.17676
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 163.88689 | spectral_norm = 14.32168 | nuclear_norm = 4328.61816
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 150.38168 | spectral_norm = 14.77613 | nuclear_norm = 3474.59473
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 147.95657 | spectral_norm = 16.08185 | nuclear_norm = 3425.69116
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 261.08676 | spectral_norm = 23.35885 | nuclear_norm = 5984.13965
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 265.81146 | spectral_norm = 20.49998 | nuclear_norm = 6195.08105
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 325.11572 | spectral_norm = 23.35148 | nuclear_norm = 8656.30664
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 162.35713 | spectral_norm = 16.27280 | nuclear_norm = 4272.89648
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 146.68077 | spectral_norm = 13.94411 | nuclear_norm = 3257.01855
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 145.73306 | spectral_norm = 13.35809 | nuclear_norm = 3252.10889
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 282.03598 | spectral_norm = 26.03185 | nuclear_norm = 6438.17773
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 286.98007 | spectral_norm = 22.12547 | nuclear_norm = 6739.27979
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 328.89505 | spectral_norm = 25.98080 | nuclear_norm = 8760.61328
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 163.91492 | spectral_norm = 16.05309 | nuclear_norm = 4323.80908
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 148.44894 | spectral_norm = 14.27968 | nuclear_norm = 3391.68726
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 147.18367 | spectral_norm = 13.66273 | nuclear_norm = 3361.02368
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 293.82645 | spectral_norm = 26.34842 | nuclear_norm = 6699.49121
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 292.48291 | spectral_norm = 21.86804 | nuclear_norm = 6883.33301
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 331.76431 | spectral_norm = 25.41826 | nuclear_norm = 8842.82129
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 163.55630 | spectral_norm = 15.36105 | nuclear_norm = 4317.70410
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 148.71112 | spectral_norm = 15.27390 | nuclear_norm = 3403.70557
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 146.13649 | spectral_norm = 14.31137 | nuclear_norm = 3368.78369
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 301.77786 | spectral_norm = 25.77043 | nuclear_norm = 6845.46631
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 296.58972 | spectral_norm = 22.47696 | nuclear_norm = 6956.07422
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 333.15256 | spectral_norm = 27.94077 | nuclear_norm = 8872.28125
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 161.27574 | spectral_norm = 14.60829 | nuclear_norm = 4228.62598
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 146.24840 | spectral_norm = 14.97523 | nuclear_norm = 3350.65771
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 144.30060 | spectral_norm = 15.02530 | nuclear_norm = 3330.98828
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 273.59219 | spectral_norm = 23.47564 | nuclear_norm = 6157.98438
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 280.18320 | spectral_norm = 22.27141 | nuclear_norm = 6446.65430
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 339.68362 | spectral_norm = 25.66962 | nuclear_norm = 9026.28418
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 164.56865 | spectral_norm = 16.11270 | nuclear_norm = 4321.57471
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 144.17789 | spectral_norm = 13.85537 | nuclear_norm = 3250.00586
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 142.97134 | spectral_norm = 13.55977 | nuclear_norm = 3235.32324
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 295.92178 | spectral_norm = 26.60073 | nuclear_norm = 6657.51172
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 296.27362 | spectral_norm = 24.03448 | nuclear_norm = 6929.27246
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 335.80545 | spectral_norm = 24.03489 | nuclear_norm = 8949.04883
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 164.80009 | spectral_norm = 16.52736 | nuclear_norm = 4348.23828
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 152.05101 | spectral_norm = 14.38886 | nuclear_norm = 3482.39746
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 150.41324 | spectral_norm = 15.50359 | nuclear_norm = 3445.13135
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 313.03351 | spectral_norm = 29.09156 | nuclear_norm = 7057.08691
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 295.34415 | spectral_norm = 22.01444 | nuclear_norm = 6951.00732
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 329.77029 | spectral_norm = 27.27634 | nuclear_norm = 8780.89258
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 168.72891 | spectral_norm = 15.62001 | nuclear_norm = 4465.68506
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 149.05052 | spectral_norm = 14.55148 | nuclear_norm = 3375.19092
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 148.44873 | spectral_norm = 13.84707 | nuclear_norm = 3356.02734
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 304.22665 | spectral_norm = 25.76675 | nuclear_norm = 6911.36475
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 296.50940 | spectral_norm = 23.85742 | nuclear_norm = 6955.53418
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 335.74289 | spectral_norm = 28.03919 | nuclear_norm = 8934.79883
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 169.86900 | spectral_norm = 16.11351 | nuclear_norm = 4501.04053
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 150.79712 | spectral_norm = 15.99156 | nuclear_norm = 3412.91748
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 149.25215 | spectral_norm = 14.15397 | nuclear_norm = 3363.51318
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 300.31006 | spectral_norm = 30.66398 | nuclear_norm = 6769.35156
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 298.56946 | spectral_norm = 22.17596 | nuclear_norm = 7058.55908
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 337.51788 | spectral_norm = 27.96025 | nuclear_norm = 8975.05273
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 166.78207 | spectral_norm = 18.30165 | nuclear_norm = 4415.99316
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 150.31680 | spectral_norm = 16.69696 | nuclear_norm = 3329.87109
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 150.42352 | spectral_norm = 15.37167 | nuclear_norm = 3287.15332
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 305.92081 | spectral_norm = 28.89158 | nuclear_norm = 7020.52930
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 308.74545 | spectral_norm = 21.27041 | nuclear_norm = 7274.25195
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 341.20862 | spectral_norm = 24.71180 | nuclear_norm = 9100.20508
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 161.35971 | spectral_norm = 19.23127 | nuclear_norm = 4268.63037
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 152.03102 | spectral_norm = 16.70446 | nuclear_norm = 3430.69116
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 150.63091 | spectral_norm = 16.24193 | nuclear_norm = 3380.89014
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 273.49850 | spectral_norm = 25.83012 | nuclear_norm = 6258.40723
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 303.80304 | spectral_norm = 22.50711 | nuclear_norm = 7116.01855
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 350.65112 | spectral_norm = 27.38901 | nuclear_norm = 9332.39648
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 165.19733 | spectral_norm = 19.50295 | nuclear_norm = 4344.66895
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1095.09912 | spectral_norm = 181.71925 | nuclear_norm = 28568.53906
===========================================
step:876/1750 train_loss:3.4567 train_time:308017ms step_avg:355.68ms
step:877/1750 train_loss:3.6378 train_time:308377ms step_avg:355.68ms
step:878/1750 train_loss:3.4833 train_time:308742ms step_avg:355.69ms
step:879/1750 train_loss:3.6648 train_time:309110ms step_avg:355.71ms
step:880/1750 train_loss:3.3224 train_time:309475ms step_avg:355.72ms
step:881/1750 train_loss:3.4995 train_time:309842ms step_avg:355.73ms
step:882/1750 train_loss:3.7083 train_time:310210ms step_avg:355.75ms
step:883/1750 train_loss:3.8516 train_time:310579ms step_avg:355.76ms
step:884/1750 train_loss:3.5808 train_time:310950ms step_avg:355.78ms
step:885/1750 train_loss:3.5075 train_time:311320ms step_avg:355.79ms
step:886/1750 train_loss:3.5886 train_time:311688ms step_avg:355.81ms
step:887/1750 train_loss:4.1006 train_time:312057ms step_avg:355.82ms
step:888/1750 train_loss:3.8493 train_time:312436ms step_avg:355.85ms
step:889/1750 train_loss:3.5389 train_time:312807ms step_avg:355.87ms
step:890/1750 train_loss:3.5474 train_time:313172ms step_avg:355.88ms
step:891/1750 train_loss:3.3796 train_time:313539ms step_avg:355.89ms
step:892/1750 train_loss:3.7364 train_time:313908ms step_avg:355.91ms
step:893/1750 train_loss:3.4429 train_time:314275ms step_avg:355.92ms
step:894/1750 train_loss:3.6472 train_time:314648ms step_avg:355.94ms
step:895/1750 train_loss:3.6994 train_time:315019ms step_avg:355.95ms
step:896/1750 train_loss:3.5168 train_time:315389ms step_avg:355.97ms
step:897/1750 train_loss:3.5589 train_time:315759ms step_avg:355.99ms
step:898/1750 train_loss:3.6091 train_time:316129ms step_avg:356.00ms
step:899/1750 train_loss:3.4942 train_time:316496ms step_avg:356.01ms
step:900/1750 train_loss:3.4390 train_time:316868ms step_avg:356.03ms
step:901/1750 train_loss:3.6419 train_time:317234ms step_avg:356.04ms
step:902/1750 train_loss:3.6508 train_time:317601ms step_avg:356.06ms
step:903/1750 train_loss:3.5560 train_time:317974ms step_avg:356.07ms
step:904/1750 train_loss:3.5096 train_time:318345ms step_avg:356.09ms
step:905/1750 train_loss:3.5235 train_time:318713ms step_avg:356.10ms
step:906/1750 train_loss:3.7277 train_time:319088ms step_avg:356.13ms
step:907/1750 train_loss:3.5322 train_time:319461ms step_avg:356.14ms
step:908/1750 train_loss:3.5841 train_time:319828ms step_avg:356.16ms
step:909/1750 train_loss:3.4695 train_time:320207ms step_avg:356.18ms
step:910/1750 train_loss:3.5426 train_time:320591ms step_avg:356.21ms
step:911/1750 train_loss:3.6565 train_time:320964ms step_avg:356.23ms
step:912/1750 train_loss:3.6140 train_time:321341ms step_avg:356.25ms
step:913/1750 train_loss:3.4696 train_time:321722ms step_avg:356.28ms
step:914/1750 train_loss:3.7585 train_time:322103ms step_avg:356.31ms
step:915/1750 train_loss:3.5475 train_time:322484ms step_avg:356.34ms
step:916/1750 train_loss:3.6363 train_time:322861ms step_avg:356.36ms
step:917/1750 train_loss:3.6168 train_time:323235ms step_avg:356.38ms
step:918/1750 train_loss:4.8311 train_time:323618ms step_avg:356.41ms
step:919/1750 train_loss:3.5100 train_time:324000ms step_avg:356.44ms
step:920/1750 train_loss:3.6035 train_time:324373ms step_avg:356.45ms
step:921/1750 train_loss:3.5622 train_time:324751ms step_avg:356.48ms
step:922/1750 train_loss:3.6022 train_time:325131ms step_avg:356.50ms
step:923/1750 train_loss:3.6264 train_time:325502ms step_avg:356.52ms
step:924/1750 train_loss:3.6955 train_time:325879ms step_avg:356.54ms
step:925/1750 train_loss:3.6658 train_time:326254ms step_avg:356.56ms
step:926/1750 train_loss:3.5764 train_time:326625ms step_avg:356.58ms
step:927/1750 train_loss:3.5717 train_time:326994ms step_avg:356.59ms
step:928/1750 train_loss:3.8062 train_time:327370ms step_avg:356.61ms
step:929/1750 train_loss:3.6291 train_time:327748ms step_avg:356.64ms
step:930/1750 train_loss:3.4185 train_time:328124ms step_avg:356.66ms
step:931/1750 train_loss:3.5156 train_time:328493ms step_avg:356.67ms
step:932/1750 train_loss:3.6701 train_time:328868ms step_avg:356.69ms
step:933/1750 train_loss:3.4040 train_time:329243ms step_avg:356.71ms
step:934/1750 train_loss:3.6048 train_time:329620ms step_avg:356.73ms
step:935/1750 train_loss:3.4560 train_time:329999ms step_avg:356.76ms
step:936/1750 train_loss:3.5391 train_time:330376ms step_avg:356.78ms
step:937/1750 train_loss:3.6382 train_time:330757ms step_avg:356.80ms
step:938/1750 train_loss:3.5550 train_time:331130ms step_avg:356.82ms
step:939/1750 train_loss:3.6900 train_time:331514ms step_avg:356.85ms
step:940/1750 train_loss:3.4968 train_time:331890ms step_avg:356.87ms
step:941/1750 train_loss:3.5619 train_time:332262ms step_avg:356.89ms
step:942/1750 train_loss:3.3778 train_time:332637ms step_avg:356.91ms
step:943/1750 train_loss:3.7256 train_time:333019ms step_avg:356.93ms
step:944/1750 train_loss:3.4248 train_time:333425ms step_avg:356.99ms
step:945/1750 train_loss:3.4418 train_time:333967ms step_avg:357.18ms
step:946/1750 train_loss:5.0917 train_time:334350ms step_avg:357.21ms
step:947/1750 train_loss:3.6207 train_time:334725ms step_avg:357.23ms
step:948/1750 train_loss:3.5015 train_time:335100ms step_avg:357.25ms
step:949/1750 train_loss:3.3973 train_time:335615ms step_avg:357.42ms
step:950/1750 train_loss:3.4578 train_time:335988ms step_avg:357.43ms
step:951/1750 train_loss:3.4256 train_time:336367ms step_avg:357.46ms
step:952/1750 train_loss:3.4968 train_time:336739ms step_avg:357.47ms
step:953/1750 train_loss:3.5859 train_time:337119ms step_avg:357.50ms
step:954/1750 train_loss:3.4605 train_time:337501ms step_avg:357.52ms
step:955/1750 train_loss:3.4985 train_time:337871ms step_avg:357.54ms
step:956/1750 train_loss:3.4618 train_time:338248ms step_avg:357.56ms
step:957/1750 train_loss:3.5219 train_time:338635ms step_avg:357.59ms
step:958/1750 train_loss:3.5194 train_time:339019ms step_avg:357.62ms
step:959/1750 train_loss:3.5322 train_time:339393ms step_avg:357.63ms
step:960/1750 train_loss:3.4234 train_time:339769ms step_avg:357.65ms
step:961/1750 train_loss:3.6749 train_time:340142ms step_avg:357.67ms
step:962/1750 train_loss:3.6262 train_time:340516ms step_avg:357.68ms
step:963/1750 train_loss:3.7567 train_time:340893ms step_avg:357.71ms
step:964/1750 train_loss:3.4487 train_time:341273ms step_avg:357.73ms
step:965/1750 train_loss:3.5005 train_time:341645ms step_avg:357.74ms
step:966/1750 train_loss:3.7388 train_time:342017ms step_avg:357.76ms
step:967/1750 train_loss:3.5469 train_time:342389ms step_avg:357.77ms
step:968/1750 train_loss:3.5468 train_time:342766ms step_avg:357.79ms
step:969/1750 train_loss:3.6064 train_time:343142ms step_avg:357.81ms
step:970/1750 train_loss:3.3944 train_time:343516ms step_avg:357.83ms
step:971/1750 train_loss:3.5582 train_time:343889ms step_avg:357.85ms
step:972/1750 train_loss:3.5046 train_time:344259ms step_avg:357.86ms
step:973/1750 train_loss:3.5619 train_time:344631ms step_avg:357.87ms
step:974/1750 train_loss:3.6119 train_time:345006ms step_avg:357.89ms
step:975/1750 train_loss:3.4939 train_time:345380ms step_avg:357.91ms
step:976/1750 train_loss:3.6925 train_time:345751ms step_avg:357.92ms
step:977/1750 train_loss:3.5945 train_time:346120ms step_avg:357.93ms
step:978/1750 train_loss:3.3846 train_time:346492ms step_avg:357.95ms
step:979/1750 train_loss:3.6553 train_time:346866ms step_avg:357.96ms
step:980/1750 train_loss:3.4395 train_time:347246ms step_avg:357.99ms
step:981/1750 train_loss:3.6069 train_time:347625ms step_avg:358.01ms
step:982/1750 train_loss:3.5732 train_time:347997ms step_avg:358.02ms
step:983/1750 train_loss:3.5376 train_time:348373ms step_avg:358.04ms
step:984/1750 train_loss:3.5196 train_time:348746ms step_avg:358.06ms
step:985/1750 train_loss:3.6087 train_time:349123ms step_avg:358.08ms
step:986/1750 train_loss:3.4444 train_time:349497ms step_avg:358.09ms
step:987/1750 train_loss:3.5111 train_time:349867ms step_avg:358.10ms
step:988/1750 train_loss:3.5069 train_time:350237ms step_avg:358.12ms
step:989/1750 train_loss:3.4406 train_time:350606ms step_avg:358.13ms
step:990/1750 train_loss:3.6812 train_time:350980ms step_avg:358.14ms
step:991/1750 train_loss:3.5024 train_time:351355ms step_avg:358.16ms
step:992/1750 train_loss:3.4688 train_time:351746ms step_avg:358.19ms
step:993/1750 train_loss:3.5354 train_time:352131ms step_avg:358.22ms
step:994/1750 train_loss:3.6241 train_time:352503ms step_avg:358.23ms
step:995/1750 train_loss:3.5646 train_time:352872ms step_avg:358.25ms
step:996/1750 train_loss:3.4855 train_time:353239ms step_avg:358.25ms
step:997/1750 train_loss:3.8044 train_time:353610ms step_avg:358.27ms
step:998/1750 train_loss:3.4768 train_time:353982ms step_avg:358.28ms
step:999/1750 train_loss:3.6134 train_time:354354ms step_avg:358.30ms
step:1000/1750 train_loss:3.4710 train_time:354732ms step_avg:358.31ms
step:1000/1750 val_loss:3.4997 train_time:354827ms step_avg:358.41ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 269.49896 | frobenius_norm = 62090.62891 | spectral_norm = 11188.25879 | nuclear_norm = 1558234.87500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 163.80832 | spectral_norm = 28.06509 | nuclear_norm = 3780.38501
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 158.80997 | spectral_norm = 31.82217 | nuclear_norm = 3641.91846
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 303.77625 | spectral_norm = 19.77050 | nuclear_norm = 7381.65137
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 227.02100 | spectral_norm = 22.55728 | nuclear_norm = 5259.18945
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 354.03452 | spectral_norm = 27.84219 | nuclear_norm = 9419.74414
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 177.79597 | spectral_norm = 15.82687 | nuclear_norm = 4693.49805
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 163.23108 | spectral_norm = 16.26577 | nuclear_norm = 3763.89160
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 160.95879 | spectral_norm = 17.25840 | nuclear_norm = 3721.90088
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 280.09561 | spectral_norm = 25.25492 | nuclear_norm = 6414.34766
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 285.25925 | spectral_norm = 21.93404 | nuclear_norm = 6647.99902
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 352.03931 | spectral_norm = 25.94663 | nuclear_norm = 9374.46387
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 175.17509 | spectral_norm = 17.98899 | nuclear_norm = 4607.55957
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 158.65172 | spectral_norm = 15.32172 | nuclear_norm = 3509.06299
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 157.90309 | spectral_norm = 14.55384 | nuclear_norm = 3509.37402
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 303.77771 | spectral_norm = 28.38574 | nuclear_norm = 6927.89551
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 308.55368 | spectral_norm = 23.87098 | nuclear_norm = 7241.58594
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 356.08743 | spectral_norm = 29.26561 | nuclear_norm = 9483.93945
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 177.49733 | spectral_norm = 17.78352 | nuclear_norm = 4680.61328
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 160.92459 | spectral_norm = 15.69560 | nuclear_norm = 3668.47803
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 159.38811 | spectral_norm = 14.86496 | nuclear_norm = 3631.83789
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 317.57361 | spectral_norm = 28.66018 | nuclear_norm = 7236.63770
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 315.41229 | spectral_norm = 23.54251 | nuclear_norm = 7424.43164
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 358.84900 | spectral_norm = 28.30640 | nuclear_norm = 9566.60938
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 177.07097 | spectral_norm = 16.85730 | nuclear_norm = 4674.38525
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 161.28162 | spectral_norm = 16.77054 | nuclear_norm = 3682.86890
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 158.07748 | spectral_norm = 15.68108 | nuclear_norm = 3638.85645
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 327.12836 | spectral_norm = 27.88709 | nuclear_norm = 7421.44043
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 321.45300 | spectral_norm = 24.30032 | nuclear_norm = 7545.28613
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 359.76562 | spectral_norm = 31.06285 | nuclear_norm = 9581.85449
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 174.33984 | spectral_norm = 16.06537 | nuclear_norm = 4570.21875
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 158.33513 | spectral_norm = 16.56836 | nuclear_norm = 3617.46045
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 156.22209 | spectral_norm = 16.46220 | nuclear_norm = 3599.55981
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 296.91962 | spectral_norm = 25.40384 | nuclear_norm = 6684.51074
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 303.73846 | spectral_norm = 24.01097 | nuclear_norm = 6992.49707
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 367.11060 | spectral_norm = 28.35658 | nuclear_norm = 9754.06055
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 177.98793 | spectral_norm = 17.93613 | nuclear_norm = 4671.18457
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 155.87042 | spectral_norm = 15.11771 | nuclear_norm = 3499.55347
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 154.47130 | spectral_norm = 14.83354 | nuclear_norm = 3481.64648
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 319.96631 | spectral_norm = 28.66477 | nuclear_norm = 7200.80322
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 319.41092 | spectral_norm = 25.60568 | nuclear_norm = 7470.01855
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 364.88281 | spectral_norm = 26.57443 | nuclear_norm = 9723.97852
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 178.59761 | spectral_norm = 18.44099 | nuclear_norm = 4710.74707
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 164.68497 | spectral_norm = 15.80520 | nuclear_norm = 3760.56470
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 162.82593 | spectral_norm = 17.00315 | nuclear_norm = 3717.96265
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 338.41214 | spectral_norm = 32.50853 | nuclear_norm = 7607.01660
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 318.78659 | spectral_norm = 23.92065 | nuclear_norm = 7508.26074
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 357.44699 | spectral_norm = 29.83000 | nuclear_norm = 9518.45703
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 182.88588 | spectral_norm = 17.39452 | nuclear_norm = 4839.73584
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 161.16403 | spectral_norm = 16.03157 | nuclear_norm = 3637.08203
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 160.67773 | spectral_norm = 15.20541 | nuclear_norm = 3623.24170
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 328.16257 | spectral_norm = 27.93709 | nuclear_norm = 7446.51758
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 319.43121 | spectral_norm = 25.73747 | nuclear_norm = 7487.52295
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 364.48178 | spectral_norm = 30.51898 | nuclear_norm = 9698.57031
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 184.32954 | spectral_norm = 17.92951 | nuclear_norm = 4883.74316
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 163.46745 | spectral_norm = 17.63071 | nuclear_norm = 3686.51611
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 161.77232 | spectral_norm = 15.68961 | nuclear_norm = 3632.68262
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 324.31448 | spectral_norm = 33.87976 | nuclear_norm = 7291.50098
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 321.24945 | spectral_norm = 24.02545 | nuclear_norm = 7591.82227
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 366.32507 | spectral_norm = 30.85638 | nuclear_norm = 9737.23438
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 180.78819 | spectral_norm = 20.37602 | nuclear_norm = 4786.47656
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 162.69272 | spectral_norm = 18.56913 | nuclear_norm = 3585.76611
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 163.12138 | spectral_norm = 16.97826 | nuclear_norm = 3543.71777
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 328.90683 | spectral_norm = 32.08096 | nuclear_norm = 7539.56396
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 332.82547 | spectral_norm = 23.03726 | nuclear_norm = 7839.58691
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 370.65619 | spectral_norm = 27.22961 | nuclear_norm = 9884.54492
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 174.88335 | spectral_norm = 21.40241 | nuclear_norm = 4625.14453
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 164.72206 | spectral_norm = 18.45792 | nuclear_norm = 3698.28857
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 163.15193 | spectral_norm = 17.94070 | nuclear_norm = 3647.50684
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 295.08121 | spectral_norm = 28.52321 | nuclear_norm = 6744.22656
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 328.72675 | spectral_norm = 24.49013 | nuclear_norm = 7689.74023
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 381.05182 | spectral_norm = 29.78517 | nuclear_norm = 10139.19922
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 178.82549 | spectral_norm = 21.83052 | nuclear_norm = 4700.27393
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1172.62366 | spectral_norm = 183.79811 | nuclear_norm = 30696.39453
===========================================
step:1001/1750 train_loss:3.5291 train_time:355093ms step_avg:358.32ms
step:1002/1750 train_loss:3.4111 train_time:355458ms step_avg:358.32ms
step:1003/1750 train_loss:3.5876 train_time:355833ms step_avg:358.34ms
step:1004/1750 train_loss:3.6347 train_time:356208ms step_avg:358.36ms
step:1005/1750 train_loss:3.4215 train_time:356577ms step_avg:358.37ms
step:1006/1750 train_loss:3.4923 train_time:356950ms step_avg:358.38ms
step:1007/1750 train_loss:3.4680 train_time:357320ms step_avg:358.40ms
step:1008/1750 train_loss:3.5944 train_time:357697ms step_avg:358.41ms
step:1009/1750 train_loss:3.6957 train_time:358078ms step_avg:358.44ms
step:1010/1750 train_loss:3.5915 train_time:358447ms step_avg:358.45ms
step:1011/1750 train_loss:3.5667 train_time:358818ms step_avg:358.46ms
step:1012/1750 train_loss:3.4203 train_time:359188ms step_avg:358.47ms
step:1013/1750 train_loss:3.5700 train_time:359562ms step_avg:358.49ms
step:1014/1750 train_loss:3.6564 train_time:359938ms step_avg:358.50ms
step:1015/1750 train_loss:3.3631 train_time:360317ms step_avg:358.52ms
step:1016/1750 train_loss:3.4441 train_time:360688ms step_avg:358.54ms
step:1017/1750 train_loss:3.4331 train_time:361064ms step_avg:358.55ms
step:1018/1750 train_loss:3.4275 train_time:361442ms step_avg:358.57ms
step:1019/1750 train_loss:3.5578 train_time:361815ms step_avg:358.59ms
step:1020/1750 train_loss:3.4247 train_time:362187ms step_avg:358.60ms
step:1021/1750 train_loss:3.3871 train_time:362555ms step_avg:358.61ms
step:1022/1750 train_loss:3.5159 train_time:362928ms step_avg:358.62ms
step:1023/1750 train_loss:3.5432 train_time:363301ms step_avg:358.64ms
step:1024/1750 train_loss:3.5092 train_time:363674ms step_avg:358.65ms
step:1025/1750 train_loss:3.5136 train_time:364048ms step_avg:358.67ms
step:1026/1750 train_loss:3.6638 train_time:364418ms step_avg:358.68ms
step:1027/1750 train_loss:3.3602 train_time:364786ms step_avg:358.69ms
step:1028/1750 train_loss:3.4260 train_time:365163ms step_avg:358.71ms
step:1029/1750 train_loss:3.3566 train_time:365541ms step_avg:358.73ms
step:1030/1750 train_loss:3.5676 train_time:365916ms step_avg:358.74ms
step:1031/1750 train_loss:3.5489 train_time:366290ms step_avg:358.76ms
step:1032/1750 train_loss:3.7374 train_time:366669ms step_avg:358.78ms
step:1033/1750 train_loss:3.5306 train_time:367039ms step_avg:358.79ms
step:1034/1750 train_loss:3.4407 train_time:367412ms step_avg:358.80ms
step:1035/1750 train_loss:3.4847 train_time:367785ms step_avg:358.81ms
step:1036/1750 train_loss:3.5252 train_time:368157ms step_avg:358.83ms
step:1037/1750 train_loss:3.8270 train_time:368527ms step_avg:358.84ms
step:1038/1750 train_loss:3.6548 train_time:368900ms step_avg:358.85ms
step:1039/1750 train_loss:3.5552 train_time:369282ms step_avg:358.87ms
step:1040/1750 train_loss:3.4520 train_time:369660ms step_avg:358.89ms
step:1041/1750 train_loss:3.5234 train_time:370036ms step_avg:358.91ms
step:1042/1750 train_loss:3.5646 train_time:370406ms step_avg:358.92ms
step:1043/1750 train_loss:3.4786 train_time:370779ms step_avg:358.93ms
step:1044/1750 train_loss:3.4922 train_time:371157ms step_avg:358.95ms
step:1045/1750 train_loss:3.5559 train_time:371535ms step_avg:358.97ms
step:1046/1750 train_loss:3.4664 train_time:371910ms step_avg:358.99ms
step:1047/1750 train_loss:3.6831 train_time:372289ms step_avg:359.01ms
step:1048/1750 train_loss:3.5386 train_time:372668ms step_avg:359.03ms
step:1049/1750 train_loss:3.4408 train_time:373049ms step_avg:359.05ms
step:1050/1750 train_loss:3.4362 train_time:373435ms step_avg:359.07ms
step:1051/1750 train_loss:3.5409 train_time:373817ms step_avg:359.09ms
step:1052/1750 train_loss:3.3964 train_time:374200ms step_avg:359.12ms
step:1053/1750 train_loss:3.7344 train_time:374580ms step_avg:359.14ms
step:1054/1750 train_loss:3.5871 train_time:374961ms step_avg:359.16ms
step:1055/1750 train_loss:3.4172 train_time:375336ms step_avg:359.17ms
step:1056/1750 train_loss:3.5449 train_time:375715ms step_avg:359.19ms
step:1057/1750 train_loss:3.6180 train_time:376096ms step_avg:359.21ms
step:1058/1750 train_loss:3.3470 train_time:376477ms step_avg:359.23ms
step:1059/1750 train_loss:3.4059 train_time:376863ms step_avg:359.26ms
step:1060/1750 train_loss:3.4807 train_time:377242ms step_avg:359.28ms
step:1061/1750 train_loss:3.4591 train_time:377617ms step_avg:359.29ms
step:1062/1750 train_loss:3.4267 train_time:377993ms step_avg:359.31ms
step:1063/1750 train_loss:3.5111 train_time:378367ms step_avg:359.32ms
step:1064/1750 train_loss:3.4258 train_time:378740ms step_avg:359.34ms
step:1065/1750 train_loss:3.4124 train_time:379124ms step_avg:359.36ms
step:1066/1750 train_loss:3.4562 train_time:379505ms step_avg:359.38ms
step:1067/1750 train_loss:3.3255 train_time:379885ms step_avg:359.40ms
step:1068/1750 train_loss:3.4786 train_time:380266ms step_avg:359.42ms
step:1069/1750 train_loss:3.3460 train_time:380652ms step_avg:359.45ms
step:1070/1750 train_loss:3.6078 train_time:381030ms step_avg:359.46ms
step:1071/1750 train_loss:3.5559 train_time:381413ms step_avg:359.48ms
step:1072/1750 train_loss:3.4817 train_time:381785ms step_avg:359.50ms
step:1073/1750 train_loss:3.5716 train_time:382158ms step_avg:359.51ms
step:1074/1750 train_loss:3.4862 train_time:382536ms step_avg:359.53ms
step:1075/1750 train_loss:3.4471 train_time:382913ms step_avg:359.54ms
step:1076/1750 train_loss:3.8415 train_time:383288ms step_avg:359.56ms
step:1077/1750 train_loss:3.4751 train_time:383662ms step_avg:359.57ms
step:1078/1750 train_loss:3.1285 train_time:384058ms step_avg:359.61ms
step:1079/1750 train_loss:3.5797 train_time:384443ms step_avg:359.63ms
step:1080/1750 train_loss:3.4742 train_time:384823ms step_avg:359.65ms
step:1081/1750 train_loss:3.5589 train_time:385197ms step_avg:359.66ms
step:1082/1750 train_loss:3.6454 train_time:385574ms step_avg:359.68ms
step:1083/1750 train_loss:3.5485 train_time:385949ms step_avg:359.69ms
step:1084/1750 train_loss:3.5243 train_time:386328ms step_avg:359.71ms
step:1085/1750 train_loss:3.4829 train_time:386708ms step_avg:359.73ms
step:1086/1750 train_loss:3.6817 train_time:387090ms step_avg:359.75ms
step:1087/1750 train_loss:3.5631 train_time:387468ms step_avg:359.77ms
step:1088/1750 train_loss:3.4166 train_time:387851ms step_avg:359.79ms
step:1089/1750 train_loss:3.4309 train_time:388241ms step_avg:359.82ms
step:1090/1750 train_loss:3.5395 train_time:388628ms step_avg:359.84ms
step:1091/1750 train_loss:3.3356 train_time:389009ms step_avg:359.86ms
step:1092/1750 train_loss:3.5448 train_time:389393ms step_avg:359.88ms
step:1093/1750 train_loss:3.6635 train_time:389773ms step_avg:359.90ms
step:1094/1750 train_loss:3.4955 train_time:390149ms step_avg:359.92ms
step:1095/1750 train_loss:3.4632 train_time:390530ms step_avg:359.94ms
step:1096/1750 train_loss:3.4813 train_time:390916ms step_avg:359.96ms
step:1097/1750 train_loss:3.5385 train_time:391300ms step_avg:359.98ms
step:1098/1750 train_loss:3.6123 train_time:391678ms step_avg:360.00ms
step:1099/1750 train_loss:3.5763 train_time:392057ms step_avg:360.02ms
step:1100/1750 train_loss:3.4895 train_time:392446ms step_avg:360.04ms
step:1101/1750 train_loss:3.3416 train_time:392825ms step_avg:360.06ms
step:1102/1750 train_loss:3.3599 train_time:393211ms step_avg:360.08ms
step:1103/1750 train_loss:3.4985 train_time:393597ms step_avg:360.11ms
step:1104/1750 train_loss:3.3691 train_time:393971ms step_avg:360.12ms
step:1105/1750 train_loss:4.1100 train_time:394350ms step_avg:360.14ms
step:1106/1750 train_loss:3.2825 train_time:394724ms step_avg:360.15ms
step:1107/1750 train_loss:3.6298 train_time:395100ms step_avg:360.16ms
step:1108/1750 train_loss:3.3990 train_time:395473ms step_avg:360.18ms
step:1109/1750 train_loss:3.5571 train_time:395848ms step_avg:360.19ms
step:1110/1750 train_loss:3.4811 train_time:396224ms step_avg:360.20ms
step:1111/1750 train_loss:3.5351 train_time:396603ms step_avg:360.22ms
step:1112/1750 train_loss:3.6166 train_time:396987ms step_avg:360.24ms
step:1113/1750 train_loss:3.4892 train_time:397377ms step_avg:360.27ms
step:1114/1750 train_loss:3.4169 train_time:397755ms step_avg:360.29ms
step:1115/1750 train_loss:3.3027 train_time:398135ms step_avg:360.30ms
step:1116/1750 train_loss:3.4836 train_time:398508ms step_avg:360.31ms
step:1117/1750 train_loss:3.6487 train_time:398892ms step_avg:360.34ms
step:1118/1750 train_loss:3.6793 train_time:399273ms step_avg:360.35ms
step:1119/1750 train_loss:3.5367 train_time:399647ms step_avg:360.37ms
step:1120/1750 train_loss:3.5515 train_time:400026ms step_avg:360.38ms
step:1121/1750 train_loss:3.4459 train_time:400405ms step_avg:360.40ms
step:1122/1750 train_loss:3.5127 train_time:400779ms step_avg:360.41ms
step:1123/1750 train_loss:3.6428 train_time:401155ms step_avg:360.43ms
step:1124/1750 train_loss:3.4060 train_time:401533ms step_avg:360.44ms
step:1125/1750 train_loss:3.2894 train_time:401911ms step_avg:360.46ms
step:1125/1750 val_loss:3.4714 train_time:402011ms step_avg:360.55ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 281.28989 | frobenius_norm = 64859.26562 | spectral_norm = 11641.79297 | nuclear_norm = 1630603.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 175.20920 | spectral_norm = 30.99826 | nuclear_norm = 4037.79395
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 170.06358 | spectral_norm = 35.04655 | nuclear_norm = 3893.56445
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 323.80048 | spectral_norm = 21.30952 | nuclear_norm = 7884.84473
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 236.60080 | spectral_norm = 24.03269 | nuclear_norm = 5465.48535
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 381.46658 | spectral_norm = 30.31991 | nuclear_norm = 10150.39648
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 190.75655 | spectral_norm = 17.30971 | nuclear_norm = 5033.28809
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 174.93814 | spectral_norm = 17.80094 | nuclear_norm = 4027.01562
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 172.80911 | spectral_norm = 18.44324 | nuclear_norm = 3990.58350
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 298.15326 | spectral_norm = 27.10263 | nuclear_norm = 6822.81006
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 303.58487 | spectral_norm = 23.52514 | nuclear_norm = 7074.02930
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 377.07529 | spectral_norm = 28.39627 | nuclear_norm = 10041.83398
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 187.12766 | spectral_norm = 19.54289 | nuclear_norm = 4919.60645
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 169.86372 | spectral_norm = 16.59412 | nuclear_norm = 3744.43018
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 169.17592 | spectral_norm = 15.94292 | nuclear_norm = 3747.27319
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 324.11615 | spectral_norm = 30.49715 | nuclear_norm = 7384.69287
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 328.90503 | spectral_norm = 25.37831 | nuclear_norm = 7718.07715
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 381.27386 | spectral_norm = 32.36511 | nuclear_norm = 10154.57422
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 190.14233 | spectral_norm = 19.37226 | nuclear_norm = 5013.72900
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 172.51355 | spectral_norm = 17.04548 | nuclear_norm = 3925.64795
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 170.83237 | spectral_norm = 16.08697 | nuclear_norm = 3886.41113
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 339.77536 | spectral_norm = 30.88177 | nuclear_norm = 7738.93994
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 336.72482 | spectral_norm = 25.16784 | nuclear_norm = 7929.75830
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 384.08777 | spectral_norm = 31.04462 | nuclear_norm = 10240.39062
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 189.69081 | spectral_norm = 18.26499 | nuclear_norm = 5008.25000
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 172.97905 | spectral_norm = 18.20105 | nuclear_norm = 3940.58154
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 169.51953 | spectral_norm = 16.89590 | nuclear_norm = 3896.90356
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 350.99271 | spectral_norm = 29.95358 | nuclear_norm = 7964.21484
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 344.88120 | spectral_norm = 26.02105 | nuclear_norm = 8100.62793
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 384.56879 | spectral_norm = 33.94199 | nuclear_norm = 10244.96484
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 186.54224 | spectral_norm = 17.48151 | nuclear_norm = 4890.08545
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 169.67529 | spectral_norm = 18.13783 | nuclear_norm = 3865.60645
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 167.39439 | spectral_norm = 17.76602 | nuclear_norm = 3849.79980
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 319.08170 | spectral_norm = 27.28997 | nuclear_norm = 7188.55908
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 326.14752 | spectral_norm = 25.78346 | nuclear_norm = 7513.06641
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 392.59082 | spectral_norm = 31.00480 | nuclear_norm = 10430.02344
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 190.40976 | spectral_norm = 19.62168 | nuclear_norm = 4995.52783
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 166.81235 | spectral_norm = 16.48878 | nuclear_norm = 3734.37500
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 165.25740 | spectral_norm = 16.05344 | nuclear_norm = 3713.76904
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 342.50125 | spectral_norm = 30.45756 | nuclear_norm = 7713.30615
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 340.68451 | spectral_norm = 27.27651 | nuclear_norm = 7969.73145
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 392.30566 | spectral_norm = 29.14400 | nuclear_norm = 10453.36523
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 191.53728 | spectral_norm = 20.24559 | nuclear_norm = 5050.80078
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 176.38924 | spectral_norm = 17.16028 | nuclear_norm = 4019.20166
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 174.51967 | spectral_norm = 18.44251 | nuclear_norm = 3978.35571
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 361.69937 | spectral_norm = 35.49437 | nuclear_norm = 8113.86230
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 340.38806 | spectral_norm = 25.65789 | nuclear_norm = 8017.62354
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 383.04221 | spectral_norm = 32.32771 | nuclear_norm = 10199.29102
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 196.02956 | spectral_norm = 19.00186 | nuclear_norm = 5187.48047
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 172.40550 | spectral_norm = 17.34939 | nuclear_norm = 3879.27368
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 171.94095 | spectral_norm = 16.53478 | nuclear_norm = 3868.50317
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 350.57983 | spectral_norm = 29.98355 | nuclear_norm = 7951.91943
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 341.21643 | spectral_norm = 27.27051 | nuclear_norm = 7994.04883
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 391.51947 | spectral_norm = 32.78449 | nuclear_norm = 10416.36426
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 197.91310 | spectral_norm = 19.63529 | nuclear_norm = 5243.49658
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 175.25172 | spectral_norm = 18.99690 | nuclear_norm = 3941.75757
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 173.45972 | spectral_norm = 16.97966 | nuclear_norm = 3882.77441
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 346.55179 | spectral_norm = 36.87381 | nuclear_norm = 7778.24854
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 342.39252 | spectral_norm = 25.58760 | nuclear_norm = 8083.91113
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 393.20801 | spectral_norm = 33.50912 | nuclear_norm = 10446.91406
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 193.89619 | spectral_norm = 22.36348 | nuclear_norm = 5133.44727
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 174.15892 | spectral_norm = 20.31528 | nuclear_norm = 3822.57495
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 174.71327 | spectral_norm = 18.42206 | nuclear_norm = 3776.15576
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 350.72964 | spectral_norm = 34.86452 | nuclear_norm = 8029.34912
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 355.49063 | spectral_norm = 24.50611 | nuclear_norm = 8371.38477
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 398.19400 | spectral_norm = 29.38127 | nuclear_norm = 10616.90527
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 187.23450 | spectral_norm = 23.57334 | nuclear_norm = 4950.53711
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 176.41582 | spectral_norm = 20.20333 | nuclear_norm = 3943.59253
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 174.89082 | spectral_norm = 19.50546 | nuclear_norm = 3897.18213
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 315.80093 | spectral_norm = 31.23169 | nuclear_norm = 7212.65234
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 351.83328 | spectral_norm = 26.24154 | nuclear_norm = 8228.42578
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 409.32730 | spectral_norm = 31.98559 | nuclear_norm = 10888.69824
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 191.48775 | spectral_norm = 24.02805 | nuclear_norm = 5030.12891
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1243.72168 | spectral_norm = 185.63054 | nuclear_norm = 32657.67383
===========================================
step:1126/1750 train_loss:3.5369 train_time:402278ms step_avg:360.46ms
step:1127/1750 train_loss:3.7442 train_time:402644ms step_avg:360.47ms
step:1128/1750 train_loss:3.2897 train_time:403019ms step_avg:360.48ms
step:1129/1750 train_loss:3.6202 train_time:403397ms step_avg:360.50ms
step:1130/1750 train_loss:3.4427 train_time:403775ms step_avg:360.51ms
step:1131/1750 train_loss:3.4609 train_time:404160ms step_avg:360.54ms
step:1132/1750 train_loss:3.4242 train_time:404530ms step_avg:360.54ms
step:1133/1750 train_loss:3.5576 train_time:404971ms step_avg:360.62ms
step:1134/1750 train_loss:3.5086 train_time:405457ms step_avg:360.73ms
step:1135/1750 train_loss:3.5797 train_time:405833ms step_avg:360.74ms
step:1136/1750 train_loss:3.6194 train_time:406209ms step_avg:360.75ms
step:1137/1750 train_loss:3.5171 train_time:406583ms step_avg:360.77ms
step:1138/1750 train_loss:3.4176 train_time:406960ms step_avg:360.78ms
step:1139/1750 train_loss:3.7097 train_time:407465ms step_avg:360.91ms
step:1140/1750 train_loss:3.5237 train_time:407839ms step_avg:360.92ms
step:1141/1750 train_loss:3.6538 train_time:408222ms step_avg:360.94ms
step:1142/1750 train_loss:3.5184 train_time:408601ms step_avg:360.95ms
step:1143/1750 train_loss:3.4265 train_time:408983ms step_avg:360.97ms
step:1144/1750 train_loss:3.5050 train_time:409359ms step_avg:360.99ms
step:1145/1750 train_loss:3.6576 train_time:409731ms step_avg:361.00ms
step:1146/1750 train_loss:3.6139 train_time:410111ms step_avg:361.01ms
step:1147/1750 train_loss:3.5666 train_time:410489ms step_avg:361.03ms
step:1148/1750 train_loss:3.5596 train_time:410862ms step_avg:361.04ms
step:1149/1750 train_loss:3.3935 train_time:411239ms step_avg:361.05ms
step:1150/1750 train_loss:3.4282 train_time:411612ms step_avg:361.06ms
step:1151/1750 train_loss:3.3831 train_time:411989ms step_avg:361.08ms
step:1152/1750 train_loss:3.4700 train_time:412371ms step_avg:361.10ms
step:1153/1750 train_loss:3.4916 train_time:412752ms step_avg:361.11ms
step:1154/1750 train_loss:3.5806 train_time:413123ms step_avg:361.12ms
step:1155/1750 train_loss:3.3824 train_time:413505ms step_avg:361.14ms
step:1156/1750 train_loss:3.5992 train_time:413892ms step_avg:361.16ms
step:1157/1750 train_loss:3.5568 train_time:414272ms step_avg:361.18ms
step:1158/1750 train_loss:3.3241 train_time:414646ms step_avg:361.19ms
step:1159/1750 train_loss:3.4023 train_time:415023ms step_avg:361.20ms
step:1160/1750 train_loss:3.3955 train_time:415392ms step_avg:361.21ms
step:1161/1750 train_loss:3.1512 train_time:415771ms step_avg:361.23ms
step:1162/1750 train_loss:3.4851 train_time:416146ms step_avg:361.24ms
step:1163/1750 train_loss:3.4499 train_time:416524ms step_avg:361.25ms
step:1164/1750 train_loss:3.3541 train_time:416899ms step_avg:361.26ms
step:1165/1750 train_loss:3.3096 train_time:417271ms step_avg:361.27ms
step:1166/1750 train_loss:3.4408 train_time:417647ms step_avg:361.29ms
step:1167/1750 train_loss:3.4633 train_time:418020ms step_avg:361.30ms
step:1168/1750 train_loss:3.7805 train_time:418396ms step_avg:361.31ms
step:1169/1750 train_loss:3.4387 train_time:418777ms step_avg:361.33ms
step:1170/1750 train_loss:3.4503 train_time:419158ms step_avg:361.34ms
step:1171/1750 train_loss:3.3648 train_time:419539ms step_avg:361.36ms
step:1172/1750 train_loss:3.4821 train_time:419917ms step_avg:361.37ms
step:1173/1750 train_loss:3.6000 train_time:420307ms step_avg:361.40ms
step:1174/1750 train_loss:3.4452 train_time:420707ms step_avg:361.43ms
step:1175/1750 train_loss:3.4382 train_time:421092ms step_avg:361.45ms
step:1176/1750 train_loss:3.4798 train_time:421486ms step_avg:361.48ms
step:1177/1750 train_loss:3.5094 train_time:421879ms step_avg:361.51ms
step:1178/1750 train_loss:3.5564 train_time:422256ms step_avg:361.52ms
step:1179/1750 train_loss:3.4664 train_time:422639ms step_avg:361.54ms
step:1180/1750 train_loss:3.4197 train_time:423041ms step_avg:361.57ms
step:1181/1750 train_loss:3.4041 train_time:423423ms step_avg:361.59ms
step:1182/1750 train_loss:3.4475 train_time:423803ms step_avg:361.61ms
step:1183/1750 train_loss:3.3951 train_time:424185ms step_avg:361.62ms
step:1184/1750 train_loss:3.5694 train_time:424568ms step_avg:361.64ms
step:1185/1750 train_loss:3.6101 train_time:424956ms step_avg:361.66ms
step:1186/1750 train_loss:3.4268 train_time:425343ms step_avg:361.69ms
step:1187/1750 train_loss:3.4769 train_time:425743ms step_avg:361.72ms
step:1188/1750 train_loss:3.5037 train_time:426120ms step_avg:361.73ms
step:1189/1750 train_loss:3.3341 train_time:426506ms step_avg:361.75ms
step:1190/1750 train_loss:3.5076 train_time:426892ms step_avg:361.77ms
step:1191/1750 train_loss:3.6448 train_time:427281ms step_avg:361.80ms
step:1192/1750 train_loss:3.4519 train_time:427662ms step_avg:361.81ms
step:1193/1750 train_loss:3.3394 train_time:428042ms step_avg:361.83ms
step:1194/1750 train_loss:3.6195 train_time:428423ms step_avg:361.84ms
step:1195/1750 train_loss:3.4372 train_time:428816ms step_avg:361.87ms
step:1196/1750 train_loss:3.4467 train_time:429223ms step_avg:361.91ms
step:1197/1750 train_loss:3.3548 train_time:429610ms step_avg:361.93ms
step:1198/1750 train_loss:3.3639 train_time:430007ms step_avg:361.96ms
step:1199/1750 train_loss:3.4025 train_time:430392ms step_avg:361.98ms
step:1200/1750 train_loss:3.5046 train_time:430777ms step_avg:362.00ms
step:1201/1750 train_loss:3.5413 train_time:431158ms step_avg:362.01ms
step:1202/1750 train_loss:3.7322 train_time:431565ms step_avg:362.05ms
step:1203/1750 train_loss:3.4676 train_time:431954ms step_avg:362.07ms
step:1204/1750 train_loss:3.3724 train_time:432341ms step_avg:362.09ms
step:1205/1750 train_loss:3.4879 train_time:432723ms step_avg:362.11ms
step:1206/1750 train_loss:3.5324 train_time:433103ms step_avg:362.13ms
step:1207/1750 train_loss:3.5807 train_time:433482ms step_avg:362.14ms
step:1208/1750 train_loss:3.4646 train_time:433856ms step_avg:362.15ms
step:1209/1750 train_loss:3.2929 train_time:434242ms step_avg:362.17ms
step:1210/1750 train_loss:3.3693 train_time:434632ms step_avg:362.19ms
step:1211/1750 train_loss:3.4628 train_time:435010ms step_avg:362.21ms
step:1212/1750 train_loss:3.4559 train_time:435388ms step_avg:362.22ms
step:1213/1750 train_loss:3.4786 train_time:435773ms step_avg:362.24ms
step:1214/1750 train_loss:3.3331 train_time:436162ms step_avg:362.26ms
step:1215/1750 train_loss:3.4533 train_time:436540ms step_avg:362.27ms
step:1216/1750 train_loss:3.3852 train_time:436921ms step_avg:362.29ms
step:1217/1750 train_loss:3.3919 train_time:437304ms step_avg:362.31ms
step:1218/1750 train_loss:3.4774 train_time:437690ms step_avg:362.33ms
step:1219/1750 train_loss:3.3240 train_time:438084ms step_avg:362.35ms
step:1220/1750 train_loss:3.5330 train_time:438464ms step_avg:362.37ms
step:1221/1750 train_loss:3.5733 train_time:438842ms step_avg:362.38ms
step:1222/1750 train_loss:3.5072 train_time:439221ms step_avg:362.39ms
step:1223/1750 train_loss:3.3566 train_time:439604ms step_avg:362.41ms
step:1224/1750 train_loss:3.3196 train_time:439994ms step_avg:362.43ms
step:1225/1750 train_loss:3.4345 train_time:440377ms step_avg:362.45ms
step:1226/1750 train_loss:3.3885 train_time:440765ms step_avg:362.47ms
step:1227/1750 train_loss:3.3276 train_time:441154ms step_avg:362.49ms
step:1228/1750 train_loss:3.5078 train_time:441532ms step_avg:362.51ms
step:1229/1750 train_loss:3.4305 train_time:441916ms step_avg:362.52ms
step:1230/1750 train_loss:3.4613 train_time:442311ms step_avg:362.55ms
step:1231/1750 train_loss:3.6409 train_time:442700ms step_avg:362.57ms
step:1232/1750 train_loss:3.5528 train_time:443086ms step_avg:362.59ms
step:1233/1750 train_loss:3.4850 train_time:443463ms step_avg:362.60ms
step:1234/1750 train_loss:3.6485 train_time:443843ms step_avg:362.62ms
step:1235/1750 train_loss:3.3860 train_time:444228ms step_avg:362.63ms
step:1236/1750 train_loss:3.3509 train_time:444606ms step_avg:362.65ms
step:1237/1750 train_loss:3.3310 train_time:444986ms step_avg:362.66ms
step:1238/1750 train_loss:3.3492 train_time:445378ms step_avg:362.69ms
step:1239/1750 train_loss:3.3855 train_time:445760ms step_avg:362.70ms
step:1240/1750 train_loss:3.4454 train_time:446147ms step_avg:362.72ms
step:1241/1750 train_loss:3.4946 train_time:446533ms step_avg:362.74ms
step:1242/1750 train_loss:3.3602 train_time:446910ms step_avg:362.75ms
step:1243/1750 train_loss:3.4721 train_time:447291ms step_avg:362.77ms
step:1244/1750 train_loss:3.4713 train_time:447667ms step_avg:362.78ms
step:1245/1750 train_loss:3.4812 train_time:448046ms step_avg:362.79ms
step:1246/1750 train_loss:3.2995 train_time:448428ms step_avg:362.81ms
step:1247/1750 train_loss:3.4435 train_time:448807ms step_avg:362.82ms
step:1248/1750 train_loss:3.4976 train_time:449182ms step_avg:362.83ms
step:1249/1750 train_loss:3.4839 train_time:449560ms step_avg:362.84ms
step:1250/1750 train_loss:3.3627 train_time:449938ms step_avg:362.85ms
step:1250/1750 val_loss:3.4185 train_time:450043ms step_avg:362.94ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 289.78030 | frobenius_norm = 66858.57812 | spectral_norm = 11987.27441 | nuclear_norm = 1683246.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 183.64044 | spectral_norm = 33.54661 | nuclear_norm = 4222.50537
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 178.51965 | spectral_norm = 37.61358 | nuclear_norm = 4080.58350
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 339.30719 | spectral_norm = 22.32482 | nuclear_norm = 8280.25879
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 243.01956 | spectral_norm = 25.07296 | nuclear_norm = 5599.15332
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 402.46075 | spectral_norm = 32.22406 | nuclear_norm = 10708.39258
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 200.70863 | spectral_norm = 18.40150 | nuclear_norm = 5293.60449
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 184.02367 | spectral_norm = 18.97774 | nuclear_norm = 4228.26660
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 181.90213 | spectral_norm = 19.43121 | nuclear_norm = 4195.93994
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 312.59540 | spectral_norm = 28.71360 | nuclear_norm = 7151.42676
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 318.14771 | spectral_norm = 24.85272 | nuclear_norm = 7413.45361
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 396.29224 | spectral_norm = 30.22210 | nuclear_norm = 10553.20605
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 196.31334 | spectral_norm = 20.80501 | nuclear_norm = 5158.90039
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 178.19972 | spectral_norm = 17.53057 | nuclear_norm = 3914.51221
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 177.64462 | spectral_norm = 16.86704 | nuclear_norm = 3919.45361
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 340.21347 | spectral_norm = 32.22177 | nuclear_norm = 7749.63135
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 344.72525 | spectral_norm = 26.64041 | nuclear_norm = 8088.51758
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 400.41299 | spectral_norm = 34.89735 | nuclear_norm = 10663.05566
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 199.95129 | spectral_norm = 20.69491 | nuclear_norm = 5271.22754
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 181.22023 | spectral_norm = 18.09223 | nuclear_norm = 4116.65137
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 179.42001 | spectral_norm = 17.14511 | nuclear_norm = 4075.96191
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 357.35156 | spectral_norm = 32.61352 | nuclear_norm = 8142.87695
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 353.52328 | spectral_norm = 26.35635 | nuclear_norm = 8329.09375
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 403.41919 | spectral_norm = 33.19081 | nuclear_norm = 10755.09082
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 199.44601 | spectral_norm = 19.39528 | nuclear_norm = 5266.12793
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 181.97984 | spectral_norm = 19.23034 | nuclear_norm = 4138.03076
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 178.17456 | spectral_norm = 17.91831 | nuclear_norm = 4090.04883
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 369.88058 | spectral_norm = 31.51860 | nuclear_norm = 8399.88281
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 363.43286 | spectral_norm = 27.31365 | nuclear_norm = 8539.32422
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 403.41183 | spectral_norm = 36.37086 | nuclear_norm = 10746.18262
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 195.99208 | spectral_norm = 18.61889 | nuclear_norm = 5137.57812
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 178.36028 | spectral_norm = 19.40757 | nuclear_norm = 4052.62061
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 175.83830 | spectral_norm = 18.80582 | nuclear_norm = 4037.32275
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 336.84451 | spectral_norm = 28.64468 | nuclear_norm = 7598.60156
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 344.00833 | spectral_norm = 26.94015 | nuclear_norm = 7930.73730
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 412.02371 | spectral_norm = 33.06173 | nuclear_norm = 10943.65234
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 199.98108 | spectral_norm = 20.98265 | nuclear_norm = 5245.36133
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 174.99208 | spectral_norm = 17.46890 | nuclear_norm = 3904.58350
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 173.38058 | spectral_norm = 16.95358 | nuclear_norm = 3885.14258
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 360.56177 | spectral_norm = 31.94633 | nuclear_norm = 8130.56104
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 357.26596 | spectral_norm = 28.37086 | nuclear_norm = 8357.39355
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 413.46085 | spectral_norm = 31.17201 | nuclear_norm = 11017.08203
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 201.50458 | spectral_norm = 21.76152 | nuclear_norm = 5311.89258
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 185.23369 | spectral_norm = 18.27911 | nuclear_norm = 4210.37891
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 183.27551 | spectral_norm = 19.47559 | nuclear_norm = 4168.18018
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 380.31604 | spectral_norm = 38.27664 | nuclear_norm = 8520.54102
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 357.31216 | spectral_norm = 27.13858 | nuclear_norm = 8418.19336
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 402.68756 | spectral_norm = 34.49832 | nuclear_norm = 10720.79883
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 206.07704 | spectral_norm = 20.27810 | nuclear_norm = 5452.93945
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 180.80634 | spectral_norm = 18.56317 | nuclear_norm = 4056.26709
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 180.52803 | spectral_norm = 17.57879 | nuclear_norm = 4052.32227
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 368.48465 | spectral_norm = 31.60281 | nuclear_norm = 8358.38965
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 358.00449 | spectral_norm = 28.70731 | nuclear_norm = 8383.77148
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 412.27441 | spectral_norm = 34.71976 | nuclear_norm = 10966.20703
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 208.23776 | spectral_norm = 20.92506 | nuclear_norm = 5516.72070
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 184.20425 | spectral_norm = 20.21906 | nuclear_norm = 4128.56445
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 182.38181 | spectral_norm = 18.09654 | nuclear_norm = 4070.54590
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 364.45560 | spectral_norm = 38.98130 | nuclear_norm = 8166.41455
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 358.88815 | spectral_norm = 26.85052 | nuclear_norm = 8474.07031
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 413.74655 | spectral_norm = 35.44589 | nuclear_norm = 10986.77148
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 203.92967 | spectral_norm = 23.91007 | nuclear_norm = 5398.16162
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 182.72627 | spectral_norm = 21.71121 | nuclear_norm = 3991.49097
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 183.47058 | spectral_norm = 19.63879 | nuclear_norm = 3940.74976
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 368.85095 | spectral_norm = 37.21164 | nuclear_norm = 8435.63965
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 373.03351 | spectral_norm = 25.79063 | nuclear_norm = 8783.93652
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 418.45361 | spectral_norm = 31.21242 | nuclear_norm = 11154.58301
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 196.79935 | spectral_norm = 25.22480 | nuclear_norm = 5202.50244
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 185.21127 | spectral_norm = 21.52155 | nuclear_norm = 4125.91553
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 183.47502 | spectral_norm = 20.79798 | nuclear_norm = 4074.44141
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 333.28552 | spectral_norm = 33.44594 | nuclear_norm = 7607.25537
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 370.53711 | spectral_norm = 27.77304 | nuclear_norm = 8659.79102
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 430.17340 | spectral_norm = 33.67329 | nuclear_norm = 11438.11230
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 201.23622 | spectral_norm = 25.70583 | nuclear_norm = 5283.72461
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1294.43115 | spectral_norm = 186.68027 | nuclear_norm = 34069.02344
===========================================
step:1251/1750 train_loss:3.5596 train_time:450322ms step_avg:362.87ms
step:1252/1750 train_loss:3.4308 train_time:450694ms step_avg:362.88ms
step:1253/1750 train_loss:3.3741 train_time:451068ms step_avg:362.89ms
step:1254/1750 train_loss:3.4770 train_time:451448ms step_avg:362.90ms
step:1255/1750 train_loss:3.5805 train_time:451843ms step_avg:362.93ms
step:1256/1750 train_loss:3.3673 train_time:452227ms step_avg:362.94ms
step:1257/1750 train_loss:3.4323 train_time:452604ms step_avg:362.95ms
step:1258/1750 train_loss:3.4146 train_time:452990ms step_avg:362.97ms
step:1259/1750 train_loss:3.3958 train_time:453367ms step_avg:362.98ms
step:1260/1750 train_loss:3.2701 train_time:453740ms step_avg:362.99ms
step:1261/1750 train_loss:3.3593 train_time:454121ms step_avg:363.01ms
step:1262/1750 train_loss:3.3868 train_time:454510ms step_avg:363.03ms
step:1263/1750 train_loss:3.2892 train_time:454895ms step_avg:363.04ms
step:1264/1750 train_loss:3.5058 train_time:455269ms step_avg:363.05ms
step:1265/1750 train_loss:3.4880 train_time:455643ms step_avg:363.06ms
step:1266/1750 train_loss:3.5002 train_time:456022ms step_avg:363.07ms
step:1267/1750 train_loss:3.4311 train_time:456399ms step_avg:363.09ms
step:1268/1750 train_loss:3.4674 train_time:456777ms step_avg:363.10ms
step:1269/1750 train_loss:3.3186 train_time:457162ms step_avg:363.12ms
step:1270/1750 train_loss:3.1627 train_time:457542ms step_avg:363.13ms
step:1271/1750 train_loss:3.4622 train_time:457922ms step_avg:363.14ms
step:1272/1750 train_loss:3.4209 train_time:458298ms step_avg:363.15ms
step:1273/1750 train_loss:3.4546 train_time:458683ms step_avg:363.17ms
step:1274/1750 train_loss:3.4138 train_time:459067ms step_avg:363.19ms
step:1275/1750 train_loss:3.4957 train_time:459442ms step_avg:363.20ms
step:1276/1750 train_loss:3.5308 train_time:459813ms step_avg:363.20ms
step:1277/1750 train_loss:3.4742 train_time:460192ms step_avg:363.21ms
step:1278/1750 train_loss:3.4607 train_time:460566ms step_avg:363.22ms
step:1279/1750 train_loss:3.3221 train_time:460948ms step_avg:363.24ms
step:1280/1750 train_loss:3.4344 train_time:461336ms step_avg:363.26ms
step:1281/1750 train_loss:3.4897 train_time:461713ms step_avg:363.27ms
step:1282/1750 train_loss:3.5311 train_time:462086ms step_avg:363.28ms
step:1283/1750 train_loss:3.3957 train_time:462471ms step_avg:363.29ms
step:1284/1750 train_loss:3.4336 train_time:462851ms step_avg:363.31ms
step:1285/1750 train_loss:3.4176 train_time:463229ms step_avg:363.32ms
step:1286/1750 train_loss:3.3938 train_time:463609ms step_avg:363.33ms
step:1287/1750 train_loss:3.5530 train_time:463987ms step_avg:363.34ms
step:1288/1750 train_loss:3.3595 train_time:464368ms step_avg:363.36ms
step:1289/1750 train_loss:3.4469 train_time:464758ms step_avg:363.38ms
step:1290/1750 train_loss:3.5201 train_time:465149ms step_avg:363.40ms
step:1291/1750 train_loss:3.4404 train_time:465532ms step_avg:363.41ms
step:1292/1750 train_loss:3.5329 train_time:465916ms step_avg:363.43ms
step:1293/1750 train_loss:3.5759 train_time:466299ms step_avg:363.44ms
step:1294/1750 train_loss:3.5286 train_time:466681ms step_avg:363.46ms
step:1295/1750 train_loss:3.3470 train_time:467060ms step_avg:363.47ms
step:1296/1750 train_loss:3.4350 train_time:467442ms step_avg:363.49ms
step:1297/1750 train_loss:3.3401 train_time:467823ms step_avg:363.50ms
step:1298/1750 train_loss:3.3377 train_time:468207ms step_avg:363.51ms
step:1299/1750 train_loss:3.4572 train_time:468588ms step_avg:363.53ms
step:1300/1750 train_loss:3.4694 train_time:468973ms step_avg:363.54ms
step:1301/1750 train_loss:3.4672 train_time:469351ms step_avg:363.56ms
step:1302/1750 train_loss:3.6363 train_time:469744ms step_avg:363.58ms
step:1303/1750 train_loss:3.3654 train_time:470137ms step_avg:363.60ms
step:1304/1750 train_loss:3.5651 train_time:470526ms step_avg:363.62ms
step:1305/1750 train_loss:3.3297 train_time:470908ms step_avg:363.64ms
step:1306/1750 train_loss:3.5147 train_time:471301ms step_avg:363.66ms
step:1307/1750 train_loss:3.5187 train_time:471677ms step_avg:363.67ms
step:1308/1750 train_loss:3.3500 train_time:472059ms step_avg:363.68ms
step:1309/1750 train_loss:3.3701 train_time:472447ms step_avg:363.70ms
step:1310/1750 train_loss:3.3557 train_time:472831ms step_avg:363.72ms
step:1311/1750 train_loss:3.3561 train_time:473215ms step_avg:363.73ms
step:1312/1750 train_loss:3.4463 train_time:473605ms step_avg:363.75ms
step:1313/1750 train_loss:3.4081 train_time:473986ms step_avg:363.76ms
step:1314/1750 train_loss:3.1028 train_time:474377ms step_avg:363.79ms
step:1315/1750 train_loss:3.3398 train_time:474759ms step_avg:363.80ms
step:1316/1750 train_loss:3.4525 train_time:475134ms step_avg:363.81ms
step:1317/1750 train_loss:3.4826 train_time:475514ms step_avg:363.82ms
step:1318/1750 train_loss:3.3594 train_time:475911ms step_avg:363.85ms
step:1319/1750 train_loss:3.4878 train_time:476302ms step_avg:363.87ms
step:1320/1750 train_loss:3.5137 train_time:476695ms step_avg:363.89ms
step:1321/1750 train_loss:3.4246 train_time:477083ms step_avg:363.91ms
step:1322/1750 train_loss:3.3787 train_time:477525ms step_avg:363.97ms
step:1323/1750 train_loss:3.3838 train_time:478028ms step_avg:364.07ms
step:1324/1750 train_loss:3.4943 train_time:478416ms step_avg:364.09ms
step:1325/1750 train_loss:3.5564 train_time:478815ms step_avg:364.12ms
step:1326/1750 train_loss:3.2828 train_time:479203ms step_avg:364.14ms
step:1327/1750 train_loss:3.2258 train_time:479583ms step_avg:364.15ms
step:1328/1750 train_loss:3.5533 train_time:479975ms step_avg:364.17ms
step:1329/1750 train_loss:3.3502 train_time:480518ms step_avg:364.30ms
step:1330/1750 train_loss:3.4809 train_time:480909ms step_avg:364.33ms
step:1331/1750 train_loss:3.3951 train_time:481288ms step_avg:364.34ms
step:1332/1750 train_loss:3.8057 train_time:481676ms step_avg:364.35ms
step:1333/1750 train_loss:3.5326 train_time:482065ms step_avg:364.37ms
step:1334/1750 train_loss:3.4275 train_time:482450ms step_avg:364.39ms
step:1335/1750 train_loss:3.3581 train_time:482834ms step_avg:364.40ms
step:1336/1750 train_loss:3.3514 train_time:483230ms step_avg:364.43ms
step:1337/1750 train_loss:3.6136 train_time:483619ms step_avg:364.45ms
step:1338/1750 train_loss:3.5796 train_time:484007ms step_avg:364.46ms
step:1339/1750 train_loss:3.4026 train_time:484399ms step_avg:364.48ms
step:1340/1750 train_loss:3.3412 train_time:484787ms step_avg:364.50ms
step:1341/1750 train_loss:3.6530 train_time:485170ms step_avg:364.52ms
step:1342/1750 train_loss:3.4193 train_time:485557ms step_avg:364.53ms
step:1343/1750 train_loss:3.4244 train_time:485936ms step_avg:364.54ms
step:1344/1750 train_loss:3.4783 train_time:486326ms step_avg:364.56ms
step:1345/1750 train_loss:3.4449 train_time:486721ms step_avg:364.59ms
step:1346/1750 train_loss:3.3590 train_time:487103ms step_avg:364.60ms
step:1347/1750 train_loss:3.3302 train_time:487488ms step_avg:364.61ms
step:1348/1750 train_loss:3.4108 train_time:487873ms step_avg:364.63ms
step:1349/1750 train_loss:3.3329 train_time:488259ms step_avg:364.64ms
step:1350/1750 train_loss:3.4476 train_time:488650ms step_avg:364.66ms
step:1351/1750 train_loss:3.3041 train_time:489028ms step_avg:364.67ms
step:1352/1750 train_loss:3.3615 train_time:489412ms step_avg:364.69ms
step:1353/1750 train_loss:3.4706 train_time:489805ms step_avg:364.71ms
step:1354/1750 train_loss:3.3127 train_time:490191ms step_avg:364.73ms
step:1355/1750 train_loss:3.2515 train_time:490576ms step_avg:364.74ms
step:1356/1750 train_loss:3.5811 train_time:490963ms step_avg:364.76ms
step:1357/1750 train_loss:3.4861 train_time:491353ms step_avg:364.78ms
step:1358/1750 train_loss:3.2377 train_time:491740ms step_avg:364.79ms
step:1359/1750 train_loss:3.5012 train_time:492127ms step_avg:364.81ms
step:1360/1750 train_loss:3.4134 train_time:492515ms step_avg:364.83ms
step:1361/1750 train_loss:3.2016 train_time:492906ms step_avg:364.85ms
step:1362/1750 train_loss:3.4494 train_time:493293ms step_avg:364.86ms
step:1363/1750 train_loss:3.3356 train_time:493686ms step_avg:364.88ms
step:1364/1750 train_loss:3.3682 train_time:494065ms step_avg:364.89ms
step:1365/1750 train_loss:3.3776 train_time:494446ms step_avg:364.90ms
step:1366/1750 train_loss:3.4827 train_time:494833ms step_avg:364.92ms
step:1367/1750 train_loss:3.4546 train_time:495216ms step_avg:364.93ms
step:1368/1750 train_loss:3.4074 train_time:495602ms step_avg:364.95ms
step:1369/1750 train_loss:3.3237 train_time:496000ms step_avg:364.97ms
step:1370/1750 train_loss:3.6636 train_time:496386ms step_avg:364.99ms
step:1371/1750 train_loss:3.3758 train_time:496774ms step_avg:365.01ms
step:1372/1750 train_loss:3.4272 train_time:497162ms step_avg:365.02ms
step:1373/1750 train_loss:3.4253 train_time:497543ms step_avg:365.04ms
step:1374/1750 train_loss:3.2149 train_time:497927ms step_avg:365.05ms
step:1375/1750 train_loss:3.5988 train_time:498307ms step_avg:365.06ms
step:1375/1750 val_loss:3.3715 train_time:498408ms step_avg:365.13ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 294.44376 | frobenius_norm = 67961.57812 | spectral_norm = 12189.87305 | nuclear_norm = 1712771.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 188.46950 | spectral_norm = 35.36473 | nuclear_norm = 4325.64111
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 183.48695 | spectral_norm = 39.41835 | nuclear_norm = 4189.04541
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 348.79956 | spectral_norm = 23.00081 | nuclear_norm = 8528.41602
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 245.98862 | spectral_norm = 25.83910 | nuclear_norm = 5653.85400
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 415.24225 | spectral_norm = 33.59127 | nuclear_norm = 11047.73633
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 206.77255 | spectral_norm = 19.07474 | nuclear_norm = 5452.46191
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 189.57782 | spectral_norm = 19.84155 | nuclear_norm = 4351.60791
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 187.33737 | spectral_norm = 20.02276 | nuclear_norm = 4318.90674
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 321.81766 | spectral_norm = 29.64109 | nuclear_norm = 7361.81152
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 327.19608 | spectral_norm = 25.65193 | nuclear_norm = 7627.45703
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 407.80859 | spectral_norm = 31.35437 | nuclear_norm = 10858.88965
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 201.95450 | spectral_norm = 21.66258 | nuclear_norm = 5305.80225
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 183.22482 | spectral_norm = 18.15742 | nuclear_norm = 4014.59570
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 182.71004 | spectral_norm = 17.48942 | nuclear_norm = 4018.81055
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 350.43277 | spectral_norm = 33.33306 | nuclear_norm = 7983.93213
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 354.65012 | spectral_norm = 27.33188 | nuclear_norm = 8322.79590
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 412.04709 | spectral_norm = 36.62658 | nuclear_norm = 10971.13379
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 205.91312 | spectral_norm = 21.56359 | nuclear_norm = 5428.51270
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 186.50032 | spectral_norm = 18.62277 | nuclear_norm = 4231.12891
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 184.66122 | spectral_norm = 17.72206 | nuclear_norm = 4189.59326
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 368.49228 | spectral_norm = 33.56324 | nuclear_norm = 8402.08984
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 364.06396 | spectral_norm = 27.25208 | nuclear_norm = 8581.73340
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 414.87546 | spectral_norm = 34.67831 | nuclear_norm = 11059.62207
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 205.37759 | spectral_norm = 20.11195 | nuclear_norm = 5424.29590
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 187.50642 | spectral_norm = 19.99342 | nuclear_norm = 4257.57861
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 183.56578 | spectral_norm = 18.50897 | nuclear_norm = 4212.16455
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 381.89355 | spectral_norm = 32.50201 | nuclear_norm = 8682.69824
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 375.13705 | spectral_norm = 28.12307 | nuclear_norm = 8819.80566
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 414.59009 | spectral_norm = 37.81875 | nuclear_norm = 11044.44531
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 201.71854 | spectral_norm = 19.39323 | nuclear_norm = 5288.38135
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 183.58125 | spectral_norm = 20.30282 | nuclear_norm = 4162.47168
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 180.86964 | spectral_norm = 19.41293 | nuclear_norm = 4148.06152
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 348.62924 | spectral_norm = 29.68369 | nuclear_norm = 7876.88867
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 355.64667 | spectral_norm = 27.76882 | nuclear_norm = 8210.07129
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 423.42798 | spectral_norm = 34.32751 | nuclear_norm = 11243.98926
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 205.74326 | spectral_norm = 21.91420 | nuclear_norm = 5395.49072
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 179.86700 | spectral_norm = 18.13646 | nuclear_norm = 4001.51782
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 178.25659 | spectral_norm = 17.52093 | nuclear_norm = 3985.39893
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 371.77744 | spectral_norm = 32.92337 | nuclear_norm = 8396.55859
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 367.38318 | spectral_norm = 29.06183 | nuclear_norm = 8595.36914
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 426.00266 | spectral_norm = 32.50857 | nuclear_norm = 11349.91016
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 207.55507 | spectral_norm = 22.71671 | nuclear_norm = 5470.73926
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 190.41798 | spectral_norm = 18.97009 | nuclear_norm = 4319.38525
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 188.59285 | spectral_norm = 20.03278 | nuclear_norm = 4280.57031
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 392.13818 | spectral_norm = 39.89885 | nuclear_norm = 8780.21191
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 367.74017 | spectral_norm = 27.83066 | nuclear_norm = 8664.60449
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 414.31946 | spectral_norm = 35.87966 | nuclear_norm = 11027.98926
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 212.10477 | spectral_norm = 21.11453 | nuclear_norm = 5612.29346
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 185.83116 | spectral_norm = 19.28544 | nuclear_norm = 4157.50439
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 185.78308 | spectral_norm = 18.23716 | nuclear_norm = 4160.67871
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 379.64920 | spectral_norm = 32.52835 | nuclear_norm = 8618.49609
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 368.34982 | spectral_norm = 29.62118 | nuclear_norm = 8622.87305
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 424.62451 | spectral_norm = 35.96530 | nuclear_norm = 11291.38281
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 214.44933 | spectral_norm = 21.78424 | nuclear_norm = 5680.72070
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 189.51749 | spectral_norm = 21.05112 | nuclear_norm = 4235.21631
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 187.73994 | spectral_norm = 18.87137 | nuclear_norm = 4178.41064
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 376.08841 | spectral_norm = 40.45628 | nuclear_norm = 8423.68652
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 369.01907 | spectral_norm = 27.59122 | nuclear_norm = 8710.02930
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 425.78464 | spectral_norm = 36.59808 | nuclear_norm = 11301.13672
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 210.06863 | spectral_norm = 24.95464 | nuclear_norm = 5559.57080
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 187.74763 | spectral_norm = 22.69945 | nuclear_norm = 4081.56738
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 188.62721 | spectral_norm = 20.34603 | nuclear_norm = 4028.52759
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 381.19931 | spectral_norm = 38.61630 | nuclear_norm = 8710.62598
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 383.96365 | spectral_norm = 26.50842 | nuclear_norm = 9039.39844
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 430.08353 | spectral_norm = 32.32299 | nuclear_norm = 11462.58301
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 202.92122 | spectral_norm = 26.27295 | nuclear_norm = 5364.04688
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 190.45547 | spectral_norm = 22.48979 | nuclear_norm = 4229.98584
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 188.47247 | spectral_norm = 21.65085 | nuclear_norm = 4170.55371
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 346.53394 | spectral_norm = 35.06640 | nuclear_norm = 7906.27051
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 382.23096 | spectral_norm = 28.65510 | nuclear_norm = 8928.78906
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 441.56677 | spectral_norm = 34.74284 | nuclear_norm = 11737.19043
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 207.25130 | spectral_norm = 26.76071 | nuclear_norm = 5439.33105
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1319.45874 | spectral_norm = 186.66687 | nuclear_norm = 34798.03906
===========================================
step:1376/1750 train_loss:3.4013 train_time:498681ms step_avg:365.07ms
step:1377/1750 train_loss:3.5376 train_time:499055ms step_avg:365.07ms
step:1378/1750 train_loss:3.5393 train_time:499433ms step_avg:365.08ms
step:1379/1750 train_loss:3.1898 train_time:499820ms step_avg:365.10ms
step:1380/1750 train_loss:3.3763 train_time:500200ms step_avg:365.11ms
step:1381/1750 train_loss:3.7758 train_time:500590ms step_avg:365.13ms
step:1382/1750 train_loss:3.2715 train_time:500971ms step_avg:365.14ms
step:1383/1750 train_loss:3.4493 train_time:501356ms step_avg:365.15ms
step:1384/1750 train_loss:3.5356 train_time:501742ms step_avg:365.17ms
step:1385/1750 train_loss:3.4609 train_time:502117ms step_avg:365.18ms
step:1386/1750 train_loss:3.4086 train_time:502500ms step_avg:365.19ms
step:1387/1750 train_loss:3.2578 train_time:502884ms step_avg:365.20ms
step:1388/1750 train_loss:3.4004 train_time:503263ms step_avg:365.21ms
step:1389/1750 train_loss:3.3752 train_time:503648ms step_avg:365.23ms
step:1390/1750 train_loss:3.6311 train_time:504027ms step_avg:365.24ms
step:1391/1750 train_loss:3.3491 train_time:504411ms step_avg:365.25ms
step:1392/1750 train_loss:3.3473 train_time:504792ms step_avg:365.26ms
step:1393/1750 train_loss:3.3013 train_time:505169ms step_avg:365.27ms
step:1394/1750 train_loss:3.5668 train_time:505545ms step_avg:365.28ms
step:1395/1750 train_loss:3.4535 train_time:505926ms step_avg:365.29ms
step:1396/1750 train_loss:3.4686 train_time:506304ms step_avg:365.30ms
step:1397/1750 train_loss:3.3620 train_time:506680ms step_avg:365.31ms
step:1398/1750 train_loss:3.3107 train_time:507060ms step_avg:365.32ms
step:1399/1750 train_loss:3.3840 train_time:507444ms step_avg:365.33ms
step:1400/1750 train_loss:3.3750 train_time:507840ms step_avg:365.35ms
step:1401/1750 train_loss:3.4036 train_time:508210ms step_avg:365.36ms
step:1402/1750 train_loss:3.3556 train_time:508588ms step_avg:365.36ms
step:1403/1750 train_loss:3.5530 train_time:508977ms step_avg:365.38ms
step:1404/1750 train_loss:3.3355 train_time:509355ms step_avg:365.39ms
step:1405/1750 train_loss:3.3648 train_time:509735ms step_avg:365.40ms
step:1406/1750 train_loss:3.3671 train_time:510117ms step_avg:365.41ms
step:1407/1750 train_loss:3.2338 train_time:510495ms step_avg:365.42ms
step:1408/1750 train_loss:3.3661 train_time:510880ms step_avg:365.44ms
step:1409/1750 train_loss:3.3533 train_time:511283ms step_avg:365.46ms
step:1410/1750 train_loss:3.3418 train_time:511663ms step_avg:365.47ms
step:1411/1750 train_loss:3.4238 train_time:512039ms step_avg:365.48ms
step:1412/1750 train_loss:3.3881 train_time:512419ms step_avg:365.49ms
step:1413/1750 train_loss:3.4161 train_time:512803ms step_avg:365.50ms
step:1414/1750 train_loss:3.3946 train_time:513188ms step_avg:365.52ms
step:1415/1750 train_loss:3.4745 train_time:513584ms step_avg:365.54ms
step:1416/1750 train_loss:3.2836 train_time:513990ms step_avg:365.57ms
step:1417/1750 train_loss:3.3417 train_time:514380ms step_avg:365.59ms
step:1418/1750 train_loss:3.4450 train_time:514763ms step_avg:365.60ms
step:1419/1750 train_loss:3.4012 train_time:515152ms step_avg:365.62ms
step:1420/1750 train_loss:3.4120 train_time:515540ms step_avg:365.63ms
step:1421/1750 train_loss:3.4288 train_time:515924ms step_avg:365.64ms
step:1422/1750 train_loss:3.3963 train_time:516304ms step_avg:365.65ms
step:1423/1750 train_loss:3.3771 train_time:516684ms step_avg:365.66ms
step:1424/1750 train_loss:3.3863 train_time:517076ms step_avg:365.68ms
step:1425/1750 train_loss:3.2434 train_time:517473ms step_avg:365.71ms
step:1426/1750 train_loss:3.3837 train_time:517856ms step_avg:365.72ms
step:1427/1750 train_loss:3.3305 train_time:518246ms step_avg:365.73ms
step:1428/1750 train_loss:3.4312 train_time:518628ms step_avg:365.75ms
step:1429/1750 train_loss:3.4100 train_time:519009ms step_avg:365.76ms
step:1430/1750 train_loss:3.3200 train_time:519398ms step_avg:365.77ms
step:1431/1750 train_loss:3.3796 train_time:519792ms step_avg:365.79ms
step:1432/1750 train_loss:3.3938 train_time:520186ms step_avg:365.81ms
step:1433/1750 train_loss:3.1949 train_time:520588ms step_avg:365.84ms
step:1434/1750 train_loss:3.3433 train_time:520989ms step_avg:365.86ms
step:1435/1750 train_loss:3.1750 train_time:521378ms step_avg:365.88ms
step:1436/1750 train_loss:3.2782 train_time:521764ms step_avg:365.89ms
step:1437/1750 train_loss:3.4653 train_time:522148ms step_avg:365.91ms
step:1438/1750 train_loss:3.4337 train_time:522534ms step_avg:365.92ms
step:1439/1750 train_loss:3.3718 train_time:522923ms step_avg:365.94ms
step:1440/1750 train_loss:3.2421 train_time:523304ms step_avg:365.95ms
step:1441/1750 train_loss:3.4015 train_time:523690ms step_avg:365.96ms
step:1442/1750 train_loss:3.4379 train_time:524085ms step_avg:365.98ms
step:1443/1750 train_loss:3.5285 train_time:524490ms step_avg:366.01ms
step:1444/1750 train_loss:3.5009 train_time:524872ms step_avg:366.02ms
step:1445/1750 train_loss:3.3899 train_time:525260ms step_avg:366.03ms
step:1446/1750 train_loss:3.2535 train_time:525656ms step_avg:366.06ms
step:1447/1750 train_loss:3.3503 train_time:526050ms step_avg:366.08ms
step:1448/1750 train_loss:3.3469 train_time:526433ms step_avg:366.09ms
step:1449/1750 train_loss:3.4596 train_time:526817ms step_avg:366.10ms
step:1450/1750 train_loss:3.4460 train_time:527205ms step_avg:366.11ms
step:1451/1750 train_loss:3.2617 train_time:527590ms step_avg:366.13ms
step:1452/1750 train_loss:3.3808 train_time:527979ms step_avg:366.14ms
step:1453/1750 train_loss:3.3144 train_time:528356ms step_avg:366.15ms
step:1454/1750 train_loss:3.3388 train_time:528738ms step_avg:366.16ms
step:1455/1750 train_loss:3.3826 train_time:529130ms step_avg:366.18ms
step:1456/1750 train_loss:3.3322 train_time:529511ms step_avg:366.19ms
step:1457/1750 train_loss:3.2113 train_time:529894ms step_avg:366.20ms
step:1458/1750 train_loss:3.4732 train_time:530280ms step_avg:366.22ms
step:1459/1750 train_loss:3.3227 train_time:530673ms step_avg:366.23ms
step:1460/1750 train_loss:3.3671 train_time:531057ms step_avg:366.25ms
step:1461/1750 train_loss:3.4888 train_time:531443ms step_avg:366.26ms
step:1462/1750 train_loss:3.3165 train_time:531825ms step_avg:366.27ms
step:1463/1750 train_loss:3.5194 train_time:532218ms step_avg:366.29ms
step:1464/1750 train_loss:3.4111 train_time:532607ms step_avg:366.30ms
step:1465/1750 train_loss:3.4066 train_time:532992ms step_avg:366.32ms
step:1466/1750 train_loss:3.3390 train_time:533377ms step_avg:366.33ms
step:1467/1750 train_loss:3.4446 train_time:533768ms step_avg:366.35ms
step:1468/1750 train_loss:3.3400 train_time:534152ms step_avg:366.36ms
step:1469/1750 train_loss:3.3195 train_time:534542ms step_avg:366.38ms
step:1470/1750 train_loss:3.3838 train_time:534940ms step_avg:366.40ms
step:1471/1750 train_loss:3.3089 train_time:535343ms step_avg:366.42ms
step:1472/1750 train_loss:3.2999 train_time:535744ms step_avg:366.45ms
step:1473/1750 train_loss:3.4859 train_time:536128ms step_avg:366.46ms
step:1474/1750 train_loss:3.3680 train_time:536524ms step_avg:366.48ms
step:1475/1750 train_loss:3.1948 train_time:536923ms step_avg:366.50ms
step:1476/1750 train_loss:3.3148 train_time:537308ms step_avg:366.51ms
step:1477/1750 train_loss:3.2913 train_time:537706ms step_avg:366.53ms
step:1478/1750 train_loss:3.3622 train_time:538102ms step_avg:366.55ms
step:1479/1750 train_loss:3.4472 train_time:538490ms step_avg:366.57ms
step:1480/1750 train_loss:3.3256 train_time:538872ms step_avg:366.58ms
step:1481/1750 train_loss:3.5045 train_time:539261ms step_avg:366.59ms
step:1482/1750 train_loss:3.4197 train_time:539664ms step_avg:366.62ms
step:1483/1750 train_loss:3.3279 train_time:540075ms step_avg:366.65ms
step:1484/1750 train_loss:3.3117 train_time:540472ms step_avg:366.67ms
step:1485/1750 train_loss:3.3271 train_time:540856ms step_avg:366.68ms
step:1486/1750 train_loss:3.2736 train_time:541247ms step_avg:366.70ms
step:1487/1750 train_loss:3.3912 train_time:541640ms step_avg:366.72ms
step:1488/1750 train_loss:3.2812 train_time:542035ms step_avg:366.74ms
step:1489/1750 train_loss:3.3727 train_time:542424ms step_avg:366.75ms
step:1490/1750 train_loss:3.2994 train_time:542815ms step_avg:366.77ms
step:1491/1750 train_loss:3.2121 train_time:543202ms step_avg:366.78ms
step:1492/1750 train_loss:3.3139 train_time:543587ms step_avg:366.79ms
step:1493/1750 train_loss:3.4855 train_time:543967ms step_avg:366.80ms
step:1494/1750 train_loss:3.3473 train_time:544348ms step_avg:366.81ms
step:1495/1750 train_loss:3.0823 train_time:544739ms step_avg:366.83ms
step:1496/1750 train_loss:3.4085 train_time:545128ms step_avg:366.84ms
step:1497/1750 train_loss:3.3573 train_time:545518ms step_avg:366.86ms
step:1498/1750 train_loss:3.3906 train_time:545915ms step_avg:366.88ms
step:1499/1750 train_loss:3.3648 train_time:546317ms step_avg:366.90ms
step:1500/1750 train_loss:3.3422 train_time:546729ms step_avg:366.93ms
step:1500/1750 val_loss:3.3277 train_time:546836ms step_avg:367.00ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.49353 | frobenius_norm = 68447.96875 | spectral_norm = 12283.41211 | nuclear_norm = 1726242.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 190.66924 | spectral_norm = 36.58689 | nuclear_norm = 4369.62842
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 185.94072 | spectral_norm = 40.47526 | nuclear_norm = 4240.84717
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 354.21997 | spectral_norm = 23.34124 | nuclear_norm = 8671.73242
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 247.28319 | spectral_norm = 26.29430 | nuclear_norm = 5673.02637
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 422.34961 | spectral_norm = 34.39652 | nuclear_norm = 11236.57715
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 210.06995 | spectral_norm = 19.50176 | nuclear_norm = 5539.53809
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 192.55128 | spectral_norm = 20.36334 | nuclear_norm = 4416.26758
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 190.28421 | spectral_norm = 20.42390 | nuclear_norm = 4384.91113
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 326.96930 | spectral_norm = 30.13821 | nuclear_norm = 7482.06836
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 332.24271 | spectral_norm = 26.17386 | nuclear_norm = 7747.82324
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 414.11722 | spectral_norm = 32.01805 | nuclear_norm = 11026.14453
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 204.98888 | spectral_norm = 22.13278 | nuclear_norm = 5384.63770
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 185.84183 | spectral_norm = 18.55280 | nuclear_norm = 4063.17578
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 185.32893 | spectral_norm = 17.89075 | nuclear_norm = 4067.23535
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 356.24271 | spectral_norm = 33.85012 | nuclear_norm = 8120.97705
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 360.21887 | spectral_norm = 27.72587 | nuclear_norm = 8456.76562
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 418.31351 | spectral_norm = 37.60612 | nuclear_norm = 11136.26367
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 209.11012 | spectral_norm = 21.98787 | nuclear_norm = 5512.86230
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 189.23302 | spectral_norm = 18.99053 | nuclear_norm = 4286.23633
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 187.43393 | spectral_norm = 18.07763 | nuclear_norm = 4246.68213
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 374.87415 | spectral_norm = 34.14420 | nuclear_norm = 8553.69824
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 369.96460 | spectral_norm = 27.73960 | nuclear_norm = 8724.66211
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 421.02664 | spectral_norm = 35.40119 | nuclear_norm = 11223.11914
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 208.59143 | spectral_norm = 20.51341 | nuclear_norm = 5510.74756
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 190.35370 | spectral_norm = 20.30978 | nuclear_norm = 4316.34619
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 186.31708 | spectral_norm = 18.90187 | nuclear_norm = 4272.81934
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 388.91006 | spectral_norm = 33.09809 | nuclear_norm = 8850.57715
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 381.89597 | spectral_norm = 28.60034 | nuclear_norm = 8983.47070
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 420.46469 | spectral_norm = 38.57800 | nuclear_norm = 11201.70508
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 204.81001 | spectral_norm = 19.81930 | nuclear_norm = 5369.98389
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 186.34572 | spectral_norm = 20.78402 | nuclear_norm = 4218.72363
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 183.52806 | spectral_norm = 19.77836 | nuclear_norm = 4205.63770
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 355.74850 | spectral_norm = 30.29615 | nuclear_norm = 8049.17139
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 362.54794 | spectral_norm = 28.20513 | nuclear_norm = 8378.90918
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 429.39685 | spectral_norm = 35.04781 | nuclear_norm = 11399.70215
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 208.75653 | spectral_norm = 22.44367 | nuclear_norm = 5473.80273
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 182.27411 | spectral_norm = 18.53412 | nuclear_norm = 4043.70166
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 180.67851 | spectral_norm = 17.81799 | nuclear_norm = 4031.59937
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 378.35068 | spectral_norm = 33.29773 | nuclear_norm = 8558.54395
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 373.16632 | spectral_norm = 29.42341 | nuclear_norm = 8732.21094
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 432.72852 | spectral_norm = 33.17137 | nuclear_norm = 11526.84766
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 210.73265 | spectral_norm = 23.19994 | nuclear_norm = 5553.92480
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 193.09361 | spectral_norm = 19.40795 | nuclear_norm = 4371.75781
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 191.42091 | spectral_norm = 20.35878 | nuclear_norm = 4338.89941
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 398.99619 | spectral_norm = 40.92154 | nuclear_norm = 8933.37598
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 373.53522 | spectral_norm = 28.30248 | nuclear_norm = 8800.64746
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 420.35657 | spectral_norm = 36.63370 | nuclear_norm = 11187.58203
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 215.20782 | spectral_norm = 21.56398 | nuclear_norm = 5694.40771
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 188.38216 | spectral_norm = 19.69996 | nuclear_norm = 4205.55762
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 188.43867 | spectral_norm = 18.63269 | nuclear_norm = 4212.94043
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 386.03973 | spectral_norm = 33.10766 | nuclear_norm = 8768.84180
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 374.01645 | spectral_norm = 30.17230 | nuclear_norm = 8754.17188
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 431.16022 | spectral_norm = 36.59689 | nuclear_norm = 11462.50977
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 217.66035 | spectral_norm = 22.23692 | nuclear_norm = 5765.14258
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 192.26877 | spectral_norm = 21.52689 | nuclear_norm = 4285.97754
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 190.46439 | spectral_norm = 19.31435 | nuclear_norm = 4228.45654
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 383.14267 | spectral_norm = 41.39075 | nuclear_norm = 8580.78711
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 374.78503 | spectral_norm = 28.07530 | nuclear_norm = 8843.40918
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 432.06058 | spectral_norm = 37.27915 | nuclear_norm = 11462.72852
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 213.35019 | spectral_norm = 25.49318 | nuclear_norm = 5645.88477
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 190.26283 | spectral_norm = 23.24609 | nuclear_norm = 4119.32617
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 191.26796 | spectral_norm = 20.86503 | nuclear_norm = 4065.94824
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 389.07761 | spectral_norm = 39.48353 | nuclear_norm = 8886.98926
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 390.05386 | spectral_norm = 26.91480 | nuclear_norm = 9181.24609
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 435.70493 | spectral_norm = 32.95433 | nuclear_norm = 11610.26758
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 206.27351 | spectral_norm = 26.75271 | nuclear_norm = 5452.68066
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 193.09351 | spectral_norm = 23.05884 | nuclear_norm = 4278.08105
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 190.96457 | spectral_norm = 22.11642 | nuclear_norm = 4211.80322
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 355.33588 | spectral_norm = 36.15857 | nuclear_norm = 8105.81836
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 389.12076 | spectral_norm = 29.18805 | nuclear_norm = 9084.99023
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 446.76147 | spectral_norm = 35.13162 | nuclear_norm = 11872.17871
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 210.50377 | spectral_norm = 27.27480 | nuclear_norm = 5523.28027
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1327.75781 | spectral_norm = 185.70352 | nuclear_norm = 35073.73438
===========================================
step:1501/1750 train_loss:3.1327 train_time:547112ms step_avg:366.94ms
step:1502/1750 train_loss:3.4097 train_time:547489ms step_avg:366.95ms
step:1503/1750 train_loss:3.2906 train_time:547868ms step_avg:366.96ms
step:1504/1750 train_loss:3.2948 train_time:548251ms step_avg:366.97ms
step:1505/1750 train_loss:3.2547 train_time:548632ms step_avg:366.98ms
step:1506/1750 train_loss:3.3244 train_time:549022ms step_avg:366.99ms
step:1507/1750 train_loss:3.2223 train_time:549430ms step_avg:367.02ms
step:1508/1750 train_loss:3.5245 train_time:549817ms step_avg:367.03ms
step:1509/1750 train_loss:3.3224 train_time:550198ms step_avg:367.04ms
step:1510/1750 train_loss:3.3200 train_time:550581ms step_avg:367.05ms
step:1511/1750 train_loss:3.4584 train_time:551009ms step_avg:367.09ms
step:1512/1750 train_loss:3.4630 train_time:551457ms step_avg:367.15ms
step:1513/1750 train_loss:3.3146 train_time:551848ms step_avg:367.16ms
step:1514/1750 train_loss:3.1373 train_time:552236ms step_avg:367.18ms
step:1515/1750 train_loss:3.2785 train_time:552624ms step_avg:367.19ms
step:1516/1750 train_loss:3.2939 train_time:553020ms step_avg:367.21ms
step:1517/1750 train_loss:3.3493 train_time:553406ms step_avg:367.22ms
step:1518/1750 train_loss:3.2564 train_time:553797ms step_avg:367.24ms
step:1519/1750 train_loss:3.5445 train_time:554301ms step_avg:367.33ms
step:1520/1750 train_loss:3.1739 train_time:554693ms step_avg:367.35ms
step:1521/1750 train_loss:3.2523 train_time:555076ms step_avg:367.36ms
step:1522/1750 train_loss:3.3965 train_time:555470ms step_avg:367.37ms
step:1523/1750 train_loss:3.2725 train_time:555853ms step_avg:367.38ms
step:1524/1750 train_loss:3.3911 train_time:556242ms step_avg:367.40ms
step:1525/1750 train_loss:3.3777 train_time:556644ms step_avg:367.42ms
step:1526/1750 train_loss:3.3149 train_time:557051ms step_avg:367.45ms
step:1527/1750 train_loss:3.3340 train_time:557439ms step_avg:367.46ms
step:1528/1750 train_loss:3.4534 train_time:557823ms step_avg:367.47ms
step:1529/1750 train_loss:3.4565 train_time:558203ms step_avg:367.48ms
step:1530/1750 train_loss:3.2799 train_time:558584ms step_avg:367.49ms
step:1531/1750 train_loss:3.2345 train_time:558971ms step_avg:367.50ms
step:1532/1750 train_loss:3.3854 train_time:559357ms step_avg:367.51ms
step:1533/1750 train_loss:3.3188 train_time:559756ms step_avg:367.53ms
step:1534/1750 train_loss:3.3194 train_time:560153ms step_avg:367.55ms
step:1535/1750 train_loss:3.3244 train_time:560540ms step_avg:367.57ms
step:1536/1750 train_loss:3.2663 train_time:560933ms step_avg:367.58ms
step:1537/1750 train_loss:3.3154 train_time:561321ms step_avg:367.60ms
step:1538/1750 train_loss:3.4714 train_time:561724ms step_avg:367.62ms
step:1539/1750 train_loss:3.4431 train_time:562119ms step_avg:367.64ms
step:1540/1750 train_loss:3.3167 train_time:562506ms step_avg:367.65ms
step:1541/1750 train_loss:3.2718 train_time:562897ms step_avg:367.67ms
step:1542/1750 train_loss:3.2898 train_time:563289ms step_avg:367.68ms
step:1543/1750 train_loss:3.1915 train_time:563676ms step_avg:367.69ms
step:1544/1750 train_loss:3.3322 train_time:564057ms step_avg:367.70ms
step:1545/1750 train_loss:3.3067 train_time:564448ms step_avg:367.72ms
step:1546/1750 train_loss:3.3003 train_time:564853ms step_avg:367.74ms
step:1547/1750 train_loss:3.2585 train_time:565247ms step_avg:367.76ms
step:1548/1750 train_loss:3.3079 train_time:565646ms step_avg:367.78ms
step:1549/1750 train_loss:3.3680 train_time:566028ms step_avg:367.79ms
step:1550/1750 train_loss:3.3357 train_time:566410ms step_avg:367.80ms
step:1551/1750 train_loss:3.2409 train_time:566800ms step_avg:367.81ms
step:1552/1750 train_loss:3.2595 train_time:567190ms step_avg:367.83ms
step:1553/1750 train_loss:3.2681 train_time:567573ms step_avg:367.84ms
step:1554/1750 train_loss:3.3999 train_time:567962ms step_avg:367.85ms
step:1555/1750 train_loss:3.3738 train_time:568354ms step_avg:367.87ms
step:1556/1750 train_loss:3.3146 train_time:568735ms step_avg:367.87ms
step:1557/1750 train_loss:3.3610 train_time:569114ms step_avg:367.88ms
step:1558/1750 train_loss:3.2990 train_time:569503ms step_avg:367.90ms
step:1559/1750 train_loss:3.1730 train_time:569907ms step_avg:367.92ms
step:1560/1750 train_loss:3.4696 train_time:570291ms step_avg:367.93ms
step:1561/1750 train_loss:3.2642 train_time:570679ms step_avg:367.94ms
step:1562/1750 train_loss:3.2558 train_time:571063ms step_avg:367.95ms
step:1563/1750 train_loss:3.3659 train_time:571450ms step_avg:367.97ms
step:1564/1750 train_loss:3.1955 train_time:571852ms step_avg:367.99ms
step:1565/1750 train_loss:3.2050 train_time:572249ms step_avg:368.01ms
step:1566/1750 train_loss:3.4037 train_time:572639ms step_avg:368.02ms
step:1567/1750 train_loss:3.2748 train_time:573027ms step_avg:368.03ms
step:1568/1750 train_loss:3.2818 train_time:573426ms step_avg:368.05ms
step:1569/1750 train_loss:3.3665 train_time:573847ms step_avg:368.09ms
step:1570/1750 train_loss:3.3186 train_time:574254ms step_avg:368.11ms
step:1571/1750 train_loss:3.2012 train_time:574652ms step_avg:368.13ms
step:1572/1750 train_loss:3.2349 train_time:575042ms step_avg:368.14ms
step:1573/1750 train_loss:3.3566 train_time:575435ms step_avg:368.16ms
step:1574/1750 train_loss:3.2129 train_time:575818ms step_avg:368.17ms
step:1575/1750 train_loss:3.3713 train_time:576204ms step_avg:368.18ms
step:1576/1750 train_loss:3.2712 train_time:576592ms step_avg:368.19ms
step:1577/1750 train_loss:3.3244 train_time:576990ms step_avg:368.21ms
step:1578/1750 train_loss:3.3074 train_time:577381ms step_avg:368.23ms
step:1579/1750 train_loss:3.2839 train_time:577779ms step_avg:368.25ms
step:1580/1750 train_loss:3.2424 train_time:578165ms step_avg:368.26ms
step:1581/1750 train_loss:3.4400 train_time:578561ms step_avg:368.28ms
step:1582/1750 train_loss:3.2608 train_time:578972ms step_avg:368.30ms
step:1583/1750 train_loss:3.4227 train_time:579378ms step_avg:368.33ms
step:1584/1750 train_loss:3.2383 train_time:579764ms step_avg:368.34ms
step:1585/1750 train_loss:3.4071 train_time:580162ms step_avg:368.36ms
step:1586/1750 train_loss:3.1870 train_time:580550ms step_avg:368.37ms
step:1587/1750 train_loss:3.3919 train_time:580936ms step_avg:368.38ms
step:1588/1750 train_loss:3.2694 train_time:581331ms step_avg:368.40ms
step:1589/1750 train_loss:3.4310 train_time:581720ms step_avg:368.41ms
step:1590/1750 train_loss:3.2762 train_time:582109ms step_avg:368.42ms
step:1591/1750 train_loss:3.2903 train_time:582502ms step_avg:368.44ms
step:1592/1750 train_loss:3.3572 train_time:582892ms step_avg:368.45ms
step:1593/1750 train_loss:3.3289 train_time:583296ms step_avg:368.48ms
step:1594/1750 train_loss:3.2995 train_time:583685ms step_avg:368.49ms
step:1595/1750 train_loss:3.4442 train_time:584075ms step_avg:368.50ms
step:1596/1750 train_loss:3.1569 train_time:584478ms step_avg:368.52ms
step:1597/1750 train_loss:3.3253 train_time:584881ms step_avg:368.54ms
step:1598/1750 train_loss:3.3748 train_time:585284ms step_avg:368.57ms
step:1599/1750 train_loss:3.4387 train_time:585690ms step_avg:368.59ms
step:1600/1750 train_loss:3.2698 train_time:586089ms step_avg:368.61ms
step:1601/1750 train_loss:3.5727 train_time:586476ms step_avg:368.62ms
step:1602/1750 train_loss:3.4451 train_time:586874ms step_avg:368.64ms
step:1603/1750 train_loss:3.2193 train_time:587279ms step_avg:368.66ms
step:1604/1750 train_loss:3.2557 train_time:587673ms step_avg:368.68ms
step:1605/1750 train_loss:3.1515 train_time:588083ms step_avg:368.70ms
step:1606/1750 train_loss:3.4617 train_time:588490ms step_avg:368.73ms
step:1607/1750 train_loss:3.2984 train_time:588882ms step_avg:368.74ms
step:1608/1750 train_loss:3.3008 train_time:589277ms step_avg:368.76ms
step:1609/1750 train_loss:3.2354 train_time:589675ms step_avg:368.78ms
step:1610/1750 train_loss:3.7433 train_time:590090ms step_avg:368.81ms
step:1611/1750 train_loss:3.4967 train_time:590493ms step_avg:368.83ms
step:1612/1750 train_loss:3.3880 train_time:590900ms step_avg:368.85ms
step:1613/1750 train_loss:3.2577 train_time:591315ms step_avg:368.88ms
step:1614/1750 train_loss:3.2883 train_time:591707ms step_avg:368.89ms
step:1615/1750 train_loss:3.3068 train_time:592111ms step_avg:368.92ms
step:1616/1750 train_loss:3.2773 train_time:592540ms step_avg:368.95ms
step:1617/1750 train_loss:3.3471 train_time:592958ms step_avg:368.98ms
step:1618/1750 train_loss:3.2725 train_time:593341ms step_avg:368.99ms
step:1619/1750 train_loss:3.1806 train_time:593735ms step_avg:369.01ms
step:1620/1750 train_loss:3.4553 train_time:594123ms step_avg:369.02ms
step:1621/1750 train_loss:3.3770 train_time:594526ms step_avg:369.04ms
step:1622/1750 train_loss:3.1541 train_time:594919ms step_avg:369.06ms
step:1623/1750 train_loss:3.2474 train_time:595314ms step_avg:369.07ms
step:1624/1750 train_loss:3.2071 train_time:595696ms step_avg:369.08ms
step:1625/1750 train_loss:3.3128 train_time:596080ms step_avg:369.09ms
step:1625/1750 val_loss:3.2924 train_time:596184ms step_avg:369.15ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.99701 | frobenius_norm = 68567.46875 | spectral_norm = 12318.13672 | nuclear_norm = 1729854.87500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 191.33585 | spectral_norm = 37.28553 | nuclear_norm = 4380.61719
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 186.75203 | spectral_norm = 40.97786 | nuclear_norm = 4256.66748
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 356.76862 | spectral_norm = 23.46199 | nuclear_norm = 8740.25977
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 247.38023 | spectral_norm = 26.48478 | nuclear_norm = 5670.03320
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 425.17871 | spectral_norm = 34.77584 | nuclear_norm = 11312.26855
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 211.42249 | spectral_norm = 19.67803 | nuclear_norm = 5575.43896
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 193.68237 | spectral_norm = 20.57107 | nuclear_norm = 4440.08447
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 191.48003 | spectral_norm = 20.61364 | nuclear_norm = 4411.31836
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 329.27747 | spectral_norm = 30.37046 | nuclear_norm = 7537.18262
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 334.52402 | spectral_norm = 26.41876 | nuclear_norm = 7803.41992
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 416.75604 | spectral_norm = 32.22882 | nuclear_norm = 11095.88477
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 206.21805 | spectral_norm = 22.32216 | nuclear_norm = 5416.43408
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 186.72853 | spectral_norm = 18.66315 | nuclear_norm = 4075.50146
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 186.26762 | spectral_norm = 18.07641 | nuclear_norm = 4079.91504
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 358.83078 | spectral_norm = 34.04844 | nuclear_norm = 8182.34814
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 362.69940 | spectral_norm = 27.93241 | nuclear_norm = 8517.95703
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 420.85297 | spectral_norm = 38.05183 | nuclear_norm = 11202.91406
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 210.39650 | spectral_norm = 22.18265 | nuclear_norm = 5546.91309
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 190.28665 | spectral_norm = 19.13241 | nuclear_norm = 4306.02148
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 188.46472 | spectral_norm = 18.26762 | nuclear_norm = 4266.57666
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 377.73694 | spectral_norm = 34.37171 | nuclear_norm = 8622.70703
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 372.63110 | spectral_norm = 27.95114 | nuclear_norm = 8790.67480
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 423.57028 | spectral_norm = 35.69162 | nuclear_norm = 11290.91504
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 209.89684 | spectral_norm = 20.67827 | nuclear_norm = 5546.40039
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 191.55757 | spectral_norm = 20.47154 | nuclear_norm = 4339.93750
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 187.44014 | spectral_norm = 19.06567 | nuclear_norm = 4296.26367
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 392.10535 | spectral_norm = 33.32650 | nuclear_norm = 8929.71582
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 384.98975 | spectral_norm = 28.81105 | nuclear_norm = 9059.80078
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 422.84634 | spectral_norm = 38.87093 | nuclear_norm = 11265.93652
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 206.05336 | spectral_norm = 20.00496 | nuclear_norm = 5402.99414
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 187.41701 | spectral_norm = 21.03414 | nuclear_norm = 4238.42920
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 184.54089 | spectral_norm = 19.90349 | nuclear_norm = 4227.05566
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 359.15732 | spectral_norm = 30.67308 | nuclear_norm = 8134.35498
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 365.85471 | spectral_norm = 28.38440 | nuclear_norm = 8461.33594
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 431.77191 | spectral_norm = 35.35524 | nuclear_norm = 11460.94531
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 209.93898 | spectral_norm = 22.68740 | nuclear_norm = 5504.45752
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 183.13242 | spectral_norm = 18.70173 | nuclear_norm = 4054.69678
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 181.56659 | spectral_norm = 17.96499 | nuclear_norm = 4044.62061
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 381.49997 | spectral_norm = 33.53183 | nuclear_norm = 8638.20215
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 375.91699 | spectral_norm = 29.56564 | nuclear_norm = 8799.17969
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 435.55109 | spectral_norm = 33.45787 | nuclear_norm = 11600.80859
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 211.99284 | spectral_norm = 23.41472 | nuclear_norm = 5586.82910
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 194.11510 | spectral_norm = 19.57295 | nuclear_norm = 4388.78271
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 192.48441 | spectral_norm = 20.44589 | nuclear_norm = 4358.56885
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 402.21219 | spectral_norm = 41.36896 | nuclear_norm = 9004.79199
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 376.14606 | spectral_norm = 28.46829 | nuclear_norm = 8861.87402
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 422.85608 | spectral_norm = 36.90810 | nuclear_norm = 11252.29395
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 216.42416 | spectral_norm = 21.75938 | nuclear_norm = 5726.54883
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 189.37434 | spectral_norm = 19.94009 | nuclear_norm = 4220.92676
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 189.44193 | spectral_norm = 18.81126 | nuclear_norm = 4229.67285
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 388.95004 | spectral_norm = 33.37324 | nuclear_norm = 8838.88086
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 376.61407 | spectral_norm = 30.41801 | nuclear_norm = 8811.80469
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 433.88348 | spectral_norm = 36.91274 | nuclear_norm = 11532.85254
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 218.91225 | spectral_norm = 22.39675 | nuclear_norm = 5798.00586
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 193.29958 | spectral_norm = 21.69732 | nuclear_norm = 4301.29688
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 191.52652 | spectral_norm = 19.50595 | nuclear_norm = 4244.43555
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 386.40488 | spectral_norm = 41.85841 | nuclear_norm = 8652.87402
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 377.45410 | spectral_norm = 28.29151 | nuclear_norm = 8905.65234
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 434.56967 | spectral_norm = 37.62101 | nuclear_norm = 11525.81934
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 214.63353 | spectral_norm = 25.68985 | nuclear_norm = 5679.44727
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 191.08310 | spectral_norm = 23.57309 | nuclear_norm = 4124.22949
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 192.18188 | spectral_norm = 21.13748 | nuclear_norm = 4071.01709
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 392.98358 | spectral_norm = 40.14217 | nuclear_norm = 8973.54688
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 392.92462 | spectral_norm = 27.10246 | nuclear_norm = 9246.33301
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 437.76965 | spectral_norm = 33.20049 | nuclear_norm = 11663.62500
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 207.62474 | spectral_norm = 26.90736 | nuclear_norm = 5488.41699
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 194.07149 | spectral_norm = 23.37687 | nuclear_norm = 4290.81836
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 191.84213 | spectral_norm = 22.34412 | nuclear_norm = 4221.14746
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 359.83298 | spectral_norm = 36.77886 | nuclear_norm = 8207.30176
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 392.35413 | spectral_norm = 29.43824 | nuclear_norm = 9156.26367
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 448.46527 | spectral_norm = 35.22467 | nuclear_norm = 11915.70508
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 211.83189 | spectral_norm = 27.43882 | nuclear_norm = 5557.22754
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1326.52185 | spectral_norm = 184.36076 | nuclear_norm = 35082.78125
===========================================
step:1626/1750 train_loss:3.2330 train_time:596467ms step_avg:369.10ms
step:1627/1750 train_loss:3.2365 train_time:596846ms step_avg:369.11ms
step:1628/1750 train_loss:3.3539 train_time:597233ms step_avg:369.12ms
step:1629/1750 train_loss:3.2421 train_time:597622ms step_avg:369.13ms
step:1630/1750 train_loss:3.3128 train_time:598020ms step_avg:369.15ms
step:1631/1750 train_loss:3.1716 train_time:598442ms step_avg:369.18ms
step:1632/1750 train_loss:3.1417 train_time:598829ms step_avg:369.19ms
step:1633/1750 train_loss:3.2926 train_time:599217ms step_avg:369.20ms
step:1634/1750 train_loss:3.3042 train_time:599600ms step_avg:369.21ms
step:1635/1750 train_loss:3.2461 train_time:600005ms step_avg:369.23ms
step:1636/1750 train_loss:3.3255 train_time:600395ms step_avg:369.25ms
step:1637/1750 train_loss:3.3700 train_time:600781ms step_avg:369.26ms
step:1638/1750 train_loss:3.3986 train_time:601173ms step_avg:369.27ms
step:1639/1750 train_loss:3.5693 train_time:601574ms step_avg:369.29ms
step:1640/1750 train_loss:3.3478 train_time:601972ms step_avg:369.31ms
step:1641/1750 train_loss:3.2878 train_time:602366ms step_avg:369.32ms
step:1642/1750 train_loss:3.4032 train_time:602755ms step_avg:369.34ms
step:1643/1750 train_loss:3.2672 train_time:603157ms step_avg:369.36ms
step:1644/1750 train_loss:3.3065 train_time:603547ms step_avg:369.37ms
step:1645/1750 train_loss:3.3134 train_time:603932ms step_avg:369.38ms
step:1646/1750 train_loss:3.0663 train_time:604322ms step_avg:369.39ms
step:1647/1750 train_loss:3.3168 train_time:604710ms step_avg:369.40ms
step:1648/1750 train_loss:3.2098 train_time:605100ms step_avg:369.41ms
step:1649/1750 train_loss:3.2860 train_time:605484ms step_avg:369.42ms
step:1650/1750 train_loss:3.2662 train_time:605869ms step_avg:369.43ms
step:1651/1750 train_loss:3.3397 train_time:606255ms step_avg:369.44ms
step:1652/1750 train_loss:3.2506 train_time:606644ms step_avg:369.45ms
step:1653/1750 train_loss:3.3851 train_time:607045ms step_avg:369.47ms
step:1654/1750 train_loss:3.3832 train_time:607433ms step_avg:369.48ms
step:1655/1750 train_loss:3.1757 train_time:607832ms step_avg:369.50ms
step:1656/1750 train_loss:3.3235 train_time:608243ms step_avg:369.53ms
step:1657/1750 train_loss:3.2458 train_time:608643ms step_avg:369.55ms
step:1658/1750 train_loss:3.2134 train_time:609029ms step_avg:369.56ms
step:1659/1750 train_loss:3.3008 train_time:609417ms step_avg:369.57ms
step:1660/1750 train_loss:3.3406 train_time:609805ms step_avg:369.58ms
step:1661/1750 train_loss:3.2439 train_time:610197ms step_avg:369.59ms
step:1662/1750 train_loss:3.3518 train_time:610582ms step_avg:369.60ms
step:1663/1750 train_loss:3.3442 train_time:610986ms step_avg:369.62ms
step:1664/1750 train_loss:3.3960 train_time:611409ms step_avg:369.65ms
step:1665/1750 train_loss:3.3268 train_time:611807ms step_avg:369.67ms
step:1666/1750 train_loss:3.4994 train_time:612199ms step_avg:369.69ms
step:1667/1750 train_loss:3.1986 train_time:612594ms step_avg:369.70ms
step:1668/1750 train_loss:3.2882 train_time:612990ms step_avg:369.72ms
step:1669/1750 train_loss:3.2047 train_time:613377ms step_avg:369.73ms
step:1670/1750 train_loss:3.2147 train_time:613769ms step_avg:369.74ms
step:1671/1750 train_loss:3.3653 train_time:614164ms step_avg:369.76ms
step:1672/1750 train_loss:3.5675 train_time:614556ms step_avg:369.77ms
step:1673/1750 train_loss:3.2714 train_time:614947ms step_avg:369.78ms
step:1674/1750 train_loss:3.2521 train_time:615338ms step_avg:369.79ms
step:1675/1750 train_loss:3.1268 train_time:615741ms step_avg:369.81ms
step:1676/1750 train_loss:3.3457 train_time:616141ms step_avg:369.83ms
step:1677/1750 train_loss:3.2752 train_time:616533ms step_avg:369.85ms
step:1678/1750 train_loss:3.2933 train_time:616926ms step_avg:369.86ms
step:1679/1750 train_loss:3.2978 train_time:617317ms step_avg:369.87ms
step:1680/1750 train_loss:3.0771 train_time:617734ms step_avg:369.90ms
step:1681/1750 train_loss:3.2937 train_time:618133ms step_avg:369.92ms
step:1682/1750 train_loss:3.2860 train_time:618532ms step_avg:369.94ms
step:1683/1750 train_loss:3.3022 train_time:618924ms step_avg:369.95ms
step:1684/1750 train_loss:3.3366 train_time:619311ms step_avg:369.96ms
step:1685/1750 train_loss:3.2354 train_time:619698ms step_avg:369.97ms
step:1686/1750 train_loss:3.3657 train_time:620094ms step_avg:369.98ms
step:1687/1750 train_loss:3.2350 train_time:620487ms step_avg:370.00ms
step:1688/1750 train_loss:3.3110 train_time:620897ms step_avg:370.02ms
step:1689/1750 train_loss:3.2189 train_time:621297ms step_avg:370.04ms
step:1690/1750 train_loss:3.0648 train_time:621700ms step_avg:370.06ms
step:1691/1750 train_loss:3.3005 train_time:622090ms step_avg:370.07ms
step:1692/1750 train_loss:3.2918 train_time:622478ms step_avg:370.08ms
step:1693/1750 train_loss:3.2092 train_time:622866ms step_avg:370.09ms
step:1694/1750 train_loss:3.6069 train_time:623269ms step_avg:370.11ms
step:1695/1750 train_loss:3.3232 train_time:623671ms step_avg:370.13ms
step:1696/1750 train_loss:3.3293 train_time:624066ms step_avg:370.15ms
step:1697/1750 train_loss:3.2495 train_time:624448ms step_avg:370.15ms
step:1698/1750 train_loss:3.1182 train_time:624837ms step_avg:370.16ms
step:1699/1750 train_loss:3.2296 train_time:625229ms step_avg:370.18ms
step:1700/1750 train_loss:3.2375 train_time:625668ms step_avg:370.22ms
step:1701/1750 train_loss:3.3159 train_time:626119ms step_avg:370.27ms
step:1702/1750 train_loss:3.2376 train_time:626505ms step_avg:370.27ms
step:1703/1750 train_loss:3.4103 train_time:626888ms step_avg:370.28ms
step:1704/1750 train_loss:3.2043 train_time:627273ms step_avg:370.29ms
step:1705/1750 train_loss:3.4297 train_time:627658ms step_avg:370.30ms
step:1706/1750 train_loss:3.2496 train_time:628040ms step_avg:370.31ms
step:1707/1750 train_loss:3.0475 train_time:628435ms step_avg:370.32ms
step:1708/1750 train_loss:3.3876 train_time:628825ms step_avg:370.33ms
step:1709/1750 train_loss:3.2878 train_time:629341ms step_avg:370.42ms
step:1710/1750 train_loss:3.2743 train_time:629752ms step_avg:370.44ms
step:1711/1750 train_loss:3.2802 train_time:630150ms step_avg:370.46ms
step:1712/1750 train_loss:3.3123 train_time:630546ms step_avg:370.47ms
step:1713/1750 train_loss:3.3317 train_time:630939ms step_avg:370.49ms
step:1714/1750 train_loss:3.2237 train_time:631342ms step_avg:370.51ms
step:1715/1750 train_loss:3.2757 train_time:631764ms step_avg:370.54ms
step:1716/1750 train_loss:3.0925 train_time:632152ms step_avg:370.55ms
step:1717/1750 train_loss:3.2419 train_time:632531ms step_avg:370.55ms
step:1718/1750 train_loss:3.2570 train_time:632920ms step_avg:370.56ms
step:1719/1750 train_loss:3.2158 train_time:633315ms step_avg:370.58ms
step:1720/1750 train_loss:3.3677 train_time:633726ms step_avg:370.60ms
step:1721/1750 train_loss:3.1604 train_time:634156ms step_avg:370.63ms
step:1722/1750 train_loss:3.3117 train_time:634552ms step_avg:370.65ms
step:1723/1750 train_loss:3.3996 train_time:634963ms step_avg:370.67ms
step:1724/1750 train_loss:3.2529 train_time:635358ms step_avg:370.69ms
step:1725/1750 train_loss:3.4847 train_time:635764ms step_avg:370.71ms
step:1726/1750 train_loss:3.2542 train_time:636171ms step_avg:370.73ms
step:1727/1750 train_loss:3.3243 train_time:636555ms step_avg:370.74ms
step:1728/1750 train_loss:3.2954 train_time:636947ms step_avg:370.75ms
step:1729/1750 train_loss:3.2708 train_time:637349ms step_avg:370.77ms
step:1730/1750 train_loss:3.6536 train_time:637750ms step_avg:370.78ms
step:1731/1750 train_loss:3.2922 train_time:638143ms step_avg:370.80ms
step:1732/1750 train_loss:3.4260 train_time:638538ms step_avg:370.81ms
step:1733/1750 train_loss:3.1994 train_time:638918ms step_avg:370.82ms
step:1734/1750 train_loss:3.2397 train_time:639308ms step_avg:370.83ms
step:1735/1750 train_loss:3.2724 train_time:639704ms step_avg:370.84ms
step:1736/1750 train_loss:3.2500 train_time:640104ms step_avg:370.86ms
step:1737/1750 train_loss:3.3779 train_time:640505ms step_avg:370.88ms
step:1738/1750 train_loss:3.2166 train_time:640923ms step_avg:370.90ms
step:1739/1750 train_loss:3.2821 train_time:641330ms step_avg:370.93ms
step:1740/1750 train_loss:3.3638 train_time:641727ms step_avg:370.94ms
step:1741/1750 train_loss:3.1571 train_time:642119ms step_avg:370.95ms
step:1742/1750 train_loss:3.0562 train_time:642515ms step_avg:370.97ms
step:1743/1750 train_loss:2.9462 train_time:642928ms step_avg:370.99ms
step:1744/1750 train_loss:3.2859 train_time:643317ms step_avg:371.00ms
step:1745/1750 train_loss:3.3083 train_time:643701ms step_avg:371.01ms
step:1746/1750 train_loss:3.2624 train_time:644089ms step_avg:371.02ms
step:1747/1750 train_loss:3.2925 train_time:644494ms step_avg:371.04ms
step:1748/1750 train_loss:3.4925 train_time:644917ms step_avg:371.07ms
step:1749/1750 train_loss:3.2210 train_time:645314ms step_avg:371.08ms
step:1750/1750 train_loss:3.2772 train_time:645720ms step_avg:371.10ms
step:1750/1750 val_loss:3.2713 train_time:645836ms step_avg:371.17ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 297.02252 | frobenius_norm = 68573.51562 | spectral_norm = 12325.19336 | nuclear_norm = 1730124.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 191.32462 | spectral_norm = 37.51376 | nuclear_norm = 4378.64258
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 186.82933 | spectral_norm = 41.12313 | nuclear_norm = 4257.28027
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 357.41315 | spectral_norm = 23.47299 | nuclear_norm = 8758.50586
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 247.24095 | spectral_norm = 26.53184 | nuclear_norm = 5664.17725
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 425.79868 | spectral_norm = 34.88781 | nuclear_norm = 11329.01758
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 211.70485 | spectral_norm = 19.72380 | nuclear_norm = 5583.06885
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 193.89467 | spectral_norm = 20.62524 | nuclear_norm = 4444.28223
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 191.70967 | spectral_norm = 20.66588 | nuclear_norm = 4415.90820
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 329.79947 | spectral_norm = 30.41030 | nuclear_norm = 7549.52148
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 335.02200 | spectral_norm = 26.45578 | nuclear_norm = 7816.19971
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 417.35037 | spectral_norm = 32.26710 | nuclear_norm = 11111.84961
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 206.44945 | spectral_norm = 22.37221 | nuclear_norm = 5422.24414
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 186.83711 | spectral_norm = 18.67412 | nuclear_norm = 4074.83887
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 186.40143 | spectral_norm = 18.11311 | nuclear_norm = 4079.79053
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 359.45432 | spectral_norm = 34.10197 | nuclear_norm = 8197.25586
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 363.29178 | spectral_norm = 27.96614 | nuclear_norm = 8533.40234
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 421.38660 | spectral_norm = 38.14468 | nuclear_norm = 11216.85547
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 210.63799 | spectral_norm = 22.23738 | nuclear_norm = 5553.38477
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 190.46756 | spectral_norm = 19.16537 | nuclear_norm = 4308.57812
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 188.65152 | spectral_norm = 18.29656 | nuclear_norm = 4269.68604
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 378.45584 | spectral_norm = 34.43944 | nuclear_norm = 8640.80078
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 373.29034 | spectral_norm = 27.98899 | nuclear_norm = 8807.82520
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 424.08963 | spectral_norm = 35.75818 | nuclear_norm = 11304.72168
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 210.15137 | spectral_norm = 20.71638 | nuclear_norm = 5553.51514
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 191.78625 | spectral_norm = 20.52358 | nuclear_norm = 4343.69141
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 187.66507 | spectral_norm = 19.09817 | nuclear_norm = 4300.84521
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 392.89789 | spectral_norm = 33.39564 | nuclear_norm = 8949.82812
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 385.74911 | spectral_norm = 28.85085 | nuclear_norm = 9079.17578
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 423.31213 | spectral_norm = 38.91206 | nuclear_norm = 11278.67188
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 206.28015 | spectral_norm = 20.05810 | nuclear_norm = 5409.18994
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 187.57172 | spectral_norm = 21.10571 | nuclear_norm = 4239.98730
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 184.68559 | spectral_norm = 19.93466 | nuclear_norm = 4229.37402
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 360.05853 | spectral_norm = 30.75199 | nuclear_norm = 8157.29736
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 366.72256 | spectral_norm = 28.42914 | nuclear_norm = 8483.58203
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 432.24777 | spectral_norm = 35.45583 | nuclear_norm = 11472.76270
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 210.13664 | spectral_norm = 22.74944 | nuclear_norm = 5509.36768
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 183.25113 | spectral_norm = 18.74186 | nuclear_norm = 4053.99341
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 181.69467 | spectral_norm = 18.00089 | nuclear_norm = 4044.71973
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 382.30768 | spectral_norm = 33.55587 | nuclear_norm = 8659.28711
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 376.63599 | spectral_norm = 29.60795 | nuclear_norm = 8817.05469
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 436.13089 | spectral_norm = 33.52171 | nuclear_norm = 11615.50195
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 212.21561 | spectral_norm = 23.46461 | nuclear_norm = 5592.60352
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 194.28143 | spectral_norm = 19.61852 | nuclear_norm = 4390.22754
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 192.68428 | spectral_norm = 20.43695 | nuclear_norm = 4361.50684
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 403.03482 | spectral_norm = 41.43053 | nuclear_norm = 9022.72949
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 376.76791 | spectral_norm = 28.51807 | nuclear_norm = 8876.31934
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 423.33530 | spectral_norm = 36.98412 | nuclear_norm = 11264.48730
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 216.62869 | spectral_norm = 21.80677 | nuclear_norm = 5731.90869
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 189.53621 | spectral_norm = 19.99506 | nuclear_norm = 4221.88721
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 189.61775 | spectral_norm = 18.83183 | nuclear_norm = 4231.54639
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 389.65042 | spectral_norm = 33.39717 | nuclear_norm = 8856.04004
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 377.24875 | spectral_norm = 30.49259 | nuclear_norm = 8826.23828
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 434.41656 | spectral_norm = 36.96723 | nuclear_norm = 11546.26172
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 219.12456 | spectral_norm = 22.43090 | nuclear_norm = 5803.42383
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 193.46458 | spectral_norm = 21.76470 | nuclear_norm = 4302.00098
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 191.69518 | spectral_norm = 19.55470 | nuclear_norm = 4245.33838
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 387.24219 | spectral_norm = 41.96408 | nuclear_norm = 8671.30078
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 378.11328 | spectral_norm = 28.35393 | nuclear_norm = 8920.89844
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 435.02280 | spectral_norm = 37.69158 | nuclear_norm = 11536.60449
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 214.84807 | spectral_norm = 25.71690 | nuclear_norm = 5684.90137
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 191.18698 | spectral_norm = 23.65191 | nuclear_norm = 4121.09229
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 192.30748 | spectral_norm = 21.19109 | nuclear_norm = 4067.50928
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 393.99966 | spectral_norm = 40.34650 | nuclear_norm = 8995.62500
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 393.63840 | spectral_norm = 27.16212 | nuclear_norm = 9262.26465
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 438.09320 | spectral_norm = 33.25443 | nuclear_norm = 11671.50000
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 207.86790 | spectral_norm = 26.92738 | nuclear_norm = 5494.72168
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 194.22731 | spectral_norm = 23.47081 | nuclear_norm = 4290.79102
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 191.96414 | spectral_norm = 22.38279 | nuclear_norm = 4219.96094
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 361.01971 | spectral_norm = 36.97080 | nuclear_norm = 8233.84375
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 393.17136 | spectral_norm = 29.51122 | nuclear_norm = 9173.42871
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 448.62836 | spectral_norm = 35.22022 | nuclear_norm = 11919.39746
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 212.07840 | spectral_norm = 27.46197 | nuclear_norm = 5563.24805
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1324.15076 | spectral_norm = 183.59337 | nuclear_norm = 35036.44531
===========================================

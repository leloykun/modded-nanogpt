====================================================================================================
import os
import sys
with open(sys.argv[0]) as f:
    code = f.read() # read the code of this file ASAP, for logging
import uuid
import glob
import time
from dataclasses import dataclass

import numpy as np
import torch
from torch import nn
import torch.nn.functional as F
import torch.distributed as dist
import torch._inductor.config as config
from torch.nn.parallel import DistributedDataParallel as DDP
# Use of FlexAttention contributed by @KoszarskyB
from torch.nn.attention.flex_attention import flex_attention, create_block_mask, BlockMask, _score_mod_signature
from torch._inductor.lowering import make_pointwise, register_lowering
# Some internal torch.compile details
from torch._inductor.virtualized import ops
from functools import partial
flex_attention = torch.compile(flex_attention, dynamic=False)
create_block_mask = torch.compile(create_block_mask, dynamic=False)

# -----------------------------------------------------------------------------
# Muon optimizer

def zeropower_via_svd(G, steps=None):
    U, S, V = G.svd()
    return U @ V.T

@torch.compile
def zeropower_via_newtonschulz5(G, steps=10, eps=1e-7):
    """
    Newton-Schulz iteration to compute the zeroth power / orthogonalization of G. We opt to use a
    quintic iteration whose coefficients are selected to maximize the slope at zero. For the purpose
    of minimizing steps, it turns out to be empirically effective to keep increasing the slope at
    zero even beyond the point where the iteration no longer converges all the way to one everywhere
    on the interval. This iteration therefore does not produce UV^T but rather something like US'V^T
    where S' is diagonal with S_{ii}' ~ Uniform(0.5, 1.5), which turns out not to hurt model
    performance at all relative to UV^T, where USV^T = G is the SVD.
    """
    assert len(G.shape) == 2
    a, b, c = (3.4445, -4.7750,  2.0315)
    X = G.bfloat16()
    X /= (X.norm() + eps) # ensure top singular value <= 1
    if G.size(0) > G.size(1):
        X = X.T
    for _ in range(steps):
        A = X @ X.T
        B = b * A + c * A @ A # adapted from suggestion by @jxbz, @leloykun, and @YouJiacheng
        X = a * X + B @ X
    if G.size(0) > G.size(1):
        X = X.T
    return X

zeropower_backends = dict(svd=zeropower_via_svd, newtonschulz5=zeropower_via_newtonschulz5)

class Muon(torch.optim.Optimizer):
    """
    Muon - MomentUm Orthogonalized by Newton-schulz

    Muon internally runs standard SGD-momentum, and then performs an orthogonalization post-
    processing step, in which each 2D parameter's update is replaced with the nearest orthogonal
    matrix. To efficiently orthogonalize each update, we use a Newton-Schulz iteration, which has
    the advantage that it can be stably run in bfloat16 on the GPU.

    Some warnings:
    - This optimizer assumes that all parameters passed in are 2D.
    - It should not be used for the embedding layer, the final fully connected layer, or any {0,1}-D
    parameters; those should all be optimized by a standard method (e.g., AdamW).
    - To use it with 4D convolutional filters, it works well to just flatten their last 3 dimensions.
    - We believe it is unlikely to work well for training with small batch size.
    - We believe it may not work well for finetuning pretrained models, but we haven't tested this.
    - We have not yet tried this optimizer for training scenarios larger than NanoGPT (124M).

    Arguments:
        lr: The learning rate used by the internal SGD.
        momentum: The momentum used by the internal SGD.
        nesterov: Whether to use Nesterov-style momentum in the internal SGD. (recommended)
        backend: The chosen backend for the orthogonalization step. (recommended: 'newtonschulz5')
        backend_steps: The number of iteration steps to use in the backend, if it is iterative.
    """
    def __init__(self, params, lr=0.02, momentum=0.95, nesterov=True,
                 backend='newtonschulz5', backend_steps=5):
        defaults = dict(lr=lr, momentum=momentum, nesterov=nesterov, backend=backend, backend_steps=backend_steps)
        super().__init__(params, defaults)

    def step(self):

        for group in self.param_groups:

            lr = group['lr']
            momentum = group['momentum']
            zeropower_backend = zeropower_backends[group['backend']]

            # generate weight updates in distributed fashion
            total_params = sum(p.numel() for p in group['params'])
            updates_flat = torch.zeros(total_params, device='cuda', dtype=torch.bfloat16)
            curr_idx = 0
            for i, p in enumerate(group['params']):
                # luckily this will perfectly distribute a transformer with multiple of 4 layers to 8 GPUs
                if i % int(os.environ['WORLD_SIZE']) == int(os.environ['RANK']):
                    g = p.grad
                    assert g is not None
                    state = self.state[p]
                    if 'momentum_buffer' not in state:
                        state['momentum_buffer'] = torch.zeros_like(g)
                    buf = state['momentum_buffer']
                    buf.mul_(momentum).add_(g)
                    if group['nesterov']:
                        g = g.add(buf, alpha=momentum)
                    g = zeropower_backend(g, steps=group['backend_steps'])
                    g *= max(1, g.size(0)/g.size(1))**0.5
                    updates_flat[curr_idx:curr_idx+p.numel()] = g.flatten()
                curr_idx += p.numel()

            # sync updates across devices. we are not memory-constrained so can do this simple deserialization
            dist.all_reduce(updates_flat, op=dist.ReduceOp.SUM)

            # deserialize and apply updates
            curr_idx = 0
            for p in group['params']:
                g = updates_flat[curr_idx:curr_idx+p.numel()].view_as(p.data).type_as(p.data)
                p.data.add_(g, alpha=-lr)
                curr_idx += p.numel()

# -----------------------------------------------------------------------------
# Attention Tanh softcapping

@torch.library.custom_op("approx::tanh", mutates_args=())
def _tanh_approx(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

@_tanh_approx.register_fake
def _(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

def _tanh_approx_lowering(inp):
    fn = partial(ops.inline_asm_elementwise, asm="tanh.approx.f32 $0, $1;")
    return make_pointwise(fn)(inp)

register_lowering(torch.ops.approx.tanh)(_tanh_approx_lowering)

class _TanhApprox(torch.autograd.Function):
    @staticmethod
    def forward(x):
        return torch.ops.approx.tanh(x)

    @staticmethod
    def setup_context(ctx, inputs, output):
        (x,) = inputs
        result = output
        ctx.save_for_backward(result)

    @staticmethod
    def backward(ctx, grad_output):
        (result,) = ctx.saved_tensors
        return grad_output * (1 - result * result)

    @staticmethod
    def vmap(info, in_dims, x):
        return torch.tanh(x), 0

_tanh_approx = _TanhApprox.apply

def generate_tanh_softcap(soft_cap: int, approx: bool=True) -> _score_mod_signature:
    tanh = _tanh_approx if approx else torch.tanh

    def tanh_softcap(score, b, h, q_idx, kv_idx):
        return soft_cap * tanh(score / soft_cap)

    prefix = "tanh_softcap_approx" if approx else "tanh_softcap"
    tanh_softcap.__name__ = f"{prefix}_{soft_cap}"

    return tanh_softcap

# -----------------------------------------------------------------------------
# PyTorch nn.Module definitions for the GPT-2 model

class Rotary(torch.nn.Module):

    def __init__(self, dim, base=10000):
        super().__init__()
        self.dim = dim
        self.base = base
        self.inv_freq = None
        self.seq_len_cached = None
        self.cos_cached = None
        self.sin_cached = None

    def forward(self, x):
        seq_len = x.shape[1]
        if seq_len != self.seq_len_cached:
            self.inv_freq = 1.0 / (self.base ** (torch.arange(0, self.dim, 2, device=x.device).float() / self.dim))
            self.seq_len_cached = seq_len
            t = torch.arange(seq_len, device=x.device).type_as(self.inv_freq)
            freqs = torch.outer(t, self.inv_freq)
            self.cos_cached = freqs.cos().bfloat16()
            self.sin_cached = freqs.sin().bfloat16()
        return self.cos_cached[None, :, None, :], self.sin_cached[None, :, None, :]

def apply_rotary_emb(x, cos, sin):
    assert x.ndim == 4 # multihead attention
    d = x.shape[3]//2
    x1 = x[..., :d]
    x2 = x[..., d:]
    y1 = x1 * cos + x2 * sin
    y2 = x1 * (-sin) + x2 * cos
    return torch.cat([y1, y2], 3).type_as(x)

class CastedLinear(nn.Linear):
    def forward(self, x):
        return F.linear(x, self.weight.to(x.dtype))

class CausalSelfAttention(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.n_head = config.n_head
        self.n_embd = config.n_embd
        self.head_dim = self.n_embd // self.n_head
        assert self.n_embd % self.n_head == 0
        self.c_q = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_k = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_v = CastedLinear(self.n_embd, self.n_embd, bias=False)
        with torch.no_grad():
            self.c_q.weight.data.mul_(1.25)
            self.c_k.weight.data.mul_(1.25)
        # output projection
        self.c_proj = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977
        self.rotary = Rotary(self.head_dim)
        self.lamb = nn.Parameter(torch.tensor(0.5)) # @Grad62304977

    def forward(self, x, v1, block_mask: BlockMask, score_mod: _score_mod_signature):
        B, T, C = x.size() # batch size, sequence length, embedding dimensionality (n_embd)
        q = self.c_q(x).view(B, T, self.n_head, self.head_dim)
        k = self.c_k(x).view(B, T, self.n_head, self.head_dim)
        v = self.c_v(x).view(B, T, self.n_head, self.head_dim)
        if v1 is None:
            v1 = v # This happens if we are in the first block. v needs to be accessed by subsequent blocks
        v = (1 - self.lamb) * v + self.lamb * v1.view_as(v) # @Grad62304977
        cos, sin = self.rotary(q)
        q, k = F.rms_norm(q, (q.size(-1),)), F.rms_norm(k, (k.size(-1),)) # QK norm suggested by @Grad62304977
        q, k = apply_rotary_emb(q, cos, sin), apply_rotary_emb(k, cos, sin)
        y = flex_attention(q.transpose(1, 2), k.transpose(1, 2), v.transpose(1, 2), score_mod=score_mod, block_mask=block_mask)
        y = y.transpose(1, 2).contiguous().view_as(x) # re-assemble all head outputs side by side
        y = self.c_proj(y)
        return y, v1

class MLP(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.c_fc    = CastedLinear(config.n_embd, 4 * config.n_embd, bias=False)
        self.c_proj  = CastedLinear(4 * config.n_embd, config.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977

    def forward(self, x):
        x = self.c_fc(x)
        x = F.relu(x).square() # https://arxiv.org/abs/2109.08668v2; ~1-2% better than GELU; suggested by @SKYLINEZ007 and @Grad62304977
        x = self.c_proj(x)
        return x

class Block(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.attn = CausalSelfAttention(config)
        self.mlp = MLP(config)
        self.lambdas = nn.Parameter(torch.tensor([1., 0.]))

    def forward(self, x, v1, x0, block_mask: BlockMask, score_mod: _score_mod_signature):
        x = self.lambdas[0] * x + self.lambdas[1] * x0
        x1, v1 = self.attn(F.rms_norm(x, (x.size(-1),)), v1, block_mask, score_mod)
        x = x + x1
        x = x + self.mlp(F.rms_norm(x, (x.size(-1),)))
        return x, v1

# -----------------------------------------------------------------------------
# The main GPT-2 model

@dataclass
class GPTConfig:
    vocab_size : int = 50304
    n_layer : int = 12
    n_head : int = 6 # head dim 128 suggested by @Grad62304977
    n_embd : int = 768
    attention_soft_cap : int = 50
    lm_head_soft_cap : int = 30

class GPT(nn.Module):

    def __init__(self, config: GPTConfig):
        super().__init__()
        self.attention_soft_cap = config.attention_soft_cap
        self.lm_head_soft_cap = config.lm_head_soft_cap

        # U-net design by @brendanh0gan
        self.num_encoder_layers = config.n_layer // 2 # Half of the layers for encoder
        self.num_decoder_layers = config.n_layer - self.num_encoder_layers # Remaining for decoder
        # Add learnable skip connection weights for decoder layers
        self.skip_weights = nn.Parameter(torch.ones(self.num_decoder_layers))

        self.transformer = nn.ModuleDict(dict(
            wte = nn.Embedding(config.vocab_size, config.n_embd),
            h = nn.ModuleList([Block(config) for _ in range(config.n_layer)]),
        ))
        self.lm_head = CastedLinear(config.n_embd, config.vocab_size, bias=False)
        self.lm_head.weight.data.zero_() # @Grad62304977

    def forward(self, idx, target, attn_blocksize: int):

        docs = (idx == 50256).cumsum(0)
        def document_causal_mask(b, h, q_idx, kv_idx):
            causal_mask = q_idx >= kv_idx
            document_mask = docs[q_idx] == docs[kv_idx]
            window_mask = q_idx - kv_idx < attn_blocksize
            return causal_mask & document_mask & window_mask

        softcap_mod = generate_tanh_softcap(self.attention_soft_cap, approx=True)  # @leloykun

        S = len(idx)
        block_mask = create_block_mask(document_causal_mask, None, None, S, S, device="cuda", _compile=True)

        # forward the GPT model itself
        x = self.transformer.wte(idx[None]) # token embeddings of shape (b, t, n_embd)
        x = F.rms_norm(x, (x.size(-1),)) # @Grad62304977
        x0 = x
        v1 = None

        # Store outputs for U-Net skip connections
        skip_connections = []
        # Encoder pass - process only the first half of the blocks
        for i in range(self.num_encoder_layers):
            x, v1 = self.transformer.h[i](x, v1, x0, block_mask, softcap_mod)
            skip_connections.append(x)
        # Decoder pass - process the remaining blocks with weighted skip connections
        for i in range(self.num_decoder_layers):
            x = x + self.skip_weights[i] * skip_connections.pop()
            x, v1 = self.transformer.h[self.num_encoder_layers + i](x, v1, x0, block_mask, softcap_mod)

        x = F.rms_norm(x, (x.size(-1),))
        logits = self.lm_head(x)
        logits = self.lm_head_soft_cap * torch.tanh(logits / self.lm_head_soft_cap) # @Grad62304977
        logits = logits.float()
        loss = F.cross_entropy(logits.view(-1, logits.size(-1)), target.view(-1))
        return loss

# -----------------------------------------------------------------------------
# Our own simple Distributed Data Loader

def _peek_data_shard(filename):
    # only reads the header, returns header data
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
    if header[0] != 20240520:
        print("ERROR: magic number mismatch in the data .bin file!")
        print("---> HINT: Are you passing in a correct file with --input_bin?")
        print("---> HINT: Dataset encoding changed recently, re-run data prepro or refer again to README")
        print("---> HINT: For example re-run: `python dev/data/tinyshakespeare.py`, then re-try")
        exit(1)
    assert header[1] == 1, "unsupported version"
    ntok = header[2] # number of tokens (claimed)
    return ntok # for now just return the number of tokens

def _load_data_shard(filename):
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
        assert header[0] == 20240520, "magic number mismatch in the data .bin file"
        assert header[1] == 1, "unsupported version"
        ntok = header[2] # number of tokens (claimed)
        # the rest of it are tokens, stored as uint16
        tokens = np.frombuffer(f.read(), dtype=np.uint16)
    assert len(tokens) == ntok, "number of tokens read does not match header?"
    return tokens

class DistributedDataLoader:
    def __init__(self, filename_pattern, B, T, process_rank, num_processes):
        self.process_rank = process_rank
        self.num_processes = num_processes
        self.B = B
        self.T = T

        # glob files that match the pattern
        self.files = sorted(glob.glob(filename_pattern))
        assert len(self.files) > 0, f"did not find any files that match the pattern {filename_pattern}"

        # load and validate all data shards, count number of tokens in total
        ntok_total = 0
        for fname in self.files:
            shard_ntok = _peek_data_shard(fname)
            assert shard_ntok >= num_processes * B * T + 1
            ntok_total += int(shard_ntok)
        self.ntok_total = ntok_total

        self.reset()

    def reset(self):
        self.current_shard = -1
        self.advance()

    def advance(self): # advance to next data shard
        self.current_shard = (self.current_shard + 1) % len(self.files)
        self.current_position = self.process_rank * self.B * self.T
        self.tokens = _load_data_shard(self.files[self.current_shard])

    def next_batch(self):
        batch_size = self.B * self.T * self.num_processes
        buf = self.tokens[self.current_position:self.current_position+self.B*self.T+1]
        buf = torch.tensor(buf.astype(np.int32), dtype=torch.long)
        x = buf[:-1] # inputs
        y = buf[1:] # targets
        # advance current position and load next shard if necessary
        self.current_position += batch_size
        if self.current_position + batch_size >= len(self.tokens):
            self.advance()
        return x.cuda(), y.cuda()

# -----------------------------------------------------------------------------
# int main

@dataclass
class Hyperparameters:
    # data hyperparams
    input_bin : str = 'data/fineweb10B/fineweb_train_*.bin' # input .bin to train on
    input_val_bin : str = 'data/fineweb10B/fineweb_val_*.bin' # input .bin to eval validation loss on
    # optimization hyperparams
    batch_size : int = 8 # batch size, in sequences, across all devices
    device_batch_size : int = 1 # batch size, in sequences, per device
    sequence_length : int = 64*1024 # sequence length, in tokens
    num_iterations : int = 1750 # number of iterations to run
    warmup_iters : int = 0
    cooldown_iters : int = 640 # number of iterations of linear warmup/cooldown for triangular or trapezoidal schedule
    weight_decay : float = 0
    # evaluation and logging hyperparams
    val_loss_every : int = 125 # every how many steps to evaluate val loss? 0 for only at the end
    val_tokens : int = 10485760 # how many tokens of validation data? it's important to keep this fixed for consistent comparisons
    save_every : int = 0 # every how many steps to save the checkpoint? 0 for only at the end
args = Hyperparameters()

# set up DDP (distributed data parallel). torchrun sets this env variable
assert torch.cuda.is_available()
dist.init_process_group(backend='nccl')
ddp_rank = int(os.environ['RANK'])
ddp_local_rank = int(os.environ['LOCAL_RANK'])
ddp_world_size = int(os.environ['WORLD_SIZE'])
device = f'cuda:{ddp_local_rank}'
torch.cuda.set_device(device)
print(f"using device: {device}")
master_process = (ddp_rank == 0) # this process will do logging, checkpointing etc.

# begin logging
logfile = None
if master_process:
    run_id = str(uuid.uuid4())
    logdir = 'logs/%s/' % run_id
    os.makedirs(logdir, exist_ok=True)
    logfile = 'logs/%s.txt' % run_id
    # create the log file
    with open(logfile, "w") as f:
        # begin the log by printing this file (the Python code)
        f.write('='*100 + '\n')
        f.write(code)
        f.write('='*100 + '\n')
def print0(s, logonly=False):
    if master_process:
        with open(logfile, "a") as f:
            if not logonly:
                print(s)
            f.write(s+'\n')
# log information about the hardware/software environment this is running on
# and print the full `nvidia-smi` to file
print0(f"Running pytorch {torch.version.__version__} compiled for CUDA {torch.version.cuda}\nnvidia-smi:")
import subprocess
result = subprocess.run(['nvidia-smi'], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
print0(f'{result.stdout}', logonly=True)
print0('='*100, logonly=True)

# convenience variables
B, T = args.device_batch_size, args.sequence_length
# calculate the number of steps to take in the val loop.
assert args.val_tokens % (B * T * ddp_world_size) == 0
val_steps = args.val_tokens // (B * T * ddp_world_size)
# calculate the steps of gradient accumulation required to attain the desired global batch size.
assert args.batch_size % (B * ddp_world_size) == 0
train_accumulation_steps = args.batch_size // (B * ddp_world_size)

# load tokens
train_loader = DistributedDataLoader(args.input_bin, B, T, ddp_rank, ddp_world_size)
val_loader = DistributedDataLoader(args.input_val_bin, B, T, ddp_rank, ddp_world_size)
print0(f"Training DataLoader: total number of tokens: {train_loader.ntok_total} across {len(train_loader.files)} files")
print0(f"Validation DataLoader: total number of tokens: {val_loader.ntok_total} across {len(val_loader.files)} files")
print0('='*100, logonly=True)
x, y = train_loader.next_batch()

# there are only 50257 unique GPT-2 tokens; we extend to nearest multiple of 128 for efficiency. suggested to me by @Grad62304977.
# this originates from Karpathy's experiments.
num_vocab = 50304
model = GPT(GPTConfig(vocab_size=num_vocab, n_layer=12, n_head=6, n_embd=768))
model = model.cuda().bfloat16()
for m in model.modules():
    if isinstance(m, CastedLinear):
        m.float()
if hasattr(config, "coordinate_descent_tuning"):
    config.coordinate_descent_tuning = True # suggested by @Chillee
model = torch.compile(model)
# here we wrap model into DDP container
model = DDP(model, device_ids=[ddp_local_rank])
raw_model = model.module # always contains the "raw" unwrapped model

# CUDNN attention is ~4ms faster than Flash, but doesn't get selected by default in PyTorch 2.5.1
from torch.backends.cuda import enable_cudnn_sdp, enable_flash_sdp, enable_math_sdp, enable_mem_efficient_sdp
enable_cudnn_sdp(True)
enable_flash_sdp(False)
enable_mem_efficient_sdp(False)
enable_math_sdp(False)

# init the optimizer(s)
optimizer1 = torch.optim.Adam([raw_model.transformer.wte.weight], lr=0.6,   betas=(0.8, 0.95), fused=True)
optimizer2 = torch.optim.Adam([raw_model.lm_head.weight],         lr=0.008, betas=(0.8, 0.95), fused=True)
params = list(raw_model.transformer.h.parameters())
matrix_params = [p for p in params if p.ndim == 2]
scalar_params = [p for p in params if p.ndim < 2] + [raw_model.skip_weights]
optimizer3 = Muon(matrix_params, lr=0.05, momentum=0.95)
optimizer4 = torch.optim.Adam(scalar_params, lr=0.04, betas=(0.8, 0.95), fused=True) # note that this learning rate is neither sensitive nor tuned
optimizers = [optimizer1, optimizer2, optimizer3, optimizer4]
# learning rate decay scheduler (linear warmup and cooldown)
def get_lr(it):
    assert it <= args.num_iterations
    # 1) linear warmup for warmup_iters steps
    if it < args.warmup_iters:
        return (it+1) / args.warmup_iters
    # 2) constant lr for a while
    elif it < args.num_iterations - args.cooldown_iters:
        return 1.0
    # 3) linear cooldown
    else:
        decay_ratio = (args.num_iterations - it) / args.cooldown_iters
        return decay_ratio
schedulers = [torch.optim.lr_scheduler.LambdaLR(opt, get_lr) for opt in optimizers]

# Start training loop
training_time_ms = 0
# start the clock
torch.cuda.synchronize()
t0 = time.time()
# begin training
for step in range(args.num_iterations + 1):
    last_step = (step == args.num_iterations)
    # Set the attention blocksize for the current step, in chunks of 64
    attn_blocksize = torch.tensor(64*((step/args.num_iterations * (1792 - 64) + 64)//64), dtype=torch.int, device='cuda')
    # This effectively ignores timing first 10 steps, which are slower for weird reasons.
    # Alternately, and slightly more correctly in terms of benchmarking, we could do 10
    # steps with dummy data first, and then re-initialize the model and reset the loader.
    if step == 10:
        training_time_ms = 0
        t0 = time.time()
    timed_steps = float('nan') if step <= 11 else (step - 10) + 1 # <= 11 to avoid bug in val

    # Set the attention blocksize for the current step, in chunks of 64. By @fernbear.bsky.social
    attn_blocksize = torch.tensor(64*((step/args.num_iterations * (1792 - 64) + 64)//64), dtype=torch.int, device='cuda')

    # once in a while evaluate the validation dataset
    if (last_step or (args.val_loss_every > 0 and step % args.val_loss_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # run validation batches
        model.eval()
        val_loader.reset()
        val_loss = 0.0
        for _ in range(val_steps):
            with torch.no_grad():
                x_val, y_val = val_loader.next_batch()
                val_loss += model(x_val, y_val, attn_blocksize=attn_blocksize)
        dist.all_reduce(val_loss, op=dist.ReduceOp.AVG)
        val_loss /= val_steps
        # log val loss to console and to logfile
        print0(f'step:{step}/{args.num_iterations} val_loss:{val_loss:.4f} train_time:{training_time_ms:.0f}ms step_avg:{training_time_ms/(timed_steps-1):.2f}ms')
        if master_process:
            print("============== Weight norms: ==============")
            with open(logfile, "a") as f:
                f.write("============== Weight norms: ==============\n")
                for name, p in model.named_parameters():
                    if p.ndim == 2:
                        frobenius_norm = torch.linalg.norm(p.data.float(), ord='fro').item()
                        spectral_norm = torch.linalg.matrix_norm(p.data.float(), ord=2).item()
                        nuclear_norm = torch.linalg.matrix_norm(p.data.float(), ord="nuc").item()
                        print(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                f.write("===========================================\n")
            print("===========================================")
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    if master_process and (last_step or (args.save_every > 0 and step % args.save_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # save the state of the training process
        log = dict(step=step, code=code, model=raw_model.state_dict(), optimizers=[opt.state_dict() for opt in optimizers])
        torch.save(log, 'logs/%s/state_step%06d.pt' % (run_id, step))
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    # bit confusing: we want to make sure to eval on 0th iteration
    # but also after the very last iteration. so we loop for step <= num_iterations
    # instead of just < num_iterations (one extra due to <=), only to do
    # the validation/sampling one last time, and then we break right here as we're done.
    if last_step:
        break

    # --------------- TRAINING SECTION BEGIN -----------------
    model.train()
    for i in range(1, train_accumulation_steps+1):
        # forward pass
        loss = model(x, y, attn_blocksize=attn_blocksize)
        train_loss = loss.detach()
        # advance the dataset for the next batch
        x, y = train_loader.next_batch()
        # backward pass
        if i < train_accumulation_steps:
            with model.no_sync(): # there's no need to sync gradients every accumulation step
                loss.backward()
        else:
            loss.backward() # just sync on the last step
    for p in model.parameters():
        p.grad /= train_accumulation_steps
    # momentum warmup for Muon
    frac = min(step/300, 1)
    optimizer3.param_groups[0]['momentum'] = (1 - frac) * 0.85 + frac * 0.95
    # step the optimizers and schedulers
    for opt, sched in zip(optimizers, schedulers):
        opt.step()
        sched.step()
    # null the gradients
    model.zero_grad(set_to_none=True)
    # --------------- TRAINING SECTION END -------------------
    # everything that follows now is just diagnostics, prints, logging, etc.

    #dist.all_reduce(train_loss, op=dist.ReduceOp.AVG) # all-reducing the training loss would be more correct in terms of logging, but slower
    approx_time = training_time_ms + 1000 * (time.time() - t0)
    print0(f"step:{step+1}/{args.num_iterations} train_loss:{train_loss.item():.4f} train_time:{approx_time:.0f}ms step_avg:{approx_time/timed_steps:.2f}ms")

if master_process:
    print(f"peak memory consumption: {torch.cuda.max_memory_allocated() // 1024 // 1024} MiB")

# -------------------------------------------------------------------------
# clean up nice
dist.destroy_process_group()
====================================================================================================
Running pytorch 2.6.0.dev20241124+cu124 compiled for CUDA 12.4
nvidia-smi:
Mon Nov 25 08:11:58 2024       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:4E:00.0 Off |                    0 |
| N/A   31C    P0             68W /  400W |   32907MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:87:00.0 Off |                    0 |
| N/A   44C    P0             73W /  400W |      85MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:90:00.0 Off |                    0 |
| N/A   33C    P0             68W /  400W |     423MiB /  81920MiB |      1%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:B7:00.0 Off |                    0 |
| N/A   33C    P0             68W /  400W |      31MiB /  81920MiB |      1%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
+-----------------------------------------------------------------------------------------+

====================================================================================================
Training DataLoader: total number of tokens: 1100000000 across 11 files
Validation DataLoader: total number of tokens: 100000000 across 1 files
====================================================================================================
step:0/1750 val_loss:10.8258 train_time:0ms step_avg:nanms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | frobenius_norm = 6214.96729 | spectral_norm = 251.59488 | nuclear_norm = 171927.39062
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 19.99688 | spectral_norm = 1.44371 | nuclear_norm = 470.56339
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 19.97822 | spectral_norm = 1.43295 | nuclear_norm = 470.03851
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 15.98890 | spectral_norm = 1.14057 | nuclear_norm = 376.27289
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 31.98806 | spectral_norm = 1.72757 | nuclear_norm = 857.96368
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 20.00781 | spectral_norm = 1.42822 | nuclear_norm = 470.84955
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 19.99869 | spectral_norm = 1.43929 | nuclear_norm = 470.12521
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 16.00320 | spectral_norm = 1.14104 | nuclear_norm = 376.42294
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 32.00567 | spectral_norm = 1.72171 | nuclear_norm = 858.35724
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 19.99958 | spectral_norm = 1.43681 | nuclear_norm = 470.71570
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 20.00622 | spectral_norm = 1.44112 | nuclear_norm = 470.54276
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 16.00633 | spectral_norm = 1.14116 | nuclear_norm = 376.50629
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 31.99685 | spectral_norm = 1.73008 | nuclear_norm = 858.11975
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 19.99898 | spectral_norm = 1.44551 | nuclear_norm = 470.46436
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 19.99320 | spectral_norm = 1.43045 | nuclear_norm = 470.30615
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 15.99233 | spectral_norm = 1.15052 | nuclear_norm = 376.11526
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 31.99785 | spectral_norm = 1.72771 | nuclear_norm = 858.11084
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 20.00353 | spectral_norm = 1.43422 | nuclear_norm = 470.68988
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 19.99355 | spectral_norm = 1.42622 | nuclear_norm = 470.38931
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 15.99466 | spectral_norm = 1.13763 | nuclear_norm = 376.38129
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 32.00615 | spectral_norm = 1.72862 | nuclear_norm = 858.44287
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 19.99261 | spectral_norm = 1.44021 | nuclear_norm = 470.45160
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 20.01832 | spectral_norm = 1.44569 | nuclear_norm = 470.98370
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 16.00910 | spectral_norm = 1.14239 | nuclear_norm = 376.61932
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 31.98856 | spectral_norm = 1.72464 | nuclear_norm = 857.85718
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 19.98858 | spectral_norm = 1.44490 | nuclear_norm = 470.09753
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 20.01300 | spectral_norm = 1.44889 | nuclear_norm = 470.55896
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 16.00890 | spectral_norm = 1.14309 | nuclear_norm = 376.67163
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 31.99154 | spectral_norm = 1.72916 | nuclear_norm = 857.92078
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 19.98901 | spectral_norm = 1.43999 | nuclear_norm = 470.29785
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 20.00819 | spectral_norm = 1.44184 | nuclear_norm = 470.70123
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 15.99852 | spectral_norm = 1.15422 | nuclear_norm = 376.27216
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 32.01072 | spectral_norm = 1.72494 | nuclear_norm = 858.47296
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 19.97469 | spectral_norm = 1.44223 | nuclear_norm = 470.01617
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 20.00179 | spectral_norm = 1.44470 | nuclear_norm = 470.32370
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 15.99310 | spectral_norm = 1.14878 | nuclear_norm = 376.37701
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 31.99953 | spectral_norm = 1.73710 | nuclear_norm = 858.21277
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 20.00408 | spectral_norm = 1.44038 | nuclear_norm = 470.51813
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 20.00017 | spectral_norm = 1.43962 | nuclear_norm = 470.56702
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 15.98851 | spectral_norm = 1.15875 | nuclear_norm = 375.95465
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 31.99802 | spectral_norm = 1.72610 | nuclear_norm = 858.18103
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 20.00380 | spectral_norm = 1.43756 | nuclear_norm = 470.51126
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 20.00261 | spectral_norm = 1.43796 | nuclear_norm = 470.69232
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 15.99452 | spectral_norm = 1.14834 | nuclear_norm = 376.28693
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 31.99046 | spectral_norm = 1.72494 | nuclear_norm = 857.90771
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 20.00358 | spectral_norm = 1.43667 | nuclear_norm = 470.72006
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 20.01845 | spectral_norm = 1.43507 | nuclear_norm = 471.17969
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 15.98031 | spectral_norm = 1.14151 | nuclear_norm = 375.83438
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 31.98785 | spectral_norm = 1.71909 | nuclear_norm = 857.97491
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
===========================================
step:1/1750 train_loss:10.8258 train_time:28003ms step_avg:nanms
step:2/1750 train_loss:10.1215 train_time:28658ms step_avg:nanms
step:3/1750 train_loss:8.4019 train_time:29312ms step_avg:nanms
step:4/1750 train_loss:7.5906 train_time:29971ms step_avg:nanms
step:5/1750 train_loss:7.4445 train_time:30627ms step_avg:nanms
step:6/1750 train_loss:7.0241 train_time:31283ms step_avg:nanms
step:7/1750 train_loss:7.0013 train_time:31942ms step_avg:nanms
step:8/1750 train_loss:6.4659 train_time:32600ms step_avg:nanms
step:9/1750 train_loss:6.7777 train_time:33257ms step_avg:nanms
step:10/1750 train_loss:6.5364 train_time:33918ms step_avg:nanms
step:11/1750 train_loss:6.4726 train_time:646ms step_avg:nanms
step:12/1750 train_loss:6.3794 train_time:1305ms step_avg:nanms
step:13/1750 train_loss:6.3032 train_time:1963ms step_avg:654.47ms
step:14/1750 train_loss:6.2551 train_time:2622ms step_avg:655.41ms
step:15/1750 train_loss:6.2243 train_time:3281ms step_avg:656.15ms
step:16/1750 train_loss:6.0315 train_time:3939ms step_avg:656.43ms
step:17/1750 train_loss:5.9680 train_time:4597ms step_avg:656.77ms
step:18/1750 train_loss:6.5112 train_time:5256ms step_avg:657.06ms
step:19/1750 train_loss:5.9713 train_time:5918ms step_avg:657.53ms
step:20/1750 train_loss:6.1446 train_time:6577ms step_avg:657.70ms
step:21/1750 train_loss:6.0512 train_time:7236ms step_avg:657.85ms
step:22/1750 train_loss:5.7955 train_time:7896ms step_avg:658.04ms
step:23/1750 train_loss:5.8469 train_time:8556ms step_avg:658.17ms
step:24/1750 train_loss:5.9066 train_time:9216ms step_avg:658.26ms
step:25/1750 train_loss:5.7089 train_time:9875ms step_avg:658.31ms
step:26/1750 train_loss:5.8025 train_time:10535ms step_avg:658.43ms
step:27/1750 train_loss:5.7603 train_time:11195ms step_avg:658.55ms
step:28/1750 train_loss:5.7663 train_time:11856ms step_avg:658.66ms
step:29/1750 train_loss:5.7879 train_time:12515ms step_avg:658.71ms
step:30/1750 train_loss:5.7898 train_time:13175ms step_avg:658.74ms
step:31/1750 train_loss:6.1812 train_time:13834ms step_avg:658.76ms
step:32/1750 train_loss:5.6834 train_time:14494ms step_avg:658.83ms
step:33/1750 train_loss:5.4859 train_time:15152ms step_avg:658.80ms
step:34/1750 train_loss:5.5132 train_time:15813ms step_avg:658.86ms
step:35/1750 train_loss:5.7434 train_time:16474ms step_avg:658.96ms
step:36/1750 train_loss:5.6589 train_time:17135ms step_avg:659.02ms
step:37/1750 train_loss:5.6500 train_time:17795ms step_avg:659.07ms
step:38/1750 train_loss:5.4821 train_time:18455ms step_avg:659.11ms
step:39/1750 train_loss:5.5833 train_time:19114ms step_avg:659.11ms
step:40/1750 train_loss:5.3577 train_time:19773ms step_avg:659.11ms
step:41/1750 train_loss:5.5364 train_time:20434ms step_avg:659.15ms
step:42/1750 train_loss:5.3975 train_time:21093ms step_avg:659.17ms
step:43/1750 train_loss:5.4254 train_time:21753ms step_avg:659.19ms
step:44/1750 train_loss:5.2971 train_time:22413ms step_avg:659.22ms
step:45/1750 train_loss:5.2024 train_time:23075ms step_avg:659.30ms
step:46/1750 train_loss:5.2832 train_time:23736ms step_avg:659.34ms
step:47/1750 train_loss:5.2179 train_time:24396ms step_avg:659.36ms
step:48/1750 train_loss:5.3351 train_time:25057ms step_avg:659.39ms
step:49/1750 train_loss:5.1791 train_time:25716ms step_avg:659.37ms
step:50/1750 train_loss:5.2294 train_time:26375ms step_avg:659.37ms
step:51/1750 train_loss:5.2199 train_time:27035ms step_avg:659.38ms
step:52/1750 train_loss:5.3255 train_time:27695ms step_avg:659.40ms
step:53/1750 train_loss:5.1678 train_time:28354ms step_avg:659.40ms
step:54/1750 train_loss:5.2114 train_time:29015ms step_avg:659.43ms
step:55/1750 train_loss:5.1130 train_time:29674ms step_avg:659.43ms
step:56/1750 train_loss:5.1097 train_time:30335ms step_avg:659.45ms
step:57/1750 train_loss:5.1543 train_time:30995ms step_avg:659.46ms
step:58/1750 train_loss:5.1732 train_time:31653ms step_avg:659.44ms
step:59/1750 train_loss:5.1775 train_time:32313ms step_avg:659.46ms
step:60/1750 train_loss:5.0585 train_time:32973ms step_avg:659.46ms
step:61/1750 train_loss:5.1796 train_time:33631ms step_avg:659.44ms
step:62/1750 train_loss:5.1679 train_time:34291ms step_avg:659.44ms
step:63/1750 train_loss:5.1018 train_time:34950ms step_avg:659.43ms
step:64/1750 train_loss:5.0918 train_time:35609ms step_avg:659.42ms
step:65/1750 train_loss:4.9516 train_time:36269ms step_avg:659.43ms
step:66/1750 train_loss:5.0213 train_time:36928ms step_avg:659.43ms
step:67/1750 train_loss:5.1093 train_time:37587ms step_avg:659.43ms
step:68/1750 train_loss:5.0616 train_time:38247ms step_avg:659.44ms
step:69/1750 train_loss:5.1042 train_time:38908ms step_avg:659.45ms
step:70/1750 train_loss:4.9515 train_time:39567ms step_avg:659.45ms
step:71/1750 train_loss:5.0421 train_time:40226ms step_avg:659.45ms
step:72/1750 train_loss:5.0277 train_time:40886ms step_avg:659.46ms
step:73/1750 train_loss:5.0022 train_time:41546ms step_avg:659.46ms
step:74/1750 train_loss:4.8558 train_time:42206ms step_avg:659.47ms
step:75/1750 train_loss:4.8921 train_time:42865ms step_avg:659.47ms
step:76/1750 train_loss:4.7825 train_time:43524ms step_avg:659.46ms
step:77/1750 train_loss:5.0024 train_time:44184ms step_avg:659.46ms
step:78/1750 train_loss:4.9296 train_time:44844ms step_avg:659.47ms
step:79/1750 train_loss:4.6341 train_time:45502ms step_avg:659.45ms
step:80/1750 train_loss:4.9100 train_time:46161ms step_avg:659.44ms
step:81/1750 train_loss:4.8828 train_time:46818ms step_avg:659.40ms
step:82/1750 train_loss:4.9126 train_time:47477ms step_avg:659.40ms
step:83/1750 train_loss:4.9109 train_time:48136ms step_avg:659.39ms
step:84/1750 train_loss:4.7843 train_time:48794ms step_avg:659.38ms
step:85/1750 train_loss:4.8354 train_time:49454ms step_avg:659.38ms
step:86/1750 train_loss:4.9147 train_time:50110ms step_avg:659.34ms
step:87/1750 train_loss:4.9017 train_time:50769ms step_avg:659.34ms
step:88/1750 train_loss:4.7500 train_time:51428ms step_avg:659.33ms
step:89/1750 train_loss:4.7531 train_time:52085ms step_avg:659.30ms
step:90/1750 train_loss:4.6835 train_time:52743ms step_avg:659.28ms
step:91/1750 train_loss:4.8299 train_time:53402ms step_avg:659.28ms
step:92/1750 train_loss:4.7924 train_time:54060ms step_avg:659.27ms
step:93/1750 train_loss:4.9043 train_time:54718ms step_avg:659.25ms
step:94/1750 train_loss:4.9987 train_time:55376ms step_avg:659.24ms
step:95/1750 train_loss:4.7357 train_time:56034ms step_avg:659.22ms
step:96/1750 train_loss:4.6441 train_time:56692ms step_avg:659.21ms
step:97/1750 train_loss:4.7991 train_time:57350ms step_avg:659.19ms
step:98/1750 train_loss:4.6347 train_time:58006ms step_avg:659.16ms
step:99/1750 train_loss:4.6244 train_time:58664ms step_avg:659.15ms
step:100/1750 train_loss:4.6709 train_time:59321ms step_avg:659.12ms
step:101/1750 train_loss:4.5381 train_time:59979ms step_avg:659.11ms
step:102/1750 train_loss:4.6861 train_time:60637ms step_avg:659.10ms
step:103/1750 train_loss:4.5957 train_time:61295ms step_avg:659.09ms
step:104/1750 train_loss:4.6932 train_time:61955ms step_avg:659.09ms
step:105/1750 train_loss:4.6982 train_time:62612ms step_avg:659.08ms
step:106/1750 train_loss:4.8615 train_time:63270ms step_avg:659.06ms
step:107/1750 train_loss:4.6132 train_time:63927ms step_avg:659.04ms
step:108/1750 train_loss:4.4636 train_time:64586ms step_avg:659.04ms
step:109/1750 train_loss:4.8376 train_time:65243ms step_avg:659.02ms
step:110/1750 train_loss:4.6331 train_time:65899ms step_avg:658.99ms
step:111/1750 train_loss:4.5483 train_time:66556ms step_avg:658.97ms
step:112/1750 train_loss:4.7727 train_time:67214ms step_avg:658.96ms
step:113/1750 train_loss:4.4420 train_time:67872ms step_avg:658.95ms
step:114/1750 train_loss:4.6329 train_time:68529ms step_avg:658.93ms
step:115/1750 train_loss:4.5672 train_time:69187ms step_avg:658.92ms
step:116/1750 train_loss:4.6096 train_time:69843ms step_avg:658.90ms
step:117/1750 train_loss:4.3986 train_time:70498ms step_avg:658.86ms
step:118/1750 train_loss:4.6147 train_time:71155ms step_avg:658.84ms
step:119/1750 train_loss:4.4392 train_time:71810ms step_avg:658.81ms
step:120/1750 train_loss:4.5407 train_time:72466ms step_avg:658.78ms
step:121/1750 train_loss:4.5090 train_time:73122ms step_avg:658.76ms
step:122/1750 train_loss:4.4076 train_time:73779ms step_avg:658.74ms
step:123/1750 train_loss:4.4850 train_time:74435ms step_avg:658.72ms
step:124/1750 train_loss:4.3580 train_time:75091ms step_avg:658.69ms
step:125/1750 train_loss:4.3675 train_time:75746ms step_avg:658.66ms
step:125/1750 val_loss:4.4692 train_time:75757ms step_avg:658.76ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | frobenius_norm = 26607.59375 | spectral_norm = 6940.45654 | nuclear_norm = 641712.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 36.86493 | spectral_norm = 3.39907 | nuclear_norm = 863.28076
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 35.92497 | spectral_norm = 4.23672 | nuclear_norm = 838.40173
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 44.24975 | spectral_norm = 3.47153 | nuclear_norm = 975.74573
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 36.53775 | spectral_norm = 2.94217 | nuclear_norm = 851.87512
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 65.82752 | spectral_norm = 5.93044 | nuclear_norm = 1744.00366
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 38.90363 | spectral_norm = 2.74606 | nuclear_norm = 1031.06641
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 35.02677 | spectral_norm = 3.30081 | nuclear_norm = 817.60553
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 34.40666 | spectral_norm = 3.87894 | nuclear_norm = 801.36804
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 38.30208 | spectral_norm = 3.25994 | nuclear_norm = 846.89185
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 38.10514 | spectral_norm = 2.96671 | nuclear_norm = 872.69348
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 76.40974 | spectral_norm = 5.54799 | nuclear_norm = 2031.64783
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 41.71782 | spectral_norm = 2.85929 | nuclear_norm = 1108.30713
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 34.43532 | spectral_norm = 3.15799 | nuclear_norm = 800.12390
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 34.31791 | spectral_norm = 3.10584 | nuclear_norm = 795.63501
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 42.67516 | spectral_norm = 3.80855 | nuclear_norm = 935.99500
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 39.86629 | spectral_norm = 2.96717 | nuclear_norm = 925.32227
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 76.64020 | spectral_norm = 5.55483 | nuclear_norm = 2036.60889
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 42.47777 | spectral_norm = 2.90175 | nuclear_norm = 1126.61401
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 33.76834 | spectral_norm = 3.17601 | nuclear_norm = 777.95636
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 34.39243 | spectral_norm = 3.07212 | nuclear_norm = 792.41565
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 38.90028 | spectral_norm = 3.48500 | nuclear_norm = 841.89355
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 39.94267 | spectral_norm = 3.19989 | nuclear_norm = 905.41333
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 78.67241 | spectral_norm = 5.36415 | nuclear_norm = 2087.59033
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 42.71805 | spectral_norm = 3.01607 | nuclear_norm = 1130.95166
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 33.16941 | spectral_norm = 3.15185 | nuclear_norm = 765.39355
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 33.87387 | spectral_norm = 3.27718 | nuclear_norm = 782.18359
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 38.99000 | spectral_norm = 3.47124 | nuclear_norm = 842.02460
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 39.27697 | spectral_norm = 3.19183 | nuclear_norm = 875.10364
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 79.51428 | spectral_norm = 5.45989 | nuclear_norm = 2106.68408
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 42.48557 | spectral_norm = 2.96638 | nuclear_norm = 1124.12134
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 32.82963 | spectral_norm = 3.04965 | nuclear_norm = 751.39148
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 33.97912 | spectral_norm = 3.06598 | nuclear_norm = 777.11829
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 39.19301 | spectral_norm = 3.61185 | nuclear_norm = 846.32660
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 41.22588 | spectral_norm = 3.26463 | nuclear_norm = 940.31226
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 78.30163 | spectral_norm = 5.59494 | nuclear_norm = 2069.28687
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 41.55209 | spectral_norm = 2.88863 | nuclear_norm = 1096.05640
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 32.69221 | spectral_norm = 3.05958 | nuclear_norm = 746.67084
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 33.79111 | spectral_norm = 2.92795 | nuclear_norm = 774.02209
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 39.55838 | spectral_norm = 3.85858 | nuclear_norm = 849.55017
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 41.83409 | spectral_norm = 3.41393 | nuclear_norm = 957.39014
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 78.19714 | spectral_norm = 5.64299 | nuclear_norm = 2062.68262
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 41.22718 | spectral_norm = 2.86907 | nuclear_norm = 1083.05835
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 32.22779 | spectral_norm = 3.06812 | nuclear_norm = 732.76038
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 33.49764 | spectral_norm = 3.00914 | nuclear_norm = 763.68860
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 39.33182 | spectral_norm = 4.04410 | nuclear_norm = 844.13538
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 42.70499 | spectral_norm = 3.63581 | nuclear_norm = 978.37384
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 77.87806 | spectral_norm = 5.63798 | nuclear_norm = 2052.52173
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 40.93197 | spectral_norm = 2.87406 | nuclear_norm = 1074.21191
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 33.23462 | spectral_norm = 3.03938 | nuclear_norm = 758.74268
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 34.20431 | spectral_norm = 3.01184 | nuclear_norm = 780.41687
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 45.02206 | spectral_norm = 4.08906 | nuclear_norm = 993.50220
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 44.59194 | spectral_norm = 3.49115 | nuclear_norm = 1033.57312
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 78.78053 | spectral_norm = 5.65861 | nuclear_norm = 2077.85400
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 41.05007 | spectral_norm = 2.91694 | nuclear_norm = 1078.36646
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 33.13791 | spectral_norm = 3.11837 | nuclear_norm = 757.25562
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 34.12399 | spectral_norm = 3.08408 | nuclear_norm = 781.57666
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 39.01682 | spectral_norm = 3.64419 | nuclear_norm = 834.81860
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 41.10249 | spectral_norm = 3.43519 | nuclear_norm = 923.85010
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 78.79894 | spectral_norm = 5.90518 | nuclear_norm = 2078.43896
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 40.82477 | spectral_norm = 2.93264 | nuclear_norm = 1071.30493
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 32.84397 | spectral_norm = 3.06411 | nuclear_norm = 750.13196
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 33.75359 | spectral_norm = 3.03313 | nuclear_norm = 769.18878
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 36.65916 | spectral_norm = 3.19886 | nuclear_norm = 810.07275
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 44.70686 | spectral_norm = 3.28409 | nuclear_norm = 1040.34766
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 75.94859 | spectral_norm = 5.85051 | nuclear_norm = 2006.09863
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 39.45273 | spectral_norm = 2.86237 | nuclear_norm = 1034.64575
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 32.91596 | spectral_norm = 3.01439 | nuclear_norm = 752.51086
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 33.39281 | spectral_norm = 3.04792 | nuclear_norm = 760.33936
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 38.71279 | spectral_norm = 3.34225 | nuclear_norm = 842.35883
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 42.89664 | spectral_norm = 3.18367 | nuclear_norm = 988.79700
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 73.96151 | spectral_norm = 5.81327 | nuclear_norm = 1952.95825
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 38.54527 | spectral_norm = 2.86164 | nuclear_norm = 1008.43945
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 378.49115 | spectral_norm = 131.92343 | nuclear_norm = 8965.19434
===========================================
step:126/1750 train_loss:4.3315 train_time:76395ms step_avg:658.58ms
step:127/1750 train_loss:4.5234 train_time:77048ms step_avg:658.53ms
step:128/1750 train_loss:4.5162 train_time:77700ms step_avg:658.48ms
step:129/1750 train_loss:4.5225 train_time:78354ms step_avg:658.44ms
step:130/1750 train_loss:4.4752 train_time:79008ms step_avg:658.40ms
step:131/1750 train_loss:4.6074 train_time:79683ms step_avg:658.54ms
step:132/1750 train_loss:4.3481 train_time:80359ms step_avg:658.68ms
step:133/1750 train_loss:4.3359 train_time:81033ms step_avg:658.81ms
step:134/1750 train_loss:4.4892 train_time:81709ms step_avg:658.94ms
step:135/1750 train_loss:4.3196 train_time:82383ms step_avg:659.06ms
step:136/1750 train_loss:4.3146 train_time:83058ms step_avg:659.19ms
step:137/1750 train_loss:4.3664 train_time:83733ms step_avg:659.32ms
step:138/1750 train_loss:4.3984 train_time:84407ms step_avg:659.43ms
step:139/1750 train_loss:4.5033 train_time:85082ms step_avg:659.55ms
step:140/1750 train_loss:4.3927 train_time:85757ms step_avg:659.67ms
step:141/1750 train_loss:4.2926 train_time:86434ms step_avg:659.80ms
step:142/1750 train_loss:4.4005 train_time:87109ms step_avg:659.92ms
step:143/1750 train_loss:4.5005 train_time:87787ms step_avg:660.05ms
step:144/1750 train_loss:4.5715 train_time:88463ms step_avg:660.17ms
step:145/1750 train_loss:4.3446 train_time:89139ms step_avg:660.29ms
step:146/1750 train_loss:4.3518 train_time:89815ms step_avg:660.40ms
step:147/1750 train_loss:4.3869 train_time:90492ms step_avg:660.52ms
step:148/1750 train_loss:4.1816 train_time:91167ms step_avg:660.63ms
step:149/1750 train_loss:4.3546 train_time:91843ms step_avg:660.74ms
step:150/1750 train_loss:4.3012 train_time:92519ms step_avg:660.85ms
step:151/1750 train_loss:4.3109 train_time:93194ms step_avg:660.95ms
step:152/1750 train_loss:4.1982 train_time:93870ms step_avg:661.06ms
step:153/1750 train_loss:4.3881 train_time:94546ms step_avg:661.16ms
step:154/1750 train_loss:4.1953 train_time:95222ms step_avg:661.26ms
step:155/1750 train_loss:4.1837 train_time:95898ms step_avg:661.37ms
step:156/1750 train_loss:4.3147 train_time:96574ms step_avg:661.47ms
step:157/1750 train_loss:4.3892 train_time:97250ms step_avg:661.57ms
step:158/1750 train_loss:4.2831 train_time:97926ms step_avg:661.66ms
step:159/1750 train_loss:4.2430 train_time:98601ms step_avg:661.75ms
step:160/1750 train_loss:4.1969 train_time:99276ms step_avg:661.84ms
step:161/1750 train_loss:4.2568 train_time:99952ms step_avg:661.93ms
step:162/1750 train_loss:4.2735 train_time:100627ms step_avg:662.02ms
step:163/1750 train_loss:4.2347 train_time:101304ms step_avg:662.12ms
step:164/1750 train_loss:4.1718 train_time:101980ms step_avg:662.21ms
step:165/1750 train_loss:4.2711 train_time:102656ms step_avg:662.30ms
step:166/1750 train_loss:4.3882 train_time:103332ms step_avg:662.38ms
step:167/1750 train_loss:4.3309 train_time:104008ms step_avg:662.47ms
step:168/1750 train_loss:4.2378 train_time:104683ms step_avg:662.55ms
step:169/1750 train_loss:4.2801 train_time:105360ms step_avg:662.64ms
step:170/1750 train_loss:4.3189 train_time:106036ms step_avg:662.72ms
step:171/1750 train_loss:3.8192 train_time:106713ms step_avg:662.81ms
step:172/1750 train_loss:4.1657 train_time:107388ms step_avg:662.89ms
step:173/1750 train_loss:4.1811 train_time:108064ms step_avg:662.97ms
step:174/1750 train_loss:4.3718 train_time:108741ms step_avg:663.05ms
step:175/1750 train_loss:4.1922 train_time:109416ms step_avg:663.13ms
step:176/1750 train_loss:4.2543 train_time:110093ms step_avg:663.21ms
step:177/1750 train_loss:4.3871 train_time:110768ms step_avg:663.28ms
step:178/1750 train_loss:4.2542 train_time:111444ms step_avg:663.36ms
step:179/1750 train_loss:4.1998 train_time:112120ms step_avg:663.43ms
step:180/1750 train_loss:4.2553 train_time:112795ms step_avg:663.50ms
step:181/1750 train_loss:4.1471 train_time:113472ms step_avg:663.58ms
step:182/1750 train_loss:4.1881 train_time:114149ms step_avg:663.66ms
step:183/1750 train_loss:4.1606 train_time:114825ms step_avg:663.73ms
step:184/1750 train_loss:4.3149 train_time:115502ms step_avg:663.80ms
step:185/1750 train_loss:4.2077 train_time:116178ms step_avg:663.87ms
step:186/1750 train_loss:4.3189 train_time:116854ms step_avg:663.95ms
step:187/1750 train_loss:4.2125 train_time:117530ms step_avg:664.01ms
step:188/1750 train_loss:4.1963 train_time:118204ms step_avg:664.07ms
step:189/1750 train_loss:4.0196 train_time:118880ms step_avg:664.14ms
step:190/1750 train_loss:4.1327 train_time:119760ms step_avg:665.33ms
step:191/1750 train_loss:4.1250 train_time:120436ms step_avg:665.39ms
step:192/1750 train_loss:4.0812 train_time:121112ms step_avg:665.45ms
step:193/1750 train_loss:4.3039 train_time:121789ms step_avg:665.51ms
step:194/1750 train_loss:4.2214 train_time:122466ms step_avg:665.58ms
step:195/1750 train_loss:4.3961 train_time:123141ms step_avg:665.62ms
step:196/1750 train_loss:4.2259 train_time:123812ms step_avg:665.66ms
step:197/1750 train_loss:4.0859 train_time:124483ms step_avg:665.69ms
step:198/1750 train_loss:4.2043 train_time:125155ms step_avg:665.72ms
step:199/1750 train_loss:4.0598 train_time:125827ms step_avg:665.75ms
step:200/1750 train_loss:4.1454 train_time:126498ms step_avg:665.78ms
step:201/1750 train_loss:4.0316 train_time:127170ms step_avg:665.81ms
step:202/1750 train_loss:4.2844 train_time:127844ms step_avg:665.85ms
step:203/1750 train_loss:4.0891 train_time:128516ms step_avg:665.89ms
step:204/1750 train_loss:4.2184 train_time:129188ms step_avg:665.92ms
step:205/1750 train_loss:4.2733 train_time:129860ms step_avg:665.95ms
step:206/1750 train_loss:3.9710 train_time:130531ms step_avg:665.97ms
step:207/1750 train_loss:4.1108 train_time:131204ms step_avg:666.01ms
step:208/1750 train_loss:4.1218 train_time:131875ms step_avg:666.04ms
step:209/1750 train_loss:4.2677 train_time:132547ms step_avg:666.06ms
step:210/1750 train_loss:4.2100 train_time:133220ms step_avg:666.10ms
step:211/1750 train_loss:4.0798 train_time:133891ms step_avg:666.12ms
step:212/1750 train_loss:4.1415 train_time:134561ms step_avg:666.14ms
step:213/1750 train_loss:4.0774 train_time:135234ms step_avg:666.18ms
step:214/1750 train_loss:4.1413 train_time:135907ms step_avg:666.21ms
step:215/1750 train_loss:3.9862 train_time:136579ms step_avg:666.24ms
step:216/1750 train_loss:4.0344 train_time:137252ms step_avg:666.27ms
step:217/1750 train_loss:4.0384 train_time:137925ms step_avg:666.31ms
step:218/1750 train_loss:4.1125 train_time:138597ms step_avg:666.33ms
step:219/1750 train_loss:4.0845 train_time:139269ms step_avg:666.36ms
step:220/1750 train_loss:4.1117 train_time:139942ms step_avg:666.39ms
step:221/1750 train_loss:4.1287 train_time:140613ms step_avg:666.41ms
step:222/1750 train_loss:4.0149 train_time:141285ms step_avg:666.44ms
step:223/1750 train_loss:4.0055 train_time:141957ms step_avg:666.46ms
step:224/1750 train_loss:4.3215 train_time:142630ms step_avg:666.49ms
step:225/1750 train_loss:3.9304 train_time:143301ms step_avg:666.51ms
step:226/1750 train_loss:4.0286 train_time:143973ms step_avg:666.54ms
step:227/1750 train_loss:4.0250 train_time:144643ms step_avg:666.56ms
step:228/1750 train_loss:4.1676 train_time:145315ms step_avg:666.58ms
step:229/1750 train_loss:3.9575 train_time:145987ms step_avg:666.61ms
step:230/1750 train_loss:4.0827 train_time:146659ms step_avg:666.63ms
step:231/1750 train_loss:3.9341 train_time:147329ms step_avg:666.65ms
step:232/1750 train_loss:4.0009 train_time:148001ms step_avg:666.67ms
step:233/1750 train_loss:4.1255 train_time:148673ms step_avg:666.69ms
step:234/1750 train_loss:4.0642 train_time:149345ms step_avg:666.72ms
step:235/1750 train_loss:3.9370 train_time:150017ms step_avg:666.74ms
step:236/1750 train_loss:4.1244 train_time:150687ms step_avg:666.76ms
step:237/1750 train_loss:4.1165 train_time:151359ms step_avg:666.78ms
step:238/1750 train_loss:3.9825 train_time:152031ms step_avg:666.80ms
step:239/1750 train_loss:4.1053 train_time:152704ms step_avg:666.83ms
step:240/1750 train_loss:4.1333 train_time:153376ms step_avg:666.85ms
step:241/1750 train_loss:3.9987 train_time:154048ms step_avg:666.88ms
step:242/1750 train_loss:4.1777 train_time:154719ms step_avg:666.89ms
step:243/1750 train_loss:4.0436 train_time:155391ms step_avg:666.92ms
step:244/1750 train_loss:4.1155 train_time:156063ms step_avg:666.94ms
step:245/1750 train_loss:4.1821 train_time:156735ms step_avg:666.96ms
step:246/1750 train_loss:4.0892 train_time:157408ms step_avg:666.98ms
step:247/1750 train_loss:4.0355 train_time:158080ms step_avg:667.00ms
step:248/1750 train_loss:4.1405 train_time:158752ms step_avg:667.03ms
step:249/1750 train_loss:3.9473 train_time:159423ms step_avg:667.04ms
step:250/1750 train_loss:4.0087 train_time:160095ms step_avg:667.06ms
step:250/1750 val_loss:4.0373 train_time:160106ms step_avg:667.11ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | frobenius_norm = 35588.67969 | spectral_norm = 7713.36963 | nuclear_norm = 869320.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 57.43877 | spectral_norm = 6.19093 | nuclear_norm = 1343.01514
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 56.14943 | spectral_norm = 8.00556 | nuclear_norm = 1305.25916
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 73.29530 | spectral_norm = 5.00202 | nuclear_norm = 1688.68689
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 57.72850 | spectral_norm = 4.97003 | nuclear_norm = 1354.83130
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 109.03636 | spectral_norm = 9.59499 | nuclear_norm = 2895.32910
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 59.94892 | spectral_norm = 4.40937 | nuclear_norm = 1590.58337
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 55.69635 | spectral_norm = 5.23751 | nuclear_norm = 1298.75476
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 54.58393 | spectral_norm = 6.55966 | nuclear_norm = 1272.40820
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 59.15775 | spectral_norm = 4.97723 | nuclear_norm = 1337.89600
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 59.20830 | spectral_norm = 4.61545 | nuclear_norm = 1370.86182
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 122.17255 | spectral_norm = 7.94787 | nuclear_norm = 3259.50488
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 62.67894 | spectral_norm = 5.04778 | nuclear_norm = 1661.81299
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 55.99721 | spectral_norm = 4.99150 | nuclear_norm = 1303.22388
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 55.23482 | spectral_norm = 4.99255 | nuclear_norm = 1285.13184
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 64.84144 | spectral_norm = 5.86384 | nuclear_norm = 1432.50195
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 63.23563 | spectral_norm = 4.56320 | nuclear_norm = 1488.12646
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 121.66754 | spectral_norm = 8.68665 | nuclear_norm = 3248.35156
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 63.64677 | spectral_norm = 4.80011 | nuclear_norm = 1687.20996
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 54.91142 | spectral_norm = 5.11724 | nuclear_norm = 1269.51587
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 54.83961 | spectral_norm = 4.97464 | nuclear_norm = 1266.57153
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 60.98787 | spectral_norm = 5.43788 | nuclear_norm = 1335.67603
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 64.02171 | spectral_norm = 5.18978 | nuclear_norm = 1476.01892
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 126.09908 | spectral_norm = 8.53038 | nuclear_norm = 3361.37012
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 64.29345 | spectral_norm = 5.00694 | nuclear_norm = 1699.79932
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 53.63745 | spectral_norm = 5.28491 | nuclear_norm = 1239.84570
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 53.73599 | spectral_norm = 5.23213 | nuclear_norm = 1246.19238
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 61.25684 | spectral_norm = 5.27779 | nuclear_norm = 1330.56946
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 62.94506 | spectral_norm = 4.94041 | nuclear_norm = 1416.70605
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 127.60071 | spectral_norm = 8.80611 | nuclear_norm = 3395.64844
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 63.97520 | spectral_norm = 5.16188 | nuclear_norm = 1692.40698
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 53.71579 | spectral_norm = 4.82615 | nuclear_norm = 1226.44568
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 54.69605 | spectral_norm = 4.73279 | nuclear_norm = 1252.07166
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 61.92821 | spectral_norm = 5.54331 | nuclear_norm = 1357.83325
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 66.29504 | spectral_norm = 5.33987 | nuclear_norm = 1534.58643
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 129.24751 | spectral_norm = 8.64364 | nuclear_norm = 3437.01709
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 63.06727 | spectral_norm = 4.81599 | nuclear_norm = 1667.51062
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 54.32689 | spectral_norm = 5.07778 | nuclear_norm = 1245.99438
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 54.48423 | spectral_norm = 4.63758 | nuclear_norm = 1253.26025
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 64.25900 | spectral_norm = 6.43901 | nuclear_norm = 1384.95471
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 69.03275 | spectral_norm = 5.64551 | nuclear_norm = 1610.80005
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 126.32985 | spectral_norm = 8.95245 | nuclear_norm = 3356.87354
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 62.90093 | spectral_norm = 4.97050 | nuclear_norm = 1659.52563
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 54.04297 | spectral_norm = 4.95346 | nuclear_norm = 1235.44702
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 54.34741 | spectral_norm = 4.67216 | nuclear_norm = 1249.02148
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 65.82503 | spectral_norm = 6.59272 | nuclear_norm = 1424.13086
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 70.89197 | spectral_norm = 5.56282 | nuclear_norm = 1653.27112
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 125.68368 | spectral_norm = 9.15670 | nuclear_norm = 3336.83325
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 62.95152 | spectral_norm = 5.07371 | nuclear_norm = 1662.41187
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 55.34686 | spectral_norm = 5.00744 | nuclear_norm = 1272.87842
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 55.25143 | spectral_norm = 4.99287 | nuclear_norm = 1267.14429
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 72.19221 | spectral_norm = 6.56503 | nuclear_norm = 1608.15967
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 72.06520 | spectral_norm = 5.19376 | nuclear_norm = 1693.61584
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 125.44795 | spectral_norm = 9.17783 | nuclear_norm = 3330.67822
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 63.07637 | spectral_norm = 5.22836 | nuclear_norm = 1667.11597
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 54.28825 | spectral_norm = 5.34518 | nuclear_norm = 1245.66797
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 54.53091 | spectral_norm = 5.03073 | nuclear_norm = 1256.15381
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 63.99337 | spectral_norm = 6.07851 | nuclear_norm = 1388.55151
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 67.59293 | spectral_norm = 5.76154 | nuclear_norm = 1551.44751
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 127.91241 | spectral_norm = 9.38678 | nuclear_norm = 3396.03320
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 63.42167 | spectral_norm = 5.42256 | nuclear_norm = 1675.50476
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 55.06431 | spectral_norm = 5.04568 | nuclear_norm = 1259.01636
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 55.07648 | spectral_norm = 5.04678 | nuclear_norm = 1253.04346
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 54.13583 | spectral_norm = 4.43640 | nuclear_norm = 1232.44214
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 72.58436 | spectral_norm = 4.99185 | nuclear_norm = 1710.22729
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 123.54720 | spectral_norm = 9.25629 | nuclear_norm = 3286.23462
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 62.20244 | spectral_norm = 5.61813 | nuclear_norm = 1642.91858
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 55.46611 | spectral_norm = 5.42270 | nuclear_norm = 1271.92517
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 54.96054 | spectral_norm = 5.23167 | nuclear_norm = 1253.51160
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 63.55851 | spectral_norm = 5.46896 | nuclear_norm = 1416.79736
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 72.82360 | spectral_norm = 5.13660 | nuclear_norm = 1700.66870
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 121.72262 | spectral_norm = 9.05154 | nuclear_norm = 3238.09253
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 62.31476 | spectral_norm = 5.68179 | nuclear_norm = 1639.41724
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 544.15253 | spectral_norm = 151.16460 | nuclear_norm = 13494.83398
===========================================
step:251/1750 train_loss:4.1032 train_time:160758ms step_avg:667.05ms
step:252/1750 train_loss:4.1915 train_time:161426ms step_avg:667.05ms
step:253/1750 train_loss:3.9589 train_time:162093ms step_avg:667.05ms
step:254/1750 train_loss:3.9046 train_time:162763ms step_avg:667.06ms
step:255/1750 train_loss:4.1059 train_time:163434ms step_avg:667.08ms
step:256/1750 train_loss:4.0252 train_time:164106ms step_avg:667.10ms
step:257/1750 train_loss:4.0278 train_time:164777ms step_avg:667.11ms
step:258/1750 train_loss:4.0151 train_time:165449ms step_avg:667.13ms
step:259/1750 train_loss:4.0544 train_time:166121ms step_avg:667.15ms
step:260/1750 train_loss:4.0950 train_time:166792ms step_avg:667.17ms
step:261/1750 train_loss:4.0415 train_time:167480ms step_avg:667.25ms
step:262/1750 train_loss:4.0172 train_time:168170ms step_avg:667.34ms
step:263/1750 train_loss:3.9234 train_time:168862ms step_avg:667.44ms
step:264/1750 train_loss:4.0201 train_time:169551ms step_avg:667.52ms
step:265/1750 train_loss:3.8971 train_time:170243ms step_avg:667.62ms
step:266/1750 train_loss:3.9396 train_time:170932ms step_avg:667.70ms
step:267/1750 train_loss:3.9398 train_time:171621ms step_avg:667.79ms
step:268/1750 train_loss:3.9832 train_time:172310ms step_avg:667.87ms
step:269/1750 train_loss:3.8790 train_time:173000ms step_avg:667.95ms
step:270/1750 train_loss:4.1256 train_time:173689ms step_avg:668.04ms
step:271/1750 train_loss:3.9908 train_time:174376ms step_avg:668.11ms
step:272/1750 train_loss:3.9498 train_time:175067ms step_avg:668.19ms
step:273/1750 train_loss:3.9751 train_time:175757ms step_avg:668.28ms
step:274/1750 train_loss:4.0634 train_time:176447ms step_avg:668.36ms
step:275/1750 train_loss:4.0768 train_time:177140ms step_avg:668.45ms
step:276/1750 train_loss:4.2396 train_time:177831ms step_avg:668.54ms
step:277/1750 train_loss:4.0616 train_time:178521ms step_avg:668.62ms
step:278/1750 train_loss:4.1132 train_time:179210ms step_avg:668.69ms
step:279/1750 train_loss:4.0244 train_time:179900ms step_avg:668.77ms
step:280/1750 train_loss:4.2223 train_time:180593ms step_avg:668.86ms
step:281/1750 train_loss:4.0017 train_time:181286ms step_avg:668.95ms
step:282/1750 train_loss:3.9839 train_time:181980ms step_avg:669.05ms
step:283/1750 train_loss:3.9335 train_time:182672ms step_avg:669.13ms
step:284/1750 train_loss:4.0661 train_time:183363ms step_avg:669.21ms
step:285/1750 train_loss:4.0823 train_time:184052ms step_avg:669.28ms
step:286/1750 train_loss:4.1203 train_time:184745ms step_avg:669.37ms
step:287/1750 train_loss:3.9440 train_time:185435ms step_avg:669.44ms
step:288/1750 train_loss:4.0390 train_time:186123ms step_avg:669.51ms
step:289/1750 train_loss:3.9171 train_time:186816ms step_avg:669.59ms
step:290/1750 train_loss:3.8803 train_time:187505ms step_avg:669.66ms
step:291/1750 train_loss:3.9584 train_time:188194ms step_avg:669.73ms
step:292/1750 train_loss:3.8926 train_time:188882ms step_avg:669.80ms
step:293/1750 train_loss:3.9442 train_time:189571ms step_avg:669.86ms
step:294/1750 train_loss:3.9737 train_time:190261ms step_avg:669.93ms
step:295/1750 train_loss:3.8545 train_time:190951ms step_avg:670.00ms
step:296/1750 train_loss:3.8970 train_time:191641ms step_avg:670.07ms
step:297/1750 train_loss:3.9044 train_time:192330ms step_avg:670.14ms
step:298/1750 train_loss:4.0097 train_time:193020ms step_avg:670.21ms
step:299/1750 train_loss:3.8461 train_time:193710ms step_avg:670.28ms
step:300/1750 train_loss:3.9912 train_time:194403ms step_avg:670.35ms
step:301/1750 train_loss:3.9939 train_time:195093ms step_avg:670.42ms
step:302/1750 train_loss:3.9645 train_time:195781ms step_avg:670.48ms
step:303/1750 train_loss:4.0003 train_time:196471ms step_avg:670.55ms
step:304/1750 train_loss:3.9931 train_time:197160ms step_avg:670.61ms
step:305/1750 train_loss:4.4907 train_time:197849ms step_avg:670.67ms
step:306/1750 train_loss:3.9710 train_time:198540ms step_avg:670.74ms
step:307/1750 train_loss:3.8631 train_time:199232ms step_avg:670.81ms
step:308/1750 train_loss:4.0095 train_time:199921ms step_avg:670.88ms
step:309/1750 train_loss:3.8932 train_time:200609ms step_avg:670.93ms
step:310/1750 train_loss:4.1107 train_time:201298ms step_avg:670.99ms
step:311/1750 train_loss:3.9550 train_time:201987ms step_avg:671.05ms
step:312/1750 train_loss:3.8924 train_time:202676ms step_avg:671.11ms
step:313/1750 train_loss:3.9728 train_time:203369ms step_avg:671.18ms
step:314/1750 train_loss:4.0969 train_time:204057ms step_avg:671.24ms
step:315/1750 train_loss:3.9741 train_time:204746ms step_avg:671.30ms
step:316/1750 train_loss:3.8325 train_time:205435ms step_avg:671.36ms
step:317/1750 train_loss:3.9094 train_time:206125ms step_avg:671.42ms
step:318/1750 train_loss:3.9522 train_time:206817ms step_avg:671.48ms
step:319/1750 train_loss:3.9159 train_time:207508ms step_avg:671.55ms
step:320/1750 train_loss:4.0475 train_time:208198ms step_avg:671.61ms
step:321/1750 train_loss:3.9788 train_time:208888ms step_avg:671.67ms
step:322/1750 train_loss:3.9592 train_time:209577ms step_avg:671.72ms
step:323/1750 train_loss:4.0248 train_time:210265ms step_avg:671.77ms
step:324/1750 train_loss:3.9786 train_time:210956ms step_avg:671.84ms
step:325/1750 train_loss:4.0371 train_time:211646ms step_avg:671.89ms
step:326/1750 train_loss:3.9193 train_time:212330ms step_avg:671.93ms
step:327/1750 train_loss:4.4191 train_time:213017ms step_avg:671.98ms
step:328/1750 train_loss:4.0976 train_time:213704ms step_avg:672.03ms
step:329/1750 train_loss:3.8272 train_time:214394ms step_avg:672.08ms
step:330/1750 train_loss:3.7668 train_time:215079ms step_avg:672.12ms
step:331/1750 train_loss:4.0057 train_time:215765ms step_avg:672.17ms
step:332/1750 train_loss:3.9280 train_time:216449ms step_avg:672.20ms
step:333/1750 train_loss:3.8976 train_time:217135ms step_avg:672.24ms
step:334/1750 train_loss:3.8648 train_time:217821ms step_avg:672.29ms
step:335/1750 train_loss:4.0358 train_time:218504ms step_avg:672.32ms
step:336/1750 train_loss:3.9886 train_time:219191ms step_avg:672.36ms
step:337/1750 train_loss:4.4560 train_time:219877ms step_avg:672.41ms
step:338/1750 train_loss:3.9792 train_time:220563ms step_avg:672.45ms
step:339/1750 train_loss:3.8889 train_time:221250ms step_avg:672.49ms
step:340/1750 train_loss:3.9525 train_time:221937ms step_avg:672.54ms
step:341/1750 train_loss:3.8807 train_time:222623ms step_avg:672.58ms
step:342/1750 train_loss:3.8332 train_time:223307ms step_avg:672.61ms
step:343/1750 train_loss:3.8645 train_time:223996ms step_avg:672.66ms
step:344/1750 train_loss:4.0233 train_time:224683ms step_avg:672.70ms
step:345/1750 train_loss:3.8326 train_time:225369ms step_avg:672.74ms
step:346/1750 train_loss:3.7828 train_time:226054ms step_avg:672.78ms
step:347/1750 train_loss:3.8248 train_time:226739ms step_avg:672.81ms
step:348/1750 train_loss:3.8874 train_time:227422ms step_avg:672.85ms
step:349/1750 train_loss:3.8584 train_time:228106ms step_avg:672.88ms
step:350/1750 train_loss:3.5902 train_time:228790ms step_avg:672.91ms
step:351/1750 train_loss:3.8475 train_time:229475ms step_avg:672.95ms
step:352/1750 train_loss:4.2124 train_time:230158ms step_avg:672.98ms
step:353/1750 train_loss:3.6819 train_time:230844ms step_avg:673.01ms
step:354/1750 train_loss:3.9506 train_time:231529ms step_avg:673.05ms
step:355/1750 train_loss:3.8135 train_time:232215ms step_avg:673.09ms
step:356/1750 train_loss:3.9039 train_time:232899ms step_avg:673.12ms
step:357/1750 train_loss:3.7879 train_time:233584ms step_avg:673.15ms
step:358/1750 train_loss:3.8833 train_time:234270ms step_avg:673.19ms
step:359/1750 train_loss:3.8623 train_time:234955ms step_avg:673.22ms
step:360/1750 train_loss:3.4607 train_time:235640ms step_avg:673.26ms
step:361/1750 train_loss:4.0401 train_time:236324ms step_avg:673.29ms
step:362/1750 train_loss:3.9495 train_time:237009ms step_avg:673.32ms
step:363/1750 train_loss:3.8647 train_time:237692ms step_avg:673.35ms
step:364/1750 train_loss:3.7662 train_time:238377ms step_avg:673.38ms
step:365/1750 train_loss:3.9379 train_time:239059ms step_avg:673.41ms
step:366/1750 train_loss:3.8896 train_time:239744ms step_avg:673.44ms
step:367/1750 train_loss:3.8821 train_time:240427ms step_avg:673.47ms
step:368/1750 train_loss:3.8724 train_time:241113ms step_avg:673.50ms
step:369/1750 train_loss:3.7611 train_time:241797ms step_avg:673.53ms
step:370/1750 train_loss:3.9118 train_time:242480ms step_avg:673.56ms
step:371/1750 train_loss:3.7655 train_time:243165ms step_avg:673.59ms
step:372/1750 train_loss:3.7182 train_time:243849ms step_avg:673.62ms
step:373/1750 train_loss:3.9410 train_time:244532ms step_avg:673.64ms
step:374/1750 train_loss:3.8528 train_time:245218ms step_avg:673.68ms
step:375/1750 train_loss:3.8244 train_time:245902ms step_avg:673.70ms
step:375/1750 val_loss:3.8515 train_time:245913ms step_avg:673.73ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | frobenius_norm = 42099.90625 | spectral_norm = 8440.93066 | nuclear_norm = 1036225.06250
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 82.09432 | spectral_norm = 9.87281 | nuclear_norm = 1918.56995
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 80.32410 | spectral_norm = 12.32152 | nuclear_norm = 1864.75623
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 104.16438 | spectral_norm = 6.86113 | nuclear_norm = 2446.00537
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 82.88971 | spectral_norm = 7.51134 | nuclear_norm = 1945.63525
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 163.65950 | spectral_norm = 13.21115 | nuclear_norm = 4351.49854
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 87.40757 | spectral_norm = 6.98558 | nuclear_norm = 2323.43091
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 80.65676 | spectral_norm = 7.49781 | nuclear_norm = 1881.25110
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 79.35822 | spectral_norm = 9.19792 | nuclear_norm = 1851.56201
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 84.05676 | spectral_norm = 6.95275 | nuclear_norm = 1930.13074
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 83.35766 | spectral_norm = 6.60000 | nuclear_norm = 1937.11279
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 174.36319 | spectral_norm = 11.34694 | nuclear_norm = 4656.16797
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 88.97005 | spectral_norm = 7.66598 | nuclear_norm = 2358.61548
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 81.29746 | spectral_norm = 7.31024 | nuclear_norm = 1893.37585
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 79.88224 | spectral_norm = 7.32356 | nuclear_norm = 1859.70813
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 93.51469 | spectral_norm = 8.23198 | nuclear_norm = 2104.33154
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 91.78784 | spectral_norm = 6.47874 | nuclear_norm = 2168.00952
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 172.61336 | spectral_norm = 12.14222 | nuclear_norm = 4612.83594
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 89.28634 | spectral_norm = 7.13812 | nuclear_norm = 2366.70483
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 80.28769 | spectral_norm = 7.59155 | nuclear_norm = 1859.11133
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 79.57970 | spectral_norm = 7.26132 | nuclear_norm = 1839.19299
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 88.78371 | spectral_norm = 7.79055 | nuclear_norm = 1981.88208
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 92.01431 | spectral_norm = 7.59338 | nuclear_norm = 2127.78394
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 178.39279 | spectral_norm = 12.32707 | nuclear_norm = 4762.29688
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 88.86569 | spectral_norm = 7.40488 | nuclear_norm = 2344.68506
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 78.51423 | spectral_norm = 7.82049 | nuclear_norm = 1817.63623
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 78.01870 | spectral_norm = 7.57612 | nuclear_norm = 1814.62305
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 86.91884 | spectral_norm = 7.57746 | nuclear_norm = 1908.07397
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 88.95380 | spectral_norm = 7.03134 | nuclear_norm = 2009.68359
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 180.12155 | spectral_norm = 12.93328 | nuclear_norm = 4799.97754
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 89.28361 | spectral_norm = 7.47769 | nuclear_norm = 2358.49023
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 78.06918 | spectral_norm = 7.10031 | nuclear_norm = 1776.65564
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 78.79573 | spectral_norm = 6.78810 | nuclear_norm = 1802.26880
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 88.05283 | spectral_norm = 7.66979 | nuclear_norm = 1956.04370
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 92.79915 | spectral_norm = 7.36947 | nuclear_norm = 2145.69238
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 186.93712 | spectral_norm = 12.59594 | nuclear_norm = 4984.81396
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 88.43685 | spectral_norm = 7.35649 | nuclear_norm = 2337.17773
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 79.53419 | spectral_norm = 7.57374 | nuclear_norm = 1827.87073
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 78.61979 | spectral_norm = 6.87635 | nuclear_norm = 1809.18359
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 92.37554 | spectral_norm = 9.40952 | nuclear_norm = 2018.60657
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 98.27459 | spectral_norm = 7.91706 | nuclear_norm = 2304.02563
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 180.79446 | spectral_norm = 12.60514 | nuclear_norm = 4820.99805
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 88.70306 | spectral_norm = 7.49768 | nuclear_norm = 2343.74854
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 79.28203 | spectral_norm = 6.99920 | nuclear_norm = 1816.43896
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 78.90044 | spectral_norm = 6.88777 | nuclear_norm = 1812.83545
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 96.02866 | spectral_norm = 9.35797 | nuclear_norm = 2108.84473
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 101.33630 | spectral_norm = 8.02315 | nuclear_norm = 2372.77393
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 179.53632 | spectral_norm = 13.16744 | nuclear_norm = 4781.84277
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 89.58408 | spectral_norm = 7.64185 | nuclear_norm = 2372.98071
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 81.42597 | spectral_norm = 7.42664 | nuclear_norm = 1875.65125
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 80.77809 | spectral_norm = 7.57554 | nuclear_norm = 1850.90027
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 101.23093 | spectral_norm = 9.16699 | nuclear_norm = 2267.22437
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 101.30043 | spectral_norm = 7.22148 | nuclear_norm = 2385.85791
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 177.97723 | spectral_norm = 13.21908 | nuclear_norm = 4740.27832
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 90.16841 | spectral_norm = 7.76286 | nuclear_norm = 2390.65723
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 79.21137 | spectral_norm = 8.06225 | nuclear_norm = 1818.90869
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 79.02894 | spectral_norm = 7.50034 | nuclear_norm = 1826.32861
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 93.62295 | spectral_norm = 8.88615 | nuclear_norm = 2058.19775
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 95.32355 | spectral_norm = 8.30603 | nuclear_norm = 2182.31982
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 183.03967 | spectral_norm = 13.66989 | nuclear_norm = 4873.48291
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 89.42538 | spectral_norm = 8.14243 | nuclear_norm = 2368.24292
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 80.77558 | spectral_norm = 7.95547 | nuclear_norm = 1845.86755
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 80.67250 | spectral_norm = 7.59963 | nuclear_norm = 1829.91846
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 78.48264 | spectral_norm = 6.36329 | nuclear_norm = 1805.12158
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 99.24749 | spectral_norm = 6.72997 | nuclear_norm = 2344.08228
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 181.41837 | spectral_norm = 13.04746 | nuclear_norm = 4841.12549
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 87.69224 | spectral_norm = 8.64697 | nuclear_norm = 2319.70483
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 81.86179 | spectral_norm = 8.35057 | nuclear_norm = 1878.72437
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 80.68677 | spectral_norm = 7.92618 | nuclear_norm = 1841.08984
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 93.78168 | spectral_norm = 8.33760 | nuclear_norm = 2124.44263
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 104.95245 | spectral_norm = 7.37128 | nuclear_norm = 2459.79785
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 179.39798 | spectral_norm = 12.92629 | nuclear_norm = 4783.99121
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 88.66815 | spectral_norm = 9.02594 | nuclear_norm = 2333.56201
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 685.75574 | spectral_norm = 161.73322 | nuclear_norm = 17346.43555
===========================================
step:376/1750 train_loss:3.8908 train_time:246577ms step_avg:673.71ms
step:377/1750 train_loss:3.8225 train_time:247260ms step_avg:673.73ms
step:378/1750 train_loss:3.8642 train_time:247942ms step_avg:673.76ms
step:379/1750 train_loss:3.8962 train_time:248622ms step_avg:673.77ms
step:380/1750 train_loss:3.9784 train_time:249522ms step_avg:674.38ms
step:381/1750 train_loss:3.7212 train_time:250418ms step_avg:674.98ms
step:382/1750 train_loss:3.7934 train_time:251107ms step_avg:675.02ms
step:383/1750 train_loss:3.8038 train_time:251789ms step_avg:675.04ms
step:384/1750 train_loss:3.9008 train_time:252472ms step_avg:675.06ms
step:385/1750 train_loss:3.6932 train_time:253154ms step_avg:675.08ms
step:386/1750 train_loss:3.8856 train_time:253837ms step_avg:675.10ms
step:387/1750 train_loss:3.8144 train_time:254520ms step_avg:675.12ms
step:388/1750 train_loss:3.9931 train_time:255203ms step_avg:675.14ms
step:389/1750 train_loss:3.8208 train_time:255886ms step_avg:675.16ms
step:390/1750 train_loss:3.8921 train_time:256585ms step_avg:675.22ms
step:391/1750 train_loss:3.7289 train_time:257284ms step_avg:675.29ms
step:392/1750 train_loss:3.7904 train_time:257981ms step_avg:675.34ms
step:393/1750 train_loss:3.8361 train_time:258676ms step_avg:675.39ms
step:394/1750 train_loss:3.8243 train_time:259372ms step_avg:675.45ms
step:395/1750 train_loss:3.8289 train_time:260069ms step_avg:675.50ms
step:396/1750 train_loss:3.7425 train_time:260769ms step_avg:675.57ms
step:397/1750 train_loss:3.5915 train_time:261470ms step_avg:675.63ms
step:398/1750 train_loss:3.8391 train_time:262170ms step_avg:675.70ms
step:399/1750 train_loss:3.8016 train_time:262868ms step_avg:675.75ms
step:400/1750 train_loss:3.7311 train_time:263564ms step_avg:675.80ms
step:401/1750 train_loss:3.8344 train_time:264263ms step_avg:675.86ms
step:402/1750 train_loss:3.7111 train_time:264961ms step_avg:675.92ms
step:403/1750 train_loss:4.0034 train_time:265662ms step_avg:675.98ms
step:404/1750 train_loss:3.9014 train_time:266361ms step_avg:676.04ms
step:405/1750 train_loss:3.8589 train_time:267060ms step_avg:676.10ms
step:406/1750 train_loss:3.8794 train_time:267758ms step_avg:676.16ms
step:407/1750 train_loss:3.8549 train_time:268454ms step_avg:676.21ms
step:408/1750 train_loss:3.7718 train_time:269156ms step_avg:676.27ms
step:409/1750 train_loss:3.8296 train_time:269853ms step_avg:676.32ms
step:410/1750 train_loss:3.7715 train_time:270549ms step_avg:676.37ms
step:411/1750 train_loss:3.7851 train_time:271246ms step_avg:676.42ms
step:412/1750 train_loss:3.7884 train_time:271944ms step_avg:676.48ms
step:413/1750 train_loss:3.7755 train_time:272643ms step_avg:676.53ms
step:414/1750 train_loss:3.9089 train_time:273345ms step_avg:676.60ms
step:415/1750 train_loss:3.7434 train_time:274044ms step_avg:676.65ms
step:416/1750 train_loss:3.8181 train_time:274743ms step_avg:676.71ms
step:417/1750 train_loss:3.9124 train_time:275440ms step_avg:676.76ms
step:418/1750 train_loss:3.6860 train_time:276141ms step_avg:676.82ms
step:419/1750 train_loss:3.9410 train_time:276837ms step_avg:676.86ms
step:420/1750 train_loss:4.0245 train_time:277536ms step_avg:676.92ms
step:421/1750 train_loss:3.7778 train_time:278234ms step_avg:676.97ms
step:422/1750 train_loss:3.9092 train_time:278932ms step_avg:677.02ms
step:423/1750 train_loss:3.6069 train_time:279633ms step_avg:677.08ms
step:424/1750 train_loss:3.7965 train_time:280330ms step_avg:677.13ms
step:425/1750 train_loss:3.6789 train_time:281030ms step_avg:677.18ms
step:426/1750 train_loss:3.8856 train_time:281728ms step_avg:677.23ms
step:427/1750 train_loss:3.8548 train_time:282427ms step_avg:677.28ms
step:428/1750 train_loss:3.7860 train_time:283128ms step_avg:677.34ms
step:429/1750 train_loss:3.8954 train_time:283825ms step_avg:677.39ms
step:430/1750 train_loss:3.7096 train_time:284524ms step_avg:677.44ms
step:431/1750 train_loss:3.6460 train_time:285226ms step_avg:677.50ms
step:432/1750 train_loss:3.8589 train_time:285923ms step_avg:677.54ms
step:433/1750 train_loss:3.8872 train_time:286620ms step_avg:677.59ms
step:434/1750 train_loss:3.8733 train_time:287318ms step_avg:677.64ms
step:435/1750 train_loss:3.7710 train_time:288019ms step_avg:677.69ms
step:436/1750 train_loss:3.8517 train_time:288717ms step_avg:677.74ms
step:437/1750 train_loss:3.8443 train_time:289414ms step_avg:677.78ms
step:438/1750 train_loss:3.8191 train_time:290112ms step_avg:677.83ms
step:439/1750 train_loss:3.8777 train_time:290812ms step_avg:677.88ms
step:440/1750 train_loss:3.7223 train_time:291514ms step_avg:677.94ms
step:441/1750 train_loss:3.8270 train_time:292213ms step_avg:677.99ms
step:442/1750 train_loss:3.7393 train_time:292914ms step_avg:678.04ms
step:443/1750 train_loss:3.6371 train_time:293612ms step_avg:678.09ms
step:444/1750 train_loss:3.7864 train_time:294307ms step_avg:678.13ms
step:445/1750 train_loss:4.0500 train_time:295008ms step_avg:678.18ms
step:446/1750 train_loss:3.6524 train_time:295706ms step_avg:678.22ms
step:447/1750 train_loss:3.8546 train_time:296404ms step_avg:678.27ms
step:448/1750 train_loss:3.8948 train_time:297103ms step_avg:678.32ms
step:449/1750 train_loss:3.7221 train_time:297803ms step_avg:678.37ms
step:450/1750 train_loss:3.6901 train_time:298502ms step_avg:678.41ms
step:451/1750 train_loss:3.7458 train_time:299206ms step_avg:678.47ms
step:452/1750 train_loss:4.0652 train_time:299907ms step_avg:678.52ms
step:453/1750 train_loss:3.9686 train_time:300605ms step_avg:678.57ms
step:454/1750 train_loss:3.8261 train_time:301304ms step_avg:678.61ms
step:455/1750 train_loss:3.7237 train_time:302002ms step_avg:678.66ms
step:456/1750 train_loss:3.8307 train_time:302698ms step_avg:678.69ms
step:457/1750 train_loss:3.7641 train_time:303392ms step_avg:678.73ms
step:458/1750 train_loss:3.7781 train_time:304086ms step_avg:678.76ms
step:459/1750 train_loss:3.8809 train_time:304781ms step_avg:678.80ms
step:460/1750 train_loss:3.6853 train_time:305479ms step_avg:678.84ms
step:461/1750 train_loss:3.8040 train_time:306176ms step_avg:678.88ms
step:462/1750 train_loss:3.7681 train_time:306872ms step_avg:678.92ms
step:463/1750 train_loss:3.6082 train_time:307568ms step_avg:678.96ms
step:464/1750 train_loss:3.7544 train_time:308262ms step_avg:678.99ms
step:465/1750 train_loss:3.8437 train_time:308956ms step_avg:679.02ms
step:466/1750 train_loss:3.7463 train_time:309653ms step_avg:679.06ms
step:467/1750 train_loss:3.7463 train_time:310349ms step_avg:679.10ms
step:468/1750 train_loss:3.7281 train_time:311044ms step_avg:679.14ms
step:469/1750 train_loss:3.9278 train_time:311737ms step_avg:679.16ms
step:470/1750 train_loss:3.7560 train_time:312431ms step_avg:679.20ms
step:471/1750 train_loss:3.6223 train_time:313129ms step_avg:679.24ms
step:472/1750 train_loss:3.8420 train_time:313823ms step_avg:679.27ms
step:473/1750 train_loss:3.6965 train_time:314515ms step_avg:679.30ms
step:474/1750 train_loss:3.8133 train_time:315211ms step_avg:679.33ms
step:475/1750 train_loss:3.8868 train_time:315904ms step_avg:679.36ms
step:476/1750 train_loss:4.0565 train_time:316600ms step_avg:679.40ms
step:477/1750 train_loss:3.8418 train_time:317294ms step_avg:679.43ms
step:478/1750 train_loss:3.8089 train_time:317989ms step_avg:679.46ms
step:479/1750 train_loss:3.7612 train_time:318685ms step_avg:679.50ms
step:480/1750 train_loss:3.7069 train_time:319382ms step_avg:679.54ms
step:481/1750 train_loss:3.7402 train_time:320077ms step_avg:679.57ms
step:482/1750 train_loss:3.8524 train_time:320774ms step_avg:679.61ms
step:483/1750 train_loss:3.7813 train_time:321470ms step_avg:679.64ms
step:484/1750 train_loss:3.8484 train_time:322165ms step_avg:679.67ms
step:485/1750 train_loss:3.7851 train_time:322861ms step_avg:679.71ms
step:486/1750 train_loss:3.6197 train_time:323556ms step_avg:679.74ms
step:487/1750 train_loss:3.7558 train_time:324251ms step_avg:679.77ms
step:488/1750 train_loss:3.7642 train_time:324948ms step_avg:679.81ms
step:489/1750 train_loss:3.7679 train_time:325641ms step_avg:679.84ms
step:490/1750 train_loss:3.9749 train_time:326336ms step_avg:679.87ms
step:491/1750 train_loss:3.7163 train_time:327030ms step_avg:679.90ms
step:492/1750 train_loss:3.6698 train_time:327724ms step_avg:679.93ms
step:493/1750 train_loss:3.7943 train_time:328418ms step_avg:679.96ms
step:494/1750 train_loss:3.5721 train_time:329117ms step_avg:679.99ms
step:495/1750 train_loss:3.7351 train_time:329813ms step_avg:680.03ms
step:496/1750 train_loss:3.9088 train_time:330512ms step_avg:680.07ms
step:497/1750 train_loss:3.7612 train_time:331208ms step_avg:680.10ms
step:498/1750 train_loss:3.7406 train_time:331904ms step_avg:680.13ms
step:499/1750 train_loss:3.7085 train_time:332598ms step_avg:680.16ms
step:500/1750 train_loss:3.8224 train_time:333294ms step_avg:680.19ms
step:500/1750 val_loss:3.7279 train_time:333306ms step_avg:680.22ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | frobenius_norm = 47276.59766 | spectral_norm = 9089.27148 | nuclear_norm = 1169715.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 103.52531 | spectral_norm = 13.71041 | nuclear_norm = 2411.93555
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 100.35503 | spectral_norm = 16.36075 | nuclear_norm = 2320.82959
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 130.76974 | spectral_norm = 8.48933 | nuclear_norm = 3091.32471
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 103.82641 | spectral_norm = 9.94496 | nuclear_norm = 2428.45947
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 209.77354 | spectral_norm = 16.48135 | nuclear_norm = 5575.62012
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 111.40907 | spectral_norm = 9.82808 | nuclear_norm = 2959.93115
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 101.82088 | spectral_norm = 9.58892 | nuclear_norm = 2366.92944
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 100.37677 | spectral_norm = 11.27031 | nuclear_norm = 2335.65088
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 105.13103 | spectral_norm = 8.69979 | nuclear_norm = 2421.07666
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 103.88483 | spectral_norm = 8.38061 | nuclear_norm = 2413.08862
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 219.30692 | spectral_norm = 14.49022 | nuclear_norm = 5855.61621
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 111.97466 | spectral_norm = 10.41720 | nuclear_norm = 2965.99170
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 102.58081 | spectral_norm = 9.54000 | nuclear_norm = 2379.29712
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 100.54073 | spectral_norm = 9.46983 | nuclear_norm = 2332.92920
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 119.35146 | spectral_norm = 10.47520 | nuclear_norm = 2702.15869
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 117.13238 | spectral_norm = 8.24773 | nuclear_norm = 2769.38184
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 215.79922 | spectral_norm = 15.47506 | nuclear_norm = 5765.26953
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 111.59280 | spectral_norm = 9.48015 | nuclear_norm = 2955.94897
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 101.41287 | spectral_norm = 9.89377 | nuclear_norm = 2336.42383
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 100.34059 | spectral_norm = 9.34299 | nuclear_norm = 2307.23633
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 114.21660 | spectral_norm = 10.16588 | nuclear_norm = 2559.67676
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 116.61844 | spectral_norm = 9.85337 | nuclear_norm = 2690.60571
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 222.91481 | spectral_norm = 16.28891 | nuclear_norm = 5950.59424
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 110.23825 | spectral_norm = 9.78948 | nuclear_norm = 2903.69385
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 99.33501 | spectral_norm = 10.17472 | nuclear_norm = 2287.86963
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 98.35052 | spectral_norm = 9.88868 | nuclear_norm = 2280.62598
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 109.76798 | spectral_norm = 9.63495 | nuclear_norm = 2414.27197
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 111.54028 | spectral_norm = 8.84602 | nuclear_norm = 2520.93359
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 223.95036 | spectral_norm = 17.24524 | nuclear_norm = 5963.52637
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 111.20858 | spectral_norm = 9.83589 | nuclear_norm = 2932.53076
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 98.31550 | spectral_norm = 9.24318 | nuclear_norm = 2218.35596
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 99.04617 | spectral_norm = 8.70683 | nuclear_norm = 2248.48560
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 111.14360 | spectral_norm = 9.81569 | nuclear_norm = 2474.84521
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 115.46535 | spectral_norm = 9.20072 | nuclear_norm = 2658.02832
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 235.72583 | spectral_norm = 16.49085 | nuclear_norm = 6284.87549
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 110.27393 | spectral_norm = 10.04563 | nuclear_norm = 2909.23486
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 100.22929 | spectral_norm = 9.70206 | nuclear_norm = 2290.00269
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 98.88906 | spectral_norm = 9.00806 | nuclear_norm = 2263.67188
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 117.22141 | spectral_norm = 12.26680 | nuclear_norm = 2574.02197
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 123.53120 | spectral_norm = 9.89662 | nuclear_norm = 2897.54736
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 227.45209 | spectral_norm = 16.41572 | nuclear_norm = 6067.91895
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 111.11916 | spectral_norm = 10.22774 | nuclear_norm = 2933.36621
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 100.07156 | spectral_norm = 8.99243 | nuclear_norm = 2276.04541
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 99.60762 | spectral_norm = 8.95251 | nuclear_norm = 2273.12061
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 122.84101 | spectral_norm = 11.85427 | nuclear_norm = 2709.95337
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 127.92529 | spectral_norm = 10.19421 | nuclear_norm = 2996.36133
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 224.87964 | spectral_norm = 17.04343 | nuclear_norm = 5990.47266
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 112.86130 | spectral_norm = 10.35552 | nuclear_norm = 2991.28809
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 102.82189 | spectral_norm = 9.60524 | nuclear_norm = 2354.10791
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 102.20597 | spectral_norm = 10.01412 | nuclear_norm = 2323.37842
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 127.77882 | spectral_norm = 11.96586 | nuclear_norm = 2855.89600
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 127.33717 | spectral_norm = 9.10956 | nuclear_norm = 2996.32007
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 222.80795 | spectral_norm = 16.98599 | nuclear_norm = 5935.78662
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 114.13642 | spectral_norm = 10.32403 | nuclear_norm = 3028.28467
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 99.84082 | spectral_norm = 10.53158 | nuclear_norm = 2279.33057
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 99.52719 | spectral_norm = 9.91725 | nuclear_norm = 2289.74268
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 120.68015 | spectral_norm = 11.41711 | nuclear_norm = 2654.76685
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 119.82580 | spectral_norm = 10.62136 | nuclear_norm = 2723.28223
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 229.03239 | spectral_norm = 17.72693 | nuclear_norm = 6097.56104
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 112.41705 | spectral_norm = 10.53830 | nuclear_norm = 2978.94604
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 101.98241 | spectral_norm = 10.70350 | nuclear_norm = 2313.58911
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 102.45229 | spectral_norm = 10.14203 | nuclear_norm = 2304.46362
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 99.14862 | spectral_norm = 8.17820 | nuclear_norm = 2283.53955
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 122.05592 | spectral_norm = 8.34305 | nuclear_norm = 2881.71094
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 232.95723 | spectral_norm = 16.54964 | nuclear_norm = 6218.91602
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 110.27465 | spectral_norm = 11.49171 | nuclear_norm = 2915.95044
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 104.01998 | spectral_norm = 11.18351 | nuclear_norm = 2372.17163
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 102.48392 | spectral_norm = 10.60274 | nuclear_norm = 2322.78711
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 121.17786 | spectral_norm = 11.26299 | nuclear_norm = 2750.87988
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 133.53714 | spectral_norm = 9.44073 | nuclear_norm = 3132.28027
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 229.26193 | spectral_norm = 16.65255 | nuclear_norm = 6111.72168
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 111.23974 | spectral_norm = 12.38221 | nuclear_norm = 2922.75830
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 806.20422 | spectral_norm = 169.16696 | nuclear_norm = 20623.95508
===========================================
step:501/1750 train_loss:3.7149 train_time:333983ms step_avg:680.21ms
step:502/1750 train_loss:3.6553 train_time:334673ms step_avg:680.23ms
step:503/1750 train_loss:3.7762 train_time:335365ms step_avg:680.25ms
step:504/1750 train_loss:3.6333 train_time:336060ms step_avg:680.28ms
step:505/1750 train_loss:4.0501 train_time:336751ms step_avg:680.31ms
step:506/1750 train_loss:3.7024 train_time:337447ms step_avg:680.34ms
step:507/1750 train_loss:3.7882 train_time:338143ms step_avg:680.37ms
step:508/1750 train_loss:3.9748 train_time:338838ms step_avg:680.40ms
step:509/1750 train_loss:3.6675 train_time:339531ms step_avg:680.42ms
step:510/1750 train_loss:3.7582 train_time:340224ms step_avg:680.45ms
step:511/1750 train_loss:3.7605 train_time:340922ms step_avg:680.48ms
step:512/1750 train_loss:3.5892 train_time:341616ms step_avg:680.51ms
step:513/1750 train_loss:3.5821 train_time:342313ms step_avg:680.54ms
step:514/1750 train_loss:3.8064 train_time:343006ms step_avg:680.57ms
step:515/1750 train_loss:3.9326 train_time:343702ms step_avg:680.60ms
step:516/1750 train_loss:3.8044 train_time:344397ms step_avg:680.63ms
step:517/1750 train_loss:3.6461 train_time:345093ms step_avg:680.66ms
step:518/1750 train_loss:3.8126 train_time:345787ms step_avg:680.68ms
step:519/1750 train_loss:3.5520 train_time:346479ms step_avg:680.71ms
step:520/1750 train_loss:3.8155 train_time:347190ms step_avg:680.76ms
step:521/1750 train_loss:3.6820 train_time:347900ms step_avg:680.82ms
step:522/1750 train_loss:3.5816 train_time:348609ms step_avg:680.88ms
step:523/1750 train_loss:3.8235 train_time:349319ms step_avg:680.93ms
step:524/1750 train_loss:3.6210 train_time:350028ms step_avg:680.99ms
step:525/1750 train_loss:3.6924 train_time:350734ms step_avg:681.04ms
step:526/1750 train_loss:3.7306 train_time:351451ms step_avg:681.11ms
step:527/1750 train_loss:3.9847 train_time:352157ms step_avg:681.15ms
step:528/1750 train_loss:3.7005 train_time:352864ms step_avg:681.20ms
step:529/1750 train_loss:3.6874 train_time:353570ms step_avg:681.25ms
step:530/1750 train_loss:3.6867 train_time:354278ms step_avg:681.30ms
step:531/1750 train_loss:3.8008 train_time:354987ms step_avg:681.36ms
step:532/1750 train_loss:3.7614 train_time:355700ms step_avg:681.42ms
step:533/1750 train_loss:3.7578 train_time:356406ms step_avg:681.47ms
step:534/1750 train_loss:3.8325 train_time:357112ms step_avg:681.51ms
step:535/1750 train_loss:3.7800 train_time:357829ms step_avg:681.58ms
step:536/1750 train_loss:3.6497 train_time:358538ms step_avg:681.63ms
step:537/1750 train_loss:3.7162 train_time:359247ms step_avg:681.68ms
step:538/1750 train_loss:3.6515 train_time:359955ms step_avg:681.73ms
step:539/1750 train_loss:3.6491 train_time:360667ms step_avg:681.79ms
step:540/1750 train_loss:3.7261 train_time:361385ms step_avg:681.86ms
step:541/1750 train_loss:3.6407 train_time:362092ms step_avg:681.91ms
step:542/1750 train_loss:3.6698 train_time:362804ms step_avg:681.96ms
step:543/1750 train_loss:3.7355 train_time:363515ms step_avg:682.02ms
step:544/1750 train_loss:3.7102 train_time:364223ms step_avg:682.07ms
step:545/1750 train_loss:3.7618 train_time:364931ms step_avg:682.11ms
step:546/1750 train_loss:3.7810 train_time:365637ms step_avg:682.16ms
step:547/1750 train_loss:3.6308 train_time:366348ms step_avg:682.21ms
step:548/1750 train_loss:3.8713 train_time:367059ms step_avg:682.27ms
step:549/1750 train_loss:3.2964 train_time:367770ms step_avg:682.32ms
step:550/1750 train_loss:3.7638 train_time:368486ms step_avg:682.38ms
step:551/1750 train_loss:3.7627 train_time:369192ms step_avg:682.42ms
step:552/1750 train_loss:3.6899 train_time:369899ms step_avg:682.47ms
step:553/1750 train_loss:3.7809 train_time:370615ms step_avg:682.53ms
step:554/1750 train_loss:3.7025 train_time:371324ms step_avg:682.58ms
step:555/1750 train_loss:3.6942 train_time:372034ms step_avg:682.63ms
step:556/1750 train_loss:3.8148 train_time:372743ms step_avg:682.68ms
step:557/1750 train_loss:3.7204 train_time:373453ms step_avg:682.73ms
step:558/1750 train_loss:3.6466 train_time:374163ms step_avg:682.78ms
step:559/1750 train_loss:3.7426 train_time:374869ms step_avg:682.82ms
step:560/1750 train_loss:3.6468 train_time:375576ms step_avg:682.86ms
step:561/1750 train_loss:3.6918 train_time:376284ms step_avg:682.91ms
step:562/1750 train_loss:3.6956 train_time:376991ms step_avg:682.95ms
step:563/1750 train_loss:3.5041 train_time:377699ms step_avg:683.00ms
step:564/1750 train_loss:3.7608 train_time:378406ms step_avg:683.04ms
step:565/1750 train_loss:3.6315 train_time:379116ms step_avg:683.09ms
step:566/1750 train_loss:3.6730 train_time:379831ms step_avg:683.15ms
step:567/1750 train_loss:3.7489 train_time:380539ms step_avg:683.19ms
step:568/1750 train_loss:3.6900 train_time:381248ms step_avg:683.24ms
step:569/1750 train_loss:4.0155 train_time:381955ms step_avg:683.28ms
step:570/1750 train_loss:3.7241 train_time:382868ms step_avg:683.69ms
step:571/1750 train_loss:3.6783 train_time:383585ms step_avg:683.75ms
step:572/1750 train_loss:3.7830 train_time:384293ms step_avg:683.80ms
step:573/1750 train_loss:3.7425 train_time:385004ms step_avg:683.84ms
step:574/1750 train_loss:3.7615 train_time:385713ms step_avg:683.89ms
step:575/1750 train_loss:3.8001 train_time:386436ms step_avg:683.96ms
step:576/1750 train_loss:3.7517 train_time:387146ms step_avg:684.00ms
step:577/1750 train_loss:3.7854 train_time:387856ms step_avg:684.05ms
step:578/1750 train_loss:3.7010 train_time:388562ms step_avg:684.09ms
step:579/1750 train_loss:3.6942 train_time:389270ms step_avg:684.13ms
step:580/1750 train_loss:3.6931 train_time:389979ms step_avg:684.17ms
step:581/1750 train_loss:3.6204 train_time:390689ms step_avg:684.22ms
step:582/1750 train_loss:3.6566 train_time:391398ms step_avg:684.26ms
step:583/1750 train_loss:3.8717 train_time:392106ms step_avg:684.30ms
step:584/1750 train_loss:3.6519 train_time:392812ms step_avg:684.34ms
step:585/1750 train_loss:3.6100 train_time:393517ms step_avg:684.38ms
step:586/1750 train_loss:3.8142 train_time:394220ms step_avg:684.41ms
step:587/1750 train_loss:3.5343 train_time:394926ms step_avg:684.45ms
step:588/1750 train_loss:3.6896 train_time:395627ms step_avg:684.48ms
step:589/1750 train_loss:3.6714 train_time:396331ms step_avg:684.51ms
step:590/1750 train_loss:4.0245 train_time:397044ms step_avg:684.56ms
step:591/1750 train_loss:3.8038 train_time:397748ms step_avg:684.59ms
step:592/1750 train_loss:3.5325 train_time:398451ms step_avg:684.62ms
step:593/1750 train_loss:3.5558 train_time:399158ms step_avg:684.66ms
step:594/1750 train_loss:3.5169 train_time:399866ms step_avg:684.70ms
step:595/1750 train_loss:3.5760 train_time:400574ms step_avg:684.74ms
step:596/1750 train_loss:3.9476 train_time:401284ms step_avg:684.78ms
step:597/1750 train_loss:3.6719 train_time:401993ms step_avg:684.83ms
step:598/1750 train_loss:3.6125 train_time:402696ms step_avg:684.86ms
step:599/1750 train_loss:3.6865 train_time:403399ms step_avg:684.89ms
step:600/1750 train_loss:3.4981 train_time:404105ms step_avg:684.92ms
step:601/1750 train_loss:3.6186 train_time:404812ms step_avg:684.96ms
step:602/1750 train_loss:3.6632 train_time:405517ms step_avg:685.00ms
step:603/1750 train_loss:3.6945 train_time:406223ms step_avg:685.03ms
step:604/1750 train_loss:3.8039 train_time:406932ms step_avg:685.07ms
step:605/1750 train_loss:3.6351 train_time:407636ms step_avg:685.10ms
step:606/1750 train_loss:3.6327 train_time:408345ms step_avg:685.14ms
step:607/1750 train_loss:3.6017 train_time:409062ms step_avg:685.20ms
step:608/1750 train_loss:3.8561 train_time:409764ms step_avg:685.22ms
step:609/1750 train_loss:3.6654 train_time:410471ms step_avg:685.26ms
step:610/1750 train_loss:3.6370 train_time:411172ms step_avg:685.29ms
step:611/1750 train_loss:3.7273 train_time:411878ms step_avg:685.32ms
step:612/1750 train_loss:3.6285 train_time:412586ms step_avg:685.36ms
step:613/1750 train_loss:3.5993 train_time:413291ms step_avg:685.39ms
step:614/1750 train_loss:3.7896 train_time:413999ms step_avg:685.43ms
step:615/1750 train_loss:3.7356 train_time:414702ms step_avg:685.46ms
step:616/1750 train_loss:3.7124 train_time:415404ms step_avg:685.49ms
step:617/1750 train_loss:3.6483 train_time:416108ms step_avg:685.51ms
step:618/1750 train_loss:3.5901 train_time:416812ms step_avg:685.55ms
step:619/1750 train_loss:3.7083 train_time:417514ms step_avg:685.57ms
step:620/1750 train_loss:3.5851 train_time:418222ms step_avg:685.61ms
step:621/1750 train_loss:3.6109 train_time:418930ms step_avg:685.65ms
step:622/1750 train_loss:3.9428 train_time:419636ms step_avg:685.68ms
step:623/1750 train_loss:3.5920 train_time:420343ms step_avg:685.71ms
step:624/1750 train_loss:3.6213 train_time:421046ms step_avg:685.74ms
step:625/1750 train_loss:3.7221 train_time:421752ms step_avg:685.78ms
step:625/1750 val_loss:3.6469 train_time:421763ms step_avg:685.79ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | frobenius_norm = 51625.08203 | spectral_norm = 9651.13574 | nuclear_norm = 1282381.37500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 120.87034 | spectral_norm = 17.16994 | nuclear_norm = 2805.82397
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 116.56287 | spectral_norm = 19.94157 | nuclear_norm = 2687.31250
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 152.79880 | spectral_norm = 9.92726 | nuclear_norm = 3629.78906
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 120.40525 | spectral_norm = 12.05876 | nuclear_norm = 2808.24121
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 247.43095 | spectral_norm = 19.22857 | nuclear_norm = 6576.04541
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 131.08809 | spectral_norm = 12.36013 | nuclear_norm = 3480.58350
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 119.33194 | spectral_norm = 11.41202 | nuclear_norm = 2765.99121
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 117.56107 | spectral_norm = 12.89752 | nuclear_norm = 2729.93555
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 122.47314 | spectral_norm = 10.19772 | nuclear_norm = 2823.06006
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 120.82573 | spectral_norm = 9.81116 | nuclear_norm = 2804.71875
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 256.35678 | spectral_norm = 17.15416 | nuclear_norm = 6845.98438
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 131.01248 | spectral_norm = 12.94977 | nuclear_norm = 3467.37061
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 119.98301 | spectral_norm = 11.35404 | nuclear_norm = 2774.96460
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 117.39343 | spectral_norm = 11.19410 | nuclear_norm = 2714.77295
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 141.06825 | spectral_norm = 12.36203 | nuclear_norm = 3198.62354
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 138.16150 | spectral_norm = 9.68903 | nuclear_norm = 3269.45703
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 251.30852 | spectral_norm = 18.44950 | nuclear_norm = 6712.37158
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 129.76814 | spectral_norm = 11.57227 | nuclear_norm = 3434.81836
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 118.37655 | spectral_norm = 11.89206 | nuclear_norm = 2712.96094
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 117.07372 | spectral_norm = 11.04373 | nuclear_norm = 2680.77222
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 136.02092 | spectral_norm = 12.22168 | nuclear_norm = 3052.14941
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 137.54675 | spectral_norm = 11.80575 | nuclear_norm = 3168.74561
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 259.59055 | spectral_norm = 20.12092 | nuclear_norm = 6927.28809
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 127.96486 | spectral_norm = 11.79968 | nuclear_norm = 3366.21240
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 116.30937 | spectral_norm = 12.22967 | nuclear_norm = 2666.53638
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 115.18495 | spectral_norm = 11.87153 | nuclear_norm = 2661.18994
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 129.26105 | spectral_norm = 11.34433 | nuclear_norm = 2845.05713
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 130.78677 | spectral_norm = 10.38448 | nuclear_norm = 2958.02051
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 259.72177 | spectral_norm = 21.06548 | nuclear_norm = 6908.73633
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 129.29015 | spectral_norm = 12.06057 | nuclear_norm = 3403.88525
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 114.59431 | spectral_norm = 11.01380 | nuclear_norm = 2561.22461
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 115.51874 | spectral_norm = 10.45710 | nuclear_norm = 2601.86646
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 130.79385 | spectral_norm = 11.78872 | nuclear_norm = 2909.76440
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 134.72816 | spectral_norm = 10.82061 | nuclear_norm = 3094.53467
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 276.14566 | spectral_norm = 20.35929 | nuclear_norm = 7358.44434
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 128.18262 | spectral_norm = 12.44688 | nuclear_norm = 3376.35474
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 116.86200 | spectral_norm = 11.42058 | nuclear_norm = 2656.25244
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 115.37004 | spectral_norm = 10.72942 | nuclear_norm = 2628.07275
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 138.04893 | spectral_norm = 14.40294 | nuclear_norm = 3037.04248
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 144.49619 | spectral_norm = 11.56259 | nuclear_norm = 3385.75732
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 267.44757 | spectral_norm = 19.90743 | nuclear_norm = 7134.67676
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 129.61031 | spectral_norm = 12.76655 | nuclear_norm = 3417.18945
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 116.79923 | spectral_norm = 10.76509 | nuclear_norm = 2639.12183
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 116.38367 | spectral_norm = 10.57472 | nuclear_norm = 2641.74341
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 145.00952 | spectral_norm = 13.76952 | nuclear_norm = 3201.25244
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 149.91095 | spectral_norm = 11.99970 | nuclear_norm = 3510.38086
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 262.75983 | spectral_norm = 20.62449 | nuclear_norm = 6996.88281
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 131.84543 | spectral_norm = 12.87895 | nuclear_norm = 3493.11621
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 120.21375 | spectral_norm = 11.59809 | nuclear_norm = 2735.08447
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 119.83739 | spectral_norm = 12.19163 | nuclear_norm = 2705.40088
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 150.26723 | spectral_norm = 14.63205 | nuclear_norm = 3342.26904
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 149.56285 | spectral_norm = 10.74415 | nuclear_norm = 3514.33081
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 260.87866 | spectral_norm = 20.53176 | nuclear_norm = 6947.12207
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 133.96907 | spectral_norm = 12.64504 | nuclear_norm = 3553.98315
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 116.47875 | spectral_norm = 12.72285 | nuclear_norm = 2642.86670
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 116.18105 | spectral_norm = 12.11823 | nuclear_norm = 2661.71436
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 143.84447 | spectral_norm = 13.61253 | nuclear_norm = 3160.39990
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 140.63707 | spectral_norm = 12.51765 | nuclear_norm = 3174.61133
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 267.19385 | spectral_norm = 21.29566 | nuclear_norm = 7109.43066
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 131.53333 | spectral_norm = 12.72634 | nuclear_norm = 3486.40576
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 119.09114 | spectral_norm = 13.08247 | nuclear_norm = 2681.50586
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 120.09436 | spectral_norm = 12.19451 | nuclear_norm = 2680.51660
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 116.12519 | spectral_norm = 9.96197 | nuclear_norm = 2673.98120
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 141.26010 | spectral_norm = 9.70988 | nuclear_norm = 3333.67603
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 277.01007 | spectral_norm = 19.65262 | nuclear_norm = 7393.64160
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 129.12279 | spectral_norm = 14.14473 | nuclear_norm = 3413.55615
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 121.88539 | spectral_norm = 13.61097 | nuclear_norm = 2761.33569
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 119.97310 | spectral_norm = 12.85271 | nuclear_norm = 2704.44434
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 144.52126 | spectral_norm = 13.72527 | nuclear_norm = 3278.09180
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 157.89844 | spectral_norm = 11.22351 | nuclear_norm = 3702.70947
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 270.23315 | spectral_norm = 20.36533 | nuclear_norm = 7197.88086
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 130.07457 | spectral_norm = 15.34833 | nuclear_norm = 3413.34326
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 911.61560 | spectral_norm = 174.01721 | nuclear_norm = 23498.71289
===========================================
step:626/1750 train_loss:3.7293 train_time:422449ms step_avg:685.79ms
step:627/1750 train_loss:3.7653 train_time:423150ms step_avg:685.82ms
step:628/1750 train_loss:3.7421 train_time:423853ms step_avg:685.85ms
step:629/1750 train_loss:3.7926 train_time:424553ms step_avg:685.87ms
step:630/1750 train_loss:3.6173 train_time:425256ms step_avg:685.90ms
step:631/1750 train_loss:3.7466 train_time:425955ms step_avg:685.92ms
step:632/1750 train_loss:3.7664 train_time:426660ms step_avg:685.95ms
step:633/1750 train_loss:3.6715 train_time:427363ms step_avg:685.98ms
step:634/1750 train_loss:3.6242 train_time:428067ms step_avg:686.00ms
step:635/1750 train_loss:3.7170 train_time:428772ms step_avg:686.04ms
step:636/1750 train_loss:3.9753 train_time:429472ms step_avg:686.06ms
step:637/1750 train_loss:3.5650 train_time:430175ms step_avg:686.08ms
step:638/1750 train_loss:3.3757 train_time:430875ms step_avg:686.11ms
step:639/1750 train_loss:3.6142 train_time:431580ms step_avg:686.14ms
step:640/1750 train_loss:3.6566 train_time:432285ms step_avg:686.17ms
step:641/1750 train_loss:3.5961 train_time:432988ms step_avg:686.19ms
step:642/1750 train_loss:3.6060 train_time:433691ms step_avg:686.22ms
step:643/1750 train_loss:3.6550 train_time:434395ms step_avg:686.25ms
step:644/1750 train_loss:3.6293 train_time:435103ms step_avg:686.28ms
step:645/1750 train_loss:3.5804 train_time:435803ms step_avg:686.30ms
step:646/1750 train_loss:3.8009 train_time:436506ms step_avg:686.33ms
step:647/1750 train_loss:3.7025 train_time:437212ms step_avg:686.36ms
step:648/1750 train_loss:3.6881 train_time:437916ms step_avg:686.39ms
step:649/1750 train_loss:3.7300 train_time:438627ms step_avg:686.43ms
step:650/1750 train_loss:3.7855 train_time:439340ms step_avg:686.47ms
step:651/1750 train_loss:3.6462 train_time:440066ms step_avg:686.53ms
step:652/1750 train_loss:3.7937 train_time:440784ms step_avg:686.58ms
step:653/1750 train_loss:3.6043 train_time:441499ms step_avg:686.62ms
step:654/1750 train_loss:3.6852 train_time:442210ms step_avg:686.66ms
step:655/1750 train_loss:3.4518 train_time:442927ms step_avg:686.71ms
step:656/1750 train_loss:3.6030 train_time:443638ms step_avg:686.75ms
step:657/1750 train_loss:3.5965 train_time:444356ms step_avg:686.79ms
step:658/1750 train_loss:3.5234 train_time:445078ms step_avg:686.85ms
step:659/1750 train_loss:3.7128 train_time:445807ms step_avg:686.91ms
step:660/1750 train_loss:3.6101 train_time:446529ms step_avg:686.97ms
step:661/1750 train_loss:3.7058 train_time:447243ms step_avg:687.01ms
step:662/1750 train_loss:3.7729 train_time:447961ms step_avg:687.06ms
step:663/1750 train_loss:3.6875 train_time:448675ms step_avg:687.10ms
step:664/1750 train_loss:3.5828 train_time:449387ms step_avg:687.14ms
step:665/1750 train_loss:3.6417 train_time:450106ms step_avg:687.18ms
step:666/1750 train_loss:3.5135 train_time:450824ms step_avg:687.23ms
step:667/1750 train_loss:3.8078 train_time:451537ms step_avg:687.27ms
step:668/1750 train_loss:3.6369 train_time:452265ms step_avg:687.33ms
step:669/1750 train_loss:3.6633 train_time:452982ms step_avg:687.38ms
step:670/1750 train_loss:3.5080 train_time:453707ms step_avg:687.43ms
step:671/1750 train_loss:3.6197 train_time:454426ms step_avg:687.48ms
step:672/1750 train_loss:3.5829 train_time:455145ms step_avg:687.53ms
step:673/1750 train_loss:3.5924 train_time:455866ms step_avg:687.58ms
step:674/1750 train_loss:3.8736 train_time:456584ms step_avg:687.63ms
step:675/1750 train_loss:3.6538 train_time:457305ms step_avg:687.68ms
step:676/1750 train_loss:3.7349 train_time:458027ms step_avg:687.73ms
step:677/1750 train_loss:3.5159 train_time:458743ms step_avg:687.77ms
step:678/1750 train_loss:3.6230 train_time:459458ms step_avg:687.81ms
step:679/1750 train_loss:3.5732 train_time:460173ms step_avg:687.85ms
step:680/1750 train_loss:3.7028 train_time:460895ms step_avg:687.90ms
step:681/1750 train_loss:3.6108 train_time:461625ms step_avg:687.97ms
step:682/1750 train_loss:3.6330 train_time:462340ms step_avg:688.01ms
step:683/1750 train_loss:3.6860 train_time:463059ms step_avg:688.05ms
step:684/1750 train_loss:3.7515 train_time:463779ms step_avg:688.10ms
step:685/1750 train_loss:3.6677 train_time:464511ms step_avg:688.16ms
step:686/1750 train_loss:3.7156 train_time:465227ms step_avg:688.21ms
step:687/1750 train_loss:3.6538 train_time:465949ms step_avg:688.26ms
step:688/1750 train_loss:3.6854 train_time:466669ms step_avg:688.30ms
step:689/1750 train_loss:3.2310 train_time:467406ms step_avg:688.37ms
step:690/1750 train_loss:3.4353 train_time:468123ms step_avg:688.42ms
step:691/1750 train_loss:3.5681 train_time:468842ms step_avg:688.46ms
step:692/1750 train_loss:3.4439 train_time:469559ms step_avg:688.50ms
step:693/1750 train_loss:3.6500 train_time:470276ms step_avg:688.54ms
step:694/1750 train_loss:3.6770 train_time:470990ms step_avg:688.58ms
step:695/1750 train_loss:3.5748 train_time:471708ms step_avg:688.62ms
step:696/1750 train_loss:3.5560 train_time:472420ms step_avg:688.66ms
step:697/1750 train_loss:3.8815 train_time:473144ms step_avg:688.71ms
step:698/1750 train_loss:3.6137 train_time:473860ms step_avg:688.75ms
step:699/1750 train_loss:3.6666 train_time:474576ms step_avg:688.79ms
step:700/1750 train_loss:3.7934 train_time:475298ms step_avg:688.84ms
step:701/1750 train_loss:3.5907 train_time:476010ms step_avg:688.87ms
step:702/1750 train_loss:3.5730 train_time:476723ms step_avg:688.91ms
step:703/1750 train_loss:3.5393 train_time:477440ms step_avg:688.95ms
step:704/1750 train_loss:3.5190 train_time:478157ms step_avg:688.99ms
step:705/1750 train_loss:3.6021 train_time:478889ms step_avg:689.05ms
step:706/1750 train_loss:3.5910 train_time:479608ms step_avg:689.09ms
step:707/1750 train_loss:3.6030 train_time:480333ms step_avg:689.14ms
step:708/1750 train_loss:3.6683 train_time:481050ms step_avg:689.18ms
step:709/1750 train_loss:3.6252 train_time:481778ms step_avg:689.24ms
step:710/1750 train_loss:3.6010 train_time:482495ms step_avg:689.28ms
step:711/1750 train_loss:3.5663 train_time:483216ms step_avg:689.32ms
step:712/1750 train_loss:3.6178 train_time:483944ms step_avg:689.38ms
step:713/1750 train_loss:3.6733 train_time:484661ms step_avg:689.42ms
step:714/1750 train_loss:3.6705 train_time:485379ms step_avg:689.46ms
step:715/1750 train_loss:3.5826 train_time:486093ms step_avg:689.49ms
step:716/1750 train_loss:3.5937 train_time:486804ms step_avg:689.52ms
step:717/1750 train_loss:3.6102 train_time:487516ms step_avg:689.56ms
step:718/1750 train_loss:3.7325 train_time:488228ms step_avg:689.59ms
step:719/1750 train_loss:3.6195 train_time:488939ms step_avg:689.62ms
step:720/1750 train_loss:3.7046 train_time:489650ms step_avg:689.65ms
step:721/1750 train_loss:3.8827 train_time:490370ms step_avg:689.69ms
step:722/1750 train_loss:3.4888 train_time:491084ms step_avg:689.72ms
step:723/1750 train_loss:3.7553 train_time:491798ms step_avg:689.76ms
step:724/1750 train_loss:3.7929 train_time:492507ms step_avg:689.79ms
step:725/1750 train_loss:3.5903 train_time:493225ms step_avg:689.83ms
step:726/1750 train_loss:3.6725 train_time:493954ms step_avg:689.88ms
step:727/1750 train_loss:3.5609 train_time:494668ms step_avg:689.91ms
step:728/1750 train_loss:3.5985 train_time:495382ms step_avg:689.95ms
step:729/1750 train_loss:3.7605 train_time:496091ms step_avg:689.97ms
step:730/1750 train_loss:3.6935 train_time:496808ms step_avg:690.01ms
step:731/1750 train_loss:3.6988 train_time:497528ms step_avg:690.05ms
step:732/1750 train_loss:3.5876 train_time:498240ms step_avg:690.08ms
step:733/1750 train_loss:3.6223 train_time:498945ms step_avg:690.10ms
step:734/1750 train_loss:3.8590 train_time:499656ms step_avg:690.13ms
step:735/1750 train_loss:3.5831 train_time:500366ms step_avg:690.16ms
step:736/1750 train_loss:3.6359 train_time:501083ms step_avg:690.20ms
step:737/1750 train_loss:3.7656 train_time:501796ms step_avg:690.23ms
step:738/1750 train_loss:3.6976 train_time:502506ms step_avg:690.26ms
step:739/1750 train_loss:3.6222 train_time:503216ms step_avg:690.28ms
step:740/1750 train_loss:3.5264 train_time:503926ms step_avg:690.31ms
step:741/1750 train_loss:4.1334 train_time:504651ms step_avg:690.36ms
step:742/1750 train_loss:3.5185 train_time:505361ms step_avg:690.38ms
step:743/1750 train_loss:3.5849 train_time:506082ms step_avg:690.43ms
step:744/1750 train_loss:3.6006 train_time:506808ms step_avg:690.47ms
step:745/1750 train_loss:3.6728 train_time:507530ms step_avg:690.52ms
step:746/1750 train_loss:3.6088 train_time:508240ms step_avg:690.54ms
step:747/1750 train_loss:3.6209 train_time:508949ms step_avg:690.57ms
step:748/1750 train_loss:3.6749 train_time:509662ms step_avg:690.60ms
step:749/1750 train_loss:3.5887 train_time:510382ms step_avg:690.64ms
step:750/1750 train_loss:3.5864 train_time:511104ms step_avg:690.68ms
step:750/1750 val_loss:3.5919 train_time:511116ms step_avg:690.70ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | frobenius_norm = 55417.31641 | spectral_norm = 10163.31348 | nuclear_norm = 1381078.87500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 135.96016 | spectral_norm = 20.42144 | nuclear_norm = 3146.95410
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 130.57198 | spectral_norm = 23.55112 | nuclear_norm = 3003.33936
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 172.02745 | spectral_norm = 11.07994 | nuclear_norm = 4105.24268
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 134.10349 | spectral_norm = 13.97556 | nuclear_norm = 3121.96973
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 280.49042 | spectral_norm = 21.73321 | nuclear_norm = 7457.24512
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 148.29318 | spectral_norm = 14.62689 | nuclear_norm = 3935.74487
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 134.62439 | spectral_norm = 13.15036 | nuclear_norm = 3115.82593
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 132.52126 | spectral_norm = 14.25447 | nuclear_norm = 3072.27539
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 137.31270 | spectral_norm = 11.47980 | nuclear_norm = 3166.03809
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 135.35031 | spectral_norm = 11.02281 | nuclear_norm = 3141.12500
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 289.20969 | spectral_norm = 19.50987 | nuclear_norm = 7725.59766
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 147.55986 | spectral_norm = 15.25395 | nuclear_norm = 3902.80518
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 135.33005 | spectral_norm = 13.09113 | nuclear_norm = 3122.93115
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 132.22763 | spectral_norm = 12.81424 | nuclear_norm = 3050.04199
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 159.93867 | spectral_norm = 13.89840 | nuclear_norm = 3630.62134
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 156.27383 | spectral_norm = 10.99096 | nuclear_norm = 3700.69922
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 282.46445 | spectral_norm = 21.26878 | nuclear_norm = 7544.68115
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 145.18431 | spectral_norm = 13.38444 | nuclear_norm = 3840.05762
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 133.12488 | spectral_norm = 13.61369 | nuclear_norm = 3041.62549
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 131.74103 | spectral_norm = 12.57131 | nuclear_norm = 3006.01367
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 155.34273 | spectral_norm = 14.09053 | nuclear_norm = 3488.33105
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 155.91985 | spectral_norm = 13.60574 | nuclear_norm = 3591.37061
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 291.54303 | spectral_norm = 23.74826 | nuclear_norm = 7779.57178
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 143.51149 | spectral_norm = 13.65768 | nuclear_norm = 3771.28320
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 131.04909 | spectral_norm = 14.28828 | nuclear_norm = 2993.05347
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 129.80148 | spectral_norm = 13.44439 | nuclear_norm = 2992.57080
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 146.78876 | spectral_norm = 12.89826 | nuclear_norm = 3232.12451
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 147.99663 | spectral_norm = 11.70903 | nuclear_norm = 3352.86401
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 291.08978 | spectral_norm = 24.91078 | nuclear_norm = 7736.90625
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 145.03740 | spectral_norm = 14.01393 | nuclear_norm = 3812.68970
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 128.42783 | spectral_norm = 12.57771 | nuclear_norm = 2848.23535
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 129.71225 | spectral_norm = 12.00137 | nuclear_norm = 2902.22729
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 148.27795 | spectral_norm = 13.43610 | nuclear_norm = 3298.41309
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 151.89981 | spectral_norm = 12.15996 | nuclear_norm = 3484.67871
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 311.41852 | spectral_norm = 23.88256 | nuclear_norm = 8292.28223
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 143.65912 | spectral_norm = 14.59281 | nuclear_norm = 3779.22559
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 131.13892 | spectral_norm = 13.02818 | nuclear_norm = 2967.31494
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 129.60385 | spectral_norm = 12.27706 | nuclear_norm = 2939.85352
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 156.43065 | spectral_norm = 16.26967 | nuclear_norm = 3444.63794
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 162.76486 | spectral_norm = 13.09024 | nuclear_norm = 3808.21216
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 302.95483 | spectral_norm = 23.25517 | nuclear_norm = 8081.58105
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 145.72821 | spectral_norm = 15.02978 | nuclear_norm = 3837.38184
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 131.21710 | spectral_norm = 12.37224 | nuclear_norm = 2951.40088
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 130.82506 | spectral_norm = 12.00917 | nuclear_norm = 2957.02783
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 164.29343 | spectral_norm = 15.45891 | nuclear_norm = 3627.12842
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 168.89452 | spectral_norm = 13.37144 | nuclear_norm = 3953.54346
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 296.34512 | spectral_norm = 24.05839 | nuclear_norm = 7885.61719
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 148.30533 | spectral_norm = 15.17005 | nuclear_norm = 3926.76807
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 135.26772 | spectral_norm = 13.21211 | nuclear_norm = 3061.65527
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 135.01576 | spectral_norm = 14.11483 | nuclear_norm = 3031.11499
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 170.92958 | spectral_norm = 17.10823 | nuclear_norm = 3785.59058
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 169.36736 | spectral_norm = 12.36937 | nuclear_norm = 3976.18970
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 294.79614 | spectral_norm = 24.01188 | nuclear_norm = 7847.64258
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 151.32561 | spectral_norm = 14.71052 | nuclear_norm = 4013.30005
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 130.88460 | spectral_norm = 14.57004 | nuclear_norm = 2954.84668
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 130.70903 | spectral_norm = 14.07823 | nuclear_norm = 2982.95728
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 164.46817 | spectral_norm = 15.55102 | nuclear_norm = 3611.39600
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 159.24669 | spectral_norm = 14.16546 | nuclear_norm = 3580.42847
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 300.68268 | spectral_norm = 24.70323 | nuclear_norm = 7994.38184
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 148.36719 | spectral_norm = 14.64277 | nuclear_norm = 3933.00928
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 133.86832 | spectral_norm = 15.27927 | nuclear_norm = 2994.69873
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 135.14796 | spectral_norm = 14.01976 | nuclear_norm = 2996.67480
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 130.87564 | spectral_norm = 11.97341 | nuclear_norm = 3010.96411
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 158.31596 | spectral_norm = 10.87356 | nuclear_norm = 3735.37891
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 315.95877 | spectral_norm = 22.59798 | nuclear_norm = 8431.19531
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 145.74841 | spectral_norm = 16.65457 | nuclear_norm = 3852.73242
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 137.43390 | spectral_norm = 16.02934 | nuclear_norm = 3095.60767
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 135.02061 | spectral_norm = 15.07570 | nuclear_norm = 3028.09912
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 165.27779 | spectral_norm = 16.12812 | nuclear_norm = 3743.65869
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 179.70120 | spectral_norm = 12.72363 | nuclear_norm = 4214.09961
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 306.63754 | spectral_norm = 23.63484 | nuclear_norm = 8163.87207
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 146.74677 | spectral_norm = 18.04312 | nuclear_norm = 3848.29126
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1005.38074 | spectral_norm = 176.57426 | nuclear_norm = 26069.34961
===========================================
step:751/1750 train_loss:3.6339 train_time:511810ms step_avg:690.70ms
step:752/1750 train_loss:3.5876 train_time:512525ms step_avg:690.73ms
step:753/1750 train_loss:3.6365 train_time:513237ms step_avg:690.76ms
step:754/1750 train_loss:3.6410 train_time:513947ms step_avg:690.79ms
step:755/1750 train_loss:3.6189 train_time:514656ms step_avg:690.81ms
step:756/1750 train_loss:3.7059 train_time:515371ms step_avg:690.85ms
step:757/1750 train_loss:3.4855 train_time:516084ms step_avg:690.88ms
step:758/1750 train_loss:3.7448 train_time:516810ms step_avg:690.92ms
step:759/1750 train_loss:3.6751 train_time:517520ms step_avg:690.95ms
step:760/1750 train_loss:3.6168 train_time:518433ms step_avg:691.24ms
step:761/1750 train_loss:3.7227 train_time:519145ms step_avg:691.27ms
step:762/1750 train_loss:3.6376 train_time:520048ms step_avg:691.55ms
step:763/1750 train_loss:3.4708 train_time:520764ms step_avg:691.59ms
step:764/1750 train_loss:3.4611 train_time:521475ms step_avg:691.61ms
step:765/1750 train_loss:3.5650 train_time:522188ms step_avg:691.64ms
step:766/1750 train_loss:3.5718 train_time:522899ms step_avg:691.67ms
step:767/1750 train_loss:4.6129 train_time:523621ms step_avg:691.70ms
step:768/1750 train_loss:3.5694 train_time:524336ms step_avg:691.74ms
step:769/1750 train_loss:3.6234 train_time:525046ms step_avg:691.76ms
step:770/1750 train_loss:3.6976 train_time:525760ms step_avg:691.79ms
step:771/1750 train_loss:4.2051 train_time:526474ms step_avg:691.82ms
step:772/1750 train_loss:3.6180 train_time:527191ms step_avg:691.85ms
step:773/1750 train_loss:3.6248 train_time:527901ms step_avg:691.88ms
step:774/1750 train_loss:3.5889 train_time:528614ms step_avg:691.90ms
step:775/1750 train_loss:3.7220 train_time:529322ms step_avg:691.92ms
step:776/1750 train_loss:3.5139 train_time:530033ms step_avg:691.95ms
step:777/1750 train_loss:3.6423 train_time:530744ms step_avg:691.97ms
step:778/1750 train_loss:3.6407 train_time:531460ms step_avg:692.01ms
step:779/1750 train_loss:3.5997 train_time:532189ms step_avg:692.05ms
step:780/1750 train_loss:3.6026 train_time:532912ms step_avg:692.09ms
step:781/1750 train_loss:3.4999 train_time:533643ms step_avg:692.14ms
step:782/1750 train_loss:3.6552 train_time:534363ms step_avg:692.18ms
step:783/1750 train_loss:3.6012 train_time:535092ms step_avg:692.23ms
step:784/1750 train_loss:3.5588 train_time:535814ms step_avg:692.27ms
step:785/1750 train_loss:3.5678 train_time:536540ms step_avg:692.31ms
step:786/1750 train_loss:3.5943 train_time:537261ms step_avg:692.35ms
step:787/1750 train_loss:3.5417 train_time:537990ms step_avg:692.39ms
step:788/1750 train_loss:3.6075 train_time:538712ms step_avg:692.43ms
step:789/1750 train_loss:3.5688 train_time:539437ms step_avg:692.47ms
step:790/1750 train_loss:3.4977 train_time:540158ms step_avg:692.51ms
step:791/1750 train_loss:3.5536 train_time:540896ms step_avg:692.57ms
step:792/1750 train_loss:3.6215 train_time:541614ms step_avg:692.60ms
step:793/1750 train_loss:3.6255 train_time:542339ms step_avg:692.64ms
step:794/1750 train_loss:3.6620 train_time:543075ms step_avg:692.70ms
step:795/1750 train_loss:3.5926 train_time:543801ms step_avg:692.74ms
step:796/1750 train_loss:3.7061 train_time:544536ms step_avg:692.79ms
step:797/1750 train_loss:3.6010 train_time:545265ms step_avg:692.84ms
step:798/1750 train_loss:3.4154 train_time:545996ms step_avg:692.89ms
step:799/1750 train_loss:3.4927 train_time:546728ms step_avg:692.94ms
step:800/1750 train_loss:4.4107 train_time:547468ms step_avg:693.00ms
step:801/1750 train_loss:3.7213 train_time:548189ms step_avg:693.03ms
step:802/1750 train_loss:3.5715 train_time:548916ms step_avg:693.08ms
step:803/1750 train_loss:3.6186 train_time:549649ms step_avg:693.13ms
step:804/1750 train_loss:3.6082 train_time:550381ms step_avg:693.17ms
step:805/1750 train_loss:3.5516 train_time:551101ms step_avg:693.21ms
step:806/1750 train_loss:3.5526 train_time:551835ms step_avg:693.26ms
step:807/1750 train_loss:3.5818 train_time:552559ms step_avg:693.30ms
step:808/1750 train_loss:3.6491 train_time:553283ms step_avg:693.34ms
step:809/1750 train_loss:3.8615 train_time:554008ms step_avg:693.38ms
step:810/1750 train_loss:3.7055 train_time:554727ms step_avg:693.41ms
step:811/1750 train_loss:3.5108 train_time:555455ms step_avg:693.45ms
step:812/1750 train_loss:3.6288 train_time:556176ms step_avg:693.49ms
step:813/1750 train_loss:3.6420 train_time:556899ms step_avg:693.52ms
step:814/1750 train_loss:3.5886 train_time:557620ms step_avg:693.56ms
step:815/1750 train_loss:3.4391 train_time:558349ms step_avg:693.60ms
step:816/1750 train_loss:3.7814 train_time:559075ms step_avg:693.64ms
step:817/1750 train_loss:3.5987 train_time:559798ms step_avg:693.68ms
step:818/1750 train_loss:3.5650 train_time:560526ms step_avg:693.72ms
step:819/1750 train_loss:3.5692 train_time:561251ms step_avg:693.76ms
step:820/1750 train_loss:3.5527 train_time:561969ms step_avg:693.79ms
step:821/1750 train_loss:3.4410 train_time:562695ms step_avg:693.83ms
step:822/1750 train_loss:3.5671 train_time:563417ms step_avg:693.86ms
step:823/1750 train_loss:3.6616 train_time:564138ms step_avg:693.90ms
step:824/1750 train_loss:3.4036 train_time:564863ms step_avg:693.94ms
step:825/1750 train_loss:3.6152 train_time:565589ms step_avg:693.97ms
step:826/1750 train_loss:3.7071 train_time:566316ms step_avg:694.01ms
step:827/1750 train_loss:3.4636 train_time:567057ms step_avg:694.07ms
step:828/1750 train_loss:3.5233 train_time:567791ms step_avg:694.12ms
step:829/1750 train_loss:3.5309 train_time:568515ms step_avg:694.16ms
step:830/1750 train_loss:3.6313 train_time:569233ms step_avg:694.19ms
step:831/1750 train_loss:3.4717 train_time:569961ms step_avg:694.23ms
step:832/1750 train_loss:3.5997 train_time:570697ms step_avg:694.28ms
step:833/1750 train_loss:3.6275 train_time:571432ms step_avg:694.33ms
step:834/1750 train_loss:3.6375 train_time:572154ms step_avg:694.36ms
step:835/1750 train_loss:3.4819 train_time:572899ms step_avg:694.42ms
step:836/1750 train_loss:3.7070 train_time:573625ms step_avg:694.46ms
step:837/1750 train_loss:3.4903 train_time:574352ms step_avg:694.50ms
step:838/1750 train_loss:3.4070 train_time:575071ms step_avg:694.53ms
step:839/1750 train_loss:3.6426 train_time:575793ms step_avg:694.56ms
step:840/1750 train_loss:3.5651 train_time:576518ms step_avg:694.60ms
step:841/1750 train_loss:3.6525 train_time:577241ms step_avg:694.63ms
step:842/1750 train_loss:3.5341 train_time:577960ms step_avg:694.66ms
step:843/1750 train_loss:3.5860 train_time:578686ms step_avg:694.70ms
step:844/1750 train_loss:3.5516 train_time:579405ms step_avg:694.73ms
step:845/1750 train_loss:3.5675 train_time:580129ms step_avg:694.77ms
step:846/1750 train_loss:3.5775 train_time:580851ms step_avg:694.80ms
step:847/1750 train_loss:3.6148 train_time:581578ms step_avg:694.84ms
step:848/1750 train_loss:3.5597 train_time:582301ms step_avg:694.87ms
step:849/1750 train_loss:3.4010 train_time:583022ms step_avg:694.90ms
step:850/1750 train_loss:3.6070 train_time:583744ms step_avg:694.93ms
step:851/1750 train_loss:3.4967 train_time:584465ms step_avg:694.96ms
step:852/1750 train_loss:3.6100 train_time:585199ms step_avg:695.01ms
step:853/1750 train_loss:3.3844 train_time:585918ms step_avg:695.04ms
step:854/1750 train_loss:3.6873 train_time:586641ms step_avg:695.07ms
step:855/1750 train_loss:3.6104 train_time:587357ms step_avg:695.10ms
step:856/1750 train_loss:3.3879 train_time:588081ms step_avg:695.13ms
step:857/1750 train_loss:3.6874 train_time:588812ms step_avg:695.17ms
step:858/1750 train_loss:3.6826 train_time:589536ms step_avg:695.21ms
step:859/1750 train_loss:3.3981 train_time:590261ms step_avg:695.24ms
step:860/1750 train_loss:3.5762 train_time:590982ms step_avg:695.27ms
step:861/1750 train_loss:3.6400 train_time:591705ms step_avg:695.31ms
step:862/1750 train_loss:3.4447 train_time:592427ms step_avg:695.34ms
step:863/1750 train_loss:3.5206 train_time:593154ms step_avg:695.37ms
step:864/1750 train_loss:3.8241 train_time:593891ms step_avg:695.42ms
step:865/1750 train_loss:3.7675 train_time:594630ms step_avg:695.47ms
step:866/1750 train_loss:3.5832 train_time:595349ms step_avg:695.50ms
step:867/1750 train_loss:3.5370 train_time:596069ms step_avg:695.53ms
step:868/1750 train_loss:3.7297 train_time:596796ms step_avg:695.57ms
step:869/1750 train_loss:3.4634 train_time:597522ms step_avg:695.60ms
step:870/1750 train_loss:3.4201 train_time:598244ms step_avg:695.63ms
step:871/1750 train_loss:3.5928 train_time:598967ms step_avg:695.66ms
step:872/1750 train_loss:3.5438 train_time:599686ms step_avg:695.69ms
step:873/1750 train_loss:3.4921 train_time:600410ms step_avg:695.72ms
step:874/1750 train_loss:3.6302 train_time:601132ms step_avg:695.75ms
step:875/1750 train_loss:3.5368 train_time:601854ms step_avg:695.78ms
step:875/1750 val_loss:3.5438 train_time:601865ms step_avg:695.80ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | frobenius_norm = 58787.90625 | spectral_norm = 10632.33691 | nuclear_norm = 1469049.62500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 149.51965 | spectral_norm = 23.33519 | nuclear_norm = 3451.24854
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 143.48897 | spectral_norm = 27.07838 | nuclear_norm = 3294.13281
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 189.66673 | spectral_norm = 12.32834 | nuclear_norm = 4542.42285
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 146.55486 | spectral_norm = 15.72511 | nuclear_norm = 3406.21143
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 311.37491 | spectral_norm = 24.18510 | nuclear_norm = 8283.50098
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 163.65259 | spectral_norm = 16.75711 | nuclear_norm = 4341.28516
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 148.76605 | spectral_norm = 14.61699 | nuclear_norm = 3439.06299
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 146.35052 | spectral_norm = 15.47045 | nuclear_norm = 3389.66626
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 150.85109 | spectral_norm = 12.52421 | nuclear_norm = 3479.84521
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 148.58427 | spectral_norm = 12.10044 | nuclear_norm = 3446.60742
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 320.29834 | spectral_norm = 21.82590 | nuclear_norm = 8560.89453
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 162.60251 | spectral_norm = 17.32439 | nuclear_norm = 4298.45557
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 149.28857 | spectral_norm = 14.54820 | nuclear_norm = 3438.24512
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 145.87291 | spectral_norm = 14.32409 | nuclear_norm = 3359.13574
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 177.14957 | spectral_norm = 15.44790 | nuclear_norm = 4023.04224
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 172.67841 | spectral_norm = 12.23896 | nuclear_norm = 4092.33594
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 312.07980 | spectral_norm = 23.97685 | nuclear_norm = 8338.40430
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 159.04688 | spectral_norm = 14.94764 | nuclear_norm = 4204.04053
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 146.55115 | spectral_norm = 15.29653 | nuclear_norm = 3340.06396
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 145.13608 | spectral_norm = 13.87995 | nuclear_norm = 3303.34546
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 173.17697 | spectral_norm = 15.88444 | nuclear_norm = 3891.45093
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 172.81299 | spectral_norm = 15.22454 | nuclear_norm = 3979.70264
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 321.37305 | spectral_norm = 27.08732 | nuclear_norm = 8577.90137
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 157.77496 | spectral_norm = 15.39588 | nuclear_norm = 4142.80469
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 144.39157 | spectral_norm = 16.25143 | nuclear_norm = 3283.72510
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 143.01210 | spectral_norm = 15.15547 | nuclear_norm = 3289.50171
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 163.03572 | spectral_norm = 14.38951 | nuclear_norm = 3591.10107
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 163.96347 | spectral_norm = 13.03296 | nuclear_norm = 3719.79590
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 320.18112 | spectral_norm = 28.44053 | nuclear_norm = 8504.36719
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 159.29118 | spectral_norm = 15.81037 | nuclear_norm = 4182.89453
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 140.92770 | spectral_norm = 14.10438 | nuclear_norm = 3105.07373
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 142.47076 | spectral_norm = 13.36109 | nuclear_norm = 3170.59766
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 164.76538 | spectral_norm = 15.14663 | nuclear_norm = 3661.85962
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 167.95667 | spectral_norm = 13.55138 | nuclear_norm = 3848.56104
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 343.48819 | spectral_norm = 27.23684 | nuclear_norm = 9141.48340
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 157.76344 | spectral_norm = 16.53827 | nuclear_norm = 4147.15625
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 144.06595 | spectral_norm = 14.47538 | nuclear_norm = 3246.37646
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 142.73280 | spectral_norm = 13.78706 | nuclear_norm = 3227.04590
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 173.54059 | spectral_norm = 17.92611 | nuclear_norm = 3825.78174
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 179.50630 | spectral_norm = 14.52651 | nuclear_norm = 4195.12549
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 335.62415 | spectral_norm = 26.39966 | nuclear_norm = 8951.67969
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 160.24274 | spectral_norm = 17.12457 | nuclear_norm = 4215.11572
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 144.27223 | spectral_norm = 13.82860 | nuclear_norm = 3229.66455
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 143.95959 | spectral_norm = 13.32036 | nuclear_norm = 3241.55640
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 181.82538 | spectral_norm = 17.03359 | nuclear_norm = 4014.88599
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 186.09067 | spectral_norm = 14.75997 | nuclear_norm = 4355.02881
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 327.38293 | spectral_norm = 27.31219 | nuclear_norm = 8706.68164
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 163.00406 | spectral_norm = 17.26682 | nuclear_norm = 4313.59277
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 148.87219 | spectral_norm = 14.66057 | nuclear_norm = 3354.70117
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 148.68279 | spectral_norm = 15.88805 | nuclear_norm = 3320.98047
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 189.98267 | spectral_norm = 19.52975 | nuclear_norm = 4192.44141
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 187.70726 | spectral_norm = 13.78864 | nuclear_norm = 4403.22705
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 326.24200 | spectral_norm = 27.49106 | nuclear_norm = 8680.22266
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 167.00972 | spectral_norm = 16.63713 | nuclear_norm = 4428.12207
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 144.03601 | spectral_norm = 16.31577 | nuclear_norm = 3236.94824
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 143.89278 | spectral_norm = 15.83478 | nuclear_norm = 3273.31445
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 183.39627 | spectral_norm = 17.28362 | nuclear_norm = 4024.91333
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 176.51833 | spectral_norm = 15.67188 | nuclear_norm = 3956.69873
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 331.26770 | spectral_norm = 27.87396 | nuclear_norm = 8801.24414
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 163.56810 | spectral_norm = 16.52804 | nuclear_norm = 4336.07422
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 147.19214 | spectral_norm = 17.35115 | nuclear_norm = 3274.63208
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 148.96150 | spectral_norm = 15.71843 | nuclear_norm = 3284.05029
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 144.15906 | spectral_norm = 13.83542 | nuclear_norm = 3314.16284
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 174.06090 | spectral_norm = 11.91547 | nuclear_norm = 4108.00537
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 352.41074 | spectral_norm = 25.37452 | nuclear_norm = 9402.70020
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 160.76392 | spectral_norm = 19.08078 | nuclear_norm = 4249.79150
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 151.56746 | spectral_norm = 18.13330 | nuclear_norm = 3395.07324
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 148.94603 | spectral_norm = 17.05153 | nuclear_norm = 3326.83008
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 184.87956 | spectral_norm = 18.40748 | nuclear_norm = 4181.22705
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 199.75024 | spectral_norm = 14.13979 | nuclear_norm = 4683.49902
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 340.01138 | spectral_norm = 26.50527 | nuclear_norm = 9048.00000
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 161.89200 | spectral_norm = 20.59978 | nuclear_norm = 4243.02148
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1089.65869 | spectral_norm = 177.74753 | nuclear_norm = 28382.59570
===========================================
step:876/1750 train_loss:3.6425 train_time:602578ms step_avg:695.82ms
step:877/1750 train_loss:3.4424 train_time:603297ms step_avg:695.84ms
step:878/1750 train_loss:3.6470 train_time:604015ms step_avg:695.87ms
step:879/1750 train_loss:3.5156 train_time:604736ms step_avg:695.90ms
step:880/1750 train_loss:3.8773 train_time:605456ms step_avg:695.93ms
step:881/1750 train_loss:3.5834 train_time:606176ms step_avg:695.95ms
step:882/1750 train_loss:3.4021 train_time:606890ms step_avg:695.97ms
step:883/1750 train_loss:3.7315 train_time:607611ms step_avg:696.00ms
step:884/1750 train_loss:3.4363 train_time:608334ms step_avg:696.03ms
step:885/1750 train_loss:3.6905 train_time:609051ms step_avg:696.06ms
step:886/1750 train_loss:3.5610 train_time:609784ms step_avg:696.10ms
step:887/1750 train_loss:3.6275 train_time:610515ms step_avg:696.14ms
step:888/1750 train_loss:3.5991 train_time:611237ms step_avg:696.17ms
step:889/1750 train_loss:3.6295 train_time:611961ms step_avg:696.20ms
step:890/1750 train_loss:3.5949 train_time:612697ms step_avg:696.25ms
step:891/1750 train_loss:3.4342 train_time:613413ms step_avg:696.27ms
step:892/1750 train_loss:3.6211 train_time:614137ms step_avg:696.30ms
step:893/1750 train_loss:3.5278 train_time:614862ms step_avg:696.33ms
step:894/1750 train_loss:3.5883 train_time:615579ms step_avg:696.36ms
step:895/1750 train_loss:3.4155 train_time:616300ms step_avg:696.38ms
step:896/1750 train_loss:3.3186 train_time:617030ms step_avg:696.42ms
step:897/1750 train_loss:3.4832 train_time:617755ms step_avg:696.45ms
step:898/1750 train_loss:3.6755 train_time:618482ms step_avg:696.49ms
step:899/1750 train_loss:3.5340 train_time:619203ms step_avg:696.52ms
step:900/1750 train_loss:3.5921 train_time:619928ms step_avg:696.55ms
step:901/1750 train_loss:3.7488 train_time:620648ms step_avg:696.57ms
step:902/1750 train_loss:3.5241 train_time:621371ms step_avg:696.60ms
step:903/1750 train_loss:3.4701 train_time:622089ms step_avg:696.63ms
step:904/1750 train_loss:3.6944 train_time:622824ms step_avg:696.67ms
step:905/1750 train_loss:3.6400 train_time:623544ms step_avg:696.70ms
step:906/1750 train_loss:3.4965 train_time:624268ms step_avg:696.73ms
step:907/1750 train_loss:3.4972 train_time:624986ms step_avg:696.75ms
step:908/1750 train_loss:3.7928 train_time:625722ms step_avg:696.80ms
step:909/1750 train_loss:3.5049 train_time:626455ms step_avg:696.83ms
step:910/1750 train_loss:3.6888 train_time:627186ms step_avg:696.87ms
step:911/1750 train_loss:3.8861 train_time:627934ms step_avg:696.93ms
step:912/1750 train_loss:3.3386 train_time:628663ms step_avg:696.97ms
step:913/1750 train_loss:3.6567 train_time:629393ms step_avg:697.00ms
step:914/1750 train_loss:3.5175 train_time:630137ms step_avg:697.05ms
step:915/1750 train_loss:3.5931 train_time:630880ms step_avg:697.10ms
step:916/1750 train_loss:3.7363 train_time:631621ms step_avg:697.15ms
step:917/1750 train_loss:3.5051 train_time:632354ms step_avg:697.19ms
step:918/1750 train_loss:3.4892 train_time:633099ms step_avg:697.25ms
step:919/1750 train_loss:3.5749 train_time:633831ms step_avg:697.28ms
step:920/1750 train_loss:3.4662 train_time:634575ms step_avg:697.34ms
step:921/1750 train_loss:3.5251 train_time:635320ms step_avg:697.39ms
step:922/1750 train_loss:3.4816 train_time:636050ms step_avg:697.42ms
step:923/1750 train_loss:3.6428 train_time:636779ms step_avg:697.46ms
step:924/1750 train_loss:3.5027 train_time:637504ms step_avg:697.49ms
step:925/1750 train_loss:3.4957 train_time:638235ms step_avg:697.52ms
step:926/1750 train_loss:3.6161 train_time:638980ms step_avg:697.58ms
step:927/1750 train_loss:3.4843 train_time:639711ms step_avg:697.61ms
step:928/1750 train_loss:3.6793 train_time:640452ms step_avg:697.66ms
step:929/1750 train_loss:3.5496 train_time:641176ms step_avg:697.69ms
step:930/1750 train_loss:3.3953 train_time:641914ms step_avg:697.73ms
step:931/1750 train_loss:3.7212 train_time:642643ms step_avg:697.77ms
step:932/1750 train_loss:3.4080 train_time:643375ms step_avg:697.80ms
step:933/1750 train_loss:3.3678 train_time:644104ms step_avg:697.84ms
step:934/1750 train_loss:3.6015 train_time:644845ms step_avg:697.88ms
step:935/1750 train_loss:3.5636 train_time:645572ms step_avg:697.92ms
step:936/1750 train_loss:3.4104 train_time:646329ms step_avg:697.98ms
step:937/1750 train_loss:3.3646 train_time:647067ms step_avg:698.02ms
step:938/1750 train_loss:3.5247 train_time:647796ms step_avg:698.06ms
step:939/1750 train_loss:3.3363 train_time:648526ms step_avg:698.09ms
step:940/1750 train_loss:3.6045 train_time:649251ms step_avg:698.12ms
step:941/1750 train_loss:3.4522 train_time:649997ms step_avg:698.17ms
step:942/1750 train_loss:3.4432 train_time:650737ms step_avg:698.22ms
step:943/1750 train_loss:3.5691 train_time:651479ms step_avg:698.26ms
step:944/1750 train_loss:3.4624 train_time:652208ms step_avg:698.30ms
step:945/1750 train_loss:3.4670 train_time:652941ms step_avg:698.33ms
step:946/1750 train_loss:3.6398 train_time:653684ms step_avg:698.38ms
step:947/1750 train_loss:3.5425 train_time:654417ms step_avg:698.42ms
step:948/1750 train_loss:3.6157 train_time:655159ms step_avg:698.46ms
step:949/1750 train_loss:3.7738 train_time:655901ms step_avg:698.51ms
step:950/1750 train_loss:3.4070 train_time:656829ms step_avg:698.75ms
step:951/1750 train_loss:3.4740 train_time:657555ms step_avg:698.78ms
step:952/1750 train_loss:3.7308 train_time:658294ms step_avg:698.83ms
step:953/1750 train_loss:3.4355 train_time:659018ms step_avg:698.85ms
step:954/1750 train_loss:3.4999 train_time:659762ms step_avg:698.90ms
step:955/1750 train_loss:3.5958 train_time:660510ms step_avg:698.95ms
step:956/1750 train_loss:3.4660 train_time:661245ms step_avg:698.99ms
step:957/1750 train_loss:3.5033 train_time:661967ms step_avg:699.01ms
step:958/1750 train_loss:3.4691 train_time:662718ms step_avg:699.07ms
step:959/1750 train_loss:3.5210 train_time:663461ms step_avg:699.12ms
step:960/1750 train_loss:3.5308 train_time:664196ms step_avg:699.15ms
step:961/1750 train_loss:3.5417 train_time:664930ms step_avg:699.19ms
step:962/1750 train_loss:3.4269 train_time:665680ms step_avg:699.24ms
step:963/1750 train_loss:3.6802 train_time:666418ms step_avg:699.28ms
step:964/1750 train_loss:3.6297 train_time:667142ms step_avg:699.31ms
step:965/1750 train_loss:3.5164 train_time:667877ms step_avg:699.35ms
step:966/1750 train_loss:3.4554 train_time:668616ms step_avg:699.39ms
step:967/1750 train_loss:3.5021 train_time:669341ms step_avg:699.42ms
step:968/1750 train_loss:3.7456 train_time:670074ms step_avg:699.45ms
step:969/1750 train_loss:3.5503 train_time:670802ms step_avg:699.48ms
step:970/1750 train_loss:3.5512 train_time:671527ms step_avg:699.51ms
step:971/1750 train_loss:3.6099 train_time:672269ms step_avg:699.55ms
step:972/1750 train_loss:3.4010 train_time:672999ms step_avg:699.58ms
step:973/1750 train_loss:3.5666 train_time:673734ms step_avg:699.62ms
step:974/1750 train_loss:3.5210 train_time:674460ms step_avg:699.65ms
step:975/1750 train_loss:3.5701 train_time:675193ms step_avg:699.68ms
step:976/1750 train_loss:3.6190 train_time:675920ms step_avg:699.71ms
step:977/1750 train_loss:3.5017 train_time:676649ms step_avg:699.74ms
step:978/1750 train_loss:3.6995 train_time:677374ms step_avg:699.77ms
step:979/1750 train_loss:3.6047 train_time:678099ms step_avg:699.79ms
step:980/1750 train_loss:3.3912 train_time:678826ms step_avg:699.82ms
step:981/1750 train_loss:3.6616 train_time:679552ms step_avg:699.85ms
step:982/1750 train_loss:3.4470 train_time:680277ms step_avg:699.87ms
step:983/1750 train_loss:3.6046 train_time:680998ms step_avg:699.90ms
step:984/1750 train_loss:3.5761 train_time:681731ms step_avg:699.93ms
step:985/1750 train_loss:3.5562 train_time:682470ms step_avg:699.97ms
step:986/1750 train_loss:3.5281 train_time:683202ms step_avg:700.00ms
step:987/1750 train_loss:3.6066 train_time:683936ms step_avg:700.04ms
step:988/1750 train_loss:3.4518 train_time:684658ms step_avg:700.06ms
step:989/1750 train_loss:3.5211 train_time:685383ms step_avg:700.08ms
step:990/1750 train_loss:3.5227 train_time:686109ms step_avg:700.11ms
step:991/1750 train_loss:3.4509 train_time:686846ms step_avg:700.15ms
step:992/1750 train_loss:3.6931 train_time:687590ms step_avg:700.19ms
step:993/1750 train_loss:3.5053 train_time:688312ms step_avg:700.22ms
step:994/1750 train_loss:3.4693 train_time:689041ms step_avg:700.24ms
step:995/1750 train_loss:3.5409 train_time:689790ms step_avg:700.29ms
step:996/1750 train_loss:3.6266 train_time:690514ms step_avg:700.32ms
step:997/1750 train_loss:3.5730 train_time:691239ms step_avg:700.34ms
step:998/1750 train_loss:3.4930 train_time:691964ms step_avg:700.37ms
step:999/1750 train_loss:3.8104 train_time:692686ms step_avg:700.39ms
step:1000/1750 train_loss:3.4788 train_time:693411ms step_avg:700.42ms
step:1000/1750 val_loss:3.5050 train_time:693423ms step_avg:700.43ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | frobenius_norm = 61828.20703 | spectral_norm = 11076.97656 | nuclear_norm = 1548639.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 161.82910 | spectral_norm = 26.11760 | nuclear_norm = 3727.79443
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 155.29039 | spectral_norm = 30.46067 | nuclear_norm = 3557.32275
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 205.71071 | spectral_norm = 13.41532 | nuclear_norm = 4945.18848
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 157.63472 | spectral_norm = 17.46206 | nuclear_norm = 3659.70996
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 338.67612 | spectral_norm = 26.31721 | nuclear_norm = 9013.33984
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 177.93611 | spectral_norm = 18.78278 | nuclear_norm = 4719.12793
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 161.73909 | spectral_norm = 16.05284 | nuclear_norm = 3736.00000
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 159.13226 | spectral_norm = 16.45222 | nuclear_norm = 3683.28467
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 162.75517 | spectral_norm = 13.63460 | nuclear_norm = 3755.96899
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 160.26775 | spectral_norm = 13.01941 | nuclear_norm = 3715.91357
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 348.50970 | spectral_norm = 24.16897 | nuclear_norm = 9318.11230
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 176.45566 | spectral_norm = 19.32897 | nuclear_norm = 4663.19531
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 161.86577 | spectral_norm = 16.01944 | nuclear_norm = 3722.60840
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 158.35373 | spectral_norm = 15.76249 | nuclear_norm = 3643.86475
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 192.65703 | spectral_norm = 16.90410 | nuclear_norm = 4376.90527
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 187.30640 | spectral_norm = 13.26947 | nuclear_norm = 4443.98633
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 338.62790 | spectral_norm = 26.46042 | nuclear_norm = 9048.37500
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 171.73253 | spectral_norm = 16.43761 | nuclear_norm = 4536.97754
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 158.85262 | spectral_norm = 16.87824 | nuclear_norm = 3611.10571
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 157.59392 | spectral_norm = 15.12774 | nuclear_norm = 3580.76123
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 189.68655 | spectral_norm = 17.29237 | nuclear_norm = 4263.22168
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 188.45934 | spectral_norm = 16.62175 | nuclear_norm = 4340.27686
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 348.31760 | spectral_norm = 30.39561 | nuclear_norm = 9297.54688
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 170.87059 | spectral_norm = 16.96027 | nuclear_norm = 4483.45898
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 156.64842 | spectral_norm = 18.13947 | nuclear_norm = 3552.56934
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 155.28380 | spectral_norm = 16.63091 | nuclear_norm = 3564.54004
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 178.19933 | spectral_norm = 15.74934 | nuclear_norm = 3928.78174
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 178.88869 | spectral_norm = 14.27896 | nuclear_norm = 4065.29565
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 346.57339 | spectral_norm = 31.86034 | nuclear_norm = 9198.85938
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 172.42047 | spectral_norm = 17.41343 | nuclear_norm = 4522.62402
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 152.27795 | spectral_norm = 15.39198 | nuclear_norm = 3337.89575
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 154.09346 | spectral_norm = 14.75331 | nuclear_norm = 3411.29272
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 180.14256 | spectral_norm = 16.63415 | nuclear_norm = 4001.18115
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 182.94060 | spectral_norm = 14.96257 | nuclear_norm = 4192.12598
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 372.65143 | spectral_norm = 30.56286 | nuclear_norm = 9911.22461
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 170.64726 | spectral_norm = 18.34770 | nuclear_norm = 4482.25293
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 155.78278 | spectral_norm = 15.87663 | nuclear_norm = 3500.83398
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 154.43222 | spectral_norm = 15.19205 | nuclear_norm = 3483.55859
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 189.32372 | spectral_norm = 19.48494 | nuclear_norm = 4179.34375
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 194.90320 | spectral_norm = 15.79273 | nuclear_norm = 4552.37695
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 365.54056 | spectral_norm = 29.34874 | nuclear_norm = 9748.41406
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 173.64117 | spectral_norm = 19.08390 | nuclear_norm = 4563.79492
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 156.22125 | spectral_norm = 15.12675 | nuclear_norm = 3485.49316
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 156.02464 | spectral_norm = 14.54990 | nuclear_norm = 3502.52148
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 197.80249 | spectral_norm = 18.62671 | nuclear_norm = 4370.01855
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 201.67758 | spectral_norm = 15.91775 | nuclear_norm = 4719.70117
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 356.23926 | spectral_norm = 30.38992 | nuclear_norm = 9468.94727
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 176.52679 | spectral_norm = 19.19580 | nuclear_norm = 4668.98438
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 161.28323 | spectral_norm = 16.15058 | nuclear_norm = 3620.47852
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 161.13396 | spectral_norm = 17.50833 | nuclear_norm = 3583.59814
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 207.78920 | spectral_norm = 21.72900 | nuclear_norm = 4568.89258
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 204.73116 | spectral_norm = 15.07372 | nuclear_norm = 4800.49072
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 355.21027 | spectral_norm = 30.90202 | nuclear_norm = 9446.03418
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 181.36646 | spectral_norm = 18.43946 | nuclear_norm = 4807.31641
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 156.19096 | spectral_norm = 17.92363 | nuclear_norm = 3498.50684
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 156.10127 | spectral_norm = 17.47907 | nuclear_norm = 3542.35083
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 201.03735 | spectral_norm = 18.90894 | nuclear_norm = 4412.41357
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 192.73285 | spectral_norm = 17.09519 | nuclear_norm = 4311.79785
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 359.53522 | spectral_norm = 30.98520 | nuclear_norm = 9543.80176
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 177.46468 | spectral_norm = 18.23704 | nuclear_norm = 4703.76123
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 159.52071 | spectral_norm = 19.19939 | nuclear_norm = 3532.43408
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 161.35588 | spectral_norm = 17.29028 | nuclear_norm = 3540.15137
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 156.07278 | spectral_norm = 15.67315 | nuclear_norm = 3583.93066
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 188.28708 | spectral_norm = 12.91650 | nuclear_norm = 4443.79199
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 385.69577 | spectral_norm = 27.99764 | nuclear_norm = 10288.15137
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 174.58423 | spectral_norm = 21.31905 | nuclear_norm = 4615.15234
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 164.31100 | spectral_norm = 20.20757 | nuclear_norm = 3660.99805
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 161.35759 | spectral_norm = 18.94057 | nuclear_norm = 3586.67212
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 202.95148 | spectral_norm = 20.57604 | nuclear_norm = 4584.59229
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 218.77800 | spectral_norm = 15.46734 | nuclear_norm = 5127.61035
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 370.15454 | spectral_norm = 29.23478 | nuclear_norm = 9844.95703
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 175.71268 | spectral_norm = 23.09634 | nuclear_norm = 4602.14355
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1167.33093 | spectral_norm = 178.02061 | nuclear_norm = 30515.57422
===========================================
step:1001/1750 train_loss:3.6242 train_time:694128ms step_avg:700.43ms
step:1002/1750 train_loss:3.4834 train_time:694846ms step_avg:700.45ms
step:1003/1750 train_loss:3.5390 train_time:695567ms step_avg:700.47ms
step:1004/1750 train_loss:3.4160 train_time:696301ms step_avg:700.50ms
step:1005/1750 train_loss:3.5966 train_time:697039ms step_avg:700.54ms
step:1006/1750 train_loss:3.6481 train_time:697778ms step_avg:700.58ms
step:1007/1750 train_loss:3.4298 train_time:698503ms step_avg:700.60ms
step:1008/1750 train_loss:3.5040 train_time:699228ms step_avg:700.63ms
step:1009/1750 train_loss:3.4781 train_time:699952ms step_avg:700.65ms
step:1010/1750 train_loss:3.6065 train_time:700687ms step_avg:700.69ms
step:1011/1750 train_loss:3.7012 train_time:701430ms step_avg:700.73ms
step:1012/1750 train_loss:3.5933 train_time:702155ms step_avg:700.75ms
step:1013/1750 train_loss:3.5734 train_time:702876ms step_avg:700.77ms
step:1014/1750 train_loss:3.4315 train_time:703613ms step_avg:700.81ms
step:1015/1750 train_loss:3.5761 train_time:704336ms step_avg:700.83ms
step:1016/1750 train_loss:3.6695 train_time:705060ms step_avg:700.85ms
step:1017/1750 train_loss:3.3685 train_time:705795ms step_avg:700.89ms
step:1018/1750 train_loss:3.4519 train_time:706534ms step_avg:700.93ms
step:1019/1750 train_loss:3.4421 train_time:707272ms step_avg:700.96ms
step:1020/1750 train_loss:3.4304 train_time:707992ms step_avg:700.98ms
step:1021/1750 train_loss:3.5667 train_time:708721ms step_avg:701.01ms
step:1022/1750 train_loss:3.4377 train_time:709452ms step_avg:701.04ms
step:1023/1750 train_loss:3.3844 train_time:710181ms step_avg:701.07ms
step:1024/1750 train_loss:3.5213 train_time:710909ms step_avg:701.09ms
step:1025/1750 train_loss:3.5466 train_time:711647ms step_avg:701.13ms
step:1026/1750 train_loss:3.5188 train_time:712386ms step_avg:701.17ms
step:1027/1750 train_loss:3.5207 train_time:713121ms step_avg:701.20ms
step:1028/1750 train_loss:3.6754 train_time:713843ms step_avg:701.22ms
step:1029/1750 train_loss:3.3691 train_time:714579ms step_avg:701.25ms
step:1030/1750 train_loss:3.4401 train_time:715332ms step_avg:701.31ms
step:1031/1750 train_loss:3.3650 train_time:716072ms step_avg:701.34ms
step:1032/1750 train_loss:3.5735 train_time:716793ms step_avg:701.36ms
step:1033/1750 train_loss:3.5626 train_time:717518ms step_avg:701.39ms
step:1034/1750 train_loss:3.7402 train_time:718251ms step_avg:701.42ms
step:1035/1750 train_loss:3.5329 train_time:718985ms step_avg:701.45ms
step:1036/1750 train_loss:3.4670 train_time:719724ms step_avg:701.49ms
step:1037/1750 train_loss:3.4856 train_time:720454ms step_avg:701.51ms
step:1038/1750 train_loss:3.5334 train_time:721184ms step_avg:701.54ms
step:1039/1750 train_loss:3.8384 train_time:721923ms step_avg:701.58ms
step:1040/1750 train_loss:3.6637 train_time:722661ms step_avg:701.61ms
step:1041/1750 train_loss:3.5560 train_time:723399ms step_avg:701.65ms
step:1042/1750 train_loss:3.4568 train_time:724136ms step_avg:701.68ms
step:1043/1750 train_loss:3.5310 train_time:724884ms step_avg:701.73ms
step:1044/1750 train_loss:3.5713 train_time:725632ms step_avg:701.77ms
step:1045/1750 train_loss:3.4874 train_time:726360ms step_avg:701.80ms
step:1046/1750 train_loss:3.5008 train_time:727097ms step_avg:701.83ms
step:1047/1750 train_loss:3.5672 train_time:727843ms step_avg:701.87ms
step:1048/1750 train_loss:3.4737 train_time:728586ms step_avg:701.91ms
step:1049/1750 train_loss:3.6869 train_time:729326ms step_avg:701.95ms
step:1050/1750 train_loss:3.5521 train_time:730073ms step_avg:701.99ms
step:1051/1750 train_loss:3.4521 train_time:730808ms step_avg:702.03ms
step:1052/1750 train_loss:3.4393 train_time:731550ms step_avg:702.06ms
step:1053/1750 train_loss:3.5476 train_time:732289ms step_avg:702.10ms
step:1054/1750 train_loss:3.3994 train_time:733026ms step_avg:702.13ms
step:1055/1750 train_loss:3.7401 train_time:733755ms step_avg:702.16ms
step:1056/1750 train_loss:3.5900 train_time:734496ms step_avg:702.20ms
step:1057/1750 train_loss:3.4306 train_time:735233ms step_avg:702.23ms
step:1058/1750 train_loss:3.5511 train_time:735973ms step_avg:702.26ms
step:1059/1750 train_loss:3.6347 train_time:736703ms step_avg:702.29ms
step:1060/1750 train_loss:3.3520 train_time:737456ms step_avg:702.34ms
step:1061/1750 train_loss:3.4153 train_time:738211ms step_avg:702.39ms
step:1062/1750 train_loss:3.4923 train_time:738945ms step_avg:702.42ms
step:1063/1750 train_loss:3.4650 train_time:739680ms step_avg:702.45ms
step:1064/1750 train_loss:3.4348 train_time:740413ms step_avg:702.48ms
step:1065/1750 train_loss:3.5202 train_time:741148ms step_avg:702.51ms
step:1066/1750 train_loss:3.4342 train_time:741879ms step_avg:702.54ms
step:1067/1750 train_loss:3.4115 train_time:742618ms step_avg:702.57ms
step:1068/1750 train_loss:3.4615 train_time:743362ms step_avg:702.61ms
step:1069/1750 train_loss:3.3420 train_time:744110ms step_avg:702.65ms
step:1070/1750 train_loss:3.4820 train_time:744839ms step_avg:702.68ms
step:1071/1750 train_loss:3.3596 train_time:745589ms step_avg:702.72ms
step:1072/1750 train_loss:3.6216 train_time:746319ms step_avg:702.75ms
step:1073/1750 train_loss:3.5628 train_time:747079ms step_avg:702.80ms
step:1074/1750 train_loss:3.4928 train_time:747811ms step_avg:702.83ms
step:1075/1750 train_loss:3.5728 train_time:748540ms step_avg:702.85ms
step:1076/1750 train_loss:3.4903 train_time:749288ms step_avg:702.90ms
step:1077/1750 train_loss:3.4545 train_time:750028ms step_avg:702.93ms
step:1078/1750 train_loss:3.8486 train_time:750758ms step_avg:702.96ms
step:1079/1750 train_loss:3.4898 train_time:751492ms step_avg:702.99ms
step:1080/1750 train_loss:3.1357 train_time:752260ms step_avg:703.05ms
step:1081/1750 train_loss:3.5851 train_time:752994ms step_avg:703.08ms
step:1082/1750 train_loss:3.4775 train_time:753736ms step_avg:703.11ms
step:1083/1750 train_loss:3.5663 train_time:754493ms step_avg:703.16ms
step:1084/1750 train_loss:3.6501 train_time:755232ms step_avg:703.20ms
step:1085/1750 train_loss:3.5605 train_time:755962ms step_avg:703.22ms
step:1086/1750 train_loss:3.5289 train_time:756700ms step_avg:703.25ms
step:1087/1750 train_loss:3.4920 train_time:757438ms step_avg:703.29ms
step:1088/1750 train_loss:3.6873 train_time:758190ms step_avg:703.33ms
step:1089/1750 train_loss:3.5713 train_time:758943ms step_avg:703.38ms
step:1090/1750 train_loss:3.4137 train_time:759674ms step_avg:703.40ms
step:1091/1750 train_loss:3.4370 train_time:760419ms step_avg:703.44ms
step:1092/1750 train_loss:3.5372 train_time:761160ms step_avg:703.48ms
step:1093/1750 train_loss:3.3456 train_time:761898ms step_avg:703.51ms
step:1094/1750 train_loss:3.5467 train_time:762625ms step_avg:703.53ms
step:1095/1750 train_loss:3.6683 train_time:763359ms step_avg:703.56ms
step:1096/1750 train_loss:3.5058 train_time:764108ms step_avg:703.60ms
step:1097/1750 train_loss:3.4744 train_time:764842ms step_avg:703.63ms
step:1098/1750 train_loss:3.4905 train_time:765588ms step_avg:703.67ms
step:1099/1750 train_loss:3.5507 train_time:766318ms step_avg:703.69ms
step:1100/1750 train_loss:3.6166 train_time:767075ms step_avg:703.74ms
step:1101/1750 train_loss:3.5846 train_time:767822ms step_avg:703.78ms
step:1102/1750 train_loss:3.4981 train_time:768564ms step_avg:703.81ms
step:1103/1750 train_loss:3.3507 train_time:769300ms step_avg:703.84ms
step:1104/1750 train_loss:3.3709 train_time:770043ms step_avg:703.88ms
step:1105/1750 train_loss:3.5101 train_time:770785ms step_avg:703.91ms
step:1106/1750 train_loss:3.3801 train_time:771518ms step_avg:703.94ms
step:1107/1750 train_loss:4.1292 train_time:772268ms step_avg:703.98ms
step:1108/1750 train_loss:3.2914 train_time:772999ms step_avg:704.01ms
step:1109/1750 train_loss:3.6228 train_time:773734ms step_avg:704.03ms
step:1110/1750 train_loss:3.4056 train_time:774466ms step_avg:704.06ms
step:1111/1750 train_loss:3.5670 train_time:775190ms step_avg:704.08ms
step:1112/1750 train_loss:3.4933 train_time:775922ms step_avg:704.10ms
step:1113/1750 train_loss:3.5461 train_time:776665ms step_avg:704.14ms
step:1114/1750 train_loss:3.6273 train_time:777398ms step_avg:704.17ms
step:1115/1750 train_loss:3.4974 train_time:778122ms step_avg:704.18ms
step:1116/1750 train_loss:3.4271 train_time:778858ms step_avg:704.21ms
step:1117/1750 train_loss:3.3096 train_time:779625ms step_avg:704.27ms
step:1118/1750 train_loss:3.4884 train_time:780346ms step_avg:704.28ms
step:1119/1750 train_loss:3.6591 train_time:781101ms step_avg:704.33ms
step:1120/1750 train_loss:3.6921 train_time:781829ms step_avg:704.35ms
step:1121/1750 train_loss:3.5428 train_time:782559ms step_avg:704.37ms
step:1122/1750 train_loss:3.5605 train_time:783292ms step_avg:704.40ms
step:1123/1750 train_loss:3.4510 train_time:784022ms step_avg:704.42ms
step:1124/1750 train_loss:3.5138 train_time:784743ms step_avg:704.44ms
step:1125/1750 train_loss:3.6517 train_time:785488ms step_avg:704.47ms
step:1125/1750 val_loss:3.4774 train_time:785500ms step_avg:704.48ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | frobenius_norm = 64607.65234 | spectral_norm = 11487.81836 | nuclear_norm = 1621738.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 173.39383 | spectral_norm = 28.65926 | nuclear_norm = 3988.93042
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 166.31638 | spectral_norm = 33.60688 | nuclear_norm = 3802.90430
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 219.97421 | spectral_norm = 14.56086 | nuclear_norm = 5304.98828
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 166.98071 | spectral_norm = 18.99786 | nuclear_norm = 3873.32715
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 364.48508 | spectral_norm = 28.35212 | nuclear_norm = 9704.12305
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 191.20395 | spectral_norm = 20.64455 | nuclear_norm = 5069.73438
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 173.85640 | spectral_norm = 17.52172 | nuclear_norm = 4012.28125
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 171.01971 | spectral_norm = 17.39898 | nuclear_norm = 3956.27051
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 173.58026 | spectral_norm = 14.43847 | nuclear_norm = 4005.41333
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 170.93291 | spectral_norm = 13.95523 | nuclear_norm = 3962.45947
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 375.32761 | spectral_norm = 26.41853 | nuclear_norm = 10038.41504
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 189.32452 | spectral_norm = 21.17655 | nuclear_norm = 5002.13477
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 173.74419 | spectral_norm = 17.26626 | nuclear_norm = 3993.75562
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 169.88855 | spectral_norm = 17.07843 | nuclear_norm = 3905.03149
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 206.77373 | spectral_norm = 18.26565 | nuclear_norm = 4697.38184
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 200.63652 | spectral_norm = 14.22937 | nuclear_norm = 4763.96973
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 363.59540 | spectral_norm = 28.99385 | nuclear_norm = 9717.02246
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 183.47072 | spectral_norm = 17.76467 | nuclear_norm = 4845.04541
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 170.12961 | spectral_norm = 18.24155 | nuclear_norm = 3858.52759
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 169.09908 | spectral_norm = 16.23092 | nuclear_norm = 3836.68188
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 205.01048 | spectral_norm = 18.73951 | nuclear_norm = 4607.81787
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 202.88135 | spectral_norm = 17.95441 | nuclear_norm = 4674.41992
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 373.38116 | spectral_norm = 33.23925 | nuclear_norm = 9967.84570
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 183.00577 | spectral_norm = 18.36855 | nuclear_norm = 4799.84766
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 168.02426 | spectral_norm = 19.91665 | nuclear_norm = 3800.38379
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 166.70085 | spectral_norm = 18.14936 | nuclear_norm = 3822.55615
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 192.48956 | spectral_norm = 17.05634 | nuclear_norm = 4247.60840
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 192.92361 | spectral_norm = 15.39371 | nuclear_norm = 4390.28809
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 371.08582 | spectral_norm = 35.11152 | nuclear_norm = 9842.74219
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 184.59564 | spectral_norm = 18.95909 | nuclear_norm = 4838.30811
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 162.80873 | spectral_norm = 16.69563 | nuclear_norm = 3554.23047
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 164.94348 | spectral_norm = 15.86332 | nuclear_norm = 3639.32349
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 194.78984 | spectral_norm = 18.10225 | nuclear_norm = 4324.25684
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 197.20309 | spectral_norm = 16.42834 | nuclear_norm = 4520.28027
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 399.69193 | spectral_norm = 33.66976 | nuclear_norm = 10624.31348
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 182.61362 | spectral_norm = 20.06135 | nuclear_norm = 4794.68945
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 166.85457 | spectral_norm = 17.12410 | nuclear_norm = 3740.45850
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 165.37767 | spectral_norm = 16.50014 | nuclear_norm = 3721.89600
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 204.07516 | spectral_norm = 20.85923 | nuclear_norm = 4510.55273
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 209.15752 | spectral_norm = 17.04471 | nuclear_norm = 4883.26611
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 393.33231 | spectral_norm = 32.06899 | nuclear_norm = 10488.01562
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 186.03204 | spectral_norm = 20.90983 | nuclear_norm = 4885.45508
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 167.31349 | spectral_norm = 16.46934 | nuclear_norm = 3721.71899
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 167.24672 | spectral_norm = 15.55944 | nuclear_norm = 3746.08667
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 212.55940 | spectral_norm = 19.94080 | nuclear_norm = 4698.57422
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 215.86189 | spectral_norm = 17.14859 | nuclear_norm = 5049.08350
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 383.04755 | spectral_norm = 33.43405 | nuclear_norm = 10175.26953
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 188.93839 | spectral_norm = 21.01632 | nuclear_norm = 4995.36133
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 172.94189 | spectral_norm = 17.43312 | nuclear_norm = 3868.74756
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 172.88593 | spectral_norm = 18.97577 | nuclear_norm = 3833.22705
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 224.10892 | spectral_norm = 23.70471 | nuclear_norm = 4915.96973
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 220.49326 | spectral_norm = 16.31743 | nuclear_norm = 5166.89795
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 382.30539 | spectral_norm = 34.18278 | nuclear_norm = 10161.09473
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 194.66832 | spectral_norm = 20.08307 | nuclear_norm = 5158.83301
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 167.57327 | spectral_norm = 19.43645 | nuclear_norm = 3743.05420
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 167.49950 | spectral_norm = 18.91165 | nuclear_norm = 3795.48340
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 217.32494 | spectral_norm = 20.38095 | nuclear_norm = 4771.31445
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 207.80626 | spectral_norm = 18.50978 | nuclear_norm = 4641.34717
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 385.92474 | spectral_norm = 33.95592 | nuclear_norm = 10236.72168
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 190.36847 | spectral_norm = 19.90308 | nuclear_norm = 5044.68164
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 170.89069 | spectral_norm = 20.96434 | nuclear_norm = 3768.73096
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 173.10434 | spectral_norm = 18.72191 | nuclear_norm = 3784.66748
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 167.33083 | spectral_norm = 17.30528 | nuclear_norm = 3838.63672
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 201.50198 | spectral_norm = 13.88869 | nuclear_norm = 4756.66553
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 416.80170 | spectral_norm = 30.69370 | nuclear_norm = 11115.36719
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 187.46790 | spectral_norm = 23.51417 | nuclear_norm = 4955.52490
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 176.24828 | spectral_norm = 22.14535 | nuclear_norm = 3913.69019
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 173.12311 | spectral_norm = 20.68028 | nuclear_norm = 3836.66748
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 219.98116 | spectral_norm = 22.82509 | nuclear_norm = 4962.49902
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 236.24023 | spectral_norm = 16.86769 | nuclear_norm = 5536.25244
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 397.86743 | spectral_norm = 31.53957 | nuclear_norm = 10578.07617
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 188.41707 | spectral_norm = 25.47344 | nuclear_norm = 4931.80615
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1238.62622 | spectral_norm = 177.50764 | nuclear_norm = 32481.93359
===========================================
step:1126/1750 train_loss:3.4158 train_time:786226ms step_avg:704.50ms
step:1127/1750 train_loss:3.2825 train_time:786968ms step_avg:704.54ms
step:1128/1750 train_loss:3.5431 train_time:787712ms step_avg:704.57ms
step:1129/1750 train_loss:3.7454 train_time:788448ms step_avg:704.60ms
step:1130/1750 train_loss:3.2980 train_time:789186ms step_avg:704.63ms
step:1131/1750 train_loss:3.6244 train_time:789921ms step_avg:704.66ms
step:1132/1750 train_loss:3.4439 train_time:790647ms step_avg:704.68ms
step:1133/1750 train_loss:3.4636 train_time:791380ms step_avg:704.70ms
step:1134/1750 train_loss:3.4299 train_time:792106ms step_avg:704.72ms
step:1135/1750 train_loss:3.5581 train_time:792859ms step_avg:704.76ms
step:1136/1750 train_loss:3.5141 train_time:793595ms step_avg:704.79ms
step:1137/1750 train_loss:3.5867 train_time:794332ms step_avg:704.82ms
step:1138/1750 train_loss:3.6273 train_time:795077ms step_avg:704.86ms
step:1139/1750 train_loss:3.5249 train_time:795819ms step_avg:704.89ms
step:1140/1750 train_loss:3.4124 train_time:796752ms step_avg:705.09ms
step:1141/1750 train_loss:3.7208 train_time:797489ms step_avg:705.12ms
step:1142/1750 train_loss:3.5284 train_time:798217ms step_avg:705.14ms
step:1143/1750 train_loss:3.5922 train_time:799139ms step_avg:705.33ms
step:1144/1750 train_loss:3.6344 train_time:799868ms step_avg:705.35ms
step:1145/1750 train_loss:3.2371 train_time:800612ms step_avg:705.39ms
step:1146/1750 train_loss:3.5632 train_time:801356ms step_avg:705.42ms
step:1147/1750 train_loss:3.4146 train_time:802093ms step_avg:705.45ms
step:1148/1750 train_loss:3.4642 train_time:802822ms step_avg:705.47ms
step:1149/1750 train_loss:3.5238 train_time:803556ms step_avg:705.49ms
step:1150/1750 train_loss:3.6046 train_time:804289ms step_avg:705.52ms
step:1151/1750 train_loss:3.5676 train_time:805025ms step_avg:705.54ms
step:1152/1750 train_loss:3.4571 train_time:805772ms step_avg:705.58ms
step:1153/1750 train_loss:3.4238 train_time:806523ms step_avg:705.62ms
step:1154/1750 train_loss:3.6538 train_time:807253ms step_avg:705.64ms
step:1155/1750 train_loss:3.6512 train_time:807995ms step_avg:705.67ms
step:1156/1750 train_loss:3.3607 train_time:808731ms step_avg:705.70ms
step:1157/1750 train_loss:3.3671 train_time:809458ms step_avg:705.72ms
step:1158/1750 train_loss:3.5040 train_time:810212ms step_avg:705.76ms
step:1159/1750 train_loss:3.5253 train_time:810955ms step_avg:705.79ms
step:1160/1750 train_loss:3.2930 train_time:811688ms step_avg:705.82ms
step:1161/1750 train_loss:3.3672 train_time:812420ms step_avg:705.84ms
step:1162/1750 train_loss:3.3521 train_time:813158ms step_avg:705.87ms
step:1163/1750 train_loss:3.5772 train_time:813889ms step_avg:705.89ms
step:1164/1750 train_loss:3.3799 train_time:814633ms step_avg:705.92ms
step:1165/1750 train_loss:3.4990 train_time:815371ms step_avg:705.95ms
step:1166/1750 train_loss:3.4705 train_time:816108ms step_avg:705.98ms
step:1167/1750 train_loss:3.4688 train_time:816847ms step_avg:706.00ms
step:1168/1750 train_loss:3.4506 train_time:817587ms step_avg:706.03ms
step:1169/1750 train_loss:3.4477 train_time:818330ms step_avg:706.07ms
step:1170/1750 train_loss:3.6616 train_time:819080ms step_avg:706.10ms
step:1171/1750 train_loss:3.4305 train_time:819827ms step_avg:706.14ms
step:1172/1750 train_loss:3.5201 train_time:820567ms step_avg:706.17ms
step:1173/1750 train_loss:3.4814 train_time:821320ms step_avg:706.21ms
step:1174/1750 train_loss:3.3884 train_time:822063ms step_avg:706.24ms
step:1175/1750 train_loss:3.4824 train_time:822800ms step_avg:706.27ms
step:1176/1750 train_loss:3.8285 train_time:823605ms step_avg:706.35ms
step:1177/1750 train_loss:3.4505 train_time:824357ms step_avg:706.39ms
step:1178/1750 train_loss:3.4615 train_time:825109ms step_avg:706.43ms
step:1179/1750 train_loss:3.3412 train_time:825886ms step_avg:706.49ms
step:1180/1750 train_loss:3.4837 train_time:826633ms step_avg:706.52ms
step:1181/1750 train_loss:3.5018 train_time:827375ms step_avg:706.55ms
step:1182/1750 train_loss:3.4330 train_time:828123ms step_avg:706.59ms
step:1183/1750 train_loss:3.3528 train_time:828878ms step_avg:706.63ms
step:1184/1750 train_loss:3.4850 train_time:829634ms step_avg:706.67ms
step:1185/1750 train_loss:3.5940 train_time:830385ms step_avg:706.71ms
step:1186/1750 train_loss:3.7641 train_time:831136ms step_avg:706.75ms
step:1187/1750 train_loss:3.6038 train_time:831885ms step_avg:706.78ms
step:1188/1750 train_loss:3.4422 train_time:832644ms step_avg:706.83ms
step:1189/1750 train_loss:3.2995 train_time:833426ms step_avg:706.89ms
step:1190/1750 train_loss:3.4356 train_time:834178ms step_avg:706.93ms
step:1191/1750 train_loss:3.4352 train_time:834918ms step_avg:706.96ms
step:1192/1750 train_loss:3.4822 train_time:835668ms step_avg:707.00ms
step:1193/1750 train_loss:3.3983 train_time:836413ms step_avg:707.03ms
step:1194/1750 train_loss:3.5565 train_time:837162ms step_avg:707.06ms
step:1195/1750 train_loss:3.4193 train_time:837898ms step_avg:707.09ms
step:1196/1750 train_loss:3.4092 train_time:838662ms step_avg:707.13ms
step:1197/1750 train_loss:3.4005 train_time:839420ms step_avg:707.18ms
step:1198/1750 train_loss:3.4839 train_time:840167ms step_avg:707.21ms
step:1199/1750 train_loss:3.4525 train_time:840908ms step_avg:707.24ms
step:1200/1750 train_loss:3.4172 train_time:841677ms step_avg:707.29ms
step:1201/1750 train_loss:3.8278 train_time:842466ms step_avg:707.36ms
step:1202/1750 train_loss:3.3614 train_time:843213ms step_avg:707.39ms
step:1203/1750 train_loss:3.4568 train_time:843953ms step_avg:707.42ms
step:1204/1750 train_loss:3.4534 train_time:844707ms step_avg:707.46ms
step:1205/1750 train_loss:3.5205 train_time:845494ms step_avg:707.53ms
step:1206/1750 train_loss:3.5162 train_time:846241ms step_avg:707.56ms
step:1207/1750 train_loss:3.4765 train_time:847004ms step_avg:707.61ms
step:1208/1750 train_loss:3.3989 train_time:847752ms step_avg:707.64ms
step:1209/1750 train_loss:3.4670 train_time:848492ms step_avg:707.67ms
step:1210/1750 train_loss:3.4071 train_time:849241ms step_avg:707.70ms
step:1211/1750 train_loss:3.4736 train_time:849988ms step_avg:707.73ms
step:1212/1750 train_loss:3.7171 train_time:850753ms step_avg:707.78ms
step:1213/1750 train_loss:3.3917 train_time:851498ms step_avg:707.81ms
step:1214/1750 train_loss:3.6381 train_time:852242ms step_avg:707.84ms
step:1215/1750 train_loss:3.4420 train_time:852985ms step_avg:707.87ms
step:1216/1750 train_loss:3.5266 train_time:853736ms step_avg:707.91ms
step:1217/1750 train_loss:3.4763 train_time:854489ms step_avg:707.94ms
step:1218/1750 train_loss:3.4884 train_time:855218ms step_avg:707.96ms
step:1219/1750 train_loss:3.5187 train_time:855971ms step_avg:708.00ms
step:1220/1750 train_loss:3.4417 train_time:856714ms step_avg:708.03ms
step:1221/1750 train_loss:3.4934 train_time:857456ms step_avg:708.06ms
step:1222/1750 train_loss:3.5040 train_time:858209ms step_avg:708.09ms
step:1223/1750 train_loss:3.5174 train_time:858955ms step_avg:708.12ms
step:1224/1750 train_loss:3.4701 train_time:859726ms step_avg:708.18ms
step:1225/1750 train_loss:3.4493 train_time:860472ms step_avg:708.21ms
step:1226/1750 train_loss:3.3517 train_time:861226ms step_avg:708.24ms
step:1227/1750 train_loss:3.5052 train_time:861980ms step_avg:708.28ms
step:1228/1750 train_loss:3.2990 train_time:862716ms step_avg:708.31ms
step:1229/1750 train_loss:3.5976 train_time:863468ms step_avg:708.34ms
step:1230/1750 train_loss:3.4173 train_time:864216ms step_avg:708.37ms
step:1231/1750 train_loss:3.4206 train_time:864988ms step_avg:708.43ms
step:1232/1750 train_loss:3.5815 train_time:865753ms step_avg:708.47ms
step:1233/1750 train_loss:3.3081 train_time:866502ms step_avg:708.51ms
step:1234/1750 train_loss:3.3832 train_time:867245ms step_avg:708.53ms
step:1235/1750 train_loss:3.4355 train_time:867984ms step_avg:708.56ms
step:1236/1750 train_loss:3.4497 train_time:868730ms step_avg:708.59ms
step:1237/1750 train_loss:3.4414 train_time:869483ms step_avg:708.63ms
step:1238/1750 train_loss:3.4112 train_time:870227ms step_avg:708.65ms
step:1239/1750 train_loss:3.6368 train_time:870967ms step_avg:708.68ms
step:1240/1750 train_loss:3.3905 train_time:871738ms step_avg:708.73ms
step:1241/1750 train_loss:3.2844 train_time:872485ms step_avg:708.76ms
step:1242/1750 train_loss:3.5537 train_time:873247ms step_avg:708.80ms
step:1243/1750 train_loss:3.2656 train_time:874004ms step_avg:708.84ms
step:1244/1750 train_loss:3.4433 train_time:874743ms step_avg:708.87ms
step:1245/1750 train_loss:3.6821 train_time:875486ms step_avg:708.90ms
step:1246/1750 train_loss:3.3712 train_time:876229ms step_avg:708.92ms
step:1247/1750 train_loss:3.4491 train_time:876966ms step_avg:708.95ms
step:1248/1750 train_loss:3.5411 train_time:877699ms step_avg:708.97ms
step:1249/1750 train_loss:3.2667 train_time:878441ms step_avg:708.99ms
step:1250/1750 train_loss:3.3723 train_time:879188ms step_avg:709.02ms
step:1250/1750 val_loss:3.4242 train_time:879200ms step_avg:709.03ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | frobenius_norm = 66613.56250 | spectral_norm = 11799.33887 | nuclear_norm = 1674815.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 181.97173 | spectral_norm = 30.87774 | nuclear_norm = 4179.55908
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 174.72160 | spectral_norm = 36.30093 | nuclear_norm = 3988.61133
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 230.76274 | spectral_norm = 15.32045 | nuclear_norm = 5577.43506
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 172.59108 | spectral_norm = 20.12258 | nuclear_norm = 3998.07104
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 384.72144 | spectral_norm = 30.15136 | nuclear_norm = 10246.29102
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 201.46939 | spectral_norm = 22.12577 | nuclear_norm = 5341.73535
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 183.03711 | spectral_norm = 18.64315 | nuclear_norm = 4220.86084
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 180.12877 | spectral_norm = 18.32691 | nuclear_norm = 4165.21875
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 181.82549 | spectral_norm = 15.15248 | nuclear_norm = 4196.68994
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 179.04208 | spectral_norm = 14.56626 | nuclear_norm = 4150.89453
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 395.97397 | spectral_norm = 28.21614 | nuclear_norm = 10592.07031
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 199.24751 | spectral_norm = 22.65611 | nuclear_norm = 5263.91211
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 182.74570 | spectral_norm = 18.31212 | nuclear_norm = 4196.63232
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 178.74860 | spectral_norm = 18.05163 | nuclear_norm = 4105.06445
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 217.90102 | spectral_norm = 19.38559 | nuclear_norm = 4952.51416
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 210.90796 | spectral_norm = 15.07612 | nuclear_norm = 5011.79688
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 382.71625 | spectral_norm = 30.85584 | nuclear_norm = 10228.69727
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 192.62889 | spectral_norm = 18.81507 | nuclear_norm = 5085.77051
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 178.57077 | spectral_norm = 19.43234 | nuclear_norm = 4041.36670
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 177.71130 | spectral_norm = 17.25341 | nuclear_norm = 4024.46436
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 217.34213 | spectral_norm = 19.82125 | nuclear_norm = 4889.09570
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 214.32953 | spectral_norm = 19.01212 | nuclear_norm = 4940.77393
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 392.38583 | spectral_norm = 35.53176 | nuclear_norm = 10475.44043
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 192.50703 | spectral_norm = 19.56889 | nuclear_norm = 5047.03271
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 176.76376 | spectral_norm = 21.34255 | nuclear_norm = 3988.72363
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 175.45874 | spectral_norm = 19.32228 | nuclear_norm = 4017.84033
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 204.08727 | spectral_norm = 18.06113 | nuclear_norm = 4510.75781
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 204.19461 | spectral_norm = 16.36621 | nuclear_norm = 4653.15967
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 389.80469 | spectral_norm = 37.76120 | nuclear_norm = 10331.46484
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 193.88179 | spectral_norm = 20.19298 | nuclear_norm = 5076.99219
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 170.74219 | spectral_norm = 17.80466 | nuclear_norm = 3712.75464
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 173.13728 | spectral_norm = 16.85420 | nuclear_norm = 3807.75854
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 206.49437 | spectral_norm = 19.33197 | nuclear_norm = 4585.89160
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 208.60556 | spectral_norm = 17.47781 | nuclear_norm = 4785.10645
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 420.32507 | spectral_norm = 36.19416 | nuclear_norm = 11167.36035
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 191.77609 | spectral_norm = 21.42601 | nuclear_norm = 5033.32422
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 175.30273 | spectral_norm = 18.26251 | nuclear_norm = 3919.72607
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 173.68335 | spectral_norm = 17.54943 | nuclear_norm = 3899.58374
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 215.86620 | spectral_norm = 21.94997 | nuclear_norm = 4783.03125
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 220.36777 | spectral_norm = 18.01899 | nuclear_norm = 5143.65137
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 414.62576 | spectral_norm = 34.27297 | nuclear_norm = 11055.13477
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 195.60176 | spectral_norm = 22.50132 | nuclear_norm = 5133.77539
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 175.84277 | spectral_norm = 17.47017 | nuclear_norm = 3901.13428
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 175.67175 | spectral_norm = 16.42418 | nuclear_norm = 3924.49756
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 224.32384 | spectral_norm = 21.02235 | nuclear_norm = 4965.46387
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 226.73523 | spectral_norm = 17.95116 | nuclear_norm = 5303.34961
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 403.32562 | spectral_norm = 35.72951 | nuclear_norm = 10708.07227
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 198.32156 | spectral_norm = 22.44938 | nuclear_norm = 5241.20801
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 181.80595 | spectral_norm = 18.47210 | nuclear_norm = 4054.89331
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 181.66843 | spectral_norm = 20.10365 | nuclear_norm = 4013.80469
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 237.63217 | spectral_norm = 25.29327 | nuclear_norm = 5205.01758
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 232.90221 | spectral_norm = 17.22051 | nuclear_norm = 5452.71191
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 402.65182 | spectral_norm = 36.98438 | nuclear_norm = 10695.94531
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 204.71037 | spectral_norm = 21.40427 | nuclear_norm = 5423.47363
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 176.37460 | spectral_norm = 20.69503 | nuclear_norm = 3929.02856
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 176.23642 | spectral_norm = 20.05577 | nuclear_norm = 3986.43701
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 230.79546 | spectral_norm = 21.65334 | nuclear_norm = 5074.46924
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 220.01541 | spectral_norm = 19.52205 | nuclear_norm = 4911.78613
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 405.53586 | spectral_norm = 36.33338 | nuclear_norm = 10748.35938
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 200.20804 | spectral_norm = 21.22019 | nuclear_norm = 5304.43457
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 179.60846 | spectral_norm = 22.32883 | nuclear_norm = 3945.08740
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 181.81290 | spectral_norm = 19.88625 | nuclear_norm = 3956.26831
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 176.82428 | spectral_norm = 18.78907 | nuclear_norm = 4054.40234
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 211.84334 | spectral_norm = 14.65514 | nuclear_norm = 5002.40283
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 439.54889 | spectral_norm = 32.67203 | nuclear_norm = 11718.20703
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 197.31738 | spectral_norm = 25.29528 | nuclear_norm = 5214.76025
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 185.29411 | spectral_norm = 23.75336 | nuclear_norm = 4098.12842
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 181.77557 | spectral_norm = 22.11314 | nuclear_norm = 4011.53418
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 234.89297 | spectral_norm = 24.70204 | nuclear_norm = 5295.97266
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 249.97331 | spectral_norm = 17.76096 | nuclear_norm = 5855.64941
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 418.16687 | spectral_norm = 33.44276 | nuclear_norm = 11111.91992
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 198.00368 | spectral_norm = 27.16926 | nuclear_norm = 5179.81445
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1289.08691 | spectral_norm = 176.19762 | nuclear_norm = 33889.70703
===========================================
step:1251/1750 train_loss:3.3778 train_time:879924ms step_avg:709.04ms
step:1252/1750 train_loss:3.2570 train_time:880661ms step_avg:709.07ms
step:1253/1750 train_loss:3.5074 train_time:881400ms step_avg:709.09ms
step:1254/1750 train_loss:3.6093 train_time:882167ms step_avg:709.14ms
step:1255/1750 train_loss:3.3511 train_time:882900ms step_avg:709.16ms
step:1256/1750 train_loss:3.5554 train_time:883630ms step_avg:709.17ms
step:1257/1750 train_loss:3.2979 train_time:884381ms step_avg:709.21ms
step:1258/1750 train_loss:3.4758 train_time:885126ms step_avg:709.24ms
step:1259/1750 train_loss:3.5627 train_time:885865ms step_avg:709.26ms
step:1260/1750 train_loss:3.4082 train_time:886600ms step_avg:709.28ms
step:1261/1750 train_loss:3.4627 train_time:887360ms step_avg:709.32ms
step:1262/1750 train_loss:3.5850 train_time:888103ms step_avg:709.35ms
step:1263/1750 train_loss:3.2460 train_time:888844ms step_avg:709.37ms
step:1264/1750 train_loss:3.5089 train_time:889590ms step_avg:709.40ms
step:1265/1750 train_loss:3.4310 train_time:890336ms step_avg:709.43ms
step:1266/1750 train_loss:3.4191 train_time:891076ms step_avg:709.46ms
step:1267/1750 train_loss:3.3454 train_time:891816ms step_avg:709.48ms
step:1268/1750 train_loss:3.3456 train_time:892572ms step_avg:709.52ms
step:1269/1750 train_loss:3.4554 train_time:893310ms step_avg:709.54ms
step:1270/1750 train_loss:3.3512 train_time:894058ms step_avg:709.57ms
step:1271/1750 train_loss:3.4647 train_time:894795ms step_avg:709.59ms
step:1272/1750 train_loss:3.4194 train_time:895546ms step_avg:709.62ms
step:1273/1750 train_loss:3.4551 train_time:896281ms step_avg:709.64ms
step:1274/1750 train_loss:3.3565 train_time:897030ms step_avg:709.68ms
step:1275/1750 train_loss:3.4863 train_time:897755ms step_avg:709.69ms
step:1276/1750 train_loss:3.4211 train_time:898489ms step_avg:709.71ms
step:1277/1750 train_loss:3.5159 train_time:899224ms step_avg:709.73ms
step:1278/1750 train_loss:3.4552 train_time:899964ms step_avg:709.75ms
step:1279/1750 train_loss:3.3783 train_time:900737ms step_avg:709.80ms
step:1280/1750 train_loss:3.3239 train_time:901479ms step_avg:709.83ms
step:1281/1750 train_loss:3.4120 train_time:902215ms step_avg:709.85ms
step:1282/1750 train_loss:3.3765 train_time:902965ms step_avg:709.88ms
step:1283/1750 train_loss:3.5543 train_time:903704ms step_avg:709.90ms
step:1284/1750 train_loss:3.3784 train_time:904442ms step_avg:709.92ms
step:1285/1750 train_loss:3.5232 train_time:905188ms step_avg:709.95ms
step:1286/1750 train_loss:3.3973 train_time:905941ms step_avg:709.98ms
step:1287/1750 train_loss:3.4815 train_time:906673ms step_avg:710.00ms
step:1288/1750 train_loss:3.4417 train_time:907407ms step_avg:710.02ms
step:1289/1750 train_loss:3.4441 train_time:908158ms step_avg:710.05ms
step:1290/1750 train_loss:3.4571 train_time:908915ms step_avg:710.09ms
step:1291/1750 train_loss:3.5959 train_time:909678ms step_avg:710.13ms
step:1292/1750 train_loss:3.4073 train_time:910437ms step_avg:710.17ms
step:1293/1750 train_loss:3.2161 train_time:911195ms step_avg:710.21ms
step:1294/1750 train_loss:3.4331 train_time:911932ms step_avg:710.23ms
step:1295/1750 train_loss:3.4181 train_time:912703ms step_avg:710.27ms
step:1296/1750 train_loss:3.4682 train_time:913447ms step_avg:710.30ms
step:1297/1750 train_loss:3.5008 train_time:914192ms step_avg:710.33ms
step:1298/1750 train_loss:3.5001 train_time:914934ms step_avg:710.35ms
step:1299/1750 train_loss:3.4724 train_time:915689ms step_avg:710.39ms
step:1300/1750 train_loss:3.4433 train_time:916428ms step_avg:710.41ms
step:1301/1750 train_loss:3.5770 train_time:917173ms step_avg:710.44ms
step:1302/1750 train_loss:3.4283 train_time:917922ms step_avg:710.47ms
step:1303/1750 train_loss:3.5197 train_time:918672ms step_avg:710.50ms
step:1304/1750 train_loss:3.4433 train_time:919411ms step_avg:710.52ms
step:1305/1750 train_loss:3.5303 train_time:920181ms step_avg:710.56ms
step:1306/1750 train_loss:3.6128 train_time:920953ms step_avg:710.61ms
step:1307/1750 train_loss:3.3962 train_time:921721ms step_avg:710.66ms
step:1308/1750 train_loss:3.3571 train_time:922472ms step_avg:710.69ms
step:1309/1750 train_loss:3.3706 train_time:923230ms step_avg:710.72ms
step:1310/1750 train_loss:3.4257 train_time:923974ms step_avg:710.75ms
step:1311/1750 train_loss:3.3551 train_time:924723ms step_avg:710.78ms
step:1312/1750 train_loss:3.5338 train_time:925469ms step_avg:710.81ms
step:1313/1750 train_loss:3.4164 train_time:926217ms step_avg:710.83ms
step:1314/1750 train_loss:3.4738 train_time:926967ms step_avg:710.86ms
step:1315/1750 train_loss:3.4567 train_time:927719ms step_avg:710.90ms
step:1316/1750 train_loss:3.4756 train_time:928468ms step_avg:710.93ms
step:1317/1750 train_loss:3.3179 train_time:929242ms step_avg:710.97ms
step:1318/1750 train_loss:3.5927 train_time:929982ms step_avg:711.00ms
step:1319/1750 train_loss:3.5047 train_time:930737ms step_avg:711.03ms
step:1320/1750 train_loss:3.3871 train_time:931478ms step_avg:711.05ms
step:1321/1750 train_loss:3.4976 train_time:932245ms step_avg:711.09ms
step:1322/1750 train_loss:3.4666 train_time:932986ms step_avg:711.12ms
step:1323/1750 train_loss:3.4498 train_time:933738ms step_avg:711.15ms
step:1324/1750 train_loss:3.6326 train_time:934510ms step_avg:711.19ms
step:1325/1750 train_loss:3.4992 train_time:935285ms step_avg:711.24ms
step:1326/1750 train_loss:3.5446 train_time:936032ms step_avg:711.27ms
step:1327/1750 train_loss:3.5587 train_time:936773ms step_avg:711.29ms
step:1328/1750 train_loss:3.3034 train_time:937538ms step_avg:711.33ms
step:1329/1750 train_loss:3.3860 train_time:938286ms step_avg:711.36ms
step:1330/1750 train_loss:3.4418 train_time:939242ms step_avg:711.55ms
step:1331/1750 train_loss:2.7069 train_time:940030ms step_avg:711.61ms
step:1332/1750 train_loss:3.4519 train_time:940794ms step_avg:711.64ms
step:1333/1750 train_loss:3.4172 train_time:941552ms step_avg:711.68ms
step:1334/1750 train_loss:3.3964 train_time:942296ms step_avg:711.70ms
step:1335/1750 train_loss:3.8058 train_time:943088ms step_avg:711.76ms
step:1336/1750 train_loss:3.5396 train_time:943828ms step_avg:711.79ms
step:1337/1750 train_loss:3.4352 train_time:944578ms step_avg:711.81ms
step:1338/1750 train_loss:3.3602 train_time:945344ms step_avg:711.86ms
step:1339/1750 train_loss:3.3577 train_time:946107ms step_avg:711.89ms
step:1340/1750 train_loss:3.6194 train_time:946871ms step_avg:711.93ms
step:1341/1750 train_loss:3.5823 train_time:947626ms step_avg:711.97ms
step:1342/1750 train_loss:3.4011 train_time:948389ms step_avg:712.00ms
step:1343/1750 train_loss:3.3502 train_time:949130ms step_avg:712.03ms
step:1344/1750 train_loss:3.6617 train_time:949890ms step_avg:712.06ms
step:1345/1750 train_loss:3.4244 train_time:950639ms step_avg:712.09ms
step:1346/1750 train_loss:3.4245 train_time:951398ms step_avg:712.12ms
step:1347/1750 train_loss:3.4812 train_time:952143ms step_avg:712.15ms
step:1348/1750 train_loss:3.4487 train_time:952895ms step_avg:712.18ms
step:1349/1750 train_loss:3.3630 train_time:953635ms step_avg:712.20ms
step:1350/1750 train_loss:3.3347 train_time:954384ms step_avg:712.23ms
step:1351/1750 train_loss:3.4064 train_time:955151ms step_avg:712.27ms
step:1352/1750 train_loss:3.3393 train_time:955910ms step_avg:712.30ms
step:1353/1750 train_loss:3.4515 train_time:956657ms step_avg:712.33ms
step:1354/1750 train_loss:3.3075 train_time:957399ms step_avg:712.35ms
step:1355/1750 train_loss:3.3692 train_time:958140ms step_avg:712.37ms
step:1356/1750 train_loss:3.4734 train_time:958903ms step_avg:712.41ms
step:1357/1750 train_loss:3.3182 train_time:959664ms step_avg:712.45ms
step:1358/1750 train_loss:3.2551 train_time:960408ms step_avg:712.47ms
step:1359/1750 train_loss:3.5798 train_time:961166ms step_avg:712.50ms
step:1360/1750 train_loss:3.4899 train_time:961922ms step_avg:712.53ms
step:1361/1750 train_loss:3.2443 train_time:962676ms step_avg:712.57ms
step:1362/1750 train_loss:3.5089 train_time:963449ms step_avg:712.61ms
step:1363/1750 train_loss:3.4205 train_time:964205ms step_avg:712.64ms
step:1364/1750 train_loss:3.2109 train_time:964972ms step_avg:712.68ms
step:1365/1750 train_loss:3.4531 train_time:965725ms step_avg:712.71ms
step:1366/1750 train_loss:3.3369 train_time:966485ms step_avg:712.75ms
step:1367/1750 train_loss:3.3676 train_time:967228ms step_avg:712.77ms
step:1368/1750 train_loss:3.3743 train_time:968000ms step_avg:712.81ms
step:1369/1750 train_loss:3.4886 train_time:968734ms step_avg:712.83ms
step:1370/1750 train_loss:3.4533 train_time:969488ms step_avg:712.86ms
step:1371/1750 train_loss:3.4136 train_time:970252ms step_avg:712.90ms
step:1372/1750 train_loss:3.3304 train_time:971020ms step_avg:712.94ms
step:1373/1750 train_loss:3.6712 train_time:971777ms step_avg:712.97ms
step:1374/1750 train_loss:3.3803 train_time:972513ms step_avg:712.99ms
step:1375/1750 train_loss:3.4365 train_time:973269ms step_avg:713.02ms
step:1375/1750 val_loss:3.3764 train_time:973281ms step_avg:713.03ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | frobenius_norm = 67724.68750 | spectral_norm = 11983.08203 | nuclear_norm = 1704719.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 186.70377 | spectral_norm = 32.57020 | nuclear_norm = 4282.47363
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 179.56497 | spectral_norm = 38.07365 | nuclear_norm = 4094.06885
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 237.41356 | spectral_norm = 15.86036 | nuclear_norm = 5749.47363
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 175.33078 | spectral_norm = 20.86220 | nuclear_norm = 4057.68799
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 397.38120 | spectral_norm = 31.31319 | nuclear_norm = 10587.19141
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 207.66566 | spectral_norm = 23.02410 | nuclear_norm = 5506.30322
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 188.63167 | spectral_norm = 19.34399 | nuclear_norm = 4347.40430
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 185.68813 | spectral_norm = 18.86785 | nuclear_norm = 4290.92480
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 186.93153 | spectral_norm = 15.63120 | nuclear_norm = 4315.87061
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 184.05621 | spectral_norm = 14.98527 | nuclear_norm = 4270.14990
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 408.64258 | spectral_norm = 29.40731 | nuclear_norm = 10932.51367
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 205.26765 | spectral_norm = 23.59444 | nuclear_norm = 5423.50977
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 188.13707 | spectral_norm = 18.91074 | nuclear_norm = 4316.21680
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 184.10368 | spectral_norm = 18.71999 | nuclear_norm = 4224.75977
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 224.86520 | spectral_norm = 20.06795 | nuclear_norm = 5116.39062
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 217.26036 | spectral_norm = 15.59897 | nuclear_norm = 5166.48633
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 394.54611 | spectral_norm = 32.07310 | nuclear_norm = 10545.54492
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 198.28867 | spectral_norm = 19.56099 | nuclear_norm = 5235.08447
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 183.71487 | spectral_norm = 20.16598 | nuclear_norm = 4150.66357
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 183.01491 | spectral_norm = 17.68612 | nuclear_norm = 4139.40527
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 225.31895 | spectral_norm = 20.53267 | nuclear_norm = 5075.93018
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 221.67229 | spectral_norm = 19.71774 | nuclear_norm = 5113.11865
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 403.87189 | spectral_norm = 36.91379 | nuclear_norm = 10782.75000
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 198.34406 | spectral_norm = 20.31708 | nuclear_norm = 5199.18652
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 182.08768 | spectral_norm = 22.14874 | nuclear_norm = 4101.34229
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 180.87151 | spectral_norm = 19.92101 | nuclear_norm = 4137.56543
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 211.86374 | spectral_norm = 18.63632 | nuclear_norm = 4691.62305
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 211.62454 | spectral_norm = 16.96409 | nuclear_norm = 4830.73242
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 400.89124 | spectral_norm = 39.30055 | nuclear_norm = 10619.34961
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 199.43648 | spectral_norm = 20.94666 | nuclear_norm = 5218.36572
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 175.46779 | spectral_norm = 18.39339 | nuclear_norm = 3801.27124
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 177.92233 | spectral_norm = 17.38982 | nuclear_norm = 3899.72778
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 214.38554 | spectral_norm = 20.05142 | nuclear_norm = 4768.76660
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 216.13474 | spectral_norm = 18.29713 | nuclear_norm = 4963.98340
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 432.72287 | spectral_norm = 37.68335 | nuclear_norm = 11492.13086
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 197.38672 | spectral_norm = 22.34043 | nuclear_norm = 5179.82031
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 180.40628 | spectral_norm = 18.94947 | nuclear_norm = 4024.45874
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 178.69467 | spectral_norm = 18.19302 | nuclear_norm = 4003.99731
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 223.58954 | spectral_norm = 22.59002 | nuclear_norm = 4967.01318
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 227.53279 | spectral_norm = 18.62294 | nuclear_norm = 5314.85352
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 427.54987 | spectral_norm = 35.62155 | nuclear_norm = 11399.12305
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 201.40530 | spectral_norm = 23.49998 | nuclear_norm = 5283.43750
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 180.92973 | spectral_norm = 18.17353 | nuclear_norm = 4004.02075
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 180.81471 | spectral_norm = 16.93183 | nuclear_norm = 4031.36426
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 232.07375 | spectral_norm = 21.70506 | nuclear_norm = 5147.15576
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 233.55002 | spectral_norm = 18.48656 | nuclear_norm = 5466.06885
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 415.66617 | spectral_norm = 37.11757 | nuclear_norm = 11030.23828
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 203.90054 | spectral_norm = 23.30951 | nuclear_norm = 5387.18066
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 187.01653 | spectral_norm = 19.08631 | nuclear_norm = 4158.77881
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 186.96536 | spectral_norm = 20.82228 | nuclear_norm = 4116.41553
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 246.92119 | spectral_norm = 26.38519 | nuclear_norm = 5408.05566
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 240.60315 | spectral_norm = 17.86852 | nuclear_norm = 5632.12646
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 414.79947 | spectral_norm = 38.76776 | nuclear_norm = 11012.69141
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 210.71895 | spectral_norm = 22.21185 | nuclear_norm = 5581.97168
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 181.65990 | spectral_norm = 21.60715 | nuclear_norm = 4036.89209
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 181.47322 | spectral_norm = 20.76358 | nuclear_norm = 4098.29834
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 239.95197 | spectral_norm = 22.33635 | nuclear_norm = 5288.29053
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 228.13583 | spectral_norm = 20.19542 | nuclear_norm = 5094.46289
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 416.90369 | spectral_norm = 37.81102 | nuclear_norm = 11042.07129
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 205.98514 | spectral_norm = 22.04402 | nuclear_norm = 5456.11914
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 184.64423 | spectral_norm = 23.28524 | nuclear_norm = 4038.93604
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 186.96031 | spectral_norm = 20.73727 | nuclear_norm = 4050.27808
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 183.60190 | spectral_norm = 19.81427 | nuclear_norm = 4206.78076
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 218.32466 | spectral_norm = 15.26387 | nuclear_norm = 5156.38672
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 452.40021 | spectral_norm = 33.88112 | nuclear_norm = 12056.74609
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 203.44308 | spectral_norm = 26.36850 | nuclear_norm = 5376.40137
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 190.89174 | spectral_norm = 24.93863 | nuclear_norm = 4208.44385
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 186.85110 | spectral_norm = 23.22759 | nuclear_norm = 4108.51172
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 245.93498 | spectral_norm = 26.02244 | nuclear_norm = 5543.50781
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 258.68948 | spectral_norm = 18.45203 | nuclear_norm = 6056.04297
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 428.99008 | spectral_norm = 34.49763 | nuclear_norm = 11394.51855
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 203.81813 | spectral_norm = 28.17499 | nuclear_norm = 5330.35938
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1314.33447 | spectral_norm = 173.80663 | nuclear_norm = 34626.69141
===========================================
step:1376/1750 train_loss:3.4285 train_time:974001ms step_avg:713.03ms
step:1377/1750 train_loss:3.2202 train_time:974765ms step_avg:713.07ms
step:1378/1750 train_loss:3.6042 train_time:975510ms step_avg:713.09ms
step:1379/1750 train_loss:3.4010 train_time:976246ms step_avg:713.11ms
step:1380/1750 train_loss:3.5445 train_time:977005ms step_avg:713.14ms
step:1381/1750 train_loss:3.5496 train_time:977742ms step_avg:713.16ms
step:1382/1750 train_loss:3.1822 train_time:978495ms step_avg:713.19ms
step:1383/1750 train_loss:3.3808 train_time:979265ms step_avg:713.23ms
step:1384/1750 train_loss:3.7719 train_time:980021ms step_avg:713.26ms
step:1385/1750 train_loss:3.2806 train_time:980768ms step_avg:713.29ms
step:1386/1750 train_loss:3.4586 train_time:981509ms step_avg:713.31ms
step:1387/1750 train_loss:3.5390 train_time:982257ms step_avg:713.33ms
step:1388/1750 train_loss:3.4667 train_time:982995ms step_avg:713.35ms
step:1389/1750 train_loss:3.4001 train_time:983742ms step_avg:713.37ms
step:1390/1750 train_loss:3.2627 train_time:984492ms step_avg:713.40ms
step:1391/1750 train_loss:3.4048 train_time:985243ms step_avg:713.43ms
step:1392/1750 train_loss:3.3848 train_time:985989ms step_avg:713.45ms
step:1393/1750 train_loss:3.6338 train_time:986726ms step_avg:713.47ms
step:1394/1750 train_loss:3.3528 train_time:987474ms step_avg:713.49ms
step:1395/1750 train_loss:3.3529 train_time:988223ms step_avg:713.52ms
step:1396/1750 train_loss:3.3135 train_time:988964ms step_avg:713.54ms
step:1397/1750 train_loss:3.5716 train_time:989713ms step_avg:713.56ms
step:1398/1750 train_loss:3.4625 train_time:990459ms step_avg:713.59ms
step:1399/1750 train_loss:3.4661 train_time:991205ms step_avg:713.61ms
step:1400/1750 train_loss:3.3633 train_time:991935ms step_avg:713.62ms
step:1401/1750 train_loss:3.3187 train_time:992683ms step_avg:713.65ms
step:1402/1750 train_loss:3.3944 train_time:993433ms step_avg:713.67ms
step:1403/1750 train_loss:3.3791 train_time:994187ms step_avg:713.70ms
step:1404/1750 train_loss:3.4078 train_time:994923ms step_avg:713.72ms
step:1405/1750 train_loss:3.3615 train_time:995675ms step_avg:713.75ms
step:1406/1750 train_loss:3.5612 train_time:996435ms step_avg:713.78ms
step:1407/1750 train_loss:3.3407 train_time:997168ms step_avg:713.79ms
step:1408/1750 train_loss:3.3686 train_time:997929ms step_avg:713.83ms
step:1409/1750 train_loss:3.3741 train_time:998671ms step_avg:713.85ms
step:1410/1750 train_loss:3.2359 train_time:999414ms step_avg:713.87ms
step:1411/1750 train_loss:3.3676 train_time:1000149ms step_avg:713.88ms
step:1412/1750 train_loss:3.3583 train_time:1000924ms step_avg:713.93ms
step:1413/1750 train_loss:3.3437 train_time:1001668ms step_avg:713.95ms
step:1414/1750 train_loss:3.4271 train_time:1002414ms step_avg:713.97ms
step:1415/1750 train_loss:3.3916 train_time:1003160ms step_avg:713.99ms
step:1416/1750 train_loss:3.4147 train_time:1003909ms step_avg:714.02ms
step:1417/1750 train_loss:3.3956 train_time:1004656ms step_avg:714.04ms
step:1418/1750 train_loss:3.4675 train_time:1005404ms step_avg:714.07ms
step:1419/1750 train_loss:3.2847 train_time:1006189ms step_avg:714.12ms
step:1420/1750 train_loss:3.3444 train_time:1006953ms step_avg:714.15ms
step:1421/1750 train_loss:3.4528 train_time:1007691ms step_avg:714.17ms
step:1422/1750 train_loss:3.4093 train_time:1008440ms step_avg:714.19ms
step:1423/1750 train_loss:3.4223 train_time:1009198ms step_avg:714.22ms
step:1424/1750 train_loss:3.4365 train_time:1009949ms step_avg:714.25ms
step:1425/1750 train_loss:3.3996 train_time:1010701ms step_avg:714.28ms
step:1426/1750 train_loss:3.3784 train_time:1011441ms step_avg:714.29ms
step:1427/1750 train_loss:3.3910 train_time:1012203ms step_avg:714.33ms
step:1428/1750 train_loss:3.2423 train_time:1012990ms step_avg:714.38ms
step:1429/1750 train_loss:3.3900 train_time:1013736ms step_avg:714.40ms
step:1430/1750 train_loss:3.3363 train_time:1014495ms step_avg:714.43ms
step:1431/1750 train_loss:3.4387 train_time:1015248ms step_avg:714.46ms
step:1432/1750 train_loss:3.4241 train_time:1015990ms step_avg:714.48ms
step:1433/1750 train_loss:3.3208 train_time:1016751ms step_avg:714.51ms
step:1434/1750 train_loss:3.3797 train_time:1017512ms step_avg:714.55ms
step:1435/1750 train_loss:3.3952 train_time:1018270ms step_avg:714.58ms
step:1436/1750 train_loss:3.2037 train_time:1019053ms step_avg:714.62ms
step:1437/1750 train_loss:3.3490 train_time:1019825ms step_avg:714.66ms
step:1438/1750 train_loss:3.1791 train_time:1020577ms step_avg:714.69ms
step:1439/1750 train_loss:3.2843 train_time:1021325ms step_avg:714.71ms
step:1440/1750 train_loss:3.4654 train_time:1022100ms step_avg:714.76ms
step:1441/1750 train_loss:3.4376 train_time:1022853ms step_avg:714.78ms
step:1442/1750 train_loss:3.3761 train_time:1023620ms step_avg:714.82ms
step:1443/1750 train_loss:3.2442 train_time:1024373ms step_avg:714.85ms
step:1444/1750 train_loss:3.4035 train_time:1025136ms step_avg:714.88ms
step:1445/1750 train_loss:3.4450 train_time:1025915ms step_avg:714.92ms
step:1446/1750 train_loss:3.5318 train_time:1026694ms step_avg:714.97ms
step:1447/1750 train_loss:3.5068 train_time:1027447ms step_avg:714.99ms
step:1448/1750 train_loss:3.3912 train_time:1028202ms step_avg:715.02ms
step:1449/1750 train_loss:3.2655 train_time:1028969ms step_avg:715.06ms
step:1450/1750 train_loss:3.3553 train_time:1029724ms step_avg:715.09ms
step:1451/1750 train_loss:3.3554 train_time:1030483ms step_avg:715.12ms
step:1452/1750 train_loss:3.4586 train_time:1031230ms step_avg:715.14ms
step:1453/1750 train_loss:3.4518 train_time:1031981ms step_avg:715.16ms
step:1454/1750 train_loss:3.2657 train_time:1032744ms step_avg:715.20ms
step:1455/1750 train_loss:3.3874 train_time:1033503ms step_avg:715.23ms
step:1456/1750 train_loss:3.3162 train_time:1034270ms step_avg:715.26ms
step:1457/1750 train_loss:3.3422 train_time:1035023ms step_avg:715.29ms
step:1458/1750 train_loss:3.3854 train_time:1035798ms step_avg:715.33ms
step:1459/1750 train_loss:3.3338 train_time:1036549ms step_avg:715.35ms
step:1460/1750 train_loss:3.2163 train_time:1037304ms step_avg:715.38ms
step:1461/1750 train_loss:3.4825 train_time:1038067ms step_avg:715.41ms
step:1462/1750 train_loss:3.3253 train_time:1038817ms step_avg:715.44ms
step:1463/1750 train_loss:3.3736 train_time:1039586ms step_avg:715.48ms
step:1464/1750 train_loss:3.4926 train_time:1040332ms step_avg:715.50ms
step:1465/1750 train_loss:3.3142 train_time:1041093ms step_avg:715.53ms
step:1466/1750 train_loss:3.5233 train_time:1041854ms step_avg:715.56ms
step:1467/1750 train_loss:3.4164 train_time:1042599ms step_avg:715.58ms
step:1468/1750 train_loss:3.4113 train_time:1043347ms step_avg:715.60ms
step:1469/1750 train_loss:3.3438 train_time:1044121ms step_avg:715.64ms
step:1470/1750 train_loss:3.4531 train_time:1044871ms step_avg:715.67ms
step:1471/1750 train_loss:3.3390 train_time:1045629ms step_avg:715.69ms
step:1472/1750 train_loss:3.3242 train_time:1046392ms step_avg:715.73ms
step:1473/1750 train_loss:3.3938 train_time:1047181ms step_avg:715.78ms
step:1474/1750 train_loss:3.3079 train_time:1047943ms step_avg:715.81ms
step:1475/1750 train_loss:3.3003 train_time:1048720ms step_avg:715.85ms
step:1476/1750 train_loss:3.4908 train_time:1049468ms step_avg:715.87ms
step:1477/1750 train_loss:3.3690 train_time:1050222ms step_avg:715.90ms
step:1478/1750 train_loss:3.2002 train_time:1050976ms step_avg:715.92ms
step:1479/1750 train_loss:3.3187 train_time:1051747ms step_avg:715.96ms
step:1480/1750 train_loss:3.3005 train_time:1052527ms step_avg:716.01ms
step:1481/1750 train_loss:3.3658 train_time:1053307ms step_avg:716.05ms
step:1482/1750 train_loss:3.4461 train_time:1054060ms step_avg:716.07ms
step:1483/1750 train_loss:3.3267 train_time:1054805ms step_avg:716.09ms
step:1484/1750 train_loss:3.5088 train_time:1055564ms step_avg:716.12ms
step:1485/1750 train_loss:3.4221 train_time:1056316ms step_avg:716.15ms
step:1486/1750 train_loss:3.3336 train_time:1057104ms step_avg:716.19ms
step:1487/1750 train_loss:3.3137 train_time:1057858ms step_avg:716.22ms
step:1488/1750 train_loss:3.3286 train_time:1058613ms step_avg:716.25ms
step:1489/1750 train_loss:3.2716 train_time:1059391ms step_avg:716.29ms
step:1490/1750 train_loss:3.3869 train_time:1060165ms step_avg:716.33ms
step:1491/1750 train_loss:3.2873 train_time:1060940ms step_avg:716.37ms
step:1492/1750 train_loss:3.3762 train_time:1061691ms step_avg:716.39ms
step:1493/1750 train_loss:3.3070 train_time:1062461ms step_avg:716.43ms
step:1494/1750 train_loss:3.2202 train_time:1063200ms step_avg:716.44ms
step:1495/1750 train_loss:3.3134 train_time:1063957ms step_avg:716.47ms
step:1496/1750 train_loss:3.4892 train_time:1064707ms step_avg:716.49ms
step:1497/1750 train_loss:3.3494 train_time:1065472ms step_avg:716.52ms
step:1498/1750 train_loss:3.0872 train_time:1066230ms step_avg:716.55ms
step:1499/1750 train_loss:3.4118 train_time:1066988ms step_avg:716.58ms
step:1500/1750 train_loss:3.3639 train_time:1067745ms step_avg:716.61ms
step:1500/1750 val_loss:3.3307 train_time:1067756ms step_avg:716.61ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | frobenius_norm = 68215.49219 | spectral_norm = 12075.48438 | nuclear_norm = 1718317.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 188.90674 | spectral_norm = 33.71017 | nuclear_norm = 4327.49414
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 181.94301 | spectral_norm = 39.09517 | nuclear_norm = 4144.22949
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 241.22617 | spectral_norm = 16.06392 | nuclear_norm = 5849.43457
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 176.48505 | spectral_norm = 21.28534 | nuclear_norm = 4080.29736
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 404.26709 | spectral_norm = 32.08636 | nuclear_norm = 10772.62500
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 211.02258 | spectral_norm = 23.53118 | nuclear_norm = 5595.85547
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 191.60909 | spectral_norm = 19.70769 | nuclear_norm = 4412.93408
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 188.62326 | spectral_norm = 19.16490 | nuclear_norm = 4357.98926
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 189.69574 | spectral_norm = 15.85590 | nuclear_norm = 4381.97461
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 186.75064 | spectral_norm = 15.18358 | nuclear_norm = 4336.41260
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 415.37735 | spectral_norm = 30.02958 | nuclear_norm = 11113.88184
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 208.50989 | spectral_norm = 24.11141 | nuclear_norm = 5510.01221
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 191.05118 | spectral_norm = 19.29189 | nuclear_norm = 4380.65430
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 187.01044 | spectral_norm = 19.05715 | nuclear_norm = 4289.77051
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 228.83553 | spectral_norm = 20.40073 | nuclear_norm = 5211.56885
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 220.85823 | spectral_norm = 15.92522 | nuclear_norm = 5256.30713
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 400.82516 | spectral_norm = 32.77245 | nuclear_norm = 10713.84375
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 201.30769 | spectral_norm = 19.98942 | nuclear_norm = 5314.75439
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 186.29263 | spectral_norm = 20.62292 | nuclear_norm = 4203.37744
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 185.65897 | spectral_norm = 17.98533 | nuclear_norm = 4195.26855
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 230.12163 | spectral_norm = 20.88116 | nuclear_norm = 5190.59570
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 226.06239 | spectral_norm = 20.05220 | nuclear_norm = 5219.43652
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 409.96552 | spectral_norm = 37.66650 | nuclear_norm = 10946.21387
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 201.48853 | spectral_norm = 20.80267 | nuclear_norm = 5281.60547
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 184.81799 | spectral_norm = 22.68676 | nuclear_norm = 4157.18555
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 183.55139 | spectral_norm = 20.34464 | nuclear_norm = 4194.12891
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 216.54137 | spectral_norm = 18.99515 | nuclear_norm = 4803.70312
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 216.02336 | spectral_norm = 17.33202 | nuclear_norm = 4938.84277
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 406.69070 | spectral_norm = 40.18450 | nuclear_norm = 10767.78809
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 202.26398 | spectral_norm = 21.38657 | nuclear_norm = 5289.53271
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 177.86829 | spectral_norm = 18.76759 | nuclear_norm = 3843.15820
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 180.40184 | spectral_norm = 17.82762 | nuclear_norm = 3943.08301
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 218.98117 | spectral_norm = 20.49589 | nuclear_norm = 4877.38965
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 220.53378 | spectral_norm = 18.76762 | nuclear_norm = 5072.74121
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 439.19818 | spectral_norm = 38.59353 | nuclear_norm = 11660.43164
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 200.34689 | spectral_norm = 22.91161 | nuclear_norm = 5257.38184
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 183.01521 | spectral_norm = 19.39755 | nuclear_norm = 4074.30054
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 181.36012 | spectral_norm = 18.53253 | nuclear_norm = 4057.98096
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 228.19684 | spectral_norm = 22.86138 | nuclear_norm = 5080.45410
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 231.70772 | spectral_norm = 18.93084 | nuclear_norm = 5416.77441
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 434.53070 | spectral_norm = 36.33883 | nuclear_norm = 11584.56738
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 204.50221 | spectral_norm = 24.07726 | nuclear_norm = 5363.03125
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 183.53917 | spectral_norm = 18.58023 | nuclear_norm = 4052.05859
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 183.41571 | spectral_norm = 17.21609 | nuclear_norm = 4081.65039
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 236.55838 | spectral_norm = 22.01321 | nuclear_norm = 5254.85156
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 237.38216 | spectral_norm = 18.83632 | nuclear_norm = 5556.73340
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 422.22305 | spectral_norm = 37.92567 | nuclear_norm = 11198.92578
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 206.77087 | spectral_norm = 23.77833 | nuclear_norm = 5461.36426
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 189.70647 | spectral_norm = 19.52961 | nuclear_norm = 4206.96777
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 189.66472 | spectral_norm = 21.20182 | nuclear_norm = 4162.80273
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 252.70889 | spectral_norm = 27.00386 | nuclear_norm = 5537.07520
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 245.05577 | spectral_norm = 18.19721 | nuclear_norm = 5734.42676
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 421.11649 | spectral_norm = 39.84871 | nuclear_norm = 11175.64648
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 213.84187 | spectral_norm = 22.63177 | nuclear_norm = 5663.80176
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 184.47011 | spectral_norm = 22.17135 | nuclear_norm = 4091.90356
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 184.30392 | spectral_norm = 21.21624 | nuclear_norm = 4157.49512
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 245.44733 | spectral_norm = 22.74050 | nuclear_norm = 5422.74316
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 232.86858 | spectral_norm = 20.63595 | nuclear_norm = 5202.51367
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 422.74680 | spectral_norm = 38.59868 | nuclear_norm = 11190.88672
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 208.97559 | spectral_norm = 22.49038 | nuclear_norm = 5534.02002
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 187.31119 | spectral_norm = 23.81502 | nuclear_norm = 4083.12085
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 189.69736 | spectral_norm = 21.15612 | nuclear_norm = 4095.16455
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 187.92973 | spectral_norm = 20.52118 | nuclear_norm = 4304.91797
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 221.83414 | spectral_norm = 15.63000 | nuclear_norm = 5238.51855
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 458.57941 | spectral_norm = 34.59742 | nuclear_norm = 12218.19922
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 206.84644 | spectral_norm = 26.80930 | nuclear_norm = 5466.76758
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 193.72844 | spectral_norm = 25.62109 | nuclear_norm = 4259.55566
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 189.41264 | spectral_norm = 23.91528 | nuclear_norm = 4150.54004
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 253.30948 | spectral_norm = 26.87572 | nuclear_norm = 5711.16406
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 263.89377 | spectral_norm = 18.90038 | nuclear_norm = 6174.05566
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 433.88846 | spectral_norm = 34.94085 | nuclear_norm = 11521.09570
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 206.87212 | spectral_norm = 28.65586 | nuclear_norm = 5409.02979
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1322.62122 | spectral_norm = 170.59023 | nuclear_norm = 34906.63281
===========================================
step:1501/1750 train_loss:3.3947 train_time:1068478ms step_avg:716.62ms
step:1502/1750 train_loss:3.3625 train_time:1069258ms step_avg:716.66ms
step:1503/1750 train_loss:3.3448 train_time:1070018ms step_avg:716.69ms
step:1504/1750 train_loss:3.1286 train_time:1070811ms step_avg:716.74ms
step:1505/1750 train_loss:3.4100 train_time:1071577ms step_avg:716.77ms
step:1506/1750 train_loss:3.2930 train_time:1072361ms step_avg:716.82ms
step:1507/1750 train_loss:3.2967 train_time:1073128ms step_avg:716.85ms
step:1508/1750 train_loss:3.2606 train_time:1073875ms step_avg:716.87ms
step:1509/1750 train_loss:3.3291 train_time:1074619ms step_avg:716.89ms
step:1510/1750 train_loss:3.2242 train_time:1075379ms step_avg:716.92ms
step:1511/1750 train_loss:3.5331 train_time:1076138ms step_avg:716.95ms
step:1512/1750 train_loss:3.3308 train_time:1076877ms step_avg:716.96ms
step:1513/1750 train_loss:3.3212 train_time:1077633ms step_avg:716.99ms
step:1514/1750 train_loss:3.4640 train_time:1078368ms step_avg:717.00ms
step:1515/1750 train_loss:3.4701 train_time:1079140ms step_avg:717.04ms
step:1516/1750 train_loss:3.3165 train_time:1079897ms step_avg:717.06ms
step:1517/1750 train_loss:3.1369 train_time:1080672ms step_avg:717.10ms
step:1518/1750 train_loss:3.2872 train_time:1081416ms step_avg:717.12ms
step:1519/1750 train_loss:3.2992 train_time:1082190ms step_avg:717.16ms
step:1520/1750 train_loss:3.3509 train_time:1083141ms step_avg:717.31ms
step:1521/1750 train_loss:3.2547 train_time:1083890ms step_avg:717.33ms
step:1522/1750 train_loss:3.5514 train_time:1084638ms step_avg:717.35ms
step:1523/1750 train_loss:3.1777 train_time:1085386ms step_avg:717.37ms
step:1524/1750 train_loss:3.2899 train_time:1086352ms step_avg:717.54ms
step:1525/1750 train_loss:3.3540 train_time:1087115ms step_avg:717.57ms
step:1526/1750 train_loss:3.3386 train_time:1087881ms step_avg:717.60ms
step:1527/1750 train_loss:3.3946 train_time:1088640ms step_avg:717.63ms
step:1528/1750 train_loss:3.2923 train_time:1089388ms step_avg:717.65ms
step:1529/1750 train_loss:3.2603 train_time:1090138ms step_avg:717.67ms
step:1530/1750 train_loss:3.3104 train_time:1090881ms step_avg:717.68ms
step:1531/1750 train_loss:3.3214 train_time:1091638ms step_avg:717.71ms
step:1532/1750 train_loss:3.3327 train_time:1092394ms step_avg:717.74ms
step:1533/1750 train_loss:3.2838 train_time:1093213ms step_avg:717.80ms
step:1534/1750 train_loss:3.4531 train_time:1093967ms step_avg:717.83ms
step:1535/1750 train_loss:3.2361 train_time:1094728ms step_avg:717.85ms
step:1536/1750 train_loss:3.3859 train_time:1095473ms step_avg:717.87ms
step:1537/1750 train_loss:3.2991 train_time:1096236ms step_avg:717.90ms
step:1538/1750 train_loss:3.1750 train_time:1097007ms step_avg:717.94ms
step:1539/1750 train_loss:3.1408 train_time:1097772ms step_avg:717.97ms
step:1540/1750 train_loss:3.2366 train_time:1098516ms step_avg:717.98ms
step:1541/1750 train_loss:3.2514 train_time:1099287ms step_avg:718.02ms
step:1542/1750 train_loss:3.1678 train_time:1100041ms step_avg:718.04ms
step:1543/1750 train_loss:3.4385 train_time:1100795ms step_avg:718.07ms
step:1544/1750 train_loss:3.2592 train_time:1101546ms step_avg:718.09ms
step:1545/1750 train_loss:3.1429 train_time:1102351ms step_avg:718.14ms
step:1546/1750 train_loss:3.3260 train_time:1103114ms step_avg:718.17ms
step:1547/1750 train_loss:3.3352 train_time:1103869ms step_avg:718.20ms
step:1548/1750 train_loss:3.1180 train_time:1104623ms step_avg:718.22ms
step:1549/1750 train_loss:3.4834 train_time:1105376ms step_avg:718.24ms
step:1550/1750 train_loss:3.4404 train_time:1106144ms step_avg:718.28ms
step:1551/1750 train_loss:3.3016 train_time:1106928ms step_avg:718.32ms
step:1552/1750 train_loss:3.4641 train_time:1107682ms step_avg:718.34ms
step:1553/1750 train_loss:3.3670 train_time:1108438ms step_avg:718.37ms
step:1554/1750 train_loss:3.2909 train_time:1109202ms step_avg:718.39ms
step:1555/1750 train_loss:3.4484 train_time:1109958ms step_avg:718.42ms
step:1556/1750 train_loss:3.4067 train_time:1110700ms step_avg:718.43ms
step:1557/1750 train_loss:3.2855 train_time:1111449ms step_avg:718.45ms
step:1558/1750 train_loss:3.2338 train_time:1112212ms step_avg:718.48ms
step:1559/1750 train_loss:3.2430 train_time:1112967ms step_avg:718.51ms
step:1560/1750 train_loss:3.2835 train_time:1113728ms step_avg:718.53ms
step:1561/1750 train_loss:3.3120 train_time:1114491ms step_avg:718.56ms
step:1562/1750 train_loss:3.3147 train_time:1115269ms step_avg:718.60ms
step:1563/1750 train_loss:3.3669 train_time:1116046ms step_avg:718.64ms
step:1564/1750 train_loss:3.2772 train_time:1116789ms step_avg:718.65ms
step:1565/1750 train_loss:3.3871 train_time:1117552ms step_avg:718.68ms
step:1566/1750 train_loss:3.2541 train_time:1118320ms step_avg:718.71ms
step:1567/1750 train_loss:3.4058 train_time:1119078ms step_avg:718.74ms
step:1568/1750 train_loss:3.2184 train_time:1119847ms step_avg:718.77ms
step:1569/1750 train_loss:3.2389 train_time:1120609ms step_avg:718.80ms
step:1570/1750 train_loss:3.1716 train_time:1121355ms step_avg:718.82ms
step:1571/1750 train_loss:3.1716 train_time:1122127ms step_avg:718.85ms
step:1572/1750 train_loss:3.2209 train_time:1122890ms step_avg:718.88ms
step:1573/1750 train_loss:3.3014 train_time:1123648ms step_avg:718.90ms
step:1574/1750 train_loss:3.0788 train_time:1124418ms step_avg:718.94ms
step:1575/1750 train_loss:3.2910 train_time:1125174ms step_avg:718.96ms
step:1576/1750 train_loss:3.3103 train_time:1125976ms step_avg:719.01ms
step:1577/1750 train_loss:3.2789 train_time:1126746ms step_avg:719.05ms
step:1578/1750 train_loss:3.3121 train_time:1127542ms step_avg:719.10ms
step:1579/1750 train_loss:3.3025 train_time:1128300ms step_avg:719.12ms
step:1580/1750 train_loss:3.2566 train_time:1129055ms step_avg:719.14ms
step:1581/1750 train_loss:3.4749 train_time:1129818ms step_avg:719.17ms
step:1582/1750 train_loss:3.3431 train_time:1130586ms step_avg:719.20ms
step:1583/1750 train_loss:3.3967 train_time:1131334ms step_avg:719.22ms
step:1584/1750 train_loss:3.1300 train_time:1132123ms step_avg:719.27ms
step:1585/1750 train_loss:3.2762 train_time:1132913ms step_avg:719.31ms
step:1586/1750 train_loss:3.2087 train_time:1133669ms step_avg:719.33ms
step:1587/1750 train_loss:3.3734 train_time:1134416ms step_avg:719.35ms
step:1588/1750 train_loss:3.2774 train_time:1135170ms step_avg:719.37ms
step:1589/1750 train_loss:3.2420 train_time:1135922ms step_avg:719.39ms
step:1590/1750 train_loss:3.2404 train_time:1136709ms step_avg:719.44ms
step:1591/1750 train_loss:3.2763 train_time:1137459ms step_avg:719.46ms
step:1592/1750 train_loss:3.1107 train_time:1138240ms step_avg:719.49ms
step:1593/1750 train_loss:3.2280 train_time:1138993ms step_avg:719.52ms
step:1594/1750 train_loss:3.5719 train_time:1139760ms step_avg:719.55ms
step:1595/1750 train_loss:3.2059 train_time:1140522ms step_avg:719.57ms
step:1596/1750 train_loss:3.1797 train_time:1141326ms step_avg:719.63ms
step:1597/1750 train_loss:3.3406 train_time:1142077ms step_avg:719.64ms
step:1598/1750 train_loss:3.2665 train_time:1142879ms step_avg:719.70ms
step:1599/1750 train_loss:3.1194 train_time:1143652ms step_avg:719.73ms
step:1600/1750 train_loss:3.2787 train_time:1144430ms step_avg:719.77ms
step:1601/1750 train_loss:3.2645 train_time:1145181ms step_avg:719.79ms
step:1602/1750 train_loss:3.3367 train_time:1145942ms step_avg:719.81ms
step:1603/1750 train_loss:3.2387 train_time:1146692ms step_avg:719.83ms
step:1604/1750 train_loss:3.1476 train_time:1147489ms step_avg:719.88ms
step:1605/1750 train_loss:3.3167 train_time:1148267ms step_avg:719.92ms
step:1606/1750 train_loss:3.1052 train_time:1149066ms step_avg:719.97ms
step:1607/1750 train_loss:3.3168 train_time:1149823ms step_avg:719.99ms
step:1608/1750 train_loss:3.1829 train_time:1150597ms step_avg:720.02ms
step:1609/1750 train_loss:3.2792 train_time:1151351ms step_avg:720.04ms
step:1610/1750 train_loss:3.3012 train_time:1152154ms step_avg:720.10ms
step:1611/1750 train_loss:3.1506 train_time:1152908ms step_avg:720.12ms
step:1612/1750 train_loss:3.2888 train_time:1153728ms step_avg:720.18ms
step:1613/1750 train_loss:3.2782 train_time:1154485ms step_avg:720.20ms
step:1614/1750 train_loss:3.1161 train_time:1155336ms step_avg:720.28ms
step:1615/1750 train_loss:3.3711 train_time:1156143ms step_avg:720.34ms
step:1616/1750 train_loss:3.3344 train_time:1156915ms step_avg:720.37ms
step:1617/1750 train_loss:3.2987 train_time:1157674ms step_avg:720.39ms
step:1618/1750 train_loss:3.2104 train_time:1158456ms step_avg:720.43ms
step:1619/1750 train_loss:3.4025 train_time:1159219ms step_avg:720.46ms
step:1620/1750 train_loss:3.3586 train_time:1159971ms step_avg:720.48ms
step:1621/1750 train_loss:3.2801 train_time:1160735ms step_avg:720.51ms
step:1622/1750 train_loss:3.5277 train_time:1161493ms step_avg:720.53ms
step:1623/1750 train_loss:3.2347 train_time:1162261ms step_avg:720.56ms
step:1624/1750 train_loss:3.5240 train_time:1163063ms step_avg:720.61ms
step:1625/1750 train_loss:3.2725 train_time:1163817ms step_avg:720.63ms
step:1625/1750 val_loss:3.2956 train_time:1163829ms step_avg:720.64ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | frobenius_norm = 68337.07031 | spectral_norm = 12105.04492 | nuclear_norm = 1721989.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 189.53499 | spectral_norm = 34.32002 | nuclear_norm = 4337.20996
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 182.75647 | spectral_norm = 39.56429 | nuclear_norm = 4159.38428
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 242.99994 | spectral_norm = 16.12064 | nuclear_norm = 5896.72266
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 176.77145 | spectral_norm = 21.44722 | nuclear_norm = 4085.00732
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 407.11136 | spectral_norm = 32.44102 | nuclear_norm = 10849.49414
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 212.42749 | spectral_norm = 23.73272 | nuclear_norm = 5633.79688
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 192.71887 | spectral_norm = 19.91828 | nuclear_norm = 4436.79492
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 189.73891 | spectral_norm = 19.33364 | nuclear_norm = 4383.46875
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 190.94727 | spectral_norm = 15.96904 | nuclear_norm = 4413.27832
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 187.98709 | spectral_norm = 15.31403 | nuclear_norm = 4367.39746
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 418.18033 | spectral_norm = 30.30085 | nuclear_norm = 11189.77734
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 209.83951 | spectral_norm = 24.31586 | nuclear_norm = 5545.99121
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 192.15962 | spectral_norm = 19.51795 | nuclear_norm = 4403.66113
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 188.19353 | spectral_norm = 19.19478 | nuclear_norm = 4315.92285
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 230.65021 | spectral_norm = 20.58150 | nuclear_norm = 5255.74756
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 222.43614 | spectral_norm = 16.08882 | nuclear_norm = 5296.12109
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 403.37476 | spectral_norm = 33.05604 | nuclear_norm = 10782.71289
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 202.54071 | spectral_norm = 20.14982 | nuclear_norm = 5347.71387
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 187.29207 | spectral_norm = 20.83831 | nuclear_norm = 4221.92578
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 186.73718 | spectral_norm = 18.11949 | nuclear_norm = 4216.97412
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 232.37250 | spectral_norm = 21.02613 | nuclear_norm = 5246.00537
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 228.12563 | spectral_norm = 20.18301 | nuclear_norm = 5270.80078
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 412.37827 | spectral_norm = 37.92541 | nuclear_norm = 11011.29883
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 202.75812 | spectral_norm = 21.00831 | nuclear_norm = 5314.83203
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 185.91098 | spectral_norm = 22.93039 | nuclear_norm = 4177.00586
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 184.61334 | spectral_norm = 20.50897 | nuclear_norm = 4216.17383
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 218.84573 | spectral_norm = 19.17789 | nuclear_norm = 4860.53662
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 218.14845 | spectral_norm = 17.48236 | nuclear_norm = 4993.06055
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 409.01538 | spectral_norm = 40.55792 | nuclear_norm = 10824.86621
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 203.34915 | spectral_norm = 21.61761 | nuclear_norm = 5315.74121
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 178.72678 | spectral_norm = 18.90104 | nuclear_norm = 3853.80737
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 181.27042 | spectral_norm = 17.98701 | nuclear_norm = 3954.71484
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 221.20103 | spectral_norm = 20.71996 | nuclear_norm = 4931.55420
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 222.64275 | spectral_norm = 18.97595 | nuclear_norm = 5126.71924
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 441.81348 | spectral_norm = 39.04768 | nuclear_norm = 11726.71191
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 201.53963 | spectral_norm = 23.17157 | nuclear_norm = 5288.60449
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 184.07259 | spectral_norm = 19.59860 | nuclear_norm = 4092.64160
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 182.41962 | spectral_norm = 18.69088 | nuclear_norm = 4077.42480
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 230.41951 | spectral_norm = 22.96729 | nuclear_norm = 5137.54639
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 233.73070 | spectral_norm = 19.11131 | nuclear_norm = 5467.08203
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 437.47260 | spectral_norm = 36.67942 | nuclear_norm = 11662.88281
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 205.74936 | spectral_norm = 24.33444 | nuclear_norm = 5394.83545
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 184.48169 | spectral_norm = 18.79026 | nuclear_norm = 4066.06299
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 184.43887 | spectral_norm = 17.37070 | nuclear_norm = 4098.21973
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 238.75568 | spectral_norm = 22.15070 | nuclear_norm = 5309.42188
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 239.20824 | spectral_norm = 18.97137 | nuclear_norm = 5600.12109
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 424.97070 | spectral_norm = 38.26353 | nuclear_norm = 11268.46289
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 207.88440 | spectral_norm = 23.98911 | nuclear_norm = 5489.97754
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 190.69598 | spectral_norm = 19.67983 | nuclear_norm = 4221.52832
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 190.66740 | spectral_norm = 21.32374 | nuclear_norm = 4175.74854
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 255.62213 | spectral_norm = 27.29726 | nuclear_norm = 5603.67480
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 247.14044 | spectral_norm = 18.40068 | nuclear_norm = 5781.53076
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 423.62860 | spectral_norm = 40.34593 | nuclear_norm = 11238.99219
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 215.05086 | spectral_norm = 22.79218 | nuclear_norm = 5695.42871
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 185.51021 | spectral_norm = 22.44650 | nuclear_norm = 4108.83105
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 185.36929 | spectral_norm = 21.40332 | nuclear_norm = 4178.07715
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 248.13777 | spectral_norm = 22.91780 | nuclear_norm = 5491.14062
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 235.16328 | spectral_norm = 20.79004 | nuclear_norm = 5255.38232
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 425.07043 | spectral_norm = 38.90156 | nuclear_norm = 11248.57812
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 210.09442 | spectral_norm = 22.66568 | nuclear_norm = 5562.91992
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 188.27576 | spectral_norm = 24.10654 | nuclear_norm = 4094.08081
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 190.69786 | spectral_norm = 21.37678 | nuclear_norm = 4104.35352
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 190.11395 | spectral_norm = 20.89004 | nuclear_norm = 4353.46484
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 223.33890 | spectral_norm = 15.76727 | nuclear_norm = 5273.52930
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 460.77573 | spectral_norm = 34.88497 | nuclear_norm = 12274.69336
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 208.21219 | spectral_norm = 26.92954 | nuclear_norm = 5503.31299
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 194.78229 | spectral_norm = 26.00306 | nuclear_norm = 4274.21143
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 190.29666 | spectral_norm = 24.24245 | nuclear_norm = 4158.89355
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 257.19116 | spectral_norm = 27.35390 | nuclear_norm = 5798.86719
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 266.46164 | spectral_norm = 19.09844 | nuclear_norm = 6231.55469
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 435.38171 | spectral_norm = 35.02934 | nuclear_norm = 11558.51758
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 208.10863 | spectral_norm = 28.78236 | nuclear_norm = 5440.63477
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1321.40979 | spectral_norm = 167.44244 | nuclear_norm = 34920.97656
===========================================
step:1626/1750 train_loss:3.3465 train_time:1164555ms step_avg:720.64ms
step:1627/1750 train_loss:3.3731 train_time:1165313ms step_avg:720.66ms
step:1628/1750 train_loss:3.3936 train_time:1166060ms step_avg:720.68ms
step:1629/1750 train_loss:3.2401 train_time:1166821ms step_avg:720.70ms
step:1630/1750 train_loss:3.3062 train_time:1167585ms step_avg:720.73ms
step:1631/1750 train_loss:3.2659 train_time:1168342ms step_avg:720.75ms
step:1632/1750 train_loss:3.1666 train_time:1169102ms step_avg:720.78ms
step:1633/1750 train_loss:3.2857 train_time:1169853ms step_avg:720.80ms
step:1634/1750 train_loss:3.2909 train_time:1170606ms step_avg:720.82ms
step:1635/1750 train_loss:3.2768 train_time:1171379ms step_avg:720.85ms
step:1636/1750 train_loss:3.3616 train_time:1172133ms step_avg:720.87ms
step:1637/1750 train_loss:3.6329 train_time:1172904ms step_avg:720.90ms
step:1638/1750 train_loss:3.2563 train_time:1173726ms step_avg:720.96ms
step:1639/1750 train_loss:3.2279 train_time:1174495ms step_avg:720.99ms
step:1640/1750 train_loss:3.2492 train_time:1175261ms step_avg:721.02ms
step:1641/1750 train_loss:3.3566 train_time:1175998ms step_avg:721.03ms
step:1642/1750 train_loss:3.3149 train_time:1176755ms step_avg:721.05ms
step:1643/1750 train_loss:3.2942 train_time:1177534ms step_avg:721.09ms
step:1644/1750 train_loss:3.2092 train_time:1178284ms step_avg:721.10ms
step:1645/1750 train_loss:3.2023 train_time:1179051ms step_avg:721.13ms
step:1646/1750 train_loss:3.2909 train_time:1179817ms step_avg:721.16ms
step:1647/1750 train_loss:3.1606 train_time:1180610ms step_avg:721.20ms
step:1648/1750 train_loss:3.3230 train_time:1181366ms step_avg:721.22ms
step:1649/1750 train_loss:3.3555 train_time:1182115ms step_avg:721.24ms
step:1650/1750 train_loss:3.2392 train_time:1182879ms step_avg:721.27ms
step:1651/1750 train_loss:3.3286 train_time:1183638ms step_avg:721.29ms
step:1652/1750 train_loss:3.2893 train_time:1184411ms step_avg:721.32ms
step:1653/1750 train_loss:3.2317 train_time:1185158ms step_avg:721.34ms
step:1654/1750 train_loss:3.3582 train_time:1185922ms step_avg:721.36ms
step:1655/1750 train_loss:3.1952 train_time:1186677ms step_avg:721.38ms
step:1656/1750 train_loss:2.9770 train_time:1187458ms step_avg:721.42ms
step:1657/1750 train_loss:3.3088 train_time:1188214ms step_avg:721.44ms
step:1658/1750 train_loss:3.3300 train_time:1188970ms step_avg:721.46ms
step:1659/1750 train_loss:3.2752 train_time:1189732ms step_avg:721.49ms
step:1660/1750 train_loss:3.5299 train_time:1190527ms step_avg:721.53ms
step:1661/1750 train_loss:3.3637 train_time:1191292ms step_avg:721.56ms
step:1662/1750 train_loss:3.3409 train_time:1192052ms step_avg:721.58ms
step:1663/1750 train_loss:3.3090 train_time:1192823ms step_avg:721.61ms
step:1664/1750 train_loss:3.3420 train_time:1193578ms step_avg:721.63ms
step:1665/1750 train_loss:3.1620 train_time:1194343ms step_avg:721.66ms
step:1666/1750 train_loss:3.3204 train_time:1195101ms step_avg:721.68ms
step:1667/1750 train_loss:3.1070 train_time:1195869ms step_avg:721.71ms
step:1668/1750 train_loss:3.2724 train_time:1196628ms step_avg:721.73ms
step:1669/1750 train_loss:3.3069 train_time:1197384ms step_avg:721.75ms
step:1670/1750 train_loss:3.1181 train_time:1198144ms step_avg:721.77ms
step:1671/1750 train_loss:3.2753 train_time:1198971ms step_avg:721.84ms
step:1672/1750 train_loss:3.1682 train_time:1199747ms step_avg:721.87ms
step:1673/1750 train_loss:3.4544 train_time:1200513ms step_avg:721.90ms
step:1674/1750 train_loss:3.3192 train_time:1201270ms step_avg:721.92ms
step:1675/1750 train_loss:3.2898 train_time:1202024ms step_avg:721.94ms
step:1676/1750 train_loss:3.1669 train_time:1202794ms step_avg:721.97ms
step:1677/1750 train_loss:3.2284 train_time:1203574ms step_avg:722.00ms
step:1678/1750 train_loss:3.5730 train_time:1204334ms step_avg:722.02ms
step:1679/1750 train_loss:3.2937 train_time:1205097ms step_avg:722.05ms
step:1680/1750 train_loss:3.2773 train_time:1205863ms step_avg:722.07ms
step:1681/1750 train_loss:3.4080 train_time:1206628ms step_avg:722.10ms
step:1682/1750 train_loss:3.3276 train_time:1207394ms step_avg:722.13ms
step:1683/1750 train_loss:3.2441 train_time:1208185ms step_avg:722.17ms
step:1684/1750 train_loss:3.3359 train_time:1208947ms step_avg:722.19ms
step:1685/1750 train_loss:3.1629 train_time:1209707ms step_avg:722.21ms
step:1686/1750 train_loss:3.3324 train_time:1210472ms step_avg:722.24ms
step:1687/1750 train_loss:3.2273 train_time:1211283ms step_avg:722.29ms
step:1688/1750 train_loss:3.0473 train_time:1212053ms step_avg:722.32ms
step:1689/1750 train_loss:3.3662 train_time:1212846ms step_avg:722.36ms
step:1690/1750 train_loss:3.3197 train_time:1213609ms step_avg:722.39ms
step:1691/1750 train_loss:3.3131 train_time:1214380ms step_avg:722.42ms
step:1692/1750 train_loss:3.2158 train_time:1215210ms step_avg:722.48ms
step:1693/1750 train_loss:3.2122 train_time:1215979ms step_avg:722.51ms
step:1694/1750 train_loss:3.3084 train_time:1216745ms step_avg:722.53ms
step:1695/1750 train_loss:3.2286 train_time:1217508ms step_avg:722.56ms
step:1696/1750 train_loss:3.3183 train_time:1218283ms step_avg:722.59ms
step:1697/1750 train_loss:3.2722 train_time:1219064ms step_avg:722.62ms
step:1698/1750 train_loss:3.3747 train_time:1219826ms step_avg:722.65ms
step:1699/1750 train_loss:3.2022 train_time:1220614ms step_avg:722.68ms
step:1700/1750 train_loss:3.2628 train_time:1221385ms step_avg:722.71ms
step:1701/1750 train_loss:3.1848 train_time:1222141ms step_avg:722.73ms
step:1702/1750 train_loss:3.1987 train_time:1222912ms step_avg:722.76ms
step:1703/1750 train_loss:3.2922 train_time:1223665ms step_avg:722.78ms
step:1704/1750 train_loss:3.3102 train_time:1224424ms step_avg:722.80ms
step:1705/1750 train_loss:3.2761 train_time:1225177ms step_avg:722.82ms
step:1706/1750 train_loss:3.3161 train_time:1225950ms step_avg:722.85ms
step:1707/1750 train_loss:3.2651 train_time:1226729ms step_avg:722.88ms
step:1708/1750 train_loss:3.4257 train_time:1227491ms step_avg:722.90ms
step:1709/1750 train_loss:3.1342 train_time:1228251ms step_avg:722.93ms
step:1710/1750 train_loss:3.2315 train_time:1229203ms step_avg:723.06ms
step:1711/1750 train_loss:3.2276 train_time:1229993ms step_avg:723.10ms
step:1712/1750 train_loss:3.2337 train_time:1230752ms step_avg:723.12ms
step:1713/1750 train_loss:3.7028 train_time:1231549ms step_avg:723.16ms
step:1714/1750 train_loss:3.2775 train_time:1232343ms step_avg:723.21ms
step:1715/1750 train_loss:3.2845 train_time:1233105ms step_avg:723.23ms
step:1716/1750 train_loss:3.3118 train_time:1233865ms step_avg:723.25ms
step:1717/1750 train_loss:3.3352 train_time:1234625ms step_avg:723.27ms
step:1718/1750 train_loss:3.2270 train_time:1235397ms step_avg:723.30ms
step:1719/1750 train_loss:3.2804 train_time:1236188ms step_avg:723.34ms
step:1720/1750 train_loss:3.0940 train_time:1236952ms step_avg:723.36ms
step:1721/1750 train_loss:3.2458 train_time:1237705ms step_avg:723.38ms
step:1722/1750 train_loss:3.2581 train_time:1238458ms step_avg:723.40ms
step:1723/1750 train_loss:3.2091 train_time:1239212ms step_avg:723.42ms
step:1724/1750 train_loss:3.3763 train_time:1239983ms step_avg:723.44ms
step:1725/1750 train_loss:3.1625 train_time:1240802ms step_avg:723.50ms
step:1726/1750 train_loss:3.3130 train_time:1241598ms step_avg:723.54ms
step:1727/1750 train_loss:3.4052 train_time:1242358ms step_avg:723.56ms
step:1728/1750 train_loss:3.2594 train_time:1243130ms step_avg:723.59ms
step:1729/1750 train_loss:3.4847 train_time:1243919ms step_avg:723.63ms
step:1730/1750 train_loss:3.2585 train_time:1244693ms step_avg:723.66ms
step:1731/1750 train_loss:3.3250 train_time:1245446ms step_avg:723.68ms
step:1732/1750 train_loss:3.2938 train_time:1246211ms step_avg:723.70ms
step:1733/1750 train_loss:3.2713 train_time:1246980ms step_avg:723.73ms
step:1734/1750 train_loss:3.6502 train_time:1247771ms step_avg:723.76ms
step:1735/1750 train_loss:3.2967 train_time:1248540ms step_avg:723.79ms
step:1736/1750 train_loss:3.4251 train_time:1249311ms step_avg:723.82ms
step:1737/1750 train_loss:3.2037 train_time:1250095ms step_avg:723.85ms
step:1738/1750 train_loss:3.2481 train_time:1250864ms step_avg:723.88ms
step:1739/1750 train_loss:3.2738 train_time:1251613ms step_avg:723.89ms
step:1740/1750 train_loss:3.2554 train_time:1252381ms step_avg:723.92ms
step:1741/1750 train_loss:3.3794 train_time:1253138ms step_avg:723.94ms
step:1742/1750 train_loss:3.2156 train_time:1253913ms step_avg:723.97ms
step:1743/1750 train_loss:3.2852 train_time:1254700ms step_avg:724.00ms
step:1744/1750 train_loss:3.3718 train_time:1255452ms step_avg:724.02ms
step:1745/1750 train_loss:3.1599 train_time:1256221ms step_avg:724.05ms
step:1746/1750 train_loss:3.0625 train_time:1256983ms step_avg:724.07ms
step:1747/1750 train_loss:2.9505 train_time:1257797ms step_avg:724.12ms
step:1748/1750 train_loss:3.2901 train_time:1258561ms step_avg:724.14ms
step:1749/1750 train_loss:3.3120 train_time:1259308ms step_avg:724.16ms
step:1750/1750 train_loss:3.2699 train_time:1260064ms step_avg:724.17ms
step:1750/1750 val_loss:3.2741 train_time:1260076ms step_avg:724.18ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | frobenius_norm = 68343.33594 | spectral_norm = 12109.80664 | nuclear_norm = 1722244.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 189.48195 | spectral_norm = 34.53418 | nuclear_norm = 4334.16699
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 182.80782 | spectral_norm = 39.70914 | nuclear_norm = 4159.33594
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 243.43832 | spectral_norm = 16.11841 | nuclear_norm = 5908.93457
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 176.72865 | spectral_norm = 21.47893 | nuclear_norm = 4083.22412
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 407.70819 | spectral_norm = 32.52895 | nuclear_norm = 10865.89160
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 212.71306 | spectral_norm = 23.77849 | nuclear_norm = 5641.66992
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 192.88655 | spectral_norm = 19.95603 | nuclear_norm = 4439.77393
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 189.95114 | spectral_norm = 19.37060 | nuclear_norm = 4387.91455
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 191.23717 | spectral_norm = 15.98780 | nuclear_norm = 4420.57227
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 188.27589 | spectral_norm = 15.33094 | nuclear_norm = 4375.22412
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 418.75897 | spectral_norm = 30.34900 | nuclear_norm = 11205.75586
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 210.09796 | spectral_norm = 24.36202 | nuclear_norm = 5553.15820
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 192.37175 | spectral_norm = 19.58144 | nuclear_norm = 4407.57178
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 188.43076 | spectral_norm = 19.23972 | nuclear_norm = 4321.03662
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 231.07532 | spectral_norm = 20.61425 | nuclear_norm = 5266.26758
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 222.80099 | spectral_norm = 16.11856 | nuclear_norm = 5305.87500
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 403.90350 | spectral_norm = 33.10436 | nuclear_norm = 10797.05664
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 202.76859 | spectral_norm = 20.19057 | nuclear_norm = 5353.88086
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 187.43843 | spectral_norm = 20.88778 | nuclear_norm = 4223.67871
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 186.91600 | spectral_norm = 18.15525 | nuclear_norm = 4219.97070
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 232.95598 | spectral_norm = 21.04806 | nuclear_norm = 5260.99561
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 228.64514 | spectral_norm = 20.20576 | nuclear_norm = 5284.33154
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 412.83078 | spectral_norm = 37.97357 | nuclear_norm = 11023.75195
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 202.99062 | spectral_norm = 21.05706 | nuclear_norm = 5321.05078
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 186.08519 | spectral_norm = 22.99289 | nuclear_norm = 4179.43359
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 184.79810 | spectral_norm = 20.57428 | nuclear_norm = 4219.82324
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 219.44608 | spectral_norm = 19.23365 | nuclear_norm = 4876.07080
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 218.70024 | spectral_norm = 17.51355 | nuclear_norm = 5007.63525
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 409.43320 | spectral_norm = 40.63182 | nuclear_norm = 10834.47461
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 203.51566 | spectral_norm = 21.67211 | nuclear_norm = 5319.21777
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 178.81277 | spectral_norm = 18.93649 | nuclear_norm = 3852.33643
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 181.36314 | spectral_norm = 18.02569 | nuclear_norm = 3953.42822
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 221.79294 | spectral_norm = 20.77107 | nuclear_norm = 4946.47949
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 223.20503 | spectral_norm = 19.04060 | nuclear_norm = 5141.56201
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 442.28592 | spectral_norm = 39.14488 | nuclear_norm = 11738.04492
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 201.74565 | spectral_norm = 23.23242 | nuclear_norm = 5294.06250
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 184.23579 | spectral_norm = 19.65384 | nuclear_norm = 4094.00586
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 182.60335 | spectral_norm = 18.72941 | nuclear_norm = 4079.76660
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 231.00227 | spectral_norm = 22.97570 | nuclear_norm = 5153.27246
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 234.26816 | spectral_norm = 19.14860 | nuclear_norm = 5480.78613
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 438.08627 | spectral_norm = 36.76158 | nuclear_norm = 11679.11621
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 205.97011 | spectral_norm = 24.39721 | nuclear_norm = 5400.24902
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 184.62216 | spectral_norm = 18.84374 | nuclear_norm = 4065.95337
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 184.59358 | spectral_norm = 17.40478 | nuclear_norm = 4099.31543
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 239.32817 | spectral_norm = 22.19087 | nuclear_norm = 5323.87549
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 239.67612 | spectral_norm = 19.02205 | nuclear_norm = 5610.95557
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 425.46866 | spectral_norm = 38.35299 | nuclear_norm = 11280.08008
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 208.05641 | spectral_norm = 24.02691 | nuclear_norm = 5494.22949
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 190.83569 | spectral_norm = 19.71749 | nuclear_norm = 4221.52637
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 190.82732 | spectral_norm = 21.34824 | nuclear_norm = 4175.76025
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 256.44687 | spectral_norm = 27.39675 | nuclear_norm = 5622.53418
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 247.68483 | spectral_norm = 18.45709 | nuclear_norm = 5793.58398
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 424.11304 | spectral_norm = 40.46429 | nuclear_norm = 11250.55859
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 215.25764 | spectral_norm = 22.82132 | nuclear_norm = 5700.68945
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 185.67787 | spectral_norm = 22.52521 | nuclear_norm = 4110.22363
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 185.55560 | spectral_norm = 21.45099 | nuclear_norm = 4180.87451
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 248.88928 | spectral_norm = 22.96033 | nuclear_norm = 5510.54736
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 235.80055 | spectral_norm = 20.84888 | nuclear_norm = 5270.03955
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 425.49149 | spectral_norm = 38.97792 | nuclear_norm = 11257.96094
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 210.26602 | spectral_norm = 22.70036 | nuclear_norm = 5567.10303
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 188.42072 | spectral_norm = 24.18347 | nuclear_norm = 4092.84888
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 190.87306 | spectral_norm = 21.40270 | nuclear_norm = 4103.33545
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 190.68120 | spectral_norm = 20.98791 | nuclear_norm = 4365.82764
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 223.69426 | spectral_norm = 15.81583 | nuclear_norm = 5281.68066
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 461.09818 | spectral_norm = 34.96083 | nuclear_norm = 12282.39844
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 208.46245 | spectral_norm = 26.92803 | nuclear_norm = 5510.01318
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 194.93628 | spectral_norm = 26.11817 | nuclear_norm = 4274.26025
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 190.40295 | spectral_norm = 24.34606 | nuclear_norm = 4156.71533
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 258.29980 | spectral_norm = 27.47836 | nuclear_norm = 5823.84863
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 267.15579 | spectral_norm = 19.17312 | nuclear_norm = 6246.67871
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 435.47723 | spectral_norm = 35.03179 | nuclear_norm = 11559.95898
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 208.32990 | spectral_norm = 28.79043 | nuclear_norm = 5446.04199
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1318.97461 | spectral_norm = 165.82248 | nuclear_norm = 34875.80469
===========================================

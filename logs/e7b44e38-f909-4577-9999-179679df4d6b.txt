====================================================================================================
import os
import sys
with open(sys.argv[0]) as f:
    code = f.read() # read the code of this file ASAP, for logging
import uuid
import glob
import time
from dataclasses import dataclass

import numpy as np
import torch
from torch import nn
import torch.nn.functional as F
import torch.distributed as dist
import torch._inductor.config as config
from torch.nn.parallel import DistributedDataParallel as DDP
# Use of FlexAttention contributed by @KoszarskyB
from torch.nn.attention.flex_attention import flex_attention, create_block_mask, BlockMask, _score_mod_signature
from torch._inductor.lowering import make_pointwise, register_lowering
# Some internal torch.compile details
from torch._inductor.virtualized import ops
from functools import partial
flex_attention = torch.compile(flex_attention, dynamic=False)
create_block_mask = torch.compile(create_block_mask, dynamic=False)

# -----------------------------------------------------------------------------
# Muon optimizer

def zeropower_via_svd(G, steps=None):
    U, S, V = G.svd()
    return U @ V.T

@torch.compile
def zeropower_via_newtonschulz5(G, steps=10, eps=1e-7):
    """
    Newton-Schulz iteration to compute the zeroth power / orthogonalization of G. We opt to use a
    quintic iteration whose coefficients are selected to maximize the slope at zero. For the purpose
    of minimizing steps, it turns out to be empirically effective to keep increasing the slope at
    zero even beyond the point where the iteration no longer converges all the way to one everywhere
    on the interval. This iteration therefore does not produce UV^T but rather something like US'V^T
    where S' is diagonal with S_{ii}' ~ Uniform(0.5, 1.5), which turns out not to hurt model
    performance at all relative to UV^T, where USV^T = G is the SVD.
    """
    assert len(G.shape) == 2
    a, b, c = (3.4445, -4.7750,  2.0315)
    X = G.bfloat16()
    X /= (X.norm() + eps) # ensure top singular value <= 1
    if G.size(0) > G.size(1):
        X = X.T
    for _ in range(steps):
        A = X @ X.T
        B = b * A + c * A @ A # adapted from suggestion by @jxbz, @leloykun, and @YouJiacheng
        X = a * X + B @ X
    if G.size(0) > G.size(1):
        X = X.T
    return X

zeropower_backends = dict(svd=zeropower_via_svd, newtonschulz5=zeropower_via_newtonschulz5)

class Muon(torch.optim.Optimizer):
    """
    Muon - MomentUm Orthogonalized by Newton-schulz

    Muon internally runs standard SGD-momentum, and then performs an orthogonalization post-
    processing step, in which each 2D parameter's update is replaced with the nearest orthogonal
    matrix. To efficiently orthogonalize each update, we use a Newton-Schulz iteration, which has
    the advantage that it can be stably run in bfloat16 on the GPU.

    Some warnings:
    - This optimizer assumes that all parameters passed in are 2D.
    - It should not be used for the embedding layer, the final fully connected layer, or any {0,1}-D
    parameters; those should all be optimized by a standard method (e.g., AdamW).
    - To use it with 4D convolutional filters, it works well to just flatten their last 3 dimensions.
    - We believe it is unlikely to work well for training with small batch size.
    - We believe it may not work well for finetuning pretrained models, but we haven't tested this.
    - We have not yet tried this optimizer for training scenarios larger than NanoGPT (124M).

    Arguments:
        lr: The learning rate used by the internal SGD.
        momentum: The momentum used by the internal SGD.
        nesterov: Whether to use Nesterov-style momentum in the internal SGD. (recommended)
        backend: The chosen backend for the orthogonalization step. (recommended: 'newtonschulz5')
        backend_steps: The number of iteration steps to use in the backend, if it is iterative.
    """
    def __init__(self, params, lr=0.02, momentum=0.95, nesterov=True,
                 backend='newtonschulz5', backend_steps=5):
        defaults = dict(lr=lr, momentum=momentum, nesterov=nesterov, backend=backend, backend_steps=backend_steps)
        super().__init__(params, defaults)

    def step(self):

        for group in self.param_groups:

            lr = group['lr']
            momentum = group['momentum']
            zeropower_backend = zeropower_backends[group['backend']]

            # generate weight updates in distributed fashion
            total_params = sum(p.numel() for p in group['params'])
            updates_flat = torch.zeros(total_params, device='cuda', dtype=torch.bfloat16)
            curr_idx = 0
            for i, p in enumerate(group['params']):
                # luckily this will perfectly distribute a transformer with multiple of 4 layers to 8 GPUs
                if i % int(os.environ['WORLD_SIZE']) == int(os.environ['RANK']):
                    g = p.grad
                    assert g is not None
                    state = self.state[p]
                    if 'momentum_buffer' not in state:
                        state['momentum_buffer'] = torch.zeros_like(g)
                    buf = state['momentum_buffer']
                    buf.mul_(momentum).add_(g)
                    if group['nesterov']:
                        g = g.add(buf, alpha=momentum)
                    g = zeropower_backend(g, steps=group['backend_steps'])
                    g *= max(1, g.size(0)/g.size(1))**0.5
                    updates_flat[curr_idx:curr_idx+p.numel()] = g.flatten()
                curr_idx += p.numel()

            # sync updates across devices. we are not memory-constrained so can do this simple deserialization
            dist.all_reduce(updates_flat, op=dist.ReduceOp.SUM)

            # deserialize and apply updates
            curr_idx = 0
            for p in group['params']:
                g = updates_flat[curr_idx:curr_idx+p.numel()].view_as(p.data).type_as(p.data)
                p.data.add_(g, alpha=-lr)
                curr_idx += p.numel()

# -----------------------------------------------------------------------------
# Attention Tanh softcapping

@torch.library.custom_op("approx::tanh", mutates_args=())
def _tanh_approx(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

@_tanh_approx.register_fake
def _(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

def _tanh_approx_lowering(inp):
    fn = partial(ops.inline_asm_elementwise, asm="tanh.approx.f32 $0, $1;")
    return make_pointwise(fn)(inp)

register_lowering(torch.ops.approx.tanh)(_tanh_approx_lowering)

class _TanhApprox(torch.autograd.Function):
    @staticmethod
    def forward(x):
        return torch.ops.approx.tanh(x)

    @staticmethod
    def setup_context(ctx, inputs, output):
        (x,) = inputs
        result = output
        ctx.save_for_backward(result)

    @staticmethod
    def backward(ctx, grad_output):
        (result,) = ctx.saved_tensors
        return grad_output * (1 - result * result)

    @staticmethod
    def vmap(info, in_dims, x):
        return torch.tanh(x), 0

_tanh_approx = _TanhApprox.apply

def generate_tanh_softcap(soft_cap: int, approx: bool=True) -> _score_mod_signature:
    tanh = _tanh_approx if approx else torch.tanh

    def tanh_softcap(score, b, h, q_idx, kv_idx):
        return soft_cap * tanh(score / soft_cap)

    prefix = "tanh_softcap_approx" if approx else "tanh_softcap"
    tanh_softcap.__name__ = f"{prefix}_{soft_cap}"

    return tanh_softcap

# -----------------------------------------------------------------------------
# PyTorch nn.Module definitions for the GPT-2 model

class Rotary(torch.nn.Module):

    def __init__(self, dim, base=10000):
        super().__init__()
        self.dim = dim
        self.base = base
        self.inv_freq = None
        self.seq_len_cached = None
        self.cos_cached = None
        self.sin_cached = None

    def forward(self, x):
        seq_len = x.shape[1]
        if seq_len != self.seq_len_cached:
            self.inv_freq = 1.0 / (self.base ** (torch.arange(0, self.dim, 2, device=x.device).float() / self.dim))
            self.seq_len_cached = seq_len
            t = torch.arange(seq_len, device=x.device).type_as(self.inv_freq)
            freqs = torch.outer(t, self.inv_freq)
            self.cos_cached = freqs.cos().bfloat16()
            self.sin_cached = freqs.sin().bfloat16()
        return self.cos_cached[None, :, None, :], self.sin_cached[None, :, None, :]

def apply_rotary_emb(x, cos, sin):
    assert x.ndim == 4 # multihead attention
    d = x.shape[3]//2
    x1 = x[..., :d]
    x2 = x[..., d:]
    y1 = x1 * cos + x2 * sin
    y2 = x1 * (-sin) + x2 * cos
    return torch.cat([y1, y2], 3).type_as(x)

class CastedLinear(nn.Linear):
    def forward(self, x):
        return F.linear(x, self.weight.to(x.dtype))

class CausalSelfAttention(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.n_head = config.n_head
        self.n_embd = config.n_embd
        self.head_dim = self.n_embd // self.n_head
        assert self.n_embd % self.n_head == 0
        self.c_q = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_k = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_v = CastedLinear(self.n_embd, self.n_embd, bias=False)
        # output projection
        self.c_proj = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977
        self.rotary = Rotary(self.head_dim)
        self.lamb = nn.Parameter(torch.tensor(0.5)) # @Grad62304977

    def forward(self, x, v1, block_mask: BlockMask, score_mod: _score_mod_signature):
        B, T, C = x.size() # batch size, sequence length, embedding dimensionality (n_embd)
        q = self.c_q(x).view(B, T, self.n_head, self.head_dim)
        k = self.c_k(x).view(B, T, self.n_head, self.head_dim)
        v = self.c_v(x).view(B, T, self.n_head, self.head_dim)
        if v1 is None:
            v1 = v # This happens if we are in the first block. v needs to be accessed by subsequent blocks
        v = (1 - self.lamb) * v + self.lamb * v1.view_as(v) # @Grad62304977
        cos, sin = self.rotary(q)
        q, k = F.rms_norm(q, (q.size(-1),)), F.rms_norm(k, (k.size(-1),)) # QK norm suggested by @Grad62304977
        q, k = apply_rotary_emb(q, cos, sin), apply_rotary_emb(k, cos, sin)
        y = flex_attention(q.transpose(1, 2), k.transpose(1, 2), v.transpose(1, 2), score_mod=score_mod, block_mask=block_mask)
        y = y.transpose(1, 2).contiguous().view_as(x) # re-assemble all head outputs side by side
        y = self.c_proj(y)
        return y, v1

class MLP(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.c_fc    = CastedLinear(config.n_embd, 4 * config.n_embd, bias=False)
        self.c_proj  = CastedLinear(4 * config.n_embd, config.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977

    def forward(self, x):
        x = self.c_fc(x)
        x = F.relu(x).square() # https://arxiv.org/abs/2109.08668v2; ~1-2% better than GELU; suggested by @SKYLINEZ007 and @Grad62304977
        x = self.c_proj(x)
        return x

class Block(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.attn = CausalSelfAttention(config)
        self.mlp = MLP(config)
        self.lambdas = nn.Parameter(torch.tensor([1., 0.]))

    def forward(self, x, v1, x0, block_mask: BlockMask, score_mod: _score_mod_signature):
        x = self.lambdas[0] * x + self.lambdas[1] * x0
        x1, v1 = self.attn(F.rms_norm(x, (x.size(-1),)), v1, block_mask, score_mod)
        x = x + x1
        x = x + self.mlp(F.rms_norm(x, (x.size(-1),)))
        return x, v1

# -----------------------------------------------------------------------------
# The main GPT-2 model

@dataclass
class GPTConfig:
    vocab_size : int = 50304
    n_layer : int = 12
    n_head : int = 6 # head dim 128 suggested by @Grad62304977
    n_embd : int = 768
    attention_soft_cap : int = 50
    lm_head_soft_cap : int = 30

class GPT(nn.Module):

    def __init__(self, config: GPTConfig):
        super().__init__()
        self.attention_soft_cap = config.attention_soft_cap
        self.lm_head_soft_cap = config.lm_head_soft_cap

        # U-net design by @brendanh0gan
        self.num_encoder_layers = config.n_layer // 2 # Half of the layers for encoder
        self.num_decoder_layers = config.n_layer - self.num_encoder_layers # Remaining for decoder
        # Add learnable skip connection weights for decoder layers
        self.skip_weights = nn.Parameter(torch.ones(self.num_decoder_layers))

        self.transformer = nn.ModuleDict(dict(
            wte = nn.Embedding(config.vocab_size, config.n_embd),
            h = nn.ModuleList([Block(config) for _ in range(config.n_layer)]),
        ))
        self.lm_head = CastedLinear(config.n_embd, config.vocab_size, bias=False)
        self.lm_head.weight.data.zero_() # @Grad62304977

    def forward(self, idx, target, attn_blocksize: int):

        docs = (idx == 50256).cumsum(0)
        def document_causal_mask(b, h, q_idx, kv_idx):
            causal_mask = q_idx >= kv_idx
            document_mask = docs[q_idx] == docs[kv_idx]
            window_mask = q_idx - kv_idx < attn_blocksize
            return causal_mask & document_mask & window_mask

        # softcap_mod = generate_tanh_softcap(self.attention_soft_cap, approx=True)  # @leloykun
        softcap_mod = None

        S = len(idx)
        block_mask = create_block_mask(document_causal_mask, None, None, S, S, device="cuda", _compile=True)

        # forward the GPT model itself
        x = self.transformer.wte(idx[None]) # token embeddings of shape (b, t, n_embd)
        x = F.rms_norm(x, (x.size(-1),)) # @Grad62304977
        x0 = x
        v1 = None

        # Store outputs for U-Net skip connections
        skip_connections = []
        # Encoder pass - process only the first half of the blocks
        for i in range(self.num_encoder_layers):
            x, v1 = self.transformer.h[i](x, v1, x0, block_mask, softcap_mod)
            skip_connections.append(x)
        # Decoder pass - process the remaining blocks with weighted skip connections
        for i in range(self.num_decoder_layers):
            x = x + self.skip_weights[i] * skip_connections.pop()
            x, v1 = self.transformer.h[self.num_encoder_layers + i](x, v1, x0, block_mask, softcap_mod)

        x = F.rms_norm(x, (x.size(-1),))
        logits = self.lm_head(x)
        logits = self.lm_head_soft_cap * torch.tanh(logits / self.lm_head_soft_cap) # @Grad62304977
        logits = logits.float()
        loss = F.cross_entropy(logits.view(-1, logits.size(-1)), target.view(-1))
        return loss

# -----------------------------------------------------------------------------
# Our own simple Distributed Data Loader

def _peek_data_shard(filename):
    # only reads the header, returns header data
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
    if header[0] != 20240520:
        print("ERROR: magic number mismatch in the data .bin file!")
        print("---> HINT: Are you passing in a correct file with --input_bin?")
        print("---> HINT: Dataset encoding changed recently, re-run data prepro or refer again to README")
        print("---> HINT: For example re-run: `python dev/data/tinyshakespeare.py`, then re-try")
        exit(1)
    assert header[1] == 1, "unsupported version"
    ntok = header[2] # number of tokens (claimed)
    return ntok # for now just return the number of tokens

def _load_data_shard(filename):
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
        assert header[0] == 20240520, "magic number mismatch in the data .bin file"
        assert header[1] == 1, "unsupported version"
        ntok = header[2] # number of tokens (claimed)
        # the rest of it are tokens, stored as uint16
        tokens = np.frombuffer(f.read(), dtype=np.uint16)
    assert len(tokens) == ntok, "number of tokens read does not match header?"
    return tokens

class DistributedDataLoader:
    def __init__(self, filename_pattern, B, T, process_rank, num_processes):
        self.process_rank = process_rank
        self.num_processes = num_processes
        self.B = B
        self.T = T

        # glob files that match the pattern
        self.files = sorted(glob.glob(filename_pattern))
        assert len(self.files) > 0, f"did not find any files that match the pattern {filename_pattern}"

        # load and validate all data shards, count number of tokens in total
        ntok_total = 0
        for fname in self.files:
            shard_ntok = _peek_data_shard(fname)
            assert shard_ntok >= num_processes * B * T + 1
            ntok_total += int(shard_ntok)
        self.ntok_total = ntok_total

        self.reset()

    def reset(self):
        self.current_shard = -1
        self.advance()

    def advance(self): # advance to next data shard
        self.current_shard = (self.current_shard + 1) % len(self.files)
        self.current_position = self.process_rank * self.B * self.T
        self.tokens = _load_data_shard(self.files[self.current_shard])

    def next_batch(self):
        batch_size = self.B * self.T * self.num_processes
        buf = self.tokens[self.current_position:self.current_position+self.B*self.T+1]
        buf = torch.tensor(buf.astype(np.int32), dtype=torch.long)
        x = buf[:-1] # inputs
        y = buf[1:] # targets
        # advance current position and load next shard if necessary
        self.current_position += batch_size
        if self.current_position + batch_size >= len(self.tokens):
            self.advance()
        return x.cuda(), y.cuda()

# -----------------------------------------------------------------------------
# int main

@dataclass
class Hyperparameters:
    # data hyperparams
    input_bin : str = 'data/fineweb10B/fineweb_train_*.bin' # input .bin to train on
    input_val_bin : str = 'data/fineweb10B/fineweb_val_*.bin' # input .bin to eval validation loss on
    # optimization hyperparams
    batch_size : int = 8 # batch size, in sequences, across all devices
    device_batch_size : int = 1 # batch size, in sequences, per device
    sequence_length : int = 64*1024 # sequence length, in tokens
    num_iterations : int = 1750 # number of iterations to run
    warmup_iters : int = 0
    cooldown_iters : int = 640 # number of iterations of linear warmup/cooldown for triangular or trapezoidal schedule
    weight_decay : float = 0
    # evaluation and logging hyperparams
    val_loss_every : int = 125 # every how many steps to evaluate val loss? 0 for only at the end
    val_tokens : int = 10485760 # how many tokens of validation data? it's important to keep this fixed for consistent comparisons
    save_every : int = 0 # every how many steps to save the checkpoint? 0 for only at the end
args = Hyperparameters()

# set up DDP (distributed data parallel). torchrun sets this env variable
assert torch.cuda.is_available()
dist.init_process_group(backend='nccl')
ddp_rank = int(os.environ['RANK'])
ddp_local_rank = int(os.environ['LOCAL_RANK'])
ddp_world_size = int(os.environ['WORLD_SIZE'])
device = f'cuda:{ddp_local_rank}'
torch.cuda.set_device(device)
print(f"using device: {device}")
master_process = (ddp_rank == 0) # this process will do logging, checkpointing etc.

# begin logging
logfile = None
if master_process:
    run_id = str(uuid.uuid4())
    logdir = 'logs/%s/' % run_id
    os.makedirs(logdir, exist_ok=True)
    logfile = 'logs/%s.txt' % run_id
    # create the log file
    with open(logfile, "w") as f:
        # begin the log by printing this file (the Python code)
        f.write('='*100 + '\n')
        f.write(code)
        f.write('='*100 + '\n')
def print0(s, logonly=False):
    if master_process:
        with open(logfile, "a") as f:
            if not logonly:
                print(s)
            f.write(s+'\n')
# log information about the hardware/software environment this is running on
# and print the full `nvidia-smi` to file
print0(f"Running pytorch {torch.version.__version__} compiled for CUDA {torch.version.cuda}\nnvidia-smi:")
import subprocess
result = subprocess.run(['nvidia-smi'], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
print0(f'{result.stdout}', logonly=True)
print0('='*100, logonly=True)

# convenience variables
B, T = args.device_batch_size, args.sequence_length
# calculate the number of steps to take in the val loop.
assert args.val_tokens % (B * T * ddp_world_size) == 0
val_steps = args.val_tokens // (B * T * ddp_world_size)
# calculate the steps of gradient accumulation required to attain the desired global batch size.
assert args.batch_size % (B * ddp_world_size) == 0
train_accumulation_steps = args.batch_size // (B * ddp_world_size)

# load tokens
train_loader = DistributedDataLoader(args.input_bin, B, T, ddp_rank, ddp_world_size)
val_loader = DistributedDataLoader(args.input_val_bin, B, T, ddp_rank, ddp_world_size)
print0(f"Training DataLoader: total number of tokens: {train_loader.ntok_total} across {len(train_loader.files)} files")
print0(f"Validation DataLoader: total number of tokens: {val_loader.ntok_total} across {len(val_loader.files)} files")
print0('='*100, logonly=True)
x, y = train_loader.next_batch()

# there are only 50257 unique GPT-2 tokens; we extend to nearest multiple of 128 for efficiency. suggested to me by @Grad62304977.
# this originates from Karpathy's experiments.
num_vocab = 50304
model = GPT(GPTConfig(vocab_size=num_vocab, n_layer=12, n_head=6, n_embd=768))
model = model.cuda().bfloat16()
for m in model.modules():
    if isinstance(m, CastedLinear):
        m.float()
if hasattr(config, "coordinate_descent_tuning"):
    config.coordinate_descent_tuning = True # suggested by @Chillee
model = torch.compile(model)
# here we wrap model into DDP container
model = DDP(model, device_ids=[ddp_local_rank])
raw_model = model.module # always contains the "raw" unwrapped model

# CUDNN attention is ~4ms faster than Flash, but doesn't get selected by default in PyTorch 2.5.1
from torch.backends.cuda import enable_cudnn_sdp, enable_flash_sdp, enable_math_sdp, enable_mem_efficient_sdp
enable_cudnn_sdp(True)
enable_flash_sdp(False)
enable_mem_efficient_sdp(False)
enable_math_sdp(False)

# init the optimizer(s)
optimizer1 = torch.optim.Adam([raw_model.transformer.wte.weight], lr=0.6,   betas=(0.8, 0.95), fused=True)
optimizer2 = torch.optim.Adam([raw_model.lm_head.weight],         lr=0.008, betas=(0.8, 0.95), fused=True)
param_names = [name for name, _ in raw_model.named_parameters()]
params = list(raw_model.transformer.h.parameters())
qk_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and ("c_q" in n or "c_k" in n)]
matrix_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and "c_q" not in n and "c_k" not in n]
scalar_params = [p for p in params if p.ndim < 2] + [raw_model.skip_weights]
optimizer5 = Muon(qk_params, lr=0.085, momentum=0.95)
optimizer3 = Muon(matrix_params, lr=0.05, momentum=0.95)
optimizer4 = torch.optim.Adam(scalar_params, lr=0.04, betas=(0.8, 0.95), fused=True) # note that this learning rate is neither sensitive nor tuned
optimizers = [optimizer1, optimizer2, optimizer3, optimizer4, optimizer5]
# learning rate decay scheduler (linear warmup and cooldown)
def get_lr(it):
    assert it <= args.num_iterations
    # 1) linear warmup for warmup_iters steps
    if it < args.warmup_iters:
        return (it+1) / args.warmup_iters
    # 2) constant lr for a while
    elif it < args.num_iterations - args.cooldown_iters:
        return 1.0
    # 3) linear cooldown
    else:
        decay_ratio = (args.num_iterations - it) / args.cooldown_iters
        return decay_ratio
schedulers = [torch.optim.lr_scheduler.LambdaLR(opt, get_lr) for opt in optimizers]

# Start training loop
training_time_ms = 0
# start the clock
torch.cuda.synchronize()
t0 = time.time()
# begin training
for step in range(args.num_iterations + 1):
    last_step = (step == args.num_iterations)
    # Set the attention blocksize for the current step, in chunks of 64
    attn_blocksize = torch.tensor(64*((step/args.num_iterations * (1792 - 64) + 64)//64), dtype=torch.int, device='cuda')
    # This effectively ignores timing first 10 steps, which are slower for weird reasons.
    # Alternately, and slightly more correctly in terms of benchmarking, we could do 10
    # steps with dummy data first, and then re-initialize the model and reset the loader.
    if step == 10:
        training_time_ms = 0
        t0 = time.time()
    timed_steps = float('nan') if step <= 11 else (step - 10) + 1 # <= 11 to avoid bug in val

    # once in a while evaluate the validation dataset
    if (last_step or (args.val_loss_every > 0 and step % args.val_loss_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # run validation batches
        model.eval()
        val_loader.reset()
        val_loss = 0.0
        for _ in range(val_steps):
            with torch.no_grad():
                x_val, y_val = val_loader.next_batch()
                val_loss += model(x_val, y_val, attn_blocksize=attn_blocksize)
        dist.all_reduce(val_loss, op=dist.ReduceOp.AVG)
        val_loss /= val_steps
        # log val loss to console and to logfile
        print0(f'step:{step}/{args.num_iterations} val_loss:{val_loss:.4f} train_time:{training_time_ms:.0f}ms step_avg:{training_time_ms/(timed_steps-1):.2f}ms')
        if master_process:
            print("============== Weight norms: ==============")
            with open(logfile, "a") as f:
                f.write("============== Weight norms: ==============\n")
                for name, p in model.named_parameters():
                    if p.ndim != 2:
                        continue
                    if "transformer.wte" in name:
                        l1_to_l2_norm = torch.norm(p.data.float(), p=2, dim=1).mean().item()
                    frobenius_norm = torch.linalg.norm(p.data.float(), ord='fro').item()
                    spectral_norm = torch.linalg.matrix_norm(p.data.float(), ord=2).item()
                    nuclear_norm = torch.linalg.matrix_norm(p.data.float(), ord="nuc").item()
                    if "transformer.wte" in name:
                        print(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                    else:
                        print(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                f.write("===========================================\n")
            print("===========================================")
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    if master_process and (last_step or (args.save_every > 0 and step % args.save_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # save the state of the training process
        log = dict(step=step, code=code, model=raw_model.state_dict(), optimizers=[opt.state_dict() for opt in optimizers])
        torch.save(log, 'logs/%s/state_step%06d.pt' % (run_id, step))
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    # bit confusing: we want to make sure to eval on 0th iteration
    # but also after the very last iteration. so we loop for step <= num_iterations
    # instead of just < num_iterations (one extra due to <=), only to do
    # the validation/sampling one last time, and then we break right here as we're done.
    if last_step:
        break

    # --------------- TRAINING SECTION BEGIN -----------------
    model.train()
    for i in range(1, train_accumulation_steps+1):
        # forward pass
        loss = model(x, y, attn_blocksize=attn_blocksize)
        train_loss = loss.detach()
        # advance the dataset for the next batch
        x, y = train_loader.next_batch()
        # backward pass
        if i < train_accumulation_steps:
            with model.no_sync(): # there's no need to sync gradients every accumulation step
                loss.backward()
        else:
            loss.backward() # just sync on the last step
    for p in model.parameters():
        p.grad /= train_accumulation_steps
    # momentum warmup for Muon
    frac = min(step/300, 1)
    optimizer3.param_groups[0]['momentum'] = (1 - frac) * 0.85 + frac * 0.95
    # step the optimizers and schedulers
    for opt, sched in zip(optimizers, schedulers):
        opt.step()
        sched.step()
    # null the gradients
    model.zero_grad(set_to_none=True)
    # --------------- TRAINING SECTION END -------------------
    # everything that follows now is just diagnostics, prints, logging, etc.

    #dist.all_reduce(train_loss, op=dist.ReduceOp.AVG) # all-reducing the training loss would be more correct in terms of logging, but slower
    approx_time = training_time_ms + 1000 * (time.time() - t0)
    print0(f"step:{step+1}/{args.num_iterations} train_loss:{train_loss.item():.4f} train_time:{approx_time:.0f}ms step_avg:{approx_time/timed_steps:.2f}ms")

if master_process:
    print(f"peak memory consumption: {torch.cuda.max_memory_allocated() // 1024 // 1024} MiB")

# -------------------------------------------------------------------------
# clean up nice
dist.destroy_process_group()
====================================================================================================
Running pytorch 2.6.0.dev20241125+cu124 compiled for CUDA 12.4
nvidia-smi:
Mon Nov 25 14:45:31 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.12             Driver Version: 535.104.12   CUDA Version: 12.4     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  | 00000000:07:00.0 Off |                    0 |
| N/A   41C    P0              68W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  | 00000000:0A:00.0 Off |                    0 |
| N/A   33C    P0              69W / 400W |     25MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  | 00000000:45:00.0 Off |                    0 |
| N/A   33C    P0              71W / 400W |     33MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  | 00000000:4B:00.0 Off |                    0 |
| N/A   43C    P0              77W / 400W |    427MiB / 81920MiB |      1%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   4  NVIDIA A100-SXM4-80GB          On  | 00000000:84:00.0 Off |                    0 |
| N/A   44C    P0              77W / 400W |    427MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   5  NVIDIA A100-SXM4-80GB          On  | 00000000:8A:00.0 Off |                    0 |
| N/A   33C    P0              71W / 400W |     25MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   6  NVIDIA A100-SXM4-80GB          On  | 00000000:C0:00.0 Off |                    0 |
| N/A   32C    P0              70W / 400W |    427MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   7  NVIDIA A100-SXM4-80GB          On  | 00000000:C3:00.0 Off |                    0 |
| N/A   42C    P0              76W / 400W |    427MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
+---------------------------------------------------------------------------------------+

====================================================================================================
Training DataLoader: total number of tokens: 1100000000 across 11 files
Validation DataLoader: total number of tokens: 100000000 across 1 files
====================================================================================================
step:0/1750 val_loss:10.8258 train_time:0ms step_avg:nanms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 27.70226 | frobenius_norm = 6215.23926 | spectral_norm = 251.93134 | nuclear_norm = 171934.23438
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 15.99510 | spectral_norm = 1.15686 | nuclear_norm = 376.47150
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 15.99029 | spectral_norm = 1.14279 | nuclear_norm = 376.03784
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 16.01156 | spectral_norm = 1.15798 | nuclear_norm = 376.39218
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 31.98851 | spectral_norm = 1.73593 | nuclear_norm = 857.76556
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 16.00504 | spectral_norm = 1.14857 | nuclear_norm = 376.63031
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 15.97987 | spectral_norm = 1.14515 | nuclear_norm = 376.00632
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 16.00081 | spectral_norm = 1.14338 | nuclear_norm = 376.26660
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 32.00179 | spectral_norm = 1.72457 | nuclear_norm = 858.21277
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 15.98684 | spectral_norm = 1.13455 | nuclear_norm = 376.01038
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 15.99254 | spectral_norm = 1.15238 | nuclear_norm = 376.20950
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 15.99218 | spectral_norm = 1.14592 | nuclear_norm = 376.38129
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 32.00896 | spectral_norm = 1.73203 | nuclear_norm = 858.62903
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 15.98479 | spectral_norm = 1.14600 | nuclear_norm = 375.88379
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 15.98033 | spectral_norm = 1.15521 | nuclear_norm = 375.77283
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 15.99455 | spectral_norm = 1.14372 | nuclear_norm = 376.29492
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 32.00245 | spectral_norm = 1.71749 | nuclear_norm = 858.26019
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 16.01152 | spectral_norm = 1.14121 | nuclear_norm = 376.57440
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 15.99329 | spectral_norm = 1.14975 | nuclear_norm = 376.24200
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 16.00617 | spectral_norm = 1.14865 | nuclear_norm = 376.72839
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 32.00495 | spectral_norm = 1.73261 | nuclear_norm = 858.33667
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 15.98933 | spectral_norm = 1.14842 | nuclear_norm = 376.16339
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 16.00112 | spectral_norm = 1.15216 | nuclear_norm = 376.30884
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 15.99726 | spectral_norm = 1.14571 | nuclear_norm = 376.60342
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 31.99024 | spectral_norm = 1.72685 | nuclear_norm = 857.95947
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 15.99747 | spectral_norm = 1.15373 | nuclear_norm = 376.52161
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 16.00625 | spectral_norm = 1.15426 | nuclear_norm = 376.67426
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 15.98847 | spectral_norm = 1.14565 | nuclear_norm = 376.10260
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 32.00146 | spectral_norm = 1.72734 | nuclear_norm = 858.24866
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 15.99864 | spectral_norm = 1.15101 | nuclear_norm = 376.25769
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 15.99188 | spectral_norm = 1.14647 | nuclear_norm = 376.21439
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 15.99045 | spectral_norm = 1.14548 | nuclear_norm = 375.90564
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 32.00535 | spectral_norm = 1.72002 | nuclear_norm = 858.52795
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 16.00583 | spectral_norm = 1.15339 | nuclear_norm = 376.56470
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 15.99974 | spectral_norm = 1.15165 | nuclear_norm = 376.30646
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 16.00226 | spectral_norm = 1.15323 | nuclear_norm = 376.30374
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 31.98925 | spectral_norm = 1.72528 | nuclear_norm = 857.99573
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 16.00289 | spectral_norm = 1.14375 | nuclear_norm = 376.41675
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 16.01961 | spectral_norm = 1.14932 | nuclear_norm = 376.92145
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 15.98651 | spectral_norm = 1.14786 | nuclear_norm = 376.05316
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 32.00500 | spectral_norm = 1.72777 | nuclear_norm = 858.32922
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 16.00773 | spectral_norm = 1.15519 | nuclear_norm = 376.51642
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 16.01732 | spectral_norm = 1.14503 | nuclear_norm = 376.65863
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 16.00160 | spectral_norm = 1.15335 | nuclear_norm = 376.65289
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 31.99724 | spectral_norm = 1.72480 | nuclear_norm = 858.16687
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 15.99154 | spectral_norm = 1.16648 | nuclear_norm = 376.19867
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 15.99937 | spectral_norm = 1.15599 | nuclear_norm = 376.26398
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 16.00637 | spectral_norm = 1.15078 | nuclear_norm = 376.85287
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 32.00047 | spectral_norm = 1.72045 | nuclear_norm = 858.27435
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
===========================================
step:1/1750 train_loss:10.8258 train_time:34739ms step_avg:nanms
step:2/1750 train_loss:10.0791 train_time:35564ms step_avg:nanms
step:3/1750 train_loss:8.3492 train_time:35886ms step_avg:nanms
step:4/1750 train_loss:7.6503 train_time:36212ms step_avg:nanms
step:5/1750 train_loss:7.5357 train_time:36539ms step_avg:nanms
step:6/1750 train_loss:7.0233 train_time:36866ms step_avg:nanms
step:7/1750 train_loss:7.2233 train_time:37194ms step_avg:nanms
step:8/1750 train_loss:6.7310 train_time:37521ms step_avg:nanms
step:9/1750 train_loss:6.6357 train_time:37848ms step_avg:nanms
step:10/1750 train_loss:6.5401 train_time:38175ms step_avg:nanms
step:11/1750 train_loss:6.5313 train_time:247ms step_avg:nanms
step:12/1750 train_loss:6.3491 train_time:575ms step_avg:nanms
step:13/1750 train_loss:6.2762 train_time:903ms step_avg:301.15ms
step:14/1750 train_loss:6.2199 train_time:1231ms step_avg:307.70ms
step:15/1750 train_loss:6.1747 train_time:1559ms step_avg:311.72ms
step:16/1750 train_loss:6.1125 train_time:1886ms step_avg:314.41ms
step:17/1750 train_loss:6.1768 train_time:2214ms step_avg:316.34ms
step:18/1750 train_loss:5.9538 train_time:2542ms step_avg:317.70ms
step:19/1750 train_loss:6.0178 train_time:2869ms step_avg:318.80ms
step:20/1750 train_loss:5.6981 train_time:3197ms step_avg:319.74ms
step:21/1750 train_loss:5.9940 train_time:3525ms step_avg:320.45ms
step:22/1750 train_loss:6.1936 train_time:3853ms step_avg:321.07ms
step:23/1750 train_loss:5.8847 train_time:4181ms step_avg:321.59ms
step:24/1750 train_loss:6.0705 train_time:4509ms step_avg:322.08ms
step:25/1750 train_loss:5.7332 train_time:4837ms step_avg:322.44ms
step:26/1750 train_loss:5.6533 train_time:5164ms step_avg:322.78ms
step:27/1750 train_loss:5.8552 train_time:5491ms step_avg:323.03ms
step:28/1750 train_loss:5.4667 train_time:5820ms step_avg:323.31ms
step:29/1750 train_loss:5.7274 train_time:6147ms step_avg:323.52ms
step:30/1750 train_loss:5.5282 train_time:6475ms step_avg:323.77ms
step:31/1750 train_loss:5.5028 train_time:6803ms step_avg:323.94ms
step:32/1750 train_loss:5.3383 train_time:7131ms step_avg:324.11ms
step:33/1750 train_loss:5.6259 train_time:7458ms step_avg:324.27ms
step:34/1750 train_loss:5.5368 train_time:7786ms step_avg:324.40ms
step:35/1750 train_loss:5.6704 train_time:8113ms step_avg:324.54ms
step:36/1750 train_loss:5.5894 train_time:8442ms step_avg:324.68ms
step:37/1750 train_loss:5.4931 train_time:8770ms step_avg:324.80ms
step:38/1750 train_loss:5.3583 train_time:9097ms step_avg:324.90ms
step:39/1750 train_loss:5.3735 train_time:9425ms step_avg:325.02ms
step:40/1750 train_loss:5.2832 train_time:9753ms step_avg:325.12ms
step:41/1750 train_loss:5.2818 train_time:10083ms step_avg:325.24ms
step:42/1750 train_loss:5.1984 train_time:10410ms step_avg:325.31ms
step:43/1750 train_loss:5.3003 train_time:10738ms step_avg:325.40ms
step:44/1750 train_loss:5.2698 train_time:11067ms step_avg:325.49ms
step:45/1750 train_loss:5.4035 train_time:11396ms step_avg:325.59ms
step:46/1750 train_loss:5.2218 train_time:11724ms step_avg:325.67ms
step:47/1750 train_loss:5.1436 train_time:12052ms step_avg:325.73ms
step:48/1750 train_loss:5.2722 train_time:12381ms step_avg:325.82ms
step:49/1750 train_loss:5.1777 train_time:12709ms step_avg:325.88ms
step:50/1750 train_loss:5.2865 train_time:13038ms step_avg:325.95ms
step:51/1750 train_loss:5.1835 train_time:13367ms step_avg:326.02ms
step:52/1750 train_loss:5.0736 train_time:13696ms step_avg:326.09ms
step:53/1750 train_loss:5.2078 train_time:14025ms step_avg:326.17ms
step:54/1750 train_loss:5.0573 train_time:14355ms step_avg:326.25ms
step:55/1750 train_loss:5.4488 train_time:14684ms step_avg:326.32ms
step:56/1750 train_loss:5.0549 train_time:15013ms step_avg:326.37ms
step:57/1750 train_loss:4.9283 train_time:15342ms step_avg:326.42ms
step:58/1750 train_loss:5.0481 train_time:15671ms step_avg:326.48ms
step:59/1750 train_loss:5.0378 train_time:16000ms step_avg:326.52ms
step:60/1750 train_loss:5.1770 train_time:16329ms step_avg:326.58ms
step:61/1750 train_loss:4.9022 train_time:16658ms step_avg:326.63ms
step:62/1750 train_loss:5.0235 train_time:16987ms step_avg:326.67ms
step:63/1750 train_loss:5.0056 train_time:17316ms step_avg:326.71ms
step:64/1750 train_loss:5.0872 train_time:17645ms step_avg:326.77ms
step:65/1750 train_loss:4.8349 train_time:17974ms step_avg:326.80ms
step:66/1750 train_loss:4.9972 train_time:18303ms step_avg:326.84ms
step:67/1750 train_loss:4.8849 train_time:18634ms step_avg:326.91ms
step:68/1750 train_loss:5.1436 train_time:18964ms step_avg:326.97ms
step:69/1750 train_loss:4.7802 train_time:19293ms step_avg:327.00ms
step:70/1750 train_loss:4.8651 train_time:19623ms step_avg:327.04ms
step:71/1750 train_loss:4.9932 train_time:19953ms step_avg:327.10ms
step:72/1750 train_loss:4.8955 train_time:20283ms step_avg:327.15ms
step:73/1750 train_loss:4.7759 train_time:20612ms step_avg:327.18ms
step:74/1750 train_loss:4.9242 train_time:20943ms step_avg:327.23ms
step:75/1750 train_loss:4.8526 train_time:21273ms step_avg:327.28ms
step:76/1750 train_loss:4.8122 train_time:21604ms step_avg:327.33ms
step:77/1750 train_loss:4.9239 train_time:21935ms step_avg:327.38ms
step:78/1750 train_loss:5.1201 train_time:22265ms step_avg:327.42ms
step:79/1750 train_loss:4.8668 train_time:22595ms step_avg:327.46ms
step:80/1750 train_loss:4.8749 train_time:22925ms step_avg:327.50ms
step:81/1750 train_loss:4.6644 train_time:23254ms step_avg:327.53ms
step:82/1750 train_loss:4.8099 train_time:23583ms step_avg:327.55ms
step:83/1750 train_loss:4.7715 train_time:23915ms step_avg:327.60ms
step:84/1750 train_loss:4.7606 train_time:24245ms step_avg:327.64ms
step:85/1750 train_loss:4.6188 train_time:24575ms step_avg:327.67ms
step:86/1750 train_loss:4.8384 train_time:24907ms step_avg:327.72ms
step:87/1750 train_loss:4.7583 train_time:25238ms step_avg:327.77ms
step:88/1750 train_loss:4.7245 train_time:25568ms step_avg:327.80ms
step:89/1750 train_loss:4.6861 train_time:25898ms step_avg:327.82ms
step:90/1750 train_loss:4.6415 train_time:26229ms step_avg:327.86ms
step:91/1750 train_loss:4.6130 train_time:26560ms step_avg:327.91ms
step:92/1750 train_loss:4.7781 train_time:26890ms step_avg:327.93ms
step:93/1750 train_loss:4.5910 train_time:27220ms step_avg:327.96ms
step:94/1750 train_loss:4.6313 train_time:27552ms step_avg:327.99ms
step:95/1750 train_loss:4.6809 train_time:27881ms step_avg:328.01ms
step:96/1750 train_loss:4.5928 train_time:28211ms step_avg:328.04ms
step:97/1750 train_loss:4.6242 train_time:28541ms step_avg:328.06ms
step:98/1750 train_loss:4.5618 train_time:28871ms step_avg:328.08ms
step:99/1750 train_loss:4.6464 train_time:29202ms step_avg:328.11ms
step:100/1750 train_loss:4.6682 train_time:29535ms step_avg:328.17ms
step:101/1750 train_loss:4.5013 train_time:29863ms step_avg:328.17ms
step:102/1750 train_loss:4.6794 train_time:30194ms step_avg:328.20ms
step:103/1750 train_loss:4.5691 train_time:30524ms step_avg:328.21ms
step:104/1750 train_loss:4.5355 train_time:30855ms step_avg:328.24ms
step:105/1750 train_loss:4.5444 train_time:31187ms step_avg:328.28ms
step:106/1750 train_loss:4.5771 train_time:31516ms step_avg:328.30ms
step:107/1750 train_loss:4.5102 train_time:31847ms step_avg:328.32ms
step:108/1750 train_loss:4.3627 train_time:32177ms step_avg:328.34ms
step:109/1750 train_loss:4.4799 train_time:32508ms step_avg:328.36ms
step:110/1750 train_loss:4.4638 train_time:32837ms step_avg:328.37ms
step:111/1750 train_loss:4.4149 train_time:33168ms step_avg:328.40ms
step:112/1750 train_loss:4.5683 train_time:33499ms step_avg:328.42ms
step:113/1750 train_loss:4.4763 train_time:33829ms step_avg:328.44ms
step:114/1750 train_loss:4.3611 train_time:34159ms step_avg:328.45ms
step:115/1750 train_loss:4.5037 train_time:34490ms step_avg:328.48ms
step:116/1750 train_loss:4.4753 train_time:34820ms step_avg:328.49ms
step:117/1750 train_loss:4.3726 train_time:35150ms step_avg:328.51ms
step:118/1750 train_loss:4.5869 train_time:35481ms step_avg:328.53ms
step:119/1750 train_loss:4.4483 train_time:35812ms step_avg:328.55ms
step:120/1750 train_loss:4.3686 train_time:36142ms step_avg:328.56ms
step:121/1750 train_loss:4.3011 train_time:36474ms step_avg:328.59ms
step:122/1750 train_loss:4.4646 train_time:36805ms step_avg:328.62ms
step:123/1750 train_loss:4.2987 train_time:37136ms step_avg:328.63ms
step:124/1750 train_loss:4.5938 train_time:37465ms step_avg:328.64ms
step:125/1750 train_loss:4.4664 train_time:37796ms step_avg:328.66ms
step:125/1750 val_loss:4.4123 train_time:37877ms step_avg:329.37ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 118.84108 | frobenius_norm = 27090.54297 | spectral_norm = 6657.91260 | nuclear_norm = 658916.87500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 39.04488 | spectral_norm = 3.13830 | nuclear_norm = 920.35754
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 37.35003 | spectral_norm = 4.40290 | nuclear_norm = 877.67651
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 87.04855 | spectral_norm = 5.94234 | nuclear_norm = 2034.16602
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 89.36165 | spectral_norm = 9.57493 | nuclear_norm = 2124.27246
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 77.28759 | spectral_norm = 5.47144 | nuclear_norm = 2052.85791
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 41.69730 | spectral_norm = 2.78332 | nuclear_norm = 1108.02979
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 36.29988 | spectral_norm = 3.08263 | nuclear_norm = 852.90942
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 35.61824 | spectral_norm = 3.95921 | nuclear_norm = 836.04028
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 98.49642 | spectral_norm = 8.08210 | nuclear_norm = 2280.83813
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 100.42536 | spectral_norm = 9.79185 | nuclear_norm = 2392.41455
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 84.42089 | spectral_norm = 5.49074 | nuclear_norm = 2246.65771
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 43.69097 | spectral_norm = 2.97617 | nuclear_norm = 1161.10559
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 35.87560 | spectral_norm = 3.03767 | nuclear_norm = 842.47845
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 35.48798 | spectral_norm = 3.56907 | nuclear_norm = 832.70032
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 100.69556 | spectral_norm = 9.32259 | nuclear_norm = 2263.76123
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 99.07175 | spectral_norm = 9.03813 | nuclear_norm = 2354.87012
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 86.07428 | spectral_norm = 5.41981 | nuclear_norm = 2287.94214
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 44.25262 | spectral_norm = 3.04884 | nuclear_norm = 1172.88477
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 35.04692 | spectral_norm = 2.94827 | nuclear_norm = 815.64453
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 35.24402 | spectral_norm = 3.45543 | nuclear_norm = 820.74890
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 88.89223 | spectral_norm = 8.30502 | nuclear_norm = 1994.20752
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 96.48116 | spectral_norm = 8.63858 | nuclear_norm = 2280.62598
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 86.92754 | spectral_norm = 5.48529 | nuclear_norm = 2309.38013
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 44.07177 | spectral_norm = 3.09002 | nuclear_norm = 1167.04248
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 34.88031 | spectral_norm = 2.83285 | nuclear_norm = 813.92603
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 35.41065 | spectral_norm = 3.01570 | nuclear_norm = 827.28394
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 93.84878 | spectral_norm = 9.53203 | nuclear_norm = 2041.70154
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 92.07406 | spectral_norm = 8.65293 | nuclear_norm = 2181.12842
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 85.38169 | spectral_norm = 5.39669 | nuclear_norm = 2263.93262
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 43.52305 | spectral_norm = 3.08763 | nuclear_norm = 1148.51074
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 34.15235 | spectral_norm = 2.99483 | nuclear_norm = 795.09229
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 34.63827 | spectral_norm = 3.17881 | nuclear_norm = 806.83740
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 82.03864 | spectral_norm = 7.65967 | nuclear_norm = 1828.55945
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 89.90013 | spectral_norm = 8.13578 | nuclear_norm = 2133.90063
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 83.48519 | spectral_norm = 5.29826 | nuclear_norm = 2211.26172
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 42.35524 | spectral_norm = 2.96274 | nuclear_norm = 1117.10474
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 33.87416 | spectral_norm = 2.75069 | nuclear_norm = 787.96802
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 34.62746 | spectral_norm = 2.80800 | nuclear_norm = 806.48206
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 100.70527 | spectral_norm = 9.10758 | nuclear_norm = 2213.80664
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 91.81396 | spectral_norm = 8.51751 | nuclear_norm = 2173.48633
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 82.53182 | spectral_norm = 5.32992 | nuclear_norm = 2183.14258
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 41.86391 | spectral_norm = 2.94382 | nuclear_norm = 1101.17175
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 33.61658 | spectral_norm = 2.93193 | nuclear_norm = 780.73584
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 34.24688 | spectral_norm = 2.86186 | nuclear_norm = 796.47485
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 82.81079 | spectral_norm = 7.96495 | nuclear_norm = 1816.72266
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 93.50826 | spectral_norm = 8.58342 | nuclear_norm = 2226.28906
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 82.30132 | spectral_norm = 5.46835 | nuclear_norm = 2174.14380
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 41.63274 | spectral_norm = 2.93924 | nuclear_norm = 1094.37012
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 33.76280 | spectral_norm = 2.78686 | nuclear_norm = 781.10339
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 34.50007 | spectral_norm = 2.80194 | nuclear_norm = 799.39807
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 89.51461 | spectral_norm = 9.07127 | nuclear_norm = 1969.45300
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 97.36372 | spectral_norm = 8.72433 | nuclear_norm = 2327.64746
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 83.08058 | spectral_norm = 5.59208 | nuclear_norm = 2195.45459
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 41.73256 | spectral_norm = 2.91254 | nuclear_norm = 1096.60974
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 34.04788 | spectral_norm = 2.84361 | nuclear_norm = 787.82275
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 34.51020 | spectral_norm = 2.93314 | nuclear_norm = 799.49481
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 91.85317 | spectral_norm = 8.19633 | nuclear_norm = 2055.05493
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 99.88996 | spectral_norm = 8.80634 | nuclear_norm = 2399.06006
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 84.42278 | spectral_norm = 5.82375 | nuclear_norm = 2231.24365
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 41.79552 | spectral_norm = 2.89395 | nuclear_norm = 1097.17554
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 34.37724 | spectral_norm = 2.94660 | nuclear_norm = 799.85449
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 34.77261 | spectral_norm = 2.96461 | nuclear_norm = 809.53320
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 90.31465 | spectral_norm = 7.79195 | nuclear_norm = 2030.23499
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 97.93828 | spectral_norm = 8.25504 | nuclear_norm = 2358.19263
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 84.04697 | spectral_norm = 6.16432 | nuclear_norm = 2221.83691
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 41.29184 | spectral_norm = 2.82949 | nuclear_norm = 1081.58594
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 34.69328 | spectral_norm = 3.00485 | nuclear_norm = 803.79681
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 34.95745 | spectral_norm = 3.13181 | nuclear_norm = 808.06262
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 83.08939 | spectral_norm = 7.70910 | nuclear_norm = 1850.02637
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 96.05701 | spectral_norm = 7.52098 | nuclear_norm = 2311.43164
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 82.61275 | spectral_norm = 6.34663 | nuclear_norm = 2183.27417
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 40.17368 | spectral_norm = 2.81959 | nuclear_norm = 1049.94556
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 386.10062 | spectral_norm = 132.96803 | nuclear_norm = 9207.84277
===========================================
step:126/1750 train_loss:4.4232 train_time:38123ms step_avg:328.65ms
step:127/1750 train_loss:4.4491 train_time:38451ms step_avg:328.64ms
step:128/1750 train_loss:4.3894 train_time:38780ms step_avg:328.65ms
step:129/1750 train_loss:4.7111 train_time:39109ms step_avg:328.65ms
step:130/1750 train_loss:4.4056 train_time:39439ms step_avg:328.66ms
step:131/1750 train_loss:4.4089 train_time:39773ms step_avg:328.71ms
step:132/1750 train_loss:4.3476 train_time:40112ms step_avg:328.78ms
step:133/1750 train_loss:4.4493 train_time:40451ms step_avg:328.87ms
step:134/1750 train_loss:4.2489 train_time:40789ms step_avg:328.94ms
step:135/1750 train_loss:4.4362 train_time:41127ms step_avg:329.02ms
step:136/1750 train_loss:4.2083 train_time:41465ms step_avg:329.09ms
step:137/1750 train_loss:4.3716 train_time:41804ms step_avg:329.16ms
step:138/1750 train_loss:4.2788 train_time:42142ms step_avg:329.24ms
step:139/1750 train_loss:4.3767 train_time:42481ms step_avg:329.31ms
step:140/1750 train_loss:4.4611 train_time:42822ms step_avg:329.40ms
step:141/1750 train_loss:4.3034 train_time:43160ms step_avg:329.47ms
step:142/1750 train_loss:4.3086 train_time:43500ms step_avg:329.54ms
step:143/1750 train_loss:4.2465 train_time:43840ms step_avg:329.62ms
step:144/1750 train_loss:4.3387 train_time:44180ms step_avg:329.70ms
step:145/1750 train_loss:4.2938 train_time:44521ms step_avg:329.78ms
step:146/1750 train_loss:4.1584 train_time:44860ms step_avg:329.85ms
step:147/1750 train_loss:4.3101 train_time:45199ms step_avg:329.92ms
step:148/1750 train_loss:4.3561 train_time:45540ms step_avg:330.00ms
step:149/1750 train_loss:4.3018 train_time:45880ms step_avg:330.07ms
step:150/1750 train_loss:4.4352 train_time:46219ms step_avg:330.14ms
step:151/1750 train_loss:4.2613 train_time:46558ms step_avg:330.20ms
step:152/1750 train_loss:4.2676 train_time:46897ms step_avg:330.26ms
step:153/1750 train_loss:4.3599 train_time:47237ms step_avg:330.33ms
step:154/1750 train_loss:4.3566 train_time:47577ms step_avg:330.40ms
step:155/1750 train_loss:4.2664 train_time:47916ms step_avg:330.45ms
step:156/1750 train_loss:4.3424 train_time:48255ms step_avg:330.51ms
step:157/1750 train_loss:4.3961 train_time:48595ms step_avg:330.58ms
step:158/1750 train_loss:4.2429 train_time:48936ms step_avg:330.65ms
step:159/1750 train_loss:4.3029 train_time:49276ms step_avg:330.71ms
step:160/1750 train_loss:4.1240 train_time:49616ms step_avg:330.77ms
step:161/1750 train_loss:4.3539 train_time:49956ms step_avg:330.84ms
step:162/1750 train_loss:4.3642 train_time:50296ms step_avg:330.89ms
step:163/1750 train_loss:4.3338 train_time:50634ms step_avg:330.94ms
step:164/1750 train_loss:4.1884 train_time:50974ms step_avg:331.00ms
step:165/1750 train_loss:4.2792 train_time:51315ms step_avg:331.06ms
step:166/1750 train_loss:4.3456 train_time:51654ms step_avg:331.11ms
step:167/1750 train_loss:4.1936 train_time:51995ms step_avg:331.18ms
step:168/1750 train_loss:4.2775 train_time:52334ms step_avg:331.23ms
step:169/1750 train_loss:4.1457 train_time:52674ms step_avg:331.28ms
step:170/1750 train_loss:4.0077 train_time:53016ms step_avg:331.35ms
step:171/1750 train_loss:4.1975 train_time:53356ms step_avg:331.40ms
step:172/1750 train_loss:4.2270 train_time:53697ms step_avg:331.47ms
step:173/1750 train_loss:4.2743 train_time:54037ms step_avg:331.52ms
step:174/1750 train_loss:4.4380 train_time:54378ms step_avg:331.57ms
step:175/1750 train_loss:4.2402 train_time:54720ms step_avg:331.64ms
step:176/1750 train_loss:4.0930 train_time:55060ms step_avg:331.68ms
step:177/1750 train_loss:4.0876 train_time:55401ms step_avg:331.75ms
step:178/1750 train_loss:4.1940 train_time:55742ms step_avg:331.80ms
step:179/1750 train_loss:4.1378 train_time:56081ms step_avg:331.84ms
step:180/1750 train_loss:4.1120 train_time:56423ms step_avg:331.90ms
step:181/1750 train_loss:4.3020 train_time:56764ms step_avg:331.95ms
step:182/1750 train_loss:4.1575 train_time:57103ms step_avg:331.99ms
step:183/1750 train_loss:4.1453 train_time:57442ms step_avg:332.04ms
step:184/1750 train_loss:4.1374 train_time:57784ms step_avg:332.09ms
step:185/1750 train_loss:4.2095 train_time:58123ms step_avg:332.13ms
step:186/1750 train_loss:4.1795 train_time:58463ms step_avg:332.17ms
step:187/1750 train_loss:4.2374 train_time:58803ms step_avg:332.22ms
step:188/1750 train_loss:4.1789 train_time:59164ms step_avg:332.38ms
step:189/1750 train_loss:4.1273 train_time:59736ms step_avg:333.72ms
step:190/1750 train_loss:4.2241 train_time:60082ms step_avg:333.79ms
step:191/1750 train_loss:4.0901 train_time:60421ms step_avg:333.82ms
step:192/1750 train_loss:4.0372 train_time:60761ms step_avg:333.85ms
step:193/1750 train_loss:4.2552 train_time:61102ms step_avg:333.89ms
step:194/1750 train_loss:4.1764 train_time:61444ms step_avg:333.94ms
step:195/1750 train_loss:4.3642 train_time:61784ms step_avg:333.97ms
step:196/1750 train_loss:4.1848 train_time:62122ms step_avg:333.99ms
step:197/1750 train_loss:4.0433 train_time:62461ms step_avg:334.01ms
step:198/1750 train_loss:4.1656 train_time:62799ms step_avg:334.04ms
step:199/1750 train_loss:4.0211 train_time:63136ms step_avg:334.05ms
step:200/1750 train_loss:4.1097 train_time:63476ms step_avg:334.08ms
step:201/1750 train_loss:3.9935 train_time:63813ms step_avg:334.10ms
step:202/1750 train_loss:4.2523 train_time:64152ms step_avg:334.13ms
step:203/1750 train_loss:4.0662 train_time:64491ms step_avg:334.15ms
step:204/1750 train_loss:4.2027 train_time:64828ms step_avg:334.17ms
step:205/1750 train_loss:4.2458 train_time:65167ms step_avg:334.19ms
step:206/1750 train_loss:3.9363 train_time:65506ms step_avg:334.22ms
step:207/1750 train_loss:4.0783 train_time:65845ms step_avg:334.24ms
step:208/1750 train_loss:4.0864 train_time:66183ms step_avg:334.26ms
step:209/1750 train_loss:4.2319 train_time:66520ms step_avg:334.27ms
step:210/1750 train_loss:4.1645 train_time:66857ms step_avg:334.28ms
step:211/1750 train_loss:4.0525 train_time:67195ms step_avg:334.30ms
step:212/1750 train_loss:4.1071 train_time:67534ms step_avg:334.33ms
step:213/1750 train_loss:4.0391 train_time:67872ms step_avg:334.34ms
step:214/1750 train_loss:4.0972 train_time:68210ms step_avg:334.36ms
step:215/1750 train_loss:3.9496 train_time:68547ms step_avg:334.38ms
step:216/1750 train_loss:3.9974 train_time:68885ms step_avg:334.39ms
step:217/1750 train_loss:4.0081 train_time:69223ms step_avg:334.41ms
step:218/1750 train_loss:4.0841 train_time:69559ms step_avg:334.42ms
step:219/1750 train_loss:4.0701 train_time:69897ms step_avg:334.44ms
step:220/1750 train_loss:4.0734 train_time:70235ms step_avg:334.45ms
step:221/1750 train_loss:4.0912 train_time:70574ms step_avg:334.47ms
step:222/1750 train_loss:3.9965 train_time:70913ms step_avg:334.50ms
step:223/1750 train_loss:3.9890 train_time:71251ms step_avg:334.51ms
step:224/1750 train_loss:4.2937 train_time:71589ms step_avg:334.53ms
step:225/1750 train_loss:3.8838 train_time:71925ms step_avg:334.54ms
step:226/1750 train_loss:3.9884 train_time:72263ms step_avg:334.55ms
step:227/1750 train_loss:3.9779 train_time:72601ms step_avg:334.57ms
step:228/1750 train_loss:4.1381 train_time:72938ms step_avg:334.58ms
step:229/1750 train_loss:3.9269 train_time:73276ms step_avg:334.59ms
step:230/1750 train_loss:4.0533 train_time:73614ms step_avg:334.61ms
step:231/1750 train_loss:3.9009 train_time:73953ms step_avg:334.63ms
step:232/1750 train_loss:3.9638 train_time:74290ms step_avg:334.64ms
step:233/1750 train_loss:4.0852 train_time:74629ms step_avg:334.66ms
step:234/1750 train_loss:4.0315 train_time:74966ms step_avg:334.67ms
step:235/1750 train_loss:3.9088 train_time:75304ms step_avg:334.68ms
step:236/1750 train_loss:4.0933 train_time:75643ms step_avg:334.70ms
step:237/1750 train_loss:4.0885 train_time:75983ms step_avg:334.73ms
step:238/1750 train_loss:3.9386 train_time:76323ms step_avg:334.75ms
step:239/1750 train_loss:4.0748 train_time:76661ms step_avg:334.76ms
step:240/1750 train_loss:4.1054 train_time:77000ms step_avg:334.78ms
step:241/1750 train_loss:3.9680 train_time:77338ms step_avg:334.80ms
step:242/1750 train_loss:4.1394 train_time:77678ms step_avg:334.82ms
step:243/1750 train_loss:4.0280 train_time:78017ms step_avg:334.84ms
step:244/1750 train_loss:4.0985 train_time:78356ms step_avg:334.85ms
step:245/1750 train_loss:4.1527 train_time:78694ms step_avg:334.87ms
step:246/1750 train_loss:4.0649 train_time:79033ms step_avg:334.88ms
step:247/1750 train_loss:4.0023 train_time:79369ms step_avg:334.89ms
step:248/1750 train_loss:4.1070 train_time:79708ms step_avg:334.91ms
step:249/1750 train_loss:3.9201 train_time:80046ms step_avg:334.92ms
step:250/1750 train_loss:3.9759 train_time:80386ms step_avg:334.94ms
step:250/1750 val_loss:4.0109 train_time:80472ms step_avg:335.30ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 157.30467 | frobenius_norm = 35938.09375 | spectral_norm = 7461.06836 | nuclear_norm = 884472.87500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 59.82156 | spectral_norm = 6.35058 | nuclear_norm = 1402.97498
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 58.07211 | spectral_norm = 8.32244 | nuclear_norm = 1356.12744
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 131.22472 | spectral_norm = 8.54190 | nuclear_norm = 3112.16895
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 123.11623 | spectral_norm = 11.29830 | nuclear_norm = 2893.32422
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 121.45642 | spectral_norm = 9.30353 | nuclear_norm = 3224.10205
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 63.56833 | spectral_norm = 4.57885 | nuclear_norm = 1687.21655
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 57.94278 | spectral_norm = 4.93605 | nuclear_norm = 1358.67371
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 57.12879 | spectral_norm = 6.19450 | nuclear_norm = 1338.72864
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 151.21687 | spectral_norm = 12.21452 | nuclear_norm = 3513.86377
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 147.16061 | spectral_norm = 12.59173 | nuclear_norm = 3474.76562
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 131.99005 | spectral_norm = 8.61276 | nuclear_norm = 3508.12207
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 66.27262 | spectral_norm = 5.20085 | nuclear_norm = 1755.37854
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 57.14162 | spectral_norm = 5.02490 | nuclear_norm = 1337.29358
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 56.49067 | spectral_norm = 5.65591 | nuclear_norm = 1322.02026
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 148.25130 | spectral_norm = 12.18582 | nuclear_norm = 3394.20068
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 148.70729 | spectral_norm = 11.58602 | nuclear_norm = 3504.99707
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 134.73526 | spectral_norm = 8.98451 | nuclear_norm = 3580.96582
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 67.26243 | spectral_norm = 5.19519 | nuclear_norm = 1777.65039
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 56.28421 | spectral_norm = 4.78393 | nuclear_norm = 1298.93530
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 55.80976 | spectral_norm = 5.47471 | nuclear_norm = 1288.05920
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 141.61414 | spectral_norm = 11.57618 | nuclear_norm = 3243.17725
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 148.42522 | spectral_norm = 11.25378 | nuclear_norm = 3500.62427
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 136.89328 | spectral_norm = 8.78536 | nuclear_norm = 3636.83105
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 67.70810 | spectral_norm = 5.52545 | nuclear_norm = 1789.01343
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 56.54214 | spectral_norm = 4.72566 | nuclear_norm = 1316.78796
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 56.84336 | spectral_norm = 4.78971 | nuclear_norm = 1324.12939
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 145.88226 | spectral_norm = 12.75777 | nuclear_norm = 3302.31738
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 146.85744 | spectral_norm = 11.23241 | nuclear_norm = 3466.59863
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 136.20961 | spectral_norm = 9.58678 | nuclear_norm = 3613.57471
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 67.18613 | spectral_norm = 5.06399 | nuclear_norm = 1769.91919
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 55.39773 | spectral_norm = 4.99755 | nuclear_norm = 1281.56531
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 55.43565 | spectral_norm = 5.05134 | nuclear_norm = 1282.68469
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 140.64671 | spectral_norm = 11.36473 | nuclear_norm = 3233.72290
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 145.24103 | spectral_norm = 10.56565 | nuclear_norm = 3435.21265
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 136.74509 | spectral_norm = 8.79080 | nuclear_norm = 3628.68433
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 66.40971 | spectral_norm = 5.13734 | nuclear_norm = 1751.35547
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 56.42445 | spectral_norm = 4.77994 | nuclear_norm = 1312.45703
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 56.62154 | spectral_norm = 4.59204 | nuclear_norm = 1317.55396
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 150.85364 | spectral_norm = 12.40504 | nuclear_norm = 3421.32275
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 145.61661 | spectral_norm = 11.16742 | nuclear_norm = 3435.73877
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 133.44838 | spectral_norm = 9.02927 | nuclear_norm = 3540.69385
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 65.83686 | spectral_norm = 5.34365 | nuclear_norm = 1733.18176
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 55.30050 | spectral_norm = 5.04088 | nuclear_norm = 1284.52173
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 55.38475 | spectral_norm = 4.72843 | nuclear_norm = 1288.33130
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 139.95555 | spectral_norm = 11.94588 | nuclear_norm = 3183.88867
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 146.21930 | spectral_norm = 10.98622 | nuclear_norm = 3451.95776
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 134.37454 | spectral_norm = 9.56629 | nuclear_norm = 3562.17627
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 65.94990 | spectral_norm = 5.33042 | nuclear_norm = 1738.54553
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 56.58918 | spectral_norm = 4.74678 | nuclear_norm = 1305.41003
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 56.63941 | spectral_norm = 4.83443 | nuclear_norm = 1303.01929
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 148.26431 | spectral_norm = 12.71585 | nuclear_norm = 3423.65845
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 155.42365 | spectral_norm = 10.79072 | nuclear_norm = 3687.52246
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 133.37161 | spectral_norm = 9.54803 | nuclear_norm = 3537.25781
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 65.95493 | spectral_norm = 5.29387 | nuclear_norm = 1740.37500
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 56.76339 | spectral_norm = 4.87610 | nuclear_norm = 1315.27002
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 56.61658 | spectral_norm = 4.82034 | nuclear_norm = 1308.01758
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 153.59433 | spectral_norm = 12.34555 | nuclear_norm = 3526.30566
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 156.40538 | spectral_norm = 10.92977 | nuclear_norm = 3721.45874
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 135.48293 | spectral_norm = 9.51970 | nuclear_norm = 3593.99072
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 66.50718 | spectral_norm = 5.41711 | nuclear_norm = 1755.85986
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 57.19952 | spectral_norm = 5.00883 | nuclear_norm = 1332.91211
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 56.78076 | spectral_norm = 4.96443 | nuclear_norm = 1321.12390
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 145.90564 | spectral_norm = 11.80502 | nuclear_norm = 3353.55566
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 153.37729 | spectral_norm = 11.50086 | nuclear_norm = 3658.09375
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 137.31592 | spectral_norm = 9.38240 | nuclear_norm = 3644.79785
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 67.17070 | spectral_norm = 5.31203 | nuclear_norm = 1773.47388
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 57.27632 | spectral_norm = 5.52137 | nuclear_norm = 1321.01514
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 56.67496 | spectral_norm = 5.31861 | nuclear_norm = 1298.88940
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 135.45312 | spectral_norm = 11.57490 | nuclear_norm = 3106.57031
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 153.12410 | spectral_norm = 10.57181 | nuclear_norm = 3632.97363
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 134.72322 | spectral_norm = 9.45925 | nuclear_norm = 3575.53613
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 65.82800 | spectral_norm = 5.46542 | nuclear_norm = 1733.92920
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 553.48682 | spectral_norm = 153.05530 | nuclear_norm = 13785.36133
===========================================
step:251/1750 train_loss:4.0809 train_time:80721ms step_avg:334.94ms
step:252/1750 train_loss:4.1678 train_time:81056ms step_avg:334.94ms
step:253/1750 train_loss:3.9330 train_time:81391ms step_avg:334.94ms
step:254/1750 train_loss:3.8822 train_time:81726ms step_avg:334.94ms
step:255/1750 train_loss:4.0792 train_time:82061ms step_avg:334.94ms
step:256/1750 train_loss:3.9774 train_time:82396ms step_avg:334.94ms
step:257/1750 train_loss:3.9873 train_time:82732ms step_avg:334.95ms
step:258/1750 train_loss:3.9888 train_time:83068ms step_avg:334.95ms
step:259/1750 train_loss:4.0314 train_time:83404ms step_avg:334.95ms
step:260/1750 train_loss:4.0601 train_time:83740ms step_avg:334.96ms
step:261/1750 train_loss:4.0176 train_time:84082ms step_avg:334.99ms
step:262/1750 train_loss:3.9941 train_time:84428ms step_avg:335.03ms
step:263/1750 train_loss:3.8879 train_time:84774ms step_avg:335.07ms
step:264/1750 train_loss:3.9851 train_time:85119ms step_avg:335.11ms
step:265/1750 train_loss:3.8637 train_time:85465ms step_avg:335.16ms
step:266/1750 train_loss:3.9151 train_time:85810ms step_avg:335.20ms
step:267/1750 train_loss:3.9172 train_time:86157ms step_avg:335.24ms
step:268/1750 train_loss:3.9597 train_time:86504ms step_avg:335.29ms
step:269/1750 train_loss:3.8608 train_time:86849ms step_avg:335.33ms
step:270/1750 train_loss:4.1033 train_time:87195ms step_avg:335.37ms
step:271/1750 train_loss:3.9639 train_time:87541ms step_avg:335.41ms
step:272/1750 train_loss:3.9205 train_time:87887ms step_avg:335.45ms
step:273/1750 train_loss:3.9467 train_time:88230ms step_avg:335.47ms
step:274/1750 train_loss:4.0283 train_time:88576ms step_avg:335.52ms
step:275/1750 train_loss:4.0536 train_time:88923ms step_avg:335.56ms
step:276/1750 train_loss:4.2157 train_time:89268ms step_avg:335.59ms
step:277/1750 train_loss:4.0278 train_time:89614ms step_avg:335.63ms
step:278/1750 train_loss:4.0843 train_time:89961ms step_avg:335.67ms
step:279/1750 train_loss:3.9917 train_time:90305ms step_avg:335.71ms
step:280/1750 train_loss:4.1668 train_time:90653ms step_avg:335.75ms
step:281/1750 train_loss:3.9656 train_time:91001ms step_avg:335.80ms
step:282/1750 train_loss:3.9358 train_time:91350ms step_avg:335.84ms
step:283/1750 train_loss:3.9150 train_time:91694ms step_avg:335.88ms
step:284/1750 train_loss:4.0432 train_time:92040ms step_avg:335.91ms
step:285/1750 train_loss:4.0578 train_time:92386ms step_avg:335.95ms
step:286/1750 train_loss:4.0842 train_time:92730ms step_avg:335.98ms
step:287/1750 train_loss:3.9097 train_time:93077ms step_avg:336.02ms
step:288/1750 train_loss:4.0109 train_time:93424ms step_avg:336.06ms
step:289/1750 train_loss:3.8810 train_time:93769ms step_avg:336.09ms
step:290/1750 train_loss:3.8435 train_time:94116ms step_avg:336.13ms
step:291/1750 train_loss:3.9031 train_time:94463ms step_avg:336.17ms
step:292/1750 train_loss:3.8691 train_time:94808ms step_avg:336.20ms
step:293/1750 train_loss:3.9085 train_time:95153ms step_avg:336.23ms
step:294/1750 train_loss:3.9438 train_time:95499ms step_avg:336.26ms
step:295/1750 train_loss:3.8374 train_time:95845ms step_avg:336.30ms
step:296/1750 train_loss:3.8681 train_time:96193ms step_avg:336.34ms
step:297/1750 train_loss:3.8610 train_time:96539ms step_avg:336.37ms
step:298/1750 train_loss:3.9809 train_time:96885ms step_avg:336.41ms
step:299/1750 train_loss:3.8251 train_time:97231ms step_avg:336.44ms
step:300/1750 train_loss:3.9665 train_time:97580ms step_avg:336.48ms
step:301/1750 train_loss:3.9710 train_time:97923ms step_avg:336.51ms
step:302/1750 train_loss:3.9322 train_time:98269ms step_avg:336.54ms
step:303/1750 train_loss:3.9795 train_time:98614ms step_avg:336.57ms
step:304/1750 train_loss:3.9655 train_time:98960ms step_avg:336.60ms
step:305/1750 train_loss:4.4614 train_time:99304ms step_avg:336.62ms
step:306/1750 train_loss:3.9407 train_time:99649ms step_avg:336.65ms
step:307/1750 train_loss:3.8418 train_time:99993ms step_avg:336.68ms
step:308/1750 train_loss:3.9810 train_time:100337ms step_avg:336.70ms
step:309/1750 train_loss:3.8752 train_time:100683ms step_avg:336.73ms
step:310/1750 train_loss:4.0891 train_time:101028ms step_avg:336.76ms
step:311/1750 train_loss:3.9326 train_time:101376ms step_avg:336.80ms
step:312/1750 train_loss:3.8575 train_time:101723ms step_avg:336.83ms
step:313/1750 train_loss:3.9405 train_time:102071ms step_avg:336.87ms
step:314/1750 train_loss:4.0641 train_time:102418ms step_avg:336.90ms
step:315/1750 train_loss:3.9516 train_time:102762ms step_avg:336.93ms
step:316/1750 train_loss:3.7976 train_time:103108ms step_avg:336.95ms
step:317/1750 train_loss:3.8790 train_time:103455ms step_avg:336.99ms
step:318/1750 train_loss:3.9291 train_time:103800ms step_avg:337.01ms
step:319/1750 train_loss:3.8882 train_time:104144ms step_avg:337.03ms
step:320/1750 train_loss:4.0130 train_time:104489ms step_avg:337.06ms
step:321/1750 train_loss:3.9542 train_time:104835ms step_avg:337.09ms
step:322/1750 train_loss:3.9324 train_time:105181ms step_avg:337.12ms
step:323/1750 train_loss:4.0093 train_time:105528ms step_avg:337.15ms
step:324/1750 train_loss:3.9495 train_time:105876ms step_avg:337.18ms
step:325/1750 train_loss:4.0162 train_time:106221ms step_avg:337.21ms
step:326/1750 train_loss:3.8966 train_time:106568ms step_avg:337.24ms
step:327/1750 train_loss:4.3890 train_time:106914ms step_avg:337.27ms
step:328/1750 train_loss:4.0701 train_time:107260ms step_avg:337.30ms
step:329/1750 train_loss:3.8023 train_time:107603ms step_avg:337.31ms
step:330/1750 train_loss:3.7437 train_time:107948ms step_avg:337.34ms
step:331/1750 train_loss:3.9736 train_time:108291ms step_avg:337.36ms
step:332/1750 train_loss:3.9109 train_time:108636ms step_avg:337.38ms
step:333/1750 train_loss:3.8802 train_time:108981ms step_avg:337.40ms
step:334/1750 train_loss:3.8416 train_time:109324ms step_avg:337.42ms
step:335/1750 train_loss:4.0069 train_time:109668ms step_avg:337.44ms
step:336/1750 train_loss:3.9715 train_time:110012ms step_avg:337.46ms
step:337/1750 train_loss:4.4310 train_time:110355ms step_avg:337.48ms
step:338/1750 train_loss:3.9372 train_time:110698ms step_avg:337.49ms
step:339/1750 train_loss:3.8616 train_time:111044ms step_avg:337.52ms
step:340/1750 train_loss:3.9304 train_time:111388ms step_avg:337.54ms
step:341/1750 train_loss:3.8476 train_time:111730ms step_avg:337.55ms
step:342/1750 train_loss:3.8113 train_time:112074ms step_avg:337.57ms
step:343/1750 train_loss:3.8378 train_time:112419ms step_avg:337.60ms
step:344/1750 train_loss:3.9949 train_time:112763ms step_avg:337.61ms
step:345/1750 train_loss:3.8186 train_time:113108ms step_avg:337.64ms
step:346/1750 train_loss:3.7722 train_time:113451ms step_avg:337.65ms
step:347/1750 train_loss:3.7936 train_time:113797ms step_avg:337.68ms
step:348/1750 train_loss:3.8511 train_time:114141ms step_avg:337.70ms
step:349/1750 train_loss:3.8325 train_time:114486ms step_avg:337.72ms
step:350/1750 train_loss:3.5655 train_time:114830ms step_avg:337.74ms
step:351/1750 train_loss:3.8210 train_time:115176ms step_avg:337.76ms
step:352/1750 train_loss:4.1852 train_time:115518ms step_avg:337.77ms
step:353/1750 train_loss:3.6591 train_time:115861ms step_avg:337.79ms
step:354/1750 train_loss:3.9299 train_time:116204ms step_avg:337.80ms
step:355/1750 train_loss:3.7858 train_time:116547ms step_avg:337.82ms
step:356/1750 train_loss:3.8775 train_time:116891ms step_avg:337.83ms
step:357/1750 train_loss:3.7513 train_time:117234ms step_avg:337.85ms
step:358/1750 train_loss:3.8534 train_time:117581ms step_avg:337.88ms
step:359/1750 train_loss:3.7846 train_time:117928ms step_avg:337.90ms
step:360/1750 train_loss:3.4218 train_time:118273ms step_avg:337.92ms
step:361/1750 train_loss:4.0297 train_time:118617ms step_avg:337.94ms
step:362/1750 train_loss:3.9237 train_time:118962ms step_avg:337.96ms
step:363/1750 train_loss:3.8434 train_time:119306ms step_avg:337.98ms
step:364/1750 train_loss:3.7438 train_time:119652ms step_avg:338.00ms
step:365/1750 train_loss:3.9184 train_time:119997ms step_avg:338.02ms
step:366/1750 train_loss:3.8643 train_time:120343ms step_avg:338.04ms
step:367/1750 train_loss:3.8632 train_time:120687ms step_avg:338.06ms
step:368/1750 train_loss:3.8508 train_time:121031ms step_avg:338.08ms
step:369/1750 train_loss:3.7450 train_time:121377ms step_avg:338.10ms
step:370/1750 train_loss:3.8871 train_time:121721ms step_avg:338.12ms
step:371/1750 train_loss:3.7372 train_time:122066ms step_avg:338.13ms
step:372/1750 train_loss:3.6962 train_time:122410ms step_avg:338.15ms
step:373/1750 train_loss:3.9176 train_time:122753ms step_avg:338.16ms
step:374/1750 train_loss:3.8356 train_time:123098ms step_avg:338.18ms
step:375/1750 train_loss:3.7991 train_time:123444ms step_avg:338.20ms
step:375/1750 val_loss:3.8268 train_time:123531ms step_avg:338.44ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 184.97446 | frobenius_norm = 42348.01172 | spectral_norm = 8164.27148 | nuclear_norm = 1048223.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 84.84102 | spectral_norm = 10.41297 | nuclear_norm = 1987.39417
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 82.65630 | spectral_norm = 12.42997 | nuclear_norm = 1928.04004
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 169.55048 | spectral_norm = 10.83455 | nuclear_norm = 4044.89429
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 151.16676 | spectral_norm = 12.85092 | nuclear_norm = 3537.83740
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 173.74060 | spectral_norm = 13.51612 | nuclear_norm = 4615.09668
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 90.26079 | spectral_norm = 6.63657 | nuclear_norm = 2396.88916
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 83.94665 | spectral_norm = 7.16788 | nuclear_norm = 1967.20129
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 83.03548 | spectral_norm = 8.37607 | nuclear_norm = 1944.76965
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 186.72018 | spectral_norm = 15.75445 | nuclear_norm = 4324.03174
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 181.93825 | spectral_norm = 14.41524 | nuclear_norm = 4283.36084
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 183.58244 | spectral_norm = 12.20544 | nuclear_norm = 4879.64111
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 91.23990 | spectral_norm = 7.72745 | nuclear_norm = 2410.64209
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 82.59048 | spectral_norm = 7.45409 | nuclear_norm = 1931.37146
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 81.83209 | spectral_norm = 7.88167 | nuclear_norm = 1915.07275
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 184.65427 | spectral_norm = 15.36015 | nuclear_norm = 4235.23145
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 185.63431 | spectral_norm = 13.76058 | nuclear_norm = 4362.80615
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 187.29199 | spectral_norm = 13.16961 | nuclear_norm = 4979.62598
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 92.29267 | spectral_norm = 7.73519 | nuclear_norm = 2432.22119
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 81.08262 | spectral_norm = 6.93249 | nuclear_norm = 1864.08252
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 80.11559 | spectral_norm = 7.56109 | nuclear_norm = 1842.29565
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 177.81024 | spectral_norm = 15.12804 | nuclear_norm = 4058.90186
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 185.51331 | spectral_norm = 14.05859 | nuclear_norm = 4351.83203
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 190.61430 | spectral_norm = 12.86447 | nuclear_norm = 5067.38135
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 93.15974 | spectral_norm = 8.20321 | nuclear_norm = 2455.12939
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 81.84465 | spectral_norm = 7.09616 | nuclear_norm = 1902.65930
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 81.85412 | spectral_norm = 6.86044 | nuclear_norm = 1904.05505
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 186.84679 | spectral_norm = 16.88831 | nuclear_norm = 4236.80615
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 187.81265 | spectral_norm = 14.00563 | nuclear_norm = 4420.22461
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 191.17468 | spectral_norm = 14.17960 | nuclear_norm = 5077.86523
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 92.67921 | spectral_norm = 7.40017 | nuclear_norm = 2436.40088
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 80.41042 | spectral_norm = 7.44589 | nuclear_norm = 1857.46008
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 80.09199 | spectral_norm = 7.48003 | nuclear_norm = 1848.62073
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 182.99155 | spectral_norm = 15.35887 | nuclear_norm = 4211.70898
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 185.62372 | spectral_norm = 14.17418 | nuclear_norm = 4376.22314
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 192.87872 | spectral_norm = 12.50049 | nuclear_norm = 5127.32178
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 92.66143 | spectral_norm = 7.43939 | nuclear_norm = 2440.70044
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 82.03139 | spectral_norm = 7.01917 | nuclear_norm = 1903.39038
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 81.75240 | spectral_norm = 6.78964 | nuclear_norm = 1898.88513
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 192.63330 | spectral_norm = 16.26289 | nuclear_norm = 4372.54980
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 186.33015 | spectral_norm = 14.36996 | nuclear_norm = 4379.99609
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 187.08916 | spectral_norm = 12.99844 | nuclear_norm = 4974.58203
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 92.12706 | spectral_norm = 7.72981 | nuclear_norm = 2424.60840
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 80.24173 | spectral_norm = 7.31641 | nuclear_norm = 1859.75439
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 79.98295 | spectral_norm = 6.97327 | nuclear_norm = 1856.32593
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 182.59206 | spectral_norm = 15.38436 | nuclear_norm = 4157.28613
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 185.64587 | spectral_norm = 14.45950 | nuclear_norm = 4346.62646
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 189.66061 | spectral_norm = 14.07407 | nuclear_norm = 5038.10889
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 92.93861 | spectral_norm = 7.80654 | nuclear_norm = 2452.05298
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 82.66681 | spectral_norm = 7.44597 | nuclear_norm = 1900.25854
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 82.40933 | spectral_norm = 7.20940 | nuclear_norm = 1882.45496
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 188.09805 | spectral_norm = 14.86947 | nuclear_norm = 4354.28027
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 196.96371 | spectral_norm = 13.61318 | nuclear_norm = 4655.66553
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 187.16313 | spectral_norm = 14.30450 | nuclear_norm = 4974.53711
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 93.27643 | spectral_norm = 7.87862 | nuclear_norm = 2466.22607
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 83.28030 | spectral_norm = 7.36752 | nuclear_norm = 1927.95703
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 82.50149 | spectral_norm = 7.25771 | nuclear_norm = 1903.09595
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 198.77554 | spectral_norm = 16.48677 | nuclear_norm = 4565.17090
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 197.62044 | spectral_norm = 13.97595 | nuclear_norm = 4678.35254
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 189.71805 | spectral_norm = 14.01059 | nuclear_norm = 5043.77930
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 93.44450 | spectral_norm = 8.21778 | nuclear_norm = 2471.84082
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 84.04983 | spectral_norm = 7.62772 | nuclear_norm = 1956.22498
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 82.68874 | spectral_norm = 7.49407 | nuclear_norm = 1920.96265
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 186.27332 | spectral_norm = 16.26990 | nuclear_norm = 4285.32324
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 193.13957 | spectral_norm = 14.82714 | nuclear_norm = 4584.14844
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 194.37135 | spectral_norm = 13.18945 | nuclear_norm = 5172.68652
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 93.55074 | spectral_norm = 8.24566 | nuclear_norm = 2474.60352
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 83.40083 | spectral_norm = 8.24744 | nuclear_norm = 1917.33484
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 82.15709 | spectral_norm = 7.90125 | nuclear_norm = 1874.30933
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 172.47247 | spectral_norm = 15.51936 | nuclear_norm = 3962.05835
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 193.58435 | spectral_norm = 14.24276 | nuclear_norm = 4556.39551
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 194.51982 | spectral_norm = 13.97906 | nuclear_norm = 5178.26123
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 93.94585 | spectral_norm = 8.70256 | nuclear_norm = 2481.26660
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 695.02319 | spectral_norm = 164.26314 | nuclear_norm = 17632.98438
===========================================
step:376/1750 train_loss:3.8674 train_time:123788ms step_avg:338.22ms
step:377/1750 train_loss:3.7974 train_time:124147ms step_avg:338.28ms
step:378/1750 train_loss:3.8539 train_time:124578ms step_avg:338.53ms
step:379/1750 train_loss:3.8649 train_time:125067ms step_avg:338.94ms
step:380/1750 train_loss:3.9545 train_time:125409ms step_avg:338.94ms
step:381/1750 train_loss:3.8484 train_time:125749ms step_avg:338.94ms
step:382/1750 train_loss:3.8107 train_time:126091ms step_avg:338.95ms
step:383/1750 train_loss:3.8011 train_time:126432ms step_avg:338.96ms
step:384/1750 train_loss:3.8724 train_time:126774ms step_avg:338.97ms
step:385/1750 train_loss:3.7900 train_time:127118ms step_avg:338.98ms
step:386/1750 train_loss:3.8927 train_time:127461ms step_avg:338.99ms
step:387/1750 train_loss:4.0576 train_time:127805ms step_avg:339.01ms
step:388/1750 train_loss:3.7948 train_time:128150ms step_avg:339.02ms
step:389/1750 train_loss:3.7937 train_time:128494ms step_avg:339.03ms
step:390/1750 train_loss:3.9014 train_time:128842ms step_avg:339.06ms
step:391/1750 train_loss:3.8149 train_time:129191ms step_avg:339.08ms
step:392/1750 train_loss:3.9227 train_time:129539ms step_avg:339.11ms
step:393/1750 train_loss:3.7600 train_time:129889ms step_avg:339.14ms
step:394/1750 train_loss:3.8874 train_time:130239ms step_avg:339.16ms
step:395/1750 train_loss:3.6191 train_time:130589ms step_avg:339.19ms
step:396/1750 train_loss:3.8340 train_time:130940ms step_avg:339.22ms
step:397/1750 train_loss:3.8674 train_time:131292ms step_avg:339.26ms
step:398/1750 train_loss:3.8681 train_time:131642ms step_avg:339.28ms
step:399/1750 train_loss:3.7740 train_time:131991ms step_avg:339.31ms
step:400/1750 train_loss:3.8286 train_time:132345ms step_avg:339.35ms
step:401/1750 train_loss:3.9135 train_time:132693ms step_avg:339.37ms
step:402/1750 train_loss:3.8390 train_time:133045ms step_avg:339.40ms
step:403/1750 train_loss:3.9628 train_time:133396ms step_avg:339.43ms
step:404/1750 train_loss:3.6897 train_time:133746ms step_avg:339.46ms
step:405/1750 train_loss:3.7884 train_time:134096ms step_avg:339.48ms
step:406/1750 train_loss:4.0922 train_time:134445ms step_avg:339.51ms
step:407/1750 train_loss:3.7848 train_time:134795ms step_avg:339.54ms
step:408/1750 train_loss:3.8182 train_time:135144ms step_avg:339.56ms
step:409/1750 train_loss:3.8625 train_time:135495ms step_avg:339.59ms
step:410/1750 train_loss:3.7610 train_time:135844ms step_avg:339.61ms
step:411/1750 train_loss:3.7613 train_time:136193ms step_avg:339.63ms
step:412/1750 train_loss:4.1873 train_time:136541ms step_avg:339.66ms
step:413/1750 train_loss:3.6830 train_time:136892ms step_avg:339.68ms
step:414/1750 train_loss:4.0173 train_time:137242ms step_avg:339.71ms
step:415/1750 train_loss:3.7596 train_time:137593ms step_avg:339.73ms
step:416/1750 train_loss:3.7642 train_time:137943ms step_avg:339.76ms
step:417/1750 train_loss:3.9596 train_time:138295ms step_avg:339.79ms
step:418/1750 train_loss:3.6908 train_time:138644ms step_avg:339.81ms
step:419/1750 train_loss:3.8114 train_time:138994ms step_avg:339.84ms
step:420/1750 train_loss:3.7082 train_time:139347ms step_avg:339.87ms
step:421/1750 train_loss:3.6534 train_time:139698ms step_avg:339.90ms
step:422/1750 train_loss:3.7843 train_time:140048ms step_avg:339.92ms
step:423/1750 train_loss:3.8750 train_time:140397ms step_avg:339.94ms
step:424/1750 train_loss:3.6174 train_time:140749ms step_avg:339.97ms
step:425/1750 train_loss:3.8046 train_time:141099ms step_avg:340.00ms
step:426/1750 train_loss:3.6681 train_time:141449ms step_avg:340.02ms
step:427/1750 train_loss:3.8984 train_time:141800ms step_avg:340.05ms
step:428/1750 train_loss:3.8206 train_time:142150ms step_avg:340.07ms
step:429/1750 train_loss:3.7653 train_time:142499ms step_avg:340.09ms
step:430/1750 train_loss:3.7272 train_time:142847ms step_avg:340.11ms
step:431/1750 train_loss:3.6266 train_time:143197ms step_avg:340.14ms
step:432/1750 train_loss:3.7712 train_time:143545ms step_avg:340.15ms
step:433/1750 train_loss:3.8247 train_time:143895ms step_avg:340.18ms
step:434/1750 train_loss:3.7857 train_time:144246ms step_avg:340.20ms
step:435/1750 train_loss:3.8155 train_time:144598ms step_avg:340.23ms
step:436/1750 train_loss:3.8400 train_time:144948ms step_avg:340.25ms
step:437/1750 train_loss:3.7227 train_time:145301ms step_avg:340.28ms
step:438/1750 train_loss:3.7139 train_time:145650ms step_avg:340.30ms
step:439/1750 train_loss:3.7187 train_time:146000ms step_avg:340.33ms
step:440/1750 train_loss:3.9004 train_time:146349ms step_avg:340.35ms
step:441/1750 train_loss:3.7669 train_time:146698ms step_avg:340.37ms
step:442/1750 train_loss:3.7414 train_time:147048ms step_avg:340.39ms
step:443/1750 train_loss:3.6238 train_time:147398ms step_avg:340.41ms
step:444/1750 train_loss:3.9233 train_time:147749ms step_avg:340.44ms
step:445/1750 train_loss:3.8475 train_time:148099ms step_avg:340.46ms
step:446/1750 train_loss:3.8475 train_time:148450ms step_avg:340.48ms
step:447/1750 train_loss:3.7542 train_time:148801ms step_avg:340.51ms
step:448/1750 train_loss:3.8555 train_time:149154ms step_avg:340.53ms
step:449/1750 train_loss:3.6961 train_time:149506ms step_avg:340.56ms
step:450/1750 train_loss:3.7178 train_time:149855ms step_avg:340.58ms
step:451/1750 train_loss:3.5800 train_time:150206ms step_avg:340.60ms
step:452/1750 train_loss:3.7187 train_time:150554ms step_avg:340.62ms
step:453/1750 train_loss:3.6797 train_time:150906ms step_avg:340.64ms
step:454/1750 train_loss:3.6402 train_time:151257ms step_avg:340.67ms
step:455/1750 train_loss:3.8452 train_time:151608ms step_avg:340.69ms
step:456/1750 train_loss:3.7336 train_time:151956ms step_avg:340.71ms
step:457/1750 train_loss:3.7910 train_time:152306ms step_avg:340.73ms
step:458/1750 train_loss:3.8370 train_time:152656ms step_avg:340.75ms
step:459/1750 train_loss:3.6415 train_time:153008ms step_avg:340.77ms
step:460/1750 train_loss:3.7969 train_time:153356ms step_avg:340.79ms
step:461/1750 train_loss:3.6903 train_time:153704ms step_avg:340.81ms
step:462/1750 train_loss:3.7446 train_time:154054ms step_avg:340.83ms
step:463/1750 train_loss:3.7813 train_time:154402ms step_avg:340.84ms
step:464/1750 train_loss:3.7203 train_time:154749ms step_avg:340.86ms
step:465/1750 train_loss:3.7272 train_time:155097ms step_avg:340.87ms
step:466/1750 train_loss:3.8089 train_time:155448ms step_avg:340.90ms
step:467/1750 train_loss:3.8259 train_time:155799ms step_avg:340.92ms
step:468/1750 train_loss:3.8012 train_time:156147ms step_avg:340.93ms
step:469/1750 train_loss:3.6929 train_time:156496ms step_avg:340.95ms
step:470/1750 train_loss:3.7739 train_time:156845ms step_avg:340.97ms
step:471/1750 train_loss:3.8231 train_time:157193ms step_avg:340.98ms
step:472/1750 train_loss:3.7901 train_time:157542ms step_avg:341.00ms
step:473/1750 train_loss:3.7268 train_time:157891ms step_avg:341.02ms
step:474/1750 train_loss:3.5899 train_time:158239ms step_avg:341.03ms
step:475/1750 train_loss:4.0183 train_time:158587ms step_avg:341.05ms
step:476/1750 train_loss:3.7736 train_time:158939ms step_avg:341.07ms
step:477/1750 train_loss:3.6044 train_time:159291ms step_avg:341.09ms
step:478/1750 train_loss:3.8267 train_time:159639ms step_avg:341.11ms
step:479/1750 train_loss:3.7831 train_time:159991ms step_avg:341.13ms
step:480/1750 train_loss:3.9204 train_time:160341ms step_avg:341.15ms
step:481/1750 train_loss:3.7330 train_time:160689ms step_avg:341.17ms
step:482/1750 train_loss:3.5347 train_time:161038ms step_avg:341.18ms
step:483/1750 train_loss:3.8184 train_time:161388ms step_avg:341.20ms
step:484/1750 train_loss:3.6673 train_time:161740ms step_avg:341.22ms
step:485/1750 train_loss:3.6647 train_time:162090ms step_avg:341.24ms
step:486/1750 train_loss:3.5799 train_time:162440ms step_avg:341.26ms
step:487/1750 train_loss:3.6822 train_time:162788ms step_avg:341.27ms
step:488/1750 train_loss:3.8777 train_time:163136ms step_avg:341.29ms
step:489/1750 train_loss:3.7219 train_time:163486ms step_avg:341.31ms
step:490/1750 train_loss:3.5991 train_time:163836ms step_avg:341.32ms
step:491/1750 train_loss:3.6247 train_time:164184ms step_avg:341.34ms
step:492/1750 train_loss:3.7429 train_time:164534ms step_avg:341.36ms
step:493/1750 train_loss:3.5844 train_time:164885ms step_avg:341.38ms
step:494/1750 train_loss:3.7115 train_time:165235ms step_avg:341.39ms
step:495/1750 train_loss:3.6727 train_time:165584ms step_avg:341.41ms
step:496/1750 train_loss:3.5279 train_time:165934ms step_avg:341.43ms
step:497/1750 train_loss:3.7424 train_time:166282ms step_avg:341.44ms
step:498/1750 train_loss:3.7990 train_time:166631ms step_avg:341.46ms
step:499/1750 train_loss:3.8311 train_time:166983ms step_avg:341.48ms
step:500/1750 train_loss:3.7399 train_time:167334ms step_avg:341.50ms
step:500/1750 val_loss:3.7140 train_time:167420ms step_avg:341.67ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 206.90096 | frobenius_norm = 47450.25000 | spectral_norm = 8790.40234 | nuclear_norm = 1179003.62500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 106.28548 | spectral_norm = 14.45854 | nuclear_norm = 2480.16846
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 103.16212 | spectral_norm = 16.35246 | nuclear_norm = 2395.58789
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 206.31369 | spectral_norm = 13.08717 | nuclear_norm = 4941.54199
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 176.04596 | spectral_norm = 15.47516 | nuclear_norm = 4110.81934
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 218.44373 | spectral_norm = 17.21551 | nuclear_norm = 5800.78564
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 113.79430 | spectral_norm = 9.06215 | nuclear_norm = 3022.08032
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 106.21479 | spectral_norm = 9.14433 | nuclear_norm = 2481.67041
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 104.92845 | spectral_norm = 10.11788 | nuclear_norm = 2452.03027
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 217.19730 | spectral_norm = 18.89629 | nuclear_norm = 5020.25537
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 212.56674 | spectral_norm = 16.70899 | nuclear_norm = 4997.19141
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 227.23650 | spectral_norm = 15.44077 | nuclear_norm = 6040.57129
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 113.13911 | spectral_norm = 10.18305 | nuclear_norm = 2986.24976
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 104.04927 | spectral_norm = 9.71282 | nuclear_norm = 2422.42822
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 103.01968 | spectral_norm = 9.75302 | nuclear_norm = 2401.84229
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 216.53291 | spectral_norm = 18.08511 | nuclear_norm = 4963.54053
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 218.53406 | spectral_norm = 16.18933 | nuclear_norm = 5126.63770
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 231.46426 | spectral_norm = 16.98689 | nuclear_norm = 6152.59180
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 114.15118 | spectral_norm = 10.15534 | nuclear_norm = 3003.97876
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 101.61297 | spectral_norm = 9.05021 | nuclear_norm = 2314.02759
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 100.43535 | spectral_norm = 9.27657 | nuclear_norm = 2289.24658
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 209.43864 | spectral_norm = 18.35174 | nuclear_norm = 4765.03418
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 218.34242 | spectral_norm = 17.07329 | nuclear_norm = 5101.71094
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 235.73395 | spectral_norm = 16.71784 | nuclear_norm = 6265.64453
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 115.10808 | spectral_norm = 10.71236 | nuclear_norm = 3030.25610
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 102.74686 | spectral_norm = 9.27928 | nuclear_norm = 2374.75415
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 102.62607 | spectral_norm = 8.83543 | nuclear_norm = 2374.41870
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 222.84721 | spectral_norm = 20.63111 | nuclear_norm = 5045.95068
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 224.29628 | spectral_norm = 16.90101 | nuclear_norm = 5273.59082
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 236.96748 | spectral_norm = 18.39820 | nuclear_norm = 6295.48340
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 114.62615 | spectral_norm = 9.64997 | nuclear_norm = 3010.35693
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 100.95583 | spectral_norm = 9.78494 | nuclear_norm = 2317.07910
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 100.49084 | spectral_norm = 9.65516 | nuclear_norm = 2304.94800
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 219.18437 | spectral_norm = 18.25475 | nuclear_norm = 5044.02539
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 220.68066 | spectral_norm = 16.95373 | nuclear_norm = 5198.47852
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 239.54369 | spectral_norm = 16.00620 | nuclear_norm = 6371.80957
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 115.16976 | spectral_norm = 9.79471 | nuclear_norm = 3033.10303
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 102.85136 | spectral_norm = 9.09005 | nuclear_norm = 2368.68164
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 102.11375 | spectral_norm = 8.75773 | nuclear_norm = 2357.23047
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 229.22212 | spectral_norm = 19.81359 | nuclear_norm = 5190.02832
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 222.66447 | spectral_norm = 17.00872 | nuclear_norm = 5228.24219
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 232.42818 | spectral_norm = 16.60856 | nuclear_norm = 6185.45068
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 114.72358 | spectral_norm = 9.71420 | nuclear_norm = 3018.74780
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 100.80478 | spectral_norm = 9.43856 | nuclear_norm = 2319.55469
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 100.10910 | spectral_norm = 9.05238 | nuclear_norm = 2311.06104
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 219.28287 | spectral_norm = 18.36294 | nuclear_norm = 4983.42383
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 220.62607 | spectral_norm = 17.33841 | nuclear_norm = 5134.01758
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 235.55484 | spectral_norm = 17.95825 | nuclear_norm = 6261.04346
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 116.13618 | spectral_norm = 9.94984 | nuclear_norm = 3065.14624
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 104.30917 | spectral_norm = 9.90551 | nuclear_norm = 2377.73999
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 103.99156 | spectral_norm = 9.47083 | nuclear_norm = 2350.16699
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 222.08308 | spectral_norm = 17.61664 | nuclear_norm = 5134.19385
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 232.13034 | spectral_norm = 15.95831 | nuclear_norm = 5479.76611
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 232.86537 | spectral_norm = 18.39169 | nuclear_norm = 6191.32227
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 117.35194 | spectral_norm = 10.34211 | nuclear_norm = 3106.78174
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 105.27483 | spectral_norm = 9.78150 | nuclear_norm = 2421.26978
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 103.99335 | spectral_norm = 9.55782 | nuclear_norm = 2382.24023
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 237.49684 | spectral_norm = 20.46131 | nuclear_norm = 5442.49121
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 233.85506 | spectral_norm = 16.66994 | nuclear_norm = 5521.37793
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 235.11699 | spectral_norm = 18.16559 | nuclear_norm = 6254.56104
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 117.19616 | spectral_norm = 10.80096 | nuclear_norm = 3104.11206
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 106.44798 | spectral_norm = 10.11666 | nuclear_norm = 2462.30493
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 104.24197 | spectral_norm = 9.90251 | nuclear_norm = 2408.62720
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 221.83635 | spectral_norm = 20.50629 | nuclear_norm = 5098.18750
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 228.50957 | spectral_norm = 17.51951 | nuclear_norm = 5410.93018
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 242.13600 | spectral_norm = 17.01673 | nuclear_norm = 6448.89355
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 115.90161 | spectral_norm = 11.17733 | nuclear_norm = 3066.99316
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 105.06643 | spectral_norm = 11.14526 | nuclear_norm = 2396.23730
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 103.36449 | spectral_norm = 10.47915 | nuclear_norm = 2337.15771
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 204.88794 | spectral_norm = 19.12396 | nuclear_norm = 4701.87891
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 229.31097 | spectral_norm = 17.41873 | nuclear_norm = 5378.62695
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 244.66936 | spectral_norm = 18.16140 | nuclear_norm = 6518.05762
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 116.41431 | spectral_norm = 11.95417 | nuclear_norm = 3072.64795
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 814.72559 | spectral_norm = 169.05696 | nuclear_norm = 20902.91016
===========================================
step:501/1750 train_loss:3.8128 train_time:167676ms step_avg:341.50ms
step:502/1750 train_loss:3.7518 train_time:168019ms step_avg:341.50ms
step:503/1750 train_loss:3.7837 train_time:168365ms step_avg:341.51ms
step:504/1750 train_loss:3.7319 train_time:168710ms step_avg:341.52ms
step:505/1750 train_loss:3.8131 train_time:169058ms step_avg:341.53ms
step:506/1750 train_loss:3.6603 train_time:169403ms step_avg:341.54ms
step:507/1750 train_loss:3.7754 train_time:169749ms step_avg:341.55ms
step:508/1750 train_loss:3.8411 train_time:170099ms step_avg:341.56ms
step:509/1750 train_loss:3.7824 train_time:170445ms step_avg:341.57ms
step:510/1750 train_loss:3.5904 train_time:170792ms step_avg:341.58ms
step:511/1750 train_loss:3.7933 train_time:171141ms step_avg:341.60ms
step:512/1750 train_loss:3.7365 train_time:171493ms step_avg:341.62ms
step:513/1750 train_loss:3.6719 train_time:171841ms step_avg:341.63ms
step:514/1750 train_loss:3.8154 train_time:172188ms step_avg:341.64ms
step:515/1750 train_loss:3.7391 train_time:172536ms step_avg:341.66ms
step:516/1750 train_loss:4.0894 train_time:172886ms step_avg:341.67ms
step:517/1750 train_loss:3.6988 train_time:173235ms step_avg:341.69ms
step:518/1750 train_loss:3.7835 train_time:173583ms step_avg:341.70ms
step:519/1750 train_loss:3.6669 train_time:173932ms step_avg:341.71ms
step:520/1750 train_loss:3.6903 train_time:174286ms step_avg:341.74ms
step:521/1750 train_loss:3.6661 train_time:174641ms step_avg:341.76ms
step:522/1750 train_loss:3.6613 train_time:174999ms step_avg:341.79ms
step:523/1750 train_loss:4.2879 train_time:175354ms step_avg:341.82ms
step:524/1750 train_loss:3.7466 train_time:175708ms step_avg:341.84ms
step:525/1750 train_loss:3.6914 train_time:176064ms step_avg:341.87ms
step:526/1750 train_loss:3.7097 train_time:176419ms step_avg:341.90ms
step:527/1750 train_loss:3.6697 train_time:176775ms step_avg:341.92ms
step:528/1750 train_loss:3.6384 train_time:177128ms step_avg:341.95ms
step:529/1750 train_loss:3.8553 train_time:177484ms step_avg:341.97ms
step:530/1750 train_loss:3.6543 train_time:177839ms step_avg:342.00ms
step:531/1750 train_loss:3.9266 train_time:178195ms step_avg:342.03ms
step:532/1750 train_loss:3.7403 train_time:178547ms step_avg:342.04ms
step:533/1750 train_loss:3.6592 train_time:178900ms step_avg:342.07ms
step:534/1750 train_loss:3.6845 train_time:179253ms step_avg:342.09ms
step:535/1750 train_loss:3.6120 train_time:179609ms step_avg:342.11ms
step:536/1750 train_loss:3.7573 train_time:179964ms step_avg:342.14ms
step:537/1750 train_loss:3.7344 train_time:180321ms step_avg:342.16ms
step:538/1750 train_loss:3.6316 train_time:180680ms step_avg:342.20ms
step:539/1750 train_loss:4.1301 train_time:181040ms step_avg:342.23ms
step:540/1750 train_loss:3.6807 train_time:181395ms step_avg:342.25ms
step:541/1750 train_loss:3.7902 train_time:181749ms step_avg:342.28ms
step:542/1750 train_loss:3.6045 train_time:182104ms step_avg:342.30ms
step:543/1750 train_loss:3.5966 train_time:182460ms step_avg:342.33ms
step:544/1750 train_loss:3.6490 train_time:182816ms step_avg:342.35ms
step:545/1750 train_loss:3.6028 train_time:183172ms step_avg:342.38ms
step:546/1750 train_loss:3.6278 train_time:183528ms step_avg:342.40ms
step:547/1750 train_loss:3.6495 train_time:183882ms step_avg:342.42ms
step:548/1750 train_loss:3.6336 train_time:184237ms step_avg:342.45ms
step:549/1750 train_loss:3.7312 train_time:184594ms step_avg:342.47ms
step:550/1750 train_loss:3.6279 train_time:184950ms step_avg:342.50ms
step:551/1750 train_loss:3.6384 train_time:185304ms step_avg:342.52ms
step:552/1750 train_loss:3.9475 train_time:185657ms step_avg:342.54ms
step:553/1750 train_loss:3.7635 train_time:186011ms step_avg:342.56ms
step:554/1750 train_loss:3.7233 train_time:186363ms step_avg:342.58ms
step:555/1750 train_loss:3.6379 train_time:186717ms step_avg:342.60ms
step:556/1750 train_loss:3.7047 train_time:187069ms step_avg:342.62ms
step:557/1750 train_loss:3.3244 train_time:187424ms step_avg:342.64ms
step:558/1750 train_loss:3.6164 train_time:187779ms step_avg:342.66ms
step:559/1750 train_loss:3.6638 train_time:188131ms step_avg:342.68ms
step:560/1750 train_loss:3.6996 train_time:188484ms step_avg:342.70ms
step:561/1750 train_loss:3.6191 train_time:188838ms step_avg:342.72ms
step:562/1750 train_loss:3.5660 train_time:189193ms step_avg:342.74ms
step:563/1750 train_loss:3.7672 train_time:189550ms step_avg:342.77ms
step:564/1750 train_loss:3.5836 train_time:189909ms step_avg:342.80ms
step:565/1750 train_loss:3.6936 train_time:190262ms step_avg:342.81ms
step:566/1750 train_loss:3.6390 train_time:190659ms step_avg:342.91ms
step:567/1750 train_loss:3.6143 train_time:191069ms step_avg:343.03ms
step:568/1750 train_loss:3.6994 train_time:191425ms step_avg:343.06ms
step:569/1750 train_loss:3.6589 train_time:191917ms step_avg:343.32ms
step:570/1750 train_loss:3.7007 train_time:192268ms step_avg:343.34ms
step:571/1750 train_loss:3.7743 train_time:192618ms step_avg:343.35ms
step:572/1750 train_loss:3.7392 train_time:192972ms step_avg:343.37ms
step:573/1750 train_loss:3.7493 train_time:193329ms step_avg:343.39ms
step:574/1750 train_loss:3.7930 train_time:193689ms step_avg:343.42ms
step:575/1750 train_loss:3.7439 train_time:194044ms step_avg:343.44ms
step:576/1750 train_loss:3.7709 train_time:194397ms step_avg:343.46ms
step:577/1750 train_loss:3.6833 train_time:194751ms step_avg:343.48ms
step:578/1750 train_loss:3.6915 train_time:195104ms step_avg:343.49ms
step:579/1750 train_loss:3.6831 train_time:195457ms step_avg:343.51ms
step:580/1750 train_loss:3.6065 train_time:195811ms step_avg:343.53ms
step:581/1750 train_loss:3.6515 train_time:196168ms step_avg:343.55ms
step:582/1750 train_loss:3.8665 train_time:196521ms step_avg:343.57ms
step:583/1750 train_loss:3.6443 train_time:196877ms step_avg:343.59ms
step:584/1750 train_loss:3.6018 train_time:197234ms step_avg:343.61ms
step:585/1750 train_loss:3.7956 train_time:197585ms step_avg:343.63ms
step:586/1750 train_loss:3.5219 train_time:197939ms step_avg:343.64ms
step:587/1750 train_loss:3.6764 train_time:198292ms step_avg:343.66ms
step:588/1750 train_loss:3.6602 train_time:198645ms step_avg:343.68ms
step:589/1750 train_loss:4.0065 train_time:199000ms step_avg:343.70ms
step:590/1750 train_loss:3.7929 train_time:199353ms step_avg:343.71ms
step:591/1750 train_loss:3.5267 train_time:199708ms step_avg:343.73ms
step:592/1750 train_loss:3.5453 train_time:200063ms step_avg:343.75ms
step:593/1750 train_loss:3.5141 train_time:200419ms step_avg:343.77ms
step:594/1750 train_loss:3.5649 train_time:200773ms step_avg:343.79ms
step:595/1750 train_loss:3.9312 train_time:201127ms step_avg:343.81ms
step:596/1750 train_loss:3.6509 train_time:201482ms step_avg:343.83ms
step:597/1750 train_loss:3.5931 train_time:201834ms step_avg:343.84ms
step:598/1750 train_loss:3.6732 train_time:202188ms step_avg:343.86ms
step:599/1750 train_loss:3.4832 train_time:202542ms step_avg:343.87ms
step:600/1750 train_loss:3.6068 train_time:202899ms step_avg:343.90ms
step:601/1750 train_loss:3.6534 train_time:203251ms step_avg:343.91ms
step:602/1750 train_loss:3.6775 train_time:203605ms step_avg:343.93ms
step:603/1750 train_loss:3.7941 train_time:203958ms step_avg:343.94ms
step:604/1750 train_loss:3.6226 train_time:204311ms step_avg:343.96ms
step:605/1750 train_loss:3.6229 train_time:204663ms step_avg:343.97ms
step:606/1750 train_loss:3.5868 train_time:205018ms step_avg:343.99ms
step:607/1750 train_loss:3.8493 train_time:205370ms step_avg:344.00ms
step:608/1750 train_loss:3.6511 train_time:205724ms step_avg:344.02ms
step:609/1750 train_loss:3.6243 train_time:206078ms step_avg:344.04ms
step:610/1750 train_loss:3.7186 train_time:206429ms step_avg:344.05ms
step:611/1750 train_loss:3.6111 train_time:206780ms step_avg:344.06ms
step:612/1750 train_loss:3.5826 train_time:207134ms step_avg:344.08ms
step:613/1750 train_loss:3.7708 train_time:207488ms step_avg:344.09ms
step:614/1750 train_loss:3.7209 train_time:207843ms step_avg:344.11ms
step:615/1750 train_loss:3.7201 train_time:208195ms step_avg:344.12ms
step:616/1750 train_loss:3.6447 train_time:208549ms step_avg:344.14ms
step:617/1750 train_loss:3.5664 train_time:208903ms step_avg:344.16ms
step:618/1750 train_loss:3.7068 train_time:209256ms step_avg:344.17ms
step:619/1750 train_loss:3.5677 train_time:209609ms step_avg:344.19ms
step:620/1750 train_loss:3.5986 train_time:209962ms step_avg:344.20ms
step:621/1750 train_loss:3.9373 train_time:210318ms step_avg:344.22ms
step:622/1750 train_loss:3.5826 train_time:210674ms step_avg:344.24ms
step:623/1750 train_loss:3.6156 train_time:211030ms step_avg:344.26ms
step:624/1750 train_loss:3.7073 train_time:211381ms step_avg:344.27ms
step:625/1750 train_loss:3.7170 train_time:211735ms step_avg:344.28ms
step:625/1750 val_loss:3.6348 train_time:211827ms step_avg:344.43ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 225.30504 | frobenius_norm = 51745.70703 | spectral_norm = 9330.51465 | nuclear_norm = 1289665.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 123.62641 | spectral_norm = 18.22746 | nuclear_norm = 2873.62793
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 119.75505 | spectral_norm = 20.38032 | nuclear_norm = 2769.29346
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 238.30956 | spectral_norm = 15.13884 | nuclear_norm = 5726.66602
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 196.18256 | spectral_norm = 17.88019 | nuclear_norm = 4572.02148
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 254.89009 | spectral_norm = 20.35590 | nuclear_norm = 6769.69434
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 133.09061 | spectral_norm = 11.18807 | nuclear_norm = 3533.66821
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 124.57125 | spectral_norm = 10.72483 | nuclear_norm = 2903.85596
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 122.93944 | spectral_norm = 11.60890 | nuclear_norm = 2866.84912
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 244.07773 | spectral_norm = 21.59339 | nuclear_norm = 5633.84277
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 239.15411 | spectral_norm = 18.79145 | nuclear_norm = 5621.69189
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 263.66776 | spectral_norm = 18.45483 | nuclear_norm = 7011.80273
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 131.55777 | spectral_norm = 12.40011 | nuclear_norm = 3469.65283
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 121.52957 | spectral_norm = 11.67575 | nuclear_norm = 2818.82275
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 120.31583 | spectral_norm = 11.31963 | nuclear_norm = 2795.81885
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 244.81786 | spectral_norm = 20.75556 | nuclear_norm = 5614.77148
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 247.38133 | spectral_norm = 18.33023 | nuclear_norm = 5804.06152
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 267.74243 | spectral_norm = 20.49293 | nuclear_norm = 7115.40527
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 132.38956 | spectral_norm = 12.35386 | nuclear_norm = 3480.96924
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 118.07207 | spectral_norm = 10.84240 | nuclear_norm = 2666.61499
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 116.90999 | spectral_norm = 10.66971 | nuclear_norm = 2646.59253
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 238.13008 | spectral_norm = 21.37442 | nuclear_norm = 5401.98438
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 248.07498 | spectral_norm = 19.78849 | nuclear_norm = 5783.03125
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 272.71234 | spectral_norm = 20.21048 | nuclear_norm = 7247.87793
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 133.34149 | spectral_norm = 12.86816 | nuclear_norm = 3508.16162
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 119.79121 | spectral_norm = 11.09249 | nuclear_norm = 2754.37256
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 119.26975 | spectral_norm = 10.51720 | nuclear_norm = 2747.27197
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 255.28026 | spectral_norm = 24.05692 | nuclear_norm = 5773.12842
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 256.91327 | spectral_norm = 19.32724 | nuclear_norm = 6042.69238
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 274.53662 | spectral_norm = 22.07370 | nuclear_norm = 7293.91406
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 132.84685 | spectral_norm = 11.60992 | nuclear_norm = 3487.93848
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 117.54957 | spectral_norm = 11.71653 | nuclear_norm = 2682.57202
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 116.88005 | spectral_norm = 11.49058 | nuclear_norm = 2666.14038
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 251.58366 | spectral_norm = 20.87558 | nuclear_norm = 5793.39307
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 251.70914 | spectral_norm = 19.06255 | nuclear_norm = 5932.67676
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 277.83810 | spectral_norm = 19.05628 | nuclear_norm = 7392.42334
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 133.79744 | spectral_norm = 11.88276 | nuclear_norm = 3523.07959
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 119.62064 | spectral_norm = 10.90508 | nuclear_norm = 2737.41968
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 118.34570 | spectral_norm = 10.38153 | nuclear_norm = 2718.71094
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 262.04489 | spectral_norm = 23.03195 | nuclear_norm = 5923.50635
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 254.85161 | spectral_norm = 19.57257 | nuclear_norm = 5975.95605
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 269.57617 | spectral_norm = 19.73983 | nuclear_norm = 7176.34863
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 133.35042 | spectral_norm = 11.64887 | nuclear_norm = 3507.69629
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 117.50694 | spectral_norm = 11.10634 | nuclear_norm = 2689.12012
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 116.40058 | spectral_norm = 10.82423 | nuclear_norm = 2676.66187
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 252.09563 | spectral_norm = 21.07181 | nuclear_norm = 5725.83984
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 251.84348 | spectral_norm = 19.95390 | nuclear_norm = 5837.01855
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 273.33490 | spectral_norm = 21.15274 | nuclear_norm = 7265.19922
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 135.31042 | spectral_norm = 11.97977 | nuclear_norm = 3570.21069
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 121.82201 | spectral_norm = 12.18626 | nuclear_norm = 2757.77637
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 121.74422 | spectral_norm = 11.31854 | nuclear_norm = 2729.72510
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 251.85464 | spectral_norm = 20.56385 | nuclear_norm = 5811.10547
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 262.44519 | spectral_norm = 17.94012 | nuclear_norm = 6196.83301
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 271.58835 | spectral_norm = 21.90809 | nuclear_norm = 7219.56641
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 137.63335 | spectral_norm = 12.58922 | nuclear_norm = 3645.07397
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 123.15150 | spectral_norm = 11.84693 | nuclear_norm = 2817.71631
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 121.55037 | spectral_norm = 11.63973 | nuclear_norm = 2768.94727
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 271.41629 | spectral_norm = 23.84703 | nuclear_norm = 6205.44531
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 265.33408 | spectral_norm = 18.87438 | nuclear_norm = 6255.47314
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 272.52594 | spectral_norm = 21.82232 | nuclear_norm = 7250.00391
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 137.23067 | spectral_norm = 13.13325 | nuclear_norm = 3636.83643
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 124.53499 | spectral_norm = 12.36228 | nuclear_norm = 2865.45386
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 121.81787 | spectral_norm = 11.97632 | nuclear_norm = 2800.51318
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 253.79669 | spectral_norm = 24.56555 | nuclear_norm = 5821.52051
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 260.43100 | spectral_norm = 19.86819 | nuclear_norm = 6158.39355
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 281.85367 | spectral_norm = 20.47503 | nuclear_norm = 7509.79980
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 134.61232 | spectral_norm = 13.76942 | nuclear_norm = 3561.65552
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 122.62772 | spectral_norm = 13.70456 | nuclear_norm = 2776.60376
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 120.40824 | spectral_norm = 12.77510 | nuclear_norm = 2704.13525
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 234.27554 | spectral_norm = 22.38641 | nuclear_norm = 5366.26367
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 261.83539 | spectral_norm = 19.99003 | nuclear_norm = 6128.31104
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 286.53491 | spectral_norm = 21.40945 | nuclear_norm = 7635.39844
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 135.09616 | spectral_norm = 15.01569 | nuclear_norm = 3561.12769
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 918.94330 | spectral_norm = 170.04794 | nuclear_norm = 23760.41992
===========================================
step:626/1750 train_loss:3.7519 train_time:212086ms step_avg:344.29ms
step:627/1750 train_loss:3.7256 train_time:212436ms step_avg:344.30ms
step:628/1750 train_loss:3.7813 train_time:212785ms step_avg:344.31ms
step:629/1750 train_loss:3.6077 train_time:213135ms step_avg:344.32ms
step:630/1750 train_loss:3.7356 train_time:213486ms step_avg:344.33ms
step:631/1750 train_loss:3.7583 train_time:213837ms step_avg:344.34ms
step:632/1750 train_loss:3.6663 train_time:214192ms step_avg:344.36ms
step:633/1750 train_loss:3.6114 train_time:214546ms step_avg:344.38ms
step:634/1750 train_loss:3.7123 train_time:214895ms step_avg:344.38ms
step:635/1750 train_loss:3.9673 train_time:215245ms step_avg:344.39ms
step:636/1750 train_loss:3.5572 train_time:215599ms step_avg:344.41ms
step:637/1750 train_loss:3.3705 train_time:215953ms step_avg:344.42ms
step:638/1750 train_loss:3.6034 train_time:216304ms step_avg:344.43ms
step:639/1750 train_loss:3.6424 train_time:216654ms step_avg:344.44ms
step:640/1750 train_loss:3.5758 train_time:217007ms step_avg:344.46ms
step:641/1750 train_loss:3.5941 train_time:217359ms step_avg:344.47ms
step:642/1750 train_loss:3.6404 train_time:217711ms step_avg:344.48ms
step:643/1750 train_loss:3.6178 train_time:218065ms step_avg:344.49ms
step:644/1750 train_loss:3.5756 train_time:218418ms step_avg:344.51ms
step:645/1750 train_loss:3.7891 train_time:218771ms step_avg:344.52ms
step:646/1750 train_loss:3.6855 train_time:219126ms step_avg:344.54ms
step:647/1750 train_loss:3.6806 train_time:219478ms step_avg:344.55ms
step:648/1750 train_loss:3.7245 train_time:219835ms step_avg:344.57ms
step:649/1750 train_loss:3.7733 train_time:220187ms step_avg:344.58ms
step:650/1750 train_loss:3.6344 train_time:220545ms step_avg:344.60ms
step:651/1750 train_loss:3.7854 train_time:220906ms step_avg:344.63ms
step:652/1750 train_loss:3.5980 train_time:221265ms step_avg:344.65ms
step:653/1750 train_loss:3.6777 train_time:221624ms step_avg:344.67ms
step:654/1750 train_loss:3.4445 train_time:221984ms step_avg:344.70ms
step:655/1750 train_loss:3.5921 train_time:222339ms step_avg:344.71ms
step:656/1750 train_loss:3.5859 train_time:222695ms step_avg:344.73ms
step:657/1750 train_loss:3.5158 train_time:223053ms step_avg:344.75ms
step:658/1750 train_loss:3.7009 train_time:223413ms step_avg:344.77ms
step:659/1750 train_loss:3.6000 train_time:223770ms step_avg:344.79ms
step:660/1750 train_loss:3.6992 train_time:224128ms step_avg:344.81ms
step:661/1750 train_loss:3.7664 train_time:224489ms step_avg:344.84ms
step:662/1750 train_loss:3.6821 train_time:224845ms step_avg:344.85ms
step:663/1750 train_loss:3.5655 train_time:225203ms step_avg:344.87ms
step:664/1750 train_loss:3.6221 train_time:225562ms step_avg:344.90ms
step:665/1750 train_loss:3.5044 train_time:225923ms step_avg:344.92ms
step:666/1750 train_loss:3.7988 train_time:226280ms step_avg:344.94ms
step:667/1750 train_loss:3.6231 train_time:226638ms step_avg:344.96ms
step:668/1750 train_loss:3.6623 train_time:227000ms step_avg:344.98ms
step:669/1750 train_loss:3.4985 train_time:227362ms step_avg:345.01ms
step:670/1750 train_loss:3.6150 train_time:227720ms step_avg:345.03ms
step:671/1750 train_loss:3.5775 train_time:228081ms step_avg:345.05ms
step:672/1750 train_loss:3.5884 train_time:228441ms step_avg:345.08ms
step:673/1750 train_loss:3.8614 train_time:228800ms step_avg:345.10ms
step:674/1750 train_loss:3.6464 train_time:229159ms step_avg:345.12ms
step:675/1750 train_loss:3.7257 train_time:229518ms step_avg:345.14ms
step:676/1750 train_loss:3.5082 train_time:229877ms step_avg:345.16ms
step:677/1750 train_loss:3.6137 train_time:230238ms step_avg:345.18ms
step:678/1750 train_loss:3.5660 train_time:230598ms step_avg:345.21ms
step:679/1750 train_loss:3.6923 train_time:230958ms step_avg:345.23ms
step:680/1750 train_loss:3.6004 train_time:231318ms step_avg:345.25ms
step:681/1750 train_loss:3.6280 train_time:231679ms step_avg:345.27ms
step:682/1750 train_loss:3.6796 train_time:232042ms step_avg:345.30ms
step:683/1750 train_loss:3.7532 train_time:232398ms step_avg:345.32ms
step:684/1750 train_loss:3.6613 train_time:232754ms step_avg:345.33ms
step:685/1750 train_loss:3.7023 train_time:233113ms step_avg:345.35ms
step:686/1750 train_loss:3.6444 train_time:233472ms step_avg:345.37ms
step:687/1750 train_loss:3.6804 train_time:233828ms step_avg:345.39ms
step:688/1750 train_loss:3.2218 train_time:234193ms step_avg:345.42ms
step:689/1750 train_loss:3.4192 train_time:234555ms step_avg:345.44ms
step:690/1750 train_loss:3.5596 train_time:234917ms step_avg:345.47ms
step:691/1750 train_loss:3.4336 train_time:235273ms step_avg:345.48ms
step:692/1750 train_loss:3.6410 train_time:235632ms step_avg:345.50ms
step:693/1750 train_loss:3.6661 train_time:235993ms step_avg:345.52ms
step:694/1750 train_loss:3.5655 train_time:236351ms step_avg:345.54ms
step:695/1750 train_loss:3.5505 train_time:236706ms step_avg:345.56ms
step:696/1750 train_loss:3.8722 train_time:237064ms step_avg:345.57ms
step:697/1750 train_loss:3.6041 train_time:237422ms step_avg:345.59ms
step:698/1750 train_loss:3.6638 train_time:237780ms step_avg:345.61ms
step:699/1750 train_loss:3.7809 train_time:238140ms step_avg:345.63ms
step:700/1750 train_loss:3.5852 train_time:238501ms step_avg:345.65ms
step:701/1750 train_loss:3.5608 train_time:238859ms step_avg:345.67ms
step:702/1750 train_loss:3.5349 train_time:239219ms step_avg:345.69ms
step:703/1750 train_loss:3.5083 train_time:239578ms step_avg:345.71ms
step:704/1750 train_loss:3.5833 train_time:239936ms step_avg:345.73ms
step:705/1750 train_loss:3.5774 train_time:240301ms step_avg:345.76ms
step:706/1750 train_loss:3.5957 train_time:240667ms step_avg:345.79ms
step:707/1750 train_loss:3.6604 train_time:241025ms step_avg:345.80ms
step:708/1750 train_loss:3.6143 train_time:241382ms step_avg:345.82ms
step:709/1750 train_loss:3.6001 train_time:241739ms step_avg:345.84ms
step:710/1750 train_loss:3.5582 train_time:242097ms step_avg:345.85ms
step:711/1750 train_loss:3.6033 train_time:242459ms step_avg:345.88ms
step:712/1750 train_loss:3.6616 train_time:242822ms step_avg:345.90ms
step:713/1750 train_loss:3.6661 train_time:243185ms step_avg:345.92ms
step:714/1750 train_loss:3.5819 train_time:243542ms step_avg:345.94ms
step:715/1750 train_loss:3.5847 train_time:243897ms step_avg:345.95ms
step:716/1750 train_loss:3.6022 train_time:244253ms step_avg:345.97ms
step:717/1750 train_loss:3.7258 train_time:244613ms step_avg:345.99ms
step:718/1750 train_loss:3.6167 train_time:244969ms step_avg:346.00ms
step:719/1750 train_loss:3.6914 train_time:245325ms step_avg:346.02ms
step:720/1750 train_loss:3.8666 train_time:245685ms step_avg:346.04ms
step:721/1750 train_loss:3.4766 train_time:246041ms step_avg:346.05ms
step:722/1750 train_loss:3.7474 train_time:246398ms step_avg:346.06ms
step:723/1750 train_loss:3.7847 train_time:246755ms step_avg:346.08ms
step:724/1750 train_loss:3.5803 train_time:247113ms step_avg:346.10ms
step:725/1750 train_loss:3.6723 train_time:247470ms step_avg:346.11ms
step:726/1750 train_loss:3.5432 train_time:247828ms step_avg:346.13ms
step:727/1750 train_loss:3.5884 train_time:248190ms step_avg:346.15ms
step:728/1750 train_loss:3.7508 train_time:248549ms step_avg:346.17ms
step:729/1750 train_loss:3.6866 train_time:248907ms step_avg:346.18ms
step:730/1750 train_loss:3.6847 train_time:249266ms step_avg:346.20ms
step:731/1750 train_loss:3.5742 train_time:249620ms step_avg:346.21ms
step:732/1750 train_loss:3.6084 train_time:249976ms step_avg:346.23ms
step:733/1750 train_loss:3.8565 train_time:250336ms step_avg:346.25ms
step:734/1750 train_loss:3.5806 train_time:250697ms step_avg:346.27ms
step:735/1750 train_loss:3.6234 train_time:251055ms step_avg:346.28ms
step:736/1750 train_loss:3.7558 train_time:251413ms step_avg:346.30ms
step:737/1750 train_loss:3.6900 train_time:251767ms step_avg:346.31ms
step:738/1750 train_loss:3.6148 train_time:252123ms step_avg:346.32ms
step:739/1750 train_loss:3.5198 train_time:252482ms step_avg:346.34ms
step:740/1750 train_loss:4.1304 train_time:252848ms step_avg:346.37ms
step:741/1750 train_loss:3.5088 train_time:253205ms step_avg:346.38ms
step:742/1750 train_loss:3.5762 train_time:253559ms step_avg:346.39ms
step:743/1750 train_loss:3.5960 train_time:253915ms step_avg:346.41ms
step:744/1750 train_loss:3.6615 train_time:254272ms step_avg:346.42ms
step:745/1750 train_loss:3.6033 train_time:254633ms step_avg:346.44ms
step:746/1750 train_loss:3.6087 train_time:254989ms step_avg:346.45ms
step:747/1750 train_loss:3.6586 train_time:255350ms step_avg:346.47ms
step:748/1750 train_loss:3.5954 train_time:255715ms step_avg:346.50ms
step:749/1750 train_loss:3.5827 train_time:256072ms step_avg:346.51ms
step:750/1750 train_loss:3.6211 train_time:256428ms step_avg:346.52ms
step:750/1750 val_loss:3.5836 train_time:256521ms step_avg:346.65ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 241.33824 | frobenius_norm = 55492.43359 | spectral_norm = 9834.76270 | nuclear_norm = 1386589.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 138.42056 | spectral_norm = 21.87754 | nuclear_norm = 3207.55078
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 134.13284 | spectral_norm = 24.46597 | nuclear_norm = 3091.27197
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 265.48929 | spectral_norm = 16.83800 | nuclear_norm = 6399.23682
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 209.90697 | spectral_norm = 19.78945 | nuclear_norm = 4880.13135
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 287.39536 | spectral_norm = 23.06921 | nuclear_norm = 7636.90234
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 149.88986 | spectral_norm = 13.07881 | nuclear_norm = 3979.04492
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 140.66956 | spectral_norm = 12.24899 | nuclear_norm = 3274.08472
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 138.83679 | spectral_norm = 12.84823 | nuclear_norm = 3232.63306
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 268.09924 | spectral_norm = 24.07546 | nuclear_norm = 6182.82178
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 262.48981 | spectral_norm = 20.80862 | nuclear_norm = 6168.45508
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 295.53711 | spectral_norm = 21.01256 | nuclear_norm = 7862.75049
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 147.60873 | spectral_norm = 14.47372 | nuclear_norm = 3891.01782
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 136.67300 | spectral_norm = 13.47821 | nuclear_norm = 3160.96069
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 135.26711 | spectral_norm = 12.56211 | nuclear_norm = 3134.35791
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 270.30875 | spectral_norm = 23.17753 | nuclear_norm = 6200.22412
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 273.24020 | spectral_norm = 20.37982 | nuclear_norm = 6409.13086
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 299.62399 | spectral_norm = 23.89187 | nuclear_norm = 7962.82275
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 148.34364 | spectral_norm = 14.33088 | nuclear_norm = 3898.02930
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 132.46649 | spectral_norm = 12.47569 | nuclear_norm = 2972.11328
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 131.05573 | spectral_norm = 11.94144 | nuclear_norm = 2949.70898
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 264.21704 | spectral_norm = 24.10663 | nuclear_norm = 5981.47852
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 274.98889 | spectral_norm = 22.42460 | nuclear_norm = 6402.44336
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 305.08224 | spectral_norm = 23.54008 | nuclear_norm = 8107.95947
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 149.21283 | spectral_norm = 14.77653 | nuclear_norm = 3924.18115
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 134.46916 | spectral_norm = 12.78530 | nuclear_norm = 3081.41333
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 133.65840 | spectral_norm = 12.03663 | nuclear_norm = 3066.56763
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 284.92920 | spectral_norm = 27.17970 | nuclear_norm = 6439.33789
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 286.58795 | spectral_norm = 21.59262 | nuclear_norm = 6742.38281
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 307.19702 | spectral_norm = 25.41231 | nuclear_norm = 8162.69238
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 148.75050 | spectral_norm = 13.41011 | nuclear_norm = 3904.69238
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 131.93112 | spectral_norm = 13.49545 | nuclear_norm = 2996.55249
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 130.92848 | spectral_norm = 13.10749 | nuclear_norm = 2974.08789
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 281.02676 | spectral_norm = 23.28169 | nuclear_norm = 6474.54492
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 279.89233 | spectral_norm = 21.22272 | nuclear_norm = 6600.16016
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 311.06808 | spectral_norm = 22.08913 | nuclear_norm = 8278.77539
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 150.11441 | spectral_norm = 13.69940 | nuclear_norm = 3953.41211
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 134.04033 | spectral_norm = 12.56290 | nuclear_norm = 3052.68848
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 132.33513 | spectral_norm = 11.81148 | nuclear_norm = 3028.66553
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 292.19431 | spectral_norm = 25.78094 | nuclear_norm = 6601.74512
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 284.35522 | spectral_norm = 22.02229 | nuclear_norm = 6665.78809
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 302.41727 | spectral_norm = 22.55702 | nuclear_norm = 8055.41602
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 149.60205 | spectral_norm = 13.56640 | nuclear_norm = 3934.14258
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 131.98750 | spectral_norm = 12.68281 | nuclear_norm = 3009.10840
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 130.40305 | spectral_norm = 12.42388 | nuclear_norm = 2988.34082
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 281.71921 | spectral_norm = 23.55093 | nuclear_norm = 6399.30176
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 279.98120 | spectral_norm = 22.68507 | nuclear_norm = 6468.66602
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 306.42825 | spectral_norm = 23.84601 | nuclear_norm = 8144.20410
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 151.93658 | spectral_norm = 13.98773 | nuclear_norm = 4007.42969
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 136.74452 | spectral_norm = 14.14855 | nuclear_norm = 3073.34985
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 137.03777 | spectral_norm = 12.99799 | nuclear_norm = 3050.95312
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 278.57404 | spectral_norm = 23.31440 | nuclear_norm = 6417.57715
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 289.60980 | spectral_norm = 19.84690 | nuclear_norm = 6838.29688
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 306.36151 | spectral_norm = 25.02879 | nuclear_norm = 8142.02148
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 155.59357 | spectral_norm = 14.69680 | nuclear_norm = 4121.75684
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 138.54308 | spectral_norm = 13.64972 | nuclear_norm = 3155.71265
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 136.74849 | spectral_norm = 13.47541 | nuclear_norm = 3102.39258
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 302.22623 | spectral_norm = 26.96455 | nuclear_norm = 6898.85400
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 293.82001 | spectral_norm = 21.02732 | nuclear_norm = 6920.11475
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 305.67795 | spectral_norm = 24.93423 | nuclear_norm = 8131.71387
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 154.97044 | spectral_norm = 15.20503 | nuclear_norm = 4108.98047
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 140.19429 | spectral_norm = 14.43479 | nuclear_norm = 3210.84668
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 136.85895 | spectral_norm = 13.87615 | nuclear_norm = 3132.79932
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 283.24936 | spectral_norm = 28.26726 | nuclear_norm = 6485.87598
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 289.77686 | spectral_norm = 22.04639 | nuclear_norm = 6844.37549
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 316.95947 | spectral_norm = 23.49993 | nuclear_norm = 8446.17383
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 150.97958 | spectral_norm = 16.14255 | nuclear_norm = 3994.33154
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 137.83098 | spectral_norm = 16.00095 | nuclear_norm = 3102.12354
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 134.96666 | spectral_norm = 14.77451 | nuclear_norm = 3013.32153
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 261.23038 | spectral_norm = 25.33903 | nuclear_norm = 5971.97266
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 291.62659 | spectral_norm = 22.17006 | nuclear_norm = 6820.96680
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 323.05862 | spectral_norm = 24.05604 | nuclear_norm = 8609.16602
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 151.50453 | spectral_norm = 17.80745 | nuclear_norm = 3989.60669
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1011.60376 | spectral_norm = 169.14796 | nuclear_norm = 26311.39844
===========================================
step:751/1750 train_loss:3.5855 train_time:256783ms step_avg:346.54ms
step:752/1750 train_loss:3.6297 train_time:257134ms step_avg:346.54ms
step:753/1750 train_loss:3.6274 train_time:257488ms step_avg:346.55ms
step:754/1750 train_loss:3.6042 train_time:257844ms step_avg:346.56ms
step:755/1750 train_loss:3.6988 train_time:258221ms step_avg:346.61ms
step:756/1750 train_loss:3.4706 train_time:258662ms step_avg:346.73ms
step:757/1750 train_loss:3.7441 train_time:259020ms step_avg:346.75ms
step:758/1750 train_loss:3.6689 train_time:259376ms step_avg:346.76ms
step:759/1750 train_loss:3.6114 train_time:259862ms step_avg:346.95ms
step:760/1750 train_loss:3.7198 train_time:260217ms step_avg:346.96ms
step:761/1750 train_loss:3.4154 train_time:260574ms step_avg:346.97ms
step:762/1750 train_loss:3.5687 train_time:260930ms step_avg:346.98ms
step:763/1750 train_loss:3.6799 train_time:261286ms step_avg:346.99ms
step:764/1750 train_loss:3.3322 train_time:261642ms step_avg:347.01ms
step:765/1750 train_loss:3.7518 train_time:262001ms step_avg:347.02ms
step:766/1750 train_loss:3.5886 train_time:262361ms step_avg:347.04ms
step:767/1750 train_loss:3.5766 train_time:262717ms step_avg:347.05ms
step:768/1750 train_loss:3.5871 train_time:263074ms step_avg:347.06ms
step:769/1750 train_loss:3.6017 train_time:263434ms step_avg:347.08ms
step:770/1750 train_loss:3.6645 train_time:263790ms step_avg:347.09ms
step:771/1750 train_loss:3.8952 train_time:264144ms step_avg:347.10ms
step:772/1750 train_loss:3.4714 train_time:264499ms step_avg:347.11ms
step:773/1750 train_loss:3.6513 train_time:264854ms step_avg:347.12ms
step:774/1750 train_loss:3.6582 train_time:265209ms step_avg:347.13ms
step:775/1750 train_loss:3.6263 train_time:265565ms step_avg:347.14ms
step:776/1750 train_loss:3.4139 train_time:265924ms step_avg:347.16ms
step:777/1750 train_loss:3.3998 train_time:266284ms step_avg:347.18ms
step:778/1750 train_loss:3.5049 train_time:266639ms step_avg:347.19ms
step:779/1750 train_loss:3.5955 train_time:267000ms step_avg:347.20ms
step:780/1750 train_loss:3.6095 train_time:267364ms step_avg:347.23ms
step:781/1750 train_loss:3.6833 train_time:267724ms step_avg:347.24ms
step:782/1750 train_loss:3.6055 train_time:268085ms step_avg:347.26ms
step:783/1750 train_loss:3.5863 train_time:268445ms step_avg:347.28ms
step:784/1750 train_loss:3.6159 train_time:268809ms step_avg:347.30ms
step:785/1750 train_loss:3.5800 train_time:269168ms step_avg:347.31ms
step:786/1750 train_loss:3.4519 train_time:269529ms step_avg:347.33ms
step:787/1750 train_loss:3.7647 train_time:269894ms step_avg:347.35ms
step:788/1750 train_loss:3.5172 train_time:270259ms step_avg:347.38ms
step:789/1750 train_loss:3.5735 train_time:270619ms step_avg:347.39ms
step:790/1750 train_loss:3.6418 train_time:270985ms step_avg:347.42ms
step:791/1750 train_loss:3.7978 train_time:271353ms step_avg:347.44ms
step:792/1750 train_loss:3.7800 train_time:271713ms step_avg:347.46ms
step:793/1750 train_loss:3.4902 train_time:272071ms step_avg:347.47ms
step:794/1750 train_loss:3.6106 train_time:272433ms step_avg:347.49ms
step:795/1750 train_loss:3.6859 train_time:272798ms step_avg:347.51ms
step:796/1750 train_loss:3.7446 train_time:273165ms step_avg:347.54ms
step:797/1750 train_loss:3.5370 train_time:273528ms step_avg:347.56ms
step:798/1750 train_loss:3.6650 train_time:273895ms step_avg:347.58ms
step:799/1750 train_loss:3.5607 train_time:274264ms step_avg:347.61ms
step:800/1750 train_loss:3.5514 train_time:274629ms step_avg:347.63ms
step:801/1750 train_loss:3.6527 train_time:274987ms step_avg:347.65ms
step:802/1750 train_loss:3.5138 train_time:275352ms step_avg:347.67ms
step:803/1750 train_loss:3.5318 train_time:275711ms step_avg:347.68ms
step:804/1750 train_loss:3.6458 train_time:276072ms step_avg:347.70ms
step:805/1750 train_loss:3.5418 train_time:276437ms step_avg:347.72ms
step:806/1750 train_loss:3.5783 train_time:276796ms step_avg:347.73ms
step:807/1750 train_loss:3.6639 train_time:277158ms step_avg:347.75ms
step:808/1750 train_loss:3.5718 train_time:277519ms step_avg:347.77ms
step:809/1750 train_loss:3.5077 train_time:277879ms step_avg:347.78ms
step:810/1750 train_loss:3.5797 train_time:278239ms step_avg:347.80ms
step:811/1750 train_loss:3.5990 train_time:278600ms step_avg:347.82ms
step:812/1750 train_loss:3.6125 train_time:278958ms step_avg:347.83ms
step:813/1750 train_loss:3.6454 train_time:279316ms step_avg:347.84ms
step:814/1750 train_loss:3.5915 train_time:279678ms step_avg:347.86ms
step:815/1750 train_loss:3.5777 train_time:280040ms step_avg:347.88ms
step:816/1750 train_loss:3.6962 train_time:280405ms step_avg:347.90ms
step:817/1750 train_loss:3.7863 train_time:280766ms step_avg:347.91ms
step:818/1750 train_loss:3.5387 train_time:281127ms step_avg:347.93ms
step:819/1750 train_loss:3.7372 train_time:281492ms step_avg:347.95ms
step:820/1750 train_loss:3.5176 train_time:281856ms step_avg:347.97ms
step:821/1750 train_loss:3.5748 train_time:282217ms step_avg:347.99ms
step:822/1750 train_loss:3.7128 train_time:282581ms step_avg:348.01ms
step:823/1750 train_loss:3.5953 train_time:282945ms step_avg:348.03ms
step:824/1750 train_loss:3.5292 train_time:283306ms step_avg:348.04ms
step:825/1750 train_loss:3.6342 train_time:283671ms step_avg:348.06ms
step:826/1750 train_loss:3.4998 train_time:284036ms step_avg:348.08ms
step:827/1750 train_loss:3.7482 train_time:284399ms step_avg:348.10ms
step:828/1750 train_loss:3.6401 train_time:284762ms step_avg:348.12ms
step:829/1750 train_loss:3.6513 train_time:285128ms step_avg:348.14ms
step:830/1750 train_loss:3.5451 train_time:285490ms step_avg:348.16ms
step:831/1750 train_loss:3.6161 train_time:285851ms step_avg:348.17ms
step:832/1750 train_loss:3.5327 train_time:286210ms step_avg:348.19ms
step:833/1750 train_loss:3.6711 train_time:286572ms step_avg:348.20ms
step:834/1750 train_loss:3.4986 train_time:286934ms step_avg:348.22ms
step:835/1750 train_loss:3.4784 train_time:287299ms step_avg:348.24ms
step:836/1750 train_loss:3.7378 train_time:287667ms step_avg:348.26ms
step:837/1750 train_loss:3.4234 train_time:288030ms step_avg:348.28ms
step:838/1750 train_loss:3.6125 train_time:288391ms step_avg:348.30ms
step:839/1750 train_loss:3.4279 train_time:288753ms step_avg:348.31ms
step:840/1750 train_loss:3.4850 train_time:289113ms step_avg:348.33ms
step:841/1750 train_loss:3.5818 train_time:289476ms step_avg:348.35ms
step:842/1750 train_loss:3.6002 train_time:289840ms step_avg:348.37ms
step:843/1750 train_loss:3.5847 train_time:290198ms step_avg:348.38ms
step:844/1750 train_loss:3.4474 train_time:290559ms step_avg:348.39ms
step:845/1750 train_loss:3.6777 train_time:290920ms step_avg:348.41ms
step:846/1750 train_loss:3.5293 train_time:291281ms step_avg:348.42ms
step:847/1750 train_loss:3.5095 train_time:291644ms step_avg:348.44ms
step:848/1750 train_loss:3.6530 train_time:292005ms step_avg:348.46ms
step:849/1750 train_loss:3.5114 train_time:292366ms step_avg:348.47ms
step:850/1750 train_loss:3.4622 train_time:292729ms step_avg:348.49ms
step:851/1750 train_loss:3.7560 train_time:293089ms step_avg:348.50ms
step:852/1750 train_loss:3.4587 train_time:293447ms step_avg:348.51ms
step:853/1750 train_loss:3.5822 train_time:293808ms step_avg:348.53ms
step:854/1750 train_loss:3.6667 train_time:294169ms step_avg:348.54ms
step:855/1750 train_loss:3.5354 train_time:294528ms step_avg:348.55ms
step:856/1750 train_loss:3.5601 train_time:294889ms step_avg:348.57ms
step:857/1750 train_loss:3.6225 train_time:295253ms step_avg:348.59ms
step:858/1750 train_loss:3.4885 train_time:295619ms step_avg:348.61ms
step:859/1750 train_loss:3.5706 train_time:295980ms step_avg:348.62ms
step:860/1750 train_loss:3.6105 train_time:296340ms step_avg:348.64ms
step:861/1750 train_loss:3.6443 train_time:296708ms step_avg:348.66ms
step:862/1750 train_loss:3.6192 train_time:297077ms step_avg:348.68ms
step:863/1750 train_loss:3.5995 train_time:297439ms step_avg:348.70ms
step:864/1750 train_loss:3.3988 train_time:297801ms step_avg:348.71ms
step:865/1750 train_loss:3.6149 train_time:298159ms step_avg:348.72ms
step:866/1750 train_loss:3.8906 train_time:298523ms step_avg:348.74ms
step:867/1750 train_loss:3.4764 train_time:298883ms step_avg:348.75ms
step:868/1750 train_loss:3.6609 train_time:299241ms step_avg:348.77ms
step:869/1750 train_loss:3.6400 train_time:299603ms step_avg:348.78ms
step:870/1750 train_loss:3.4657 train_time:299966ms step_avg:348.80ms
step:871/1750 train_loss:3.4406 train_time:300324ms step_avg:348.81ms
step:872/1750 train_loss:3.6732 train_time:300685ms step_avg:348.82ms
step:873/1750 train_loss:3.4772 train_time:301044ms step_avg:348.83ms
step:874/1750 train_loss:3.2360 train_time:301412ms step_avg:348.86ms
step:875/1750 train_loss:3.6570 train_time:301773ms step_avg:348.87ms
step:875/1750 val_loss:3.5387 train_time:301866ms step_avg:348.98ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 255.56557 | frobenius_norm = 58824.66406 | spectral_norm = 10311.74023 | nuclear_norm = 1472938.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 151.77016 | spectral_norm = 25.36782 | nuclear_norm = 3507.82690
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 147.34924 | spectral_norm = 28.38637 | nuclear_norm = 3386.34204
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 290.11536 | spectral_norm = 18.68450 | nuclear_norm = 7012.73828
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 221.15964 | spectral_norm = 21.61474 | nuclear_norm = 5124.59033
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 318.82196 | spectral_norm = 26.05249 | nuclear_norm = 8476.31348
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 165.14938 | spectral_norm = 14.85739 | nuclear_norm = 4382.91357
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 155.34877 | spectral_norm = 13.64404 | nuclear_norm = 3610.40674
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 153.25128 | spectral_norm = 14.18341 | nuclear_norm = 3564.17773
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 290.72629 | spectral_norm = 26.22764 | nuclear_norm = 6695.76074
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 284.51712 | spectral_norm = 22.65409 | nuclear_norm = 6684.29346
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 325.04391 | spectral_norm = 23.63812 | nuclear_norm = 8652.58203
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 162.41762 | spectral_norm = 16.30427 | nuclear_norm = 4279.79395
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 150.69707 | spectral_norm = 15.30298 | nuclear_norm = 3478.54150
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 149.09468 | spectral_norm = 14.00859 | nuclear_norm = 3449.94238
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 294.57593 | spectral_norm = 25.59017 | nuclear_norm = 6754.90430
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 297.55670 | spectral_norm = 22.36777 | nuclear_norm = 6981.54834
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 329.23526 | spectral_norm = 27.12559 | nuclear_norm = 8751.04004
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 162.89217 | spectral_norm = 16.12538 | nuclear_norm = 4278.34277
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 145.43608 | spectral_norm = 13.98016 | nuclear_norm = 3244.80908
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 144.01187 | spectral_norm = 13.33344 | nuclear_norm = 3225.74585
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 289.39383 | spectral_norm = 26.71908 | nuclear_norm = 6540.33838
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 300.60953 | spectral_norm = 24.90261 | nuclear_norm = 6988.38477
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 335.09369 | spectral_norm = 26.82634 | nuclear_norm = 8905.87500
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 163.81094 | spectral_norm = 16.49164 | nuclear_norm = 4307.38184
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 147.82635 | spectral_norm = 14.30161 | nuclear_norm = 3375.22852
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 146.79951 | spectral_norm = 13.41934 | nuclear_norm = 3357.33301
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 313.15179 | spectral_norm = 30.02925 | nuclear_norm = 7074.32080
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 314.40781 | spectral_norm = 23.56471 | nuclear_norm = 7399.31006
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 337.08176 | spectral_norm = 28.38981 | nuclear_norm = 8958.47559
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 163.30304 | spectral_norm = 15.07793 | nuclear_norm = 4286.80957
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 144.93248 | spectral_norm = 15.14572 | nuclear_norm = 3280.23340
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 143.95180 | spectral_norm = 14.58467 | nuclear_norm = 3259.90283
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 308.67267 | spectral_norm = 25.53354 | nuclear_norm = 7120.14648
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 306.26498 | spectral_norm = 23.07483 | nuclear_norm = 7229.64062
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 341.64655 | spectral_norm = 24.81293 | nuclear_norm = 9095.27734
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 164.94218 | spectral_norm = 15.37545 | nuclear_norm = 4344.86182
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 147.06242 | spectral_norm = 14.12683 | nuclear_norm = 3335.43164
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 145.13280 | spectral_norm = 13.16404 | nuclear_norm = 3312.08032
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 320.16290 | spectral_norm = 28.62377 | nuclear_norm = 7232.68799
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 311.57083 | spectral_norm = 24.07149 | nuclear_norm = 7302.25586
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 332.20261 | spectral_norm = 25.25022 | nuclear_norm = 8852.73047
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 164.30374 | spectral_norm = 15.36574 | nuclear_norm = 4320.34229
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 144.95911 | spectral_norm = 14.20812 | nuclear_norm = 3290.13818
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 143.13756 | spectral_norm = 13.82884 | nuclear_norm = 3269.00073
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 309.20303 | spectral_norm = 25.83128 | nuclear_norm = 7026.94922
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 305.84061 | spectral_norm = 25.19978 | nuclear_norm = 7046.86328
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 336.87939 | spectral_norm = 26.29490 | nuclear_norm = 8952.00977
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 166.87453 | spectral_norm = 15.94387 | nuclear_norm = 4399.59082
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 150.28030 | spectral_norm = 15.90753 | nuclear_norm = 3360.87256
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 150.96274 | spectral_norm = 14.57229 | nuclear_norm = 3343.45557
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 302.86578 | spectral_norm = 26.00374 | nuclear_norm = 6965.12891
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 314.52451 | spectral_norm = 21.44577 | nuclear_norm = 7426.97363
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 338.51877 | spectral_norm = 28.04523 | nuclear_norm = 8993.62012
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 171.95322 | spectral_norm = 16.72468 | nuclear_norm = 4554.72266
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 152.48116 | spectral_norm = 15.40051 | nuclear_norm = 3460.25269
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 150.59315 | spectral_norm = 15.21135 | nuclear_norm = 3404.88574
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 330.97491 | spectral_norm = 30.16557 | nuclear_norm = 7542.19336
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 320.20111 | spectral_norm = 23.00710 | nuclear_norm = 7536.35986
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 336.14728 | spectral_norm = 27.96184 | nuclear_norm = 8940.55273
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 171.12892 | spectral_norm = 17.18588 | nuclear_norm = 4538.92822
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 154.19334 | spectral_norm = 16.26324 | nuclear_norm = 3519.56641
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 150.42072 | spectral_norm = 15.69336 | nuclear_norm = 3429.32666
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 310.87982 | spectral_norm = 31.78535 | nuclear_norm = 7109.11572
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 317.11185 | spectral_norm = 23.99458 | nuclear_norm = 7479.87695
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 349.07913 | spectral_norm = 26.13715 | nuclear_norm = 9301.67383
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 165.79309 | spectral_norm = 18.41956 | nuclear_norm = 4385.87988
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 151.36128 | spectral_norm = 18.19513 | nuclear_norm = 3385.77246
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 148.18495 | spectral_norm = 16.64761 | nuclear_norm = 3290.91504
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 286.83667 | spectral_norm = 28.22140 | nuclear_norm = 6549.09375
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 319.74957 | spectral_norm = 24.16360 | nuclear_norm = 7473.91553
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 356.26807 | spectral_norm = 26.40933 | nuclear_norm = 9494.29395
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 166.47601 | spectral_norm = 20.51851 | nuclear_norm = 4378.91406
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1094.88293 | spectral_norm = 168.13434 | nuclear_norm = 28603.37695
===========================================
step:876/1750 train_loss:3.4605 train_time:302126ms step_avg:348.88ms
step:877/1750 train_loss:3.6349 train_time:302479ms step_avg:348.88ms
step:878/1750 train_loss:3.4841 train_time:302838ms step_avg:348.89ms
step:879/1750 train_loss:3.6616 train_time:303197ms step_avg:348.90ms
step:880/1750 train_loss:3.3248 train_time:303553ms step_avg:348.91ms
step:881/1750 train_loss:3.5029 train_time:303910ms step_avg:348.92ms
step:882/1750 train_loss:3.7126 train_time:304272ms step_avg:348.94ms
step:883/1750 train_loss:3.8619 train_time:304632ms step_avg:348.95ms
step:884/1750 train_loss:3.5856 train_time:304993ms step_avg:348.96ms
step:885/1750 train_loss:3.5050 train_time:305353ms step_avg:348.97ms
step:886/1750 train_loss:3.5924 train_time:305714ms step_avg:348.99ms
step:887/1750 train_loss:4.1065 train_time:306073ms step_avg:349.00ms
step:888/1750 train_loss:3.8455 train_time:306442ms step_avg:349.02ms
step:889/1750 train_loss:3.5413 train_time:306801ms step_avg:349.03ms
step:890/1750 train_loss:3.5461 train_time:307159ms step_avg:349.04ms
step:891/1750 train_loss:3.3777 train_time:307518ms step_avg:349.06ms
step:892/1750 train_loss:3.7410 train_time:307877ms step_avg:349.07ms
step:893/1750 train_loss:3.4385 train_time:308234ms step_avg:349.08ms
step:894/1750 train_loss:3.6529 train_time:308598ms step_avg:349.09ms
step:895/1750 train_loss:3.7032 train_time:308960ms step_avg:349.11ms
step:896/1750 train_loss:3.5201 train_time:309320ms step_avg:349.12ms
step:897/1750 train_loss:3.5586 train_time:309682ms step_avg:349.13ms
step:898/1750 train_loss:3.6118 train_time:310042ms step_avg:349.15ms
step:899/1750 train_loss:3.4970 train_time:310402ms step_avg:349.16ms
step:900/1750 train_loss:3.4421 train_time:310765ms step_avg:349.17ms
step:901/1750 train_loss:3.6438 train_time:311122ms step_avg:349.18ms
step:902/1750 train_loss:3.6569 train_time:311481ms step_avg:349.19ms
step:903/1750 train_loss:3.5512 train_time:311845ms step_avg:349.21ms
step:904/1750 train_loss:3.5077 train_time:312207ms step_avg:349.22ms
step:905/1750 train_loss:3.5237 train_time:312564ms step_avg:349.23ms
step:906/1750 train_loss:3.7327 train_time:312928ms step_avg:349.25ms
step:907/1750 train_loss:3.5360 train_time:313293ms step_avg:349.27ms
step:908/1750 train_loss:3.5917 train_time:313652ms step_avg:349.28ms
step:909/1750 train_loss:3.4731 train_time:314021ms step_avg:349.30ms
step:910/1750 train_loss:3.5510 train_time:314395ms step_avg:349.33ms
step:911/1750 train_loss:3.6639 train_time:314759ms step_avg:349.34ms
step:912/1750 train_loss:3.6190 train_time:315128ms step_avg:349.37ms
step:913/1750 train_loss:3.4710 train_time:315496ms step_avg:349.39ms
step:914/1750 train_loss:3.7673 train_time:315866ms step_avg:349.41ms
step:915/1750 train_loss:3.5581 train_time:316237ms step_avg:349.43ms
step:916/1750 train_loss:3.6379 train_time:316603ms step_avg:349.45ms
step:917/1750 train_loss:3.6163 train_time:316969ms step_avg:349.47ms
step:918/1750 train_loss:4.8404 train_time:317341ms step_avg:349.49ms
step:919/1750 train_loss:3.5158 train_time:317711ms step_avg:349.52ms
step:920/1750 train_loss:3.6026 train_time:318075ms step_avg:349.53ms
step:921/1750 train_loss:3.5646 train_time:318444ms step_avg:349.55ms
step:922/1750 train_loss:3.6148 train_time:318813ms step_avg:349.58ms
step:923/1750 train_loss:3.6343 train_time:319177ms step_avg:349.59ms
step:924/1750 train_loss:3.7039 train_time:319543ms step_avg:349.61ms
step:925/1750 train_loss:3.6707 train_time:319911ms step_avg:349.63ms
step:926/1750 train_loss:3.5743 train_time:320272ms step_avg:349.64ms
step:927/1750 train_loss:3.5703 train_time:320634ms step_avg:349.66ms
step:928/1750 train_loss:3.8016 train_time:321001ms step_avg:349.67ms
step:929/1750 train_loss:3.6270 train_time:321367ms step_avg:349.69ms
step:930/1750 train_loss:3.4248 train_time:321734ms step_avg:349.71ms
step:931/1750 train_loss:3.5169 train_time:322094ms step_avg:349.72ms
step:932/1750 train_loss:3.6730 train_time:322459ms step_avg:349.74ms
step:933/1750 train_loss:3.4009 train_time:322824ms step_avg:349.75ms
step:934/1750 train_loss:3.6140 train_time:323191ms step_avg:349.77ms
step:935/1750 train_loss:3.4614 train_time:323559ms step_avg:349.79ms
step:936/1750 train_loss:3.5409 train_time:323928ms step_avg:349.81ms
step:937/1750 train_loss:3.6422 train_time:324297ms step_avg:349.83ms
step:938/1750 train_loss:3.5646 train_time:324660ms step_avg:349.85ms
step:939/1750 train_loss:3.6857 train_time:325034ms step_avg:349.87ms
step:940/1750 train_loss:3.5009 train_time:325400ms step_avg:349.89ms
step:941/1750 train_loss:3.5652 train_time:325764ms step_avg:349.91ms
step:942/1750 train_loss:3.3844 train_time:326129ms step_avg:349.92ms
step:943/1750 train_loss:3.7310 train_time:326499ms step_avg:349.95ms
step:944/1750 train_loss:3.4282 train_time:326914ms step_avg:350.01ms
step:945/1750 train_loss:3.4439 train_time:327330ms step_avg:350.09ms
step:946/1750 train_loss:5.0997 train_time:327703ms step_avg:350.11ms
step:947/1750 train_loss:3.6191 train_time:328069ms step_avg:350.13ms
step:948/1750 train_loss:3.5047 train_time:328434ms step_avg:350.14ms
step:949/1750 train_loss:3.3992 train_time:328926ms step_avg:350.29ms
step:950/1750 train_loss:3.4582 train_time:329296ms step_avg:350.31ms
step:951/1750 train_loss:3.4262 train_time:329664ms step_avg:350.33ms
step:952/1750 train_loss:3.4985 train_time:330028ms step_avg:350.35ms
step:953/1750 train_loss:3.5914 train_time:330399ms step_avg:350.37ms
step:954/1750 train_loss:3.4649 train_time:330771ms step_avg:350.39ms
step:955/1750 train_loss:3.5012 train_time:331131ms step_avg:350.40ms
step:956/1750 train_loss:3.4637 train_time:331498ms step_avg:350.42ms
step:957/1750 train_loss:3.5241 train_time:331873ms step_avg:350.45ms
step:958/1750 train_loss:3.5257 train_time:332248ms step_avg:350.47ms
step:959/1750 train_loss:3.5342 train_time:332615ms step_avg:350.49ms
step:960/1750 train_loss:3.4263 train_time:332982ms step_avg:350.51ms
step:961/1750 train_loss:3.6777 train_time:333346ms step_avg:350.52ms
step:962/1750 train_loss:3.6279 train_time:333711ms step_avg:350.54ms
step:963/1750 train_loss:3.8941 train_time:334079ms step_avg:350.56ms
step:964/1750 train_loss:3.4566 train_time:334448ms step_avg:350.57ms
step:965/1750 train_loss:3.5100 train_time:334811ms step_avg:350.59ms
step:966/1750 train_loss:3.7418 train_time:335175ms step_avg:350.60ms
step:967/1750 train_loss:3.5499 train_time:335536ms step_avg:350.61ms
step:968/1750 train_loss:3.5493 train_time:335902ms step_avg:350.63ms
step:969/1750 train_loss:3.6090 train_time:336269ms step_avg:350.65ms
step:970/1750 train_loss:3.4014 train_time:336633ms step_avg:350.66ms
step:971/1750 train_loss:3.5650 train_time:336999ms step_avg:350.68ms
step:972/1750 train_loss:3.5062 train_time:337361ms step_avg:350.69ms
step:973/1750 train_loss:3.5685 train_time:337723ms step_avg:350.70ms
step:974/1750 train_loss:3.6203 train_time:338090ms step_avg:350.72ms
step:975/1750 train_loss:3.5021 train_time:338455ms step_avg:350.73ms
step:976/1750 train_loss:3.7038 train_time:338817ms step_avg:350.74ms
step:977/1750 train_loss:3.5981 train_time:339178ms step_avg:350.75ms
step:978/1750 train_loss:3.3864 train_time:339541ms step_avg:350.77ms
step:979/1750 train_loss:3.6607 train_time:339906ms step_avg:350.78ms
step:980/1750 train_loss:3.4412 train_time:340276ms step_avg:350.80ms
step:981/1750 train_loss:3.6022 train_time:340644ms step_avg:350.82ms
step:982/1750 train_loss:3.5798 train_time:341006ms step_avg:350.83ms
step:983/1750 train_loss:3.5479 train_time:341374ms step_avg:350.85ms
step:984/1750 train_loss:3.5234 train_time:341739ms step_avg:350.86ms
step:985/1750 train_loss:3.6133 train_time:342107ms step_avg:350.88ms
step:986/1750 train_loss:3.4529 train_time:342472ms step_avg:350.89ms
step:987/1750 train_loss:3.5242 train_time:342833ms step_avg:350.90ms
step:988/1750 train_loss:3.5391 train_time:343194ms step_avg:350.91ms
step:989/1750 train_loss:3.4486 train_time:343555ms step_avg:350.92ms
step:990/1750 train_loss:3.6897 train_time:343918ms step_avg:350.94ms
step:991/1750 train_loss:3.4992 train_time:344283ms step_avg:350.95ms
step:992/1750 train_loss:3.4655 train_time:344660ms step_avg:350.98ms
step:993/1750 train_loss:3.5378 train_time:345034ms step_avg:351.00ms
step:994/1750 train_loss:3.6295 train_time:345395ms step_avg:351.01ms
step:995/1750 train_loss:3.5647 train_time:345757ms step_avg:351.02ms
step:996/1750 train_loss:3.4904 train_time:346116ms step_avg:351.03ms
step:997/1750 train_loss:3.8132 train_time:346479ms step_avg:351.04ms
step:998/1750 train_loss:3.4766 train_time:346841ms step_avg:351.05ms
step:999/1750 train_loss:3.6223 train_time:347205ms step_avg:351.07ms
step:1000/1750 train_loss:3.4747 train_time:347573ms step_avg:351.08ms
step:1000/1750 val_loss:3.5025 train_time:347663ms step_avg:351.18ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 268.37012 | frobenius_norm = 61828.88281 | spectral_norm = 10752.96777 | nuclear_norm = 1550991.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 164.10411 | spectral_norm = 28.63220 | nuclear_norm = 3783.54736
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 159.50140 | spectral_norm = 31.93322 | nuclear_norm = 3659.68408
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 313.69162 | spectral_norm = 20.28055 | nuclear_norm = 7596.79395
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 230.80376 | spectral_norm = 23.37762 | nuclear_norm = 5331.87500
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 348.01483 | spectral_norm = 28.75882 | nuclear_norm = 9253.56543
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 179.07529 | spectral_norm = 16.53979 | nuclear_norm = 4751.41943
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 168.95973 | spectral_norm = 14.87332 | nuclear_norm = 3923.18164
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 166.61986 | spectral_norm = 15.29445 | nuclear_norm = 3870.81982
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 311.84647 | spectral_norm = 28.32243 | nuclear_norm = 7176.72803
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 305.08740 | spectral_norm = 24.42411 | nuclear_norm = 7165.37354
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 352.06076 | spectral_norm = 26.28757 | nuclear_norm = 9376.12891
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 175.88510 | spectral_norm = 17.94149 | nuclear_norm = 4633.18115
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 163.55704 | spectral_norm = 16.92488 | nuclear_norm = 3766.41235
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 161.81149 | spectral_norm = 15.26219 | nuclear_norm = 3738.27905
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 317.35342 | spectral_norm = 27.74056 | nuclear_norm = 7275.70508
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 320.46680 | spectral_norm = 24.14048 | nuclear_norm = 7522.71777
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 356.13150 | spectral_norm = 30.25489 | nuclear_norm = 9465.61719
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 176.20743 | spectral_norm = 17.75208 | nuclear_norm = 4626.09131
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 157.29178 | spectral_norm = 15.25579 | nuclear_norm = 3493.30371
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 155.92844 | spectral_norm = 14.66950 | nuclear_norm = 3477.81787
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 312.80759 | spectral_norm = 29.10902 | nuclear_norm = 7062.60449
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 324.62894 | spectral_norm = 27.39934 | nuclear_norm = 7540.96191
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 362.47809 | spectral_norm = 29.99369 | nuclear_norm = 9632.15527
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 177.19264 | spectral_norm = 18.10591 | nuclear_norm = 4658.22070
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 159.97462 | spectral_norm = 15.64163 | nuclear_norm = 3641.58350
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 158.98383 | spectral_norm = 14.63265 | nuclear_norm = 3628.26660
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 339.58057 | spectral_norm = 32.63219 | nuclear_norm = 7673.57324
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 340.37314 | spectral_norm = 25.32362 | nuclear_norm = 8015.32959
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 364.34152 | spectral_norm = 31.16538 | nuclear_norm = 9683.85449
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 176.66467 | spectral_norm = 16.58442 | nuclear_norm = 4637.60449
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 156.95001 | spectral_norm = 16.67466 | nuclear_norm = 3541.70288
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 155.67610 | spectral_norm = 15.92694 | nuclear_norm = 3515.53125
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 334.84326 | spectral_norm = 27.76844 | nuclear_norm = 7729.74219
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 331.09229 | spectral_norm = 24.92291 | nuclear_norm = 7816.73438
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 369.63217 | spectral_norm = 27.31177 | nuclear_norm = 9841.29980
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 178.56097 | spectral_norm = 16.88184 | nuclear_norm = 4704.56396
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 159.13644 | spectral_norm = 15.50221 | nuclear_norm = 3596.61572
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 156.75388 | spectral_norm = 14.38716 | nuclear_norm = 3569.01587
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 346.57086 | spectral_norm = 31.27382 | nuclear_norm = 7832.35889
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 337.10358 | spectral_norm = 26.34883 | nuclear_norm = 7901.61865
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 359.92029 | spectral_norm = 27.80534 | nuclear_norm = 9593.72461
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 177.76320 | spectral_norm = 17.04121 | nuclear_norm = 4673.31055
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 157.13084 | spectral_norm = 15.69789 | nuclear_norm = 3555.61426
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 154.75781 | spectral_norm = 15.16718 | nuclear_norm = 3525.78955
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 335.01263 | spectral_norm = 28.07790 | nuclear_norm = 7618.44434
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 330.11090 | spectral_norm = 27.55985 | nuclear_norm = 7588.83057
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 365.42255 | spectral_norm = 28.84457 | nuclear_norm = 9708.82031
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 180.61255 | spectral_norm = 17.83502 | nuclear_norm = 4759.54395
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 162.87160 | spectral_norm = 17.57968 | nuclear_norm = 3625.63574
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 163.84084 | spectral_norm = 15.91796 | nuclear_norm = 3611.03760
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 326.21207 | spectral_norm = 28.75993 | nuclear_norm = 7485.88184
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 337.88528 | spectral_norm = 23.05369 | nuclear_norm = 7977.81250
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 368.37430 | spectral_norm = 30.80582 | nuclear_norm = 9784.57910
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 186.92049 | spectral_norm = 18.58452 | nuclear_norm = 4951.08398
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 165.44383 | spectral_norm = 16.84807 | nuclear_norm = 3743.02930
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 163.26413 | spectral_norm = 16.78766 | nuclear_norm = 3679.31226
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 357.58218 | spectral_norm = 32.77473 | nuclear_norm = 8136.90430
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 344.86224 | spectral_norm = 24.86301 | nuclear_norm = 8115.79395
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 364.29788 | spectral_norm = 30.86062 | nuclear_norm = 9686.41309
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 185.90320 | spectral_norm = 19.08594 | nuclear_norm = 4931.84033
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 167.31178 | spectral_norm = 18.06548 | nuclear_norm = 3805.58203
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 162.99556 | spectral_norm = 17.27635 | nuclear_norm = 3702.83374
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 337.32880 | spectral_norm = 35.29575 | nuclear_norm = 7704.84082
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 343.73123 | spectral_norm = 26.10337 | nuclear_norm = 8099.67773
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 378.71204 | spectral_norm = 28.80069 | nuclear_norm = 10091.83203
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 179.48892 | spectral_norm = 20.50790 | nuclear_norm = 4748.19775
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 164.18361 | spectral_norm = 20.28826 | nuclear_norm = 3648.76465
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 160.32410 | spectral_norm = 18.43623 | nuclear_norm = 3539.86279
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 311.14209 | spectral_norm = 30.87898 | nuclear_norm = 7097.51562
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 348.59753 | spectral_norm = 26.08053 | nuclear_norm = 8143.41064
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 386.93872 | spectral_norm = 28.59493 | nuclear_norm = 10310.49414
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 180.51341 | spectral_norm = 23.15327 | nuclear_norm = 4742.24170
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1172.28772 | spectral_norm = 167.11192 | nuclear_norm = 30729.98047
===========================================
step:1001/1750 train_loss:3.5346 train_time:347927ms step_avg:351.09ms
step:1002/1750 train_loss:3.4149 train_time:348282ms step_avg:351.09ms
step:1003/1750 train_loss:3.5982 train_time:348647ms step_avg:351.10ms
step:1004/1750 train_loss:3.6381 train_time:349012ms step_avg:351.12ms
step:1005/1750 train_loss:3.4266 train_time:349373ms step_avg:351.13ms
step:1006/1750 train_loss:3.5010 train_time:349737ms step_avg:351.14ms
step:1007/1750 train_loss:3.4741 train_time:350099ms step_avg:351.15ms
step:1008/1750 train_loss:3.6027 train_time:350466ms step_avg:351.17ms
step:1009/1750 train_loss:3.7039 train_time:350837ms step_avg:351.19ms
step:1010/1750 train_loss:3.5954 train_time:351198ms step_avg:351.20ms
step:1011/1750 train_loss:3.5688 train_time:351559ms step_avg:351.21ms
step:1012/1750 train_loss:3.4261 train_time:351921ms step_avg:351.22ms
step:1013/1750 train_loss:3.5699 train_time:352287ms step_avg:351.23ms
step:1014/1750 train_loss:3.6525 train_time:352654ms step_avg:351.25ms
step:1015/1750 train_loss:3.3639 train_time:353022ms step_avg:351.27ms
step:1016/1750 train_loss:3.4506 train_time:353384ms step_avg:351.28ms
step:1017/1750 train_loss:3.4410 train_time:353751ms step_avg:351.29ms
step:1018/1750 train_loss:3.4268 train_time:354119ms step_avg:351.31ms
step:1019/1750 train_loss:3.5589 train_time:354482ms step_avg:351.32ms
step:1020/1750 train_loss:3.4291 train_time:354846ms step_avg:351.33ms
step:1021/1750 train_loss:3.3931 train_time:355206ms step_avg:351.34ms
step:1022/1750 train_loss:3.5164 train_time:355571ms step_avg:351.36ms
step:1023/1750 train_loss:3.5519 train_time:355936ms step_avg:351.37ms
step:1024/1750 train_loss:3.5119 train_time:356301ms step_avg:351.38ms
step:1025/1750 train_loss:3.5158 train_time:356666ms step_avg:351.39ms
step:1026/1750 train_loss:3.6690 train_time:357028ms step_avg:351.41ms
step:1027/1750 train_loss:3.3585 train_time:357389ms step_avg:351.41ms
step:1028/1750 train_loss:3.4321 train_time:357756ms step_avg:351.43ms
step:1029/1750 train_loss:3.3595 train_time:358124ms step_avg:351.45ms
step:1030/1750 train_loss:3.5784 train_time:358488ms step_avg:351.46ms
step:1031/1750 train_loss:3.5528 train_time:358854ms step_avg:351.47ms
step:1032/1750 train_loss:3.7383 train_time:359223ms step_avg:351.49ms
step:1033/1750 train_loss:3.5331 train_time:359583ms step_avg:351.50ms
step:1034/1750 train_loss:3.4713 train_time:359947ms step_avg:351.51ms
step:1035/1750 train_loss:3.4853 train_time:360311ms step_avg:351.52ms
step:1036/1750 train_loss:3.5283 train_time:360674ms step_avg:351.53ms
step:1037/1750 train_loss:3.8274 train_time:361035ms step_avg:351.54ms
step:1038/1750 train_loss:3.6660 train_time:361399ms step_avg:351.56ms
step:1039/1750 train_loss:3.5526 train_time:361770ms step_avg:351.57ms
step:1040/1750 train_loss:3.4572 train_time:362138ms step_avg:351.59ms
step:1041/1750 train_loss:3.5232 train_time:362505ms step_avg:351.61ms
step:1042/1750 train_loss:3.5685 train_time:362865ms step_avg:351.61ms
step:1043/1750 train_loss:3.4869 train_time:363230ms step_avg:351.63ms
step:1044/1750 train_loss:3.5008 train_time:363597ms step_avg:351.64ms
step:1045/1750 train_loss:3.5674 train_time:363965ms step_avg:351.66ms
step:1046/1750 train_loss:3.4709 train_time:364331ms step_avg:351.67ms
step:1047/1750 train_loss:3.6861 train_time:364701ms step_avg:351.69ms
step:1048/1750 train_loss:3.5441 train_time:365071ms step_avg:351.71ms
step:1049/1750 train_loss:3.4521 train_time:365442ms step_avg:351.73ms
step:1050/1750 train_loss:3.4343 train_time:365816ms step_avg:351.75ms
step:1051/1750 train_loss:3.5423 train_time:366190ms step_avg:351.77ms
step:1052/1750 train_loss:3.4028 train_time:366562ms step_avg:351.79ms
step:1053/1750 train_loss:3.7413 train_time:366931ms step_avg:351.80ms
step:1054/1750 train_loss:3.5843 train_time:367302ms step_avg:351.82ms
step:1055/1750 train_loss:3.4195 train_time:367668ms step_avg:351.84ms
step:1056/1750 train_loss:3.5461 train_time:368036ms step_avg:351.85ms
step:1057/1750 train_loss:3.6263 train_time:368407ms step_avg:351.87ms
step:1058/1750 train_loss:3.3482 train_time:368777ms step_avg:351.89ms
step:1059/1750 train_loss:3.4138 train_time:369152ms step_avg:351.91ms
step:1060/1750 train_loss:3.4887 train_time:369522ms step_avg:351.93ms
step:1061/1750 train_loss:3.4655 train_time:369887ms step_avg:351.94ms
step:1062/1750 train_loss:3.4324 train_time:370254ms step_avg:351.95ms
step:1063/1750 train_loss:3.5127 train_time:370620ms step_avg:351.97ms
step:1064/1750 train_loss:3.4318 train_time:370982ms step_avg:351.98ms
step:1065/1750 train_loss:3.4085 train_time:371357ms step_avg:352.00ms
step:1066/1750 train_loss:3.4628 train_time:371729ms step_avg:352.02ms
step:1067/1750 train_loss:3.3354 train_time:372100ms step_avg:352.03ms
step:1068/1750 train_loss:3.4784 train_time:372470ms step_avg:352.05ms
step:1069/1750 train_loss:3.3563 train_time:372846ms step_avg:352.07ms
step:1070/1750 train_loss:3.6217 train_time:373212ms step_avg:352.09ms
step:1071/1750 train_loss:3.5615 train_time:373585ms step_avg:352.11ms
step:1072/1750 train_loss:3.4884 train_time:373947ms step_avg:352.12ms
step:1073/1750 train_loss:3.5788 train_time:374311ms step_avg:352.13ms
step:1074/1750 train_loss:3.4953 train_time:374678ms step_avg:352.14ms
step:1075/1750 train_loss:3.4453 train_time:375045ms step_avg:352.15ms
step:1076/1750 train_loss:3.8414 train_time:375410ms step_avg:352.17ms
step:1077/1750 train_loss:3.4889 train_time:375777ms step_avg:352.18ms
step:1078/1750 train_loss:3.1426 train_time:376161ms step_avg:352.21ms
step:1079/1750 train_loss:3.5868 train_time:376535ms step_avg:352.23ms
step:1080/1750 train_loss:3.4814 train_time:376906ms step_avg:352.25ms
step:1081/1750 train_loss:3.5605 train_time:377271ms step_avg:352.26ms
step:1082/1750 train_loss:3.6488 train_time:377637ms step_avg:352.27ms
step:1083/1750 train_loss:3.5572 train_time:378002ms step_avg:352.29ms
step:1084/1750 train_loss:3.5269 train_time:378371ms step_avg:352.30ms
step:1085/1750 train_loss:3.4861 train_time:378741ms step_avg:352.32ms
step:1086/1750 train_loss:3.6859 train_time:379111ms step_avg:352.33ms
step:1087/1750 train_loss:3.5618 train_time:379479ms step_avg:352.35ms
step:1088/1750 train_loss:3.4186 train_time:379850ms step_avg:352.37ms
step:1089/1750 train_loss:3.4335 train_time:380230ms step_avg:352.39ms
step:1090/1750 train_loss:3.5344 train_time:380605ms step_avg:352.41ms
step:1091/1750 train_loss:3.3387 train_time:380977ms step_avg:352.43ms
step:1092/1750 train_loss:3.5429 train_time:381350ms step_avg:352.45ms
step:1093/1750 train_loss:3.6631 train_time:381720ms step_avg:352.47ms
step:1094/1750 train_loss:3.5013 train_time:382086ms step_avg:352.48ms
step:1095/1750 train_loss:3.4686 train_time:382456ms step_avg:352.49ms
step:1096/1750 train_loss:3.4886 train_time:382831ms step_avg:352.51ms
step:1097/1750 train_loss:3.5447 train_time:383203ms step_avg:352.53ms
step:1098/1750 train_loss:3.6168 train_time:383572ms step_avg:352.55ms
step:1099/1750 train_loss:3.5781 train_time:383946ms step_avg:352.57ms
step:1100/1750 train_loss:3.4940 train_time:384322ms step_avg:352.59ms
step:1101/1750 train_loss:3.3453 train_time:384691ms step_avg:352.60ms
step:1102/1750 train_loss:3.3675 train_time:385065ms step_avg:352.62ms
step:1103/1750 train_loss:3.5063 train_time:385441ms step_avg:352.64ms
step:1104/1750 train_loss:3.3738 train_time:385806ms step_avg:352.66ms
step:1105/1750 train_loss:4.1117 train_time:386175ms step_avg:352.67ms
step:1106/1750 train_loss:3.2860 train_time:386540ms step_avg:352.68ms
step:1107/1750 train_loss:3.6305 train_time:386906ms step_avg:352.69ms
step:1108/1750 train_loss:3.3991 train_time:387269ms step_avg:352.70ms
step:1109/1750 train_loss:3.5621 train_time:387635ms step_avg:352.72ms
step:1110/1750 train_loss:3.4882 train_time:388002ms step_avg:352.73ms
step:1111/1750 train_loss:3.5420 train_time:388371ms step_avg:352.74ms
step:1112/1750 train_loss:3.6207 train_time:388747ms step_avg:352.76ms
step:1113/1750 train_loss:3.4967 train_time:389125ms step_avg:352.79ms
step:1114/1750 train_loss:3.4236 train_time:389493ms step_avg:352.80ms
step:1115/1750 train_loss:3.3095 train_time:389861ms step_avg:352.82ms
step:1116/1750 train_loss:3.4840 train_time:390226ms step_avg:352.83ms
step:1117/1750 train_loss:3.6567 train_time:390599ms step_avg:352.84ms
step:1118/1750 train_loss:3.6855 train_time:390969ms step_avg:352.86ms
step:1119/1750 train_loss:3.5397 train_time:391335ms step_avg:352.87ms
step:1120/1750 train_loss:3.5555 train_time:391704ms step_avg:352.89ms
step:1121/1750 train_loss:3.4486 train_time:392074ms step_avg:352.90ms
step:1122/1750 train_loss:3.5237 train_time:392438ms step_avg:352.91ms
step:1123/1750 train_loss:3.6519 train_time:392805ms step_avg:352.92ms
step:1124/1750 train_loss:3.4094 train_time:393172ms step_avg:352.94ms
step:1125/1750 train_loss:3.2844 train_time:393541ms step_avg:352.95ms
step:1125/1750 val_loss:3.4750 train_time:393637ms step_avg:353.04ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 280.04663 | frobenius_norm = 64571.06250 | spectral_norm = 11179.11035 | nuclear_norm = 1622490.37500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 175.19246 | spectral_norm = 31.73461 | nuclear_norm = 4030.29102
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 170.47588 | spectral_norm = 35.21399 | nuclear_norm = 3902.39404
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 334.36417 | spectral_norm = 21.87968 | nuclear_norm = 8118.77051
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 239.92059 | spectral_norm = 25.10512 | nuclear_norm = 5527.57764
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 375.97934 | spectral_norm = 31.39030 | nuclear_norm = 9998.50586
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 192.15112 | spectral_norm = 18.08227 | nuclear_norm = 5097.58203
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 181.62978 | spectral_norm = 16.12765 | nuclear_norm = 4213.39258
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 179.03587 | spectral_norm = 16.33460 | nuclear_norm = 4156.78662
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 331.74411 | spectral_norm = 30.33070 | nuclear_norm = 7628.09473
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 324.44855 | spectral_norm = 26.06818 | nuclear_norm = 7618.55859
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 377.20364 | spectral_norm = 28.79888 | nuclear_norm = 10050.88672
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 188.52466 | spectral_norm = 19.47114 | nuclear_norm = 4965.12207
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 175.45538 | spectral_norm = 18.63480 | nuclear_norm = 4033.54590
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 173.71184 | spectral_norm = 16.50521 | nuclear_norm = 4010.11084
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 338.99475 | spectral_norm = 29.61294 | nuclear_norm = 7769.14160
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 342.26471 | spectral_norm = 25.80355 | nuclear_norm = 8037.06152
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 381.10391 | spectral_norm = 33.36203 | nuclear_norm = 10129.20410
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 188.55304 | spectral_norm = 19.23963 | nuclear_norm = 4948.32715
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 168.07268 | spectral_norm = 16.43909 | nuclear_norm = 3720.31592
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 167.13113 | spectral_norm = 15.82690 | nuclear_norm = 3714.59229
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 335.02005 | spectral_norm = 31.24578 | nuclear_norm = 7556.13135
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 347.55890 | spectral_norm = 29.39137 | nuclear_norm = 8067.61816
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 387.83856 | spectral_norm = 32.83805 | nuclear_norm = 10306.11719
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 189.66302 | spectral_norm = 19.63634 | nuclear_norm = 4985.10156
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 171.38147 | spectral_norm = 16.96297 | nuclear_norm = 3891.98633
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 170.23024 | spectral_norm = 15.85620 | nuclear_norm = 3876.65137
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 364.53064 | spectral_norm = 35.08236 | nuclear_norm = 8236.37598
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 364.81906 | spectral_norm = 27.08138 | nuclear_norm = 8596.75195
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 389.54965 | spectral_norm = 33.98209 | nuclear_norm = 10353.48926
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 189.09906 | spectral_norm = 18.01738 | nuclear_norm = 4964.39844
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 168.19708 | spectral_norm = 18.05245 | nuclear_norm = 3786.90039
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 166.66377 | spectral_norm = 17.13663 | nuclear_norm = 3754.22974
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 359.11813 | spectral_norm = 29.91520 | nuclear_norm = 8297.10352
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 354.17630 | spectral_norm = 26.54372 | nuclear_norm = 8368.35449
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 395.36957 | spectral_norm = 29.74477 | nuclear_norm = 10527.18164
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 191.22639 | spectral_norm = 18.36250 | nuclear_norm = 5039.57227
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 170.34003 | spectral_norm = 16.80532 | nuclear_norm = 3839.38428
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 167.68460 | spectral_norm = 15.79343 | nuclear_norm = 3810.42676
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 371.27448 | spectral_norm = 33.51644 | nuclear_norm = 8394.95410
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 360.83109 | spectral_norm = 28.01814 | nuclear_norm = 8459.66992
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 385.68298 | spectral_norm = 30.30433 | nuclear_norm = 10283.90820
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 190.37392 | spectral_norm = 18.64111 | nuclear_norm = 5004.01270
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 168.51459 | spectral_norm = 17.08261 | nuclear_norm = 3803.95825
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 165.82710 | spectral_norm = 16.37791 | nuclear_norm = 3771.30908
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 358.80777 | spectral_norm = 30.04836 | nuclear_norm = 8162.68555
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 352.58820 | spectral_norm = 29.69154 | nuclear_norm = 8092.19238
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 392.04947 | spectral_norm = 31.38893 | nuclear_norm = 10412.75781
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 193.53023 | spectral_norm = 19.55641 | nuclear_norm = 5097.67090
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 174.48946 | spectral_norm = 19.11995 | nuclear_norm = 3871.88037
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 175.85832 | spectral_norm = 17.32527 | nuclear_norm = 3860.48706
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 347.97079 | spectral_norm = 31.42916 | nuclear_norm = 7970.30762
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 359.16040 | spectral_norm = 24.69805 | nuclear_norm = 8478.86230
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 396.66827 | spectral_norm = 33.46593 | nuclear_norm = 10530.35938
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 201.05742 | spectral_norm = 20.38695 | nuclear_norm = 5325.62988
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 177.49544 | spectral_norm = 18.25132 | nuclear_norm = 4006.31396
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 175.20729 | spectral_norm = 18.18866 | nuclear_norm = 3938.99146
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 382.16214 | spectral_norm = 35.33211 | nuclear_norm = 8689.71484
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 367.35516 | spectral_norm = 26.82726 | nuclear_norm = 8642.13281
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 390.43427 | spectral_norm = 33.51405 | nuclear_norm = 10379.32227
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 199.68616 | spectral_norm = 20.84858 | nuclear_norm = 5298.62012
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 179.66258 | spectral_norm = 19.79696 | nuclear_norm = 4076.17798
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 174.82257 | spectral_norm = 18.86495 | nuclear_norm = 3960.58276
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 362.18790 | spectral_norm = 38.36165 | nuclear_norm = 8265.42773
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 368.22519 | spectral_norm = 27.80686 | nuclear_norm = 8673.02344
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 406.01642 | spectral_norm = 31.32755 | nuclear_norm = 10818.26172
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 192.13065 | spectral_norm = 22.51334 | nuclear_norm = 5082.53369
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 176.34738 | spectral_norm = 22.24356 | nuclear_norm = 3902.83447
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 172.19164 | spectral_norm = 20.12140 | nuclear_norm = 3789.32373
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 334.21942 | spectral_norm = 33.57830 | nuclear_norm = 7615.96191
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 374.36533 | spectral_norm = 27.78550 | nuclear_norm = 8747.31250
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 415.11636 | spectral_norm = 30.61608 | nuclear_norm = 11060.23047
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 193.42831 | spectral_norm = 25.72226 | nuclear_norm = 5076.17871
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1242.84412 | spectral_norm = 166.23839 | nuclear_norm = 32678.71680
===========================================
step:1126/1750 train_loss:3.5399 train_time:393900ms step_avg:352.96ms
step:1127/1750 train_loss:3.7450 train_time:394257ms step_avg:352.96ms
step:1128/1750 train_loss:3.2965 train_time:394623ms step_avg:352.97ms
step:1129/1750 train_loss:3.6285 train_time:394990ms step_avg:352.98ms
step:1130/1750 train_loss:3.4451 train_time:395359ms step_avg:353.00ms
step:1131/1750 train_loss:3.4622 train_time:395732ms step_avg:353.02ms
step:1132/1750 train_loss:3.4250 train_time:396093ms step_avg:353.02ms
step:1133/1750 train_loss:3.5585 train_time:396490ms step_avg:353.06ms
step:1134/1750 train_loss:3.5160 train_time:396925ms step_avg:353.14ms
step:1135/1750 train_loss:3.5864 train_time:397290ms step_avg:353.15ms
step:1136/1750 train_loss:3.6210 train_time:397656ms step_avg:353.16ms
step:1137/1750 train_loss:3.5226 train_time:398019ms step_avg:353.17ms
step:1138/1750 train_loss:3.4145 train_time:398387ms step_avg:353.18ms
step:1139/1750 train_loss:3.7175 train_time:398875ms step_avg:353.30ms
step:1140/1750 train_loss:3.5322 train_time:399242ms step_avg:353.31ms
step:1141/1750 train_loss:3.6592 train_time:399613ms step_avg:353.33ms
step:1142/1750 train_loss:3.5218 train_time:399983ms step_avg:353.34ms
step:1143/1750 train_loss:3.4229 train_time:400354ms step_avg:353.36ms
step:1144/1750 train_loss:3.5109 train_time:400721ms step_avg:353.37ms
step:1145/1750 train_loss:3.6562 train_time:401083ms step_avg:353.38ms
step:1146/1750 train_loss:3.6139 train_time:401453ms step_avg:353.39ms
step:1147/1750 train_loss:3.5520 train_time:401820ms step_avg:353.40ms
step:1148/1750 train_loss:3.5693 train_time:402184ms step_avg:353.41ms
step:1149/1750 train_loss:3.3947 train_time:402551ms step_avg:353.42ms
step:1150/1750 train_loss:3.4354 train_time:402915ms step_avg:353.43ms
step:1151/1750 train_loss:3.3861 train_time:403281ms step_avg:353.45ms
step:1152/1750 train_loss:3.4689 train_time:403651ms step_avg:353.46ms
step:1153/1750 train_loss:3.4972 train_time:404022ms step_avg:353.47ms
step:1154/1750 train_loss:3.5905 train_time:404384ms step_avg:353.48ms
step:1155/1750 train_loss:3.3862 train_time:404755ms step_avg:353.50ms
step:1156/1750 train_loss:3.6039 train_time:405129ms step_avg:353.52ms
step:1157/1750 train_loss:3.5587 train_time:405498ms step_avg:353.53ms
step:1158/1750 train_loss:3.3307 train_time:405863ms step_avg:353.54ms
step:1159/1750 train_loss:3.4089 train_time:406229ms step_avg:353.55ms
step:1160/1750 train_loss:3.3976 train_time:406589ms step_avg:353.56ms
step:1161/1750 train_loss:3.1471 train_time:406956ms step_avg:353.57ms
step:1162/1750 train_loss:3.4900 train_time:407321ms step_avg:353.58ms
step:1163/1750 train_loss:3.4491 train_time:407689ms step_avg:353.59ms
step:1164/1750 train_loss:3.3504 train_time:408054ms step_avg:353.60ms
step:1165/1750 train_loss:3.3128 train_time:408417ms step_avg:353.61ms
step:1166/1750 train_loss:3.4490 train_time:408784ms step_avg:353.62ms
step:1167/1750 train_loss:3.4654 train_time:409147ms step_avg:353.63ms
step:1168/1750 train_loss:3.7908 train_time:409515ms step_avg:353.64ms
step:1169/1750 train_loss:3.4421 train_time:409885ms step_avg:353.65ms
step:1170/1750 train_loss:3.4542 train_time:410254ms step_avg:353.67ms
step:1171/1750 train_loss:3.3564 train_time:410624ms step_avg:353.68ms
step:1172/1750 train_loss:3.4906 train_time:410991ms step_avg:353.69ms
step:1173/1750 train_loss:3.6033 train_time:411369ms step_avg:353.71ms
step:1174/1750 train_loss:3.4507 train_time:411754ms step_avg:353.74ms
step:1175/1750 train_loss:3.4415 train_time:412128ms step_avg:353.76ms
step:1176/1750 train_loss:3.4906 train_time:412508ms step_avg:353.78ms
step:1177/1750 train_loss:3.5183 train_time:412887ms step_avg:353.80ms
step:1178/1750 train_loss:3.5633 train_time:413254ms step_avg:353.81ms
step:1179/1750 train_loss:3.4721 train_time:413625ms step_avg:353.83ms
step:1180/1750 train_loss:3.4188 train_time:414015ms step_avg:353.86ms
step:1181/1750 train_loss:3.4007 train_time:414386ms step_avg:353.87ms
step:1182/1750 train_loss:3.4522 train_time:414757ms step_avg:353.89ms
step:1183/1750 train_loss:3.3960 train_time:415127ms step_avg:353.90ms
step:1184/1750 train_loss:3.5743 train_time:415500ms step_avg:353.92ms
step:1185/1750 train_loss:3.6112 train_time:415878ms step_avg:353.94ms
step:1186/1750 train_loss:3.4261 train_time:416253ms step_avg:353.96ms
step:1187/1750 train_loss:3.4742 train_time:416640ms step_avg:353.98ms
step:1188/1750 train_loss:3.5092 train_time:417006ms step_avg:353.99ms
step:1189/1750 train_loss:3.3366 train_time:417379ms step_avg:354.01ms
step:1190/1750 train_loss:3.5141 train_time:417754ms step_avg:354.03ms
step:1191/1750 train_loss:3.6457 train_time:418131ms step_avg:354.05ms
step:1192/1750 train_loss:3.4614 train_time:418500ms step_avg:354.06ms
step:1193/1750 train_loss:3.3371 train_time:418869ms step_avg:354.07ms
step:1194/1750 train_loss:3.6256 train_time:419241ms step_avg:354.09ms
step:1195/1750 train_loss:3.4401 train_time:419623ms step_avg:354.11ms
step:1196/1750 train_loss:3.4512 train_time:420016ms step_avg:354.14ms
step:1197/1750 train_loss:3.3552 train_time:420391ms step_avg:354.16ms
step:1198/1750 train_loss:3.3636 train_time:420776ms step_avg:354.19ms
step:1199/1750 train_loss:3.4068 train_time:421150ms step_avg:354.21ms
step:1200/1750 train_loss:3.5076 train_time:421523ms step_avg:354.22ms
step:1201/1750 train_loss:3.5527 train_time:421894ms step_avg:354.23ms
step:1202/1750 train_loss:3.6682 train_time:422288ms step_avg:354.27ms
step:1203/1750 train_loss:3.4669 train_time:422665ms step_avg:354.29ms
step:1204/1750 train_loss:3.3771 train_time:423040ms step_avg:354.30ms
step:1205/1750 train_loss:3.4893 train_time:423411ms step_avg:354.32ms
step:1206/1750 train_loss:3.5381 train_time:423779ms step_avg:354.33ms
step:1207/1750 train_loss:3.5864 train_time:424146ms step_avg:354.34ms
step:1208/1750 train_loss:3.4671 train_time:424510ms step_avg:354.35ms
step:1209/1750 train_loss:3.3016 train_time:424887ms step_avg:354.37ms
step:1210/1750 train_loss:3.3719 train_time:425264ms step_avg:354.39ms
step:1211/1750 train_loss:3.4650 train_time:425631ms step_avg:354.40ms
step:1212/1750 train_loss:3.4575 train_time:425998ms step_avg:354.41ms
step:1213/1750 train_loss:3.4806 train_time:426373ms step_avg:354.42ms
step:1214/1750 train_loss:3.3292 train_time:426750ms step_avg:354.44ms
step:1215/1750 train_loss:3.4519 train_time:427119ms step_avg:354.46ms
step:1216/1750 train_loss:3.3942 train_time:427489ms step_avg:354.47ms
step:1217/1750 train_loss:3.3954 train_time:427864ms step_avg:354.49ms
step:1218/1750 train_loss:3.4751 train_time:428237ms step_avg:354.50ms
step:1219/1750 train_loss:3.3311 train_time:428618ms step_avg:354.52ms
step:1220/1750 train_loss:3.5373 train_time:428989ms step_avg:354.54ms
step:1221/1750 train_loss:3.5725 train_time:429359ms step_avg:354.55ms
step:1222/1750 train_loss:3.5077 train_time:429727ms step_avg:354.56ms
step:1223/1750 train_loss:3.3539 train_time:430100ms step_avg:354.58ms
step:1224/1750 train_loss:3.3236 train_time:430478ms step_avg:354.59ms
step:1225/1750 train_loss:3.4366 train_time:430850ms step_avg:354.61ms
step:1226/1750 train_loss:3.3907 train_time:431226ms step_avg:354.63ms
step:1227/1750 train_loss:3.3362 train_time:431601ms step_avg:354.64ms
step:1228/1750 train_loss:3.5118 train_time:431968ms step_avg:354.65ms
step:1229/1750 train_loss:3.4323 train_time:432341ms step_avg:354.67ms
step:1230/1750 train_loss:3.4652 train_time:432722ms step_avg:354.69ms
step:1231/1750 train_loss:3.6448 train_time:433100ms step_avg:354.71ms
step:1232/1750 train_loss:3.5537 train_time:433474ms step_avg:354.72ms
step:1233/1750 train_loss:3.4929 train_time:433841ms step_avg:354.74ms
step:1234/1750 train_loss:3.6519 train_time:434209ms step_avg:354.75ms
step:1235/1750 train_loss:3.3886 train_time:434584ms step_avg:354.76ms
step:1236/1750 train_loss:3.3562 train_time:434951ms step_avg:354.77ms
step:1237/1750 train_loss:3.3366 train_time:435321ms step_avg:354.78ms
step:1238/1750 train_loss:3.3545 train_time:435700ms step_avg:354.80ms
step:1239/1750 train_loss:3.3898 train_time:436071ms step_avg:354.82ms
step:1240/1750 train_loss:3.4454 train_time:436446ms step_avg:354.83ms
step:1241/1750 train_loss:3.4881 train_time:436819ms step_avg:354.85ms
step:1242/1750 train_loss:3.3705 train_time:437186ms step_avg:354.86ms
step:1243/1750 train_loss:3.4762 train_time:437557ms step_avg:354.87ms
step:1244/1750 train_loss:3.4753 train_time:437923ms step_avg:354.88ms
step:1245/1750 train_loss:3.4819 train_time:438291ms step_avg:354.89ms
step:1246/1750 train_loss:3.3011 train_time:438664ms step_avg:354.91ms
step:1247/1750 train_loss:3.4466 train_time:439031ms step_avg:354.92ms
step:1248/1750 train_loss:3.5043 train_time:439397ms step_avg:354.93ms
step:1249/1750 train_loss:3.4838 train_time:439765ms step_avg:354.94ms
step:1250/1750 train_loss:3.3677 train_time:440133ms step_avg:354.95ms
step:1250/1750 val_loss:3.4210 train_time:440232ms step_avg:355.03ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 288.43439 | frobenius_norm = 66546.57031 | spectral_norm = 11500.22363 | nuclear_norm = 1674349.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 183.44545 | spectral_norm = 34.38224 | nuclear_norm = 4212.24170
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 178.72290 | spectral_norm = 37.94328 | nuclear_norm = 4084.50342
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 350.06357 | spectral_norm = 23.00073 | nuclear_norm = 8518.91797
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 245.73277 | spectral_norm = 26.29986 | nuclear_norm = 5648.07227
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 397.46014 | spectral_norm = 33.52516 | nuclear_norm = 10569.45801
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 202.13187 | spectral_norm = 19.37231 | nuclear_norm = 5362.19238
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 191.37497 | spectral_norm = 17.05496 | nuclear_norm = 4436.52100
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 188.62134 | spectral_norm = 17.36163 | nuclear_norm = 4377.31445
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 346.97751 | spectral_norm = 31.95337 | nuclear_norm = 7978.38477
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 339.05038 | spectral_norm = 27.13388 | nuclear_norm = 7965.67334
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 396.23627 | spectral_norm = 30.67997 | nuclear_norm = 10560.77344
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 198.29556 | spectral_norm = 20.69823 | nuclear_norm = 5221.70508
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 184.63167 | spectral_norm = 19.99032 | nuclear_norm = 4238.81543
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 182.86957 | spectral_norm = 17.55427 | nuclear_norm = 4219.86279
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 355.94086 | spectral_norm = 31.30989 | nuclear_norm = 8158.74707
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 359.23282 | spectral_norm = 27.21566 | nuclear_norm = 8440.57422
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 400.10800 | spectral_norm = 35.70489 | nuclear_norm = 10633.46094
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 197.99104 | spectral_norm = 20.34859 | nuclear_norm = 5194.11963
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 176.26695 | spectral_norm = 17.48076 | nuclear_norm = 3887.11255
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 175.52261 | spectral_norm = 16.86559 | nuclear_norm = 3888.30518
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 352.65439 | spectral_norm = 33.15136 | nuclear_norm = 7952.47461
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 365.41232 | spectral_norm = 31.23528 | nuclear_norm = 8477.60156
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 406.97247 | spectral_norm = 35.20237 | nuclear_norm = 10812.03516
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 199.35477 | spectral_norm = 20.86496 | nuclear_norm = 5238.44043
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 180.05759 | spectral_norm = 17.99368 | nuclear_norm = 4080.39062
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 178.69084 | spectral_norm = 16.90515 | nuclear_norm = 4061.93970
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 384.28510 | spectral_norm = 36.98627 | nuclear_norm = 8686.96289
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 383.93683 | spectral_norm = 28.23376 | nuclear_norm = 9052.68652
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 408.47119 | spectral_norm = 36.18188 | nuclear_norm = 10854.76953
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 198.65192 | spectral_norm = 19.20509 | nuclear_norm = 5215.30469
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 176.82387 | spectral_norm = 19.22587 | nuclear_norm = 3971.40845
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 174.90669 | spectral_norm = 18.13562 | nuclear_norm = 3932.19165
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 378.38611 | spectral_norm = 31.76973 | nuclear_norm = 8750.18750
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 372.48129 | spectral_norm = 27.89950 | nuclear_norm = 8807.27051
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 414.95828 | spectral_norm = 31.81697 | nuclear_norm = 11049.41797
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 200.93245 | spectral_norm = 19.57585 | nuclear_norm = 5296.54443
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 178.75308 | spectral_norm = 17.85624 | nuclear_norm = 4018.22656
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 175.97200 | spectral_norm = 16.76813 | nuclear_norm = 3990.23584
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 390.56586 | spectral_norm = 35.33897 | nuclear_norm = 8840.01855
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 379.26633 | spectral_norm = 29.26054 | nuclear_norm = 8891.61133
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 404.90598 | spectral_norm = 32.31224 | nuclear_norm = 10795.90527
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 200.02084 | spectral_norm = 19.93679 | nuclear_norm = 5257.22949
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 177.08151 | spectral_norm = 18.14343 | nuclear_norm = 3985.85254
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 174.23604 | spectral_norm = 17.30818 | nuclear_norm = 3954.42261
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 377.80237 | spectral_norm = 31.75849 | nuclear_norm = 8604.41602
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 370.13599 | spectral_norm = 31.53032 | nuclear_norm = 8485.81836
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 412.13901 | spectral_norm = 33.49836 | nuclear_norm = 10941.53320
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 203.35750 | spectral_norm = 20.94425 | nuclear_norm = 5353.89404
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 183.35533 | spectral_norm = 20.34636 | nuclear_norm = 4053.91895
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 184.84883 | spectral_norm = 18.47488 | nuclear_norm = 4041.69360
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 365.80658 | spectral_norm = 33.50325 | nuclear_norm = 8366.58105
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 375.40536 | spectral_norm = 25.93538 | nuclear_norm = 8860.75293
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 418.04324 | spectral_norm = 35.72367 | nuclear_norm = 11092.76172
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 211.89407 | spectral_norm = 21.79827 | nuclear_norm = 5612.11475
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 186.56537 | spectral_norm = 19.47340 | nuclear_norm = 4199.89258
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 184.19966 | spectral_norm = 19.41722 | nuclear_norm = 4130.04980
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 401.94916 | spectral_norm = 37.71793 | nuclear_norm = 9134.43359
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 384.60678 | spectral_norm = 28.28905 | nuclear_norm = 9048.66309
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 409.94504 | spectral_norm = 35.67872 | nuclear_norm = 10894.20410
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 210.25500 | spectral_norm = 22.21882 | nuclear_norm = 5580.11816
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 188.94296 | spectral_norm = 21.20890 | nuclear_norm = 4272.95605
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 183.77771 | spectral_norm = 20.15390 | nuclear_norm = 4149.17725
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 382.15320 | spectral_norm = 40.90973 | nuclear_norm = 8717.09668
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 387.00034 | spectral_norm = 29.20662 | nuclear_norm = 9113.33496
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 425.91226 | spectral_norm = 33.25542 | nuclear_norm = 11347.25879
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 201.96036 | spectral_norm = 24.11309 | nuclear_norm = 5342.12744
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 185.11360 | spectral_norm = 23.89867 | nuclear_norm = 4080.20850
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 180.70418 | spectral_norm = 21.47754 | nuclear_norm = 3959.33984
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 353.96008 | spectral_norm = 35.89358 | nuclear_norm = 8059.34961
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 395.31198 | spectral_norm = 29.05610 | nuclear_norm = 9238.30371
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 435.69257 | spectral_norm = 32.13106 | nuclear_norm = 11606.46094
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 203.14427 | spectral_norm = 27.78141 | nuclear_norm = 5326.15088
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1293.08826 | spectral_norm = 165.16188 | nuclear_norm = 34078.23438
===========================================
step:1251/1750 train_loss:3.5627 train_time:440506ms step_avg:354.96ms
step:1252/1750 train_loss:3.4384 train_time:440868ms step_avg:354.97ms
step:1253/1750 train_loss:3.3713 train_time:441232ms step_avg:354.97ms
step:1254/1750 train_loss:3.4721 train_time:441602ms step_avg:354.99ms
step:1255/1750 train_loss:3.5874 train_time:441985ms step_avg:355.01ms
step:1256/1750 train_loss:3.3735 train_time:442357ms step_avg:355.02ms
step:1257/1750 train_loss:3.4302 train_time:442724ms step_avg:355.03ms
step:1258/1750 train_loss:3.4198 train_time:443100ms step_avg:355.05ms
step:1259/1750 train_loss:3.4005 train_time:443468ms step_avg:355.06ms
step:1260/1750 train_loss:3.2668 train_time:443832ms step_avg:355.07ms
step:1261/1750 train_loss:3.3645 train_time:444205ms step_avg:355.08ms
step:1262/1750 train_loss:3.3923 train_time:444583ms step_avg:355.10ms
step:1263/1750 train_loss:3.2961 train_time:444957ms step_avg:355.11ms
step:1264/1750 train_loss:3.5134 train_time:445320ms step_avg:355.12ms
step:1265/1750 train_loss:3.4946 train_time:445686ms step_avg:355.13ms
step:1266/1750 train_loss:3.5030 train_time:446054ms step_avg:355.14ms
step:1267/1750 train_loss:3.4326 train_time:446421ms step_avg:355.15ms
step:1268/1750 train_loss:3.4718 train_time:446789ms step_avg:355.16ms
step:1269/1750 train_loss:3.3119 train_time:447165ms step_avg:355.17ms
step:1270/1750 train_loss:3.1637 train_time:447534ms step_avg:355.19ms
step:1271/1750 train_loss:3.4610 train_time:447904ms step_avg:355.20ms
step:1272/1750 train_loss:3.4226 train_time:448271ms step_avg:355.21ms
step:1273/1750 train_loss:3.4551 train_time:448648ms step_avg:355.22ms
step:1274/1750 train_loss:3.4174 train_time:449022ms step_avg:355.24ms
step:1275/1750 train_loss:3.5012 train_time:449388ms step_avg:355.25ms
step:1276/1750 train_loss:3.5391 train_time:449749ms step_avg:355.25ms
step:1277/1750 train_loss:3.4763 train_time:450119ms step_avg:355.26ms
step:1278/1750 train_loss:3.4628 train_time:450484ms step_avg:355.27ms
step:1279/1750 train_loss:3.3247 train_time:450856ms step_avg:355.28ms
step:1280/1750 train_loss:3.4376 train_time:451232ms step_avg:355.30ms
step:1281/1750 train_loss:3.4867 train_time:451600ms step_avg:355.31ms
step:1282/1750 train_loss:3.5341 train_time:451963ms step_avg:355.32ms
step:1283/1750 train_loss:3.3960 train_time:452335ms step_avg:355.33ms
step:1284/1750 train_loss:3.4334 train_time:452706ms step_avg:355.34ms
step:1285/1750 train_loss:3.4239 train_time:453075ms step_avg:355.35ms
step:1286/1750 train_loss:3.4029 train_time:453443ms step_avg:355.36ms
step:1287/1750 train_loss:3.5545 train_time:453812ms step_avg:355.37ms
step:1288/1750 train_loss:3.3672 train_time:454185ms step_avg:355.39ms
step:1289/1750 train_loss:3.4488 train_time:454563ms step_avg:355.41ms
step:1290/1750 train_loss:3.5221 train_time:454942ms step_avg:355.42ms
step:1291/1750 train_loss:3.4477 train_time:455314ms step_avg:355.44ms
step:1292/1750 train_loss:3.5427 train_time:455686ms step_avg:355.45ms
step:1293/1750 train_loss:3.5822 train_time:456058ms step_avg:355.46ms
step:1294/1750 train_loss:3.5226 train_time:456432ms step_avg:355.48ms
step:1295/1750 train_loss:3.3540 train_time:456801ms step_avg:355.49ms
step:1296/1750 train_loss:3.4376 train_time:457174ms step_avg:355.50ms
step:1297/1750 train_loss:3.3427 train_time:457542ms step_avg:355.51ms
step:1298/1750 train_loss:3.3435 train_time:457916ms step_avg:355.52ms
step:1299/1750 train_loss:3.4535 train_time:458288ms step_avg:355.54ms
step:1300/1750 train_loss:3.4714 train_time:458661ms step_avg:355.55ms
step:1301/1750 train_loss:3.4698 train_time:459032ms step_avg:355.56ms
step:1302/1750 train_loss:3.6373 train_time:459413ms step_avg:355.58ms
step:1303/1750 train_loss:3.3663 train_time:459795ms step_avg:355.60ms
step:1304/1750 train_loss:3.5720 train_time:460173ms step_avg:355.62ms
step:1305/1750 train_loss:3.3314 train_time:460544ms step_avg:355.63ms
step:1306/1750 train_loss:3.5096 train_time:460924ms step_avg:355.65ms
step:1307/1750 train_loss:3.5197 train_time:461290ms step_avg:355.66ms
step:1308/1750 train_loss:3.3598 train_time:461662ms step_avg:355.67ms
step:1309/1750 train_loss:3.3689 train_time:462040ms step_avg:355.69ms
step:1310/1750 train_loss:3.3656 train_time:462415ms step_avg:355.70ms
step:1311/1750 train_loss:3.3559 train_time:462787ms step_avg:355.72ms
step:1312/1750 train_loss:3.4463 train_time:463166ms step_avg:355.73ms
step:1313/1750 train_loss:3.4094 train_time:463536ms step_avg:355.75ms
step:1314/1750 train_loss:3.1013 train_time:463915ms step_avg:355.76ms
step:1315/1750 train_loss:3.3467 train_time:464286ms step_avg:355.78ms
step:1316/1750 train_loss:3.4552 train_time:464652ms step_avg:355.78ms
step:1317/1750 train_loss:3.4873 train_time:465021ms step_avg:355.79ms
step:1318/1750 train_loss:3.3605 train_time:465405ms step_avg:355.81ms
step:1319/1750 train_loss:3.4922 train_time:465785ms step_avg:355.83ms
step:1320/1750 train_loss:3.5181 train_time:466167ms step_avg:355.85ms
step:1321/1750 train_loss:3.4250 train_time:466545ms step_avg:355.87ms
step:1322/1750 train_loss:3.3828 train_time:466966ms step_avg:355.92ms
step:1323/1750 train_loss:3.3917 train_time:467394ms step_avg:355.97ms
step:1324/1750 train_loss:3.4994 train_time:467772ms step_avg:355.99ms
step:1325/1750 train_loss:3.5601 train_time:468157ms step_avg:356.01ms
step:1326/1750 train_loss:3.2854 train_time:468535ms step_avg:356.03ms
step:1327/1750 train_loss:3.2232 train_time:468904ms step_avg:356.04ms
step:1328/1750 train_loss:3.5569 train_time:469285ms step_avg:356.06ms
step:1329/1750 train_loss:3.3604 train_time:469808ms step_avg:356.18ms
step:1330/1750 train_loss:3.4864 train_time:470189ms step_avg:356.20ms
step:1331/1750 train_loss:3.3985 train_time:470556ms step_avg:356.21ms
step:1332/1750 train_loss:3.8093 train_time:470932ms step_avg:356.23ms
step:1333/1750 train_loss:3.5363 train_time:471312ms step_avg:356.24ms
step:1334/1750 train_loss:3.4366 train_time:471686ms step_avg:356.26ms
step:1335/1750 train_loss:3.3660 train_time:472060ms step_avg:356.27ms
step:1336/1750 train_loss:3.3536 train_time:472443ms step_avg:356.29ms
step:1337/1750 train_loss:3.6136 train_time:472819ms step_avg:356.31ms
step:1338/1750 train_loss:3.5817 train_time:473196ms step_avg:356.32ms
step:1339/1750 train_loss:3.3996 train_time:473578ms step_avg:356.34ms
step:1340/1750 train_loss:3.3441 train_time:473955ms step_avg:356.36ms
step:1341/1750 train_loss:3.6609 train_time:474328ms step_avg:356.37ms
step:1342/1750 train_loss:3.4226 train_time:474704ms step_avg:356.38ms
step:1343/1750 train_loss:3.4236 train_time:475073ms step_avg:356.39ms
step:1344/1750 train_loss:3.4801 train_time:475452ms step_avg:356.41ms
step:1345/1750 train_loss:3.4473 train_time:475834ms step_avg:356.43ms
step:1346/1750 train_loss:3.3608 train_time:476207ms step_avg:356.44ms
step:1347/1750 train_loss:3.3339 train_time:476581ms step_avg:356.46ms
step:1348/1750 train_loss:3.4075 train_time:476955ms step_avg:356.47ms
step:1349/1750 train_loss:3.3357 train_time:477330ms step_avg:356.48ms
step:1350/1750 train_loss:3.4550 train_time:477709ms step_avg:356.50ms
step:1351/1750 train_loss:3.3107 train_time:478079ms step_avg:356.51ms
step:1352/1750 train_loss:3.3657 train_time:478451ms step_avg:356.52ms
step:1353/1750 train_loss:3.4690 train_time:478832ms step_avg:356.54ms
step:1354/1750 train_loss:3.3182 train_time:479207ms step_avg:356.55ms
step:1355/1750 train_loss:3.2564 train_time:479581ms step_avg:356.57ms
step:1356/1750 train_loss:3.5822 train_time:479957ms step_avg:356.58ms
step:1357/1750 train_loss:3.4842 train_time:480336ms step_avg:356.60ms
step:1358/1750 train_loss:3.2424 train_time:480713ms step_avg:356.61ms
step:1359/1750 train_loss:3.5055 train_time:481090ms step_avg:356.63ms
step:1360/1750 train_loss:3.4162 train_time:481465ms step_avg:356.64ms
step:1361/1750 train_loss:3.2060 train_time:481844ms step_avg:356.66ms
step:1362/1750 train_loss:3.4579 train_time:482220ms step_avg:356.67ms
step:1363/1750 train_loss:3.3390 train_time:482601ms step_avg:356.69ms
step:1364/1750 train_loss:3.3749 train_time:482972ms step_avg:356.70ms
step:1365/1750 train_loss:3.3754 train_time:483344ms step_avg:356.71ms
step:1366/1750 train_loss:3.4917 train_time:483720ms step_avg:356.73ms
step:1367/1750 train_loss:3.4578 train_time:484093ms step_avg:356.74ms
step:1368/1750 train_loss:3.4136 train_time:484470ms step_avg:356.75ms
step:1369/1750 train_loss:3.3254 train_time:484854ms step_avg:356.77ms
step:1370/1750 train_loss:3.6739 train_time:485230ms step_avg:356.79ms
step:1371/1750 train_loss:3.3806 train_time:485606ms step_avg:356.80ms
step:1372/1750 train_loss:3.4261 train_time:485983ms step_avg:356.82ms
step:1373/1750 train_loss:3.4252 train_time:486354ms step_avg:356.83ms
step:1374/1750 train_loss:3.2220 train_time:486729ms step_avg:356.84ms
step:1375/1750 train_loss:3.6082 train_time:487100ms step_avg:356.85ms
step:1375/1750 val_loss:3.3750 train_time:487196ms step_avg:356.92ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 293.04819 | frobenius_norm = 67638.19531 | spectral_norm = 11694.29102 | nuclear_norm = 1703547.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 188.03819 | spectral_norm = 36.30042 | nuclear_norm = 4309.31689
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 183.40067 | spectral_norm = 39.81995 | nuclear_norm = 4183.00000
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 359.53973 | spectral_norm = 23.64929 | nuclear_norm = 8765.64648
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 248.54692 | spectral_norm = 27.12552 | nuclear_norm = 5697.93164
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 410.63492 | spectral_norm = 34.87154 | nuclear_norm = 10918.37598
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 208.21335 | spectral_norm = 20.16489 | nuclear_norm = 5524.09863
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 197.23358 | spectral_norm = 17.69650 | nuclear_norm = 4569.07568
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 194.41936 | spectral_norm = 18.04601 | nuclear_norm = 4512.02979
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 356.80518 | spectral_norm = 32.76416 | nuclear_norm = 8204.53711
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 348.25455 | spectral_norm = 27.82479 | nuclear_norm = 8184.41406
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 407.83701 | spectral_norm = 31.83407 | nuclear_norm = 10872.66992
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 204.26112 | spectral_norm = 21.45488 | nuclear_norm = 5378.73828
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 190.19559 | spectral_norm = 20.73406 | nuclear_norm = 4363.00391
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 188.37050 | spectral_norm = 18.18459 | nuclear_norm = 4343.81445
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 366.86880 | spectral_norm = 32.35463 | nuclear_norm = 8413.28613
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 370.21814 | spectral_norm = 28.05411 | nuclear_norm = 8704.74805
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 411.58841 | spectral_norm = 37.09234 | nuclear_norm = 10936.86328
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 203.75215 | spectral_norm = 21.01835 | nuclear_norm = 5343.66162
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 181.17493 | spectral_norm = 18.07778 | nuclear_norm = 3986.09180
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 180.44856 | spectral_norm = 17.58025 | nuclear_norm = 3985.09180
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 364.18011 | spectral_norm = 34.16447 | nuclear_norm = 8217.49512
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 376.86798 | spectral_norm = 32.46257 | nuclear_norm = 8746.63867
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 418.42761 | spectral_norm = 36.67958 | nuclear_norm = 11114.88770
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 205.21307 | spectral_norm = 21.64001 | nuclear_norm = 5391.92627
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 185.26601 | spectral_norm = 18.64428 | nuclear_norm = 4189.65674
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 183.90401 | spectral_norm = 17.49008 | nuclear_norm = 4175.92334
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 396.83655 | spectral_norm = 38.11875 | nuclear_norm = 8980.31836
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 396.02991 | spectral_norm = 29.00550 | nuclear_norm = 9342.81250
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 419.58490 | spectral_norm = 37.47652 | nuclear_norm = 11148.22363
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 204.48213 | spectral_norm = 19.99844 | nuclear_norm = 5369.14697
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 182.06450 | spectral_norm = 19.95313 | nuclear_norm = 4079.89526
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 179.89122 | spectral_norm = 18.68840 | nuclear_norm = 4037.76245
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 390.85129 | spectral_norm = 32.70359 | nuclear_norm = 9050.66113
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 384.23553 | spectral_norm = 28.70214 | nuclear_norm = 9096.43652
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 426.68280 | spectral_norm = 33.10851 | nuclear_norm = 11360.06445
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 206.88976 | spectral_norm = 20.30064 | nuclear_norm = 5455.62207
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 183.85349 | spectral_norm = 18.56365 | nuclear_norm = 4122.62012
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 180.98149 | spectral_norm = 17.40677 | nuclear_norm = 4098.13818
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 402.92880 | spectral_norm = 36.41194 | nuclear_norm = 9130.34375
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 390.92139 | spectral_norm = 30.26265 | nuclear_norm = 9166.73828
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 416.60449 | spectral_norm = 33.60160 | nuclear_norm = 11107.88477
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 205.90067 | spectral_norm = 20.76896 | nuclear_norm = 5411.50000
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 182.26389 | spectral_norm = 18.95347 | nuclear_norm = 4092.13086
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 179.15533 | spectral_norm = 17.90281 | nuclear_norm = 4059.69946
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 389.95380 | spectral_norm = 32.93384 | nuclear_norm = 8892.66992
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 381.17877 | spectral_norm = 32.64976 | nuclear_norm = 8730.76172
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 424.38257 | spectral_norm = 34.81375 | nuclear_norm = 11262.12305
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 209.26923 | spectral_norm = 21.83380 | nuclear_norm = 5506.82861
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 188.58105 | spectral_norm = 21.07334 | nuclear_norm = 4154.23145
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 190.22726 | spectral_norm = 19.19205 | nuclear_norm = 4141.87402
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 377.84048 | spectral_norm = 34.91816 | nuclear_norm = 8633.53125
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 385.36325 | spectral_norm = 26.88539 | nuclear_norm = 9094.05371
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 430.93073 | spectral_norm = 37.19291 | nuclear_norm = 11428.76562
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 218.46297 | spectral_norm = 22.71160 | nuclear_norm = 5786.03418
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 191.91618 | spectral_norm = 20.22490 | nuclear_norm = 4308.76270
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 189.52715 | spectral_norm = 20.19190 | nuclear_norm = 4239.87598
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 414.60596 | spectral_norm = 39.15697 | nuclear_norm = 9419.70508
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 394.96799 | spectral_norm = 29.37438 | nuclear_norm = 9288.27734
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 421.39722 | spectral_norm = 37.01537 | nuclear_norm = 11194.65820
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 216.56357 | spectral_norm = 23.07452 | nuclear_norm = 5748.26123
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 194.35945 | spectral_norm = 22.18779 | nuclear_norm = 4382.13770
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 189.06537 | spectral_norm = 20.95897 | nuclear_norm = 4256.54004
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 395.46783 | spectral_norm = 42.79388 | nuclear_norm = 9016.99023
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 398.55670 | spectral_norm = 30.15141 | nuclear_norm = 9376.27734
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 437.12613 | spectral_norm = 34.37473 | nuclear_norm = 11643.71875
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 208.15234 | spectral_norm = 25.05853 | nuclear_norm = 5505.92188
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 190.15680 | spectral_norm = 25.05262 | nuclear_norm = 4176.82471
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 185.54012 | spectral_norm = 22.35960 | nuclear_norm = 4048.29150
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 368.61441 | spectral_norm = 37.29539 | nuclear_norm = 8389.85352
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 408.47113 | spectral_norm = 29.90896 | nuclear_norm = 9546.83203
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 446.51791 | spectral_norm = 32.95232 | nuclear_norm = 11891.34961
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 208.89375 | spectral_norm = 29.11920 | nuclear_norm = 5473.26172
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1318.15552 | spectral_norm = 163.22707 | nuclear_norm = 34808.38672
===========================================
step:1376/1750 train_loss:3.4040 train_time:487462ms step_avg:356.85ms
step:1377/1750 train_loss:3.5395 train_time:487826ms step_avg:356.86ms
step:1378/1750 train_loss:3.5416 train_time:488194ms step_avg:356.87ms
step:1379/1750 train_loss:3.1761 train_time:488569ms step_avg:356.88ms
step:1380/1750 train_loss:3.3781 train_time:488939ms step_avg:356.89ms
step:1381/1750 train_loss:3.7759 train_time:489316ms step_avg:356.90ms
step:1382/1750 train_loss:3.2829 train_time:489688ms step_avg:356.92ms
step:1383/1750 train_loss:3.4616 train_time:490062ms step_avg:356.93ms
step:1384/1750 train_loss:3.5448 train_time:490437ms step_avg:356.94ms
step:1385/1750 train_loss:3.4677 train_time:490802ms step_avg:356.95ms
step:1386/1750 train_loss:3.4054 train_time:491176ms step_avg:356.96ms
step:1387/1750 train_loss:3.2602 train_time:491549ms step_avg:356.97ms
step:1388/1750 train_loss:3.4073 train_time:491919ms step_avg:356.98ms
step:1389/1750 train_loss:3.3837 train_time:492291ms step_avg:356.99ms
step:1390/1750 train_loss:3.6405 train_time:492660ms step_avg:357.00ms
step:1391/1750 train_loss:3.3529 train_time:493031ms step_avg:357.01ms
step:1392/1750 train_loss:3.3513 train_time:493401ms step_avg:357.02ms
step:1393/1750 train_loss:3.3110 train_time:493769ms step_avg:357.03ms
step:1394/1750 train_loss:3.5731 train_time:494136ms step_avg:357.03ms
step:1395/1750 train_loss:3.4584 train_time:494508ms step_avg:357.05ms
step:1396/1750 train_loss:3.4708 train_time:494876ms step_avg:357.05ms
step:1397/1750 train_loss:3.3669 train_time:495241ms step_avg:357.06ms
step:1398/1750 train_loss:3.3110 train_time:495610ms step_avg:357.07ms
step:1399/1750 train_loss:3.3948 train_time:495984ms step_avg:357.08ms
step:1400/1750 train_loss:3.3780 train_time:496366ms step_avg:357.10ms
step:1401/1750 train_loss:3.4098 train_time:496727ms step_avg:357.10ms
step:1402/1750 train_loss:3.3591 train_time:497096ms step_avg:357.11ms
step:1403/1750 train_loss:3.5582 train_time:497473ms step_avg:357.12ms
step:1404/1750 train_loss:3.3423 train_time:497841ms step_avg:357.13ms
step:1405/1750 train_loss:3.3684 train_time:498211ms step_avg:357.14ms
step:1406/1750 train_loss:3.3738 train_time:498583ms step_avg:357.15ms
step:1407/1750 train_loss:3.2334 train_time:498950ms step_avg:357.16ms
step:1408/1750 train_loss:3.3654 train_time:499324ms step_avg:357.17ms
step:1409/1750 train_loss:3.3592 train_time:499713ms step_avg:357.19ms
step:1410/1750 train_loss:3.3472 train_time:500082ms step_avg:357.20ms
step:1411/1750 train_loss:3.4316 train_time:500448ms step_avg:357.21ms
step:1412/1750 train_loss:3.3901 train_time:500817ms step_avg:357.22ms
step:1413/1750 train_loss:3.4195 train_time:501191ms step_avg:357.23ms
step:1414/1750 train_loss:3.3985 train_time:501564ms step_avg:357.24ms
step:1415/1750 train_loss:3.4719 train_time:501948ms step_avg:357.26ms
step:1416/1750 train_loss:3.2846 train_time:502340ms step_avg:357.28ms
step:1417/1750 train_loss:3.3460 train_time:502719ms step_avg:357.30ms
step:1418/1750 train_loss:3.4516 train_time:503093ms step_avg:357.31ms
step:1419/1750 train_loss:3.4032 train_time:503469ms step_avg:357.32ms
step:1420/1750 train_loss:3.4168 train_time:503845ms step_avg:357.34ms
step:1421/1750 train_loss:3.4322 train_time:504218ms step_avg:357.35ms
step:1422/1750 train_loss:3.4001 train_time:504586ms step_avg:357.36ms
step:1423/1750 train_loss:3.3837 train_time:504957ms step_avg:357.36ms
step:1424/1750 train_loss:3.3850 train_time:505336ms step_avg:357.38ms
step:1425/1750 train_loss:3.2423 train_time:505721ms step_avg:357.40ms
step:1426/1750 train_loss:3.3869 train_time:506094ms step_avg:357.41ms
step:1427/1750 train_loss:3.3349 train_time:506472ms step_avg:357.43ms
step:1428/1750 train_loss:3.4387 train_time:506844ms step_avg:357.44ms
step:1429/1750 train_loss:3.4145 train_time:507215ms step_avg:357.45ms
step:1430/1750 train_loss:3.3198 train_time:507594ms step_avg:357.46ms
step:1431/1750 train_loss:3.3784 train_time:507976ms step_avg:357.48ms
step:1432/1750 train_loss:3.3951 train_time:508358ms step_avg:357.50ms
step:1433/1750 train_loss:3.2031 train_time:508746ms step_avg:357.52ms
step:1434/1750 train_loss:3.3488 train_time:509134ms step_avg:357.54ms
step:1435/1750 train_loss:3.1757 train_time:509512ms step_avg:357.55ms
step:1436/1750 train_loss:3.2820 train_time:509886ms step_avg:357.56ms
step:1437/1750 train_loss:3.4697 train_time:510255ms step_avg:357.57ms
step:1438/1750 train_loss:3.4390 train_time:510629ms step_avg:357.58ms
step:1439/1750 train_loss:3.3799 train_time:511005ms step_avg:357.60ms
step:1440/1750 train_loss:3.2451 train_time:511375ms step_avg:357.61ms
step:1441/1750 train_loss:3.4025 train_time:511751ms step_avg:357.62ms
step:1442/1750 train_loss:3.4469 train_time:512134ms step_avg:357.64ms
step:1443/1750 train_loss:3.5331 train_time:512523ms step_avg:357.66ms
step:1444/1750 train_loss:3.5050 train_time:512895ms step_avg:357.67ms
step:1445/1750 train_loss:3.3948 train_time:513272ms step_avg:357.68ms
step:1446/1750 train_loss:3.2623 train_time:513656ms step_avg:357.70ms
step:1447/1750 train_loss:3.3508 train_time:514038ms step_avg:357.72ms
step:1448/1750 train_loss:3.3566 train_time:514411ms step_avg:357.73ms
step:1449/1750 train_loss:3.4542 train_time:514784ms step_avg:357.74ms
step:1450/1750 train_loss:3.4513 train_time:515160ms step_avg:357.75ms
step:1451/1750 train_loss:3.2656 train_time:515534ms step_avg:357.76ms
step:1452/1750 train_loss:3.3860 train_time:515911ms step_avg:357.77ms
step:1453/1750 train_loss:3.3153 train_time:516278ms step_avg:357.78ms
step:1454/1750 train_loss:3.3407 train_time:516652ms step_avg:357.79ms
step:1455/1750 train_loss:3.3866 train_time:517032ms step_avg:357.81ms
step:1456/1750 train_loss:3.3370 train_time:517402ms step_avg:357.82ms
step:1457/1750 train_loss:3.2178 train_time:517775ms step_avg:357.83ms
step:1458/1750 train_loss:3.4785 train_time:518149ms step_avg:357.84ms
step:1459/1750 train_loss:3.3310 train_time:518529ms step_avg:357.85ms
step:1460/1750 train_loss:3.3799 train_time:518902ms step_avg:357.86ms
step:1461/1750 train_loss:3.4925 train_time:519277ms step_avg:357.88ms
step:1462/1750 train_loss:3.3205 train_time:519646ms step_avg:357.88ms
step:1463/1750 train_loss:3.5256 train_time:520027ms step_avg:357.90ms
step:1464/1750 train_loss:3.4186 train_time:520404ms step_avg:357.91ms
step:1465/1750 train_loss:3.4137 train_time:520779ms step_avg:357.92ms
step:1466/1750 train_loss:3.3401 train_time:521152ms step_avg:357.93ms
step:1467/1750 train_loss:3.4501 train_time:521531ms step_avg:357.95ms
step:1468/1750 train_loss:3.3414 train_time:521903ms step_avg:357.96ms
step:1469/1750 train_loss:3.3228 train_time:522282ms step_avg:357.97ms
step:1470/1750 train_loss:3.3880 train_time:522667ms step_avg:357.99ms
step:1471/1750 train_loss:3.3120 train_time:523056ms step_avg:358.01ms
step:1472/1750 train_loss:3.2990 train_time:523444ms step_avg:358.03ms
step:1473/1750 train_loss:3.4926 train_time:523818ms step_avg:358.04ms
step:1474/1750 train_loss:3.3672 train_time:524202ms step_avg:358.06ms
step:1475/1750 train_loss:3.2003 train_time:524587ms step_avg:358.08ms
step:1476/1750 train_loss:3.3181 train_time:524960ms step_avg:358.09ms
step:1477/1750 train_loss:3.2998 train_time:525343ms step_avg:358.11ms
step:1478/1750 train_loss:3.3666 train_time:525726ms step_avg:358.12ms
step:1479/1750 train_loss:3.4512 train_time:526103ms step_avg:358.14ms
step:1480/1750 train_loss:3.3316 train_time:526472ms step_avg:358.14ms
step:1481/1750 train_loss:3.5072 train_time:526849ms step_avg:358.16ms
step:1482/1750 train_loss:3.4223 train_time:527239ms step_avg:358.18ms
step:1483/1750 train_loss:3.3356 train_time:527633ms step_avg:358.20ms
step:1484/1750 train_loss:3.3109 train_time:528016ms step_avg:358.22ms
step:1485/1750 train_loss:3.3336 train_time:528390ms step_avg:358.23ms
step:1486/1750 train_loss:3.2752 train_time:528770ms step_avg:358.25ms
step:1487/1750 train_loss:3.3935 train_time:529149ms step_avg:358.26ms
step:1488/1750 train_loss:3.2837 train_time:529533ms step_avg:358.28ms
step:1489/1750 train_loss:3.3747 train_time:529911ms step_avg:358.29ms
step:1490/1750 train_loss:3.3009 train_time:530289ms step_avg:358.30ms
step:1491/1750 train_loss:3.2198 train_time:530665ms step_avg:358.32ms
step:1492/1750 train_loss:3.3146 train_time:531039ms step_avg:358.33ms
step:1493/1750 train_loss:3.4890 train_time:531409ms step_avg:358.33ms
step:1494/1750 train_loss:3.3513 train_time:531780ms step_avg:358.34ms
step:1495/1750 train_loss:3.0832 train_time:532160ms step_avg:358.36ms
step:1496/1750 train_loss:3.4081 train_time:532537ms step_avg:358.37ms
step:1497/1750 train_loss:3.3680 train_time:532916ms step_avg:358.38ms
step:1498/1750 train_loss:3.3954 train_time:533300ms step_avg:358.40ms
step:1499/1750 train_loss:3.3685 train_time:533688ms step_avg:358.42ms
step:1500/1750 train_loss:3.3456 train_time:534085ms step_avg:358.45ms
step:1500/1750 val_loss:3.3312 train_time:534185ms step_avg:358.51ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 295.07721 | frobenius_norm = 68119.66406 | spectral_norm = 11784.14551 | nuclear_norm = 1716859.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 190.13960 | spectral_norm = 37.57961 | nuclear_norm = 4350.04248
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 185.70573 | spectral_norm = 40.96657 | nuclear_norm = 4230.36621
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 365.08353 | spectral_norm = 23.94684 | nuclear_norm = 8910.48438
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 249.55078 | spectral_norm = 27.51078 | nuclear_norm = 5709.55127
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 417.95346 | spectral_norm = 35.68295 | nuclear_norm = 11112.66992
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 211.50194 | spectral_norm = 20.59109 | nuclear_norm = 5612.63770
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 200.41864 | spectral_norm = 18.03975 | nuclear_norm = 4642.54980
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 197.42686 | spectral_norm = 18.37620 | nuclear_norm = 4581.09082
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 362.28308 | spectral_norm = 33.25674 | nuclear_norm = 8332.26172
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 353.35614 | spectral_norm = 28.15000 | nuclear_norm = 8308.34668
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 414.20645 | spectral_norm = 32.49463 | nuclear_norm = 11044.62695
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 207.48773 | spectral_norm = 21.83908 | nuclear_norm = 5464.55371
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 193.12070 | spectral_norm = 21.21274 | nuclear_norm = 4424.78906
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 191.39284 | spectral_norm = 18.64216 | nuclear_norm = 4411.44629
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 373.12436 | spectral_norm = 32.89587 | nuclear_norm = 8560.42578
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 376.27615 | spectral_norm = 28.49443 | nuclear_norm = 8852.26465
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 417.85031 | spectral_norm = 37.89780 | nuclear_norm = 11102.57031
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 206.83765 | spectral_norm = 21.43081 | nuclear_norm = 5423.45166
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 183.65633 | spectral_norm = 18.46682 | nuclear_norm = 4030.72754
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 182.93539 | spectral_norm = 17.91325 | nuclear_norm = 4030.31226
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 371.00180 | spectral_norm = 34.71285 | nuclear_norm = 8376.71387
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 383.51501 | spectral_norm = 33.16388 | nuclear_norm = 8903.19043
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 424.61307 | spectral_norm = 37.50525 | nuclear_norm = 11276.87695
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 208.34990 | spectral_norm = 22.09134 | nuclear_norm = 5474.03027
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 187.93111 | spectral_norm = 18.98164 | nuclear_norm = 4242.30078
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 186.65993 | spectral_norm = 17.86115 | nuclear_norm = 4233.61230
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 404.10110 | spectral_norm = 38.69431 | nuclear_norm = 9154.06348
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 402.92990 | spectral_norm = 29.52292 | nuclear_norm = 9511.11035
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 425.57422 | spectral_norm = 38.18586 | nuclear_norm = 11305.34766
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 207.57211 | spectral_norm = 20.44689 | nuclear_norm = 5450.57031
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 184.68466 | spectral_norm = 20.39436 | nuclear_norm = 4129.78271
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 182.51219 | spectral_norm = 19.02310 | nuclear_norm = 4090.06934
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 398.22464 | spectral_norm = 33.36399 | nuclear_norm = 9229.78320
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 391.11398 | spectral_norm = 29.09874 | nuclear_norm = 9267.39453
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 432.88892 | spectral_norm = 33.90434 | nuclear_norm = 11524.02930
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 210.06329 | spectral_norm = 20.71516 | nuclear_norm = 5540.95508
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 186.53757 | spectral_norm = 19.04757 | nuclear_norm = 4174.85107
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 183.57832 | spectral_norm = 17.78363 | nuclear_norm = 4151.01318
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 410.15964 | spectral_norm = 37.05310 | nuclear_norm = 9302.61328
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 397.82513 | spectral_norm = 30.64690 | nuclear_norm = 9331.84570
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 422.85510 | spectral_norm = 34.28439 | nuclear_norm = 11274.84961
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 208.97997 | spectral_norm = 21.24028 | nuclear_norm = 5492.00684
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 184.93748 | spectral_norm = 19.42378 | nuclear_norm = 4143.82275
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 181.79504 | spectral_norm = 18.18841 | nuclear_norm = 4114.05566
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 397.17825 | spectral_norm = 33.57866 | nuclear_norm = 9068.64062
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 387.72769 | spectral_norm = 33.31369 | nuclear_norm = 8875.78906
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 430.93390 | spectral_norm = 35.53856 | nuclear_norm = 11431.91406
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 212.33206 | spectral_norm = 22.32394 | nuclear_norm = 5585.51855
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 191.25458 | spectral_norm = 21.42593 | nuclear_norm = 4200.43701
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 193.05444 | spectral_norm = 19.70343 | nuclear_norm = 4188.56201
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 385.17368 | spectral_norm = 35.98026 | nuclear_norm = 8792.99512
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 390.94568 | spectral_norm = 27.45198 | nuclear_norm = 9224.01465
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 437.84418 | spectral_norm = 37.98708 | nuclear_norm = 11608.30469
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 221.91280 | spectral_norm = 23.18113 | nuclear_norm = 5877.68408
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 194.66484 | spectral_norm = 20.74155 | nuclear_norm = 4360.48633
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 192.32143 | spectral_norm = 20.67335 | nuclear_norm = 4293.53857
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 422.09219 | spectral_norm = 40.03447 | nuclear_norm = 9589.87207
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 400.71896 | spectral_norm = 29.95049 | nuclear_norm = 9422.41797
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 427.15192 | spectral_norm = 37.81004 | nuclear_norm = 11344.08105
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 219.83835 | spectral_norm = 23.49365 | nuclear_norm = 5835.48975
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 197.05655 | spectral_norm = 22.74603 | nuclear_norm = 4432.60059
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 191.75082 | spectral_norm = 21.46592 | nuclear_norm = 4307.16699
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 403.52216 | spectral_norm = 43.97861 | nuclear_norm = 9198.19434
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 405.21060 | spectral_norm = 30.71246 | nuclear_norm = 9526.93750
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 442.64841 | spectral_norm = 34.95846 | nuclear_norm = 11789.64062
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 211.49336 | spectral_norm = 25.55359 | nuclear_norm = 5594.37402
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 192.66960 | spectral_norm = 25.84207 | nuclear_norm = 4217.01172
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 187.94205 | spectral_norm = 23.03841 | nuclear_norm = 4085.07080
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 378.32639 | spectral_norm = 38.09658 | nuclear_norm = 8611.70898
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 416.28616 | spectral_norm = 30.32176 | nuclear_norm = 9728.24512
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 451.37405 | spectral_norm = 33.25087 | nuclear_norm = 12018.50684
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 211.87854 | spectral_norm = 29.78458 | nuclear_norm = 5549.42871
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1326.40479 | spectral_norm = 160.70918 | nuclear_norm = 35084.04688
===========================================
step:1501/1750 train_loss:3.1381 train_time:534456ms step_avg:358.45ms
step:1502/1750 train_loss:3.4137 train_time:534822ms step_avg:358.46ms
step:1503/1750 train_loss:3.2920 train_time:535190ms step_avg:358.47ms
step:1504/1750 train_loss:3.2968 train_time:535562ms step_avg:358.48ms
step:1505/1750 train_loss:3.2620 train_time:535932ms step_avg:358.48ms
step:1506/1750 train_loss:3.3293 train_time:536310ms step_avg:358.50ms
step:1507/1750 train_loss:3.2188 train_time:536703ms step_avg:358.52ms
step:1508/1750 train_loss:3.5338 train_time:537078ms step_avg:358.53ms
step:1509/1750 train_loss:3.3311 train_time:537448ms step_avg:358.54ms
step:1510/1750 train_loss:3.3246 train_time:537820ms step_avg:358.55ms
step:1511/1750 train_loss:3.4618 train_time:538216ms step_avg:358.57ms
step:1512/1750 train_loss:3.4716 train_time:538654ms step_avg:358.62ms
step:1513/1750 train_loss:3.3164 train_time:539031ms step_avg:358.64ms
step:1514/1750 train_loss:3.1437 train_time:539409ms step_avg:358.65ms
step:1515/1750 train_loss:3.2849 train_time:539786ms step_avg:358.66ms
step:1516/1750 train_loss:3.2992 train_time:540168ms step_avg:358.68ms
step:1517/1750 train_loss:3.3555 train_time:540544ms step_avg:358.69ms
step:1518/1750 train_loss:3.2587 train_time:540921ms step_avg:358.70ms
step:1519/1750 train_loss:3.5541 train_time:541412ms step_avg:358.79ms
step:1520/1750 train_loss:3.1761 train_time:541795ms step_avg:358.80ms
step:1521/1750 train_loss:3.2590 train_time:542168ms step_avg:358.81ms
step:1522/1750 train_loss:3.3976 train_time:542548ms step_avg:358.83ms
step:1523/1750 train_loss:3.2758 train_time:542921ms step_avg:358.84ms
step:1524/1750 train_loss:3.3950 train_time:543296ms step_avg:358.85ms
step:1525/1750 train_loss:3.3847 train_time:543684ms step_avg:358.87ms
step:1526/1750 train_loss:3.3220 train_time:544077ms step_avg:358.89ms
step:1527/1750 train_loss:3.3309 train_time:544454ms step_avg:358.90ms
step:1528/1750 train_loss:3.4551 train_time:544828ms step_avg:358.91ms
step:1529/1750 train_loss:3.4524 train_time:545197ms step_avg:358.92ms
step:1530/1750 train_loss:3.2813 train_time:545569ms step_avg:358.93ms
step:1531/1750 train_loss:3.2383 train_time:545946ms step_avg:358.94ms
step:1532/1750 train_loss:3.3923 train_time:546320ms step_avg:358.95ms
step:1533/1750 train_loss:3.3203 train_time:546706ms step_avg:358.97ms
step:1534/1750 train_loss:3.3229 train_time:547091ms step_avg:358.98ms
step:1535/1750 train_loss:3.3280 train_time:547467ms step_avg:359.00ms
step:1536/1750 train_loss:3.2712 train_time:547848ms step_avg:359.01ms
step:1537/1750 train_loss:3.3167 train_time:548225ms step_avg:359.02ms
step:1538/1750 train_loss:3.4765 train_time:548613ms step_avg:359.04ms
step:1539/1750 train_loss:3.4393 train_time:548997ms step_avg:359.06ms
step:1540/1750 train_loss:3.3214 train_time:549373ms step_avg:359.07ms
step:1541/1750 train_loss:3.2714 train_time:549752ms step_avg:359.08ms
step:1542/1750 train_loss:3.2927 train_time:550132ms step_avg:359.09ms
step:1543/1750 train_loss:3.1967 train_time:550508ms step_avg:359.11ms
step:1544/1750 train_loss:3.3363 train_time:550878ms step_avg:359.11ms
step:1545/1750 train_loss:3.3129 train_time:551259ms step_avg:359.13ms
step:1546/1750 train_loss:3.3019 train_time:551648ms step_avg:359.15ms
step:1547/1750 train_loss:3.2601 train_time:552031ms step_avg:359.16ms
step:1548/1750 train_loss:3.3079 train_time:552417ms step_avg:359.18ms
step:1549/1750 train_loss:3.3756 train_time:552789ms step_avg:359.19ms
step:1550/1750 train_loss:3.3345 train_time:553160ms step_avg:359.19ms
step:1551/1750 train_loss:3.2471 train_time:553539ms step_avg:359.21ms
step:1552/1750 train_loss:3.2643 train_time:553917ms step_avg:359.22ms
step:1553/1750 train_loss:3.2701 train_time:554288ms step_avg:359.23ms
step:1554/1750 train_loss:3.4014 train_time:554667ms step_avg:359.24ms
step:1555/1750 train_loss:3.3763 train_time:555045ms step_avg:359.25ms
step:1556/1750 train_loss:3.3197 train_time:555416ms step_avg:359.26ms
step:1557/1750 train_loss:3.3654 train_time:555787ms step_avg:359.27ms
step:1558/1750 train_loss:3.3020 train_time:556164ms step_avg:359.28ms
step:1559/1750 train_loss:3.1756 train_time:556555ms step_avg:359.30ms
step:1560/1750 train_loss:3.4762 train_time:556928ms step_avg:359.31ms
step:1561/1750 train_loss:3.2663 train_time:557304ms step_avg:359.32ms
step:1562/1750 train_loss:3.2573 train_time:557676ms step_avg:359.33ms
step:1563/1750 train_loss:3.3671 train_time:558052ms step_avg:359.34ms
step:1564/1750 train_loss:3.1985 train_time:558441ms step_avg:359.36ms
step:1565/1750 train_loss:3.2043 train_time:558825ms step_avg:359.37ms
step:1566/1750 train_loss:3.4085 train_time:559204ms step_avg:359.39ms
step:1567/1750 train_loss:3.2771 train_time:559578ms step_avg:359.40ms
step:1568/1750 train_loss:3.2860 train_time:559967ms step_avg:359.41ms
step:1569/1750 train_loss:3.3734 train_time:560370ms step_avg:359.44ms
step:1570/1750 train_loss:3.3248 train_time:560763ms step_avg:359.46ms
step:1571/1750 train_loss:3.2043 train_time:561147ms step_avg:359.48ms
step:1572/1750 train_loss:3.2439 train_time:561525ms step_avg:359.49ms
step:1573/1750 train_loss:3.3549 train_time:561904ms step_avg:359.50ms
step:1574/1750 train_loss:3.2123 train_time:562276ms step_avg:359.51ms
step:1575/1750 train_loss:3.3696 train_time:562652ms step_avg:359.52ms
step:1576/1750 train_loss:3.2756 train_time:563029ms step_avg:359.53ms
step:1577/1750 train_loss:3.3286 train_time:563415ms step_avg:359.55ms
step:1578/1750 train_loss:3.3161 train_time:563796ms step_avg:359.56ms
step:1579/1750 train_loss:3.2897 train_time:564180ms step_avg:359.58ms
step:1580/1750 train_loss:3.2486 train_time:564556ms step_avg:359.59ms
step:1581/1750 train_loss:3.4461 train_time:564940ms step_avg:359.61ms
step:1582/1750 train_loss:3.2666 train_time:565335ms step_avg:359.63ms
step:1583/1750 train_loss:3.4218 train_time:565727ms step_avg:359.65ms
step:1584/1750 train_loss:3.2400 train_time:566104ms step_avg:359.66ms
step:1585/1750 train_loss:3.4067 train_time:566489ms step_avg:359.68ms
step:1586/1750 train_loss:3.1940 train_time:566865ms step_avg:359.69ms
step:1587/1750 train_loss:3.3956 train_time:567241ms step_avg:359.70ms
step:1588/1750 train_loss:3.2695 train_time:567625ms step_avg:359.71ms
step:1589/1750 train_loss:3.4361 train_time:568003ms step_avg:359.72ms
step:1590/1750 train_loss:3.2789 train_time:568380ms step_avg:359.73ms
step:1591/1750 train_loss:3.2910 train_time:568763ms step_avg:359.75ms
step:1592/1750 train_loss:3.3644 train_time:569141ms step_avg:359.76ms
step:1593/1750 train_loss:3.3315 train_time:569531ms step_avg:359.78ms
step:1594/1750 train_loss:3.3064 train_time:569908ms step_avg:359.79ms
step:1595/1750 train_loss:3.4528 train_time:570287ms step_avg:359.80ms
step:1596/1750 train_loss:3.1529 train_time:570676ms step_avg:359.82ms
step:1597/1750 train_loss:3.3319 train_time:571066ms step_avg:359.84ms
step:1598/1750 train_loss:3.3795 train_time:571456ms step_avg:359.86ms
step:1599/1750 train_loss:3.4425 train_time:571848ms step_avg:359.88ms
step:1600/1750 train_loss:3.2696 train_time:572235ms step_avg:359.90ms
step:1601/1750 train_loss:3.5750 train_time:572609ms step_avg:359.91ms
step:1602/1750 train_loss:3.4540 train_time:572997ms step_avg:359.92ms
step:1603/1750 train_loss:3.2204 train_time:573388ms step_avg:359.94ms
step:1604/1750 train_loss:3.2631 train_time:573770ms step_avg:359.96ms
step:1605/1750 train_loss:3.1576 train_time:574164ms step_avg:359.98ms
step:1606/1750 train_loss:3.4654 train_time:574558ms step_avg:360.00ms
step:1607/1750 train_loss:3.3007 train_time:574938ms step_avg:360.01ms
step:1608/1750 train_loss:3.3076 train_time:575322ms step_avg:360.03ms
step:1609/1750 train_loss:3.2415 train_time:575706ms step_avg:360.04ms
step:1610/1750 train_loss:3.7402 train_time:576105ms step_avg:360.07ms
step:1611/1750 train_loss:3.5009 train_time:576495ms step_avg:360.08ms
step:1612/1750 train_loss:3.3904 train_time:576889ms step_avg:360.11ms
step:1613/1750 train_loss:3.2624 train_time:577289ms step_avg:360.13ms
step:1614/1750 train_loss:3.2923 train_time:577670ms step_avg:360.14ms
step:1615/1750 train_loss:3.3163 train_time:578061ms step_avg:360.16ms
step:1616/1750 train_loss:3.2813 train_time:578472ms step_avg:360.19ms
step:1617/1750 train_loss:3.3502 train_time:578872ms step_avg:360.22ms
step:1618/1750 train_loss:3.2797 train_time:579243ms step_avg:360.23ms
step:1619/1750 train_loss:3.1838 train_time:579626ms step_avg:360.24ms
step:1620/1750 train_loss:3.4570 train_time:580005ms step_avg:360.25ms
step:1621/1750 train_loss:3.3822 train_time:580395ms step_avg:360.27ms
step:1622/1750 train_loss:3.1617 train_time:580776ms step_avg:360.28ms
step:1623/1750 train_loss:3.2496 train_time:581156ms step_avg:360.30ms
step:1624/1750 train_loss:3.2125 train_time:581527ms step_avg:360.30ms
step:1625/1750 train_loss:3.3179 train_time:581899ms step_avg:360.31ms
step:1625/1750 val_loss:3.2957 train_time:581999ms step_avg:360.37ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 295.57370 | frobenius_norm = 68237.60938 | spectral_norm = 11819.69531 | nuclear_norm = 1720471.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 190.66911 | spectral_norm = 38.28187 | nuclear_norm = 4356.62305
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 186.39331 | spectral_norm = 41.51524 | nuclear_norm = 4242.04785
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 367.52072 | spectral_norm = 24.07756 | nuclear_norm = 8975.88184
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 249.51031 | spectral_norm = 27.62628 | nuclear_norm = 5702.79199
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 420.86099 | spectral_norm = 36.08894 | nuclear_norm = 11190.42090
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 212.90234 | spectral_norm = 20.76856 | nuclear_norm = 5651.01367
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 201.67377 | spectral_norm = 18.21522 | nuclear_norm = 4670.47559
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 198.70578 | spectral_norm = 18.46745 | nuclear_norm = 4610.45996
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 364.65164 | spectral_norm = 33.47849 | nuclear_norm = 8387.86719
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 355.52863 | spectral_norm = 28.28271 | nuclear_norm = 8361.41602
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 416.80185 | spectral_norm = 32.72258 | nuclear_norm = 11115.76660
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 208.82228 | spectral_norm = 21.99340 | nuclear_norm = 5500.20020
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 194.33855 | spectral_norm = 21.38415 | nuclear_norm = 4451.12598
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 192.63188 | spectral_norm = 18.82634 | nuclear_norm = 4438.74805
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 375.88983 | spectral_norm = 33.20857 | nuclear_norm = 8626.51367
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 378.97968 | spectral_norm = 28.72389 | nuclear_norm = 8919.71387
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 420.48669 | spectral_norm = 38.17520 | nuclear_norm = 11172.23633
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 208.08034 | spectral_norm = 21.61539 | nuclear_norm = 5455.37988
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 184.55069 | spectral_norm = 18.61308 | nuclear_norm = 4043.90088
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 183.81473 | spectral_norm = 18.10515 | nuclear_norm = 4042.07983
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 374.10751 | spectral_norm = 34.86630 | nuclear_norm = 8451.08789
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 386.60477 | spectral_norm = 33.46438 | nuclear_norm = 8977.60742
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 427.13882 | spectral_norm = 37.83317 | nuclear_norm = 11342.78711
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 209.61488 | spectral_norm = 22.30180 | nuclear_norm = 5507.15625
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 188.96703 | spectral_norm = 19.15289 | nuclear_norm = 4261.10742
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 187.67392 | spectral_norm = 18.02875 | nuclear_norm = 4253.05176
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 407.51321 | spectral_norm = 38.97917 | nuclear_norm = 9235.90625
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 406.12103 | spectral_norm = 29.58309 | nuclear_norm = 9590.87793
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 428.02036 | spectral_norm = 38.49792 | nuclear_norm = 11369.28027
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 208.79646 | spectral_norm = 20.66574 | nuclear_norm = 5482.99121
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 185.66533 | spectral_norm = 20.57029 | nuclear_norm = 4145.60938
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 183.48158 | spectral_norm = 19.19646 | nuclear_norm = 4106.71680
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 401.65070 | spectral_norm = 33.69786 | nuclear_norm = 9314.59570
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 394.27377 | spectral_norm = 29.28390 | nuclear_norm = 9347.79785
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 435.37814 | spectral_norm = 34.23231 | nuclear_norm = 11589.02734
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 211.32730 | spectral_norm = 20.91453 | nuclear_norm = 5575.48535
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 187.46857 | spectral_norm = 19.26364 | nuclear_norm = 4189.55273
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 184.58430 | spectral_norm = 17.93640 | nuclear_norm = 4169.83594
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 413.43985 | spectral_norm = 37.33883 | nuclear_norm = 9383.32129
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 400.95273 | spectral_norm = 30.90342 | nuclear_norm = 9407.03320
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 425.40292 | spectral_norm = 34.55653 | nuclear_norm = 11342.64551
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 210.21689 | spectral_norm = 21.44510 | nuclear_norm = 5524.54004
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 185.93570 | spectral_norm = 19.65455 | nuclear_norm = 4159.11719
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 182.79784 | spectral_norm = 18.32923 | nuclear_norm = 4132.57080
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 400.57144 | spectral_norm = 33.83073 | nuclear_norm = 9152.41406
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 390.76450 | spectral_norm = 33.71921 | nuclear_norm = 8942.31152
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 433.64310 | spectral_norm = 35.89834 | nuclear_norm = 11501.24902
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 213.52605 | spectral_norm = 22.50242 | nuclear_norm = 5615.67285
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 192.28270 | spectral_norm = 21.56923 | nuclear_norm = 4213.59619
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 194.13661 | spectral_norm = 19.90191 | nuclear_norm = 4201.11328
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 388.51590 | spectral_norm = 36.42796 | nuclear_norm = 8865.29492
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 393.32019 | spectral_norm = 27.71800 | nuclear_norm = 9277.19434
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 440.67480 | spectral_norm = 38.38383 | nuclear_norm = 11680.17969
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 223.32603 | spectral_norm = 23.38321 | nuclear_norm = 5914.96094
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 195.71709 | spectral_norm = 20.95707 | nuclear_norm = 4377.17285
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 193.36650 | spectral_norm = 20.81080 | nuclear_norm = 4310.56006
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 425.61084 | spectral_norm = 40.44264 | nuclear_norm = 9670.05859
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 403.20111 | spectral_norm = 30.19969 | nuclear_norm = 9478.53418
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 429.35190 | spectral_norm = 38.14542 | nuclear_norm = 11400.36133
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 221.12399 | spectral_norm = 23.64053 | nuclear_norm = 5869.77441
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 198.09352 | spectral_norm = 23.07665 | nuclear_norm = 4448.70508
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 192.72092 | spectral_norm = 21.68491 | nuclear_norm = 4322.30469
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 407.34015 | spectral_norm = 44.58891 | nuclear_norm = 9282.25391
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 408.16672 | spectral_norm = 31.04004 | nuclear_norm = 9592.98438
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 444.76147 | spectral_norm = 35.17022 | nuclear_norm = 11844.64258
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 212.87782 | spectral_norm = 25.71612 | nuclear_norm = 5631.28760
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 193.58893 | spectral_norm = 26.25085 | nuclear_norm = 4226.55371
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 188.78740 | spectral_norm = 23.35371 | nuclear_norm = 4092.75439
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 383.15067 | spectral_norm = 38.61580 | nuclear_norm = 8721.29688
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 419.82852 | spectral_norm = 30.49136 | nuclear_norm = 9809.51172
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 452.81207 | spectral_norm = 33.28735 | nuclear_norm = 12055.80469
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 213.06151 | spectral_norm = 30.04001 | nuclear_norm = 5579.03809
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1325.15027 | spectral_norm = 158.26471 | nuclear_norm = 35093.94531
===========================================
step:1626/1750 train_loss:3.2360 train_time:582275ms step_avg:360.32ms
step:1627/1750 train_loss:3.2345 train_time:582644ms step_avg:360.32ms
step:1628/1750 train_loss:3.3591 train_time:583021ms step_avg:360.33ms
step:1629/1750 train_loss:3.2443 train_time:583400ms step_avg:360.35ms
step:1630/1750 train_loss:3.3220 train_time:583785ms step_avg:360.36ms
step:1631/1750 train_loss:3.1773 train_time:584189ms step_avg:360.39ms
step:1632/1750 train_loss:3.1468 train_time:584564ms step_avg:360.40ms
step:1633/1750 train_loss:3.2961 train_time:584939ms step_avg:360.41ms
step:1634/1750 train_loss:3.3108 train_time:585311ms step_avg:360.41ms
step:1635/1750 train_loss:3.2435 train_time:585699ms step_avg:360.43ms
step:1636/1750 train_loss:3.3321 train_time:586079ms step_avg:360.44ms
step:1637/1750 train_loss:3.3723 train_time:586453ms step_avg:360.45ms
step:1638/1750 train_loss:3.4001 train_time:586835ms step_avg:360.46ms
step:1639/1750 train_loss:3.5706 train_time:587223ms step_avg:360.48ms
step:1640/1750 train_loss:3.3491 train_time:587606ms step_avg:360.49ms
step:1641/1750 train_loss:3.2999 train_time:587988ms step_avg:360.51ms
step:1642/1750 train_loss:3.4062 train_time:588366ms step_avg:360.52ms
step:1643/1750 train_loss:3.2743 train_time:588756ms step_avg:360.54ms
step:1644/1750 train_loss:3.3110 train_time:589134ms step_avg:360.55ms
step:1645/1750 train_loss:3.3120 train_time:589508ms step_avg:360.56ms
step:1646/1750 train_loss:3.0694 train_time:589887ms step_avg:360.57ms
step:1647/1750 train_loss:3.3195 train_time:590261ms step_avg:360.57ms
step:1648/1750 train_loss:3.2116 train_time:590640ms step_avg:360.59ms
step:1649/1750 train_loss:3.2822 train_time:591014ms step_avg:360.59ms
step:1650/1750 train_loss:3.2666 train_time:591389ms step_avg:360.60ms
step:1651/1750 train_loss:3.3452 train_time:591762ms step_avg:360.61ms
step:1652/1750 train_loss:3.2604 train_time:592141ms step_avg:360.62ms
step:1653/1750 train_loss:3.3934 train_time:592529ms step_avg:360.64ms
step:1654/1750 train_loss:3.3873 train_time:592906ms step_avg:360.65ms
step:1655/1750 train_loss:3.1770 train_time:593293ms step_avg:360.66ms
step:1656/1750 train_loss:3.3278 train_time:593690ms step_avg:360.69ms
step:1657/1750 train_loss:3.2496 train_time:594076ms step_avg:360.70ms
step:1658/1750 train_loss:3.2211 train_time:594453ms step_avg:360.71ms
step:1659/1750 train_loss:3.2992 train_time:594831ms step_avg:360.72ms
step:1660/1750 train_loss:3.3455 train_time:595208ms step_avg:360.73ms
step:1661/1750 train_loss:3.2481 train_time:595587ms step_avg:360.74ms
step:1662/1750 train_loss:3.3565 train_time:595961ms step_avg:360.75ms
step:1663/1750 train_loss:3.3473 train_time:596352ms step_avg:360.77ms
step:1664/1750 train_loss:3.4050 train_time:596760ms step_avg:360.80ms
step:1665/1750 train_loss:3.3317 train_time:597144ms step_avg:360.81ms
step:1666/1750 train_loss:3.4975 train_time:597526ms step_avg:360.82ms
step:1667/1750 train_loss:3.2040 train_time:597909ms step_avg:360.84ms
step:1668/1750 train_loss:3.2864 train_time:598292ms step_avg:360.85ms
step:1669/1750 train_loss:3.2092 train_time:598668ms step_avg:360.86ms
step:1670/1750 train_loss:3.2181 train_time:599047ms step_avg:360.87ms
step:1671/1750 train_loss:3.3737 train_time:599429ms step_avg:360.88ms
step:1672/1750 train_loss:3.5701 train_time:599810ms step_avg:360.90ms
step:1673/1750 train_loss:3.2717 train_time:600189ms step_avg:360.91ms
step:1674/1750 train_loss:3.2570 train_time:600570ms step_avg:360.92ms
step:1675/1750 train_loss:3.1192 train_time:600960ms step_avg:360.94ms
step:1676/1750 train_loss:3.3458 train_time:601346ms step_avg:360.95ms
step:1677/1750 train_loss:3.2764 train_time:601727ms step_avg:360.96ms
step:1678/1750 train_loss:3.2981 train_time:602108ms step_avg:360.98ms
step:1679/1750 train_loss:3.2982 train_time:602487ms step_avg:360.99ms
step:1680/1750 train_loss:3.0844 train_time:602886ms step_avg:361.01ms
step:1681/1750 train_loss:3.2981 train_time:603271ms step_avg:361.02ms
step:1682/1750 train_loss:3.2852 train_time:603658ms step_avg:361.04ms
step:1683/1750 train_loss:3.3012 train_time:604038ms step_avg:361.05ms
step:1684/1750 train_loss:3.3411 train_time:604413ms step_avg:361.06ms
step:1685/1750 train_loss:3.2393 train_time:604789ms step_avg:361.07ms
step:1686/1750 train_loss:3.3661 train_time:605173ms step_avg:361.08ms
step:1687/1750 train_loss:3.2407 train_time:605555ms step_avg:361.09ms
step:1688/1750 train_loss:3.3102 train_time:605950ms step_avg:361.11ms
step:1689/1750 train_loss:3.2229 train_time:606337ms step_avg:361.13ms
step:1690/1750 train_loss:3.0706 train_time:606726ms step_avg:361.15ms
step:1691/1750 train_loss:3.3062 train_time:607105ms step_avg:361.16ms
step:1692/1750 train_loss:3.2982 train_time:607483ms step_avg:361.17ms
step:1693/1750 train_loss:3.2091 train_time:607860ms step_avg:361.18ms
step:1694/1750 train_loss:3.6108 train_time:608249ms step_avg:361.19ms
step:1695/1750 train_loss:3.3307 train_time:608637ms step_avg:361.21ms
step:1696/1750 train_loss:3.3355 train_time:609020ms step_avg:361.22ms
step:1697/1750 train_loss:3.2529 train_time:609391ms step_avg:361.23ms
step:1698/1750 train_loss:3.1234 train_time:609769ms step_avg:361.24ms
step:1699/1750 train_loss:3.2309 train_time:610150ms step_avg:361.25ms
step:1700/1750 train_loss:3.2459 train_time:610568ms step_avg:361.28ms
step:1701/1750 train_loss:3.3198 train_time:611004ms step_avg:361.33ms
step:1702/1750 train_loss:3.2392 train_time:611379ms step_avg:361.34ms
step:1703/1750 train_loss:3.4107 train_time:611751ms step_avg:361.34ms
step:1704/1750 train_loss:3.2136 train_time:612127ms step_avg:361.35ms
step:1705/1750 train_loss:3.4380 train_time:612499ms step_avg:361.36ms
step:1706/1750 train_loss:3.2525 train_time:612872ms step_avg:361.36ms
step:1707/1750 train_loss:3.0509 train_time:613254ms step_avg:361.38ms
step:1708/1750 train_loss:3.3911 train_time:613631ms step_avg:361.38ms
step:1709/1750 train_loss:3.2957 train_time:614159ms step_avg:361.48ms
step:1710/1750 train_loss:3.2823 train_time:614573ms step_avg:361.51ms
step:1711/1750 train_loss:3.2874 train_time:614959ms step_avg:361.53ms
step:1712/1750 train_loss:3.3171 train_time:615342ms step_avg:361.54ms
step:1713/1750 train_loss:3.3354 train_time:615723ms step_avg:361.55ms
step:1714/1750 train_loss:3.2221 train_time:616114ms step_avg:361.57ms
step:1715/1750 train_loss:3.2848 train_time:616517ms step_avg:361.59ms
step:1716/1750 train_loss:3.0974 train_time:616892ms step_avg:361.60ms
step:1717/1750 train_loss:3.2471 train_time:617261ms step_avg:361.61ms
step:1718/1750 train_loss:3.2583 train_time:617638ms step_avg:361.61ms
step:1719/1750 train_loss:3.2191 train_time:618022ms step_avg:361.63ms
step:1720/1750 train_loss:3.3740 train_time:618420ms step_avg:361.65ms
step:1721/1750 train_loss:3.1631 train_time:618832ms step_avg:361.68ms
step:1722/1750 train_loss:3.3148 train_time:619215ms step_avg:361.69ms
step:1723/1750 train_loss:3.4032 train_time:619610ms step_avg:361.71ms
step:1724/1750 train_loss:3.2596 train_time:619992ms step_avg:361.72ms
step:1725/1750 train_loss:3.4858 train_time:620384ms step_avg:361.74ms
step:1726/1750 train_loss:3.2548 train_time:620778ms step_avg:361.76ms
step:1727/1750 train_loss:3.3293 train_time:621151ms step_avg:361.77ms
step:1728/1750 train_loss:3.2962 train_time:621529ms step_avg:361.78ms
step:1729/1750 train_loss:3.2765 train_time:621918ms step_avg:361.79ms
step:1730/1750 train_loss:3.6517 train_time:622305ms step_avg:361.81ms
step:1731/1750 train_loss:3.2949 train_time:622685ms step_avg:361.82ms
step:1732/1750 train_loss:3.4311 train_time:623068ms step_avg:361.83ms
step:1733/1750 train_loss:3.2043 train_time:623438ms step_avg:361.83ms
step:1734/1750 train_loss:3.2440 train_time:623816ms step_avg:361.84ms
step:1735/1750 train_loss:3.2746 train_time:624201ms step_avg:361.86ms
step:1736/1750 train_loss:3.2537 train_time:624588ms step_avg:361.87ms
step:1737/1750 train_loss:3.3842 train_time:624977ms step_avg:361.89ms
step:1738/1750 train_loss:3.2198 train_time:625379ms step_avg:361.91ms
step:1739/1750 train_loss:3.2848 train_time:625770ms step_avg:361.93ms
step:1740/1750 train_loss:3.3674 train_time:626155ms step_avg:361.94ms
step:1741/1750 train_loss:3.1625 train_time:626536ms step_avg:361.95ms
step:1742/1750 train_loss:3.0565 train_time:626920ms step_avg:361.96ms
step:1743/1750 train_loss:2.9476 train_time:627317ms step_avg:361.98ms
step:1744/1750 train_loss:3.2913 train_time:627696ms step_avg:361.99ms
step:1745/1750 train_loss:3.3095 train_time:628071ms step_avg:362.00ms
step:1746/1750 train_loss:3.2725 train_time:628447ms step_avg:362.01ms
step:1747/1750 train_loss:3.2922 train_time:628839ms step_avg:362.03ms
step:1748/1750 train_loss:3.4945 train_time:629245ms step_avg:362.05ms
step:1749/1750 train_loss:3.2214 train_time:629630ms step_avg:362.06ms
step:1750/1750 train_loss:3.2758 train_time:630022ms step_avg:362.08ms
step:1750/1750 val_loss:3.2743 train_time:630132ms step_avg:362.14ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 295.59830 | frobenius_norm = 68243.46094 | spectral_norm = 11825.87793 | nuclear_norm = 1720741.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 190.60855 | spectral_norm = 38.52874 | nuclear_norm = 4352.91895
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 186.41071 | spectral_norm = 41.65795 | nuclear_norm = 4240.68750
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 368.10928 | spectral_norm = 24.06237 | nuclear_norm = 8992.42773
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 249.30504 | spectral_norm = 27.63953 | nuclear_norm = 5695.48438
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 421.48553 | spectral_norm = 36.18977 | nuclear_norm = 11207.23242
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 213.19090 | spectral_norm = 20.81870 | nuclear_norm = 5659.15381
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 201.93629 | spectral_norm = 18.26938 | nuclear_norm = 4676.19043
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 198.97665 | spectral_norm = 18.52171 | nuclear_norm = 4616.86035
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 365.18536 | spectral_norm = 33.51279 | nuclear_norm = 8400.37305
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 356.00775 | spectral_norm = 28.30791 | nuclear_norm = 8374.23730
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 417.32599 | spectral_norm = 32.76249 | nuclear_norm = 11130.62305
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 209.08374 | spectral_norm = 22.03421 | nuclear_norm = 5507.41406
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 194.56615 | spectral_norm = 21.43049 | nuclear_norm = 4455.37061
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 192.88094 | spectral_norm = 18.88229 | nuclear_norm = 4443.87109
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 376.50464 | spectral_norm = 33.25682 | nuclear_norm = 8641.74707
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 379.60141 | spectral_norm = 28.78247 | nuclear_norm = 8935.67578
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 421.04651 | spectral_norm = 38.25851 | nuclear_norm = 11187.02246
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 208.30794 | spectral_norm = 21.65643 | nuclear_norm = 5461.09473
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 184.65282 | spectral_norm = 18.64829 | nuclear_norm = 4043.48975
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 183.91731 | spectral_norm = 18.14012 | nuclear_norm = 4041.41650
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 374.86633 | spectral_norm = 34.89734 | nuclear_norm = 8470.29102
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 387.35535 | spectral_norm = 33.55864 | nuclear_norm = 8996.59570
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 427.65677 | spectral_norm = 37.90696 | nuclear_norm = 11356.08691
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 209.84361 | spectral_norm = 22.33829 | nuclear_norm = 5513.13184
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 189.11520 | spectral_norm = 19.19740 | nuclear_norm = 4262.33154
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 187.85156 | spectral_norm = 18.06682 | nuclear_norm = 4255.46484
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 408.33514 | spectral_norm = 39.05275 | nuclear_norm = 9256.58398
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 406.90082 | spectral_norm = 29.60444 | nuclear_norm = 9610.60352
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 428.50034 | spectral_norm = 38.56121 | nuclear_norm = 11381.61914
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 209.01625 | spectral_norm = 20.71149 | nuclear_norm = 5488.94141
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 185.82208 | spectral_norm = 20.62114 | nuclear_norm = 4146.77832
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 183.64325 | spectral_norm = 19.21691 | nuclear_norm = 4108.39746
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 402.53510 | spectral_norm = 33.77006 | nuclear_norm = 9336.81152
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 395.06638 | spectral_norm = 29.32297 | nuclear_norm = 9368.84668
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 435.90063 | spectral_norm = 34.29469 | nuclear_norm = 11602.51172
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 211.56168 | spectral_norm = 20.95527 | nuclear_norm = 5582.00879
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 187.61885 | spectral_norm = 19.32869 | nuclear_norm = 4190.22363
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 184.76627 | spectral_norm = 17.94432 | nuclear_norm = 4172.43408
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 414.26743 | spectral_norm = 37.39790 | nuclear_norm = 9404.25000
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 401.75137 | spectral_norm = 30.95166 | nuclear_norm = 9426.42188
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 425.91647 | spectral_norm = 34.59675 | nuclear_norm = 11356.35156
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 210.42732 | spectral_norm = 21.49748 | nuclear_norm = 5529.92676
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 186.07420 | spectral_norm = 19.72343 | nuclear_norm = 4159.76367
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 182.94875 | spectral_norm = 18.35722 | nuclear_norm = 4134.20020
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 401.45035 | spectral_norm = 33.86498 | nuclear_norm = 9174.89453
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 391.55756 | spectral_norm = 33.85941 | nuclear_norm = 8959.41016
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 434.22455 | spectral_norm = 35.97222 | nuclear_norm = 11515.53809
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 213.72295 | spectral_norm = 22.54571 | nuclear_norm = 5620.29883
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 192.40833 | spectral_norm = 21.59774 | nuclear_norm = 4212.57324
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 194.31473 | spectral_norm = 19.94040 | nuclear_norm = 4200.35498
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 389.32446 | spectral_norm = 36.54405 | nuclear_norm = 8882.15137
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 393.83112 | spectral_norm = 27.76031 | nuclear_norm = 9288.14844
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 441.25626 | spectral_norm = 38.47700 | nuclear_norm = 11694.53711
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 223.58736 | spectral_norm = 23.41737 | nuclear_norm = 5921.87402
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 195.87387 | spectral_norm = 21.03273 | nuclear_norm = 4377.60254
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 193.53471 | spectral_norm = 20.87093 | nuclear_norm = 4311.76270
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 426.50165 | spectral_norm = 40.56088 | nuclear_norm = 9689.91211
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 403.78339 | spectral_norm = 30.30227 | nuclear_norm = 9491.13184
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 429.72638 | spectral_norm = 38.22236 | nuclear_norm = 11409.36914
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 221.34366 | spectral_norm = 23.66665 | nuclear_norm = 5875.61035
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 198.26053 | spectral_norm = 23.18422 | nuclear_norm = 4449.80615
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 192.88838 | spectral_norm = 21.74802 | nuclear_norm = 4323.30176
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 408.28717 | spectral_norm = 44.74791 | nuclear_norm = 9302.85938
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 408.91827 | spectral_norm = 31.12007 | nuclear_norm = 9609.42969
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 445.08456 | spectral_norm = 35.21756 | nuclear_norm = 11852.87500
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 213.12289 | spectral_norm = 25.73295 | nuclear_norm = 5637.79102
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 193.69214 | spectral_norm = 26.36493 | nuclear_norm = 4224.49219
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 188.85991 | spectral_norm = 23.45355 | nuclear_norm = 4089.70752
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 384.44742 | spectral_norm = 38.77171 | nuclear_norm = 8750.46094
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 420.78738 | spectral_norm = 30.55964 | nuclear_norm = 9831.14355
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 452.88910 | spectral_norm = 33.28859 | nuclear_norm = 12057.37402
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 213.26468 | spectral_norm = 30.08586 | nuclear_norm = 5583.92432
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1322.79919 | spectral_norm = 157.00710 | nuclear_norm = 35049.09375
===========================================

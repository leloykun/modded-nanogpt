====================================================================================================
import os
import sys
with open(sys.argv[0]) as f:
    code = f.read() # read the code of this file ASAP, for logging
import uuid
import glob
import time
from dataclasses import dataclass

import numpy as np
import torch
from torch import nn
import torch.nn.functional as F
import torch.distributed as dist
import torch._inductor.config as config
from torch.nn.parallel import DistributedDataParallel as DDP
# Use of FlexAttention contributed by @KoszarskyB
from torch.nn.attention.flex_attention import flex_attention, create_block_mask, BlockMask, _score_mod_signature
from torch._inductor.lowering import make_pointwise, register_lowering
# Some internal torch.compile details
from torch._inductor.virtualized import ops
from functools import partial
flex_attention = torch.compile(flex_attention, dynamic=False)
create_block_mask = torch.compile(create_block_mask, dynamic=False)

# -----------------------------------------------------------------------------
# Muon optimizer

def zeropower_via_svd(G, steps=None):
    U, S, V = G.svd()
    return U @ V.T

@torch.compile
def zeropower_via_newtonschulz5(G, steps=10, eps=1e-7):
    """
    Newton-Schulz iteration to compute the zeroth power / orthogonalization of G. We opt to use a
    quintic iteration whose coefficients are selected to maximize the slope at zero. For the purpose
    of minimizing steps, it turns out to be empirically effective to keep increasing the slope at
    zero even beyond the point where the iteration no longer converges all the way to one everywhere
    on the interval. This iteration therefore does not produce UV^T but rather something like US'V^T
    where S' is diagonal with S_{ii}' ~ Uniform(0.5, 1.5), which turns out not to hurt model
    performance at all relative to UV^T, where USV^T = G is the SVD.
    """
    assert len(G.shape) == 2
    a, b, c = (3.4445, -4.7750,  2.0315)
    X = G.bfloat16()
    X /= (X.norm() + eps) # ensure top singular value <= 1
    if G.size(0) > G.size(1):
        X = X.T
    for _ in range(steps):
        A = X @ X.T
        B = b * A + c * A @ A # adapted from suggestion by @jxbz, @leloykun, and @YouJiacheng
        X = a * X + B @ X
    if G.size(0) > G.size(1):
        X = X.T
    return X

zeropower_backends = dict(svd=zeropower_via_svd, newtonschulz5=zeropower_via_newtonschulz5)

class Muon(torch.optim.Optimizer):
    """
    Muon - MomentUm Orthogonalized by Newton-schulz

    Muon internally runs standard SGD-momentum, and then performs an orthogonalization post-
    processing step, in which each 2D parameter's update is replaced with the nearest orthogonal
    matrix. To efficiently orthogonalize each update, we use a Newton-Schulz iteration, which has
    the advantage that it can be stably run in bfloat16 on the GPU.

    Some warnings:
    - This optimizer assumes that all parameters passed in are 2D.
    - It should not be used for the embedding layer, the final fully connected layer, or any {0,1}-D
    parameters; those should all be optimized by a standard method (e.g., AdamW).
    - To use it with 4D convolutional filters, it works well to just flatten their last 3 dimensions.
    - We believe it is unlikely to work well for training with small batch size.
    - We believe it may not work well for finetuning pretrained models, but we haven't tested this.
    - We have not yet tried this optimizer for training scenarios larger than NanoGPT (124M).

    Arguments:
        lr: The learning rate used by the internal SGD.
        momentum: The momentum used by the internal SGD.
        nesterov: Whether to use Nesterov-style momentum in the internal SGD. (recommended)
        backend: The chosen backend for the orthogonalization step. (recommended: 'newtonschulz5')
        backend_steps: The number of iteration steps to use in the backend, if it is iterative.
    """
    def __init__(self, params, lr=0.02, momentum=0.95, nesterov=True,
                 backend='newtonschulz5', backend_steps=5):
        defaults = dict(lr=lr, momentum=momentum, nesterov=nesterov, backend=backend, backend_steps=backend_steps)
        super().__init__(params, defaults)

    def step(self):

        for group in self.param_groups:

            lr = group['lr']
            momentum = group['momentum']
            zeropower_backend = zeropower_backends[group['backend']]

            # generate weight updates in distributed fashion
            total_params = sum(p.numel() for p in group['params'])
            updates_flat = torch.zeros(total_params, device='cuda', dtype=torch.bfloat16)
            curr_idx = 0
            for i, p in enumerate(group['params']):
                # luckily this will perfectly distribute a transformer with multiple of 4 layers to 8 GPUs
                if i % int(os.environ['WORLD_SIZE']) == int(os.environ['RANK']):
                    g = p.grad
                    assert g is not None
                    state = self.state[p]
                    if 'momentum_buffer' not in state:
                        state['momentum_buffer'] = torch.zeros_like(g)
                    buf = state['momentum_buffer']
                    buf.mul_(momentum).add_(g)
                    if group['nesterov']:
                        g = g.add(buf, alpha=momentum)
                    g = zeropower_backend(g, steps=group['backend_steps'])
                    g *= max(1, g.size(0)/g.size(1))**0.5
                    updates_flat[curr_idx:curr_idx+p.numel()] = g.flatten()
                curr_idx += p.numel()

            # sync updates across devices. we are not memory-constrained so can do this simple deserialization
            dist.all_reduce(updates_flat, op=dist.ReduceOp.SUM)

            # deserialize and apply updates
            curr_idx = 0
            for p in group['params']:
                g = updates_flat[curr_idx:curr_idx+p.numel()].view_as(p.data).type_as(p.data)
                p.data.add_(g, alpha=-lr)
                curr_idx += p.numel()

# -----------------------------------------------------------------------------
# Attention Tanh softcapping

@torch.library.custom_op("approx::tanh", mutates_args=())
def _tanh_approx(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

@_tanh_approx.register_fake
def _(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

def _tanh_approx_lowering(inp):
    fn = partial(ops.inline_asm_elementwise, asm="tanh.approx.f32 $0, $1;")
    return make_pointwise(fn)(inp)

register_lowering(torch.ops.approx.tanh)(_tanh_approx_lowering)

class _TanhApprox(torch.autograd.Function):
    @staticmethod
    def forward(x):
        return torch.ops.approx.tanh(x)

    @staticmethod
    def setup_context(ctx, inputs, output):
        (x,) = inputs
        result = output
        ctx.save_for_backward(result)

    @staticmethod
    def backward(ctx, grad_output):
        (result,) = ctx.saved_tensors
        return grad_output * (1 - result * result)

    @staticmethod
    def vmap(info, in_dims, x):
        return torch.tanh(x), 0

_tanh_approx = _TanhApprox.apply

def generate_tanh_softcap(soft_cap: int, approx: bool=True) -> _score_mod_signature:
    tanh = _tanh_approx if approx else torch.tanh

    def tanh_softcap(score, b, h, q_idx, kv_idx):
        return soft_cap * tanh(score / soft_cap)

    prefix = "tanh_softcap_approx" if approx else "tanh_softcap"
    tanh_softcap.__name__ = f"{prefix}_{soft_cap}"

    return tanh_softcap

# -----------------------------------------------------------------------------
# PyTorch nn.Module definitions for the GPT-2 model

class Rotary(torch.nn.Module):

    def __init__(self, dim, base=10000):
        super().__init__()
        self.dim = dim
        self.base = base
        self.inv_freq = None
        self.seq_len_cached = None
        self.cos_cached = None
        self.sin_cached = None

    def forward(self, x):
        seq_len = x.shape[1]
        if seq_len != self.seq_len_cached:
            self.inv_freq = 1.0 / (self.base ** (torch.arange(0, self.dim, 2, device=x.device).float() / self.dim))
            self.seq_len_cached = seq_len
            t = torch.arange(seq_len, device=x.device).type_as(self.inv_freq)
            freqs = torch.outer(t, self.inv_freq)
            self.cos_cached = freqs.cos().bfloat16()
            self.sin_cached = freqs.sin().bfloat16()
        return self.cos_cached[None, :, None, :], self.sin_cached[None, :, None, :]

def apply_rotary_emb(x, cos, sin):
    assert x.ndim == 4 # multihead attention
    d = x.shape[3]//2
    x1 = x[..., :d]
    x2 = x[..., d:]
    y1 = x1 * cos + x2 * sin
    y2 = x1 * (-sin) + x2 * cos
    return torch.cat([y1, y2], 3).type_as(x)

class CastedLinear(nn.Linear):
    def forward(self, x):
        return F.linear(x, self.weight.to(x.dtype))

class CausalSelfAttention(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.n_head = config.n_head
        self.n_embd = config.n_embd
        self.head_dim = self.n_embd // self.n_head
        assert self.n_embd % self.n_head == 0
        self.c_q = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_k = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_v = CastedLinear(self.n_embd, self.n_embd, bias=False)
        # output projection
        self.c_proj = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977
        self.rotary = Rotary(self.head_dim)
        self.lamb = nn.Parameter(torch.tensor(0.5)) # @Grad62304977

    def forward(self, x, v1, block_mask: BlockMask, score_mod: _score_mod_signature):
        B, T, C = x.size() # batch size, sequence length, embedding dimensionality (n_embd)
        q = self.c_q(x).view(B, T, self.n_head, self.head_dim)
        k = self.c_k(x).view(B, T, self.n_head, self.head_dim)
        v = self.c_v(x).view(B, T, self.n_head, self.head_dim)
        if v1 is None:
            v1 = v # This happens if we are in the first block. v needs to be accessed by subsequent blocks
        v = (1 - self.lamb) * v + self.lamb * v1.view_as(v) # @Grad62304977
        cos, sin = self.rotary(q)
        q, k = F.rms_norm(q, (q.size(-1),)), F.rms_norm(k, (k.size(-1),)) # QK norm suggested by @Grad62304977
        q, k = apply_rotary_emb(q, cos, sin), apply_rotary_emb(k, cos, sin)
        y = flex_attention(q.transpose(1, 2), k.transpose(1, 2), v.transpose(1, 2), score_mod=score_mod, block_mask=block_mask)
        y = y.transpose(1, 2).contiguous().view_as(x) # re-assemble all head outputs side by side
        y = self.c_proj(y)
        return y, v1

class MLP(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.c_fc    = CastedLinear(config.n_embd, 4 * config.n_embd, bias=False)
        self.c_proj  = CastedLinear(4 * config.n_embd, config.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977

    def forward(self, x):
        x = self.c_fc(x)
        x = F.relu(x).square() # https://arxiv.org/abs/2109.08668v2; ~1-2% better than GELU; suggested by @SKYLINEZ007 and @Grad62304977
        x = self.c_proj(x)
        return x

class Block(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.attn = CausalSelfAttention(config)
        self.mlp = MLP(config)
        self.lambdas = nn.Parameter(torch.tensor([1., 0.]))

    def forward(self, x, v1, x0, block_mask: BlockMask, score_mod: _score_mod_signature):
        x = self.lambdas[0] * x + self.lambdas[1] * x0
        x1, v1 = self.attn(F.rms_norm(x, (x.size(-1),)), v1, block_mask, score_mod)
        x = x + x1
        x = x + self.mlp(F.rms_norm(x, (x.size(-1),)))
        return x, v1

# -----------------------------------------------------------------------------
# The main GPT-2 model

@dataclass
class GPTConfig:
    vocab_size : int = 50304
    n_layer : int = 12
    n_head : int = 6 # head dim 128 suggested by @Grad62304977
    n_embd : int = 768
    attention_soft_cap : int = 50
    lm_head_soft_cap : int = 30

class GPT(nn.Module):

    def __init__(self, config: GPTConfig):
        super().__init__()
        self.attention_soft_cap = config.attention_soft_cap
        self.lm_head_soft_cap = config.lm_head_soft_cap

        # U-net design by @brendanh0gan
        self.num_encoder_layers = config.n_layer // 2 # Half of the layers for encoder
        self.num_decoder_layers = config.n_layer - self.num_encoder_layers # Remaining for decoder
        # Add learnable skip connection weights for decoder layers
        self.skip_weights = nn.Parameter(torch.ones(self.num_decoder_layers))

        self.transformer = nn.ModuleDict(dict(
            wte = nn.Embedding(config.vocab_size, config.n_embd),
            h = nn.ModuleList([Block(config) for _ in range(config.n_layer)]),
        ))
        self.lm_head = CastedLinear(config.n_embd, config.vocab_size, bias=False)
        self.lm_head.weight.data.zero_() # @Grad62304977

    def forward(self, idx, target, attn_blocksize: int):

        docs = (idx == 50256).cumsum(0)
        def document_causal_mask(b, h, q_idx, kv_idx):
            causal_mask = q_idx >= kv_idx
            document_mask = docs[q_idx] == docs[kv_idx]
            window_mask = q_idx - kv_idx < attn_blocksize
            return causal_mask & document_mask & window_mask

        softcap_mod = generate_tanh_softcap(self.attention_soft_cap, approx=True)  # @leloykun

        S = len(idx)
        block_mask = create_block_mask(document_causal_mask, None, None, S, S, device="cuda", _compile=True)

        # forward the GPT model itself
        x = self.transformer.wte(idx[None]) # token embeddings of shape (b, t, n_embd)
        x = F.rms_norm(x, (x.size(-1),)) # @Grad62304977
        x0 = x
        v1 = None

        # Store outputs for U-Net skip connections
        skip_connections = []
        # Encoder pass - process only the first half of the blocks
        for i in range(self.num_encoder_layers):
            x, v1 = self.transformer.h[i](x, v1, x0, block_mask, softcap_mod)
            skip_connections.append(x)
        # Decoder pass - process the remaining blocks with weighted skip connections
        for i in range(self.num_decoder_layers):
            x = x + self.skip_weights[i] * skip_connections.pop()
            x, v1 = self.transformer.h[self.num_encoder_layers + i](x, v1, x0, block_mask, softcap_mod)

        x = F.rms_norm(x, (x.size(-1),))
        logits = self.lm_head(x)
        logits = self.lm_head_soft_cap * torch.tanh(logits / self.lm_head_soft_cap) # @Grad62304977
        logits = logits.float()
        loss = F.cross_entropy(logits.view(-1, logits.size(-1)), target.view(-1))
        return loss

# -----------------------------------------------------------------------------
# Our own simple Distributed Data Loader

def _peek_data_shard(filename):
    # only reads the header, returns header data
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
    if header[0] != 20240520:
        print("ERROR: magic number mismatch in the data .bin file!")
        print("---> HINT: Are you passing in a correct file with --input_bin?")
        print("---> HINT: Dataset encoding changed recently, re-run data prepro or refer again to README")
        print("---> HINT: For example re-run: `python dev/data/tinyshakespeare.py`, then re-try")
        exit(1)
    assert header[1] == 1, "unsupported version"
    ntok = header[2] # number of tokens (claimed)
    return ntok # for now just return the number of tokens

def _load_data_shard(filename):
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
        assert header[0] == 20240520, "magic number mismatch in the data .bin file"
        assert header[1] == 1, "unsupported version"
        ntok = header[2] # number of tokens (claimed)
        # the rest of it are tokens, stored as uint16
        tokens = np.frombuffer(f.read(), dtype=np.uint16)
    assert len(tokens) == ntok, "number of tokens read does not match header?"
    return tokens

class DistributedDataLoader:
    def __init__(self, filename_pattern, B, T, process_rank, num_processes):
        self.process_rank = process_rank
        self.num_processes = num_processes
        self.B = B
        self.T = T

        # glob files that match the pattern
        self.files = sorted(glob.glob(filename_pattern))
        assert len(self.files) > 0, f"did not find any files that match the pattern {filename_pattern}"

        # load and validate all data shards, count number of tokens in total
        ntok_total = 0
        for fname in self.files:
            shard_ntok = _peek_data_shard(fname)
            assert shard_ntok >= num_processes * B * T + 1
            ntok_total += int(shard_ntok)
        self.ntok_total = ntok_total

        self.reset()

    def reset(self):
        self.current_shard = -1
        self.advance()

    def advance(self): # advance to next data shard
        self.current_shard = (self.current_shard + 1) % len(self.files)
        self.current_position = self.process_rank * self.B * self.T
        self.tokens = _load_data_shard(self.files[self.current_shard])

    def next_batch(self):
        batch_size = self.B * self.T * self.num_processes
        buf = self.tokens[self.current_position:self.current_position+self.B*self.T+1]
        buf = torch.tensor(buf.astype(np.int32), dtype=torch.long)
        x = buf[:-1] # inputs
        y = buf[1:] # targets
        # advance current position and load next shard if necessary
        self.current_position += batch_size
        if self.current_position + batch_size >= len(self.tokens):
            self.advance()
        return x.cuda(), y.cuda()

# -----------------------------------------------------------------------------
# int main

@dataclass
class Hyperparameters:
    # data hyperparams
    input_bin : str = 'data/fineweb10B/fineweb_train_*.bin' # input .bin to train on
    input_val_bin : str = 'data/fineweb10B/fineweb_val_*.bin' # input .bin to eval validation loss on
    # optimization hyperparams
    batch_size : int = 8 # batch size, in sequences, across all devices
    device_batch_size : int = 1 # batch size, in sequences, per device
    sequence_length : int = 64*1024 # sequence length, in tokens
    num_iterations : int = 1750 # number of iterations to run
    warmup_iters : int = 0
    cooldown_iters : int = 640 # number of iterations of linear warmup/cooldown for triangular or trapezoidal schedule
    weight_decay : float = 0
    # evaluation and logging hyperparams
    val_loss_every : int = 125 # every how many steps to evaluate val loss? 0 for only at the end
    val_tokens : int = 10485760 # how many tokens of validation data? it's important to keep this fixed for consistent comparisons
    save_every : int = 0 # every how many steps to save the checkpoint? 0 for only at the end
args = Hyperparameters()

# set up DDP (distributed data parallel). torchrun sets this env variable
assert torch.cuda.is_available()
dist.init_process_group(backend='nccl')
ddp_rank = int(os.environ['RANK'])
ddp_local_rank = int(os.environ['LOCAL_RANK'])
ddp_world_size = int(os.environ['WORLD_SIZE'])
device = f'cuda:{ddp_local_rank}'
torch.cuda.set_device(device)
print(f"using device: {device}")
master_process = (ddp_rank == 0) # this process will do logging, checkpointing etc.

# begin logging
logfile = None
if master_process:
    run_id = str(uuid.uuid4())
    logdir = 'logs/%s/' % run_id
    os.makedirs(logdir, exist_ok=True)
    logfile = 'logs/%s.txt' % run_id
    # create the log file
    with open(logfile, "w") as f:
        # begin the log by printing this file (the Python code)
        f.write('='*100 + '\n')
        f.write(code)
        f.write('='*100 + '\n')
def print0(s, logonly=False):
    if master_process:
        with open(logfile, "a") as f:
            if not logonly:
                print(s)
            f.write(s+'\n')
# log information about the hardware/software environment this is running on
# and print the full `nvidia-smi` to file
print0(f"Running pytorch {torch.version.__version__} compiled for CUDA {torch.version.cuda}\nnvidia-smi:")
import subprocess
result = subprocess.run(['nvidia-smi'], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
print0(f'{result.stdout}', logonly=True)
print0('='*100, logonly=True)

# convenience variables
B, T = args.device_batch_size, args.sequence_length
# calculate the number of steps to take in the val loop.
assert args.val_tokens % (B * T * ddp_world_size) == 0
val_steps = args.val_tokens // (B * T * ddp_world_size)
# calculate the steps of gradient accumulation required to attain the desired global batch size.
assert args.batch_size % (B * ddp_world_size) == 0
train_accumulation_steps = args.batch_size // (B * ddp_world_size)

# load tokens
train_loader = DistributedDataLoader(args.input_bin, B, T, ddp_rank, ddp_world_size)
val_loader = DistributedDataLoader(args.input_val_bin, B, T, ddp_rank, ddp_world_size)
print0(f"Training DataLoader: total number of tokens: {train_loader.ntok_total} across {len(train_loader.files)} files")
print0(f"Validation DataLoader: total number of tokens: {val_loader.ntok_total} across {len(val_loader.files)} files")
print0('='*100, logonly=True)
x, y = train_loader.next_batch()

# there are only 50257 unique GPT-2 tokens; we extend to nearest multiple of 128 for efficiency. suggested to me by @Grad62304977.
# this originates from Karpathy's experiments.
num_vocab = 50304
model = GPT(GPTConfig(vocab_size=num_vocab, n_layer=12, n_head=6, n_embd=768))
model = model.cuda().bfloat16()
for m in model.modules():
    if isinstance(m, CastedLinear):
        m.float()
if hasattr(config, "coordinate_descent_tuning"):
    config.coordinate_descent_tuning = True # suggested by @Chillee
model = torch.compile(model)
# here we wrap model into DDP container
model = DDP(model, device_ids=[ddp_local_rank])
raw_model = model.module # always contains the "raw" unwrapped model

# CUDNN attention is ~4ms faster than Flash, but doesn't get selected by default in PyTorch 2.5.1
from torch.backends.cuda import enable_cudnn_sdp, enable_flash_sdp, enable_math_sdp, enable_mem_efficient_sdp
enable_cudnn_sdp(True)
enable_flash_sdp(False)
enable_mem_efficient_sdp(False)
enable_math_sdp(False)

# init the optimizer(s)
optimizer1 = torch.optim.Adam([raw_model.transformer.wte.weight], lr=0.6,   betas=(0.8, 0.95), fused=True)
optimizer2 = torch.optim.Adam([raw_model.lm_head.weight],         lr=0.008, betas=(0.8, 0.95), fused=True)
param_names = [name for name, _ in raw_model.named_parameters()]
params = list(raw_model.transformer.h.parameters())
qk_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and ("c_q" in n or "c_k" in n)]
matrix_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and "c_q" not in n and "c_k" not in n]
scalar_params = [p for p in params if p.ndim < 2] + [raw_model.skip_weights]
optimizer5 = Muon(qk_params, lr=0.08, momentum=0.95)
optimizer3 = Muon(matrix_params, lr=0.05, momentum=0.95)
optimizer4 = torch.optim.Adam(scalar_params, lr=0.04, betas=(0.8, 0.95), fused=True) # note that this learning rate is neither sensitive nor tuned
optimizers = [optimizer1, optimizer2, optimizer3, optimizer4, optimizer5]
# learning rate decay scheduler (linear warmup and cooldown)
def get_lr(it):
    assert it <= args.num_iterations
    # 1) linear warmup for warmup_iters steps
    if it < args.warmup_iters:
        return (it+1) / args.warmup_iters
    # 2) constant lr for a while
    elif it < args.num_iterations - args.cooldown_iters:
        return 1.0
    # 3) linear cooldown
    else:
        decay_ratio = (args.num_iterations - it) / args.cooldown_iters
        return decay_ratio
schedulers = [torch.optim.lr_scheduler.LambdaLR(opt, get_lr) for opt in optimizers]

# Start training loop
training_time_ms = 0
# start the clock
torch.cuda.synchronize()
t0 = time.time()
# begin training
for step in range(args.num_iterations + 1):
    last_step = (step == args.num_iterations)
    # Set the attention blocksize for the current step, in chunks of 64
    attn_blocksize = torch.tensor(64*((step/args.num_iterations * (1792 - 64) + 64)//64), dtype=torch.int, device='cuda')
    # This effectively ignores timing first 10 steps, which are slower for weird reasons.
    # Alternately, and slightly more correctly in terms of benchmarking, we could do 10
    # steps with dummy data first, and then re-initialize the model and reset the loader.
    if step == 10:
        training_time_ms = 0
        t0 = time.time()
    timed_steps = float('nan') if step <= 11 else (step - 10) + 1 # <= 11 to avoid bug in val

    # once in a while evaluate the validation dataset
    if (last_step or (args.val_loss_every > 0 and step % args.val_loss_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # run validation batches
        model.eval()
        val_loader.reset()
        val_loss = 0.0
        for _ in range(val_steps):
            with torch.no_grad():
                x_val, y_val = val_loader.next_batch()
                val_loss += model(x_val, y_val, attn_blocksize=attn_blocksize)
        dist.all_reduce(val_loss, op=dist.ReduceOp.AVG)
        val_loss /= val_steps
        # log val loss to console and to logfile
        print0(f'step:{step}/{args.num_iterations} val_loss:{val_loss:.4f} train_time:{training_time_ms:.0f}ms step_avg:{training_time_ms/(timed_steps-1):.2f}ms')
        if master_process:
            print("============== Weight norms: ==============")
            with open(logfile, "a") as f:
                f.write("============== Weight norms: ==============\n")
                for name, p in model.named_parameters():
                    if p.ndim != 2:
                        continue
                    if "transformer.wte" in name:
                        l1_to_l2_norm = torch.norm(p.data.float(), p=2, dim=1).mean().item()
                    frobenius_norm = torch.linalg.norm(p.data.float(), ord='fro').item()
                    spectral_norm = torch.linalg.matrix_norm(p.data.float(), ord=2).item()
                    nuclear_norm = torch.linalg.matrix_norm(p.data.float(), ord="nuc").item()
                    if "transformer.wte" in name:
                        print(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                    else:
                        print(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                f.write("===========================================\n")
            print("===========================================")
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    if master_process and (last_step or (args.save_every > 0 and step % args.save_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # save the state of the training process
        log = dict(step=step, code=code, model=raw_model.state_dict(), optimizers=[opt.state_dict() for opt in optimizers])
        torch.save(log, 'logs/%s/state_step%06d.pt' % (run_id, step))
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    # bit confusing: we want to make sure to eval on 0th iteration
    # but also after the very last iteration. so we loop for step <= num_iterations
    # instead of just < num_iterations (one extra due to <=), only to do
    # the validation/sampling one last time, and then we break right here as we're done.
    if last_step:
        break

    # --------------- TRAINING SECTION BEGIN -----------------
    model.train()
    for i in range(1, train_accumulation_steps+1):
        # forward pass
        loss = model(x, y, attn_blocksize=attn_blocksize)
        train_loss = loss.detach()
        # advance the dataset for the next batch
        x, y = train_loader.next_batch()
        # backward pass
        if i < train_accumulation_steps:
            with model.no_sync(): # there's no need to sync gradients every accumulation step
                loss.backward()
        else:
            loss.backward() # just sync on the last step
    for p in model.parameters():
        p.grad /= train_accumulation_steps
    # momentum warmup for Muon
    frac = min(step/300, 1)
    optimizer3.param_groups[0]['momentum'] = (1 - frac) * 0.85 + frac * 0.95
    # step the optimizers and schedulers
    for opt, sched in zip(optimizers, schedulers):
        opt.step()
        sched.step()
    # null the gradients
    model.zero_grad(set_to_none=True)
    # --------------- TRAINING SECTION END -------------------
    # everything that follows now is just diagnostics, prints, logging, etc.

    #dist.all_reduce(train_loss, op=dist.ReduceOp.AVG) # all-reducing the training loss would be more correct in terms of logging, but slower
    approx_time = training_time_ms + 1000 * (time.time() - t0)
    print0(f"step:{step+1}/{args.num_iterations} train_loss:{train_loss.item():.4f} train_time:{approx_time:.0f}ms step_avg:{approx_time/timed_steps:.2f}ms")

if master_process:
    print(f"peak memory consumption: {torch.cuda.max_memory_allocated() // 1024 // 1024} MiB")

# -------------------------------------------------------------------------
# clean up nice
dist.destroy_process_group()
====================================================================================================
Running pytorch 2.6.0.dev20241125+cu124 compiled for CUDA 12.4
nvidia-smi:
Mon Nov 25 15:16:52 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.12             Driver Version: 535.104.12   CUDA Version: 12.4     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  | 00000000:07:00.0 Off |                    0 |
| N/A   42C    P0              69W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  | 00000000:0A:00.0 Off |                    0 |
| N/A   33C    P0              69W / 400W |     37MiB / 81920MiB |      1%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  | 00000000:45:00.0 Off |                    0 |
| N/A   33C    P0              71W / 400W |     27MiB / 81920MiB |      1%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  | 00000000:4B:00.0 Off |                    0 |
| N/A   43C    P0              76W / 400W |     24MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   4  NVIDIA A100-SXM4-80GB          On  | 00000000:84:00.0 Off |                    0 |
| N/A   44C    P0              77W / 400W |    427MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   5  NVIDIA A100-SXM4-80GB          On  | 00000000:8A:00.0 Off |                    0 |
| N/A   33C    P0              70W / 400W |     25MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   6  NVIDIA A100-SXM4-80GB          On  | 00000000:C0:00.0 Off |                    0 |
| N/A   32C    P0              70W / 400W |     25MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   7  NVIDIA A100-SXM4-80GB          On  | 00000000:C3:00.0 Off |                    0 |
| N/A   42C    P0              76W / 400W |    427MiB / 81920MiB |      1%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
+---------------------------------------------------------------------------------------+

====================================================================================================
Training DataLoader: total number of tokens: 1100000000 across 11 files
Validation DataLoader: total number of tokens: 100000000 across 1 files
====================================================================================================
step:0/1750 val_loss:10.8258 train_time:0ms step_avg:nanms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 27.69897 | frobenius_norm = 6214.48242 | spectral_norm = 251.96548 | nuclear_norm = 171914.48438
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 16.00899 | spectral_norm = 1.14927 | nuclear_norm = 376.57678
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 16.00674 | spectral_norm = 1.16165 | nuclear_norm = 376.33942
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 16.00238 | spectral_norm = 1.14377 | nuclear_norm = 376.75806
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 32.00362 | spectral_norm = 1.72526 | nuclear_norm = 858.34949
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 15.98969 | spectral_norm = 1.14873 | nuclear_norm = 376.09546
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 16.01645 | spectral_norm = 1.14931 | nuclear_norm = 376.79337
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 15.97954 | spectral_norm = 1.14613 | nuclear_norm = 375.80945
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 31.99987 | spectral_norm = 1.72401 | nuclear_norm = 858.14514
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 15.97369 | spectral_norm = 1.14184 | nuclear_norm = 376.06299
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 16.01017 | spectral_norm = 1.14316 | nuclear_norm = 376.85965
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 15.99338 | spectral_norm = 1.14212 | nuclear_norm = 376.19434
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 31.99992 | spectral_norm = 1.72796 | nuclear_norm = 858.21655
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 15.99379 | spectral_norm = 1.14586 | nuclear_norm = 376.17361
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 16.01187 | spectral_norm = 1.14360 | nuclear_norm = 376.95886
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 16.00665 | spectral_norm = 1.14667 | nuclear_norm = 376.26556
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 31.99331 | spectral_norm = 1.71655 | nuclear_norm = 858.07007
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 16.00343 | spectral_norm = 1.15234 | nuclear_norm = 376.51941
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 15.98839 | spectral_norm = 1.14765 | nuclear_norm = 376.07510
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 15.99751 | spectral_norm = 1.15428 | nuclear_norm = 376.29828
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 31.99990 | spectral_norm = 1.72524 | nuclear_norm = 858.28430
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 15.99754 | spectral_norm = 1.15281 | nuclear_norm = 376.19214
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 16.00754 | spectral_norm = 1.15347 | nuclear_norm = 376.55023
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 16.00949 | spectral_norm = 1.16040 | nuclear_norm = 376.62332
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 31.99222 | spectral_norm = 1.72200 | nuclear_norm = 857.98151
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 16.00325 | spectral_norm = 1.16031 | nuclear_norm = 376.46948
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 16.00257 | spectral_norm = 1.14407 | nuclear_norm = 376.31601
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 15.99456 | spectral_norm = 1.15708 | nuclear_norm = 376.26038
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 32.02979 | spectral_norm = 1.72988 | nuclear_norm = 859.03223
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 15.99697 | spectral_norm = 1.15500 | nuclear_norm = 376.33691
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 16.01508 | spectral_norm = 1.14669 | nuclear_norm = 376.70306
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 15.99232 | spectral_norm = 1.14750 | nuclear_norm = 376.29544
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 31.98996 | spectral_norm = 1.72595 | nuclear_norm = 857.95099
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 15.99232 | spectral_norm = 1.14816 | nuclear_norm = 376.14709
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 15.99621 | spectral_norm = 1.14323 | nuclear_norm = 376.36423
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 16.00446 | spectral_norm = 1.14636 | nuclear_norm = 376.48975
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 31.99234 | spectral_norm = 1.72683 | nuclear_norm = 857.98816
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 16.01577 | spectral_norm = 1.16085 | nuclear_norm = 376.77722
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 16.00652 | spectral_norm = 1.15835 | nuclear_norm = 376.46631
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 15.99129 | spectral_norm = 1.14978 | nuclear_norm = 375.99719
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 32.01012 | spectral_norm = 1.72861 | nuclear_norm = 858.48560
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 15.99833 | spectral_norm = 1.14292 | nuclear_norm = 376.36734
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 15.97659 | spectral_norm = 1.14510 | nuclear_norm = 375.80737
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 15.98158 | spectral_norm = 1.13569 | nuclear_norm = 376.10602
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 31.99953 | spectral_norm = 1.73143 | nuclear_norm = 858.27319
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 15.99976 | spectral_norm = 1.14550 | nuclear_norm = 376.17560
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 16.01510 | spectral_norm = 1.15188 | nuclear_norm = 376.74332
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 16.00937 | spectral_norm = 1.14700 | nuclear_norm = 376.58380
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 32.00617 | spectral_norm = 1.72118 | nuclear_norm = 858.48724
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
===========================================
step:1/1750 train_loss:10.8258 train_time:33427ms step_avg:nanms
step:2/1750 train_loss:10.0677 train_time:34228ms step_avg:nanms
step:3/1750 train_loss:8.3318 train_time:34560ms step_avg:nanms
step:4/1750 train_loss:7.6179 train_time:34894ms step_avg:nanms
step:5/1750 train_loss:7.4998 train_time:35225ms step_avg:nanms
step:6/1750 train_loss:6.9939 train_time:35556ms step_avg:nanms
step:7/1750 train_loss:7.2126 train_time:35887ms step_avg:nanms
step:8/1750 train_loss:6.7388 train_time:36218ms step_avg:nanms
step:9/1750 train_loss:6.6520 train_time:36549ms step_avg:nanms
step:10/1750 train_loss:6.5285 train_time:36880ms step_avg:nanms
step:11/1750 train_loss:6.4940 train_time:249ms step_avg:nanms
step:12/1750 train_loss:6.3260 train_time:581ms step_avg:nanms
step:13/1750 train_loss:6.3086 train_time:912ms step_avg:303.96ms
step:14/1750 train_loss:6.2183 train_time:1243ms step_avg:310.80ms
step:15/1750 train_loss:6.1633 train_time:1575ms step_avg:314.93ms
step:16/1750 train_loss:6.1239 train_time:1906ms step_avg:317.73ms
step:17/1750 train_loss:6.1806 train_time:2238ms step_avg:319.73ms
step:18/1750 train_loss:5.9728 train_time:2568ms step_avg:321.04ms
step:19/1750 train_loss:6.0439 train_time:2900ms step_avg:322.26ms
step:20/1750 train_loss:5.6996 train_time:3232ms step_avg:323.19ms
step:21/1750 train_loss:5.9887 train_time:3565ms step_avg:324.09ms
step:22/1750 train_loss:6.1900 train_time:3896ms step_avg:324.67ms
step:23/1750 train_loss:5.8839 train_time:4228ms step_avg:325.22ms
step:24/1750 train_loss:6.0348 train_time:4559ms step_avg:325.68ms
step:25/1750 train_loss:5.7272 train_time:4891ms step_avg:326.06ms
step:26/1750 train_loss:5.6615 train_time:5222ms step_avg:326.40ms
step:27/1750 train_loss:5.9089 train_time:5554ms step_avg:326.72ms
step:28/1750 train_loss:5.4739 train_time:5886ms step_avg:327.01ms
step:29/1750 train_loss:5.7135 train_time:6218ms step_avg:327.24ms
step:30/1750 train_loss:5.5249 train_time:6549ms step_avg:327.46ms
step:31/1750 train_loss:5.5192 train_time:6880ms step_avg:327.63ms
step:32/1750 train_loss:5.3576 train_time:7212ms step_avg:327.84ms
step:33/1750 train_loss:5.6427 train_time:7544ms step_avg:328.02ms
step:34/1750 train_loss:5.5442 train_time:7877ms step_avg:328.19ms
step:35/1750 train_loss:5.6801 train_time:8208ms step_avg:328.33ms
step:36/1750 train_loss:5.5904 train_time:8540ms step_avg:328.46ms
step:37/1750 train_loss:5.5143 train_time:8872ms step_avg:328.59ms
step:38/1750 train_loss:5.3747 train_time:9204ms step_avg:328.71ms
step:39/1750 train_loss:5.3757 train_time:9536ms step_avg:328.83ms
step:40/1750 train_loss:5.2987 train_time:9867ms step_avg:328.91ms
step:41/1750 train_loss:5.2946 train_time:10200ms step_avg:329.03ms
step:42/1750 train_loss:5.2135 train_time:10532ms step_avg:329.13ms
step:43/1750 train_loss:5.2945 train_time:10864ms step_avg:329.21ms
step:44/1750 train_loss:5.2862 train_time:11196ms step_avg:329.30ms
step:45/1750 train_loss:5.4270 train_time:11528ms step_avg:329.38ms
step:46/1750 train_loss:5.2192 train_time:11860ms step_avg:329.45ms
step:47/1750 train_loss:5.1099 train_time:12193ms step_avg:329.55ms
step:48/1750 train_loss:5.2567 train_time:12527ms step_avg:329.65ms
step:49/1750 train_loss:5.1743 train_time:12859ms step_avg:329.72ms
step:50/1750 train_loss:5.2800 train_time:13191ms step_avg:329.78ms
step:51/1750 train_loss:5.1831 train_time:13523ms step_avg:329.84ms
step:52/1750 train_loss:5.0791 train_time:13857ms step_avg:329.92ms
step:53/1750 train_loss:5.2282 train_time:14188ms step_avg:329.96ms
step:54/1750 train_loss:5.0606 train_time:14521ms step_avg:330.02ms
step:55/1750 train_loss:5.4660 train_time:14854ms step_avg:330.09ms
step:56/1750 train_loss:5.0788 train_time:15187ms step_avg:330.15ms
step:57/1750 train_loss:4.9136 train_time:15519ms step_avg:330.19ms
step:58/1750 train_loss:5.0367 train_time:15853ms step_avg:330.27ms
step:59/1750 train_loss:5.0374 train_time:16185ms step_avg:330.31ms
step:60/1750 train_loss:5.1632 train_time:16518ms step_avg:330.37ms
step:61/1750 train_loss:4.9111 train_time:16851ms step_avg:330.41ms
step:62/1750 train_loss:5.0454 train_time:17183ms step_avg:330.44ms
step:63/1750 train_loss:5.0112 train_time:17517ms step_avg:330.51ms
step:64/1750 train_loss:5.0171 train_time:17850ms step_avg:330.56ms
step:65/1750 train_loss:4.8494 train_time:18184ms step_avg:330.61ms
step:66/1750 train_loss:5.0197 train_time:18519ms step_avg:330.70ms
step:67/1750 train_loss:4.8785 train_time:18852ms step_avg:330.74ms
step:68/1750 train_loss:5.1524 train_time:19187ms step_avg:330.81ms
step:69/1750 train_loss:4.7574 train_time:19520ms step_avg:330.84ms
step:70/1750 train_loss:4.8932 train_time:19853ms step_avg:330.88ms
step:71/1750 train_loss:5.0211 train_time:20186ms step_avg:330.92ms
step:72/1750 train_loss:4.9267 train_time:20520ms step_avg:330.96ms
step:73/1750 train_loss:4.7891 train_time:20853ms step_avg:330.99ms
step:74/1750 train_loss:4.9456 train_time:21186ms step_avg:331.03ms
step:75/1750 train_loss:4.8857 train_time:21519ms step_avg:331.07ms
step:76/1750 train_loss:4.8337 train_time:21854ms step_avg:331.12ms
step:77/1750 train_loss:4.9283 train_time:22188ms step_avg:331.16ms
step:78/1750 train_loss:5.1468 train_time:22520ms step_avg:331.18ms
step:79/1750 train_loss:4.8347 train_time:22855ms step_avg:331.23ms
step:80/1750 train_loss:4.8618 train_time:23187ms step_avg:331.25ms
step:81/1750 train_loss:4.6568 train_time:23521ms step_avg:331.29ms
step:82/1750 train_loss:4.8390 train_time:23855ms step_avg:331.31ms
step:83/1750 train_loss:4.7879 train_time:24189ms step_avg:331.36ms
step:84/1750 train_loss:4.7717 train_time:24523ms step_avg:331.40ms
step:85/1750 train_loss:4.6285 train_time:24858ms step_avg:331.44ms
step:86/1750 train_loss:4.8526 train_time:25193ms step_avg:331.48ms
step:87/1750 train_loss:4.7614 train_time:25527ms step_avg:331.51ms
step:88/1750 train_loss:4.7269 train_time:25862ms step_avg:331.56ms
step:89/1750 train_loss:4.6963 train_time:26196ms step_avg:331.60ms
step:90/1750 train_loss:4.6403 train_time:26531ms step_avg:331.63ms
step:91/1750 train_loss:4.6252 train_time:26865ms step_avg:331.66ms
step:92/1750 train_loss:4.7887 train_time:27198ms step_avg:331.68ms
step:93/1750 train_loss:4.6016 train_time:27532ms step_avg:331.71ms
step:94/1750 train_loss:4.6464 train_time:27866ms step_avg:331.74ms
step:95/1750 train_loss:4.6797 train_time:28200ms step_avg:331.77ms
step:96/1750 train_loss:4.5782 train_time:28535ms step_avg:331.80ms
step:97/1750 train_loss:4.6201 train_time:28869ms step_avg:331.82ms
step:98/1750 train_loss:4.5715 train_time:29202ms step_avg:331.84ms
step:99/1750 train_loss:4.6488 train_time:29536ms step_avg:331.87ms
step:100/1750 train_loss:4.6760 train_time:29872ms step_avg:331.91ms
step:101/1750 train_loss:4.5138 train_time:30205ms step_avg:331.92ms
step:102/1750 train_loss:4.6837 train_time:30539ms step_avg:331.94ms
step:103/1750 train_loss:4.5621 train_time:30873ms step_avg:331.97ms
step:104/1750 train_loss:4.5340 train_time:31207ms step_avg:331.99ms
step:105/1750 train_loss:4.5641 train_time:31541ms step_avg:332.01ms
step:106/1750 train_loss:4.5857 train_time:31876ms step_avg:332.04ms
step:107/1750 train_loss:4.5100 train_time:32210ms step_avg:332.06ms
step:108/1750 train_loss:4.3517 train_time:32544ms step_avg:332.09ms
step:109/1750 train_loss:4.4834 train_time:32879ms step_avg:332.11ms
step:110/1750 train_loss:4.4662 train_time:33213ms step_avg:332.13ms
step:111/1750 train_loss:4.4213 train_time:33548ms step_avg:332.16ms
step:112/1750 train_loss:4.5748 train_time:33883ms step_avg:332.19ms
step:113/1750 train_loss:4.4903 train_time:34217ms step_avg:332.20ms
step:114/1750 train_loss:4.3609 train_time:34551ms step_avg:332.22ms
step:115/1750 train_loss:4.5031 train_time:34886ms step_avg:332.25ms
step:116/1750 train_loss:4.4754 train_time:35221ms step_avg:332.27ms
step:117/1750 train_loss:4.3890 train_time:35555ms step_avg:332.29ms
step:118/1750 train_loss:4.6188 train_time:35890ms step_avg:332.31ms
step:119/1750 train_loss:4.4734 train_time:36225ms step_avg:332.34ms
step:120/1750 train_loss:4.3781 train_time:36559ms step_avg:332.36ms
step:121/1750 train_loss:4.3144 train_time:36894ms step_avg:332.38ms
step:122/1750 train_loss:4.4631 train_time:37229ms step_avg:332.40ms
step:123/1750 train_loss:4.3002 train_time:37564ms step_avg:332.43ms
step:124/1750 train_loss:4.6109 train_time:37899ms step_avg:332.45ms
step:125/1750 train_loss:4.4715 train_time:38234ms step_avg:332.47ms
step:125/1750 val_loss:4.4200 train_time:38318ms step_avg:333.20ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 118.77807 | frobenius_norm = 27077.82422 | spectral_norm = 6759.82471 | nuclear_norm = 658258.43750
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 38.32810 | spectral_norm = 3.17623 | nuclear_norm = 903.62671
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 37.00857 | spectral_norm = 4.46931 | nuclear_norm = 868.96057
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 84.12710 | spectral_norm = 5.69277 | nuclear_norm = 1963.99158
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 85.07031 | spectral_norm = 8.65964 | nuclear_norm = 2026.62646
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 77.53448 | spectral_norm = 5.42205 | nuclear_norm = 2060.04150
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 41.87019 | spectral_norm = 2.80933 | nuclear_norm = 1112.23291
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 36.34727 | spectral_norm = 3.06081 | nuclear_norm = 853.91248
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 35.47812 | spectral_norm = 3.91571 | nuclear_norm = 832.50586
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 92.70439 | spectral_norm = 7.52212 | nuclear_norm = 2144.59326
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 94.88732 | spectral_norm = 8.88687 | nuclear_norm = 2265.32324
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 84.39676 | spectral_norm = 5.37975 | nuclear_norm = 2245.00220
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 43.77309 | spectral_norm = 2.98238 | nuclear_norm = 1161.88550
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 35.28049 | spectral_norm = 3.07480 | nuclear_norm = 826.33411
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 34.90153 | spectral_norm = 3.59748 | nuclear_norm = 816.21887
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 84.86822 | spectral_norm = 7.55953 | nuclear_norm = 1925.41528
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 94.29869 | spectral_norm = 8.49630 | nuclear_norm = 2243.93018
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 85.25300 | spectral_norm = 5.41955 | nuclear_norm = 2265.21436
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 44.04434 | spectral_norm = 3.00806 | nuclear_norm = 1167.75049
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 34.85474 | spectral_norm = 2.83636 | nuclear_norm = 806.42188
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 35.47773 | spectral_norm = 3.00101 | nuclear_norm = 824.87994
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 93.25819 | spectral_norm = 8.59754 | nuclear_norm = 2091.39404
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 91.85577 | spectral_norm = 8.23304 | nuclear_norm = 2183.08960
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 84.28683 | spectral_norm = 5.31068 | nuclear_norm = 2236.86572
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 43.84447 | spectral_norm = 3.03797 | nuclear_norm = 1160.74451
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 34.50451 | spectral_norm = 2.87210 | nuclear_norm = 800.98279
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 35.27420 | spectral_norm = 3.00074 | nuclear_norm = 820.91010
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 83.28882 | spectral_norm = 8.14734 | nuclear_norm = 1835.99097
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 87.87278 | spectral_norm = 8.06073 | nuclear_norm = 2070.36841
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 85.19146 | spectral_norm = 5.34195 | nuclear_norm = 2256.83691
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 43.78166 | spectral_norm = 3.10891 | nuclear_norm = 1156.09497
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 34.59414 | spectral_norm = 2.88107 | nuclear_norm = 805.50415
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 35.12285 | spectral_norm = 2.94645 | nuclear_norm = 819.48163
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 80.18920 | spectral_norm = 7.77281 | nuclear_norm = 1766.48694
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 84.65988 | spectral_norm = 8.04898 | nuclear_norm = 1997.36353
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 83.44260 | spectral_norm = 5.31053 | nuclear_norm = 2208.72461
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 42.93772 | spectral_norm = 3.05092 | nuclear_norm = 1132.71851
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 33.52531 | spectral_norm = 2.89334 | nuclear_norm = 779.58099
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 34.20940 | spectral_norm = 2.94421 | nuclear_norm = 796.68420
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 83.90636 | spectral_norm = 8.03113 | nuclear_norm = 1848.79077
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 86.24819 | spectral_norm = 8.14944 | nuclear_norm = 2039.55444
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 81.85055 | spectral_norm = 5.43142 | nuclear_norm = 2160.97534
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 42.00735 | spectral_norm = 2.96047 | nuclear_norm = 1103.36584
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 33.04693 | spectral_norm = 2.73636 | nuclear_norm = 764.93701
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 33.77779 | spectral_norm = 2.78951 | nuclear_norm = 781.66516
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 80.44724 | spectral_norm = 7.56348 | nuclear_norm = 1775.42993
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 88.68516 | spectral_norm = 8.29780 | nuclear_norm = 2111.02515
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 82.02750 | spectral_norm = 5.53349 | nuclear_norm = 2165.55273
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 41.91333 | spectral_norm = 2.94712 | nuclear_norm = 1101.90833
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 33.69901 | spectral_norm = 2.83567 | nuclear_norm = 779.68488
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 34.32999 | spectral_norm = 2.89098 | nuclear_norm = 794.60364
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 89.37553 | spectral_norm = 8.05611 | nuclear_norm = 1997.91089
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 92.21256 | spectral_norm = 8.22451 | nuclear_norm = 2201.19604
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 82.43547 | spectral_norm = 5.63612 | nuclear_norm = 2176.93213
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 41.83633 | spectral_norm = 2.89584 | nuclear_norm = 1099.90479
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 33.98465 | spectral_norm = 2.89699 | nuclear_norm = 788.11707
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 34.52228 | spectral_norm = 2.92369 | nuclear_norm = 800.98767
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 84.63419 | spectral_norm = 7.70790 | nuclear_norm = 1889.56189
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 92.50710 | spectral_norm = 7.97694 | nuclear_norm = 2224.12500
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 82.65612 | spectral_norm = 5.83184 | nuclear_norm = 2182.79248
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 41.70060 | spectral_norm = 2.87099 | nuclear_norm = 1094.90088
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 33.93211 | spectral_norm = 2.92820 | nuclear_norm = 780.13123
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 34.35867 | spectral_norm = 3.06836 | nuclear_norm = 789.24146
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 86.63557 | spectral_norm = 7.49663 | nuclear_norm = 1952.50195
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 95.15120 | spectral_norm = 7.63757 | nuclear_norm = 2292.83350
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 82.29623 | spectral_norm = 5.90986 | nuclear_norm = 2176.64453
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 41.04121 | spectral_norm = 2.83553 | nuclear_norm = 1076.78394
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 34.35012 | spectral_norm = 3.01647 | nuclear_norm = 797.67072
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 34.54856 | spectral_norm = 3.06869 | nuclear_norm = 802.06146
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 79.25008 | spectral_norm = 7.35542 | nuclear_norm = 1768.88184
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 89.41973 | spectral_norm = 6.79108 | nuclear_norm = 2148.03516
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 81.49220 | spectral_norm = 6.23070 | nuclear_norm = 2153.74634
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 40.08410 | spectral_norm = 2.85152 | nuclear_norm = 1047.50549
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 385.15991 | spectral_norm = 132.56334 | nuclear_norm = 9184.43066
===========================================
step:126/1750 train_loss:4.4319 train_time:38566ms step_avg:332.47ms
step:127/1750 train_loss:4.4624 train_time:38898ms step_avg:332.46ms
step:128/1750 train_loss:4.3956 train_time:39231ms step_avg:332.47ms
step:129/1750 train_loss:4.6922 train_time:39563ms step_avg:332.46ms
step:130/1750 train_loss:4.3909 train_time:39897ms step_avg:332.48ms
step:131/1750 train_loss:4.4291 train_time:40236ms step_avg:332.53ms
step:132/1750 train_loss:4.3626 train_time:40579ms step_avg:332.62ms
step:133/1750 train_loss:4.4576 train_time:40924ms step_avg:332.71ms
step:134/1750 train_loss:4.2752 train_time:41269ms step_avg:332.82ms
step:135/1750 train_loss:4.4503 train_time:41613ms step_avg:332.91ms
step:136/1750 train_loss:4.2145 train_time:41958ms step_avg:333.00ms
step:137/1750 train_loss:4.3830 train_time:42302ms step_avg:333.09ms
step:138/1750 train_loss:4.2798 train_time:42647ms step_avg:333.18ms
step:139/1750 train_loss:4.3840 train_time:42992ms step_avg:333.27ms
step:140/1750 train_loss:4.4804 train_time:43336ms step_avg:333.35ms
step:141/1750 train_loss:4.3090 train_time:43680ms step_avg:333.43ms
step:142/1750 train_loss:4.2912 train_time:44024ms step_avg:333.51ms
step:143/1750 train_loss:4.2501 train_time:44368ms step_avg:333.59ms
step:144/1750 train_loss:4.3430 train_time:44712ms step_avg:333.67ms
step:145/1750 train_loss:4.2961 train_time:45056ms step_avg:333.75ms
step:146/1750 train_loss:4.1668 train_time:45401ms step_avg:333.83ms
step:147/1750 train_loss:4.3155 train_time:45744ms step_avg:333.90ms
step:148/1750 train_loss:4.3670 train_time:46089ms step_avg:333.98ms
step:149/1750 train_loss:4.3170 train_time:46436ms step_avg:334.07ms
step:150/1750 train_loss:4.4488 train_time:46780ms step_avg:334.14ms
step:151/1750 train_loss:4.2742 train_time:47126ms step_avg:334.23ms
step:152/1750 train_loss:4.2676 train_time:47471ms step_avg:334.30ms
step:153/1750 train_loss:4.3759 train_time:47818ms step_avg:334.39ms
step:154/1750 train_loss:4.3622 train_time:48162ms step_avg:334.46ms
step:155/1750 train_loss:4.2592 train_time:48506ms step_avg:334.52ms
step:156/1750 train_loss:4.3419 train_time:48851ms step_avg:334.59ms
step:157/1750 train_loss:4.4025 train_time:49195ms step_avg:334.66ms
step:158/1750 train_loss:4.2449 train_time:49540ms step_avg:334.73ms
step:159/1750 train_loss:4.3051 train_time:49884ms step_avg:334.79ms
step:160/1750 train_loss:4.1147 train_time:50230ms step_avg:334.86ms
step:161/1750 train_loss:4.3666 train_time:50575ms step_avg:334.93ms
step:162/1750 train_loss:4.3552 train_time:50921ms step_avg:335.00ms
step:163/1750 train_loss:4.3328 train_time:51266ms step_avg:335.07ms
step:164/1750 train_loss:4.1902 train_time:51610ms step_avg:335.13ms
step:165/1750 train_loss:4.2914 train_time:51956ms step_avg:335.20ms
step:166/1750 train_loss:4.3696 train_time:52300ms step_avg:335.26ms
step:167/1750 train_loss:4.2175 train_time:52644ms step_avg:335.31ms
step:168/1750 train_loss:4.2821 train_time:52988ms step_avg:335.37ms
step:169/1750 train_loss:4.1523 train_time:53333ms step_avg:335.43ms
step:170/1750 train_loss:4.0210 train_time:53678ms step_avg:335.49ms
step:171/1750 train_loss:4.2046 train_time:54025ms step_avg:335.56ms
step:172/1750 train_loss:4.2148 train_time:54370ms step_avg:335.62ms
step:173/1750 train_loss:4.2807 train_time:54716ms step_avg:335.68ms
step:174/1750 train_loss:4.4318 train_time:55062ms step_avg:335.74ms
step:175/1750 train_loss:4.2634 train_time:55407ms step_avg:335.80ms
step:176/1750 train_loss:4.1048 train_time:55752ms step_avg:335.85ms
step:177/1750 train_loss:4.0720 train_time:56096ms step_avg:335.90ms
step:178/1750 train_loss:4.1829 train_time:56441ms step_avg:335.96ms
step:179/1750 train_loss:4.1314 train_time:56786ms step_avg:336.01ms
step:180/1750 train_loss:4.1148 train_time:57133ms step_avg:336.07ms
step:181/1750 train_loss:4.3030 train_time:57476ms step_avg:336.12ms
step:182/1750 train_loss:4.1696 train_time:57820ms step_avg:336.16ms
step:183/1750 train_loss:4.1321 train_time:58167ms step_avg:336.23ms
step:184/1750 train_loss:4.1353 train_time:58511ms step_avg:336.27ms
step:185/1750 train_loss:4.2154 train_time:58858ms step_avg:336.33ms
step:186/1750 train_loss:4.1840 train_time:59204ms step_avg:336.39ms
step:187/1750 train_loss:4.2479 train_time:59551ms step_avg:336.44ms
step:188/1750 train_loss:4.1657 train_time:59945ms step_avg:336.77ms
step:189/1750 train_loss:4.1221 train_time:60510ms step_avg:338.05ms
step:190/1750 train_loss:4.2263 train_time:60895ms step_avg:338.31ms
step:191/1750 train_loss:4.1124 train_time:61240ms step_avg:338.34ms
step:192/1750 train_loss:4.0405 train_time:61588ms step_avg:338.39ms
step:193/1750 train_loss:4.2646 train_time:61934ms step_avg:338.44ms
step:194/1750 train_loss:4.1905 train_time:62279ms step_avg:338.47ms
step:195/1750 train_loss:4.3725 train_time:62624ms step_avg:338.51ms
step:196/1750 train_loss:4.1883 train_time:62969ms step_avg:338.54ms
step:197/1750 train_loss:4.0598 train_time:63312ms step_avg:338.57ms
step:198/1750 train_loss:4.1860 train_time:63656ms step_avg:338.59ms
step:199/1750 train_loss:4.0364 train_time:63998ms step_avg:338.61ms
step:200/1750 train_loss:4.1102 train_time:64345ms step_avg:338.66ms
step:201/1750 train_loss:4.0096 train_time:64685ms step_avg:338.67ms
step:202/1750 train_loss:4.2630 train_time:65029ms step_avg:338.70ms
step:203/1750 train_loss:4.0617 train_time:65372ms step_avg:338.72ms
step:204/1750 train_loss:4.2007 train_time:65716ms step_avg:338.74ms
step:205/1750 train_loss:4.2480 train_time:66060ms step_avg:338.77ms
step:206/1750 train_loss:3.9441 train_time:66404ms step_avg:338.80ms
step:207/1750 train_loss:4.0864 train_time:66748ms step_avg:338.82ms
step:208/1750 train_loss:4.0888 train_time:67092ms step_avg:338.85ms
step:209/1750 train_loss:4.2389 train_time:67436ms step_avg:338.87ms
step:210/1750 train_loss:4.1766 train_time:67779ms step_avg:338.90ms
step:211/1750 train_loss:4.0579 train_time:68121ms step_avg:338.91ms
step:212/1750 train_loss:4.1128 train_time:68465ms step_avg:338.93ms
step:213/1750 train_loss:4.0444 train_time:68808ms step_avg:338.96ms
step:214/1750 train_loss:4.1093 train_time:69151ms step_avg:338.98ms
step:215/1750 train_loss:3.9465 train_time:69494ms step_avg:338.99ms
step:216/1750 train_loss:4.0023 train_time:69836ms step_avg:339.01ms
step:217/1750 train_loss:4.0008 train_time:70179ms step_avg:339.03ms
step:218/1750 train_loss:4.0836 train_time:70522ms step_avg:339.05ms
step:219/1750 train_loss:4.0694 train_time:70866ms step_avg:339.07ms
step:220/1750 train_loss:4.0785 train_time:71210ms step_avg:339.10ms
step:221/1750 train_loss:4.1031 train_time:71554ms step_avg:339.12ms
step:222/1750 train_loss:3.9965 train_time:71896ms step_avg:339.13ms
step:223/1750 train_loss:3.9869 train_time:72240ms step_avg:339.16ms
step:224/1750 train_loss:4.3021 train_time:72585ms step_avg:339.18ms
step:225/1750 train_loss:3.9030 train_time:72929ms step_avg:339.20ms
step:226/1750 train_loss:3.9851 train_time:73272ms step_avg:339.22ms
step:227/1750 train_loss:3.9807 train_time:73615ms step_avg:339.24ms
step:228/1750 train_loss:4.1461 train_time:73959ms step_avg:339.26ms
step:229/1750 train_loss:3.9325 train_time:74304ms step_avg:339.29ms
step:230/1750 train_loss:4.0505 train_time:74646ms step_avg:339.30ms
step:231/1750 train_loss:3.9005 train_time:74989ms step_avg:339.32ms
step:232/1750 train_loss:3.9725 train_time:75333ms step_avg:339.34ms
step:233/1750 train_loss:4.0898 train_time:75676ms step_avg:339.35ms
step:234/1750 train_loss:4.0327 train_time:76018ms step_avg:339.36ms
step:235/1750 train_loss:3.9135 train_time:76363ms step_avg:339.39ms
step:236/1750 train_loss:4.0960 train_time:76706ms step_avg:339.41ms
step:237/1750 train_loss:4.0918 train_time:77051ms step_avg:339.43ms
step:238/1750 train_loss:3.9419 train_time:77395ms step_avg:339.45ms
step:239/1750 train_loss:4.0872 train_time:77738ms step_avg:339.47ms
step:240/1750 train_loss:4.1178 train_time:78081ms step_avg:339.48ms
step:241/1750 train_loss:3.9762 train_time:78424ms step_avg:339.50ms
step:242/1750 train_loss:4.1537 train_time:78768ms step_avg:339.52ms
step:243/1750 train_loss:4.0214 train_time:79111ms step_avg:339.53ms
step:244/1750 train_loss:4.0864 train_time:79457ms step_avg:339.56ms
step:245/1750 train_loss:4.1513 train_time:79802ms step_avg:339.58ms
step:246/1750 train_loss:4.0718 train_time:80146ms step_avg:339.60ms
step:247/1750 train_loss:4.0191 train_time:80488ms step_avg:339.61ms
step:248/1750 train_loss:4.1214 train_time:80832ms step_avg:339.63ms
step:249/1750 train_loss:3.9381 train_time:81175ms step_avg:339.64ms
step:250/1750 train_loss:3.9849 train_time:81518ms step_avg:339.66ms
step:250/1750 val_loss:4.0152 train_time:81603ms step_avg:340.01ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 157.40150 | frobenius_norm = 35960.85547 | spectral_norm = 7556.33838 | nuclear_norm = 885023.68750
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 58.89355 | spectral_norm = 6.33249 | nuclear_norm = 1380.45642
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 57.55993 | spectral_norm = 8.34356 | nuclear_norm = 1343.03027
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 128.24478 | spectral_norm = 8.29608 | nuclear_norm = 3038.41016
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 118.21483 | spectral_norm = 10.22280 | nuclear_norm = 2780.82715
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 121.91781 | spectral_norm = 9.14273 | nuclear_norm = 3237.18799
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 63.70675 | spectral_norm = 4.63649 | nuclear_norm = 1689.83691
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 57.83227 | spectral_norm = 5.02642 | nuclear_norm = 1355.39722
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 56.47985 | spectral_norm = 6.35921 | nuclear_norm = 1321.97607
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 141.68237 | spectral_norm = 11.30086 | nuclear_norm = 3288.62402
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 138.17645 | spectral_norm = 11.09184 | nuclear_norm = 3265.47949
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 131.93222 | spectral_norm = 8.66347 | nuclear_norm = 3506.48169
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 66.26478 | spectral_norm = 5.22203 | nuclear_norm = 1750.98438
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 56.55410 | spectral_norm = 5.14974 | nuclear_norm = 1324.40271
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 55.59039 | spectral_norm = 5.87037 | nuclear_norm = 1298.71826
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 132.79071 | spectral_norm = 10.84097 | nuclear_norm = 3043.43164
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 140.76306 | spectral_norm = 10.81908 | nuclear_norm = 3311.55859
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 134.19395 | spectral_norm = 9.00299 | nuclear_norm = 3563.89917
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 67.29719 | spectral_norm = 5.39832 | nuclear_norm = 1778.82654
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 56.16903 | spectral_norm = 4.64140 | nuclear_norm = 1288.11572
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 56.59370 | spectral_norm = 4.62863 | nuclear_norm = 1304.20422
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 140.01796 | spectral_norm = 11.73825 | nuclear_norm = 3193.93652
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 143.73186 | spectral_norm = 10.54228 | nuclear_norm = 3403.52954
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 132.63689 | spectral_norm = 9.22475 | nuclear_norm = 3524.70337
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 66.47618 | spectral_norm = 5.09979 | nuclear_norm = 1757.55493
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 56.33765 | spectral_norm = 4.82231 | nuclear_norm = 1308.90039
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 56.42167 | spectral_norm = 4.79679 | nuclear_norm = 1314.19849
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 135.33319 | spectral_norm = 11.82700 | nuclear_norm = 3061.21704
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 138.54271 | spectral_norm = 10.73968 | nuclear_norm = 3264.62549
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 137.04254 | spectral_norm = 9.41820 | nuclear_norm = 3635.68042
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 67.36680 | spectral_norm = 5.22195 | nuclear_norm = 1776.39087
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 55.86012 | spectral_norm = 4.82757 | nuclear_norm = 1299.28882
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 55.88689 | spectral_norm = 4.99911 | nuclear_norm = 1301.36450
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 133.82079 | spectral_norm = 11.40869 | nuclear_norm = 3050.18506
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 135.47739 | spectral_norm = 10.17598 | nuclear_norm = 3193.42627
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 135.95184 | spectral_norm = 8.84679 | nuclear_norm = 3610.16504
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 66.67853 | spectral_norm = 5.23319 | nuclear_norm = 1758.30713
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 55.53137 | spectral_norm = 5.01828 | nuclear_norm = 1292.69946
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 55.52680 | spectral_norm = 4.66449 | nuclear_norm = 1294.53101
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 138.46568 | spectral_norm = 11.54146 | nuclear_norm = 3143.84155
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 136.33850 | spectral_norm = 10.49279 | nuclear_norm = 3213.53271
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 132.22119 | spectral_norm = 9.47961 | nuclear_norm = 3505.63477
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 65.77061 | spectral_norm = 5.21205 | nuclear_norm = 1730.81152
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 55.29930 | spectral_norm = 4.69672 | nuclear_norm = 1284.40430
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 55.41009 | spectral_norm = 4.62948 | nuclear_norm = 1285.27979
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 135.69908 | spectral_norm = 11.44934 | nuclear_norm = 3093.37988
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 140.43626 | spectral_norm = 10.20579 | nuclear_norm = 3336.53906
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 132.48036 | spectral_norm = 9.50300 | nuclear_norm = 3511.11816
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 65.81560 | spectral_norm = 5.26310 | nuclear_norm = 1734.61267
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 56.29907 | spectral_norm = 4.88651 | nuclear_norm = 1301.52673
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 56.28620 | spectral_norm = 4.72440 | nuclear_norm = 1298.16687
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 147.27591 | spectral_norm = 12.16520 | nuclear_norm = 3388.57861
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 145.80121 | spectral_norm = 10.79597 | nuclear_norm = 3447.77637
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 132.41986 | spectral_norm = 9.51472 | nuclear_norm = 3509.89087
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 65.82021 | spectral_norm = 5.29428 | nuclear_norm = 1736.70435
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 56.79062 | spectral_norm = 4.79967 | nuclear_norm = 1318.46069
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 56.47300 | spectral_norm = 4.80673 | nuclear_norm = 1308.95056
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 139.95662 | spectral_norm = 11.55138 | nuclear_norm = 3214.75806
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 144.37100 | spectral_norm = 10.42374 | nuclear_norm = 3444.73584
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 133.55339 | spectral_norm = 9.79438 | nuclear_norm = 3541.96094
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 66.11768 | spectral_norm = 5.31118 | nuclear_norm = 1744.11328
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 56.20522 | spectral_norm = 5.27041 | nuclear_norm = 1286.95654
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 55.85487 | spectral_norm = 5.26108 | nuclear_norm = 1270.33105
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 144.49591 | spectral_norm = 11.35663 | nuclear_norm = 3343.61768
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 153.54688 | spectral_norm = 10.41024 | nuclear_norm = 3661.42578
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 132.35457 | spectral_norm = 9.40808 | nuclear_norm = 3515.50659
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 65.87908 | spectral_norm = 5.31799 | nuclear_norm = 1739.14795
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 57.35343 | spectral_norm = 5.37182 | nuclear_norm = 1331.98828
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 56.75690 | spectral_norm = 5.20833 | nuclear_norm = 1313.40723
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 129.65631 | spectral_norm = 10.35693 | nuclear_norm = 2980.49414
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 144.11154 | spectral_norm = 9.88962 | nuclear_norm = 3423.79150
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 133.45384 | spectral_norm = 9.54844 | nuclear_norm = 3541.88525
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 65.59570 | spectral_norm = 5.46187 | nuclear_norm = 1724.14050
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 551.30261 | spectral_norm = 150.42422 | nuclear_norm = 13751.38086
===========================================
step:251/1750 train_loss:4.0853 train_time:81856ms step_avg:339.65ms
step:252/1750 train_loss:4.1788 train_time:82196ms step_avg:339.65ms
step:253/1750 train_loss:3.9469 train_time:82538ms step_avg:339.66ms
step:254/1750 train_loss:3.8882 train_time:82878ms step_avg:339.66ms
step:255/1750 train_loss:4.0720 train_time:83218ms step_avg:339.66ms
step:256/1750 train_loss:3.9875 train_time:83561ms step_avg:339.68ms
step:257/1750 train_loss:3.9966 train_time:83904ms step_avg:339.69ms
step:258/1750 train_loss:3.9974 train_time:84244ms step_avg:339.69ms
step:259/1750 train_loss:4.0395 train_time:84586ms step_avg:339.70ms
step:260/1750 train_loss:4.0734 train_time:84928ms step_avg:339.71ms
step:261/1750 train_loss:4.0221 train_time:85277ms step_avg:339.75ms
step:262/1750 train_loss:3.9915 train_time:85631ms step_avg:339.81ms
step:263/1750 train_loss:3.8948 train_time:85984ms step_avg:339.86ms
step:264/1750 train_loss:3.9968 train_time:86336ms step_avg:339.90ms
step:265/1750 train_loss:3.8736 train_time:86689ms step_avg:339.96ms
step:266/1750 train_loss:3.9247 train_time:87041ms step_avg:340.00ms
step:267/1750 train_loss:3.9212 train_time:87394ms step_avg:340.05ms
step:268/1750 train_loss:3.9620 train_time:87747ms step_avg:340.10ms
step:269/1750 train_loss:3.8626 train_time:88100ms step_avg:340.15ms
step:270/1750 train_loss:4.0998 train_time:88452ms step_avg:340.20ms
step:271/1750 train_loss:3.9682 train_time:88805ms step_avg:340.25ms
step:272/1750 train_loss:3.9240 train_time:89157ms step_avg:340.29ms
step:273/1750 train_loss:3.9506 train_time:89506ms step_avg:340.33ms
step:274/1750 train_loss:4.0449 train_time:89860ms step_avg:340.38ms
step:275/1750 train_loss:4.0639 train_time:90212ms step_avg:340.42ms
step:276/1750 train_loss:4.2265 train_time:90562ms step_avg:340.46ms
step:277/1750 train_loss:4.0298 train_time:90913ms step_avg:340.50ms
step:278/1750 train_loss:4.0798 train_time:91267ms step_avg:340.55ms
step:279/1750 train_loss:3.9954 train_time:91619ms step_avg:340.59ms
step:280/1750 train_loss:4.2010 train_time:91973ms step_avg:340.64ms
step:281/1750 train_loss:3.9706 train_time:92326ms step_avg:340.69ms
step:282/1750 train_loss:3.9342 train_time:92681ms step_avg:340.74ms
step:283/1750 train_loss:3.9121 train_time:93033ms step_avg:340.78ms
step:284/1750 train_loss:4.0418 train_time:93384ms step_avg:340.82ms
step:285/1750 train_loss:4.0644 train_time:93736ms step_avg:340.86ms
step:286/1750 train_loss:4.0916 train_time:94089ms step_avg:340.90ms
step:287/1750 train_loss:3.9134 train_time:94443ms step_avg:340.95ms
step:288/1750 train_loss:4.0218 train_time:94796ms step_avg:340.99ms
step:289/1750 train_loss:3.8891 train_time:95149ms step_avg:341.03ms
step:290/1750 train_loss:3.8541 train_time:95503ms step_avg:341.08ms
step:291/1750 train_loss:3.9092 train_time:95856ms step_avg:341.12ms
step:292/1750 train_loss:3.8614 train_time:96207ms step_avg:341.16ms
step:293/1750 train_loss:3.9109 train_time:96559ms step_avg:341.20ms
step:294/1750 train_loss:3.9474 train_time:96910ms step_avg:341.23ms
step:295/1750 train_loss:3.8450 train_time:97262ms step_avg:341.27ms
step:296/1750 train_loss:3.8698 train_time:97617ms step_avg:341.32ms
step:297/1750 train_loss:3.8699 train_time:97970ms step_avg:341.36ms
step:298/1750 train_loss:3.9897 train_time:98321ms step_avg:341.39ms
step:299/1750 train_loss:3.8227 train_time:98673ms step_avg:341.43ms
step:300/1750 train_loss:3.9681 train_time:99030ms step_avg:341.48ms
step:301/1750 train_loss:3.9793 train_time:99379ms step_avg:341.51ms
step:302/1750 train_loss:3.9379 train_time:99731ms step_avg:341.54ms
step:303/1750 train_loss:3.9875 train_time:100083ms step_avg:341.58ms
step:304/1750 train_loss:3.9738 train_time:100435ms step_avg:341.61ms
step:305/1750 train_loss:4.4713 train_time:100786ms step_avg:341.65ms
step:306/1750 train_loss:3.9436 train_time:101138ms step_avg:341.68ms
step:307/1750 train_loss:3.8450 train_time:101492ms step_avg:341.72ms
step:308/1750 train_loss:3.9888 train_time:101844ms step_avg:341.76ms
step:309/1750 train_loss:3.8740 train_time:102195ms step_avg:341.79ms
step:310/1750 train_loss:4.0911 train_time:102547ms step_avg:341.82ms
step:311/1750 train_loss:3.9295 train_time:102902ms step_avg:341.87ms
step:312/1750 train_loss:3.8627 train_time:103255ms step_avg:341.90ms
step:313/1750 train_loss:3.9472 train_time:103608ms step_avg:341.94ms
step:314/1750 train_loss:4.0714 train_time:103962ms step_avg:341.98ms
step:315/1750 train_loss:3.9512 train_time:104315ms step_avg:342.02ms
step:316/1750 train_loss:3.8001 train_time:104668ms step_avg:342.05ms
step:317/1750 train_loss:3.8797 train_time:105024ms step_avg:342.10ms
step:318/1750 train_loss:3.9322 train_time:105375ms step_avg:342.13ms
step:319/1750 train_loss:3.8927 train_time:105727ms step_avg:342.16ms
step:320/1750 train_loss:4.0186 train_time:106081ms step_avg:342.20ms
step:321/1750 train_loss:3.9694 train_time:106435ms step_avg:342.23ms
step:322/1750 train_loss:3.9418 train_time:106788ms step_avg:342.27ms
step:323/1750 train_loss:4.0059 train_time:107140ms step_avg:342.30ms
step:324/1750 train_loss:3.9597 train_time:107493ms step_avg:342.33ms
step:325/1750 train_loss:4.0236 train_time:107844ms step_avg:342.36ms
step:326/1750 train_loss:3.8997 train_time:108196ms step_avg:342.39ms
step:327/1750 train_loss:4.4142 train_time:108548ms step_avg:342.42ms
step:328/1750 train_loss:4.0786 train_time:108900ms step_avg:342.45ms
step:329/1750 train_loss:3.8050 train_time:109251ms step_avg:342.48ms
step:330/1750 train_loss:3.7608 train_time:109600ms step_avg:342.50ms
step:331/1750 train_loss:3.9905 train_time:109948ms step_avg:342.52ms
step:332/1750 train_loss:3.9144 train_time:110298ms step_avg:342.54ms
step:333/1750 train_loss:3.8872 train_time:110647ms step_avg:342.56ms
step:334/1750 train_loss:3.8493 train_time:110996ms step_avg:342.58ms
step:335/1750 train_loss:4.0063 train_time:111348ms step_avg:342.61ms
step:336/1750 train_loss:3.9669 train_time:111697ms step_avg:342.63ms
step:337/1750 train_loss:4.4201 train_time:112046ms step_avg:342.65ms
step:338/1750 train_loss:3.9508 train_time:112394ms step_avg:342.67ms
step:339/1750 train_loss:3.8698 train_time:112745ms step_avg:342.69ms
step:340/1750 train_loss:3.9375 train_time:113096ms step_avg:342.72ms
step:341/1750 train_loss:3.8592 train_time:113447ms step_avg:342.74ms
step:342/1750 train_loss:3.8195 train_time:113797ms step_avg:342.76ms
step:343/1750 train_loss:3.8441 train_time:114147ms step_avg:342.78ms
step:344/1750 train_loss:4.0022 train_time:114495ms step_avg:342.80ms
step:345/1750 train_loss:3.8232 train_time:114847ms step_avg:342.83ms
step:346/1750 train_loss:3.7735 train_time:115196ms step_avg:342.85ms
step:347/1750 train_loss:3.7957 train_time:115548ms step_avg:342.87ms
step:348/1750 train_loss:3.8603 train_time:115899ms step_avg:342.90ms
step:349/1750 train_loss:3.8333 train_time:116250ms step_avg:342.92ms
step:350/1750 train_loss:3.5737 train_time:116601ms step_avg:342.94ms
step:351/1750 train_loss:3.8255 train_time:116951ms step_avg:342.96ms
step:352/1750 train_loss:4.1770 train_time:117300ms step_avg:342.98ms
step:353/1750 train_loss:3.6627 train_time:117648ms step_avg:343.00ms
step:354/1750 train_loss:3.9255 train_time:117996ms step_avg:343.01ms
step:355/1750 train_loss:3.7928 train_time:118346ms step_avg:343.03ms
step:356/1750 train_loss:3.8906 train_time:118695ms step_avg:343.05ms
step:357/1750 train_loss:3.7730 train_time:119046ms step_avg:343.07ms
step:358/1750 train_loss:3.8584 train_time:119397ms step_avg:343.10ms
step:359/1750 train_loss:3.7827 train_time:119749ms step_avg:343.12ms
step:360/1750 train_loss:3.4299 train_time:120101ms step_avg:343.15ms
step:361/1750 train_loss:4.0347 train_time:120452ms step_avg:343.17ms
step:362/1750 train_loss:3.9252 train_time:120800ms step_avg:343.18ms
step:363/1750 train_loss:3.8514 train_time:121149ms step_avg:343.20ms
step:364/1750 train_loss:3.7514 train_time:121499ms step_avg:343.22ms
step:365/1750 train_loss:3.9217 train_time:121849ms step_avg:343.24ms
step:366/1750 train_loss:3.8694 train_time:122201ms step_avg:343.26ms
step:367/1750 train_loss:3.8645 train_time:122551ms step_avg:343.28ms
step:368/1750 train_loss:3.8531 train_time:122899ms step_avg:343.29ms
step:369/1750 train_loss:3.7576 train_time:123250ms step_avg:343.31ms
step:370/1750 train_loss:3.8984 train_time:123599ms step_avg:343.33ms
step:371/1750 train_loss:3.7389 train_time:123949ms step_avg:343.35ms
step:372/1750 train_loss:3.6921 train_time:124299ms step_avg:343.37ms
step:373/1750 train_loss:3.9273 train_time:124649ms step_avg:343.39ms
step:374/1750 train_loss:3.8378 train_time:124999ms step_avg:343.40ms
step:375/1750 train_loss:3.8092 train_time:125351ms step_avg:343.43ms
step:375/1750 val_loss:3.8342 train_time:125441ms step_avg:343.67ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 185.24785 | frobenius_norm = 42409.22656 | spectral_norm = 8297.57617 | nuclear_norm = 1050259.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 83.77348 | spectral_norm = 10.47089 | nuclear_norm = 1960.43506
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 82.07664 | spectral_norm = 12.43445 | nuclear_norm = 1910.53027
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 166.94582 | spectral_norm = 10.59113 | nuclear_norm = 3978.81738
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 146.58170 | spectral_norm = 12.65746 | nuclear_norm = 3434.00928
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 174.56564 | spectral_norm = 13.47160 | nuclear_norm = 4637.44824
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 90.09980 | spectral_norm = 6.70961 | nuclear_norm = 2391.85547
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 83.37434 | spectral_norm = 7.40016 | nuclear_norm = 1954.18518
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 81.88314 | spectral_norm = 8.81509 | nuclear_norm = 1916.21448
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 175.68811 | spectral_norm = 14.59287 | nuclear_norm = 4069.41138
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 171.02901 | spectral_norm = 12.72971 | nuclear_norm = 4028.18018
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 183.21107 | spectral_norm = 12.43072 | nuclear_norm = 4872.81006
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 90.57610 | spectral_norm = 7.71741 | nuclear_norm = 2385.64453
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 81.83915 | spectral_norm = 7.75761 | nuclear_norm = 1914.12036
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 80.55725 | spectral_norm = 8.25035 | nuclear_norm = 1882.50879
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 166.27458 | spectral_norm = 13.81284 | nuclear_norm = 3797.42261
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 174.39279 | spectral_norm = 12.92325 | nuclear_norm = 4074.60254
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 187.19513 | spectral_norm = 12.92928 | nuclear_norm = 4975.13232
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 93.24745 | spectral_norm = 8.14089 | nuclear_norm = 2459.66504
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 80.90900 | spectral_norm = 6.79747 | nuclear_norm = 1849.88135
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 81.28966 | spectral_norm = 6.60430 | nuclear_norm = 1864.69873
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 177.39600 | spectral_norm = 15.02434 | nuclear_norm = 4041.04346
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 182.75485 | spectral_norm = 13.48697 | nuclear_norm = 4314.83398
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 185.55655 | spectral_norm = 13.56601 | nuclear_norm = 4938.19922
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 91.72276 | spectral_norm = 7.42007 | nuclear_norm = 2421.61157
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 81.96557 | spectral_norm = 7.27663 | nuclear_norm = 1905.29016
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 81.68103 | spectral_norm = 7.00626 | nuclear_norm = 1902.52588
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 173.93996 | spectral_norm = 15.78782 | nuclear_norm = 3926.13599
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 176.92874 | spectral_norm = 13.83600 | nuclear_norm = 4144.84863
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 192.53424 | spectral_norm = 13.90951 | nuclear_norm = 5112.26416
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 92.81908 | spectral_norm = 7.57663 | nuclear_norm = 2442.54248
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 80.95266 | spectral_norm = 7.26693 | nuclear_norm = 1882.37061
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 80.48028 | spectral_norm = 7.56583 | nuclear_norm = 1872.82605
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 173.68146 | spectral_norm = 14.91126 | nuclear_norm = 3969.18066
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 173.27216 | spectral_norm = 12.93599 | nuclear_norm = 4075.05029
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 192.64342 | spectral_norm = 12.92592 | nuclear_norm = 5125.44434
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 92.83518 | spectral_norm = 7.47472 | nuclear_norm = 2444.20264
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 80.87290 | spectral_norm = 7.32609 | nuclear_norm = 1877.94019
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 80.29704 | spectral_norm = 6.94569 | nuclear_norm = 1868.63794
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 179.40456 | spectral_norm = 15.12861 | nuclear_norm = 4075.08154
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 175.03381 | spectral_norm = 13.41127 | nuclear_norm = 4112.46094
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 186.30339 | spectral_norm = 13.69365 | nuclear_norm = 4954.69434
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 91.79836 | spectral_norm = 7.43492 | nuclear_norm = 2416.49390
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 81.05216 | spectral_norm = 7.13880 | nuclear_norm = 1881.55420
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 80.28978 | spectral_norm = 6.93494 | nuclear_norm = 1860.82275
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 176.15938 | spectral_norm = 15.04433 | nuclear_norm = 4017.49854
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 178.14047 | spectral_norm = 12.97318 | nuclear_norm = 4208.24170
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 186.88058 | spectral_norm = 13.76913 | nuclear_norm = 4966.85889
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 92.75526 | spectral_norm = 7.60585 | nuclear_norm = 2448.78857
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 82.26065 | spectral_norm = 7.43740 | nuclear_norm = 1894.35352
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 81.84087 | spectral_norm = 7.15044 | nuclear_norm = 1875.81238
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 190.85182 | spectral_norm = 16.16197 | nuclear_norm = 4386.59424
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 186.70462 | spectral_norm = 13.89270 | nuclear_norm = 4385.69043
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 185.54443 | spectral_norm = 13.59245 | nuclear_norm = 4929.65332
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 92.79475 | spectral_norm = 7.77249 | nuclear_norm = 2453.64600
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 83.39968 | spectral_norm = 7.22870 | nuclear_norm = 1931.79187
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 82.48033 | spectral_norm = 7.18268 | nuclear_norm = 1906.77637
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 180.73541 | spectral_norm = 15.55256 | nuclear_norm = 4149.09570
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 181.93282 | spectral_norm = 13.33776 | nuclear_norm = 4316.99902
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 188.36949 | spectral_norm = 14.27597 | nuclear_norm = 5006.82324
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 93.18776 | spectral_norm = 7.93535 | nuclear_norm = 2462.56763
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 82.17085 | spectral_norm = 8.10707 | nuclear_norm = 1875.85706
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 81.25645 | spectral_norm = 7.86875 | nuclear_norm = 1837.96924
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 185.06912 | spectral_norm = 15.52055 | nuclear_norm = 4285.12061
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 195.12376 | spectral_norm = 13.22637 | nuclear_norm = 4626.85645
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 186.82101 | spectral_norm = 12.99704 | nuclear_norm = 4976.36621
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 91.30902 | spectral_norm = 8.40254 | nuclear_norm = 2413.22852
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 84.50880 | spectral_norm = 8.33831 | nuclear_norm = 1961.98975
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 82.88514 | spectral_norm = 7.89494 | nuclear_norm = 1915.86865
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 166.17218 | spectral_norm = 14.10282 | nuclear_norm = 3830.35986
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 183.37425 | spectral_norm = 12.88334 | nuclear_norm = 4332.65479
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 192.26999 | spectral_norm = 14.28977 | nuclear_norm = 5115.12939
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 93.45256 | spectral_norm = 8.57593 | nuclear_norm = 2460.85083
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 691.06525 | spectral_norm = 158.56999 | nuclear_norm = 17574.93945
===========================================
step:376/1750 train_loss:3.8738 train_time:125700ms step_avg:343.44ms
step:377/1750 train_loss:3.7935 train_time:126093ms step_avg:343.58ms
step:378/1750 train_loss:3.8511 train_time:126531ms step_avg:343.83ms
step:379/1750 train_loss:3.8745 train_time:127021ms step_avg:344.23ms
step:380/1750 train_loss:3.9683 train_time:127379ms step_avg:344.27ms
step:381/1750 train_loss:3.8503 train_time:127724ms step_avg:344.27ms
step:382/1750 train_loss:3.8207 train_time:128073ms step_avg:344.28ms
step:383/1750 train_loss:3.7998 train_time:128423ms step_avg:344.30ms
step:384/1750 train_loss:3.8788 train_time:128772ms step_avg:344.31ms
step:385/1750 train_loss:3.8017 train_time:129121ms step_avg:344.32ms
step:386/1750 train_loss:3.9049 train_time:129468ms step_avg:344.33ms
step:387/1750 train_loss:4.0769 train_time:129817ms step_avg:344.34ms
step:388/1750 train_loss:3.8016 train_time:130166ms step_avg:344.35ms
step:389/1750 train_loss:3.8013 train_time:130515ms step_avg:344.37ms
step:390/1750 train_loss:3.9016 train_time:130869ms step_avg:344.39ms
step:391/1750 train_loss:3.8114 train_time:131227ms step_avg:344.43ms
step:392/1750 train_loss:3.9325 train_time:131584ms step_avg:344.46ms
step:393/1750 train_loss:3.7616 train_time:131940ms step_avg:344.49ms
step:394/1750 train_loss:3.8973 train_time:132299ms step_avg:344.53ms
step:395/1750 train_loss:3.6349 train_time:132658ms step_avg:344.57ms
step:396/1750 train_loss:3.8442 train_time:133018ms step_avg:344.61ms
step:397/1750 train_loss:3.8725 train_time:133376ms step_avg:344.64ms
step:398/1750 train_loss:3.8896 train_time:133730ms step_avg:344.67ms
step:399/1750 train_loss:3.7803 train_time:134086ms step_avg:344.69ms
step:400/1750 train_loss:3.8312 train_time:134449ms step_avg:344.74ms
step:401/1750 train_loss:3.9178 train_time:134804ms step_avg:344.77ms
step:402/1750 train_loss:3.8458 train_time:135163ms step_avg:344.80ms
step:403/1750 train_loss:3.9628 train_time:135519ms step_avg:344.83ms
step:404/1750 train_loss:3.6914 train_time:135876ms step_avg:344.86ms
step:405/1750 train_loss:3.7870 train_time:136235ms step_avg:344.90ms
step:406/1750 train_loss:4.0983 train_time:136592ms step_avg:344.93ms
step:407/1750 train_loss:3.7894 train_time:136950ms step_avg:344.96ms
step:408/1750 train_loss:3.8218 train_time:137304ms step_avg:344.98ms
step:409/1750 train_loss:3.8609 train_time:137662ms step_avg:345.02ms
step:410/1750 train_loss:3.7670 train_time:138018ms step_avg:345.05ms
step:411/1750 train_loss:3.7662 train_time:138375ms step_avg:345.07ms
step:412/1750 train_loss:4.1844 train_time:138732ms step_avg:345.10ms
step:413/1750 train_loss:3.6217 train_time:139088ms step_avg:345.13ms
step:414/1750 train_loss:4.0214 train_time:139444ms step_avg:345.16ms
step:415/1750 train_loss:3.7609 train_time:139800ms step_avg:345.19ms
step:416/1750 train_loss:3.7705 train_time:140159ms step_avg:345.22ms
step:417/1750 train_loss:3.9622 train_time:140517ms step_avg:345.25ms
step:418/1750 train_loss:3.6934 train_time:140873ms step_avg:345.28ms
step:419/1750 train_loss:3.8164 train_time:141229ms step_avg:345.30ms
step:420/1750 train_loss:3.7140 train_time:141589ms step_avg:345.34ms
step:421/1750 train_loss:3.6509 train_time:141947ms step_avg:345.37ms
step:422/1750 train_loss:3.7897 train_time:142303ms step_avg:345.40ms
step:423/1750 train_loss:3.8785 train_time:142659ms step_avg:345.42ms
step:424/1750 train_loss:3.6213 train_time:143017ms step_avg:345.45ms
step:425/1750 train_loss:3.8015 train_time:143377ms step_avg:345.49ms
step:426/1750 train_loss:3.6705 train_time:143733ms step_avg:345.51ms
step:427/1750 train_loss:3.8990 train_time:144088ms step_avg:345.54ms
step:428/1750 train_loss:3.8269 train_time:144446ms step_avg:345.56ms
step:429/1750 train_loss:3.7635 train_time:144803ms step_avg:345.59ms
step:430/1750 train_loss:3.7258 train_time:145159ms step_avg:345.62ms
step:431/1750 train_loss:3.6291 train_time:145516ms step_avg:345.64ms
step:432/1750 train_loss:3.7777 train_time:145874ms step_avg:345.67ms
step:433/1750 train_loss:3.8275 train_time:146232ms step_avg:345.70ms
step:434/1750 train_loss:3.7801 train_time:146589ms step_avg:345.73ms
step:435/1750 train_loss:3.8191 train_time:146948ms step_avg:345.76ms
step:436/1750 train_loss:3.8393 train_time:147307ms step_avg:345.79ms
step:437/1750 train_loss:3.7302 train_time:147665ms step_avg:345.82ms
step:438/1750 train_loss:3.7166 train_time:148021ms step_avg:345.84ms
step:439/1750 train_loss:3.7153 train_time:148380ms step_avg:345.87ms
step:440/1750 train_loss:3.9066 train_time:148735ms step_avg:345.90ms
step:441/1750 train_loss:3.7669 train_time:149092ms step_avg:345.92ms
step:442/1750 train_loss:3.7434 train_time:149448ms step_avg:345.94ms
step:443/1750 train_loss:3.6316 train_time:149805ms step_avg:345.97ms
step:444/1750 train_loss:3.9293 train_time:150162ms step_avg:345.99ms
step:445/1750 train_loss:3.8529 train_time:150521ms step_avg:346.03ms
step:446/1750 train_loss:3.8453 train_time:150880ms step_avg:346.05ms
step:447/1750 train_loss:3.7608 train_time:151237ms step_avg:346.08ms
step:448/1750 train_loss:3.8666 train_time:151596ms step_avg:346.11ms
step:449/1750 train_loss:3.7030 train_time:151957ms step_avg:346.14ms
step:450/1750 train_loss:3.7203 train_time:152313ms step_avg:346.17ms
step:451/1750 train_loss:3.5914 train_time:152671ms step_avg:346.19ms
step:452/1750 train_loss:3.7209 train_time:153029ms step_avg:346.22ms
step:453/1750 train_loss:3.6863 train_time:153387ms step_avg:346.25ms
step:454/1750 train_loss:3.6531 train_time:153745ms step_avg:346.27ms
step:455/1750 train_loss:3.8516 train_time:154103ms step_avg:346.30ms
step:456/1750 train_loss:3.7360 train_time:154459ms step_avg:346.32ms
step:457/1750 train_loss:3.7921 train_time:154815ms step_avg:346.34ms
step:458/1750 train_loss:3.8380 train_time:155170ms step_avg:346.36ms
step:459/1750 train_loss:3.6397 train_time:155530ms step_avg:346.39ms
step:460/1750 train_loss:3.8043 train_time:155885ms step_avg:346.41ms
step:461/1750 train_loss:3.6991 train_time:156242ms step_avg:346.43ms
step:462/1750 train_loss:3.7511 train_time:156599ms step_avg:346.46ms
step:463/1750 train_loss:3.7868 train_time:156953ms step_avg:346.48ms
step:464/1750 train_loss:3.7204 train_time:157307ms step_avg:346.49ms
step:465/1750 train_loss:3.7291 train_time:157663ms step_avg:346.51ms
step:466/1750 train_loss:3.8143 train_time:158021ms step_avg:346.54ms
step:467/1750 train_loss:3.8322 train_time:158380ms step_avg:346.56ms
step:468/1750 train_loss:3.8075 train_time:158734ms step_avg:346.58ms
step:469/1750 train_loss:3.6926 train_time:159088ms step_avg:346.60ms
step:470/1750 train_loss:3.7779 train_time:159443ms step_avg:346.61ms
step:471/1750 train_loss:3.8356 train_time:159798ms step_avg:346.63ms
step:472/1750 train_loss:3.7921 train_time:160156ms step_avg:346.66ms
step:473/1750 train_loss:3.7333 train_time:160512ms step_avg:346.68ms
step:474/1750 train_loss:3.5995 train_time:160866ms step_avg:346.69ms
step:475/1750 train_loss:4.0151 train_time:161219ms step_avg:346.71ms
step:476/1750 train_loss:3.7684 train_time:161576ms step_avg:346.73ms
step:477/1750 train_loss:3.6025 train_time:161934ms step_avg:346.75ms
step:478/1750 train_loss:3.8359 train_time:162289ms step_avg:346.77ms
step:479/1750 train_loss:3.7814 train_time:162648ms step_avg:346.80ms
step:480/1750 train_loss:3.9294 train_time:163003ms step_avg:346.81ms
step:481/1750 train_loss:3.7374 train_time:163360ms step_avg:346.84ms
step:482/1750 train_loss:3.5360 train_time:163716ms step_avg:346.86ms
step:483/1750 train_loss:3.8201 train_time:164072ms step_avg:346.87ms
step:484/1750 train_loss:3.6721 train_time:164429ms step_avg:346.90ms
step:485/1750 train_loss:3.6722 train_time:164786ms step_avg:346.92ms
step:486/1750 train_loss:3.5907 train_time:165141ms step_avg:346.94ms
step:487/1750 train_loss:3.6868 train_time:165499ms step_avg:346.96ms
step:488/1750 train_loss:3.8872 train_time:165853ms step_avg:346.97ms
step:489/1750 train_loss:3.7222 train_time:166210ms step_avg:346.99ms
step:490/1750 train_loss:3.6016 train_time:166567ms step_avg:347.01ms
step:491/1750 train_loss:3.6215 train_time:166921ms step_avg:347.03ms
step:492/1750 train_loss:3.7358 train_time:167278ms step_avg:347.05ms
step:493/1750 train_loss:3.5885 train_time:167636ms step_avg:347.07ms
step:494/1750 train_loss:3.7161 train_time:167992ms step_avg:347.09ms
step:495/1750 train_loss:3.6683 train_time:168350ms step_avg:347.11ms
step:496/1750 train_loss:3.5256 train_time:168705ms step_avg:347.13ms
step:497/1750 train_loss:3.7441 train_time:169059ms step_avg:347.14ms
step:498/1750 train_loss:3.8020 train_time:169415ms step_avg:347.16ms
step:499/1750 train_loss:3.8338 train_time:169772ms step_avg:347.18ms
step:500/1750 train_loss:3.7468 train_time:170132ms step_avg:347.21ms
step:500/1750 val_loss:3.7188 train_time:170221ms step_avg:347.39ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 207.32817 | frobenius_norm = 47546.46875 | spectral_norm = 8943.74805 | nuclear_norm = 1182388.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 105.18066 | spectral_norm = 14.61212 | nuclear_norm = 2450.12744
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 102.37543 | spectral_norm = 16.33865 | nuclear_norm = 2373.13281
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 203.59984 | spectral_norm = 12.82826 | nuclear_norm = 4875.89844
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 171.37517 | spectral_norm = 16.06295 | nuclear_norm = 4000.89746
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 219.18565 | spectral_norm = 17.49432 | nuclear_norm = 5821.54492
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 113.44076 | spectral_norm = 8.97381 | nuclear_norm = 3011.19678
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 105.10662 | spectral_norm = 9.50533 | nuclear_norm = 2455.76123
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 103.17630 | spectral_norm = 10.82553 | nuclear_norm = 2407.52588
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 205.34186 | spectral_norm = 17.48259 | nuclear_norm = 4750.95068
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 200.29282 | spectral_norm = 15.00817 | nuclear_norm = 4711.15234
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 226.28061 | spectral_norm = 15.72449 | nuclear_norm = 6019.28809
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 111.69086 | spectral_norm = 10.08249 | nuclear_norm = 2936.35791
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 103.20525 | spectral_norm = 10.21091 | nuclear_norm = 2403.04932
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 101.48183 | spectral_norm = 10.25734 | nuclear_norm = 2364.09082
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 195.51051 | spectral_norm = 16.67204 | nuclear_norm = 4454.05566
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 204.03603 | spectral_norm = 15.41711 | nuclear_norm = 4752.22754
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 231.12889 | spectral_norm = 16.33263 | nuclear_norm = 6142.79541
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 115.72366 | spectral_norm = 10.71588 | nuclear_norm = 3049.75391
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 101.41631 | spectral_norm = 8.70183 | nuclear_norm = 2300.45142
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 101.75687 | spectral_norm = 8.41206 | nuclear_norm = 2315.90405
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 210.09830 | spectral_norm = 18.18334 | nuclear_norm = 4776.79443
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 216.68684 | spectral_norm = 16.19737 | nuclear_norm = 5111.96973
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 229.73274 | spectral_norm = 17.64266 | nuclear_norm = 6114.62500
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 113.88036 | spectral_norm = 9.68465 | nuclear_norm = 3005.10107
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 103.37313 | spectral_norm = 9.56379 | nuclear_norm = 2392.94995
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 102.76224 | spectral_norm = 8.94005 | nuclear_norm = 2382.20239
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 207.48462 | spectral_norm = 18.95081 | nuclear_norm = 4674.23926
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 210.91594 | spectral_norm = 16.41076 | nuclear_norm = 4926.19336
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 238.67207 | spectral_norm = 18.10195 | nuclear_norm = 6337.97754
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 114.59067 | spectral_norm = 9.81237 | nuclear_norm = 3012.12256
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 101.59623 | spectral_norm = 9.67560 | nuclear_norm = 2349.09766
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 100.83372 | spectral_norm = 9.86118 | nuclear_norm = 2335.01758
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 207.46368 | spectral_norm = 17.49474 | nuclear_norm = 4746.98877
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 206.25497 | spectral_norm = 15.50166 | nuclear_norm = 4844.82471
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 239.67865 | spectral_norm = 16.53723 | nuclear_norm = 6381.25684
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 115.18560 | spectral_norm = 9.68348 | nuclear_norm = 3030.88525
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 101.47292 | spectral_norm = 9.46800 | nuclear_norm = 2340.66431
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 100.43850 | spectral_norm = 9.01053 | nuclear_norm = 2326.17041
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 213.68553 | spectral_norm = 18.24477 | nuclear_norm = 4845.93652
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 208.84357 | spectral_norm = 15.87754 | nuclear_norm = 4906.26172
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 231.87802 | spectral_norm = 17.18148 | nuclear_norm = 6175.15918
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 114.19302 | spectral_norm = 9.45570 | nuclear_norm = 3006.38965
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 102.11409 | spectral_norm = 9.33170 | nuclear_norm = 2356.46875
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 100.86008 | spectral_norm = 8.98426 | nuclear_norm = 2328.19824
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 209.99243 | spectral_norm = 17.70286 | nuclear_norm = 4782.53320
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 210.75604 | spectral_norm = 15.92547 | nuclear_norm = 4957.69238
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 232.52087 | spectral_norm = 17.64136 | nuclear_norm = 6183.58301
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 116.18840 | spectral_norm = 9.68742 | nuclear_norm = 3069.96045
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 103.72874 | spectral_norm = 9.75506 | nuclear_norm = 2368.31934
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 103.33391 | spectral_norm = 9.41779 | nuclear_norm = 2345.99512
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 228.42961 | spectral_norm = 19.61814 | nuclear_norm = 5229.33594
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 222.43996 | spectral_norm = 16.42395 | nuclear_norm = 5209.81299
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 229.42432 | spectral_norm = 17.22263 | nuclear_norm = 6099.84863
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 116.48814 | spectral_norm = 10.03836 | nuclear_norm = 3084.86572
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 105.30188 | spectral_norm = 9.41931 | nuclear_norm = 2423.03662
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 104.20512 | spectral_norm = 9.51259 | nuclear_norm = 2391.03442
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 215.63982 | spectral_norm = 19.64827 | nuclear_norm = 4933.95605
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 215.19118 | spectral_norm = 15.98590 | nuclear_norm = 5089.70654
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 233.84569 | spectral_norm = 18.41459 | nuclear_norm = 6218.21240
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 117.02017 | spectral_norm = 10.32330 | nuclear_norm = 3096.36523
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 103.67891 | spectral_norm = 10.82713 | nuclear_norm = 2347.69287
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 102.56988 | spectral_norm = 10.34628 | nuclear_norm = 2297.21777
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 219.67387 | spectral_norm = 19.40389 | nuclear_norm = 5079.91748
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 230.85991 | spectral_norm = 15.80007 | nuclear_norm = 5460.16406
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 232.67857 | spectral_norm = 16.46864 | nuclear_norm = 6203.36426
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 113.02657 | spectral_norm = 11.40425 | nuclear_norm = 2987.23340
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 107.06747 | spectral_norm = 11.30434 | nuclear_norm = 2469.77710
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 104.40589 | spectral_norm = 10.62709 | nuclear_norm = 2396.42236
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 198.68773 | spectral_norm = 17.76033 | nuclear_norm = 4577.39844
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 218.42865 | spectral_norm = 15.64690 | nuclear_norm = 5144.29004
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 242.12178 | spectral_norm = 18.75124 | nuclear_norm = 6442.83057
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 116.39748 | spectral_norm = 11.76595 | nuclear_norm = 3061.09961
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 810.10187 | spectral_norm = 162.31694 | nuclear_norm = 20829.38672
===========================================
step:501/1750 train_loss:3.8164 train_time:170481ms step_avg:347.21ms
step:502/1750 train_loss:3.7526 train_time:170831ms step_avg:347.22ms
step:503/1750 train_loss:3.7883 train_time:171185ms step_avg:347.23ms
step:504/1750 train_loss:3.7437 train_time:171537ms step_avg:347.24ms
step:505/1750 train_loss:3.8074 train_time:171890ms step_avg:347.25ms
step:506/1750 train_loss:3.6664 train_time:172245ms step_avg:347.27ms
step:507/1750 train_loss:3.7743 train_time:172600ms step_avg:347.28ms
step:508/1750 train_loss:3.8400 train_time:172956ms step_avg:347.30ms
step:509/1750 train_loss:3.7901 train_time:173308ms step_avg:347.31ms
step:510/1750 train_loss:3.5911 train_time:173662ms step_avg:347.32ms
step:511/1750 train_loss:3.7908 train_time:174018ms step_avg:347.34ms
step:512/1750 train_loss:3.7398 train_time:174377ms step_avg:347.36ms
step:513/1750 train_loss:3.6785 train_time:174731ms step_avg:347.38ms
step:514/1750 train_loss:3.7950 train_time:175086ms step_avg:347.39ms
step:515/1750 train_loss:3.7523 train_time:175441ms step_avg:347.41ms
step:516/1750 train_loss:4.0851 train_time:175799ms step_avg:347.43ms
step:517/1750 train_loss:3.7005 train_time:176152ms step_avg:347.44ms
step:518/1750 train_loss:3.7817 train_time:176508ms step_avg:347.46ms
step:519/1750 train_loss:3.6782 train_time:176863ms step_avg:347.47ms
step:520/1750 train_loss:3.6935 train_time:177222ms step_avg:347.49ms
step:521/1750 train_loss:3.6727 train_time:177585ms step_avg:347.53ms
step:522/1750 train_loss:3.6677 train_time:177950ms step_avg:347.56ms
step:523/1750 train_loss:4.2918 train_time:178312ms step_avg:347.59ms
step:524/1750 train_loss:3.7460 train_time:178673ms step_avg:347.61ms
step:525/1750 train_loss:3.6911 train_time:179034ms step_avg:347.64ms
step:526/1750 train_loss:3.7068 train_time:179397ms step_avg:347.67ms
step:527/1750 train_loss:3.6716 train_time:179759ms step_avg:347.70ms
step:528/1750 train_loss:3.6453 train_time:180121ms step_avg:347.72ms
step:529/1750 train_loss:3.8632 train_time:180484ms step_avg:347.75ms
step:530/1750 train_loss:3.6508 train_time:180848ms step_avg:347.79ms
step:531/1750 train_loss:3.9407 train_time:181212ms step_avg:347.82ms
step:532/1750 train_loss:3.7407 train_time:181572ms step_avg:347.84ms
step:533/1750 train_loss:3.6687 train_time:181934ms step_avg:347.87ms
step:534/1750 train_loss:3.6837 train_time:182293ms step_avg:347.89ms
step:535/1750 train_loss:3.6192 train_time:182657ms step_avg:347.92ms
step:536/1750 train_loss:3.7634 train_time:183022ms step_avg:347.95ms
step:537/1750 train_loss:3.7360 train_time:183388ms step_avg:347.98ms
step:538/1750 train_loss:3.6363 train_time:183754ms step_avg:348.02ms
step:539/1750 train_loss:4.1274 train_time:184121ms step_avg:348.05ms
step:540/1750 train_loss:3.6871 train_time:184484ms step_avg:348.08ms
step:541/1750 train_loss:3.8014 train_time:184846ms step_avg:348.11ms
step:542/1750 train_loss:3.6067 train_time:185211ms step_avg:348.14ms
step:543/1750 train_loss:3.6008 train_time:185574ms step_avg:348.17ms
step:544/1750 train_loss:3.6487 train_time:185937ms step_avg:348.20ms
step:545/1750 train_loss:3.5971 train_time:186300ms step_avg:348.22ms
step:546/1750 train_loss:3.6395 train_time:186664ms step_avg:348.25ms
step:547/1750 train_loss:3.6571 train_time:187026ms step_avg:348.28ms
step:548/1750 train_loss:3.6301 train_time:187390ms step_avg:348.31ms
step:549/1750 train_loss:3.7389 train_time:187754ms step_avg:348.34ms
step:550/1750 train_loss:3.6290 train_time:188118ms step_avg:348.37ms
step:551/1750 train_loss:3.6390 train_time:188480ms step_avg:348.39ms
step:552/1750 train_loss:3.9445 train_time:188843ms step_avg:348.42ms
step:553/1750 train_loss:3.7744 train_time:189206ms step_avg:348.45ms
step:554/1750 train_loss:3.7300 train_time:189565ms step_avg:348.47ms
step:555/1750 train_loss:3.6472 train_time:189928ms step_avg:348.49ms
step:556/1750 train_loss:3.7063 train_time:190287ms step_avg:348.51ms
step:557/1750 train_loss:3.3261 train_time:190650ms step_avg:348.54ms
step:558/1750 train_loss:3.6197 train_time:191013ms step_avg:348.56ms
step:559/1750 train_loss:3.6604 train_time:191372ms step_avg:348.58ms
step:560/1750 train_loss:3.7066 train_time:191735ms step_avg:348.61ms
step:561/1750 train_loss:3.6213 train_time:192097ms step_avg:348.63ms
step:562/1750 train_loss:3.5712 train_time:192459ms step_avg:348.66ms
step:563/1750 train_loss:3.7709 train_time:192824ms step_avg:348.69ms
step:564/1750 train_loss:3.5879 train_time:193189ms step_avg:348.72ms
step:565/1750 train_loss:3.6955 train_time:193550ms step_avg:348.74ms
step:566/1750 train_loss:3.6359 train_time:193964ms step_avg:348.86ms
step:567/1750 train_loss:3.6201 train_time:194454ms step_avg:349.11ms
step:568/1750 train_loss:3.7030 train_time:194818ms step_avg:349.14ms
step:569/1750 train_loss:3.6668 train_time:195317ms step_avg:349.40ms
step:570/1750 train_loss:3.7107 train_time:195715ms step_avg:349.49ms
step:571/1750 train_loss:3.7761 train_time:196074ms step_avg:349.51ms
step:572/1750 train_loss:3.7402 train_time:196435ms step_avg:349.53ms
step:573/1750 train_loss:3.7484 train_time:196800ms step_avg:349.56ms
step:574/1750 train_loss:3.7952 train_time:197168ms step_avg:349.59ms
step:575/1750 train_loss:3.7422 train_time:197530ms step_avg:349.61ms
step:576/1750 train_loss:3.7705 train_time:197888ms step_avg:349.63ms
step:577/1750 train_loss:3.6830 train_time:198247ms step_avg:349.64ms
step:578/1750 train_loss:3.6937 train_time:198610ms step_avg:349.67ms
step:579/1750 train_loss:3.6914 train_time:198972ms step_avg:349.69ms
step:580/1750 train_loss:3.6091 train_time:199335ms step_avg:349.71ms
step:581/1750 train_loss:3.6542 train_time:199699ms step_avg:349.73ms
step:582/1750 train_loss:3.8709 train_time:200062ms step_avg:349.76ms
step:583/1750 train_loss:3.6456 train_time:200425ms step_avg:349.78ms
step:584/1750 train_loss:3.6005 train_time:200789ms step_avg:349.81ms
step:585/1750 train_loss:3.8042 train_time:201149ms step_avg:349.83ms
step:586/1750 train_loss:3.5249 train_time:201511ms step_avg:349.85ms
step:587/1750 train_loss:3.6830 train_time:201872ms step_avg:349.87ms
step:588/1750 train_loss:3.6656 train_time:202232ms step_avg:349.88ms
step:589/1750 train_loss:4.0123 train_time:202594ms step_avg:349.90ms
step:590/1750 train_loss:3.7960 train_time:202954ms step_avg:349.92ms
step:591/1750 train_loss:3.5269 train_time:203316ms step_avg:349.94ms
step:592/1750 train_loss:3.5515 train_time:203680ms step_avg:349.97ms
step:593/1750 train_loss:3.5168 train_time:204045ms step_avg:349.99ms
step:594/1750 train_loss:3.5647 train_time:204405ms step_avg:350.01ms
step:595/1750 train_loss:3.9327 train_time:204768ms step_avg:350.03ms
step:596/1750 train_loss:3.6570 train_time:205130ms step_avg:350.05ms
step:597/1750 train_loss:3.5998 train_time:205490ms step_avg:350.07ms
step:598/1750 train_loss:3.6793 train_time:205849ms step_avg:350.08ms
step:599/1750 train_loss:3.4885 train_time:206210ms step_avg:350.10ms
step:600/1750 train_loss:3.6184 train_time:206575ms step_avg:350.13ms
step:601/1750 train_loss:3.6572 train_time:206935ms step_avg:350.14ms
step:602/1750 train_loss:3.6770 train_time:207297ms step_avg:350.16ms
step:603/1750 train_loss:3.7988 train_time:207659ms step_avg:350.18ms
step:604/1750 train_loss:3.6255 train_time:208021ms step_avg:350.20ms
step:605/1750 train_loss:3.6242 train_time:208381ms step_avg:350.22ms
step:606/1750 train_loss:3.5906 train_time:208743ms step_avg:350.24ms
step:607/1750 train_loss:3.8560 train_time:209103ms step_avg:350.26ms
step:608/1750 train_loss:3.6569 train_time:209464ms step_avg:350.27ms
step:609/1750 train_loss:3.6256 train_time:209826ms step_avg:350.29ms
step:610/1750 train_loss:3.7160 train_time:210185ms step_avg:350.31ms
step:611/1750 train_loss:3.6181 train_time:210543ms step_avg:350.32ms
step:612/1750 train_loss:3.5796 train_time:210905ms step_avg:350.34ms
step:613/1750 train_loss:3.7694 train_time:211268ms step_avg:350.36ms
step:614/1750 train_loss:3.7252 train_time:211631ms step_avg:350.38ms
step:615/1750 train_loss:3.7053 train_time:211991ms step_avg:350.40ms
step:616/1750 train_loss:3.6459 train_time:212352ms step_avg:350.42ms
step:617/1750 train_loss:3.5675 train_time:212714ms step_avg:350.43ms
step:618/1750 train_loss:3.7007 train_time:213073ms step_avg:350.45ms
step:619/1750 train_loss:3.5761 train_time:213434ms step_avg:350.47ms
step:620/1750 train_loss:3.5958 train_time:213795ms step_avg:350.48ms
step:621/1750 train_loss:3.9410 train_time:214160ms step_avg:350.51ms
step:622/1750 train_loss:3.5825 train_time:214525ms step_avg:350.53ms
step:623/1750 train_loss:3.6210 train_time:214888ms step_avg:350.55ms
step:624/1750 train_loss:3.7129 train_time:215248ms step_avg:350.57ms
step:625/1750 train_loss:3.7255 train_time:215608ms step_avg:350.58ms
step:625/1750 val_loss:3.6387 train_time:215705ms step_avg:350.74ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 225.86429 | frobenius_norm = 51871.82422 | spectral_norm = 9521.30957 | nuclear_norm = 1294238.62500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 122.58781 | spectral_norm = 18.32845 | nuclear_norm = 2844.21533
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 118.86369 | spectral_norm = 20.27554 | nuclear_norm = 2745.20288
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 235.43193 | spectral_norm = 14.79887 | nuclear_norm = 5656.59277
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 191.29623 | spectral_norm = 18.78866 | nuclear_norm = 4454.55957
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 255.92384 | spectral_norm = 21.00359 | nuclear_norm = 6798.87598
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 132.73019 | spectral_norm = 11.04808 | nuclear_norm = 3522.66992
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 122.91512 | spectral_norm = 11.15220 | nuclear_norm = 2864.34717
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 120.60158 | spectral_norm = 12.35204 | nuclear_norm = 2805.72266
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 231.30606 | spectral_norm = 20.21638 | nuclear_norm = 5346.99561
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 225.59869 | spectral_norm = 17.19600 | nuclear_norm = 5306.47998
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 262.15491 | spectral_norm = 18.50882 | nuclear_norm = 6975.78125
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 129.37099 | spectral_norm = 12.16118 | nuclear_norm = 3396.84790
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 120.45019 | spectral_norm = 12.57199 | nuclear_norm = 2791.84595
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 118.47574 | spectral_norm = 11.88629 | nuclear_norm = 2752.78784
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 221.46667 | spectral_norm = 19.03184 | nuclear_norm = 5040.86768
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 230.27354 | spectral_norm = 17.60893 | nuclear_norm = 5355.22266
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 267.08588 | spectral_norm = 19.47498 | nuclear_norm = 7098.97559
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 134.52942 | spectral_norm = 13.07254 | nuclear_norm = 3542.95996
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 117.98159 | spectral_norm = 10.39648 | nuclear_norm = 2659.88232
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 118.17777 | spectral_norm = 10.04567 | nuclear_norm = 2671.58081
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 239.62442 | spectral_norm = 21.07900 | nuclear_norm = 5439.61621
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 246.93230 | spectral_norm = 18.34000 | nuclear_norm = 5824.46729
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 266.04700 | spectral_norm = 21.45759 | nuclear_norm = 7080.50732
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 132.38538 | spectral_norm = 11.66018 | nuclear_norm = 3493.43530
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 120.78423 | spectral_norm = 11.66698 | nuclear_norm = 2784.96387
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 119.79688 | spectral_norm = 10.51550 | nuclear_norm = 2768.06030
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 237.70332 | spectral_norm = 21.50526 | nuclear_norm = 5349.83301
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 241.31967 | spectral_norm = 18.72103 | nuclear_norm = 5628.86719
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 276.66733 | spectral_norm = 21.86792 | nuclear_norm = 7347.90674
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 132.66205 | spectral_norm = 11.84305 | nuclear_norm = 3484.99780
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 118.36401 | spectral_norm = 11.69391 | nuclear_norm = 2722.07446
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 117.30610 | spectral_norm = 11.68552 | nuclear_norm = 2703.67114
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 237.76591 | spectral_norm = 20.08176 | nuclear_norm = 5448.73730
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 235.75108 | spectral_norm = 17.73589 | nuclear_norm = 5535.15039
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 278.18994 | spectral_norm = 19.87203 | nuclear_norm = 7408.55615
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 133.57297 | spectral_norm = 11.81533 | nuclear_norm = 3514.45898
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 118.13924 | spectral_norm = 11.16686 | nuclear_norm = 2711.18262
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 116.69183 | spectral_norm = 10.70918 | nuclear_norm = 2689.10620
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 244.19293 | spectral_norm = 21.02632 | nuclear_norm = 5534.00879
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 238.76335 | spectral_norm = 17.99743 | nuclear_norm = 5613.06543
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 269.73367 | spectral_norm = 19.97159 | nuclear_norm = 7189.46045
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 132.61282 | spectral_norm = 11.43702 | nuclear_norm = 3490.58984
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 119.18940 | spectral_norm = 11.23654 | nuclear_norm = 2739.21924
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 117.46752 | spectral_norm = 10.87412 | nuclear_norm = 2703.08936
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 239.22942 | spectral_norm = 20.15343 | nuclear_norm = 5440.59033
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 239.02663 | spectral_norm = 18.53528 | nuclear_norm = 5603.90332
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 270.87888 | spectral_norm = 20.97367 | nuclear_norm = 7205.99023
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 135.52902 | spectral_norm = 11.91318 | nuclear_norm = 3581.51904
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 120.97009 | spectral_norm = 11.63574 | nuclear_norm = 2740.70020
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 120.89431 | spectral_norm = 11.26335 | nuclear_norm = 2722.86157
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 261.39606 | spectral_norm = 22.97337 | nuclear_norm = 5959.54736
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 253.79366 | spectral_norm = 18.56734 | nuclear_norm = 5937.90283
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 265.90543 | spectral_norm = 20.26357 | nuclear_norm = 7070.41016
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 136.03239 | spectral_norm = 12.13745 | nuclear_norm = 3604.50537
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 123.04794 | spectral_norm = 11.38224 | nuclear_norm = 2813.57764
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 121.88914 | spectral_norm = 11.47568 | nuclear_norm = 2781.07666
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 246.21858 | spectral_norm = 23.43666 | nuclear_norm = 5613.97070
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 244.83725 | spectral_norm = 18.56677 | nuclear_norm = 5776.53516
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 272.50278 | spectral_norm = 22.12860 | nuclear_norm = 7246.67871
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 137.08965 | spectral_norm = 12.43820 | nuclear_norm = 3629.85132
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 120.88879 | spectral_norm = 13.19686 | nuclear_norm = 2716.79614
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 119.85371 | spectral_norm = 12.55168 | nuclear_norm = 2660.92749
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 250.20818 | spectral_norm = 22.85231 | nuclear_norm = 5777.33447
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 262.19638 | spectral_norm = 17.93242 | nuclear_norm = 6194.76074
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 271.58060 | spectral_norm = 19.74713 | nuclear_norm = 7243.27344
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 131.15446 | spectral_norm = 13.99396 | nuclear_norm = 3465.55957
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 125.41208 | spectral_norm = 13.72920 | nuclear_norm = 2875.72241
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 121.74197 | spectral_norm = 13.05222 | nuclear_norm = 2778.55713
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 227.94003 | spectral_norm = 21.09366 | nuclear_norm = 5242.62500
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 250.29008 | spectral_norm = 18.07046 | nuclear_norm = 5884.97510
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 284.04108 | spectral_norm = 22.37181 | nuclear_norm = 7557.48828
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 136.00127 | spectral_norm = 14.71829 | nuclear_norm = 3572.03931
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 913.75183 | spectral_norm = 163.83647 | nuclear_norm = 23668.25000
===========================================
step:626/1750 train_loss:3.7590 train_time:215968ms step_avg:350.60ms
step:627/1750 train_loss:3.7324 train_time:216324ms step_avg:350.61ms
step:628/1750 train_loss:3.7848 train_time:216681ms step_avg:350.62ms
step:629/1750 train_loss:3.6069 train_time:217039ms step_avg:350.63ms
step:630/1750 train_loss:3.7413 train_time:217397ms step_avg:350.64ms
step:631/1750 train_loss:3.7612 train_time:217754ms step_avg:350.65ms
step:632/1750 train_loss:3.6680 train_time:218117ms step_avg:350.67ms
step:633/1750 train_loss:3.6162 train_time:218476ms step_avg:350.68ms
step:634/1750 train_loss:3.7188 train_time:218833ms step_avg:350.69ms
step:635/1750 train_loss:3.9713 train_time:219190ms step_avg:350.70ms
step:636/1750 train_loss:3.5579 train_time:219550ms step_avg:350.72ms
step:637/1750 train_loss:3.3679 train_time:219912ms step_avg:350.74ms
step:638/1750 train_loss:3.6108 train_time:220270ms step_avg:350.75ms
step:639/1750 train_loss:3.6458 train_time:220629ms step_avg:350.76ms
step:640/1750 train_loss:3.5840 train_time:220989ms step_avg:350.78ms
step:641/1750 train_loss:3.5985 train_time:221351ms step_avg:350.79ms
step:642/1750 train_loss:3.6477 train_time:221708ms step_avg:350.80ms
step:643/1750 train_loss:3.6219 train_time:222068ms step_avg:350.82ms
step:644/1750 train_loss:3.5780 train_time:222428ms step_avg:350.83ms
step:645/1750 train_loss:3.7965 train_time:222790ms step_avg:350.85ms
step:646/1750 train_loss:3.6971 train_time:223152ms step_avg:350.87ms
step:647/1750 train_loss:3.6830 train_time:223513ms step_avg:350.88ms
step:648/1750 train_loss:3.7266 train_time:223878ms step_avg:350.91ms
step:649/1750 train_loss:3.7806 train_time:224238ms step_avg:350.92ms
step:650/1750 train_loss:3.6330 train_time:224605ms step_avg:350.95ms
step:651/1750 train_loss:3.7898 train_time:224974ms step_avg:350.97ms
step:652/1750 train_loss:3.5951 train_time:225342ms step_avg:351.00ms
step:653/1750 train_loss:3.6789 train_time:225710ms step_avg:351.03ms
step:654/1750 train_loss:3.4443 train_time:226078ms step_avg:351.05ms
step:655/1750 train_loss:3.5947 train_time:226441ms step_avg:351.07ms
step:656/1750 train_loss:3.5951 train_time:226805ms step_avg:351.09ms
step:657/1750 train_loss:3.5152 train_time:227170ms step_avg:351.11ms
step:658/1750 train_loss:3.7017 train_time:227536ms step_avg:351.14ms
step:659/1750 train_loss:3.6037 train_time:227901ms step_avg:351.16ms
step:660/1750 train_loss:3.6987 train_time:228267ms step_avg:351.18ms
step:661/1750 train_loss:3.7633 train_time:228637ms step_avg:351.21ms
step:662/1750 train_loss:3.6843 train_time:229001ms step_avg:351.23ms
step:663/1750 train_loss:3.5667 train_time:229368ms step_avg:351.25ms
step:664/1750 train_loss:3.6324 train_time:229736ms step_avg:351.28ms
step:665/1750 train_loss:3.5090 train_time:230103ms step_avg:351.30ms
step:666/1750 train_loss:3.8006 train_time:230468ms step_avg:351.32ms
step:667/1750 train_loss:3.6237 train_time:230836ms step_avg:351.35ms
step:668/1750 train_loss:3.6587 train_time:231207ms step_avg:351.38ms
step:669/1750 train_loss:3.5038 train_time:231578ms step_avg:351.41ms
step:670/1750 train_loss:3.6156 train_time:231944ms step_avg:351.43ms
step:671/1750 train_loss:3.5797 train_time:232314ms step_avg:351.46ms
step:672/1750 train_loss:3.5888 train_time:232681ms step_avg:351.48ms
step:673/1750 train_loss:3.8621 train_time:233048ms step_avg:351.51ms
step:674/1750 train_loss:3.6468 train_time:233416ms step_avg:351.53ms
step:675/1750 train_loss:3.7244 train_time:233781ms step_avg:351.55ms
step:676/1750 train_loss:3.5020 train_time:234148ms step_avg:351.57ms
step:677/1750 train_loss:3.6198 train_time:234516ms step_avg:351.60ms
step:678/1750 train_loss:3.5702 train_time:234884ms step_avg:351.62ms
step:679/1750 train_loss:3.6956 train_time:235254ms step_avg:351.65ms
step:680/1750 train_loss:3.6037 train_time:235622ms step_avg:351.68ms
step:681/1750 train_loss:3.6295 train_time:235992ms step_avg:351.70ms
step:682/1750 train_loss:3.6810 train_time:236363ms step_avg:351.73ms
step:683/1750 train_loss:3.7487 train_time:236729ms step_avg:351.75ms
step:684/1750 train_loss:3.6590 train_time:237093ms step_avg:351.77ms
step:685/1750 train_loss:3.7063 train_time:237460ms step_avg:351.79ms
step:686/1750 train_loss:3.6506 train_time:237827ms step_avg:351.81ms
step:687/1750 train_loss:3.6825 train_time:238190ms step_avg:351.83ms
step:688/1750 train_loss:3.2158 train_time:238562ms step_avg:351.86ms
step:689/1750 train_loss:3.4273 train_time:238933ms step_avg:351.89ms
step:690/1750 train_loss:3.5664 train_time:239306ms step_avg:351.92ms
step:691/1750 train_loss:3.4331 train_time:239670ms step_avg:351.94ms
step:692/1750 train_loss:3.6379 train_time:240037ms step_avg:351.96ms
step:693/1750 train_loss:3.6672 train_time:240405ms step_avg:351.98ms
step:694/1750 train_loss:3.5710 train_time:240770ms step_avg:352.00ms
step:695/1750 train_loss:3.5537 train_time:241133ms step_avg:352.02ms
step:696/1750 train_loss:3.8705 train_time:241500ms step_avg:352.04ms
step:697/1750 train_loss:3.6030 train_time:241866ms step_avg:352.06ms
step:698/1750 train_loss:3.6603 train_time:242231ms step_avg:352.08ms
step:699/1750 train_loss:3.7840 train_time:242599ms step_avg:352.10ms
step:700/1750 train_loss:3.5848 train_time:242969ms step_avg:352.13ms
step:701/1750 train_loss:3.5635 train_time:243333ms step_avg:352.15ms
step:702/1750 train_loss:3.5347 train_time:243701ms step_avg:352.17ms
step:703/1750 train_loss:3.5118 train_time:244069ms step_avg:352.19ms
step:704/1750 train_loss:3.5940 train_time:244436ms step_avg:352.21ms
step:705/1750 train_loss:3.5762 train_time:244812ms step_avg:352.25ms
step:706/1750 train_loss:3.5997 train_time:245185ms step_avg:352.28ms
step:707/1750 train_loss:3.6619 train_time:245552ms step_avg:352.30ms
step:708/1750 train_loss:3.6186 train_time:245916ms step_avg:352.32ms
step:709/1750 train_loss:3.6011 train_time:246282ms step_avg:352.34ms
step:710/1750 train_loss:3.5608 train_time:246650ms step_avg:352.36ms
step:711/1750 train_loss:3.6141 train_time:247021ms step_avg:352.38ms
step:712/1750 train_loss:3.6624 train_time:247391ms step_avg:352.41ms
step:713/1750 train_loss:3.6709 train_time:247762ms step_avg:352.44ms
step:714/1750 train_loss:3.5737 train_time:248126ms step_avg:352.45ms
step:715/1750 train_loss:3.5893 train_time:248489ms step_avg:352.47ms
step:716/1750 train_loss:3.6020 train_time:248854ms step_avg:352.48ms
step:717/1750 train_loss:3.7244 train_time:249221ms step_avg:352.51ms
step:718/1750 train_loss:3.6133 train_time:249584ms step_avg:352.52ms
step:719/1750 train_loss:3.6944 train_time:249948ms step_avg:352.54ms
step:720/1750 train_loss:3.8714 train_time:250315ms step_avg:352.56ms
step:721/1750 train_loss:3.4812 train_time:250680ms step_avg:352.57ms
step:722/1750 train_loss:3.7481 train_time:251047ms step_avg:352.59ms
step:723/1750 train_loss:3.7867 train_time:251411ms step_avg:352.61ms
step:724/1750 train_loss:3.5881 train_time:251778ms step_avg:352.63ms
step:725/1750 train_loss:3.6674 train_time:252143ms step_avg:352.65ms
step:726/1750 train_loss:3.5559 train_time:252509ms step_avg:352.67ms
step:727/1750 train_loss:3.5921 train_time:252879ms step_avg:352.69ms
step:728/1750 train_loss:3.7579 train_time:253246ms step_avg:352.71ms
step:729/1750 train_loss:3.6817 train_time:253613ms step_avg:352.73ms
step:730/1750 train_loss:3.6794 train_time:253981ms step_avg:352.75ms
step:731/1750 train_loss:3.5763 train_time:254345ms step_avg:352.77ms
step:732/1750 train_loss:3.6131 train_time:254709ms step_avg:352.78ms
step:733/1750 train_loss:3.8494 train_time:255077ms step_avg:352.80ms
step:734/1750 train_loss:3.5774 train_time:255445ms step_avg:352.82ms
step:735/1750 train_loss:3.6272 train_time:255811ms step_avg:352.84ms
step:736/1750 train_loss:3.7570 train_time:256176ms step_avg:352.86ms
step:737/1750 train_loss:3.6900 train_time:256538ms step_avg:352.87ms
step:738/1750 train_loss:3.6141 train_time:256901ms step_avg:352.89ms
step:739/1750 train_loss:3.5140 train_time:257269ms step_avg:352.91ms
step:740/1750 train_loss:4.1181 train_time:257644ms step_avg:352.94ms
step:741/1750 train_loss:3.5108 train_time:258008ms step_avg:352.95ms
step:742/1750 train_loss:3.5746 train_time:258370ms step_avg:352.97ms
step:743/1750 train_loss:3.5973 train_time:258733ms step_avg:352.98ms
step:744/1750 train_loss:3.6629 train_time:259100ms step_avg:353.00ms
step:745/1750 train_loss:3.6109 train_time:259470ms step_avg:353.02ms
step:746/1750 train_loss:3.6147 train_time:259832ms step_avg:353.03ms
step:747/1750 train_loss:3.6662 train_time:260201ms step_avg:353.05ms
step:748/1750 train_loss:3.5952 train_time:260575ms step_avg:353.08ms
step:749/1750 train_loss:3.5843 train_time:260941ms step_avg:353.10ms
step:750/1750 train_loss:3.6196 train_time:261305ms step_avg:353.12ms
step:750/1750 val_loss:3.5857 train_time:261402ms step_avg:353.25ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 242.01225 | frobenius_norm = 55644.68359 | spectral_norm = 10044.68945 | nuclear_norm = 1392300.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 137.64529 | spectral_norm = 21.87681 | nuclear_norm = 3183.49487
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 133.50586 | spectral_norm = 24.25006 | nuclear_norm = 3074.73486
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 262.27319 | spectral_norm = 16.70558 | nuclear_norm = 6321.40576
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 204.92841 | spectral_norm = 20.81506 | nuclear_norm = 4761.14600
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 288.58282 | spectral_norm = 24.11738 | nuclear_norm = 7668.58105
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 149.59549 | spectral_norm = 13.01369 | nuclear_norm = 3969.92554
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 138.40625 | spectral_norm = 12.69414 | nuclear_norm = 3217.75562
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 135.79802 | spectral_norm = 13.70649 | nuclear_norm = 3152.35034
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 254.38947 | spectral_norm = 22.47909 | nuclear_norm = 5874.34766
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 247.87823 | spectral_norm = 19.01719 | nuclear_norm = 5831.51416
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 293.75861 | spectral_norm = 21.13790 | nuclear_norm = 7820.51416
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 144.91206 | spectral_norm = 14.03242 | nuclear_norm = 3802.60962
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 135.38350 | spectral_norm = 14.64649 | nuclear_norm = 3130.79053
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 133.16711 | spectral_norm = 13.34129 | nuclear_norm = 3086.72339
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 244.86398 | spectral_norm = 21.11841 | nuclear_norm = 5568.42480
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 253.87978 | spectral_norm = 19.66794 | nuclear_norm = 5897.33936
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 298.76965 | spectral_norm = 22.29565 | nuclear_norm = 7940.81787
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 151.00044 | spectral_norm = 15.16064 | nuclear_norm = 3974.60449
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 132.14543 | spectral_norm = 11.95918 | nuclear_norm = 2962.42920
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 132.44165 | spectral_norm = 11.40788 | nuclear_norm = 2979.76025
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 266.53812 | spectral_norm = 23.73998 | nuclear_norm = 6044.71777
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 273.95178 | spectral_norm = 20.32075 | nuclear_norm = 6461.82129
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 297.47510 | spectral_norm = 25.08631 | nuclear_norm = 7915.52539
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 148.60156 | spectral_norm = 13.59731 | nuclear_norm = 3920.08667
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 135.82434 | spectral_norm = 13.41175 | nuclear_norm = 3120.65112
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 134.55690 | spectral_norm = 11.95868 | nuclear_norm = 3099.71094
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 265.29865 | spectral_norm = 23.68351 | nuclear_norm = 5973.15967
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 268.92850 | spectral_norm = 20.84361 | nuclear_norm = 6269.69482
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 309.60388 | spectral_norm = 25.46091 | nuclear_norm = 8222.96777
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 148.44360 | spectral_norm = 13.63401 | nuclear_norm = 3899.21777
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 132.86253 | spectral_norm = 13.41750 | nuclear_norm = 3044.09619
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 131.34886 | spectral_norm = 13.29245 | nuclear_norm = 3017.64502
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 264.97598 | spectral_norm = 22.47581 | nuclear_norm = 6079.54297
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 262.28085 | spectral_norm = 19.65363 | nuclear_norm = 6161.40820
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 311.72507 | spectral_norm = 22.97235 | nuclear_norm = 8303.37305
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 149.64658 | spectral_norm = 13.70750 | nuclear_norm = 3938.22241
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 132.52797 | spectral_norm = 12.73183 | nuclear_norm = 3027.78027
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 130.74467 | spectral_norm = 12.25753 | nuclear_norm = 3003.01758
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 271.44974 | spectral_norm = 23.23021 | nuclear_norm = 6154.33887
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 265.53281 | spectral_norm = 19.90793 | nuclear_norm = 6247.40332
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 303.15625 | spectral_norm = 22.46894 | nuclear_norm = 8085.88477
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 148.76059 | spectral_norm = 13.38971 | nuclear_norm = 3914.42505
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 133.90091 | spectral_norm = 12.85658 | nuclear_norm = 3064.62988
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 131.87169 | spectral_norm = 12.58341 | nuclear_norm = 3026.59619
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 265.06583 | spectral_norm = 22.32177 | nuclear_norm = 6019.83545
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 263.62076 | spectral_norm = 20.85671 | nuclear_norm = 6163.85938
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 304.53955 | spectral_norm = 23.90113 | nuclear_norm = 8100.22607
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 152.34656 | spectral_norm = 14.08487 | nuclear_norm = 4024.30371
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 135.82343 | spectral_norm = 13.26892 | nuclear_norm = 3059.53271
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 135.94501 | spectral_norm = 12.92359 | nuclear_norm = 3040.43604
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 291.08505 | spectral_norm = 26.28281 | nuclear_norm = 6612.74609
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 281.96957 | spectral_norm = 20.28956 | nuclear_norm = 6592.87061
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 298.40445 | spectral_norm = 23.10160 | nuclear_norm = 7933.14746
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 153.15961 | spectral_norm = 14.11412 | nuclear_norm = 4059.27881
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 138.33302 | spectral_norm = 13.20354 | nuclear_norm = 3151.85107
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 137.13164 | spectral_norm = 13.19267 | nuclear_norm = 3113.80371
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 273.74808 | spectral_norm = 27.01588 | nuclear_norm = 6219.52100
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 271.44641 | spectral_norm = 21.14855 | nuclear_norm = 6394.57422
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 306.36743 | spectral_norm = 25.60250 | nuclear_norm = 8144.86670
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 154.70787 | spectral_norm = 14.44355 | nuclear_norm = 4098.09570
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 135.71877 | spectral_norm = 15.35932 | nuclear_norm = 3031.69800
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 134.68327 | spectral_norm = 14.47656 | nuclear_norm = 2970.32959
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 277.66064 | spectral_norm = 26.42572 | nuclear_norm = 6398.50000
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 290.30533 | spectral_norm = 19.83532 | nuclear_norm = 6856.86816
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 305.73962 | spectral_norm = 22.65593 | nuclear_norm = 8154.06201
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 147.15901 | spectral_norm = 16.31072 | nuclear_norm = 3887.96118
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 141.21658 | spectral_norm = 15.91428 | nuclear_norm = 3222.55518
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 136.74352 | spectral_norm = 15.09027 | nuclear_norm = 3104.60693
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 254.52486 | spectral_norm = 24.27673 | nuclear_norm = 5845.73730
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 279.46140 | spectral_norm = 20.25476 | nuclear_norm = 6564.61230
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 320.70544 | spectral_norm = 25.31668 | nuclear_norm = 8530.50684
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 153.91621 | spectral_norm = 17.45131 | nuclear_norm = 4039.67139
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1006.69434 | spectral_norm = 164.33762 | nuclear_norm = 26217.38867
===========================================
step:751/1750 train_loss:3.5837 train_time:261668ms step_avg:353.13ms
step:752/1750 train_loss:3.6339 train_time:262025ms step_avg:353.13ms
step:753/1750 train_loss:3.6303 train_time:262386ms step_avg:353.14ms
step:754/1750 train_loss:3.6078 train_time:262752ms step_avg:353.16ms
step:755/1750 train_loss:3.6960 train_time:263136ms step_avg:353.20ms
step:756/1750 train_loss:3.4777 train_time:263697ms step_avg:353.48ms
step:757/1750 train_loss:3.7441 train_time:264064ms step_avg:353.50ms
step:758/1750 train_loss:3.6745 train_time:264428ms step_avg:353.51ms
step:759/1750 train_loss:3.6071 train_time:264934ms step_avg:353.72ms
step:760/1750 train_loss:3.7231 train_time:265303ms step_avg:353.74ms
step:761/1750 train_loss:3.4145 train_time:265669ms step_avg:353.75ms
step:762/1750 train_loss:3.5700 train_time:266032ms step_avg:353.77ms
step:763/1750 train_loss:3.6799 train_time:266396ms step_avg:353.78ms
step:764/1750 train_loss:3.3384 train_time:266760ms step_avg:353.79ms
step:765/1750 train_loss:3.7553 train_time:267128ms step_avg:353.81ms
step:766/1750 train_loss:3.5907 train_time:267497ms step_avg:353.83ms
step:767/1750 train_loss:3.5834 train_time:267861ms step_avg:353.85ms
step:768/1750 train_loss:3.5881 train_time:268228ms step_avg:353.86ms
step:769/1750 train_loss:3.6032 train_time:268596ms step_avg:353.88ms
step:770/1750 train_loss:3.6604 train_time:268961ms step_avg:353.90ms
step:771/1750 train_loss:3.8976 train_time:269324ms step_avg:353.91ms
step:772/1750 train_loss:3.4682 train_time:269687ms step_avg:353.92ms
step:773/1750 train_loss:3.6575 train_time:270050ms step_avg:353.93ms
step:774/1750 train_loss:3.6618 train_time:270413ms step_avg:353.94ms
step:775/1750 train_loss:3.6255 train_time:270776ms step_avg:353.96ms
step:776/1750 train_loss:3.4192 train_time:271143ms step_avg:353.97ms
step:777/1750 train_loss:3.4076 train_time:271510ms step_avg:353.99ms
step:778/1750 train_loss:3.5065 train_time:271873ms step_avg:354.00ms
step:779/1750 train_loss:3.5988 train_time:272242ms step_avg:354.02ms
step:780/1750 train_loss:3.6117 train_time:272613ms step_avg:354.04ms
step:781/1750 train_loss:3.6853 train_time:272981ms step_avg:354.06ms
step:782/1750 train_loss:3.6121 train_time:273351ms step_avg:354.08ms
step:783/1750 train_loss:3.5850 train_time:273721ms step_avg:354.10ms
step:784/1750 train_loss:3.6154 train_time:274094ms step_avg:354.13ms
step:785/1750 train_loss:3.5798 train_time:274460ms step_avg:354.14ms
step:786/1750 train_loss:3.4571 train_time:274831ms step_avg:354.16ms
step:787/1750 train_loss:3.8033 train_time:275204ms step_avg:354.19ms
step:788/1750 train_loss:3.5129 train_time:275579ms step_avg:354.21ms
step:789/1750 train_loss:3.5732 train_time:275947ms step_avg:354.23ms
step:790/1750 train_loss:3.6453 train_time:276321ms step_avg:354.26ms
step:791/1750 train_loss:3.7901 train_time:276699ms step_avg:354.29ms
step:792/1750 train_loss:3.7775 train_time:277070ms step_avg:354.31ms
step:793/1750 train_loss:3.4854 train_time:277437ms step_avg:354.33ms
step:794/1750 train_loss:3.6163 train_time:277810ms step_avg:354.35ms
step:795/1750 train_loss:3.6868 train_time:278185ms step_avg:354.38ms
step:796/1750 train_loss:3.7410 train_time:278561ms step_avg:354.40ms
step:797/1750 train_loss:3.5415 train_time:278931ms step_avg:354.42ms
step:798/1750 train_loss:3.6644 train_time:279308ms step_avg:354.45ms
step:799/1750 train_loss:3.5631 train_time:279685ms step_avg:354.48ms
step:800/1750 train_loss:3.5425 train_time:280060ms step_avg:354.51ms
step:801/1750 train_loss:3.6537 train_time:280427ms step_avg:354.52ms
step:802/1750 train_loss:3.5104 train_time:280801ms step_avg:354.55ms
step:803/1750 train_loss:3.5211 train_time:281169ms step_avg:354.56ms
step:804/1750 train_loss:3.6517 train_time:281540ms step_avg:354.58ms
step:805/1750 train_loss:3.5442 train_time:281916ms step_avg:354.61ms
step:806/1750 train_loss:3.5820 train_time:282282ms step_avg:354.63ms
step:807/1750 train_loss:3.6677 train_time:282651ms step_avg:354.64ms
step:808/1750 train_loss:3.5765 train_time:283021ms step_avg:354.66ms
step:809/1750 train_loss:3.5119 train_time:283389ms step_avg:354.68ms
step:810/1750 train_loss:3.5796 train_time:283757ms step_avg:354.70ms
step:811/1750 train_loss:3.6084 train_time:284126ms step_avg:354.71ms
step:812/1750 train_loss:3.6127 train_time:284491ms step_avg:354.73ms
step:813/1750 train_loss:3.6426 train_time:284858ms step_avg:354.74ms
step:814/1750 train_loss:3.5910 train_time:285230ms step_avg:354.76ms
step:815/1750 train_loss:3.5836 train_time:285601ms step_avg:354.78ms
step:816/1750 train_loss:3.7051 train_time:285976ms step_avg:354.81ms
step:817/1750 train_loss:3.7955 train_time:286346ms step_avg:354.83ms
step:818/1750 train_loss:3.5454 train_time:286716ms step_avg:354.85ms
step:819/1750 train_loss:3.7406 train_time:287090ms step_avg:354.87ms
step:820/1750 train_loss:3.5229 train_time:287463ms step_avg:354.89ms
step:821/1750 train_loss:3.5745 train_time:287832ms step_avg:354.91ms
step:822/1750 train_loss:3.7166 train_time:288204ms step_avg:354.93ms
step:823/1750 train_loss:3.6003 train_time:288576ms step_avg:354.95ms
step:824/1750 train_loss:3.5308 train_time:288948ms step_avg:354.97ms
step:825/1750 train_loss:3.6342 train_time:289322ms step_avg:355.00ms
step:826/1750 train_loss:3.5030 train_time:289698ms step_avg:355.02ms
step:827/1750 train_loss:3.7492 train_time:290070ms step_avg:355.04ms
step:828/1750 train_loss:3.6416 train_time:290444ms step_avg:355.07ms
step:829/1750 train_loss:3.6503 train_time:290817ms step_avg:355.09ms
step:830/1750 train_loss:3.5499 train_time:291188ms step_avg:355.11ms
step:831/1750 train_loss:3.6168 train_time:291556ms step_avg:355.12ms
step:832/1750 train_loss:3.5399 train_time:291926ms step_avg:355.14ms
step:833/1750 train_loss:3.6697 train_time:292298ms step_avg:355.16ms
step:834/1750 train_loss:3.4942 train_time:292670ms step_avg:355.18ms
step:835/1750 train_loss:3.4761 train_time:293044ms step_avg:355.20ms
step:836/1750 train_loss:3.7442 train_time:293423ms step_avg:355.23ms
step:837/1750 train_loss:3.4205 train_time:293793ms step_avg:355.25ms
step:838/1750 train_loss:3.6126 train_time:294164ms step_avg:355.27ms
step:839/1750 train_loss:3.4352 train_time:294533ms step_avg:355.29ms
step:840/1750 train_loss:3.4921 train_time:294901ms step_avg:355.30ms
step:841/1750 train_loss:3.5910 train_time:295273ms step_avg:355.32ms
step:842/1750 train_loss:3.6064 train_time:295646ms step_avg:355.34ms
step:843/1750 train_loss:3.5851 train_time:296012ms step_avg:355.36ms
step:844/1750 train_loss:3.4495 train_time:296380ms step_avg:355.37ms
step:845/1750 train_loss:3.6865 train_time:296750ms step_avg:355.39ms
step:846/1750 train_loss:3.5372 train_time:297121ms step_avg:355.41ms
step:847/1750 train_loss:3.5127 train_time:297495ms step_avg:355.43ms
step:848/1750 train_loss:3.6553 train_time:297866ms step_avg:355.45ms
step:849/1750 train_loss:3.5148 train_time:298238ms step_avg:355.47ms
step:850/1750 train_loss:3.4554 train_time:298610ms step_avg:355.49ms
step:851/1750 train_loss:3.7586 train_time:298979ms step_avg:355.50ms
step:852/1750 train_loss:3.4641 train_time:299345ms step_avg:355.52ms
step:853/1750 train_loss:3.5844 train_time:299715ms step_avg:355.53ms
step:854/1750 train_loss:3.6736 train_time:300087ms step_avg:355.55ms
step:855/1750 train_loss:3.5376 train_time:300454ms step_avg:355.57ms
step:856/1750 train_loss:3.5687 train_time:300821ms step_avg:355.58ms
step:857/1750 train_loss:3.6222 train_time:301194ms step_avg:355.60ms
step:858/1750 train_loss:3.4933 train_time:301569ms step_avg:355.62ms
step:859/1750 train_loss:3.5788 train_time:301938ms step_avg:355.64ms
step:860/1750 train_loss:3.6059 train_time:302303ms step_avg:355.65ms
step:861/1750 train_loss:3.6476 train_time:302680ms step_avg:355.68ms
step:862/1750 train_loss:3.6201 train_time:303059ms step_avg:355.70ms
step:863/1750 train_loss:3.6016 train_time:303432ms step_avg:355.72ms
step:864/1750 train_loss:3.4045 train_time:303802ms step_avg:355.74ms
step:865/1750 train_loss:3.6176 train_time:304169ms step_avg:355.75ms
step:866/1750 train_loss:3.9094 train_time:304544ms step_avg:355.78ms
step:867/1750 train_loss:3.4672 train_time:304912ms step_avg:355.79ms
step:868/1750 train_loss:3.6618 train_time:305281ms step_avg:355.81ms
step:869/1750 train_loss:3.6371 train_time:305654ms step_avg:355.82ms
step:870/1750 train_loss:3.4681 train_time:306025ms step_avg:355.84ms
step:871/1750 train_loss:3.4433 train_time:306392ms step_avg:355.86ms
step:872/1750 train_loss:3.6698 train_time:306762ms step_avg:355.87ms
step:873/1750 train_loss:3.4820 train_time:307129ms step_avg:355.89ms
step:874/1750 train_loss:3.2347 train_time:307506ms step_avg:355.91ms
step:875/1750 train_loss:3.6556 train_time:307876ms step_avg:355.93ms
step:875/1750 val_loss:3.5434 train_time:307974ms step_avg:356.04ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 256.33630 | frobenius_norm = 58998.90625 | spectral_norm = 10546.41211 | nuclear_norm = 1479583.12500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 151.05441 | spectral_norm = 25.17251 | nuclear_norm = 3485.92627
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 146.65585 | spectral_norm = 28.01472 | nuclear_norm = 3370.30225
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 286.53287 | spectral_norm = 18.50904 | nuclear_norm = 6925.54590
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 216.16064 | spectral_norm = 22.86349 | nuclear_norm = 5006.01953
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 320.09412 | spectral_norm = 27.18979 | nuclear_norm = 8511.01562
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 164.64273 | spectral_norm = 14.75999 | nuclear_norm = 4368.85303
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 152.45988 | spectral_norm = 14.03995 | nuclear_norm = 3538.60718
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 149.59167 | spectral_norm = 14.85766 | nuclear_norm = 3466.42090
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 275.88425 | spectral_norm = 24.65967 | nuclear_norm = 6362.09326
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 268.65149 | spectral_norm = 20.88478 | nuclear_norm = 6319.08008
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 323.12592 | spectral_norm = 23.53907 | nuclear_norm = 8608.28516
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 158.99869 | spectral_norm = 15.75791 | nuclear_norm = 4169.83057
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 149.27411 | spectral_norm = 16.79008 | nuclear_norm = 3443.93018
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 146.72491 | spectral_norm = 14.74486 | nuclear_norm = 3396.15576
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 266.86282 | spectral_norm = 23.22661 | nuclear_norm = 6064.26172
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 275.92896 | spectral_norm = 21.57938 | nuclear_norm = 6407.81348
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 328.17102 | spectral_norm = 24.95700 | nuclear_norm = 8723.59082
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 165.91911 | spectral_norm = 17.07927 | nuclear_norm = 4365.11035
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 145.01907 | spectral_norm = 13.32496 | nuclear_norm = 3237.85229
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 145.47180 | spectral_norm = 12.67664 | nuclear_norm = 3260.08398
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 291.69604 | spectral_norm = 26.03962 | nuclear_norm = 6608.70508
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 299.03314 | spectral_norm = 22.22180 | nuclear_norm = 7053.92969
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 327.30817 | spectral_norm = 28.53192 | nuclear_norm = 8708.91016
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 163.23737 | spectral_norm = 15.33600 | nuclear_norm = 4304.97461
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 149.49931 | spectral_norm = 15.06121 | nuclear_norm = 3423.90283
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 147.99411 | spectral_norm = 13.26416 | nuclear_norm = 3399.81177
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 291.55795 | spectral_norm = 25.80989 | nuclear_norm = 6564.16211
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 294.94968 | spectral_norm = 23.04774 | nuclear_norm = 6871.08350
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 340.24332 | spectral_norm = 28.76901 | nuclear_norm = 9037.98047
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 162.84804 | spectral_norm = 15.32995 | nuclear_norm = 4276.70215
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 146.03954 | spectral_norm = 15.03546 | nuclear_norm = 3334.77686
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 144.14444 | spectral_norm = 14.78154 | nuclear_norm = 3303.48291
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 290.96793 | spectral_norm = 24.93550 | nuclear_norm = 6681.74268
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 287.51114 | spectral_norm = 21.45636 | nuclear_norm = 6755.15918
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 342.79941 | spectral_norm = 25.63152 | nuclear_norm = 9134.02539
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 164.28711 | spectral_norm = 15.45584 | nuclear_norm = 4324.32910
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 145.62695 | spectral_norm = 14.20930 | nuclear_norm = 3314.19165
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 143.51392 | spectral_norm = 13.60405 | nuclear_norm = 3286.52222
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 297.14301 | spectral_norm = 25.32981 | nuclear_norm = 6740.56836
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 290.56421 | spectral_norm = 21.56874 | nuclear_norm = 6841.81445
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 334.25070 | spectral_norm = 25.00817 | nuclear_norm = 8920.60938
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 163.32434 | spectral_norm = 15.21583 | nuclear_norm = 4296.48877
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 147.11217 | spectral_norm = 14.45191 | nuclear_norm = 3356.98071
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 144.85213 | spectral_norm = 14.00111 | nuclear_norm = 3314.05347
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 288.89349 | spectral_norm = 24.43750 | nuclear_norm = 6560.46826
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 286.30902 | spectral_norm = 22.65084 | nuclear_norm = 6677.22852
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 335.91824 | spectral_norm = 26.78474 | nuclear_norm = 8933.83203
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 167.42595 | spectral_norm = 16.13937 | nuclear_norm = 4421.36816
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 149.21764 | spectral_norm = 14.86970 | nuclear_norm = 3343.00562
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 149.47971 | spectral_norm = 14.45002 | nuclear_norm = 3324.63892
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 318.58212 | spectral_norm = 29.84726 | nuclear_norm = 7213.16113
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 308.07361 | spectral_norm = 21.96487 | nuclear_norm = 7204.01270
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 328.52246 | spectral_norm = 25.87062 | nuclear_norm = 8732.41406
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 168.50093 | spectral_norm = 16.00524 | nuclear_norm = 4466.16504
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 152.07622 | spectral_norm = 14.70257 | nuclear_norm = 3451.23438
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 150.96576 | spectral_norm = 14.95390 | nuclear_norm = 3414.57861
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 299.46329 | spectral_norm = 30.45883 | nuclear_norm = 6784.22852
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 296.29272 | spectral_norm = 23.58368 | nuclear_norm = 6971.47607
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 338.10349 | spectral_norm = 28.91060 | nuclear_norm = 8986.38184
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 170.78604 | spectral_norm = 16.32673 | nuclear_norm = 4525.49316
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 149.06105 | spectral_norm = 17.38629 | nuclear_norm = 3311.63062
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 147.99295 | spectral_norm = 16.22915 | nuclear_norm = 3245.19092
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 303.25668 | spectral_norm = 29.71459 | nuclear_norm = 6977.00684
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 316.86212 | spectral_norm = 21.73528 | nuclear_norm = 7485.14697
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 337.27054 | spectral_norm = 25.38860 | nuclear_norm = 8996.16309
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 161.76112 | spectral_norm = 18.46836 | nuclear_norm = 4273.66455
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 155.59462 | spectral_norm = 17.91502 | nuclear_norm = 3534.81055
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 150.24062 | spectral_norm = 17.06836 | nuclear_norm = 3394.25928
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 279.28427 | spectral_norm = 27.35413 | nuclear_norm = 6404.58984
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 307.04465 | spectral_norm = 22.34328 | nuclear_norm = 7209.09814
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 354.28940 | spectral_norm = 28.41864 | nuclear_norm = 9419.88086
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 171.09106 | spectral_norm = 20.13640 | nuclear_norm = 4488.56396
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1090.86121 | spectral_norm = 164.91736 | nuclear_norm = 28524.70703
===========================================
step:876/1750 train_loss:3.4654 train_time:308240ms step_avg:355.94ms
step:877/1750 train_loss:3.6379 train_time:308599ms step_avg:355.94ms
step:878/1750 train_loss:3.4927 train_time:308966ms step_avg:355.95ms
step:879/1750 train_loss:3.6628 train_time:309335ms step_avg:355.97ms
step:880/1750 train_loss:3.3271 train_time:309701ms step_avg:355.98ms
step:881/1750 train_loss:3.5053 train_time:310070ms step_avg:355.99ms
step:882/1750 train_loss:3.7189 train_time:310438ms step_avg:356.01ms
step:883/1750 train_loss:3.8581 train_time:310805ms step_avg:356.02ms
step:884/1750 train_loss:3.5867 train_time:311175ms step_avg:356.04ms
step:885/1750 train_loss:3.5082 train_time:311545ms step_avg:356.05ms
step:886/1750 train_loss:3.5913 train_time:311914ms step_avg:356.07ms
step:887/1750 train_loss:4.1168 train_time:312283ms step_avg:356.08ms
step:888/1750 train_loss:3.8596 train_time:312662ms step_avg:356.11ms
step:889/1750 train_loss:3.5434 train_time:313032ms step_avg:356.12ms
step:890/1750 train_loss:3.5491 train_time:313397ms step_avg:356.13ms
step:891/1750 train_loss:3.3802 train_time:313766ms step_avg:356.15ms
step:892/1750 train_loss:3.7431 train_time:314134ms step_avg:356.16ms
step:893/1750 train_loss:3.4454 train_time:314501ms step_avg:356.17ms
step:894/1750 train_loss:3.6594 train_time:314874ms step_avg:356.19ms
step:895/1750 train_loss:3.7022 train_time:315246ms step_avg:356.21ms
step:896/1750 train_loss:3.5237 train_time:315615ms step_avg:356.22ms
step:897/1750 train_loss:3.5601 train_time:315985ms step_avg:356.24ms
step:898/1750 train_loss:3.6135 train_time:316355ms step_avg:356.26ms
step:899/1750 train_loss:3.5007 train_time:316724ms step_avg:356.27ms
step:900/1750 train_loss:3.4408 train_time:317096ms step_avg:356.29ms
step:901/1750 train_loss:3.6426 train_time:317463ms step_avg:356.30ms
step:902/1750 train_loss:3.6568 train_time:317830ms step_avg:356.31ms
step:903/1750 train_loss:3.5627 train_time:318203ms step_avg:356.33ms
step:904/1750 train_loss:3.5167 train_time:318574ms step_avg:356.35ms
step:905/1750 train_loss:3.5242 train_time:318941ms step_avg:356.36ms
step:906/1750 train_loss:3.7321 train_time:319315ms step_avg:356.38ms
step:907/1750 train_loss:3.5387 train_time:319687ms step_avg:356.40ms
step:908/1750 train_loss:3.5933 train_time:320055ms step_avg:356.41ms
step:909/1750 train_loss:3.4696 train_time:320434ms step_avg:356.43ms
step:910/1750 train_loss:3.5469 train_time:320818ms step_avg:356.46ms
step:911/1750 train_loss:3.6655 train_time:321191ms step_avg:356.48ms
step:912/1750 train_loss:3.6209 train_time:321569ms step_avg:356.51ms
step:913/1750 train_loss:3.4837 train_time:321947ms step_avg:356.53ms
step:914/1750 train_loss:3.7671 train_time:322327ms step_avg:356.56ms
step:915/1750 train_loss:3.5513 train_time:322708ms step_avg:356.58ms
step:916/1750 train_loss:3.6425 train_time:323083ms step_avg:356.60ms
step:917/1750 train_loss:3.6189 train_time:323457ms step_avg:356.62ms
step:918/1750 train_loss:4.8401 train_time:323840ms step_avg:356.65ms
step:919/1750 train_loss:3.5155 train_time:324221ms step_avg:356.68ms
step:920/1750 train_loss:3.6046 train_time:324594ms step_avg:356.70ms
step:921/1750 train_loss:3.5657 train_time:324971ms step_avg:356.72ms
step:922/1750 train_loss:3.6099 train_time:325351ms step_avg:356.74ms
step:923/1750 train_loss:3.6318 train_time:325723ms step_avg:356.76ms
step:924/1750 train_loss:3.7009 train_time:326098ms step_avg:356.78ms
step:925/1750 train_loss:3.6678 train_time:326475ms step_avg:356.80ms
step:926/1750 train_loss:3.5805 train_time:326846ms step_avg:356.82ms
step:927/1750 train_loss:3.5752 train_time:327215ms step_avg:356.83ms
step:928/1750 train_loss:3.8045 train_time:327592ms step_avg:356.85ms
step:929/1750 train_loss:3.6281 train_time:327969ms step_avg:356.88ms
step:930/1750 train_loss:3.4238 train_time:328345ms step_avg:356.90ms
step:931/1750 train_loss:3.5268 train_time:328715ms step_avg:356.91ms
step:932/1750 train_loss:3.6719 train_time:329090ms step_avg:356.93ms
step:933/1750 train_loss:3.4021 train_time:329467ms step_avg:356.95ms
step:934/1750 train_loss:3.6104 train_time:329844ms step_avg:356.97ms
step:935/1750 train_loss:3.4673 train_time:330223ms step_avg:357.00ms
step:936/1750 train_loss:3.5391 train_time:330603ms step_avg:357.02ms
step:937/1750 train_loss:3.6453 train_time:330983ms step_avg:357.05ms
step:938/1750 train_loss:3.5631 train_time:331356ms step_avg:357.07ms
step:939/1750 train_loss:3.6921 train_time:331741ms step_avg:357.10ms
step:940/1750 train_loss:3.5005 train_time:332117ms step_avg:357.11ms
step:941/1750 train_loss:3.5637 train_time:332490ms step_avg:357.13ms
step:942/1750 train_loss:3.3799 train_time:332865ms step_avg:357.15ms
step:943/1750 train_loss:3.7342 train_time:333246ms step_avg:357.18ms
step:944/1750 train_loss:3.4251 train_time:333684ms step_avg:357.26ms
step:945/1750 train_loss:3.4464 train_time:334141ms step_avg:357.37ms
step:946/1750 train_loss:5.0958 train_time:334526ms step_avg:357.40ms
step:947/1750 train_loss:3.6252 train_time:334901ms step_avg:357.42ms
step:948/1750 train_loss:3.5063 train_time:335274ms step_avg:357.44ms
step:949/1750 train_loss:3.4027 train_time:335783ms step_avg:357.60ms
step:950/1750 train_loss:3.4580 train_time:336178ms step_avg:357.64ms
step:951/1750 train_loss:3.4310 train_time:336557ms step_avg:357.66ms
step:952/1750 train_loss:3.5014 train_time:336930ms step_avg:357.67ms
step:953/1750 train_loss:3.5934 train_time:337309ms step_avg:357.70ms
step:954/1750 train_loss:3.4671 train_time:337691ms step_avg:357.72ms
step:955/1750 train_loss:3.4989 train_time:338061ms step_avg:357.74ms
step:956/1750 train_loss:3.4687 train_time:338438ms step_avg:357.76ms
step:957/1750 train_loss:3.5242 train_time:338825ms step_avg:357.79ms
step:958/1750 train_loss:3.5285 train_time:339210ms step_avg:357.82ms
step:959/1750 train_loss:3.5365 train_time:339585ms step_avg:357.83ms
step:960/1750 train_loss:3.4301 train_time:339961ms step_avg:357.85ms
step:961/1750 train_loss:3.6764 train_time:340334ms step_avg:357.87ms
step:962/1750 train_loss:3.6252 train_time:340708ms step_avg:357.89ms
step:963/1750 train_loss:3.7474 train_time:341085ms step_avg:357.91ms
step:964/1750 train_loss:3.4524 train_time:341466ms step_avg:357.93ms
step:965/1750 train_loss:3.5067 train_time:341838ms step_avg:357.95ms
step:966/1750 train_loss:3.7390 train_time:342211ms step_avg:357.96ms
step:967/1750 train_loss:3.5535 train_time:342582ms step_avg:357.97ms
step:968/1750 train_loss:3.5509 train_time:342959ms step_avg:358.00ms
step:969/1750 train_loss:3.6099 train_time:343336ms step_avg:358.01ms
step:970/1750 train_loss:3.4001 train_time:343711ms step_avg:358.03ms
step:971/1750 train_loss:3.5696 train_time:344085ms step_avg:358.05ms
step:972/1750 train_loss:3.5044 train_time:344456ms step_avg:358.06ms
step:973/1750 train_loss:3.5712 train_time:344827ms step_avg:358.08ms
step:974/1750 train_loss:3.6214 train_time:345203ms step_avg:358.09ms
step:975/1750 train_loss:3.5010 train_time:345577ms step_avg:358.11ms
step:976/1750 train_loss:3.6980 train_time:345949ms step_avg:358.12ms
step:977/1750 train_loss:3.6010 train_time:346317ms step_avg:358.14ms
step:978/1750 train_loss:3.3970 train_time:346688ms step_avg:358.15ms
step:979/1750 train_loss:3.6550 train_time:347062ms step_avg:358.17ms
step:980/1750 train_loss:3.4412 train_time:347441ms step_avg:358.19ms
step:981/1750 train_loss:3.6074 train_time:347820ms step_avg:358.21ms
step:982/1750 train_loss:3.5724 train_time:348192ms step_avg:358.22ms
step:983/1750 train_loss:3.5540 train_time:348568ms step_avg:358.24ms
step:984/1750 train_loss:3.5257 train_time:348941ms step_avg:358.26ms
step:985/1750 train_loss:3.6134 train_time:349319ms step_avg:358.28ms
step:986/1750 train_loss:3.4436 train_time:349694ms step_avg:358.29ms
step:987/1750 train_loss:3.5182 train_time:350062ms step_avg:358.30ms
step:988/1750 train_loss:3.5339 train_time:350433ms step_avg:358.32ms
step:989/1750 train_loss:3.4496 train_time:350803ms step_avg:358.33ms
step:990/1750 train_loss:3.6857 train_time:351177ms step_avg:358.34ms
step:991/1750 train_loss:3.5041 train_time:351553ms step_avg:358.36ms
step:992/1750 train_loss:3.4750 train_time:351943ms step_avg:358.39ms
step:993/1750 train_loss:3.5401 train_time:352329ms step_avg:358.42ms
step:994/1750 train_loss:3.6274 train_time:352699ms step_avg:358.43ms
step:995/1750 train_loss:3.5653 train_time:353070ms step_avg:358.45ms
step:996/1750 train_loss:3.4894 train_time:353439ms step_avg:358.46ms
step:997/1750 train_loss:3.8117 train_time:353810ms step_avg:358.47ms
step:998/1750 train_loss:3.4761 train_time:354180ms step_avg:358.48ms
step:999/1750 train_loss:3.6250 train_time:354553ms step_avg:358.50ms
step:1000/1750 train_loss:3.4765 train_time:354931ms step_avg:358.52ms
step:1000/1750 val_loss:3.5031 train_time:355026ms step_avg:358.61ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 269.21893 | frobenius_norm = 62021.33984 | spectral_norm = 11023.96582 | nuclear_norm = 1558405.37500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 163.58716 | spectral_norm = 28.27212 | nuclear_norm = 3768.48975
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 159.02390 | spectral_norm = 31.41106 | nuclear_norm = 3649.42334
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 309.27905 | spectral_norm = 20.12255 | nuclear_norm = 7493.56006
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 225.63373 | spectral_norm = 24.64355 | nuclear_norm = 5211.93359
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 348.94495 | spectral_norm = 30.04982 | nuclear_norm = 9279.68262
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 178.66663 | spectral_norm = 16.39251 | nuclear_norm = 4739.82080
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 165.36708 | spectral_norm = 15.63844 | nuclear_norm = 3831.24854
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 162.43024 | spectral_norm = 16.02210 | nuclear_norm = 3759.19434
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 296.22763 | spectral_norm = 26.57813 | nuclear_norm = 6826.31348
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 288.27408 | spectral_norm = 22.51843 | nuclear_norm = 6781.16699
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 349.92200 | spectral_norm = 26.08805 | nuclear_norm = 9326.54785
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 171.98071 | spectral_norm = 17.31925 | nuclear_norm = 4508.10547
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 161.79944 | spectral_norm = 18.85441 | nuclear_norm = 3722.08008
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 158.93719 | spectral_norm = 16.09107 | nuclear_norm = 3673.22021
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 287.76770 | spectral_norm = 25.07673 | nuclear_norm = 6540.06445
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 297.05527 | spectral_norm = 23.52912 | nuclear_norm = 6896.67041
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 355.13751 | spectral_norm = 27.52558 | nuclear_norm = 9440.55176
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 179.62415 | spectral_norm = 18.83700 | nuclear_norm = 4723.19043
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 156.68800 | spectral_norm = 14.56850 | nuclear_norm = 3484.69385
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 157.34509 | spectral_norm = 13.87726 | nuclear_norm = 3514.24268
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 315.38388 | spectral_norm = 28.48249 | nuclear_norm = 7138.52539
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 322.42526 | spectral_norm = 24.02880 | nuclear_norm = 7607.39844
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 354.24878 | spectral_norm = 31.91353 | nuclear_norm = 9424.30078
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 176.65305 | spectral_norm = 16.94362 | nuclear_norm = 4657.08057
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 162.12566 | spectral_norm = 16.51489 | nuclear_norm = 3703.49365
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 160.36725 | spectral_norm = 14.58260 | nuclear_norm = 3674.41260
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 316.47467 | spectral_norm = 27.94417 | nuclear_norm = 7128.14551
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 319.73499 | spectral_norm = 24.96609 | nuclear_norm = 7449.24902
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 368.51712 | spectral_norm = 32.04689 | nuclear_norm = 9790.21582
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 176.22597 | spectral_norm = 16.92741 | nuclear_norm = 4628.09521
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 158.24280 | spectral_norm = 16.60953 | nuclear_norm = 3601.76611
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 155.85101 | spectral_norm = 16.17500 | nuclear_norm = 3564.37646
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 315.29080 | spectral_norm = 27.16716 | nuclear_norm = 7248.80371
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 311.02264 | spectral_norm = 23.04212 | nuclear_norm = 7310.45312
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 371.33804 | spectral_norm = 28.31801 | nuclear_norm = 9896.35938
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 177.80667 | spectral_norm = 17.13990 | nuclear_norm = 4681.26123
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 157.60371 | spectral_norm = 15.55109 | nuclear_norm = 3576.96484
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 155.18430 | spectral_norm = 14.87398 | nuclear_norm = 3545.50146
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 321.13895 | spectral_norm = 27.41997 | nuclear_norm = 7289.25098
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 313.82144 | spectral_norm = 23.23148 | nuclear_norm = 7392.22266
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 363.61371 | spectral_norm = 27.43617 | nuclear_norm = 9710.01270
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 176.93304 | spectral_norm = 16.96411 | nuclear_norm = 4653.28906
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 159.30128 | spectral_norm = 16.05744 | nuclear_norm = 3623.89355
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 156.83279 | spectral_norm = 15.45897 | nuclear_norm = 3582.34473
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 311.23917 | spectral_norm = 26.44273 | nuclear_norm = 7068.07227
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 307.24326 | spectral_norm = 24.53694 | nuclear_norm = 7148.31152
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 365.50064 | spectral_norm = 29.47081 | nuclear_norm = 9717.49414
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 181.43439 | spectral_norm = 18.03284 | nuclear_norm = 4789.20410
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 161.69872 | spectral_norm = 16.42199 | nuclear_norm = 3609.07031
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 162.28297 | spectral_norm = 15.80758 | nuclear_norm = 3593.89941
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 344.04572 | spectral_norm = 33.37510 | nuclear_norm = 7767.39795
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 332.68362 | spectral_norm = 23.66384 | nuclear_norm = 7777.19092
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 356.96500 | spectral_norm = 28.58549 | nuclear_norm = 9484.74805
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 182.74081 | spectral_norm = 17.75023 | nuclear_norm = 4844.17920
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 164.77846 | spectral_norm = 16.18726 | nuclear_norm = 3723.92090
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 163.76430 | spectral_norm = 16.67327 | nuclear_norm = 3689.37207
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 323.86240 | spectral_norm = 33.80172 | nuclear_norm = 7314.81250
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 320.05972 | spectral_norm = 26.06472 | nuclear_norm = 7522.54492
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 367.85962 | spectral_norm = 31.86676 | nuclear_norm = 9774.06152
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 185.64319 | spectral_norm = 18.13027 | nuclear_norm = 4920.12500
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 161.51717 | spectral_norm = 19.31105 | nuclear_norm = 3567.85547
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 160.25543 | spectral_norm = 17.85793 | nuclear_norm = 3495.63354
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 326.99677 | spectral_norm = 32.94293 | nuclear_norm = 7513.41992
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 341.99515 | spectral_norm = 23.50616 | nuclear_norm = 8075.89453
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 366.11536 | spectral_norm = 27.84036 | nuclear_norm = 9763.98340
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 175.23712 | spectral_norm = 20.37415 | nuclear_norm = 4630.67188
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 168.58621 | spectral_norm = 19.85369 | nuclear_norm = 3810.27124
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 162.43840 | spectral_norm = 18.87914 | nuclear_norm = 3657.70459
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 303.29425 | spectral_norm = 30.04890 | nuclear_norm = 6945.74121
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 334.72195 | spectral_norm = 24.33256 | nuclear_norm = 7853.69141
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 385.33484 | spectral_norm = 31.24219 | nuclear_norm = 10243.55371
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 188.04541 | spectral_norm = 22.73077 | nuclear_norm = 4933.94141
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1168.75439 | spectral_norm = 165.99808 | nuclear_norm = 30657.12109
===========================================
step:1001/1750 train_loss:3.5338 train_time:355294ms step_avg:358.52ms
step:1002/1750 train_loss:3.4178 train_time:355656ms step_avg:358.52ms
step:1003/1750 train_loss:3.5902 train_time:356031ms step_avg:358.54ms
step:1004/1750 train_loss:3.6431 train_time:356406ms step_avg:358.56ms
step:1005/1750 train_loss:3.4238 train_time:356775ms step_avg:358.57ms
step:1006/1750 train_loss:3.5015 train_time:357149ms step_avg:358.58ms
step:1007/1750 train_loss:3.4731 train_time:357521ms step_avg:358.60ms
step:1008/1750 train_loss:3.6000 train_time:357897ms step_avg:358.61ms
step:1009/1750 train_loss:3.7011 train_time:358279ms step_avg:358.64ms
step:1010/1750 train_loss:3.5979 train_time:358649ms step_avg:358.65ms
step:1011/1750 train_loss:3.5729 train_time:359018ms step_avg:358.66ms
step:1012/1750 train_loss:3.4250 train_time:359388ms step_avg:358.67ms
step:1013/1750 train_loss:3.5793 train_time:359763ms step_avg:358.69ms
step:1014/1750 train_loss:3.6595 train_time:360139ms step_avg:358.70ms
step:1015/1750 train_loss:3.3659 train_time:360518ms step_avg:358.72ms
step:1016/1750 train_loss:3.4507 train_time:360889ms step_avg:358.74ms
step:1017/1750 train_loss:3.4356 train_time:361265ms step_avg:358.75ms
step:1018/1750 train_loss:3.4267 train_time:361642ms step_avg:358.77ms
step:1019/1750 train_loss:3.5589 train_time:362016ms step_avg:358.79ms
step:1020/1750 train_loss:3.4260 train_time:362389ms step_avg:358.80ms
step:1021/1750 train_loss:3.3899 train_time:362759ms step_avg:358.81ms
step:1022/1750 train_loss:3.5178 train_time:363133ms step_avg:358.83ms
step:1023/1750 train_loss:3.5467 train_time:363507ms step_avg:358.84ms
step:1024/1750 train_loss:3.5176 train_time:363879ms step_avg:358.85ms
step:1025/1750 train_loss:3.5149 train_time:364253ms step_avg:358.87ms
step:1026/1750 train_loss:3.6670 train_time:364624ms step_avg:358.88ms
step:1027/1750 train_loss:3.3598 train_time:364993ms step_avg:358.89ms
step:1028/1750 train_loss:3.4354 train_time:365370ms step_avg:358.91ms
step:1029/1750 train_loss:3.3596 train_time:365748ms step_avg:358.93ms
step:1030/1750 train_loss:3.5792 train_time:366121ms step_avg:358.94ms
step:1031/1750 train_loss:3.5548 train_time:366496ms step_avg:358.96ms
step:1032/1750 train_loss:3.7425 train_time:366876ms step_avg:358.98ms
step:1033/1750 train_loss:3.5335 train_time:367244ms step_avg:358.99ms
step:1034/1750 train_loss:3.4435 train_time:367616ms step_avg:359.00ms
step:1035/1750 train_loss:3.4886 train_time:367989ms step_avg:359.01ms
step:1036/1750 train_loss:3.5241 train_time:368359ms step_avg:359.02ms
step:1037/1750 train_loss:3.8363 train_time:368729ms step_avg:359.04ms
step:1038/1750 train_loss:3.6646 train_time:369102ms step_avg:359.05ms
step:1039/1750 train_loss:3.5563 train_time:369484ms step_avg:359.07ms
step:1040/1750 train_loss:3.4602 train_time:369862ms step_avg:359.09ms
step:1041/1750 train_loss:3.5278 train_time:370239ms step_avg:359.11ms
step:1042/1750 train_loss:3.5728 train_time:370609ms step_avg:359.12ms
step:1043/1750 train_loss:3.4891 train_time:370981ms step_avg:359.13ms
step:1044/1750 train_loss:3.5006 train_time:371359ms step_avg:359.15ms
step:1045/1750 train_loss:3.5602 train_time:371736ms step_avg:359.17ms
step:1046/1750 train_loss:3.4687 train_time:372113ms step_avg:359.18ms
step:1047/1750 train_loss:3.6872 train_time:372490ms step_avg:359.20ms
step:1048/1750 train_loss:3.5389 train_time:372868ms step_avg:359.22ms
step:1049/1750 train_loss:3.4466 train_time:373248ms step_avg:359.24ms
step:1050/1750 train_loss:3.4384 train_time:373632ms step_avg:359.26ms
step:1051/1750 train_loss:3.5491 train_time:374016ms step_avg:359.28ms
step:1052/1750 train_loss:3.4051 train_time:374397ms step_avg:359.31ms
step:1053/1750 train_loss:3.7441 train_time:374776ms step_avg:359.33ms
step:1054/1750 train_loss:3.5903 train_time:375157ms step_avg:359.35ms
step:1055/1750 train_loss:3.4315 train_time:375531ms step_avg:359.36ms
step:1056/1750 train_loss:3.5473 train_time:375908ms step_avg:359.38ms
step:1057/1750 train_loss:3.6283 train_time:376289ms step_avg:359.40ms
step:1058/1750 train_loss:3.3562 train_time:376667ms step_avg:359.42ms
step:1059/1750 train_loss:3.4161 train_time:377052ms step_avg:359.44ms
step:1060/1750 train_loss:3.4891 train_time:377432ms step_avg:359.46ms
step:1061/1750 train_loss:3.4643 train_time:377805ms step_avg:359.47ms
step:1062/1750 train_loss:3.4322 train_time:378181ms step_avg:359.49ms
step:1063/1750 train_loss:3.5159 train_time:378555ms step_avg:359.50ms
step:1064/1750 train_loss:3.4332 train_time:378928ms step_avg:359.51ms
step:1065/1750 train_loss:3.4087 train_time:379311ms step_avg:359.54ms
step:1066/1750 train_loss:3.4579 train_time:379693ms step_avg:359.56ms
step:1067/1750 train_loss:3.3406 train_time:380074ms step_avg:359.58ms
step:1068/1750 train_loss:3.4806 train_time:380455ms step_avg:359.60ms
step:1069/1750 train_loss:3.3508 train_time:380841ms step_avg:359.62ms
step:1070/1750 train_loss:3.6172 train_time:381217ms step_avg:359.64ms
step:1071/1750 train_loss:3.5649 train_time:381600ms step_avg:359.66ms
step:1072/1750 train_loss:3.4867 train_time:381973ms step_avg:359.67ms
step:1073/1750 train_loss:3.5789 train_time:382346ms step_avg:359.69ms
step:1074/1750 train_loss:3.4886 train_time:382724ms step_avg:359.70ms
step:1075/1750 train_loss:3.4456 train_time:383101ms step_avg:359.72ms
step:1076/1750 train_loss:3.8483 train_time:383475ms step_avg:359.73ms
step:1077/1750 train_loss:3.4882 train_time:383849ms step_avg:359.75ms
step:1078/1750 train_loss:3.1463 train_time:384246ms step_avg:359.78ms
step:1079/1750 train_loss:3.5840 train_time:384631ms step_avg:359.80ms
step:1080/1750 train_loss:3.4785 train_time:385011ms step_avg:359.82ms
step:1081/1750 train_loss:3.5594 train_time:385385ms step_avg:359.84ms
step:1082/1750 train_loss:3.6475 train_time:385762ms step_avg:359.85ms
step:1083/1750 train_loss:3.5568 train_time:386137ms step_avg:359.87ms
step:1084/1750 train_loss:3.5276 train_time:386517ms step_avg:359.89ms
step:1085/1750 train_loss:3.4863 train_time:386896ms step_avg:359.90ms
step:1086/1750 train_loss:3.6890 train_time:387276ms step_avg:359.92ms
step:1087/1750 train_loss:3.5665 train_time:387656ms step_avg:359.94ms
step:1088/1750 train_loss:3.4206 train_time:388040ms step_avg:359.96ms
step:1089/1750 train_loss:3.4370 train_time:388430ms step_avg:359.99ms
step:1090/1750 train_loss:3.5410 train_time:388816ms step_avg:360.02ms
step:1091/1750 train_loss:3.3414 train_time:389197ms step_avg:360.03ms
step:1092/1750 train_loss:3.5489 train_time:389582ms step_avg:360.06ms
step:1093/1750 train_loss:3.6727 train_time:389961ms step_avg:360.08ms
step:1094/1750 train_loss:3.5020 train_time:390338ms step_avg:360.09ms
step:1095/1750 train_loss:3.4734 train_time:390718ms step_avg:360.11ms
step:1096/1750 train_loss:3.4844 train_time:391103ms step_avg:360.13ms
step:1097/1750 train_loss:3.5412 train_time:391486ms step_avg:360.15ms
step:1098/1750 train_loss:3.6176 train_time:391864ms step_avg:360.17ms
step:1099/1750 train_loss:3.5855 train_time:392244ms step_avg:360.19ms
step:1100/1750 train_loss:3.4932 train_time:392632ms step_avg:360.21ms
step:1101/1750 train_loss:3.3466 train_time:393012ms step_avg:360.23ms
step:1102/1750 train_loss:3.3702 train_time:393398ms step_avg:360.25ms
step:1103/1750 train_loss:3.5091 train_time:393785ms step_avg:360.28ms
step:1104/1750 train_loss:3.3781 train_time:394159ms step_avg:360.29ms
step:1105/1750 train_loss:4.1221 train_time:394539ms step_avg:360.31ms
step:1106/1750 train_loss:3.2924 train_time:394914ms step_avg:360.32ms
step:1107/1750 train_loss:3.6308 train_time:395290ms step_avg:360.34ms
step:1108/1750 train_loss:3.4010 train_time:395662ms step_avg:360.35ms
step:1109/1750 train_loss:3.5631 train_time:396038ms step_avg:360.36ms
step:1110/1750 train_loss:3.4903 train_time:396415ms step_avg:360.38ms
step:1111/1750 train_loss:3.5428 train_time:396792ms step_avg:360.39ms
step:1112/1750 train_loss:3.6246 train_time:397177ms step_avg:360.41ms
step:1113/1750 train_loss:3.4993 train_time:397568ms step_avg:360.44ms
step:1114/1750 train_loss:3.4211 train_time:397946ms step_avg:360.46ms
step:1115/1750 train_loss:3.3124 train_time:398324ms step_avg:360.47ms
step:1116/1750 train_loss:3.4895 train_time:398699ms step_avg:360.49ms
step:1117/1750 train_loss:3.6651 train_time:399082ms step_avg:360.51ms
step:1118/1750 train_loss:3.6921 train_time:399462ms step_avg:360.52ms
step:1119/1750 train_loss:3.5418 train_time:399836ms step_avg:360.54ms
step:1120/1750 train_loss:3.5544 train_time:400215ms step_avg:360.55ms
step:1121/1750 train_loss:3.4528 train_time:400595ms step_avg:360.57ms
step:1122/1750 train_loss:3.5194 train_time:400969ms step_avg:360.58ms
step:1123/1750 train_loss:3.6555 train_time:401346ms step_avg:360.60ms
step:1124/1750 train_loss:3.4128 train_time:401723ms step_avg:360.61ms
step:1125/1750 train_loss:3.2830 train_time:402100ms step_avg:360.63ms
step:1125/1750 val_loss:3.4738 train_time:402201ms step_avg:360.72ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 280.97510 | frobenius_norm = 64781.71875 | spectral_norm = 11479.04199 | nuclear_norm = 1630596.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 174.95354 | spectral_norm = 31.28566 | nuclear_norm = 4021.40674
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 170.30002 | spectral_norm = 34.59457 | nuclear_norm = 3902.51099
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 329.60101 | spectral_norm = 21.55316 | nuclear_norm = 8008.18457
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 233.96439 | spectral_norm = 26.31849 | nuclear_norm = 5388.01074
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 376.84607 | spectral_norm = 32.77332 | nuclear_norm = 10023.93652
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 191.71802 | spectral_norm = 17.89879 | nuclear_norm = 5085.79199
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 177.36646 | spectral_norm = 16.98526 | nuclear_norm = 4105.18506
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 174.28191 | spectral_norm = 17.22359 | nuclear_norm = 4029.49097
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 315.24805 | spectral_norm = 28.58931 | nuclear_norm = 7262.75977
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 306.55405 | spectral_norm = 24.14229 | nuclear_norm = 7211.76123
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 375.07916 | spectral_norm = 28.57524 | nuclear_norm = 10001.68945
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 184.12042 | spectral_norm = 18.73771 | nuclear_norm = 4824.63623
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 173.43098 | spectral_norm = 20.79021 | nuclear_norm = 3984.28125
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 170.56842 | spectral_norm = 17.33595 | nuclear_norm = 3937.75732
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 307.46521 | spectral_norm = 26.82515 | nuclear_norm = 6986.04297
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 316.93784 | spectral_norm = 25.30255 | nuclear_norm = 7355.85303
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 380.23413 | spectral_norm = 29.96671 | nuclear_norm = 10107.90625
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 192.44287 | spectral_norm = 20.47087 | nuclear_norm = 5058.37061
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 167.57091 | spectral_norm = 15.74364 | nuclear_norm = 3713.39917
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 168.42920 | spectral_norm = 15.10950 | nuclear_norm = 3751.25635
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 337.73935 | spectral_norm = 30.75005 | nuclear_norm = 7641.02881
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 344.31049 | spectral_norm = 25.60156 | nuclear_norm = 8122.39307
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 379.24619 | spectral_norm = 35.00111 | nuclear_norm = 10087.29004
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 189.30441 | spectral_norm = 18.39046 | nuclear_norm = 4989.70801
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 173.95094 | spectral_norm = 17.94364 | nuclear_norm = 3967.03467
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 172.02275 | spectral_norm = 15.66333 | nuclear_norm = 3933.14453
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 339.83014 | spectral_norm = 29.88044 | nuclear_norm = 7654.56201
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 342.76727 | spectral_norm = 26.90894 | nuclear_norm = 7986.11816
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 394.52722 | spectral_norm = 35.14259 | nuclear_norm = 10480.81836
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 188.66884 | spectral_norm = 18.43925 | nuclear_norm = 4955.97754
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 169.58110 | spectral_norm = 18.00814 | nuclear_norm = 3850.66992
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 166.93428 | spectral_norm = 17.47800 | nuclear_norm = 3812.68262
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 338.05231 | spectral_norm = 29.18022 | nuclear_norm = 7780.57910
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 332.97549 | spectral_norm = 24.63754 | nuclear_norm = 7831.34668
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 397.51273 | spectral_norm = 30.85586 | nuclear_norm = 10595.43555
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 190.33150 | spectral_norm = 18.72174 | nuclear_norm = 5012.60840
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 168.94084 | spectral_norm = 16.76193 | nuclear_norm = 3824.28223
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 166.30028 | spectral_norm = 16.16645 | nuclear_norm = 3793.06299
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 343.50635 | spectral_norm = 29.62407 | nuclear_norm = 7805.59961
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 335.38046 | spectral_norm = 24.80140 | nuclear_norm = 7906.03027
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 390.55280 | spectral_norm = 29.84503 | nuclear_norm = 10433.28320
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 189.53806 | spectral_norm = 18.60929 | nuclear_norm = 4984.19629
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 170.57860 | spectral_norm = 17.37508 | nuclear_norm = 3871.47559
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 168.15651 | spectral_norm = 16.88736 | nuclear_norm = 3834.32910
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 331.64807 | spectral_norm = 28.39111 | nuclear_norm = 7531.52783
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 326.62671 | spectral_norm = 26.03238 | nuclear_norm = 7585.84180
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 393.30405 | spectral_norm = 32.27120 | nuclear_norm = 10453.23047
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 194.52745 | spectral_norm = 19.89601 | nuclear_norm = 5132.97656
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 173.12492 | spectral_norm = 17.81581 | nuclear_norm = 3849.55737
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 174.17633 | spectral_norm = 17.05001 | nuclear_norm = 3844.52881
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 367.10403 | spectral_norm = 36.67125 | nuclear_norm = 8268.16797
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 354.89539 | spectral_norm = 25.22490 | nuclear_norm = 8297.57617
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 383.10635 | spectral_norm = 31.22531 | nuclear_norm = 10174.62695
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 195.98654 | spectral_norm = 19.41895 | nuclear_norm = 5195.44531
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 176.64081 | spectral_norm = 17.57242 | nuclear_norm = 3981.18237
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 175.66383 | spectral_norm = 18.19603 | nuclear_norm = 3949.35254
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 346.34467 | spectral_norm = 36.83853 | nuclear_norm = 7805.25781
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 342.19055 | spectral_norm = 28.17054 | nuclear_norm = 8036.66748
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 395.40329 | spectral_norm = 34.75676 | nuclear_norm = 10503.22852
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 199.42915 | spectral_norm = 19.84800 | nuclear_norm = 5287.27832
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 172.98322 | spectral_norm = 21.04539 | nuclear_norm = 3805.13647
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 171.84949 | spectral_norm = 19.47773 | nuclear_norm = 3734.86279
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 349.51944 | spectral_norm = 35.87867 | nuclear_norm = 8022.72559
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 365.39441 | spectral_norm = 25.11851 | nuclear_norm = 8630.27930
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 392.69650 | spectral_norm = 30.40372 | nuclear_norm = 10470.94531
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 187.88918 | spectral_norm = 22.21378 | nuclear_norm = 4965.21680
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 180.84529 | spectral_norm = 21.64655 | nuclear_norm = 4075.11938
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 173.96576 | spectral_norm = 20.54087 | nuclear_norm = 3903.70581
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 326.26627 | spectral_norm = 32.84591 | nuclear_norm = 7466.42432
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 360.57562 | spectral_norm = 26.18052 | nuclear_norm = 8453.24805
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 413.77396 | spectral_norm = 33.92859 | nuclear_norm = 10995.48242
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 204.19264 | spectral_norm = 25.23334 | nuclear_norm = 5358.89551
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1240.03687 | spectral_norm = 166.86188 | nuclear_norm = 32617.36133
===========================================
step:1126/1750 train_loss:3.5404 train_time:402468ms step_avg:360.63ms
step:1127/1750 train_loss:3.7417 train_time:402835ms step_avg:360.64ms
step:1128/1750 train_loss:3.2940 train_time:403211ms step_avg:360.65ms
step:1129/1750 train_loss:3.6254 train_time:403589ms step_avg:360.67ms
step:1130/1750 train_loss:3.4449 train_time:403967ms step_avg:360.69ms
step:1131/1750 train_loss:3.4602 train_time:404354ms step_avg:360.71ms
step:1132/1750 train_loss:3.4290 train_time:404723ms step_avg:360.72ms
step:1133/1750 train_loss:3.5661 train_time:405163ms step_avg:360.79ms
step:1134/1750 train_loss:3.5173 train_time:405661ms step_avg:360.91ms
step:1135/1750 train_loss:3.5843 train_time:406034ms step_avg:360.92ms
step:1136/1750 train_loss:3.6200 train_time:406408ms step_avg:360.93ms
step:1137/1750 train_loss:3.5243 train_time:406783ms step_avg:360.94ms
step:1138/1750 train_loss:3.4235 train_time:407160ms step_avg:360.96ms
step:1139/1750 train_loss:3.7172 train_time:407668ms step_avg:361.09ms
step:1140/1750 train_loss:3.5277 train_time:408056ms step_avg:361.11ms
step:1141/1750 train_loss:3.6542 train_time:408438ms step_avg:361.13ms
step:1142/1750 train_loss:3.5263 train_time:408818ms step_avg:361.15ms
step:1143/1750 train_loss:3.4278 train_time:409201ms step_avg:361.17ms
step:1144/1750 train_loss:3.5112 train_time:409576ms step_avg:361.18ms
step:1145/1750 train_loss:3.6554 train_time:409948ms step_avg:361.19ms
step:1146/1750 train_loss:3.6175 train_time:410329ms step_avg:361.21ms
step:1147/1750 train_loss:3.5487 train_time:410707ms step_avg:361.22ms
step:1148/1750 train_loss:3.5604 train_time:411081ms step_avg:361.23ms
step:1149/1750 train_loss:3.3940 train_time:411459ms step_avg:361.25ms
step:1150/1750 train_loss:3.4325 train_time:411831ms step_avg:361.26ms
step:1151/1750 train_loss:3.3862 train_time:412209ms step_avg:361.27ms
step:1152/1750 train_loss:3.4649 train_time:412591ms step_avg:361.29ms
step:1153/1750 train_loss:3.4965 train_time:412970ms step_avg:361.30ms
step:1154/1750 train_loss:3.5870 train_time:413341ms step_avg:361.31ms
step:1155/1750 train_loss:3.3953 train_time:413723ms step_avg:361.33ms
step:1156/1750 train_loss:3.6054 train_time:414109ms step_avg:361.35ms
step:1157/1750 train_loss:3.5636 train_time:414487ms step_avg:361.37ms
step:1158/1750 train_loss:3.3292 train_time:414863ms step_avg:361.38ms
step:1159/1750 train_loss:3.4062 train_time:415239ms step_avg:361.39ms
step:1160/1750 train_loss:3.3979 train_time:415609ms step_avg:361.40ms
step:1161/1750 train_loss:3.1497 train_time:415987ms step_avg:361.41ms
step:1162/1750 train_loss:3.4855 train_time:416363ms step_avg:361.43ms
step:1163/1750 train_loss:3.4477 train_time:416739ms step_avg:361.44ms
step:1164/1750 train_loss:3.3561 train_time:417115ms step_avg:361.45ms
step:1165/1750 train_loss:3.3148 train_time:417487ms step_avg:361.46ms
step:1166/1750 train_loss:3.4520 train_time:417863ms step_avg:361.47ms
step:1167/1750 train_loss:3.4707 train_time:418236ms step_avg:361.48ms
step:1168/1750 train_loss:3.7938 train_time:418613ms step_avg:361.50ms
step:1169/1750 train_loss:3.4440 train_time:418995ms step_avg:361.51ms
step:1170/1750 train_loss:3.4497 train_time:419376ms step_avg:361.53ms
step:1171/1750 train_loss:3.4283 train_time:419757ms step_avg:361.55ms
step:1172/1750 train_loss:3.4901 train_time:420136ms step_avg:361.56ms
step:1173/1750 train_loss:3.6011 train_time:420526ms step_avg:361.59ms
step:1174/1750 train_loss:3.4541 train_time:420926ms step_avg:361.62ms
step:1175/1750 train_loss:3.4429 train_time:421312ms step_avg:361.64ms
step:1176/1750 train_loss:3.4914 train_time:421706ms step_avg:361.67ms
step:1177/1750 train_loss:3.5159 train_time:422099ms step_avg:361.70ms
step:1178/1750 train_loss:3.5643 train_time:422476ms step_avg:361.71ms
step:1179/1750 train_loss:3.4741 train_time:422859ms step_avg:361.73ms
step:1180/1750 train_loss:3.4188 train_time:423262ms step_avg:361.76ms
step:1181/1750 train_loss:3.3973 train_time:423646ms step_avg:361.78ms
step:1182/1750 train_loss:3.4538 train_time:424026ms step_avg:361.80ms
step:1183/1750 train_loss:3.4008 train_time:424408ms step_avg:361.81ms
step:1184/1750 train_loss:3.5722 train_time:424792ms step_avg:361.83ms
step:1185/1750 train_loss:3.6108 train_time:425179ms step_avg:361.85ms
step:1186/1750 train_loss:3.4239 train_time:425567ms step_avg:361.88ms
step:1187/1750 train_loss:3.4748 train_time:425967ms step_avg:361.91ms
step:1188/1750 train_loss:3.5108 train_time:426345ms step_avg:361.92ms
step:1189/1750 train_loss:3.3377 train_time:426732ms step_avg:361.94ms
step:1190/1750 train_loss:3.5085 train_time:427118ms step_avg:361.96ms
step:1191/1750 train_loss:3.6511 train_time:427508ms step_avg:361.99ms
step:1192/1750 train_loss:3.4595 train_time:427890ms step_avg:362.00ms
step:1193/1750 train_loss:3.3412 train_time:428270ms step_avg:362.02ms
step:1194/1750 train_loss:3.6245 train_time:428652ms step_avg:362.04ms
step:1195/1750 train_loss:3.4414 train_time:429046ms step_avg:362.06ms
step:1196/1750 train_loss:3.4576 train_time:429454ms step_avg:362.10ms
step:1197/1750 train_loss:3.3571 train_time:429841ms step_avg:362.12ms
step:1198/1750 train_loss:3.3694 train_time:430238ms step_avg:362.15ms
step:1199/1750 train_loss:3.4078 train_time:430622ms step_avg:362.17ms
step:1200/1750 train_loss:3.5093 train_time:431007ms step_avg:362.19ms
step:1201/1750 train_loss:3.5437 train_time:431388ms step_avg:362.21ms
step:1202/1750 train_loss:3.7106 train_time:431796ms step_avg:362.24ms
step:1203/1750 train_loss:3.4734 train_time:432186ms step_avg:362.27ms
step:1204/1750 train_loss:3.3773 train_time:432574ms step_avg:362.29ms
step:1205/1750 train_loss:3.4885 train_time:432956ms step_avg:362.31ms
step:1206/1750 train_loss:3.5417 train_time:433335ms step_avg:362.32ms
step:1207/1750 train_loss:3.5818 train_time:433714ms step_avg:362.33ms
step:1208/1750 train_loss:3.4624 train_time:434088ms step_avg:362.34ms
step:1209/1750 train_loss:3.3000 train_time:434475ms step_avg:362.36ms
step:1210/1750 train_loss:3.3730 train_time:434865ms step_avg:362.39ms
step:1211/1750 train_loss:3.4649 train_time:435244ms step_avg:362.40ms
step:1212/1750 train_loss:3.4593 train_time:435624ms step_avg:362.42ms
step:1213/1750 train_loss:3.4799 train_time:436008ms step_avg:362.43ms
step:1214/1750 train_loss:3.3307 train_time:436399ms step_avg:362.46ms
step:1215/1750 train_loss:3.4527 train_time:436778ms step_avg:362.47ms
step:1216/1750 train_loss:3.3950 train_time:437160ms step_avg:362.49ms
step:1217/1750 train_loss:3.3950 train_time:437543ms step_avg:362.50ms
step:1218/1750 train_loss:3.4824 train_time:437930ms step_avg:362.52ms
step:1219/1750 train_loss:3.3369 train_time:438323ms step_avg:362.55ms
step:1220/1750 train_loss:3.5368 train_time:438704ms step_avg:362.56ms
step:1221/1750 train_loss:3.5743 train_time:439083ms step_avg:362.58ms
step:1222/1750 train_loss:3.5135 train_time:439462ms step_avg:362.59ms
step:1223/1750 train_loss:3.3556 train_time:439845ms step_avg:362.61ms
step:1224/1750 train_loss:3.3225 train_time:440235ms step_avg:362.63ms
step:1225/1750 train_loss:3.4444 train_time:440619ms step_avg:362.65ms
step:1226/1750 train_loss:3.3953 train_time:441008ms step_avg:362.67ms
step:1227/1750 train_loss:3.3306 train_time:441396ms step_avg:362.69ms
step:1228/1750 train_loss:3.5132 train_time:441774ms step_avg:362.70ms
step:1229/1750 train_loss:3.4368 train_time:442159ms step_avg:362.72ms
step:1230/1750 train_loss:3.4587 train_time:442553ms step_avg:362.75ms
step:1231/1750 train_loss:3.6487 train_time:442942ms step_avg:362.77ms
step:1232/1750 train_loss:3.5549 train_time:443330ms step_avg:362.79ms
step:1233/1750 train_loss:3.4904 train_time:443707ms step_avg:362.80ms
step:1234/1750 train_loss:3.6509 train_time:444086ms step_avg:362.82ms
step:1235/1750 train_loss:3.3904 train_time:444472ms step_avg:362.83ms
step:1236/1750 train_loss:3.3550 train_time:444850ms step_avg:362.85ms
step:1237/1750 train_loss:3.3373 train_time:445230ms step_avg:362.86ms
step:1238/1750 train_loss:3.3582 train_time:445622ms step_avg:362.88ms
step:1239/1750 train_loss:3.3933 train_time:446004ms step_avg:362.90ms
step:1240/1750 train_loss:3.4478 train_time:446390ms step_avg:362.92ms
step:1241/1750 train_loss:3.4931 train_time:446777ms step_avg:362.94ms
step:1242/1750 train_loss:3.3685 train_time:447154ms step_avg:362.95ms
step:1243/1750 train_loss:3.4758 train_time:447536ms step_avg:362.97ms
step:1244/1750 train_loss:3.4710 train_time:447911ms step_avg:362.98ms
step:1245/1750 train_loss:3.4812 train_time:448290ms step_avg:362.99ms
step:1246/1750 train_loss:3.3052 train_time:448674ms step_avg:363.00ms
step:1247/1750 train_loss:3.4435 train_time:449053ms step_avg:363.02ms
step:1248/1750 train_loss:3.5055 train_time:449428ms step_avg:363.03ms
step:1249/1750 train_loss:3.4850 train_time:449805ms step_avg:363.04ms
step:1250/1750 train_loss:3.3730 train_time:450183ms step_avg:363.05ms
step:1250/1750 val_loss:3.4208 train_time:450286ms step_avg:363.13ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 289.42715 | frobenius_norm = 66772.02344 | spectral_norm = 11839.87402 | nuclear_norm = 1682957.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 183.18494 | spectral_norm = 33.91846 | nuclear_norm = 4202.94141
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 178.67728 | spectral_norm = 37.23303 | nuclear_norm = 4088.63037
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 345.37537 | spectral_norm = 22.68416 | nuclear_norm = 8411.49023
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 239.38869 | spectral_norm = 27.37656 | nuclear_norm = 5498.96680
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 398.32449 | spectral_norm = 34.91520 | nuclear_norm = 10594.02930
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 201.79198 | spectral_norm = 19.17620 | nuclear_norm = 5352.81201
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 186.68932 | spectral_norm = 18.11443 | nuclear_norm = 4316.19727
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 183.49883 | spectral_norm = 18.10056 | nuclear_norm = 4239.28076
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 330.16202 | spectral_norm = 29.91768 | nuclear_norm = 7603.42871
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 320.74420 | spectral_norm = 25.18448 | nuclear_norm = 7546.90088
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 394.21176 | spectral_norm = 30.43416 | nuclear_norm = 10515.92969
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 193.40273 | spectral_norm = 19.88963 | nuclear_norm = 5066.33008
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 182.30367 | spectral_norm = 22.35868 | nuclear_norm = 4181.88770
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 179.29303 | spectral_norm = 18.39455 | nuclear_norm = 4133.60205
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 323.07843 | spectral_norm = 28.36558 | nuclear_norm = 7342.95801
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 332.53470 | spectral_norm = 26.82704 | nuclear_norm = 7719.71387
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 399.16614 | spectral_norm = 31.96144 | nuclear_norm = 10609.39941
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 202.15454 | spectral_norm = 21.78645 | nuclear_norm = 5311.09912
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 175.77255 | spectral_norm = 16.66157 | nuclear_norm = 3882.94116
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 176.84778 | spectral_norm = 16.02055 | nuclear_norm = 3926.10352
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 355.43408 | spectral_norm = 32.58132 | nuclear_norm = 8042.61670
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 361.29025 | spectral_norm = 26.75569 | nuclear_norm = 8524.95703
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 397.76706 | spectral_norm = 37.63001 | nuclear_norm = 10576.53320
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 198.99046 | spectral_norm = 19.62501 | nuclear_norm = 5243.58301
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 182.89777 | spectral_norm = 19.24103 | nuclear_norm = 4163.52637
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 180.80881 | spectral_norm = 16.57227 | nuclear_norm = 4126.81543
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 358.62085 | spectral_norm = 31.52715 | nuclear_norm = 8087.88965
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 360.99255 | spectral_norm = 28.36378 | nuclear_norm = 8411.43750
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 413.86542 | spectral_norm = 37.78439 | nuclear_norm = 10993.03125
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 198.25510 | spectral_norm = 19.65302 | nuclear_norm = 5208.75781
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 178.40071 | spectral_norm = 19.14227 | nuclear_norm = 4041.93091
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 175.28807 | spectral_norm = 18.45404 | nuclear_norm = 3997.96460
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 355.96997 | spectral_norm = 30.65343 | nuclear_norm = 8202.02344
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 350.08423 | spectral_norm = 25.75838 | nuclear_norm = 8240.10059
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 417.16217 | spectral_norm = 32.92581 | nuclear_norm = 11120.13477
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 200.00609 | spectral_norm = 20.03649 | nuclear_norm = 5269.57910
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 177.51646 | spectral_norm = 17.80462 | nuclear_norm = 4008.71289
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 174.68753 | spectral_norm = 17.02180 | nuclear_norm = 3978.19043
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 361.20660 | spectral_norm = 31.25008 | nuclear_norm = 8218.35547
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 352.14294 | spectral_norm = 26.07730 | nuclear_norm = 8306.37695
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 410.93494 | spectral_norm = 31.64648 | nuclear_norm = 10979.39062
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 199.25917 | spectral_norm = 19.98891 | nuclear_norm = 5238.82080
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 179.20065 | spectral_norm = 18.54944 | nuclear_norm = 4058.70288
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 176.64279 | spectral_norm = 17.89617 | nuclear_norm = 4021.68457
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 347.98007 | spectral_norm = 29.90360 | nuclear_norm = 7906.71045
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 341.64844 | spectral_norm = 27.34374 | nuclear_norm = 7924.49414
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 414.51132 | spectral_norm = 34.49112 | nuclear_norm = 11011.90527
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 204.49231 | spectral_norm = 21.37085 | nuclear_norm = 5392.99658
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 181.76677 | spectral_norm = 18.92359 | nuclear_norm = 4026.40527
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 183.11023 | spectral_norm = 18.06142 | nuclear_norm = 4024.66333
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 386.41873 | spectral_norm = 39.39272 | nuclear_norm = 8690.05371
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 372.31958 | spectral_norm = 26.43174 | nuclear_norm = 8700.78320
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 403.00958 | spectral_norm = 33.44936 | nuclear_norm = 10696.75879
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 206.05063 | spectral_norm = 20.76781 | nuclear_norm = 5461.75049
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 185.51196 | spectral_norm = 18.78382 | nuclear_norm = 4168.12598
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 184.64140 | spectral_norm = 19.24592 | nuclear_norm = 4139.86230
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 364.80176 | spectral_norm = 39.34156 | nuclear_norm = 8207.68359
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 359.47516 | spectral_norm = 29.62218 | nuclear_norm = 8438.44824
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 416.10361 | spectral_norm = 36.99685 | nuclear_norm = 11047.42969
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 209.99457 | spectral_norm = 21.23893 | nuclear_norm = 5567.42676
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 181.63443 | spectral_norm = 22.53418 | nuclear_norm = 3979.69287
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 180.50346 | spectral_norm = 20.67743 | nuclear_norm = 3905.47925
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 368.25131 | spectral_norm = 38.41628 | nuclear_norm = 8444.00586
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 383.69238 | spectral_norm = 26.31553 | nuclear_norm = 9064.71582
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 412.24158 | spectral_norm = 32.41640 | nuclear_norm = 10989.34375
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 197.66945 | spectral_norm = 23.60322 | nuclear_norm = 5223.92871
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 190.04506 | spectral_norm = 22.96215 | nuclear_norm = 4269.33203
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 182.47797 | spectral_norm = 21.86173 | nuclear_norm = 4082.80322
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 346.03555 | spectral_norm = 35.34683 | nuclear_norm = 7913.97754
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 381.29077 | spectral_norm = 27.63436 | nuclear_norm = 8936.54004
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 434.48407 | spectral_norm = 35.97487 | nuclear_norm = 11541.52930
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 216.45903 | spectral_norm = 27.08615 | nuclear_norm = 5680.33252
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1290.67432 | spectral_norm = 167.14523 | nuclear_norm = 34022.72656
===========================================
step:1251/1750 train_loss:3.5622 train_time:450568ms step_avg:363.07ms
step:1252/1750 train_loss:3.4384 train_time:450939ms step_avg:363.08ms
step:1253/1750 train_loss:3.3679 train_time:451312ms step_avg:363.08ms
step:1254/1750 train_loss:3.4776 train_time:451691ms step_avg:363.10ms
step:1255/1750 train_loss:3.5838 train_time:452088ms step_avg:363.12ms
step:1256/1750 train_loss:3.3730 train_time:452472ms step_avg:363.14ms
step:1257/1750 train_loss:3.4330 train_time:452850ms step_avg:363.15ms
step:1258/1750 train_loss:3.4198 train_time:453236ms step_avg:363.17ms
step:1259/1750 train_loss:3.4017 train_time:453614ms step_avg:363.18ms
step:1260/1750 train_loss:3.2743 train_time:453986ms step_avg:363.19ms
step:1261/1750 train_loss:3.3682 train_time:454369ms step_avg:363.20ms
step:1262/1750 train_loss:3.3894 train_time:454758ms step_avg:363.23ms
step:1263/1750 train_loss:3.2955 train_time:455142ms step_avg:363.24ms
step:1264/1750 train_loss:3.5159 train_time:455516ms step_avg:363.25ms
step:1265/1750 train_loss:3.4948 train_time:455893ms step_avg:363.26ms
step:1266/1750 train_loss:3.5107 train_time:456270ms step_avg:363.27ms
step:1267/1750 train_loss:3.4291 train_time:456647ms step_avg:363.28ms
step:1268/1750 train_loss:3.4702 train_time:457025ms step_avg:363.30ms
step:1269/1750 train_loss:3.3185 train_time:457412ms step_avg:363.31ms
step:1270/1750 train_loss:3.1643 train_time:457790ms step_avg:363.33ms
step:1271/1750 train_loss:3.4635 train_time:458171ms step_avg:363.34ms
step:1272/1750 train_loss:3.4211 train_time:458549ms step_avg:363.35ms
step:1273/1750 train_loss:3.4535 train_time:458934ms step_avg:363.37ms
step:1274/1750 train_loss:3.4192 train_time:459319ms step_avg:363.39ms
step:1275/1750 train_loss:3.5003 train_time:459695ms step_avg:363.39ms
step:1276/1750 train_loss:3.5373 train_time:460066ms step_avg:363.40ms
step:1277/1750 train_loss:3.4793 train_time:460446ms step_avg:363.41ms
step:1278/1750 train_loss:3.4651 train_time:460820ms step_avg:363.42ms
step:1279/1750 train_loss:3.3259 train_time:461202ms step_avg:363.44ms
step:1280/1750 train_loss:3.4395 train_time:461591ms step_avg:363.46ms
step:1281/1750 train_loss:3.4886 train_time:461968ms step_avg:363.47ms
step:1282/1750 train_loss:3.5364 train_time:462341ms step_avg:363.48ms
step:1283/1750 train_loss:3.4018 train_time:462725ms step_avg:363.49ms
step:1284/1750 train_loss:3.4310 train_time:463105ms step_avg:363.50ms
step:1285/1750 train_loss:3.4242 train_time:463484ms step_avg:363.52ms
step:1286/1750 train_loss:3.4049 train_time:463863ms step_avg:363.53ms
step:1287/1750 train_loss:3.5515 train_time:464241ms step_avg:363.54ms
step:1288/1750 train_loss:3.3670 train_time:464625ms step_avg:363.56ms
step:1289/1750 train_loss:3.4485 train_time:465016ms step_avg:363.58ms
step:1290/1750 train_loss:3.5223 train_time:465408ms step_avg:363.60ms
step:1291/1750 train_loss:3.4446 train_time:465792ms step_avg:363.62ms
step:1292/1750 train_loss:3.5369 train_time:466176ms step_avg:363.63ms
step:1293/1750 train_loss:3.5808 train_time:466558ms step_avg:363.65ms
step:1294/1750 train_loss:3.5287 train_time:466941ms step_avg:363.66ms
step:1295/1750 train_loss:3.3481 train_time:467321ms step_avg:363.67ms
step:1296/1750 train_loss:3.4392 train_time:467703ms step_avg:363.69ms
step:1297/1750 train_loss:3.3395 train_time:468084ms step_avg:363.70ms
step:1298/1750 train_loss:3.3433 train_time:468467ms step_avg:363.72ms
step:1299/1750 train_loss:3.4589 train_time:468849ms step_avg:363.73ms
step:1300/1750 train_loss:3.4743 train_time:469233ms step_avg:363.75ms
step:1301/1750 train_loss:3.4700 train_time:469612ms step_avg:363.76ms
step:1302/1750 train_loss:3.6393 train_time:470006ms step_avg:363.78ms
step:1303/1750 train_loss:3.3717 train_time:470400ms step_avg:363.81ms
step:1304/1750 train_loss:3.5797 train_time:470788ms step_avg:363.82ms
step:1305/1750 train_loss:3.3361 train_time:471170ms step_avg:363.84ms
step:1306/1750 train_loss:3.5120 train_time:471562ms step_avg:363.86ms
step:1307/1750 train_loss:3.5262 train_time:471938ms step_avg:363.87ms
step:1308/1750 train_loss:3.3622 train_time:472320ms step_avg:363.88ms
step:1309/1750 train_loss:3.3692 train_time:472710ms step_avg:363.90ms
step:1310/1750 train_loss:3.3624 train_time:473094ms step_avg:363.92ms
step:1311/1750 train_loss:3.3604 train_time:473479ms step_avg:363.93ms
step:1312/1750 train_loss:3.4487 train_time:473869ms step_avg:363.95ms
step:1313/1750 train_loss:3.4061 train_time:474251ms step_avg:363.97ms
step:1314/1750 train_loss:3.1064 train_time:474643ms step_avg:363.99ms
step:1315/1750 train_loss:3.3450 train_time:475025ms step_avg:364.00ms
step:1316/1750 train_loss:3.4580 train_time:475400ms step_avg:364.01ms
step:1317/1750 train_loss:3.4861 train_time:475779ms step_avg:364.02ms
step:1318/1750 train_loss:3.3625 train_time:476177ms step_avg:364.05ms
step:1319/1750 train_loss:3.4877 train_time:476568ms step_avg:364.07ms
step:1320/1750 train_loss:3.5177 train_time:476961ms step_avg:364.09ms
step:1321/1750 train_loss:3.4272 train_time:477349ms step_avg:364.11ms
step:1322/1750 train_loss:3.3843 train_time:477785ms step_avg:364.17ms
step:1323/1750 train_loss:3.3911 train_time:478242ms step_avg:364.24ms
step:1324/1750 train_loss:3.5020 train_time:478630ms step_avg:364.25ms
step:1325/1750 train_loss:3.5569 train_time:479028ms step_avg:364.28ms
step:1326/1750 train_loss:3.2837 train_time:479417ms step_avg:364.30ms
step:1327/1750 train_loss:3.2302 train_time:479797ms step_avg:364.31ms
step:1328/1750 train_loss:3.5525 train_time:480190ms step_avg:364.33ms
step:1329/1750 train_loss:3.3586 train_time:480720ms step_avg:364.46ms
step:1330/1750 train_loss:3.4866 train_time:481120ms step_avg:364.48ms
step:1331/1750 train_loss:3.3949 train_time:481497ms step_avg:364.49ms
step:1332/1750 train_loss:3.8061 train_time:481886ms step_avg:364.51ms
step:1333/1750 train_loss:3.5350 train_time:482275ms step_avg:364.53ms
step:1334/1750 train_loss:3.4388 train_time:482658ms step_avg:364.55ms
step:1335/1750 train_loss:3.3651 train_time:483041ms step_avg:364.56ms
step:1336/1750 train_loss:3.3592 train_time:483438ms step_avg:364.58ms
step:1337/1750 train_loss:3.6130 train_time:483826ms step_avg:364.60ms
step:1338/1750 train_loss:3.5805 train_time:484212ms step_avg:364.62ms
step:1339/1750 train_loss:3.4064 train_time:484606ms step_avg:364.64ms
step:1340/1750 train_loss:3.3474 train_time:484994ms step_avg:364.66ms
step:1341/1750 train_loss:3.6591 train_time:485377ms step_avg:364.67ms
step:1342/1750 train_loss:3.4188 train_time:485763ms step_avg:364.69ms
step:1343/1750 train_loss:3.4337 train_time:486143ms step_avg:364.70ms
step:1344/1750 train_loss:3.4820 train_time:486534ms step_avg:364.72ms
step:1345/1750 train_loss:3.4475 train_time:486929ms step_avg:364.74ms
step:1346/1750 train_loss:3.3618 train_time:487312ms step_avg:364.75ms
step:1347/1750 train_loss:3.3352 train_time:487697ms step_avg:364.77ms
step:1348/1750 train_loss:3.4109 train_time:488082ms step_avg:364.78ms
step:1349/1750 train_loss:3.3346 train_time:488469ms step_avg:364.80ms
step:1350/1750 train_loss:3.4520 train_time:488859ms step_avg:364.82ms
step:1351/1750 train_loss:3.3089 train_time:489238ms step_avg:364.83ms
step:1352/1750 train_loss:3.3665 train_time:489621ms step_avg:364.84ms
step:1353/1750 train_loss:3.4747 train_time:490013ms step_avg:364.86ms
step:1354/1750 train_loss:3.3176 train_time:490399ms step_avg:364.88ms
step:1355/1750 train_loss:3.2564 train_time:490783ms step_avg:364.89ms
step:1356/1750 train_loss:3.5787 train_time:491171ms step_avg:364.91ms
step:1357/1750 train_loss:3.4866 train_time:491561ms step_avg:364.93ms
step:1358/1750 train_loss:3.2450 train_time:491948ms step_avg:364.95ms
step:1359/1750 train_loss:3.5052 train_time:492336ms step_avg:364.96ms
step:1360/1750 train_loss:3.4127 train_time:492724ms step_avg:364.98ms
step:1361/1750 train_loss:3.2027 train_time:493116ms step_avg:365.00ms
step:1362/1750 train_loss:3.4543 train_time:493504ms step_avg:365.02ms
step:1363/1750 train_loss:3.3408 train_time:493895ms step_avg:365.04ms
step:1364/1750 train_loss:3.3671 train_time:494275ms step_avg:365.05ms
step:1365/1750 train_loss:3.3763 train_time:494657ms step_avg:365.06ms
step:1366/1750 train_loss:3.4913 train_time:495044ms step_avg:365.08ms
step:1367/1750 train_loss:3.4551 train_time:495428ms step_avg:365.09ms
step:1368/1750 train_loss:3.4111 train_time:495815ms step_avg:365.11ms
step:1369/1750 train_loss:3.3299 train_time:496213ms step_avg:365.13ms
step:1370/1750 train_loss:3.6734 train_time:496600ms step_avg:365.15ms
step:1371/1750 train_loss:3.3772 train_time:496986ms step_avg:365.16ms
step:1372/1750 train_loss:3.4280 train_time:497374ms step_avg:365.18ms
step:1373/1750 train_loss:3.4273 train_time:497756ms step_avg:365.19ms
step:1374/1750 train_loss:3.2181 train_time:498141ms step_avg:365.21ms
step:1375/1750 train_loss:3.6047 train_time:498522ms step_avg:365.22ms
step:1375/1750 val_loss:3.3751 train_time:498623ms step_avg:365.29ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 294.07581 | frobenius_norm = 67871.89844 | spectral_norm = 12057.83887 | nuclear_norm = 1712379.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 187.71117 | spectral_norm = 35.77636 | nuclear_norm = 4298.00391
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 183.42647 | spectral_norm = 38.96339 | nuclear_norm = 4190.59424
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 354.95480 | spectral_norm = 23.45150 | nuclear_norm = 8658.14062
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 242.15590 | spectral_norm = 28.24748 | nuclear_norm = 5549.58936
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 411.60507 | spectral_norm = 36.44447 | nuclear_norm = 10947.33203
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 207.90431 | spectral_norm = 19.95896 | nuclear_norm = 5515.56543
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 192.32214 | spectral_norm = 18.77530 | nuclear_norm = 4445.24609
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 188.93164 | spectral_norm = 18.85113 | nuclear_norm = 4363.61084
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 339.54401 | spectral_norm = 30.73140 | nuclear_norm = 7820.05566
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 329.49887 | spectral_norm = 25.77939 | nuclear_norm = 7755.04297
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 405.94174 | spectral_norm = 31.55014 | nuclear_norm = 10831.72461
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 199.12334 | spectral_norm = 20.62356 | nuclear_norm = 5215.84766
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 187.67609 | spectral_norm = 23.28965 | nuclear_norm = 4299.36133
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 184.54279 | spectral_norm = 19.10816 | nuclear_norm = 4250.58350
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 333.23096 | spectral_norm = 29.19367 | nuclear_norm = 7581.04736
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 342.55502 | spectral_norm = 27.63028 | nuclear_norm = 7958.65332
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 410.79224 | spectral_norm = 33.12439 | nuclear_norm = 10917.52930
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 207.98895 | spectral_norm = 22.60589 | nuclear_norm = 5462.27637
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 180.63988 | spectral_norm = 17.16708 | nuclear_norm = 3979.31763
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 181.78844 | spectral_norm = 16.53676 | nuclear_norm = 4025.19604
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 366.72208 | spectral_norm = 33.71992 | nuclear_norm = 8304.68164
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 372.02368 | spectral_norm = 27.77282 | nuclear_norm = 8781.42676
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 408.78909 | spectral_norm = 39.20104 | nuclear_norm = 10865.75781
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 204.76054 | spectral_norm = 20.35473 | nuclear_norm = 5394.54492
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 188.20291 | spectral_norm = 19.99553 | nuclear_norm = 4277.77539
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 186.05220 | spectral_norm = 17.15622 | nuclear_norm = 4240.78809
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 370.86130 | spectral_norm = 32.48525 | nuclear_norm = 8375.56641
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 372.82571 | spectral_norm = 29.29375 | nuclear_norm = 8689.98535
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 425.38910 | spectral_norm = 39.37304 | nuclear_norm = 11297.02148
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 204.07812 | spectral_norm = 20.40794 | nuclear_norm = 5363.31543
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 183.68283 | spectral_norm = 19.80289 | nuclear_norm = 4153.94287
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 180.48007 | spectral_norm = 19.01897 | nuclear_norm = 4111.27051
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 367.52042 | spectral_norm = 31.73561 | nuclear_norm = 8477.20410
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 361.20535 | spectral_norm = 26.60012 | nuclear_norm = 8509.58008
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 428.84860 | spectral_norm = 34.18183 | nuclear_norm = 11430.84570
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 205.88605 | spectral_norm = 20.85242 | nuclear_norm = 5426.42920
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 182.69040 | spectral_norm = 18.48182 | nuclear_norm = 4114.82812
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 179.71953 | spectral_norm = 17.61354 | nuclear_norm = 4085.97168
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 372.46381 | spectral_norm = 32.17778 | nuclear_norm = 8487.10547
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 362.82404 | spectral_norm = 26.82602 | nuclear_norm = 8563.84570
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 423.29523 | spectral_norm = 32.81248 | nuclear_norm = 11310.80957
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 205.23543 | spectral_norm = 20.87406 | nuclear_norm = 5395.75830
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 184.23228 | spectral_norm = 19.27970 | nuclear_norm = 4164.56689
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 181.81535 | spectral_norm = 18.51897 | nuclear_norm = 4133.21387
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 358.34518 | spectral_norm = 30.75782 | nuclear_norm = 8151.09277
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 350.93558 | spectral_norm = 28.12980 | nuclear_norm = 8130.15723
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 427.44977 | spectral_norm = 35.85907 | nuclear_norm = 11351.16699
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 210.56242 | spectral_norm = 22.30108 | nuclear_norm = 5550.90820
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 186.99129 | spectral_norm = 19.61685 | nuclear_norm = 4127.85352
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 188.46680 | spectral_norm = 18.63146 | nuclear_norm = 4128.30078
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 399.07675 | spectral_norm = 41.16422 | nuclear_norm = 8966.23926
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 383.02600 | spectral_norm = 27.11032 | nuclear_norm = 8948.07812
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 414.80417 | spectral_norm = 34.92735 | nuclear_norm = 11003.33008
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 212.01302 | spectral_norm = 21.53075 | nuclear_norm = 5619.34863
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 190.71658 | spectral_norm = 19.60307 | nuclear_norm = 4271.56738
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 189.82404 | spectral_norm = 20.01639 | nuclear_norm = 4241.31738
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 377.05994 | spectral_norm = 40.71886 | nuclear_norm = 8475.45605
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 370.28436 | spectral_norm = 30.82635 | nuclear_norm = 8686.42578
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 428.47739 | spectral_norm = 38.50190 | nuclear_norm = 11371.13281
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 216.38976 | spectral_norm = 22.17895 | nuclear_norm = 5737.18066
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 186.68935 | spectral_norm = 23.56231 | nuclear_norm = 4072.21045
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 185.57036 | spectral_norm = 21.49110 | nuclear_norm = 3996.96240
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 381.23584 | spectral_norm = 40.25315 | nuclear_norm = 8738.07422
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 394.92126 | spectral_norm = 27.00511 | nuclear_norm = 9328.92383
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 423.02023 | spectral_norm = 33.55376 | nuclear_norm = 11274.22852
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 203.70093 | spectral_norm = 24.47411 | nuclear_norm = 5383.53516
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 195.48949 | spectral_norm = 24.00943 | nuclear_norm = 4379.64014
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 187.51111 | spectral_norm = 22.77931 | nuclear_norm = 4181.76465
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 360.36935 | spectral_norm = 37.06043 | nuclear_norm = 8240.36426
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 393.92044 | spectral_norm = 28.72323 | nuclear_norm = 9228.91895
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 445.78641 | spectral_norm = 37.17920 | nuclear_norm = 11838.14844
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 223.60536 | spectral_norm = 28.26720 | nuclear_norm = 5865.43652
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1315.89490 | spectral_norm = 166.09071 | nuclear_norm = 34753.03906
===========================================
step:1376/1750 train_loss:3.4057 train_time:498896ms step_avg:365.22ms
step:1377/1750 train_loss:3.5415 train_time:499270ms step_avg:365.23ms
step:1378/1750 train_loss:3.5458 train_time:499648ms step_avg:365.24ms
step:1379/1750 train_loss:3.1931 train_time:500034ms step_avg:365.26ms
step:1380/1750 train_loss:3.3812 train_time:500416ms step_avg:365.27ms
step:1381/1750 train_loss:3.7822 train_time:500805ms step_avg:365.28ms
step:1382/1750 train_loss:3.2791 train_time:501187ms step_avg:365.30ms
step:1383/1750 train_loss:3.4548 train_time:501573ms step_avg:365.31ms
step:1384/1750 train_loss:3.5431 train_time:501958ms step_avg:365.33ms
step:1385/1750 train_loss:3.4666 train_time:502332ms step_avg:365.33ms
step:1386/1750 train_loss:3.4067 train_time:502716ms step_avg:365.35ms
step:1387/1750 train_loss:3.2615 train_time:503099ms step_avg:365.36ms
step:1388/1750 train_loss:3.4030 train_time:503480ms step_avg:365.37ms
step:1389/1750 train_loss:3.3822 train_time:503863ms step_avg:365.38ms
step:1390/1750 train_loss:3.6289 train_time:504242ms step_avg:365.39ms
step:1391/1750 train_loss:3.3569 train_time:504625ms step_avg:365.41ms
step:1392/1750 train_loss:3.3556 train_time:505007ms step_avg:365.42ms
step:1393/1750 train_loss:3.3039 train_time:505386ms step_avg:365.43ms
step:1394/1750 train_loss:3.5701 train_time:505763ms step_avg:365.44ms
step:1395/1750 train_loss:3.4578 train_time:506144ms step_avg:365.45ms
step:1396/1750 train_loss:3.4715 train_time:506524ms step_avg:365.46ms
step:1397/1750 train_loss:3.3670 train_time:506900ms step_avg:365.46ms
step:1398/1750 train_loss:3.3131 train_time:507278ms step_avg:365.47ms
step:1399/1750 train_loss:3.3937 train_time:507663ms step_avg:365.49ms
step:1400/1750 train_loss:3.3777 train_time:508058ms step_avg:365.51ms
step:1401/1750 train_loss:3.4068 train_time:508429ms step_avg:365.51ms
step:1402/1750 train_loss:3.3568 train_time:508807ms step_avg:365.52ms
step:1403/1750 train_loss:3.5548 train_time:509196ms step_avg:365.54ms
step:1404/1750 train_loss:3.3406 train_time:509574ms step_avg:365.55ms
step:1405/1750 train_loss:3.3689 train_time:509956ms step_avg:365.56ms
step:1406/1750 train_loss:3.3789 train_time:510340ms step_avg:365.57ms
step:1407/1750 train_loss:3.2348 train_time:510717ms step_avg:365.58ms
step:1408/1750 train_loss:3.3629 train_time:511102ms step_avg:365.60ms
step:1409/1750 train_loss:3.3581 train_time:511504ms step_avg:365.62ms
step:1410/1750 train_loss:3.3439 train_time:511885ms step_avg:365.63ms
step:1411/1750 train_loss:3.4284 train_time:512260ms step_avg:365.64ms
step:1412/1750 train_loss:3.3909 train_time:512640ms step_avg:365.65ms
step:1413/1750 train_loss:3.4250 train_time:513024ms step_avg:365.66ms
step:1414/1750 train_loss:3.3962 train_time:513409ms step_avg:365.68ms
step:1415/1750 train_loss:3.4686 train_time:513804ms step_avg:365.70ms
step:1416/1750 train_loss:3.2803 train_time:514209ms step_avg:365.72ms
step:1417/1750 train_loss:3.3394 train_time:514598ms step_avg:365.74ms
step:1418/1750 train_loss:3.4506 train_time:514983ms step_avg:365.75ms
step:1419/1750 train_loss:3.4053 train_time:515372ms step_avg:365.77ms
step:1420/1750 train_loss:3.4203 train_time:515761ms step_avg:365.79ms
step:1421/1750 train_loss:3.4347 train_time:516145ms step_avg:365.80ms
step:1422/1750 train_loss:3.4009 train_time:516525ms step_avg:365.81ms
step:1423/1750 train_loss:3.3803 train_time:516904ms step_avg:365.82ms
step:1424/1750 train_loss:3.3865 train_time:517297ms step_avg:365.84ms
step:1425/1750 train_loss:3.2423 train_time:517694ms step_avg:365.86ms
step:1426/1750 train_loss:3.3897 train_time:518077ms step_avg:365.87ms
step:1427/1750 train_loss:3.3403 train_time:518467ms step_avg:365.89ms
step:1428/1750 train_loss:3.4372 train_time:518850ms step_avg:365.90ms
step:1429/1750 train_loss:3.4170 train_time:519232ms step_avg:365.91ms
step:1430/1750 train_loss:3.3168 train_time:519621ms step_avg:365.93ms
step:1431/1750 train_loss:3.3751 train_time:520015ms step_avg:365.95ms
step:1432/1750 train_loss:3.3926 train_time:520409ms step_avg:365.97ms
step:1433/1750 train_loss:3.1985 train_time:520810ms step_avg:365.99ms
step:1434/1750 train_loss:3.3488 train_time:521210ms step_avg:366.02ms
step:1435/1750 train_loss:3.1799 train_time:521599ms step_avg:366.03ms
step:1436/1750 train_loss:3.2833 train_time:521986ms step_avg:366.05ms
step:1437/1750 train_loss:3.4664 train_time:522368ms step_avg:366.06ms
step:1438/1750 train_loss:3.4406 train_time:522754ms step_avg:366.07ms
step:1439/1750 train_loss:3.3741 train_time:523143ms step_avg:366.09ms
step:1440/1750 train_loss:3.2457 train_time:523524ms step_avg:366.10ms
step:1441/1750 train_loss:3.4020 train_time:523910ms step_avg:366.11ms
step:1442/1750 train_loss:3.4519 train_time:524306ms step_avg:366.14ms
step:1443/1750 train_loss:3.5367 train_time:524710ms step_avg:366.16ms
step:1444/1750 train_loss:3.5091 train_time:525094ms step_avg:366.17ms
step:1445/1750 train_loss:3.3945 train_time:525481ms step_avg:366.19ms
step:1446/1750 train_loss:3.2668 train_time:525877ms step_avg:366.21ms
step:1447/1750 train_loss:3.3569 train_time:526271ms step_avg:366.23ms
step:1448/1750 train_loss:3.3573 train_time:526655ms step_avg:366.24ms
step:1449/1750 train_loss:3.4568 train_time:527039ms step_avg:366.25ms
step:1450/1750 train_loss:3.4501 train_time:527426ms step_avg:366.27ms
step:1451/1750 train_loss:3.2673 train_time:527812ms step_avg:366.28ms
step:1452/1750 train_loss:3.3858 train_time:528200ms step_avg:366.30ms
step:1453/1750 train_loss:3.3147 train_time:528578ms step_avg:366.31ms
step:1454/1750 train_loss:3.3461 train_time:528962ms step_avg:366.32ms
step:1455/1750 train_loss:3.3834 train_time:529353ms step_avg:366.33ms
step:1456/1750 train_loss:3.3358 train_time:529735ms step_avg:366.35ms
step:1457/1750 train_loss:3.2171 train_time:530120ms step_avg:366.36ms
step:1458/1750 train_loss:3.4785 train_time:530506ms step_avg:366.37ms
step:1459/1750 train_loss:3.3304 train_time:530897ms step_avg:366.39ms
step:1460/1750 train_loss:3.3722 train_time:531282ms step_avg:366.40ms
step:1461/1750 train_loss:3.4921 train_time:531667ms step_avg:366.41ms
step:1462/1750 train_loss:3.3175 train_time:532050ms step_avg:366.43ms
step:1463/1750 train_loss:3.5275 train_time:532443ms step_avg:366.44ms
step:1464/1750 train_loss:3.4147 train_time:532834ms step_avg:366.46ms
step:1465/1750 train_loss:3.4125 train_time:533221ms step_avg:366.47ms
step:1466/1750 train_loss:3.3423 train_time:533603ms step_avg:366.49ms
step:1467/1750 train_loss:3.4464 train_time:533993ms step_avg:366.50ms
step:1468/1750 train_loss:3.3403 train_time:534377ms step_avg:366.51ms
step:1469/1750 train_loss:3.3230 train_time:534767ms step_avg:366.53ms
step:1470/1750 train_loss:3.3932 train_time:535165ms step_avg:366.55ms
step:1471/1750 train_loss:3.3085 train_time:535569ms step_avg:366.58ms
step:1472/1750 train_loss:3.2939 train_time:535969ms step_avg:366.60ms
step:1473/1750 train_loss:3.4902 train_time:536353ms step_avg:366.61ms
step:1474/1750 train_loss:3.3687 train_time:536750ms step_avg:366.63ms
step:1475/1750 train_loss:3.2002 train_time:537149ms step_avg:366.65ms
step:1476/1750 train_loss:3.3215 train_time:537533ms step_avg:366.67ms
step:1477/1750 train_loss:3.2985 train_time:537929ms step_avg:366.69ms
step:1478/1750 train_loss:3.3642 train_time:538324ms step_avg:366.71ms
step:1479/1750 train_loss:3.4484 train_time:538713ms step_avg:366.72ms
step:1480/1750 train_loss:3.3319 train_time:539093ms step_avg:366.73ms
step:1481/1750 train_loss:3.5048 train_time:539482ms step_avg:366.75ms
step:1482/1750 train_loss:3.4235 train_time:539885ms step_avg:366.77ms
step:1483/1750 train_loss:3.3324 train_time:540295ms step_avg:366.80ms
step:1484/1750 train_loss:3.3148 train_time:540692ms step_avg:366.82ms
step:1485/1750 train_loss:3.3326 train_time:541075ms step_avg:366.83ms
step:1486/1750 train_loss:3.2764 train_time:541468ms step_avg:366.85ms
step:1487/1750 train_loss:3.3953 train_time:541862ms step_avg:366.87ms
step:1488/1750 train_loss:3.2861 train_time:542258ms step_avg:366.89ms
step:1489/1750 train_loss:3.3733 train_time:542649ms step_avg:366.90ms
step:1490/1750 train_loss:3.3030 train_time:543039ms step_avg:366.92ms
step:1491/1750 train_loss:3.2136 train_time:543427ms step_avg:366.93ms
step:1492/1750 train_loss:3.3174 train_time:543813ms step_avg:366.95ms
step:1493/1750 train_loss:3.4882 train_time:544193ms step_avg:366.95ms
step:1494/1750 train_loss:3.3502 train_time:544573ms step_avg:366.96ms
step:1495/1750 train_loss:3.0812 train_time:544964ms step_avg:366.98ms
step:1496/1750 train_loss:3.4123 train_time:545353ms step_avg:366.99ms
step:1497/1750 train_loss:3.3637 train_time:545744ms step_avg:367.01ms
step:1498/1750 train_loss:3.3959 train_time:546140ms step_avg:367.03ms
step:1499/1750 train_loss:3.3666 train_time:546542ms step_avg:367.05ms
step:1500/1750 train_loss:3.3468 train_time:546955ms step_avg:367.08ms
step:1500/1750 val_loss:3.3303 train_time:547060ms step_avg:367.15ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.11475 | frobenius_norm = 68355.72656 | spectral_norm = 12163.04883 | nuclear_norm = 1725739.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 189.77971 | spectral_norm = 37.02892 | nuclear_norm = 4338.10449
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 185.75760 | spectral_norm = 39.99346 | nuclear_norm = 4239.27832
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 360.38937 | spectral_norm = 23.77980 | nuclear_norm = 8801.86133
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 243.20753 | spectral_norm = 28.68140 | nuclear_norm = 5564.28662
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 418.84036 | spectral_norm = 37.32180 | nuclear_norm = 11139.68262
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 211.26404 | spectral_norm = 20.40096 | nuclear_norm = 5606.30322
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 195.35614 | spectral_norm = 19.21233 | nuclear_norm = 4514.68262
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 191.84666 | spectral_norm = 19.36662 | nuclear_norm = 4429.35889
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 344.81012 | spectral_norm = 31.20864 | nuclear_norm = 7942.02344
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 334.27911 | spectral_norm = 26.11400 | nuclear_norm = 7870.02051
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 412.34814 | spectral_norm = 32.18028 | nuclear_norm = 11004.86133
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 202.21980 | spectral_norm = 21.01046 | nuclear_norm = 5297.28516
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 190.45944 | spectral_norm = 23.80162 | nuclear_norm = 4359.22656
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 187.25404 | spectral_norm = 19.56255 | nuclear_norm = 4310.20605
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 339.19839 | spectral_norm = 29.85558 | nuclear_norm = 7721.39355
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 348.31567 | spectral_norm = 28.17106 | nuclear_norm = 8097.75000
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 417.08212 | spectral_norm = 33.79215 | nuclear_norm = 11083.77734
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 211.04430 | spectral_norm = 23.05768 | nuclear_norm = 5540.86279
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 183.01144 | spectral_norm = 17.51109 | nuclear_norm = 4021.55347
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 184.33446 | spectral_norm = 16.95611 | nuclear_norm = 4072.43555
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 373.20709 | spectral_norm = 34.39794 | nuclear_norm = 8459.55566
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 377.97415 | spectral_norm = 28.24685 | nuclear_norm = 8925.18652
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 414.64227 | spectral_norm = 40.07525 | nuclear_norm = 11018.29102
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 207.80789 | spectral_norm = 20.75819 | nuclear_norm = 5474.64209
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 191.01230 | spectral_norm = 20.42822 | nuclear_norm = 4336.91406
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 188.79692 | spectral_norm = 17.56656 | nuclear_norm = 4298.69629
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 377.98123 | spectral_norm = 33.03457 | nuclear_norm = 8546.70898
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 379.68500 | spectral_norm = 29.83021 | nuclear_norm = 8855.00781
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 431.46185 | spectral_norm = 40.25828 | nuclear_norm = 11457.77637
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 207.22795 | spectral_norm = 20.88186 | nuclear_norm = 5447.60938
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 186.40710 | spectral_norm = 20.18894 | nuclear_norm = 4208.30469
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 183.14375 | spectral_norm = 19.31844 | nuclear_norm = 4167.57666
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 374.36948 | spectral_norm = 32.41346 | nuclear_norm = 8645.20508
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 367.84183 | spectral_norm = 26.98794 | nuclear_norm = 8673.59180
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 435.06418 | spectral_norm = 34.88323 | nuclear_norm = 11596.10645
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 209.04189 | spectral_norm = 21.32048 | nuclear_norm = 5511.46826
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 185.33807 | spectral_norm = 18.86062 | nuclear_norm = 4166.33887
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 182.35959 | spectral_norm = 17.96287 | nuclear_norm = 4141.91113
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 379.00058 | spectral_norm = 32.67995 | nuclear_norm = 8646.19727
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 369.01761 | spectral_norm = 27.26146 | nuclear_norm = 8715.00195
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 429.96625 | spectral_norm = 33.47507 | nuclear_norm = 11489.90332
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 208.43123 | spectral_norm = 21.39458 | nuclear_norm = 5479.85352
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 186.94786 | spectral_norm = 19.76702 | nuclear_norm = 4219.11279
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 184.56433 | spectral_norm = 18.89518 | nuclear_norm = 4191.91309
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 364.27008 | spectral_norm = 31.21562 | nuclear_norm = 8294.46191
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 356.19482 | spectral_norm = 28.60246 | nuclear_norm = 8246.44141
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 434.48468 | spectral_norm = 36.61688 | nuclear_norm = 11533.31836
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 213.70505 | spectral_norm = 22.82248 | nuclear_norm = 5632.12939
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 189.62146 | spectral_norm = 19.99359 | nuclear_norm = 4174.21680
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 191.28603 | spectral_norm = 18.96474 | nuclear_norm = 4177.07324
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 406.65253 | spectral_norm = 42.18829 | nuclear_norm = 9133.09375
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 389.07703 | spectral_norm = 27.65455 | nuclear_norm = 9086.57812
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 420.93463 | spectral_norm = 35.78700 | nuclear_norm = 11160.71484
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 215.08766 | spectral_norm = 21.93896 | nuclear_norm = 5700.59766
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 193.40977 | spectral_norm = 20.07286 | nuclear_norm = 4321.75586
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 192.58066 | spectral_norm = 20.40424 | nuclear_norm = 4293.55127
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 384.35318 | spectral_norm = 41.67688 | nuclear_norm = 8638.60840
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 376.30188 | spectral_norm = 31.57900 | nuclear_norm = 8822.39551
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 434.82602 | spectral_norm = 39.30004 | nuclear_norm = 11535.24414
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 219.72589 | spectral_norm = 22.64900 | nuclear_norm = 5825.38818
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 189.17857 | spectral_norm = 24.16570 | nuclear_norm = 4109.92627
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 188.12090 | spectral_norm = 22.00415 | nuclear_norm = 4033.53320
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 389.14047 | spectral_norm = 41.36042 | nuclear_norm = 8916.07812
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 401.23291 | spectral_norm = 27.40534 | nuclear_norm = 9478.43652
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 428.15289 | spectral_norm = 34.10757 | nuclear_norm = 11409.35742
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 206.94398 | spectral_norm = 24.91328 | nuclear_norm = 5469.54443
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 198.25920 | spectral_norm = 24.59323 | nuclear_norm = 4430.75098
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 189.97165 | spectral_norm = 23.34759 | nuclear_norm = 4225.32324
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 369.81406 | spectral_norm = 38.26128 | nuclear_norm = 8455.23535
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 401.23828 | spectral_norm = 29.30763 | nuclear_norm = 9391.86816
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 450.96765 | spectral_norm = 37.74353 | nuclear_norm = 11972.71484
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 227.12819 | spectral_norm = 28.83355 | nuclear_norm = 5955.64844
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1324.06409 | spectral_norm = 164.10036 | nuclear_norm = 35024.26562
===========================================
step:1501/1750 train_loss:3.1385 train_time:547339ms step_avg:367.10ms
step:1502/1750 train_loss:3.4068 train_time:547716ms step_avg:367.10ms
step:1503/1750 train_loss:3.2902 train_time:548095ms step_avg:367.11ms
step:1504/1750 train_loss:3.2959 train_time:548480ms step_avg:367.12ms
step:1505/1750 train_loss:3.2614 train_time:548861ms step_avg:367.13ms
step:1506/1750 train_loss:3.3347 train_time:549248ms step_avg:367.14ms
step:1507/1750 train_loss:3.2224 train_time:549655ms step_avg:367.17ms
step:1508/1750 train_loss:3.5371 train_time:550042ms step_avg:367.18ms
step:1509/1750 train_loss:3.3263 train_time:550423ms step_avg:367.19ms
step:1510/1750 train_loss:3.3239 train_time:550807ms step_avg:367.20ms
step:1511/1750 train_loss:3.4580 train_time:551212ms step_avg:367.23ms
step:1512/1750 train_loss:3.4719 train_time:551681ms step_avg:367.30ms
step:1513/1750 train_loss:3.3149 train_time:552070ms step_avg:367.31ms
step:1514/1750 train_loss:3.1386 train_time:552460ms step_avg:367.33ms
step:1515/1750 train_loss:3.2889 train_time:552848ms step_avg:367.34ms
step:1516/1750 train_loss:3.2998 train_time:553244ms step_avg:367.36ms
step:1517/1750 train_loss:3.3512 train_time:553630ms step_avg:367.37ms
step:1518/1750 train_loss:3.2569 train_time:554021ms step_avg:367.39ms
step:1519/1750 train_loss:3.5545 train_time:554528ms step_avg:367.48ms
step:1520/1750 train_loss:3.1793 train_time:554930ms step_avg:367.50ms
step:1521/1750 train_loss:3.2574 train_time:555315ms step_avg:367.51ms
step:1522/1750 train_loss:3.3989 train_time:555707ms step_avg:367.53ms
step:1523/1750 train_loss:3.2708 train_time:556091ms step_avg:367.54ms
step:1524/1750 train_loss:3.3960 train_time:556479ms step_avg:367.56ms
step:1525/1750 train_loss:3.3813 train_time:556881ms step_avg:367.58ms
step:1526/1750 train_loss:3.3203 train_time:557288ms step_avg:367.60ms
step:1527/1750 train_loss:3.3394 train_time:557676ms step_avg:367.62ms
step:1528/1750 train_loss:3.4558 train_time:558061ms step_avg:367.63ms
step:1529/1750 train_loss:3.4554 train_time:558440ms step_avg:367.64ms
step:1530/1750 train_loss:3.2843 train_time:558820ms step_avg:367.64ms
step:1531/1750 train_loss:3.2356 train_time:559209ms step_avg:367.66ms
step:1532/1750 train_loss:3.3888 train_time:559595ms step_avg:367.67ms
step:1533/1750 train_loss:3.3228 train_time:559994ms step_avg:367.69ms
step:1534/1750 train_loss:3.3195 train_time:560393ms step_avg:367.71ms
step:1535/1750 train_loss:3.3273 train_time:560781ms step_avg:367.73ms
step:1536/1750 train_loss:3.2715 train_time:561174ms step_avg:367.74ms
step:1537/1750 train_loss:3.3183 train_time:561561ms step_avg:367.75ms
step:1538/1750 train_loss:3.4722 train_time:561964ms step_avg:367.78ms
step:1539/1750 train_loss:3.4464 train_time:562357ms step_avg:367.79ms
step:1540/1750 train_loss:3.3186 train_time:562744ms step_avg:367.81ms
step:1541/1750 train_loss:3.2741 train_time:563136ms step_avg:367.82ms
step:1542/1750 train_loss:3.2945 train_time:563529ms step_avg:367.84ms
step:1543/1750 train_loss:3.1983 train_time:563915ms step_avg:367.85ms
step:1544/1750 train_loss:3.3391 train_time:564294ms step_avg:367.86ms
step:1545/1750 train_loss:3.3121 train_time:564686ms step_avg:367.87ms
step:1546/1750 train_loss:3.3025 train_time:565089ms step_avg:367.90ms
step:1547/1750 train_loss:3.2575 train_time:565483ms step_avg:367.91ms
step:1548/1750 train_loss:3.3091 train_time:565883ms step_avg:367.93ms
step:1549/1750 train_loss:3.3773 train_time:566266ms step_avg:367.94ms
step:1550/1750 train_loss:3.3390 train_time:566649ms step_avg:367.95ms
step:1551/1750 train_loss:3.2441 train_time:567039ms step_avg:367.97ms
step:1552/1750 train_loss:3.2674 train_time:567429ms step_avg:367.98ms
step:1553/1750 train_loss:3.2688 train_time:567812ms step_avg:367.99ms
step:1554/1750 train_loss:3.3995 train_time:568202ms step_avg:368.01ms
step:1555/1750 train_loss:3.3829 train_time:568593ms step_avg:368.02ms
step:1556/1750 train_loss:3.3222 train_time:568976ms step_avg:368.03ms
step:1557/1750 train_loss:3.3650 train_time:569355ms step_avg:368.04ms
step:1558/1750 train_loss:3.3004 train_time:569743ms step_avg:368.05ms
step:1559/1750 train_loss:3.1718 train_time:570147ms step_avg:368.07ms
step:1560/1750 train_loss:3.4769 train_time:570532ms step_avg:368.09ms
step:1561/1750 train_loss:3.2716 train_time:570919ms step_avg:368.10ms
step:1562/1750 train_loss:3.2561 train_time:571302ms step_avg:368.11ms
step:1563/1750 train_loss:3.3604 train_time:571690ms step_avg:368.12ms
step:1564/1750 train_loss:3.1994 train_time:572092ms step_avg:368.14ms
step:1565/1750 train_loss:3.2161 train_time:572489ms step_avg:368.16ms
step:1566/1750 train_loss:3.4104 train_time:572880ms step_avg:368.17ms
step:1567/1750 train_loss:3.2751 train_time:573266ms step_avg:368.19ms
step:1568/1750 train_loss:3.2844 train_time:573667ms step_avg:368.21ms
step:1569/1750 train_loss:3.3707 train_time:574087ms step_avg:368.24ms
step:1570/1750 train_loss:3.3245 train_time:574493ms step_avg:368.26ms
step:1571/1750 train_loss:3.1979 train_time:574890ms step_avg:368.28ms
step:1572/1750 train_loss:3.2422 train_time:575278ms step_avg:368.30ms
step:1573/1750 train_loss:3.3621 train_time:575671ms step_avg:368.31ms
step:1574/1750 train_loss:3.2092 train_time:576054ms step_avg:368.32ms
step:1575/1750 train_loss:3.3740 train_time:576440ms step_avg:368.33ms
step:1576/1750 train_loss:3.2745 train_time:576828ms step_avg:368.34ms
step:1577/1750 train_loss:3.3309 train_time:577227ms step_avg:368.36ms
step:1578/1750 train_loss:3.3142 train_time:577618ms step_avg:368.38ms
step:1579/1750 train_loss:3.2870 train_time:578016ms step_avg:368.40ms
step:1580/1750 train_loss:3.2418 train_time:578402ms step_avg:368.41ms
step:1581/1750 train_loss:3.4403 train_time:578799ms step_avg:368.43ms
step:1582/1750 train_loss:3.2643 train_time:579209ms step_avg:368.45ms
step:1583/1750 train_loss:3.4215 train_time:579617ms step_avg:368.48ms
step:1584/1750 train_loss:3.2378 train_time:580004ms step_avg:368.49ms
step:1585/1750 train_loss:3.4099 train_time:580402ms step_avg:368.51ms
step:1586/1750 train_loss:3.1938 train_time:580790ms step_avg:368.52ms
step:1587/1750 train_loss:3.3951 train_time:581177ms step_avg:368.53ms
step:1588/1750 train_loss:3.2714 train_time:581572ms step_avg:368.55ms
step:1589/1750 train_loss:3.4368 train_time:581962ms step_avg:368.56ms
step:1590/1750 train_loss:3.2832 train_time:582350ms step_avg:368.58ms
step:1591/1750 train_loss:3.2932 train_time:582742ms step_avg:368.59ms
step:1592/1750 train_loss:3.3622 train_time:583131ms step_avg:368.60ms
step:1593/1750 train_loss:3.3333 train_time:583536ms step_avg:368.63ms
step:1594/1750 train_loss:3.3084 train_time:583925ms step_avg:368.64ms
step:1595/1750 train_loss:3.4510 train_time:584316ms step_avg:368.65ms
step:1596/1750 train_loss:3.1541 train_time:584720ms step_avg:368.68ms
step:1597/1750 train_loss:3.3308 train_time:585122ms step_avg:368.70ms
step:1598/1750 train_loss:3.3798 train_time:585523ms step_avg:368.72ms
step:1599/1750 train_loss:3.4441 train_time:585930ms step_avg:368.74ms
step:1600/1750 train_loss:3.2707 train_time:586328ms step_avg:368.76ms
step:1601/1750 train_loss:3.5754 train_time:586714ms step_avg:368.77ms
step:1602/1750 train_loss:3.4484 train_time:587114ms step_avg:368.79ms
step:1603/1750 train_loss:3.2203 train_time:587518ms step_avg:368.81ms
step:1604/1750 train_loss:3.2620 train_time:587912ms step_avg:368.83ms
step:1605/1750 train_loss:3.1575 train_time:588321ms step_avg:368.85ms
step:1606/1750 train_loss:3.4649 train_time:588729ms step_avg:368.88ms
step:1607/1750 train_loss:3.3000 train_time:589122ms step_avg:368.89ms
step:1608/1750 train_loss:3.3053 train_time:589519ms step_avg:368.91ms
step:1609/1750 train_loss:3.2377 train_time:589916ms step_avg:368.93ms
step:1610/1750 train_loss:3.7472 train_time:590331ms step_avg:368.96ms
step:1611/1750 train_loss:3.5017 train_time:590734ms step_avg:368.98ms
step:1612/1750 train_loss:3.3919 train_time:591141ms step_avg:369.00ms
step:1613/1750 train_loss:3.2641 train_time:591556ms step_avg:369.03ms
step:1614/1750 train_loss:3.2914 train_time:591950ms step_avg:369.05ms
step:1615/1750 train_loss:3.3087 train_time:592354ms step_avg:369.07ms
step:1616/1750 train_loss:3.2791 train_time:592784ms step_avg:369.11ms
step:1617/1750 train_loss:3.3502 train_time:593199ms step_avg:369.13ms
step:1618/1750 train_loss:3.2774 train_time:593582ms step_avg:369.14ms
step:1619/1750 train_loss:3.1822 train_time:593975ms step_avg:369.16ms
step:1620/1750 train_loss:3.4608 train_time:594365ms step_avg:369.17ms
step:1621/1750 train_loss:3.3855 train_time:594768ms step_avg:369.19ms
step:1622/1750 train_loss:3.1631 train_time:595160ms step_avg:369.21ms
step:1623/1750 train_loss:3.2581 train_time:595554ms step_avg:369.22ms
step:1624/1750 train_loss:3.2131 train_time:595937ms step_avg:369.23ms
step:1625/1750 train_loss:3.3172 train_time:596321ms step_avg:369.24ms
step:1625/1750 val_loss:3.2951 train_time:596425ms step_avg:369.30ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.61429 | frobenius_norm = 68474.39062 | spectral_norm = 12203.65918 | nuclear_norm = 1729331.12500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 190.31567 | spectral_norm = 37.69913 | nuclear_norm = 4345.48047
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 186.48276 | spectral_norm = 40.54233 | nuclear_norm = 4252.32910
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 363.02051 | spectral_norm = 23.88765 | nuclear_norm = 8872.42090
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 243.26599 | spectral_norm = 28.84433 | nuclear_norm = 5558.96387
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 421.80197 | spectral_norm = 37.74146 | nuclear_norm = 11218.95117
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 212.67850 | spectral_norm = 20.59530 | nuclear_norm = 5645.07715
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 196.55826 | spectral_norm = 19.42435 | nuclear_norm = 4540.89355
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 193.01570 | spectral_norm = 19.57360 | nuclear_norm = 4455.62549
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 347.11777 | spectral_norm = 31.46373 | nuclear_norm = 7996.27734
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 336.32269 | spectral_norm = 26.23075 | nuclear_norm = 7920.46777
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 414.93921 | spectral_norm = 32.41426 | nuclear_norm = 11075.90039
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 203.49115 | spectral_norm = 21.18009 | nuclear_norm = 5331.14844
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 191.54628 | spectral_norm = 24.07009 | nuclear_norm = 4381.57861
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 188.32596 | spectral_norm = 19.79154 | nuclear_norm = 4332.98926
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 341.92688 | spectral_norm = 30.08391 | nuclear_norm = 7786.57617
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 350.96979 | spectral_norm = 28.44490 | nuclear_norm = 8163.26025
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 419.72879 | spectral_norm = 34.05952 | nuclear_norm = 11153.52344
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 212.27957 | spectral_norm = 23.24100 | nuclear_norm = 5572.14551
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 183.86082 | spectral_norm = 17.67092 | nuclear_norm = 4032.60498
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 185.24759 | spectral_norm = 17.14308 | nuclear_norm = 4085.79370
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 376.19943 | spectral_norm = 34.68178 | nuclear_norm = 8530.65723
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 380.61563 | spectral_norm = 28.52248 | nuclear_norm = 8989.36621
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 417.10785 | spectral_norm = 40.39685 | nuclear_norm = 11081.97656
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 209.02953 | spectral_norm = 20.92155 | nuclear_norm = 5506.60352
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 192.07437 | spectral_norm = 20.61214 | nuclear_norm = 4357.73340
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 189.83073 | spectral_norm = 17.72791 | nuclear_norm = 4318.04248
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 381.32886 | spectral_norm = 33.25735 | nuclear_norm = 8628.73828
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 382.89621 | spectral_norm = 29.99717 | nuclear_norm = 8934.19238
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 433.91296 | spectral_norm = 40.60332 | nuclear_norm = 11522.23340
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 208.48567 | spectral_norm = 21.07371 | nuclear_norm = 5481.60938
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 187.49893 | spectral_norm = 20.34129 | nuclear_norm = 4228.32666
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 184.19162 | spectral_norm = 19.49362 | nuclear_norm = 4188.61914
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 377.56201 | spectral_norm = 32.70772 | nuclear_norm = 8724.67969
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 370.91193 | spectral_norm = 27.20285 | nuclear_norm = 8750.02930
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 437.59805 | spectral_norm = 35.20108 | nuclear_norm = 11663.23047
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 210.31619 | spectral_norm = 21.53087 | nuclear_norm = 5546.44189
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 186.30699 | spectral_norm = 19.08499 | nuclear_norm = 4181.73047
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 183.36540 | spectral_norm = 18.10268 | nuclear_norm = 4161.23486
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 382.07599 | spectral_norm = 32.94075 | nuclear_norm = 8723.08301
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 371.96103 | spectral_norm = 27.42989 | nuclear_norm = 8788.08496
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 432.75040 | spectral_norm = 33.75082 | nuclear_norm = 11565.12695
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 209.70093 | spectral_norm = 21.62650 | nuclear_norm = 5513.12598
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 187.88992 | spectral_norm = 20.00446 | nuclear_norm = 4234.35303
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 185.58952 | spectral_norm = 19.05767 | nuclear_norm = 4211.32324
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 367.11047 | spectral_norm = 31.45493 | nuclear_norm = 8364.69922
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 358.62482 | spectral_norm = 28.79639 | nuclear_norm = 8300.10742
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 437.53394 | spectral_norm = 36.96743 | nuclear_norm = 11611.31250
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 214.94551 | spectral_norm = 23.05653 | nuclear_norm = 5663.53125
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 190.59566 | spectral_norm = 20.16366 | nuclear_norm = 4185.03711
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 192.32440 | spectral_norm = 19.06053 | nuclear_norm = 4189.65820
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 410.25522 | spectral_norm = 42.65462 | nuclear_norm = 9210.85059
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 391.85391 | spectral_norm = 27.80460 | nuclear_norm = 9147.46680
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 423.31442 | spectral_norm = 36.18423 | nuclear_norm = 11219.76367
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 216.25764 | spectral_norm = 22.12876 | nuclear_norm = 5731.37744
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 194.36209 | spectral_norm = 20.30592 | nuclear_norm = 4335.44287
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 193.62550 | spectral_norm = 20.61759 | nuclear_norm = 4308.81396
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 387.69412 | spectral_norm = 42.15586 | nuclear_norm = 8711.79199
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 379.07599 | spectral_norm = 31.93415 | nuclear_norm = 8884.80469
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 437.40945 | spectral_norm = 39.65353 | nuclear_norm = 11601.22363
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 221.02864 | spectral_norm = 22.85158 | nuclear_norm = 5859.80078
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 190.03006 | spectral_norm = 24.45607 | nuclear_norm = 4117.25195
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 189.00565 | spectral_norm = 22.22065 | nuclear_norm = 4039.43579
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 393.06027 | spectral_norm = 42.05946 | nuclear_norm = 9002.87793
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 404.16995 | spectral_norm = 27.60138 | nuclear_norm = 9547.02930
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 429.96750 | spectral_norm = 34.36633 | nuclear_norm = 11456.21484
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 208.21805 | spectral_norm = 25.02411 | nuclear_norm = 5503.30713
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 199.28938 | spectral_norm = 24.90875 | nuclear_norm = 4446.33594
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 190.85696 | spectral_norm = 23.64211 | nuclear_norm = 4236.85156
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 374.47595 | spectral_norm = 38.85906 | nuclear_norm = 8562.59766
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 404.75726 | spectral_norm = 29.65242 | nuclear_norm = 9470.16797
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 452.61914 | spectral_norm = 37.90018 | nuclear_norm = 12014.93457
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 228.43837 | spectral_norm = 29.03010 | nuclear_norm = 5988.33496
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1322.81885 | spectral_norm = 161.86371 | nuclear_norm = 35032.28906
===========================================
step:1626/1750 train_loss:3.2401 train_time:596707ms step_avg:369.25ms
step:1627/1750 train_loss:3.2355 train_time:597087ms step_avg:369.26ms
step:1628/1750 train_loss:3.3620 train_time:597475ms step_avg:369.27ms
step:1629/1750 train_loss:3.2431 train_time:597864ms step_avg:369.28ms
step:1630/1750 train_loss:3.3170 train_time:598262ms step_avg:369.30ms
step:1631/1750 train_loss:3.1755 train_time:598685ms step_avg:369.33ms
step:1632/1750 train_loss:3.1451 train_time:599072ms step_avg:369.34ms
step:1633/1750 train_loss:3.2985 train_time:599459ms step_avg:369.35ms
step:1634/1750 train_loss:3.3085 train_time:599843ms step_avg:369.36ms
step:1635/1750 train_loss:3.2459 train_time:600246ms step_avg:369.38ms
step:1636/1750 train_loss:3.3283 train_time:600635ms step_avg:369.39ms
step:1637/1750 train_loss:3.3727 train_time:601024ms step_avg:369.41ms
step:1638/1750 train_loss:3.3979 train_time:601416ms step_avg:369.42ms
step:1639/1750 train_loss:3.5723 train_time:601818ms step_avg:369.44ms
step:1640/1750 train_loss:3.3509 train_time:602214ms step_avg:369.46ms
step:1641/1750 train_loss:3.2968 train_time:602609ms step_avg:369.47ms
step:1642/1750 train_loss:3.4011 train_time:602999ms step_avg:369.48ms
step:1643/1750 train_loss:3.2729 train_time:603402ms step_avg:369.50ms
step:1644/1750 train_loss:3.3076 train_time:603791ms step_avg:369.52ms
step:1645/1750 train_loss:3.3136 train_time:604175ms step_avg:369.53ms
step:1646/1750 train_loss:3.0671 train_time:604564ms step_avg:369.54ms
step:1647/1750 train_loss:3.3202 train_time:604950ms step_avg:369.55ms
step:1648/1750 train_loss:3.2145 train_time:605340ms step_avg:369.56ms
step:1649/1750 train_loss:3.2847 train_time:605726ms step_avg:369.57ms
step:1650/1750 train_loss:3.2666 train_time:606112ms step_avg:369.58ms
step:1651/1750 train_loss:3.3465 train_time:606498ms step_avg:369.59ms
step:1652/1750 train_loss:3.2523 train_time:606886ms step_avg:369.60ms
step:1653/1750 train_loss:3.3885 train_time:607287ms step_avg:369.62ms
step:1654/1750 train_loss:3.3850 train_time:607677ms step_avg:369.63ms
step:1655/1750 train_loss:3.1791 train_time:608076ms step_avg:369.65ms
step:1656/1750 train_loss:3.3264 train_time:608487ms step_avg:369.68ms
step:1657/1750 train_loss:3.2435 train_time:608885ms step_avg:369.69ms
step:1658/1750 train_loss:3.2182 train_time:609272ms step_avg:369.70ms
step:1659/1750 train_loss:3.2961 train_time:609660ms step_avg:369.71ms
step:1660/1750 train_loss:3.3456 train_time:610049ms step_avg:369.73ms
step:1661/1750 train_loss:3.2534 train_time:610441ms step_avg:369.74ms
step:1662/1750 train_loss:3.3582 train_time:610825ms step_avg:369.75ms
step:1663/1750 train_loss:3.3436 train_time:611229ms step_avg:369.77ms
step:1664/1750 train_loss:3.4046 train_time:611652ms step_avg:369.80ms
step:1665/1750 train_loss:3.3281 train_time:612048ms step_avg:369.82ms
step:1666/1750 train_loss:3.4988 train_time:612440ms step_avg:369.83ms
step:1667/1750 train_loss:3.2011 train_time:612834ms step_avg:369.85ms
step:1668/1750 train_loss:3.2880 train_time:613230ms step_avg:369.86ms
step:1669/1750 train_loss:3.2078 train_time:613617ms step_avg:369.87ms
step:1670/1750 train_loss:3.2232 train_time:614009ms step_avg:369.88ms
step:1671/1750 train_loss:3.3699 train_time:614403ms step_avg:369.90ms
step:1672/1750 train_loss:3.5724 train_time:614796ms step_avg:369.91ms
step:1673/1750 train_loss:3.2736 train_time:615187ms step_avg:369.93ms
step:1674/1750 train_loss:3.2544 train_time:615578ms step_avg:369.94ms
step:1675/1750 train_loss:3.1269 train_time:615981ms step_avg:369.96ms
step:1676/1750 train_loss:3.3492 train_time:616381ms step_avg:369.98ms
step:1677/1750 train_loss:3.2769 train_time:616773ms step_avg:369.99ms
step:1678/1750 train_loss:3.2933 train_time:617166ms step_avg:370.00ms
step:1679/1750 train_loss:3.3014 train_time:617558ms step_avg:370.02ms
step:1680/1750 train_loss:3.0862 train_time:617975ms step_avg:370.05ms
step:1681/1750 train_loss:3.2976 train_time:618373ms step_avg:370.06ms
step:1682/1750 train_loss:3.2848 train_time:618772ms step_avg:370.08ms
step:1683/1750 train_loss:3.3047 train_time:619164ms step_avg:370.09ms
step:1684/1750 train_loss:3.3379 train_time:619552ms step_avg:370.10ms
step:1685/1750 train_loss:3.2421 train_time:619938ms step_avg:370.11ms
step:1686/1750 train_loss:3.3610 train_time:620334ms step_avg:370.13ms
step:1687/1750 train_loss:3.2394 train_time:620727ms step_avg:370.14ms
step:1688/1750 train_loss:3.3141 train_time:621137ms step_avg:370.17ms
step:1689/1750 train_loss:3.2222 train_time:621538ms step_avg:370.18ms
step:1690/1750 train_loss:3.0686 train_time:621941ms step_avg:370.20ms
step:1691/1750 train_loss:3.3081 train_time:622332ms step_avg:370.22ms
step:1692/1750 train_loss:3.2948 train_time:622721ms step_avg:370.23ms
step:1693/1750 train_loss:3.2113 train_time:623110ms step_avg:370.24ms
step:1694/1750 train_loss:3.6075 train_time:623513ms step_avg:370.26ms
step:1695/1750 train_loss:3.3299 train_time:623915ms step_avg:370.28ms
step:1696/1750 train_loss:3.3344 train_time:624311ms step_avg:370.29ms
step:1697/1750 train_loss:3.2561 train_time:624694ms step_avg:370.30ms
step:1698/1750 train_loss:3.1213 train_time:625082ms step_avg:370.31ms
step:1699/1750 train_loss:3.2300 train_time:625474ms step_avg:370.32ms
step:1700/1750 train_loss:3.2407 train_time:625908ms step_avg:370.36ms
step:1701/1750 train_loss:3.3223 train_time:626363ms step_avg:370.41ms
step:1702/1750 train_loss:3.2390 train_time:626750ms step_avg:370.42ms
step:1703/1750 train_loss:3.4164 train_time:627133ms step_avg:370.43ms
step:1704/1750 train_loss:3.2102 train_time:627519ms step_avg:370.44ms
step:1705/1750 train_loss:3.4331 train_time:627903ms step_avg:370.44ms
step:1706/1750 train_loss:3.2514 train_time:628285ms step_avg:370.45ms
step:1707/1750 train_loss:3.0528 train_time:628681ms step_avg:370.47ms
step:1708/1750 train_loss:3.3882 train_time:629070ms step_avg:370.48ms
step:1709/1750 train_loss:3.2960 train_time:629575ms step_avg:370.56ms
step:1710/1750 train_loss:3.2834 train_time:629998ms step_avg:370.59ms
step:1711/1750 train_loss:3.2846 train_time:630396ms step_avg:370.60ms
step:1712/1750 train_loss:3.3190 train_time:630792ms step_avg:370.62ms
step:1713/1750 train_loss:3.3306 train_time:631186ms step_avg:370.63ms
step:1714/1750 train_loss:3.2239 train_time:631588ms step_avg:370.65ms
step:1715/1750 train_loss:3.2826 train_time:632011ms step_avg:370.68ms
step:1716/1750 train_loss:3.1003 train_time:632398ms step_avg:370.69ms
step:1717/1750 train_loss:3.2448 train_time:632779ms step_avg:370.70ms
step:1718/1750 train_loss:3.2603 train_time:633168ms step_avg:370.71ms
step:1719/1750 train_loss:3.2138 train_time:633565ms step_avg:370.72ms
step:1720/1750 train_loss:3.3766 train_time:633979ms step_avg:370.75ms
step:1721/1750 train_loss:3.1595 train_time:634409ms step_avg:370.78ms
step:1722/1750 train_loss:3.3133 train_time:634804ms step_avg:370.80ms
step:1723/1750 train_loss:3.4054 train_time:635215ms step_avg:370.82ms
step:1724/1750 train_loss:3.2545 train_time:635609ms step_avg:370.83ms
step:1725/1750 train_loss:3.4871 train_time:636015ms step_avg:370.85ms
step:1726/1750 train_loss:3.2539 train_time:636423ms step_avg:370.88ms
step:1727/1750 train_loss:3.3289 train_time:636806ms step_avg:370.88ms
step:1728/1750 train_loss:3.2943 train_time:637197ms step_avg:370.89ms
step:1729/1750 train_loss:3.2747 train_time:637599ms step_avg:370.91ms
step:1730/1750 train_loss:3.6509 train_time:637999ms step_avg:370.93ms
step:1731/1750 train_loss:3.2922 train_time:638392ms step_avg:370.94ms
step:1732/1750 train_loss:3.4267 train_time:638786ms step_avg:370.96ms
step:1733/1750 train_loss:3.2047 train_time:639166ms step_avg:370.96ms
step:1734/1750 train_loss:3.2469 train_time:639555ms step_avg:370.97ms
step:1735/1750 train_loss:3.2734 train_time:639952ms step_avg:370.99ms
step:1736/1750 train_loss:3.2565 train_time:640352ms step_avg:371.00ms
step:1737/1750 train_loss:3.3855 train_time:640753ms step_avg:371.02ms
step:1738/1750 train_loss:3.2149 train_time:641173ms step_avg:371.05ms
step:1739/1750 train_loss:3.2845 train_time:641580ms step_avg:371.07ms
step:1740/1750 train_loss:3.3679 train_time:641979ms step_avg:371.09ms
step:1741/1750 train_loss:3.1612 train_time:642373ms step_avg:371.10ms
step:1742/1750 train_loss:3.0597 train_time:642768ms step_avg:371.11ms
step:1743/1750 train_loss:2.9460 train_time:643181ms step_avg:371.14ms
step:1744/1750 train_loss:3.2922 train_time:643571ms step_avg:371.15ms
step:1745/1750 train_loss:3.3127 train_time:643955ms step_avg:371.16ms
step:1746/1750 train_loss:3.2663 train_time:644342ms step_avg:371.16ms
step:1747/1750 train_loss:3.2938 train_time:644747ms step_avg:371.18ms
step:1748/1750 train_loss:3.4991 train_time:645170ms step_avg:371.21ms
step:1749/1750 train_loss:3.2274 train_time:645568ms step_avg:371.23ms
step:1750/1750 train_loss:3.2769 train_time:645975ms step_avg:371.25ms
step:1750/1750 val_loss:3.2737 train_time:646090ms step_avg:371.32ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.63809 | frobenius_norm = 68480.04688 | spectral_norm = 12210.06836 | nuclear_norm = 1729587.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 190.24333 | spectral_norm = 37.94145 | nuclear_norm = 4341.44043
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 186.53279 | spectral_norm = 40.67943 | nuclear_norm = 4252.08057
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 363.71573 | spectral_norm = 23.88662 | nuclear_norm = 8891.93066
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 243.13258 | spectral_norm = 28.87855 | nuclear_norm = 5553.62988
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 422.42572 | spectral_norm = 37.85347 | nuclear_norm = 11236.00000
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 212.97751 | spectral_norm = 20.65169 | nuclear_norm = 5653.56934
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 196.78575 | spectral_norm = 19.47659 | nuclear_norm = 4545.64648
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 193.25662 | spectral_norm = 19.65105 | nuclear_norm = 4460.50439
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 347.61914 | spectral_norm = 31.50042 | nuclear_norm = 8008.24512
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 336.75821 | spectral_norm = 26.26231 | nuclear_norm = 7931.71680
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 415.49130 | spectral_norm = 32.45767 | nuclear_norm = 11091.48340
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 203.73302 | spectral_norm = 21.22316 | nuclear_norm = 5337.68994
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 191.73741 | spectral_norm = 24.12994 | nuclear_norm = 4384.89990
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 188.50497 | spectral_norm = 19.85597 | nuclear_norm = 4336.29297
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 342.57062 | spectral_norm = 30.11082 | nuclear_norm = 7802.92334
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 351.61249 | spectral_norm = 28.49086 | nuclear_norm = 8179.50146
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 420.25903 | spectral_norm = 34.13091 | nuclear_norm = 11167.30859
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 212.49135 | spectral_norm = 23.29144 | nuclear_norm = 5577.26367
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 183.96104 | spectral_norm = 17.68684 | nuclear_norm = 4031.52881
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 185.40176 | spectral_norm = 17.16536 | nuclear_norm = 4086.34009
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 376.95053 | spectral_norm = 34.77367 | nuclear_norm = 8549.19727
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 381.27115 | spectral_norm = 28.59747 | nuclear_norm = 9005.76074
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 417.58813 | spectral_norm = 40.44352 | nuclear_norm = 11094.07129
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 209.24493 | spectral_norm = 20.95897 | nuclear_norm = 5512.19043
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 192.21396 | spectral_norm = 20.67102 | nuclear_norm = 4359.50342
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 189.98026 | spectral_norm = 17.77504 | nuclear_norm = 4320.09033
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 382.16879 | spectral_norm = 33.32517 | nuclear_norm = 8650.08496
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 383.69861 | spectral_norm = 30.02945 | nuclear_norm = 8954.28516
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 434.39075 | spectral_norm = 40.67871 | nuclear_norm = 11534.46094
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 208.71701 | spectral_norm = 21.12378 | nuclear_norm = 5488.03809
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 187.71300 | spectral_norm = 20.40590 | nuclear_norm = 4231.45312
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 184.40016 | spectral_norm = 19.51399 | nuclear_norm = 4192.24512
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 378.37070 | spectral_norm = 32.78963 | nuclear_norm = 8745.90820
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 371.70297 | spectral_norm = 27.23635 | nuclear_norm = 8770.90430
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 438.09875 | spectral_norm = 35.26844 | nuclear_norm = 11676.48828
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 210.54945 | spectral_norm = 21.58120 | nuclear_norm = 5552.97559
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 186.47050 | spectral_norm = 19.11917 | nuclear_norm = 4183.13867
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 183.53885 | spectral_norm = 18.12432 | nuclear_norm = 4163.71875
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 382.86020 | spectral_norm = 32.98753 | nuclear_norm = 8743.31641
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 372.72726 | spectral_norm = 27.47717 | nuclear_norm = 8807.49609
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 433.37018 | spectral_norm = 33.80590 | nuclear_norm = 11581.81152
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 209.93639 | spectral_norm = 21.67943 | nuclear_norm = 5519.17773
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 188.01842 | spectral_norm = 20.04823 | nuclear_norm = 4234.82715
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 185.77409 | spectral_norm = 19.10704 | nuclear_norm = 4213.93066
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 367.82996 | spectral_norm = 31.49351 | nuclear_norm = 8382.93262
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 359.23465 | spectral_norm = 28.86261 | nuclear_norm = 8313.26562
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 438.19305 | spectral_norm = 37.04821 | nuclear_norm = 11627.59766
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 215.15794 | spectral_norm = 23.11458 | nuclear_norm = 5668.57666
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 190.73956 | spectral_norm = 20.20400 | nuclear_norm = 4184.24170
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 192.51257 | spectral_norm = 19.06244 | nuclear_norm = 4189.62842
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 411.23199 | spectral_norm = 42.77853 | nuclear_norm = 9231.53711
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 392.56927 | spectral_norm = 27.85871 | nuclear_norm = 9162.67480
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 423.75943 | spectral_norm = 36.27500 | nuclear_norm = 11230.12988
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 216.45158 | spectral_norm = 22.17218 | nuclear_norm = 5736.35449
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 194.49937 | spectral_norm = 20.38911 | nuclear_norm = 4335.26367
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 193.79425 | spectral_norm = 20.66278 | nuclear_norm = 4309.68750
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 388.53860 | spectral_norm = 42.26670 | nuclear_norm = 8730.01465
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 379.76709 | spectral_norm = 32.04838 | nuclear_norm = 8899.65527
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 437.89151 | spectral_norm = 39.73152 | nuclear_norm = 11613.05859
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 221.25688 | spectral_norm = 22.89633 | nuclear_norm = 5865.71729
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 190.13048 | spectral_norm = 24.53943 | nuclear_norm = 4114.57568
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 189.10666 | spectral_norm = 22.27945 | nuclear_norm = 4036.30078
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 394.15796 | spectral_norm = 42.27827 | nuclear_norm = 9026.77930
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 404.93881 | spectral_norm = 27.64689 | nuclear_norm = 9564.79492
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 430.17130 | spectral_norm = 34.43291 | nuclear_norm = 11461.05078
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 208.43161 | spectral_norm = 25.03221 | nuclear_norm = 5508.90039
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 199.43413 | spectral_norm = 25.02820 | nuclear_norm = 4446.33350
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 190.94633 | spectral_norm = 23.70977 | nuclear_norm = 4235.39160
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 375.71109 | spectral_norm = 39.02401 | nuclear_norm = 8590.51367
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 405.67737 | spectral_norm = 29.73380 | nuclear_norm = 9490.29102
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 452.78012 | spectral_norm = 37.90908 | nuclear_norm = 12018.66504
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 228.67702 | spectral_norm = 29.05213 | nuclear_norm = 5994.01416
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1320.42285 | spectral_norm = 160.69247 | nuclear_norm = 34985.19531
===========================================

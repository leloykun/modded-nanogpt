====================================================================================================
import os
import sys
with open(sys.argv[0]) as f:
    code = f.read() # read the code of this file ASAP, for logging
import uuid
import glob
import time
from dataclasses import dataclass

import numpy as np
import torch
from torch import nn
import torch.nn.functional as F
import torch.distributed as dist
import torch._inductor.config as config
from torch.nn.parallel import DistributedDataParallel as DDP
# Use of FlexAttention contributed by @KoszarskyB
from torch.nn.attention.flex_attention import flex_attention, create_block_mask, BlockMask, _score_mod_signature
from torch._inductor.lowering import make_pointwise, register_lowering
# Some internal torch.compile details
from torch._inductor.virtualized import ops
from functools import partial
flex_attention = torch.compile(flex_attention, dynamic=False)
create_block_mask = torch.compile(create_block_mask, dynamic=False)

# -----------------------------------------------------------------------------
# Muon optimizer

def zeropower_via_svd(G, steps=None):
    U, S, V = G.svd()
    return U @ V.T

@torch.compile
def zeropower_via_newtonschulz5(G, steps=10, eps=1e-7):
    """
    Newton-Schulz iteration to compute the zeroth power / orthogonalization of G. We opt to use a
    quintic iteration whose coefficients are selected to maximize the slope at zero. For the purpose
    of minimizing steps, it turns out to be empirically effective to keep increasing the slope at
    zero even beyond the point where the iteration no longer converges all the way to one everywhere
    on the interval. This iteration therefore does not produce UV^T but rather something like US'V^T
    where S' is diagonal with S_{ii}' ~ Uniform(0.5, 1.5), which turns out not to hurt model
    performance at all relative to UV^T, where USV^T = G is the SVD.
    """
    assert len(G.shape) == 2
    a, b, c = (3.4445, -4.7750,  2.0315)
    X = G.bfloat16()
    X /= (X.norm() + eps) # ensure top singular value <= 1
    if G.size(0) > G.size(1):
        X = X.T
    for _ in range(steps):
        A = X @ X.T
        B = b * A + c * A @ A # adapted from suggestion by @jxbz, @leloykun, and @YouJiacheng
        X = a * X + B @ X
    if G.size(0) > G.size(1):
        X = X.T
    return X

zeropower_backends = dict(svd=zeropower_via_svd, newtonschulz5=zeropower_via_newtonschulz5)

class Muon(torch.optim.Optimizer):
    """
    Muon - MomentUm Orthogonalized by Newton-schulz

    Muon internally runs standard SGD-momentum, and then performs an orthogonalization post-
    processing step, in which each 2D parameter's update is replaced with the nearest orthogonal
    matrix. To efficiently orthogonalize each update, we use a Newton-Schulz iteration, which has
    the advantage that it can be stably run in bfloat16 on the GPU.

    Some warnings:
    - This optimizer assumes that all parameters passed in are 2D.
    - It should not be used for the embedding layer, the final fully connected layer, or any {0,1}-D
    parameters; those should all be optimized by a standard method (e.g., AdamW).
    - To use it with 4D convolutional filters, it works well to just flatten their last 3 dimensions.
    - We believe it is unlikely to work well for training with small batch size.
    - We believe it may not work well for finetuning pretrained models, but we haven't tested this.
    - We have not yet tried this optimizer for training scenarios larger than NanoGPT (124M).

    Arguments:
        lr: The learning rate used by the internal SGD.
        momentum: The momentum used by the internal SGD.
        nesterov: Whether to use Nesterov-style momentum in the internal SGD. (recommended)
        backend: The chosen backend for the orthogonalization step. (recommended: 'newtonschulz5')
        backend_steps: The number of iteration steps to use in the backend, if it is iterative.
    """
    def __init__(self, params, lr=0.02, momentum=0.95, nesterov=True,
                 backend='newtonschulz5', backend_steps=5):
        defaults = dict(lr=lr, momentum=momentum, nesterov=nesterov, backend=backend, backend_steps=backend_steps)
        super().__init__(params, defaults)

    def step(self):

        for group in self.param_groups:

            lr = group['lr']
            momentum = group['momentum']
            zeropower_backend = zeropower_backends[group['backend']]

            # generate weight updates in distributed fashion
            total_params = sum(p.numel() for p in group['params'])
            updates_flat = torch.zeros(total_params, device='cuda', dtype=torch.bfloat16)
            curr_idx = 0
            for i, p in enumerate(group['params']):
                # luckily this will perfectly distribute a transformer with multiple of 4 layers to 8 GPUs
                if i % int(os.environ['WORLD_SIZE']) == int(os.environ['RANK']):
                    g = p.grad
                    assert g is not None
                    state = self.state[p]
                    if 'momentum_buffer' not in state:
                        state['momentum_buffer'] = torch.zeros_like(g)
                    buf = state['momentum_buffer']
                    buf.mul_(momentum).add_(g)
                    if group['nesterov']:
                        g = g.add(buf, alpha=momentum)
                    g = zeropower_backend(g, steps=group['backend_steps'])
                    g *= max(1, g.size(0)/g.size(1))**0.5
                    updates_flat[curr_idx:curr_idx+p.numel()] = g.flatten()
                curr_idx += p.numel()

            # sync updates across devices. we are not memory-constrained so can do this simple deserialization
            dist.all_reduce(updates_flat, op=dist.ReduceOp.SUM)

            # deserialize and apply updates
            curr_idx = 0
            for p in group['params']:
                g = updates_flat[curr_idx:curr_idx+p.numel()].view_as(p.data).type_as(p.data)
                p.data.add_(g, alpha=-lr)
                curr_idx += p.numel()

# -----------------------------------------------------------------------------
# Attention Tanh softcapping

@torch.library.custom_op("approx::tanh", mutates_args=())
def _tanh_approx(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

@_tanh_approx.register_fake
def _(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

def _tanh_approx_lowering(inp):
    fn = partial(ops.inline_asm_elementwise, asm="tanh.approx.f32 $0, $1;")
    return make_pointwise(fn)(inp)

register_lowering(torch.ops.approx.tanh)(_tanh_approx_lowering)

class _TanhApprox(torch.autograd.Function):
    @staticmethod
    def forward(x):
        return torch.ops.approx.tanh(x)

    @staticmethod
    def setup_context(ctx, inputs, output):
        (x,) = inputs
        result = output
        ctx.save_for_backward(result)

    @staticmethod
    def backward(ctx, grad_output):
        (result,) = ctx.saved_tensors
        return grad_output * (1 - result * result)

    @staticmethod
    def vmap(info, in_dims, x):
        return torch.tanh(x), 0

_tanh_approx = _TanhApprox.apply

def generate_tanh_softcap(soft_cap: int, approx: bool=True) -> _score_mod_signature:
    tanh = _tanh_approx if approx else torch.tanh

    def tanh_softcap(score, b, h, q_idx, kv_idx):
        return soft_cap * tanh(score / soft_cap)

    prefix = "tanh_softcap_approx" if approx else "tanh_softcap"
    tanh_softcap.__name__ = f"{prefix}_{soft_cap}"

    return tanh_softcap

# -----------------------------------------------------------------------------
# PyTorch nn.Module definitions for the GPT-2 model

class Rotary(torch.nn.Module):

    def __init__(self, dim, base=10000):
        super().__init__()
        self.dim = dim
        self.base = base
        self.inv_freq = None
        self.seq_len_cached = None
        self.cos_cached = None
        self.sin_cached = None

    def forward(self, x):
        seq_len = x.shape[1]
        if seq_len != self.seq_len_cached:
            self.inv_freq = 1.0 / (self.base ** (torch.arange(0, self.dim, 2, device=x.device).float() / self.dim))
            self.seq_len_cached = seq_len
            t = torch.arange(seq_len, device=x.device).type_as(self.inv_freq)
            freqs = torch.outer(t, self.inv_freq)
            self.cos_cached = freqs.cos().bfloat16()
            self.sin_cached = freqs.sin().bfloat16()
        return self.cos_cached[None, :, None, :], self.sin_cached[None, :, None, :]

def apply_rotary_emb(x, cos, sin):
    assert x.ndim == 4 # multihead attention
    d = x.shape[3]//2
    x1 = x[..., :d]
    x2 = x[..., d:]
    y1 = x1 * cos + x2 * sin
    y2 = x1 * (-sin) + x2 * cos
    return torch.cat([y1, y2], 3).type_as(x)

class CastedLinear(nn.Linear):
    def forward(self, x):
        return F.linear(x, self.weight.to(x.dtype))

class CausalSelfAttention(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.n_head = config.n_head
        self.n_embd = config.n_embd
        self.head_dim = self.n_embd // self.n_head
        assert self.n_embd % self.n_head == 0
        self.c_q = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_k = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_v = CastedLinear(self.n_embd, self.n_embd, bias=False)
        # output projection
        self.c_proj = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977
        self.rotary = Rotary(self.head_dim)
        self.lamb = nn.Parameter(torch.tensor(0.5)) # @Grad62304977

    def forward(self, x, v1, block_mask: BlockMask, score_mod: _score_mod_signature):
        B, T, C = x.size() # batch size, sequence length, embedding dimensionality (n_embd)
        q = self.c_q(x).view(B, T, self.n_head, self.head_dim)
        k = self.c_k(x).view(B, T, self.n_head, self.head_dim)
        v = self.c_v(x).view(B, T, self.n_head, self.head_dim)
        if v1 is None:
            v1 = v # This happens if we are in the first block. v needs to be accessed by subsequent blocks
        v = (1 - self.lamb) * v + self.lamb * v1.view_as(v) # @Grad62304977
        cos, sin = self.rotary(q)
        q, k = F.rms_norm(q, (q.size(-1),)), F.rms_norm(k, (k.size(-1),)) # QK norm suggested by @Grad62304977
        q, k = apply_rotary_emb(q, cos, sin), apply_rotary_emb(k, cos, sin)
        y = flex_attention(q.transpose(1, 2), k.transpose(1, 2), v.transpose(1, 2), score_mod=score_mod, block_mask=block_mask)
        y = y.transpose(1, 2).contiguous().view_as(x) # re-assemble all head outputs side by side
        y = self.c_proj(y)
        return y, v1

class MLP(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.c_fc    = CastedLinear(config.n_embd, 4 * config.n_embd, bias=False)
        self.c_proj  = CastedLinear(4 * config.n_embd, config.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977

    def forward(self, x):
        x = self.c_fc(x)
        x = F.relu(x).square() # https://arxiv.org/abs/2109.08668v2; ~1-2% better than GELU; suggested by @SKYLINEZ007 and @Grad62304977
        x = self.c_proj(x)
        return x

class Block(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.attn = CausalSelfAttention(config)
        self.mlp = MLP(config)
        self.lambdas = nn.Parameter(torch.tensor([1., 0.]))

    def forward(self, x, v1, x0, block_mask: BlockMask, score_mod: _score_mod_signature):
        x = self.lambdas[0] * x + self.lambdas[1] * x0
        x1, v1 = self.attn(F.rms_norm(x, (x.size(-1),)), v1, block_mask, score_mod)
        x = x + x1
        x = x + self.mlp(F.rms_norm(x, (x.size(-1),)))
        return x, v1

# -----------------------------------------------------------------------------
# The main GPT-2 model

@dataclass
class GPTConfig:
    vocab_size : int = 50304
    n_layer : int = 12
    n_head : int = 6 # head dim 128 suggested by @Grad62304977
    n_embd : int = 768
    attention_soft_cap : int = 50
    lm_head_soft_cap : int = 30

class GPT(nn.Module):

    def __init__(self, config: GPTConfig):
        super().__init__()
        self.attention_soft_cap = config.attention_soft_cap
        self.lm_head_soft_cap = config.lm_head_soft_cap

        # U-net design by @brendanh0gan
        self.num_encoder_layers = config.n_layer // 2 # Half of the layers for encoder
        self.num_decoder_layers = config.n_layer - self.num_encoder_layers # Remaining for decoder
        # Add learnable skip connection weights for decoder layers
        self.skip_weights = nn.Parameter(torch.ones(self.num_decoder_layers))

        self.transformer = nn.ModuleDict(dict(
            wte = nn.Embedding(config.vocab_size, config.n_embd),
            h = nn.ModuleList([Block(config) for _ in range(config.n_layer)]),
        ))
        self.lm_head = CastedLinear(config.n_embd, config.vocab_size, bias=False)
        self.lm_head.weight.data.zero_() # @Grad62304977

    def forward(self, idx, target, attn_blocksize: int):

        docs = (idx == 50256).cumsum(0)
        def document_causal_mask(b, h, q_idx, kv_idx):
            causal_mask = q_idx >= kv_idx
            document_mask = docs[q_idx] == docs[kv_idx]
            window_mask = q_idx - kv_idx < attn_blocksize
            return causal_mask & document_mask & window_mask

        softcap_mod = generate_tanh_softcap(self.attention_soft_cap, approx=True)  # @leloykun

        S = len(idx)
        block_mask = create_block_mask(document_causal_mask, None, None, S, S, device="cuda", _compile=True)

        # forward the GPT model itself
        x = self.transformer.wte(idx[None]) # token embeddings of shape (b, t, n_embd)
        x = F.rms_norm(x, (x.size(-1),)) # @Grad62304977
        x0 = x
        v1 = None

        # Store outputs for U-Net skip connections
        skip_connections = []
        # Encoder pass - process only the first half of the blocks
        for i in range(self.num_encoder_layers):
            x, v1 = self.transformer.h[i](x, v1, x0, block_mask, softcap_mod)
            skip_connections.append(x)
        # Decoder pass - process the remaining blocks with weighted skip connections
        for i in range(self.num_decoder_layers):
            x = x + self.skip_weights[i] * skip_connections.pop()
            x, v1 = self.transformer.h[self.num_encoder_layers + i](x, v1, x0, block_mask, softcap_mod)

        x = F.rms_norm(x, (x.size(-1),))
        logits = self.lm_head(x)
        logits = self.lm_head_soft_cap * torch.tanh(logits / self.lm_head_soft_cap) # @Grad62304977
        logits = logits.float()
        loss = F.cross_entropy(logits.view(-1, logits.size(-1)), target.view(-1))
        return loss

# -----------------------------------------------------------------------------
# Our own simple Distributed Data Loader

def _peek_data_shard(filename):
    # only reads the header, returns header data
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
    if header[0] != 20240520:
        print("ERROR: magic number mismatch in the data .bin file!")
        print("---> HINT: Are you passing in a correct file with --input_bin?")
        print("---> HINT: Dataset encoding changed recently, re-run data prepro or refer again to README")
        print("---> HINT: For example re-run: `python dev/data/tinyshakespeare.py`, then re-try")
        exit(1)
    assert header[1] == 1, "unsupported version"
    ntok = header[2] # number of tokens (claimed)
    return ntok # for now just return the number of tokens

def _load_data_shard(filename):
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
        assert header[0] == 20240520, "magic number mismatch in the data .bin file"
        assert header[1] == 1, "unsupported version"
        ntok = header[2] # number of tokens (claimed)
        # the rest of it are tokens, stored as uint16
        tokens = np.frombuffer(f.read(), dtype=np.uint16)
    assert len(tokens) == ntok, "number of tokens read does not match header?"
    return tokens

class DistributedDataLoader:
    def __init__(self, filename_pattern, B, T, process_rank, num_processes):
        self.process_rank = process_rank
        self.num_processes = num_processes
        self.B = B
        self.T = T

        # glob files that match the pattern
        self.files = sorted(glob.glob(filename_pattern))
        assert len(self.files) > 0, f"did not find any files that match the pattern {filename_pattern}"

        # load and validate all data shards, count number of tokens in total
        ntok_total = 0
        for fname in self.files:
            shard_ntok = _peek_data_shard(fname)
            assert shard_ntok >= num_processes * B * T + 1
            ntok_total += int(shard_ntok)
        self.ntok_total = ntok_total

        self.reset()

    def reset(self):
        self.current_shard = -1
        self.advance()

    def advance(self): # advance to next data shard
        self.current_shard = (self.current_shard + 1) % len(self.files)
        self.current_position = self.process_rank * self.B * self.T
        self.tokens = _load_data_shard(self.files[self.current_shard])

    def next_batch(self):
        batch_size = self.B * self.T * self.num_processes
        buf = self.tokens[self.current_position:self.current_position+self.B*self.T+1]
        buf = torch.tensor(buf.astype(np.int32), dtype=torch.long)
        x = buf[:-1] # inputs
        y = buf[1:] # targets
        # advance current position and load next shard if necessary
        self.current_position += batch_size
        if self.current_position + batch_size >= len(self.tokens):
            self.advance()
        return x.cuda(), y.cuda()

# -----------------------------------------------------------------------------
# int main

@dataclass
class Hyperparameters:
    # data hyperparams
    input_bin : str = 'data/fineweb10B/fineweb_train_*.bin' # input .bin to train on
    input_val_bin : str = 'data/fineweb10B/fineweb_val_*.bin' # input .bin to eval validation loss on
    # optimization hyperparams
    batch_size : int = 8 # batch size, in sequences, across all devices
    device_batch_size : int = 1 # batch size, in sequences, per device
    sequence_length : int = 64*1024 # sequence length, in tokens
    num_iterations : int = 1750 # number of iterations to run
    warmup_iters : int = 0
    cooldown_iters : int = 640 # number of iterations of linear warmup/cooldown for triangular or trapezoidal schedule
    weight_decay : float = 0
    # evaluation and logging hyperparams
    val_loss_every : int = 125 # every how many steps to evaluate val loss? 0 for only at the end
    val_tokens : int = 10485760 # how many tokens of validation data? it's important to keep this fixed for consistent comparisons
    save_every : int = 0 # every how many steps to save the checkpoint? 0 for only at the end
args = Hyperparameters()

# set up DDP (distributed data parallel). torchrun sets this env variable
assert torch.cuda.is_available()
dist.init_process_group(backend='nccl')
ddp_rank = int(os.environ['RANK'])
ddp_local_rank = int(os.environ['LOCAL_RANK'])
ddp_world_size = int(os.environ['WORLD_SIZE'])
device = f'cuda:{ddp_local_rank}'
torch.cuda.set_device(device)
print(f"using device: {device}")
master_process = (ddp_rank == 0) # this process will do logging, checkpointing etc.

# begin logging
logfile = None
if master_process:
    run_id = str(uuid.uuid4())
    logdir = 'logs/%s/' % run_id
    os.makedirs(logdir, exist_ok=True)
    logfile = 'logs/%s.txt' % run_id
    # create the log file
    with open(logfile, "w") as f:
        # begin the log by printing this file (the Python code)
        f.write('='*100 + '\n')
        f.write(code)
        f.write('='*100 + '\n')
def print0(s, logonly=False):
    if master_process:
        with open(logfile, "a") as f:
            if not logonly:
                print(s)
            f.write(s+'\n')
# log information about the hardware/software environment this is running on
# and print the full `nvidia-smi` to file
print0(f"Running pytorch {torch.version.__version__} compiled for CUDA {torch.version.cuda}\nnvidia-smi:")
import subprocess
result = subprocess.run(['nvidia-smi'], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
print0(f'{result.stdout}', logonly=True)
print0('='*100, logonly=True)

# convenience variables
B, T = args.device_batch_size, args.sequence_length
# calculate the number of steps to take in the val loop.
assert args.val_tokens % (B * T * ddp_world_size) == 0
val_steps = args.val_tokens // (B * T * ddp_world_size)
# calculate the steps of gradient accumulation required to attain the desired global batch size.
assert args.batch_size % (B * ddp_world_size) == 0
train_accumulation_steps = args.batch_size // (B * ddp_world_size)

# load tokens
train_loader = DistributedDataLoader(args.input_bin, B, T, ddp_rank, ddp_world_size)
val_loader = DistributedDataLoader(args.input_val_bin, B, T, ddp_rank, ddp_world_size)
print0(f"Training DataLoader: total number of tokens: {train_loader.ntok_total} across {len(train_loader.files)} files")
print0(f"Validation DataLoader: total number of tokens: {val_loader.ntok_total} across {len(val_loader.files)} files")
print0('='*100, logonly=True)
x, y = train_loader.next_batch()

# there are only 50257 unique GPT-2 tokens; we extend to nearest multiple of 128 for efficiency. suggested to me by @Grad62304977.
# this originates from Karpathy's experiments.
num_vocab = 50304
model = GPT(GPTConfig(vocab_size=num_vocab, n_layer=12, n_head=6, n_embd=768))
model = model.cuda().bfloat16()
for m in model.modules():
    if isinstance(m, CastedLinear):
        m.float()
if hasattr(config, "coordinate_descent_tuning"):
    config.coordinate_descent_tuning = True # suggested by @Chillee
model = torch.compile(model)
# here we wrap model into DDP container
model = DDP(model, device_ids=[ddp_local_rank])
raw_model = model.module # always contains the "raw" unwrapped model

# CUDNN attention is ~4ms faster than Flash, but doesn't get selected by default in PyTorch 2.5.1
from torch.backends.cuda import enable_cudnn_sdp, enable_flash_sdp, enable_math_sdp, enable_mem_efficient_sdp
enable_cudnn_sdp(True)
enable_flash_sdp(False)
enable_mem_efficient_sdp(False)
enable_math_sdp(False)

# init the optimizer(s)
optimizer1 = torch.optim.Adam([raw_model.transformer.wte.weight], lr=0.6,   betas=(0.8, 0.95), fused=True)
optimizer2 = torch.optim.Adam([raw_model.lm_head.weight],         lr=0.008, betas=(0.8, 0.95), fused=True)
param_names = [name for name, _ in raw_model.named_parameters()]
params = list(raw_model.transformer.h.parameters())
qk_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and ("c_q" in n or "c_k" in n)]
matrix_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and "c_q" not in n and "c_k" not in n]
scalar_params = [p for p in params if p.ndim < 2] + [raw_model.skip_weights]
optimizer5 = Muon(qk_params, lr=0.08, momentum=0.95)
optimizer3 = Muon(matrix_params, lr=0.05, momentum=0.95)
optimizer4 = torch.optim.Adam(scalar_params, lr=0.04, betas=(0.8, 0.95), fused=True) # note that this learning rate is neither sensitive nor tuned
optimizers = [optimizer1, optimizer2, optimizer3, optimizer4, optimizer5]
# learning rate decay scheduler (linear warmup and cooldown)
def get_lr(it):
    assert it <= args.num_iterations
    # 1) linear warmup for warmup_iters steps
    if it < args.warmup_iters:
        return (it+1) / args.warmup_iters
    # 2) constant lr for a while
    elif it < args.num_iterations - args.cooldown_iters:
        return 1.0
    # 3) linear cooldown
    else:
        decay_ratio = (args.num_iterations - it) / args.cooldown_iters
        return decay_ratio
schedulers = [torch.optim.lr_scheduler.LambdaLR(opt, get_lr) for opt in optimizers]

# Start training loop
training_time_ms = 0
# start the clock
torch.cuda.synchronize()
t0 = time.time()
# begin training
for step in range(args.num_iterations + 1):
    last_step = (step == args.num_iterations)
    # Set the attention blocksize for the current step, in chunks of 64
    attn_blocksize = torch.tensor(64*((step/args.num_iterations * (1792 - 64) + 64)//64), dtype=torch.int, device='cuda')
    # This effectively ignores timing first 10 steps, which are slower for weird reasons.
    # Alternately, and slightly more correctly in terms of benchmarking, we could do 10
    # steps with dummy data first, and then re-initialize the model and reset the loader.
    if step == 10:
        training_time_ms = 0
        t0 = time.time()
    timed_steps = float('nan') if step <= 11 else (step - 10) + 1 # <= 11 to avoid bug in val

    # once in a while evaluate the validation dataset
    if (last_step or (args.val_loss_every > 0 and step % args.val_loss_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # run validation batches
        model.eval()
        val_loader.reset()
        val_loss = 0.0
        for _ in range(val_steps):
            with torch.no_grad():
                x_val, y_val = val_loader.next_batch()
                val_loss += model(x_val, y_val, attn_blocksize=attn_blocksize)
        dist.all_reduce(val_loss, op=dist.ReduceOp.AVG)
        val_loss /= val_steps
        # log val loss to console and to logfile
        print0(f'step:{step}/{args.num_iterations} val_loss:{val_loss:.4f} train_time:{training_time_ms:.0f}ms step_avg:{training_time_ms/(timed_steps-1):.2f}ms')
        if master_process:
            print("============== Weight norms: ==============")
            with open(logfile, "a") as f:
                f.write("============== Weight norms: ==============\n")
                for name, p in model.named_parameters():
                    if p.ndim != 2:
                        continue
                    if "transformer.wte" in name:
                        l1_to_l2_norm = torch.norm(p.data.float(), p=2, dim=1).mean().item()
                    frobenius_norm = torch.linalg.norm(p.data.float(), ord='fro').item()
                    spectral_norm = torch.linalg.matrix_norm(p.data.float(), ord=2).item()
                    nuclear_norm = torch.linalg.matrix_norm(p.data.float(), ord="nuc").item()
                    if "transformer.wte" in name:
                        print(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                    else:
                        print(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                f.write("===========================================\n")
            print("===========================================")
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    if master_process and (last_step or (args.save_every > 0 and step % args.save_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # save the state of the training process
        log = dict(step=step, code=code, model=raw_model.state_dict(), optimizers=[opt.state_dict() for opt in optimizers])
        torch.save(log, 'logs/%s/state_step%06d.pt' % (run_id, step))
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    # bit confusing: we want to make sure to eval on 0th iteration
    # but also after the very last iteration. so we loop for step <= num_iterations
    # instead of just < num_iterations (one extra due to <=), only to do
    # the validation/sampling one last time, and then we break right here as we're done.
    if last_step:
        break

    # --------------- TRAINING SECTION BEGIN -----------------
    model.train()
    for i in range(1, train_accumulation_steps+1):
        # forward pass
        loss = model(x, y, attn_blocksize=attn_blocksize)
        train_loss = loss.detach()
        # advance the dataset for the next batch
        x, y = train_loader.next_batch()
        # backward pass
        if i < train_accumulation_steps:
            with model.no_sync(): # there's no need to sync gradients every accumulation step
                loss.backward()
        else:
            loss.backward() # just sync on the last step
    for p in model.parameters():
        p.grad /= train_accumulation_steps
    # momentum warmup for Muon
    frac = min(step/300, 1)
    optimizer3.param_groups[0]['momentum'] = (1 - frac) * 0.85 + frac * 0.95
    # step the optimizers and schedulers
    for opt, sched in zip(optimizers, schedulers):
        opt.step()
        sched.step()
    # null the gradients
    model.zero_grad(set_to_none=True)
    # --------------- TRAINING SECTION END -------------------
    # everything that follows now is just diagnostics, prints, logging, etc.

    #dist.all_reduce(train_loss, op=dist.ReduceOp.AVG) # all-reducing the training loss would be more correct in terms of logging, but slower
    approx_time = training_time_ms + 1000 * (time.time() - t0)
    print0(f"step:{step+1}/{args.num_iterations} train_loss:{train_loss.item():.4f} train_time:{approx_time:.0f}ms step_avg:{approx_time/timed_steps:.2f}ms")

if master_process:
    print(f"peak memory consumption: {torch.cuda.max_memory_allocated() // 1024 // 1024} MiB")

# -------------------------------------------------------------------------
# clean up nice
dist.destroy_process_group()
====================================================================================================
Running pytorch 2.6.0.dev20241125+cu124 compiled for CUDA 12.4
nvidia-smi:
Mon Nov 25 15:01:43 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.12             Driver Version: 535.104.12   CUDA Version: 12.4     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  | 00000000:07:00.0 Off |                    0 |
| N/A   33C    P0              66W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  | 00000000:0A:00.0 Off |                    0 |
| N/A   29C    P0              62W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  | 00000000:45:00.0 Off |                    0 |
| N/A   29C    P0              64W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  | 00000000:4B:00.0 Off |                    0 |
| N/A   35C    P0              67W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   4  NVIDIA A100-SXM4-80GB          On  | 00000000:84:00.0 Off |                    0 |
| N/A   35C    P0              67W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   5  NVIDIA A100-SXM4-80GB          On  | 00000000:8A:00.0 Off |                    0 |
| N/A   29C    P0              63W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   6  NVIDIA A100-SXM4-80GB          On  | 00000000:C0:00.0 Off |                    0 |
| N/A   29C    P0              63W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   7  NVIDIA A100-SXM4-80GB          On  | 00000000:C3:00.0 Off |                    0 |
| N/A   34C    P0              72W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
+---------------------------------------------------------------------------------------+

====================================================================================================
Training DataLoader: total number of tokens: 1100000000 across 11 files
Validation DataLoader: total number of tokens: 100000000 across 1 files
====================================================================================================
step:0/1750 val_loss:10.8258 train_time:0ms step_avg:nanms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 27.70534 | frobenius_norm = 6215.93799 | spectral_norm = 251.67120 | nuclear_norm = 171954.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 16.01004 | spectral_norm = 1.14797 | nuclear_norm = 376.74255
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 16.01659 | spectral_norm = 1.14432 | nuclear_norm = 376.58789
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 16.00169 | spectral_norm = 1.14703 | nuclear_norm = 376.48679
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 32.01022 | spectral_norm = 1.73061 | nuclear_norm = 858.42334
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 16.00030 | spectral_norm = 1.14897 | nuclear_norm = 376.38855
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 15.99752 | spectral_norm = 1.14382 | nuclear_norm = 376.30045
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 16.00356 | spectral_norm = 1.14698 | nuclear_norm = 376.43213
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 32.00099 | spectral_norm = 1.72801 | nuclear_norm = 858.18860
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 15.99781 | spectral_norm = 1.14100 | nuclear_norm = 376.41418
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 16.00196 | spectral_norm = 1.15486 | nuclear_norm = 376.36017
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 15.98401 | spectral_norm = 1.15434 | nuclear_norm = 376.00775
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 32.00707 | spectral_norm = 1.71964 | nuclear_norm = 858.59845
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 16.00311 | spectral_norm = 1.15357 | nuclear_norm = 376.45450
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 16.00346 | spectral_norm = 1.15095 | nuclear_norm = 376.33813
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 16.01675 | spectral_norm = 1.15494 | nuclear_norm = 376.75266
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 32.00671 | spectral_norm = 1.72974 | nuclear_norm = 858.43994
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 16.00387 | spectral_norm = 1.14546 | nuclear_norm = 376.58200
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 16.00340 | spectral_norm = 1.14607 | nuclear_norm = 376.52612
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 16.00733 | spectral_norm = 1.14333 | nuclear_norm = 376.49707
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 31.99815 | spectral_norm = 1.72494 | nuclear_norm = 858.29456
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 16.00772 | spectral_norm = 1.13948 | nuclear_norm = 376.53085
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 16.00046 | spectral_norm = 1.14507 | nuclear_norm = 376.53369
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 16.00112 | spectral_norm = 1.15358 | nuclear_norm = 376.51300
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 31.99027 | spectral_norm = 1.73299 | nuclear_norm = 857.99268
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 15.98433 | spectral_norm = 1.15355 | nuclear_norm = 375.96484
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 15.99110 | spectral_norm = 1.14666 | nuclear_norm = 376.10281
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 16.00319 | spectral_norm = 1.14112 | nuclear_norm = 376.48914
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 31.99944 | spectral_norm = 1.73114 | nuclear_norm = 858.13586
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 15.99959 | spectral_norm = 1.14548 | nuclear_norm = 376.70239
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 16.00255 | spectral_norm = 1.16149 | nuclear_norm = 376.29626
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 16.00657 | spectral_norm = 1.14820 | nuclear_norm = 376.59598
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 32.00906 | spectral_norm = 1.72403 | nuclear_norm = 858.54767
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 15.99450 | spectral_norm = 1.14255 | nuclear_norm = 376.16962
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 15.98729 | spectral_norm = 1.14171 | nuclear_norm = 376.10367
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 16.00838 | spectral_norm = 1.14567 | nuclear_norm = 376.50360
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 31.99721 | spectral_norm = 1.74089 | nuclear_norm = 858.12323
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 16.00392 | spectral_norm = 1.14815 | nuclear_norm = 376.43146
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 15.99510 | spectral_norm = 1.15440 | nuclear_norm = 376.28653
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 15.99409 | spectral_norm = 1.14798 | nuclear_norm = 376.20874
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 31.99142 | spectral_norm = 1.72457 | nuclear_norm = 858.02649
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 16.00611 | spectral_norm = 1.15136 | nuclear_norm = 376.51306
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 15.98831 | spectral_norm = 1.15812 | nuclear_norm = 376.08618
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 16.00862 | spectral_norm = 1.14078 | nuclear_norm = 376.42227
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 31.99767 | spectral_norm = 1.72166 | nuclear_norm = 858.20770
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 16.00977 | spectral_norm = 1.15245 | nuclear_norm = 376.80908
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 16.00451 | spectral_norm = 1.15224 | nuclear_norm = 376.45865
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 16.00036 | spectral_norm = 1.16069 | nuclear_norm = 376.59277
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 32.01237 | spectral_norm = 1.72886 | nuclear_norm = 858.44104
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
===========================================
step:1/1750 train_loss:10.8258 train_time:31808ms step_avg:nanms
step:2/1750 train_loss:10.0640 train_time:32631ms step_avg:nanms
step:3/1750 train_loss:8.3063 train_time:32958ms step_avg:nanms
step:4/1750 train_loss:7.6554 train_time:33288ms step_avg:nanms
step:5/1750 train_loss:7.5712 train_time:33617ms step_avg:nanms
step:6/1750 train_loss:7.0369 train_time:33946ms step_avg:nanms
step:7/1750 train_loss:7.2516 train_time:34276ms step_avg:nanms
step:8/1750 train_loss:6.7367 train_time:34606ms step_avg:nanms
step:9/1750 train_loss:6.6128 train_time:34937ms step_avg:nanms
step:10/1750 train_loss:6.4957 train_time:35268ms step_avg:nanms
step:11/1750 train_loss:6.4700 train_time:248ms step_avg:nanms
step:12/1750 train_loss:6.3876 train_time:579ms step_avg:nanms
step:13/1750 train_loss:6.2622 train_time:909ms step_avg:303.03ms
step:14/1750 train_loss:6.2091 train_time:1240ms step_avg:310.01ms
step:15/1750 train_loss:6.1731 train_time:1572ms step_avg:314.42ms
step:16/1750 train_loss:6.1394 train_time:1903ms step_avg:317.09ms
step:17/1750 train_loss:6.1561 train_time:2233ms step_avg:318.98ms
step:18/1750 train_loss:5.9767 train_time:2565ms step_avg:320.56ms
step:19/1750 train_loss:6.0048 train_time:2895ms step_avg:321.67ms
step:20/1750 train_loss:5.6827 train_time:3226ms step_avg:322.62ms
step:21/1750 train_loss:5.9833 train_time:3557ms step_avg:323.40ms
step:22/1750 train_loss:6.2306 train_time:3889ms step_avg:324.06ms
step:23/1750 train_loss:5.8889 train_time:4219ms step_avg:324.57ms
step:24/1750 train_loss:6.0373 train_time:4550ms step_avg:325.02ms
step:25/1750 train_loss:5.7259 train_time:4882ms step_avg:325.44ms
step:26/1750 train_loss:5.6366 train_time:5212ms step_avg:325.76ms
step:27/1750 train_loss:5.7992 train_time:5544ms step_avg:326.10ms
step:28/1750 train_loss:5.4597 train_time:5875ms step_avg:326.38ms
step:29/1750 train_loss:5.7345 train_time:6207ms step_avg:326.67ms
step:30/1750 train_loss:5.5271 train_time:6538ms step_avg:326.90ms
step:31/1750 train_loss:5.4726 train_time:6869ms step_avg:327.09ms
step:32/1750 train_loss:5.3657 train_time:7200ms step_avg:327.26ms
step:33/1750 train_loss:5.6564 train_time:7531ms step_avg:327.44ms
step:34/1750 train_loss:5.5352 train_time:7863ms step_avg:327.61ms
step:35/1750 train_loss:5.6349 train_time:8193ms step_avg:327.73ms
step:36/1750 train_loss:5.5910 train_time:8524ms step_avg:327.85ms
step:37/1750 train_loss:5.4954 train_time:8855ms step_avg:327.97ms
step:38/1750 train_loss:5.3430 train_time:9187ms step_avg:328.09ms
step:39/1750 train_loss:5.3580 train_time:9518ms step_avg:328.20ms
step:40/1750 train_loss:5.2943 train_time:9850ms step_avg:328.32ms
step:41/1750 train_loss:5.2669 train_time:10181ms step_avg:328.41ms
step:42/1750 train_loss:5.2187 train_time:10513ms step_avg:328.52ms
step:43/1750 train_loss:5.3258 train_time:10844ms step_avg:328.61ms
step:44/1750 train_loss:5.3017 train_time:11176ms step_avg:328.72ms
step:45/1750 train_loss:5.4287 train_time:11507ms step_avg:328.77ms
step:46/1750 train_loss:5.2242 train_time:11839ms step_avg:328.87ms
step:47/1750 train_loss:5.1076 train_time:12171ms step_avg:328.95ms
step:48/1750 train_loss:5.2508 train_time:12503ms step_avg:329.02ms
step:49/1750 train_loss:5.1847 train_time:12835ms step_avg:329.10ms
step:50/1750 train_loss:5.3042 train_time:13166ms step_avg:329.16ms
step:51/1750 train_loss:5.1812 train_time:13498ms step_avg:329.22ms
step:52/1750 train_loss:5.0539 train_time:13830ms step_avg:329.30ms
step:53/1750 train_loss:5.2134 train_time:14163ms step_avg:329.36ms
step:54/1750 train_loss:5.0594 train_time:14496ms step_avg:329.44ms
step:55/1750 train_loss:5.4422 train_time:14826ms step_avg:329.48ms
step:56/1750 train_loss:5.0734 train_time:15159ms step_avg:329.55ms
step:57/1750 train_loss:4.9171 train_time:15492ms step_avg:329.61ms
step:58/1750 train_loss:5.0344 train_time:15825ms step_avg:329.68ms
step:59/1750 train_loss:5.0370 train_time:16157ms step_avg:329.73ms
step:60/1750 train_loss:5.1764 train_time:16489ms step_avg:329.78ms
step:61/1750 train_loss:4.9056 train_time:16821ms step_avg:329.82ms
step:62/1750 train_loss:5.0362 train_time:17153ms step_avg:329.87ms
step:63/1750 train_loss:5.0161 train_time:17485ms step_avg:329.91ms
step:64/1750 train_loss:5.0244 train_time:17818ms step_avg:329.96ms
step:65/1750 train_loss:4.8397 train_time:18151ms step_avg:330.01ms
step:66/1750 train_loss:5.0108 train_time:18483ms step_avg:330.06ms
step:67/1750 train_loss:4.8854 train_time:18815ms step_avg:330.09ms
step:68/1750 train_loss:5.1589 train_time:19149ms step_avg:330.15ms
step:69/1750 train_loss:4.7714 train_time:19481ms step_avg:330.19ms
step:70/1750 train_loss:4.8713 train_time:19814ms step_avg:330.23ms
step:71/1750 train_loss:4.9977 train_time:20146ms step_avg:330.27ms
step:72/1750 train_loss:4.9204 train_time:20478ms step_avg:330.29ms
step:73/1750 train_loss:4.8022 train_time:20811ms step_avg:330.33ms
step:74/1750 train_loss:4.9614 train_time:21144ms step_avg:330.38ms
step:75/1750 train_loss:4.8973 train_time:21477ms step_avg:330.41ms
step:76/1750 train_loss:4.8378 train_time:21810ms step_avg:330.45ms
step:77/1750 train_loss:4.9435 train_time:22143ms step_avg:330.49ms
step:78/1750 train_loss:5.1415 train_time:22477ms step_avg:330.54ms
step:79/1750 train_loss:4.8443 train_time:22810ms step_avg:330.58ms
step:80/1750 train_loss:4.8868 train_time:23143ms step_avg:330.62ms
step:81/1750 train_loss:4.6631 train_time:23476ms step_avg:330.65ms
step:82/1750 train_loss:4.8395 train_time:23810ms step_avg:330.69ms
step:83/1750 train_loss:4.7944 train_time:24143ms step_avg:330.73ms
step:84/1750 train_loss:4.7717 train_time:24477ms step_avg:330.78ms
step:85/1750 train_loss:4.6291 train_time:24813ms step_avg:330.84ms
step:86/1750 train_loss:4.8489 train_time:25145ms step_avg:330.86ms
step:87/1750 train_loss:4.7677 train_time:25480ms step_avg:330.91ms
step:88/1750 train_loss:4.7492 train_time:25814ms step_avg:330.94ms
step:89/1750 train_loss:4.7069 train_time:26149ms step_avg:331.00ms
step:90/1750 train_loss:4.6647 train_time:26482ms step_avg:331.03ms
step:91/1750 train_loss:4.6531 train_time:26815ms step_avg:331.06ms
step:92/1750 train_loss:4.7924 train_time:27151ms step_avg:331.11ms
step:93/1750 train_loss:4.6037 train_time:27484ms step_avg:331.13ms
step:94/1750 train_loss:4.6486 train_time:27818ms step_avg:331.16ms
step:95/1750 train_loss:4.6755 train_time:28151ms step_avg:331.19ms
step:96/1750 train_loss:4.5922 train_time:28486ms step_avg:331.23ms
step:97/1750 train_loss:4.6325 train_time:28820ms step_avg:331.26ms
step:98/1750 train_loss:4.5679 train_time:29154ms step_avg:331.29ms
step:99/1750 train_loss:4.6626 train_time:29487ms step_avg:331.32ms
step:100/1750 train_loss:4.6840 train_time:29823ms step_avg:331.37ms
step:101/1750 train_loss:4.5301 train_time:30154ms step_avg:331.36ms
step:102/1750 train_loss:4.7136 train_time:30487ms step_avg:331.38ms
step:103/1750 train_loss:4.5963 train_time:30822ms step_avg:331.42ms
step:104/1750 train_loss:4.5612 train_time:31156ms step_avg:331.44ms
step:105/1750 train_loss:4.5772 train_time:31489ms step_avg:331.46ms
step:106/1750 train_loss:4.6096 train_time:31823ms step_avg:331.49ms
step:107/1750 train_loss:4.5105 train_time:32157ms step_avg:331.52ms
step:108/1750 train_loss:4.3589 train_time:32492ms step_avg:331.55ms
step:109/1750 train_loss:4.4867 train_time:32827ms step_avg:331.59ms
step:110/1750 train_loss:4.4751 train_time:33162ms step_avg:331.62ms
step:111/1750 train_loss:4.4337 train_time:33496ms step_avg:331.64ms
step:112/1750 train_loss:4.5872 train_time:33831ms step_avg:331.68ms
step:113/1750 train_loss:4.4838 train_time:34166ms step_avg:331.71ms
step:114/1750 train_loss:4.3732 train_time:34500ms step_avg:331.73ms
step:115/1750 train_loss:4.5266 train_time:34833ms step_avg:331.75ms
step:116/1750 train_loss:4.4998 train_time:35168ms step_avg:331.77ms
step:117/1750 train_loss:4.4103 train_time:35504ms step_avg:331.81ms
step:118/1750 train_loss:4.6435 train_time:35839ms step_avg:331.84ms
step:119/1750 train_loss:4.4756 train_time:36175ms step_avg:331.88ms
step:120/1750 train_loss:4.3738 train_time:36511ms step_avg:331.92ms
step:121/1750 train_loss:4.3307 train_time:36847ms step_avg:331.96ms
step:122/1750 train_loss:4.4821 train_time:37184ms step_avg:332.00ms
step:123/1750 train_loss:4.2926 train_time:37517ms step_avg:332.01ms
step:124/1750 train_loss:4.6086 train_time:37851ms step_avg:332.03ms
step:125/1750 train_loss:4.4929 train_time:38185ms step_avg:332.05ms
step:125/1750 val_loss:4.4367 train_time:38269ms step_avg:332.77ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 118.89124 | frobenius_norm = 27104.25977 | spectral_norm = 6748.98584 | nuclear_norm = 659579.06250
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 38.32763 | spectral_norm = 3.25920 | nuclear_norm = 902.93842
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 36.66205 | spectral_norm = 4.58998 | nuclear_norm = 860.51044
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 83.46346 | spectral_norm = 5.64442 | nuclear_norm = 1951.68823
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 84.52967 | spectral_norm = 8.78970 | nuclear_norm = 2013.59424
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 77.61755 | spectral_norm = 5.37135 | nuclear_norm = 2063.64502
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 41.76934 | spectral_norm = 2.79954 | nuclear_norm = 1110.29395
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 36.27636 | spectral_norm = 3.15440 | nuclear_norm = 851.79382
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 35.53059 | spectral_norm = 3.80131 | nuclear_norm = 833.13440
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 90.33272 | spectral_norm = 7.55115 | nuclear_norm = 2081.06982
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 94.10334 | spectral_norm = 8.66664 | nuclear_norm = 2247.56689
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 83.52769 | spectral_norm = 5.44893 | nuclear_norm = 2221.26270
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 44.04112 | spectral_norm = 2.96412 | nuclear_norm = 1169.73547
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 35.18532 | spectral_norm = 2.94807 | nuclear_norm = 820.02917
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 35.22975 | spectral_norm = 3.32734 | nuclear_norm = 820.92078
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 92.77132 | spectral_norm = 8.04176 | nuclear_norm = 2119.68652
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 95.79076 | spectral_norm = 8.59689 | nuclear_norm = 2286.58032
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 85.06538 | spectral_norm = 5.41371 | nuclear_norm = 2260.50537
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 44.39441 | spectral_norm = 3.04109 | nuclear_norm = 1177.12390
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 34.69374 | spectral_norm = 3.04994 | nuclear_norm = 809.10388
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 34.92029 | spectral_norm = 3.38074 | nuclear_norm = 814.74622
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 86.91161 | spectral_norm = 7.88187 | nuclear_norm = 1956.43408
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 91.79636 | spectral_norm = 8.35152 | nuclear_norm = 2164.28955
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 86.33846 | spectral_norm = 5.33455 | nuclear_norm = 2291.31250
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 44.43856 | spectral_norm = 3.09125 | nuclear_norm = 1175.78467
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 34.42866 | spectral_norm = 2.96544 | nuclear_norm = 803.75610
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 34.93505 | spectral_norm = 3.10724 | nuclear_norm = 815.69922
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 83.16696 | spectral_norm = 7.96214 | nuclear_norm = 1844.38721
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 87.87938 | spectral_norm = 8.07406 | nuclear_norm = 2065.38721
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 85.50439 | spectral_norm = 5.35562 | nuclear_norm = 2265.65039
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 43.73701 | spectral_norm = 3.05256 | nuclear_norm = 1154.36877
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 34.46844 | spectral_norm = 2.90446 | nuclear_norm = 802.18451
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 34.97450 | spectral_norm = 3.20567 | nuclear_norm = 813.33850
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 77.49897 | spectral_norm = 7.51337 | nuclear_norm = 1703.02368
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 85.36517 | spectral_norm = 7.87811 | nuclear_norm = 2017.22742
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 83.33162 | spectral_norm = 5.33915 | nuclear_norm = 2206.38965
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 42.65550 | spectral_norm = 2.90425 | nuclear_norm = 1125.77319
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 33.52083 | spectral_norm = 2.87788 | nuclear_norm = 774.64587
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 34.04267 | spectral_norm = 2.78988 | nuclear_norm = 788.15070
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 86.00428 | spectral_norm = 7.98174 | nuclear_norm = 1905.62854
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 86.68063 | spectral_norm = 7.95814 | nuclear_norm = 2055.19482
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 81.41654 | spectral_norm = 5.47263 | nuclear_norm = 2151.31470
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 41.73415 | spectral_norm = 2.89988 | nuclear_norm = 1098.09937
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 33.85482 | spectral_norm = 2.85719 | nuclear_norm = 781.88483
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 34.50744 | spectral_norm = 2.82817 | nuclear_norm = 798.05792
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 91.55347 | spectral_norm = 8.15965 | nuclear_norm = 2053.39258
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 88.68126 | spectral_norm = 8.15931 | nuclear_norm = 2111.69995
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 82.53816 | spectral_norm = 5.50948 | nuclear_norm = 2181.11572
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 41.94791 | spectral_norm = 2.86949 | nuclear_norm = 1103.84412
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 33.92411 | spectral_norm = 2.90252 | nuclear_norm = 784.04297
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 34.33908 | spectral_norm = 2.87303 | nuclear_norm = 795.02710
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 86.07063 | spectral_norm = 7.96118 | nuclear_norm = 1912.75061
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 90.71214 | spectral_norm = 8.27535 | nuclear_norm = 2161.74023
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 82.57081 | spectral_norm = 5.68964 | nuclear_norm = 2181.88135
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 41.79670 | spectral_norm = 2.84185 | nuclear_norm = 1098.66187
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 33.69494 | spectral_norm = 2.87143 | nuclear_norm = 778.19055
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 34.22821 | spectral_norm = 2.85431 | nuclear_norm = 790.91089
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 86.81660 | spectral_norm = 7.70090 | nuclear_norm = 1942.93408
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 92.96114 | spectral_norm = 8.28200 | nuclear_norm = 2221.25781
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 83.44370 | spectral_norm = 5.91729 | nuclear_norm = 2206.14697
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 41.80434 | spectral_norm = 2.79652 | nuclear_norm = 1098.03601
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 34.13471 | spectral_norm = 2.97924 | nuclear_norm = 787.04150
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 34.59902 | spectral_norm = 3.08835 | nuclear_norm = 797.72449
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 89.99676 | spectral_norm = 7.84756 | nuclear_norm = 2042.00610
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 94.61958 | spectral_norm = 7.60024 | nuclear_norm = 2285.64062
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 82.25928 | spectral_norm = 6.04355 | nuclear_norm = 2174.20459
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 41.03594 | spectral_norm = 2.77888 | nuclear_norm = 1074.85706
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 34.19981 | spectral_norm = 2.90264 | nuclear_norm = 793.96027
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 34.58235 | spectral_norm = 2.96920 | nuclear_norm = 803.38007
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 78.39193 | spectral_norm = 6.94614 | nuclear_norm = 1745.35107
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 88.12774 | spectral_norm = 7.03695 | nuclear_norm = 2099.08472
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 81.31927 | spectral_norm = 6.33194 | nuclear_norm = 2146.71362
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 40.10159 | spectral_norm = 2.80709 | nuclear_norm = 1046.51416
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 384.80640 | spectral_norm = 134.49391 | nuclear_norm = 9165.57324
===========================================
step:126/1750 train_loss:4.4489 train_time:38517ms step_avg:332.04ms
step:127/1750 train_loss:4.4829 train_time:38848ms step_avg:332.04ms
step:128/1750 train_loss:4.4039 train_time:39180ms step_avg:332.03ms
step:129/1750 train_loss:4.7064 train_time:39512ms step_avg:332.04ms
step:130/1750 train_loss:4.3995 train_time:39844ms step_avg:332.04ms
step:131/1750 train_loss:4.4232 train_time:40184ms step_avg:332.10ms
step:132/1750 train_loss:4.3565 train_time:40528ms step_avg:332.19ms
step:133/1750 train_loss:4.4682 train_time:40870ms step_avg:332.28ms
step:134/1750 train_loss:4.2619 train_time:41213ms step_avg:332.36ms
step:135/1750 train_loss:4.4583 train_time:41557ms step_avg:332.46ms
step:136/1750 train_loss:4.2214 train_time:41902ms step_avg:332.56ms
step:137/1750 train_loss:4.3768 train_time:42245ms step_avg:332.64ms
step:138/1750 train_loss:4.2802 train_time:42589ms step_avg:332.73ms
step:139/1750 train_loss:4.3901 train_time:42932ms step_avg:332.81ms
step:140/1750 train_loss:4.4752 train_time:43277ms step_avg:332.90ms
step:141/1750 train_loss:4.3132 train_time:43620ms step_avg:332.98ms
step:142/1750 train_loss:4.2966 train_time:43964ms step_avg:333.06ms
step:143/1750 train_loss:4.2649 train_time:44308ms step_avg:333.14ms
step:144/1750 train_loss:4.3773 train_time:44653ms step_avg:333.23ms
step:145/1750 train_loss:4.3173 train_time:44997ms step_avg:333.31ms
step:146/1750 train_loss:4.1814 train_time:45340ms step_avg:333.38ms
step:147/1750 train_loss:4.3286 train_time:45684ms step_avg:333.46ms
step:148/1750 train_loss:4.3677 train_time:46027ms step_avg:333.53ms
step:149/1750 train_loss:4.2990 train_time:46372ms step_avg:333.61ms
step:150/1750 train_loss:4.4461 train_time:46716ms step_avg:333.69ms
step:151/1750 train_loss:4.2692 train_time:47060ms step_avg:333.76ms
step:152/1750 train_loss:4.2671 train_time:47404ms step_avg:333.83ms
step:153/1750 train_loss:4.3650 train_time:47750ms step_avg:333.92ms
step:154/1750 train_loss:4.3763 train_time:48096ms step_avg:334.00ms
step:155/1750 train_loss:4.2821 train_time:48440ms step_avg:334.07ms
step:156/1750 train_loss:4.3466 train_time:48784ms step_avg:334.14ms
step:157/1750 train_loss:4.4090 train_time:49129ms step_avg:334.21ms
step:158/1750 train_loss:4.2459 train_time:49474ms step_avg:334.29ms
step:159/1750 train_loss:4.3088 train_time:49819ms step_avg:334.35ms
step:160/1750 train_loss:4.1145 train_time:50163ms step_avg:334.42ms
step:161/1750 train_loss:4.3468 train_time:50509ms step_avg:334.50ms
step:162/1750 train_loss:4.3572 train_time:50854ms step_avg:334.56ms
step:163/1750 train_loss:4.3328 train_time:51198ms step_avg:334.63ms
step:164/1750 train_loss:4.1963 train_time:51542ms step_avg:334.69ms
step:165/1750 train_loss:4.2851 train_time:51886ms step_avg:334.75ms
step:166/1750 train_loss:4.3620 train_time:52231ms step_avg:334.81ms
step:167/1750 train_loss:4.2090 train_time:52576ms step_avg:334.88ms
step:168/1750 train_loss:4.2847 train_time:52921ms step_avg:334.94ms
step:169/1750 train_loss:4.1572 train_time:53264ms step_avg:334.99ms
step:170/1750 train_loss:4.0478 train_time:53608ms step_avg:335.05ms
step:171/1750 train_loss:4.2228 train_time:53953ms step_avg:335.11ms
step:172/1750 train_loss:4.2365 train_time:54299ms step_avg:335.18ms
step:173/1750 train_loss:4.2823 train_time:54644ms step_avg:335.24ms
step:174/1750 train_loss:4.4336 train_time:54987ms step_avg:335.29ms
step:175/1750 train_loss:4.2507 train_time:55332ms step_avg:335.35ms
step:176/1750 train_loss:4.1099 train_time:55676ms step_avg:335.40ms
step:177/1750 train_loss:4.0814 train_time:56023ms step_avg:335.46ms
step:178/1750 train_loss:4.1953 train_time:56367ms step_avg:335.52ms
step:179/1750 train_loss:4.1381 train_time:56711ms step_avg:335.57ms
step:180/1750 train_loss:4.1345 train_time:57057ms step_avg:335.63ms
step:181/1750 train_loss:4.3168 train_time:57401ms step_avg:335.68ms
step:182/1750 train_loss:4.1784 train_time:57747ms step_avg:335.74ms
step:183/1750 train_loss:4.1396 train_time:58091ms step_avg:335.79ms
step:184/1750 train_loss:4.1385 train_time:58436ms step_avg:335.84ms
step:185/1750 train_loss:4.2221 train_time:58781ms step_avg:335.89ms
step:186/1750 train_loss:4.1859 train_time:59125ms step_avg:335.94ms
step:187/1750 train_loss:4.2371 train_time:59471ms step_avg:336.00ms
step:188/1750 train_loss:4.1778 train_time:59865ms step_avg:336.32ms
step:189/1750 train_loss:4.1223 train_time:60431ms step_avg:337.60ms
step:190/1750 train_loss:4.2170 train_time:60797ms step_avg:337.76ms
step:191/1750 train_loss:4.0972 train_time:61141ms step_avg:337.79ms
step:192/1750 train_loss:4.0452 train_time:61486ms step_avg:337.83ms
step:193/1750 train_loss:4.2669 train_time:61829ms step_avg:337.87ms
step:194/1750 train_loss:4.1864 train_time:62174ms step_avg:337.90ms
step:195/1750 train_loss:4.3757 train_time:62517ms step_avg:337.93ms
step:196/1750 train_loss:4.1969 train_time:62860ms step_avg:337.96ms
step:197/1750 train_loss:4.0671 train_time:63203ms step_avg:337.98ms
step:198/1750 train_loss:4.1821 train_time:63546ms step_avg:338.01ms
step:199/1750 train_loss:4.0332 train_time:63888ms step_avg:338.03ms
step:200/1750 train_loss:4.1231 train_time:64234ms step_avg:338.08ms
step:201/1750 train_loss:3.9988 train_time:64576ms step_avg:338.09ms
step:202/1750 train_loss:4.2444 train_time:64918ms step_avg:338.12ms
step:203/1750 train_loss:4.0626 train_time:65260ms step_avg:338.14ms
step:204/1750 train_loss:4.1945 train_time:65603ms step_avg:338.16ms
step:205/1750 train_loss:4.2535 train_time:65946ms step_avg:338.18ms
step:206/1750 train_loss:3.9502 train_time:66288ms step_avg:338.20ms
step:207/1750 train_loss:4.1075 train_time:66630ms step_avg:338.22ms
step:208/1750 train_loss:4.1086 train_time:66971ms step_avg:338.24ms
step:209/1750 train_loss:4.2372 train_time:67314ms step_avg:338.26ms
step:210/1750 train_loss:4.1810 train_time:67657ms step_avg:338.29ms
step:211/1750 train_loss:4.0570 train_time:68000ms step_avg:338.31ms
step:212/1750 train_loss:4.1091 train_time:68346ms step_avg:338.34ms
step:213/1750 train_loss:4.0446 train_time:68688ms step_avg:338.37ms
step:214/1750 train_loss:4.1080 train_time:69030ms step_avg:338.38ms
step:215/1750 train_loss:3.9538 train_time:69372ms step_avg:338.40ms
step:216/1750 train_loss:4.0082 train_time:69714ms step_avg:338.42ms
step:217/1750 train_loss:4.0109 train_time:70057ms step_avg:338.44ms
step:218/1750 train_loss:4.0905 train_time:70400ms step_avg:338.46ms
step:219/1750 train_loss:4.0717 train_time:70742ms step_avg:338.48ms
step:220/1750 train_loss:4.0857 train_time:71083ms step_avg:338.49ms
step:221/1750 train_loss:4.0977 train_time:71426ms step_avg:338.51ms
step:222/1750 train_loss:3.9999 train_time:71771ms step_avg:338.54ms
step:223/1750 train_loss:3.9818 train_time:72115ms step_avg:338.57ms
step:224/1750 train_loss:4.2971 train_time:72456ms step_avg:338.58ms
step:225/1750 train_loss:3.9008 train_time:72799ms step_avg:338.60ms
step:226/1750 train_loss:3.9952 train_time:73142ms step_avg:338.62ms
step:227/1750 train_loss:3.9823 train_time:73486ms step_avg:338.65ms
step:228/1750 train_loss:4.1442 train_time:73830ms step_avg:338.67ms
step:229/1750 train_loss:3.9235 train_time:74173ms step_avg:338.69ms
step:230/1750 train_loss:4.0497 train_time:74516ms step_avg:338.71ms
step:231/1750 train_loss:3.9031 train_time:74859ms step_avg:338.73ms
step:232/1750 train_loss:3.9727 train_time:75201ms step_avg:338.74ms
step:233/1750 train_loss:4.0884 train_time:75543ms step_avg:338.76ms
step:234/1750 train_loss:4.0334 train_time:75886ms step_avg:338.78ms
step:235/1750 train_loss:3.9123 train_time:76229ms step_avg:338.80ms
step:236/1750 train_loss:4.0893 train_time:76571ms step_avg:338.81ms
step:237/1750 train_loss:4.0932 train_time:76915ms step_avg:338.83ms
step:238/1750 train_loss:3.9484 train_time:77259ms step_avg:338.85ms
step:239/1750 train_loss:4.0853 train_time:77603ms step_avg:338.88ms
step:240/1750 train_loss:4.1135 train_time:77947ms step_avg:338.90ms
step:241/1750 train_loss:3.9693 train_time:78291ms step_avg:338.92ms
step:242/1750 train_loss:4.1440 train_time:78634ms step_avg:338.94ms
step:243/1750 train_loss:4.0270 train_time:78975ms step_avg:338.95ms
step:244/1750 train_loss:4.0962 train_time:79318ms step_avg:338.96ms
step:245/1750 train_loss:4.1561 train_time:79660ms step_avg:338.98ms
step:246/1750 train_loss:4.0725 train_time:80005ms step_avg:339.01ms
step:247/1750 train_loss:4.0099 train_time:80349ms step_avg:339.03ms
step:248/1750 train_loss:4.1111 train_time:80693ms step_avg:339.05ms
step:249/1750 train_loss:3.9230 train_time:81036ms step_avg:339.06ms
step:250/1750 train_loss:3.9808 train_time:81379ms step_avg:339.08ms
step:250/1750 val_loss:4.0138 train_time:81466ms step_avg:339.44ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 157.37219 | frobenius_norm = 35954.94531 | spectral_norm = 7537.40723 | nuclear_norm = 885252.43750
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 59.26077 | spectral_norm = 6.47332 | nuclear_norm = 1390.45703
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 57.38452 | spectral_norm = 8.46341 | nuclear_norm = 1338.01831
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 127.04041 | spectral_norm = 8.21434 | nuclear_norm = 3021.25781
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 117.98991 | spectral_norm = 10.46894 | nuclear_norm = 2776.23096
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 122.88275 | spectral_norm = 9.03658 | nuclear_norm = 3264.51587
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 63.77936 | spectral_norm = 4.70075 | nuclear_norm = 1692.01978
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 57.47390 | spectral_norm = 5.21217 | nuclear_norm = 1345.55530
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 56.26202 | spectral_norm = 6.23797 | nuclear_norm = 1316.38867
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 137.75197 | spectral_norm = 11.17523 | nuclear_norm = 3192.36035
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 137.37677 | spectral_norm = 10.83243 | nuclear_norm = 3236.86499
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 131.44540 | spectral_norm = 8.54563 | nuclear_norm = 3495.11304
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 67.06111 | spectral_norm = 5.26330 | nuclear_norm = 1776.73438
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 56.76972 | spectral_norm = 4.69666 | nuclear_norm = 1313.63367
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 56.55091 | spectral_norm = 5.20682 | nuclear_norm = 1310.03491
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 141.70784 | spectral_norm = 11.57063 | nuclear_norm = 3263.54883
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 142.08548 | spectral_norm = 10.95368 | nuclear_norm = 3366.60693
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 133.32620 | spectral_norm = 8.90425 | nuclear_norm = 3546.19531
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 67.53426 | spectral_norm = 5.23214 | nuclear_norm = 1786.61047
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 56.19344 | spectral_norm = 4.95700 | nuclear_norm = 1306.02759
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 55.91446 | spectral_norm = 5.35351 | nuclear_norm = 1298.20459
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 137.43391 | spectral_norm = 11.16837 | nuclear_norm = 3151.01025
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 141.17120 | spectral_norm = 10.92197 | nuclear_norm = 3325.03662
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 136.65685 | spectral_norm = 9.01073 | nuclear_norm = 3629.67480
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 68.03213 | spectral_norm = 5.27827 | nuclear_norm = 1797.12000
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 55.70156 | spectral_norm = 5.02136 | nuclear_norm = 1299.90601
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 55.75731 | spectral_norm = 5.07003 | nuclear_norm = 1303.17871
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 135.66199 | spectral_norm = 11.32219 | nuclear_norm = 3088.12695
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 138.69986 | spectral_norm = 10.59468 | nuclear_norm = 3256.29175
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 137.33635 | spectral_norm = 9.41260 | nuclear_norm = 3643.63477
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 67.40296 | spectral_norm = 5.23009 | nuclear_norm = 1775.45874
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 55.93605 | spectral_norm = 4.69138 | nuclear_norm = 1297.77075
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 56.09629 | spectral_norm = 5.06764 | nuclear_norm = 1300.41406
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 130.32268 | spectral_norm = 10.74008 | nuclear_norm = 2968.75342
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 137.32626 | spectral_norm = 10.09046 | nuclear_norm = 3243.30688
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 137.21971 | spectral_norm = 9.10832 | nuclear_norm = 3641.74756
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 66.31155 | spectral_norm = 5.03321 | nuclear_norm = 1749.67700
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 55.99053 | spectral_norm = 4.94847 | nuclear_norm = 1292.69312
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 55.90399 | spectral_norm = 4.72526 | nuclear_norm = 1293.20410
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 137.78185 | spectral_norm = 11.64801 | nuclear_norm = 3131.28931
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 138.18552 | spectral_norm = 10.37874 | nuclear_norm = 3277.21484
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 132.16454 | spectral_norm = 9.14040 | nuclear_norm = 3507.15674
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 65.40450 | spectral_norm = 5.26297 | nuclear_norm = 1725.07910
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 56.54873 | spectral_norm = 4.74248 | nuclear_norm = 1304.83276
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 56.90155 | spectral_norm = 4.63274 | nuclear_norm = 1311.82666
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 143.98558 | spectral_norm = 11.58254 | nuclear_norm = 3306.33936
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 142.87309 | spectral_norm = 10.13130 | nuclear_norm = 3395.82324
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 132.19359 | spectral_norm = 9.52363 | nuclear_norm = 3505.84497
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 65.60983 | spectral_norm = 5.24695 | nuclear_norm = 1731.01514
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 56.48793 | spectral_norm = 4.75589 | nuclear_norm = 1307.05371
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 56.25465 | spectral_norm = 4.76510 | nuclear_norm = 1302.24878
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 141.17914 | spectral_norm = 11.55163 | nuclear_norm = 3236.60986
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 142.66710 | spectral_norm = 10.01752 | nuclear_norm = 3383.86572
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 132.16328 | spectral_norm = 9.58131 | nuclear_norm = 3504.27026
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 65.69196 | spectral_norm = 5.38198 | nuclear_norm = 1732.90210
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 56.34186 | spectral_norm = 4.89872 | nuclear_norm = 1305.32178
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 56.18602 | spectral_norm = 4.75379 | nuclear_norm = 1295.93677
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 142.78238 | spectral_norm = 11.46936 | nuclear_norm = 3279.57422
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 146.49358 | spectral_norm = 10.30144 | nuclear_norm = 3477.51538
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 133.50621 | spectral_norm = 9.55206 | nuclear_norm = 3543.26123
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 66.05337 | spectral_norm = 5.40656 | nuclear_norm = 1744.20825
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 56.68385 | spectral_norm = 5.16800 | nuclear_norm = 1305.89978
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 56.09219 | spectral_norm = 5.32444 | nuclear_norm = 1286.42542
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 144.18567 | spectral_norm = 11.20812 | nuclear_norm = 3345.63721
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 152.51564 | spectral_norm = 10.15032 | nuclear_norm = 3657.04297
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 133.55888 | spectral_norm = 9.33159 | nuclear_norm = 3544.32739
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 66.16634 | spectral_norm = 5.31574 | nuclear_norm = 1745.99829
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 57.13030 | spectral_norm = 5.15385 | nuclear_norm = 1324.83716
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 57.09987 | spectral_norm = 4.97345 | nuclear_norm = 1322.20410
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 126.14724 | spectral_norm = 10.32220 | nuclear_norm = 2874.95142
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 140.05675 | spectral_norm = 10.15316 | nuclear_norm = 3293.77002
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 134.31310 | spectral_norm = 9.66569 | nuclear_norm = 3560.84082
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 65.79016 | spectral_norm = 5.29979 | nuclear_norm = 1730.25745
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 552.79846 | spectral_norm = 158.85428 | nuclear_norm = 13725.61914
===========================================
step:251/1750 train_loss:4.0853 train_time:81720ms step_avg:339.09ms
step:252/1750 train_loss:4.1684 train_time:82059ms step_avg:339.09ms
step:253/1750 train_loss:3.9358 train_time:82399ms step_avg:339.09ms
step:254/1750 train_loss:3.8822 train_time:82740ms step_avg:339.10ms
step:255/1750 train_loss:4.0774 train_time:83080ms step_avg:339.10ms
step:256/1750 train_loss:3.9992 train_time:83420ms step_avg:339.11ms
step:257/1750 train_loss:4.0026 train_time:83760ms step_avg:339.11ms
step:258/1750 train_loss:3.9897 train_time:84101ms step_avg:339.12ms
step:259/1750 train_loss:4.0372 train_time:84440ms step_avg:339.12ms
step:260/1750 train_loss:4.0699 train_time:84783ms step_avg:339.13ms
step:261/1750 train_loss:4.0265 train_time:85130ms step_avg:339.16ms
step:262/1750 train_loss:3.9996 train_time:85480ms step_avg:339.21ms
step:263/1750 train_loss:3.8953 train_time:85833ms step_avg:339.26ms
step:264/1750 train_loss:3.9863 train_time:86187ms step_avg:339.32ms
step:265/1750 train_loss:3.8621 train_time:86537ms step_avg:339.36ms
step:266/1750 train_loss:3.9164 train_time:86889ms step_avg:339.41ms
step:267/1750 train_loss:3.9303 train_time:87242ms step_avg:339.46ms
step:268/1750 train_loss:3.9573 train_time:87595ms step_avg:339.52ms
step:269/1750 train_loss:3.8599 train_time:87947ms step_avg:339.57ms
step:270/1750 train_loss:4.1017 train_time:88299ms step_avg:339.61ms
step:271/1750 train_loss:3.9780 train_time:88653ms step_avg:339.67ms
step:272/1750 train_loss:3.9284 train_time:89006ms step_avg:339.72ms
step:273/1750 train_loss:3.9479 train_time:89356ms step_avg:339.76ms
step:274/1750 train_loss:4.0400 train_time:89708ms step_avg:339.80ms
step:275/1750 train_loss:4.0659 train_time:90059ms step_avg:339.84ms
step:276/1750 train_loss:4.2299 train_time:90410ms step_avg:339.89ms
step:277/1750 train_loss:4.0328 train_time:90761ms step_avg:339.93ms
step:278/1750 train_loss:4.0879 train_time:91113ms step_avg:339.97ms
step:279/1750 train_loss:4.0034 train_time:91465ms step_avg:340.02ms
step:280/1750 train_loss:4.2291 train_time:91819ms step_avg:340.07ms
step:281/1750 train_loss:3.9726 train_time:92174ms step_avg:340.12ms
step:282/1750 train_loss:3.9403 train_time:92528ms step_avg:340.18ms
step:283/1750 train_loss:3.9108 train_time:92879ms step_avg:340.22ms
step:284/1750 train_loss:4.0536 train_time:93232ms step_avg:340.26ms
step:285/1750 train_loss:4.0630 train_time:93583ms step_avg:340.30ms
step:286/1750 train_loss:4.0961 train_time:93936ms step_avg:340.35ms
step:287/1750 train_loss:3.9199 train_time:94289ms step_avg:340.39ms
step:288/1750 train_loss:4.0187 train_time:94641ms step_avg:340.44ms
step:289/1750 train_loss:3.8871 train_time:94992ms step_avg:340.47ms
step:290/1750 train_loss:3.8631 train_time:95345ms step_avg:340.52ms
step:291/1750 train_loss:3.9219 train_time:95698ms step_avg:340.56ms
step:292/1750 train_loss:3.8603 train_time:96049ms step_avg:340.60ms
step:293/1750 train_loss:3.9154 train_time:96401ms step_avg:340.64ms
step:294/1750 train_loss:3.9388 train_time:96753ms step_avg:340.68ms
step:295/1750 train_loss:3.8407 train_time:97106ms step_avg:340.72ms
step:296/1750 train_loss:3.8663 train_time:97459ms step_avg:340.77ms
step:297/1750 train_loss:3.8678 train_time:97812ms step_avg:340.81ms
step:298/1750 train_loss:3.9787 train_time:98165ms step_avg:340.85ms
step:299/1750 train_loss:3.8225 train_time:98516ms step_avg:340.89ms
step:300/1750 train_loss:3.9669 train_time:98870ms step_avg:340.93ms
step:301/1750 train_loss:3.9703 train_time:99219ms step_avg:340.96ms
step:302/1750 train_loss:3.9406 train_time:99570ms step_avg:340.99ms
step:303/1750 train_loss:3.9907 train_time:99921ms step_avg:341.03ms
step:304/1750 train_loss:3.9741 train_time:100273ms step_avg:341.06ms
step:305/1750 train_loss:4.4668 train_time:100626ms step_avg:341.11ms
step:306/1750 train_loss:3.9439 train_time:100976ms step_avg:341.14ms
step:307/1750 train_loss:3.8431 train_time:101329ms step_avg:341.17ms
step:308/1750 train_loss:3.9928 train_time:101681ms step_avg:341.21ms
step:309/1750 train_loss:3.8845 train_time:102032ms step_avg:341.24ms
step:310/1750 train_loss:4.1043 train_time:102385ms step_avg:341.28ms
step:311/1750 train_loss:3.9376 train_time:102740ms step_avg:341.33ms
step:312/1750 train_loss:3.8725 train_time:103093ms step_avg:341.37ms
step:313/1750 train_loss:3.9467 train_time:103447ms step_avg:341.41ms
step:314/1750 train_loss:4.0733 train_time:103800ms step_avg:341.45ms
step:315/1750 train_loss:3.9510 train_time:104153ms step_avg:341.48ms
step:316/1750 train_loss:3.7990 train_time:104505ms step_avg:341.52ms
step:317/1750 train_loss:3.8795 train_time:104860ms step_avg:341.56ms
step:318/1750 train_loss:3.9309 train_time:105211ms step_avg:341.59ms
step:319/1750 train_loss:3.9001 train_time:105562ms step_avg:341.62ms
step:320/1750 train_loss:4.0258 train_time:105915ms step_avg:341.66ms
step:321/1750 train_loss:3.9610 train_time:106268ms step_avg:341.70ms
step:322/1750 train_loss:3.9424 train_time:106621ms step_avg:341.73ms
step:323/1750 train_loss:4.0050 train_time:106971ms step_avg:341.76ms
step:324/1750 train_loss:3.9475 train_time:107323ms step_avg:341.79ms
step:325/1750 train_loss:4.0167 train_time:107675ms step_avg:341.82ms
step:326/1750 train_loss:3.8957 train_time:108027ms step_avg:341.86ms
step:327/1750 train_loss:4.3862 train_time:108379ms step_avg:341.89ms
step:328/1750 train_loss:4.0740 train_time:108731ms step_avg:341.92ms
step:329/1750 train_loss:3.7954 train_time:109081ms step_avg:341.95ms
step:330/1750 train_loss:3.7571 train_time:109432ms step_avg:341.97ms
step:331/1750 train_loss:3.9830 train_time:109780ms step_avg:341.99ms
step:332/1750 train_loss:3.9083 train_time:110130ms step_avg:342.02ms
step:333/1750 train_loss:3.8867 train_time:110478ms step_avg:342.04ms
step:334/1750 train_loss:3.8413 train_time:110827ms step_avg:342.06ms
step:335/1750 train_loss:4.0130 train_time:111177ms step_avg:342.08ms
step:336/1750 train_loss:3.9513 train_time:111527ms step_avg:342.11ms
step:337/1750 train_loss:4.4163 train_time:111876ms step_avg:342.13ms
step:338/1750 train_loss:3.9368 train_time:112224ms step_avg:342.15ms
step:339/1750 train_loss:3.8613 train_time:112573ms step_avg:342.17ms
step:340/1750 train_loss:3.9337 train_time:112923ms step_avg:342.19ms
step:341/1750 train_loss:3.8617 train_time:113274ms step_avg:342.22ms
step:342/1750 train_loss:3.8182 train_time:113625ms step_avg:342.24ms
step:343/1750 train_loss:3.8350 train_time:113976ms step_avg:342.27ms
step:344/1750 train_loss:3.9941 train_time:114324ms step_avg:342.29ms
step:345/1750 train_loss:3.8125 train_time:114674ms step_avg:342.31ms
step:346/1750 train_loss:3.7692 train_time:115023ms step_avg:342.33ms
step:347/1750 train_loss:3.8085 train_time:115372ms step_avg:342.35ms
step:348/1750 train_loss:3.8613 train_time:115721ms step_avg:342.37ms
step:349/1750 train_loss:3.8347 train_time:116072ms step_avg:342.39ms
step:350/1750 train_loss:3.5768 train_time:116424ms step_avg:342.42ms
step:351/1750 train_loss:3.8336 train_time:116774ms step_avg:342.44ms
step:352/1750 train_loss:4.2004 train_time:117123ms step_avg:342.47ms
step:353/1750 train_loss:3.6590 train_time:117473ms step_avg:342.49ms
step:354/1750 train_loss:3.9307 train_time:117822ms step_avg:342.51ms
step:355/1750 train_loss:3.7883 train_time:118173ms step_avg:342.53ms
step:356/1750 train_loss:3.8909 train_time:118522ms step_avg:342.55ms
step:357/1750 train_loss:3.7732 train_time:118874ms step_avg:342.58ms
step:358/1750 train_loss:3.8669 train_time:119226ms step_avg:342.60ms
step:359/1750 train_loss:3.7932 train_time:119579ms step_avg:342.63ms
step:360/1750 train_loss:3.4314 train_time:119930ms step_avg:342.66ms
step:361/1750 train_loss:4.0314 train_time:120280ms step_avg:342.68ms
step:362/1750 train_loss:3.9266 train_time:120630ms step_avg:342.70ms
step:363/1750 train_loss:3.8486 train_time:120980ms step_avg:342.72ms
step:364/1750 train_loss:3.7469 train_time:121330ms step_avg:342.74ms
step:365/1750 train_loss:3.9191 train_time:121681ms step_avg:342.76ms
step:366/1750 train_loss:3.8773 train_time:122032ms step_avg:342.79ms
step:367/1750 train_loss:3.8649 train_time:122383ms step_avg:342.81ms
step:368/1750 train_loss:3.8586 train_time:122733ms step_avg:342.83ms
step:369/1750 train_loss:3.7535 train_time:123084ms step_avg:342.85ms
step:370/1750 train_loss:3.8884 train_time:123434ms step_avg:342.87ms
step:371/1750 train_loss:3.7388 train_time:123785ms step_avg:342.89ms
step:372/1750 train_loss:3.6958 train_time:124134ms step_avg:342.91ms
step:373/1750 train_loss:3.9264 train_time:124483ms step_avg:342.93ms
step:374/1750 train_loss:3.8341 train_time:124834ms step_avg:342.95ms
step:375/1750 train_loss:3.8048 train_time:125185ms step_avg:342.97ms
step:375/1750 val_loss:3.8323 train_time:125276ms step_avg:343.22ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 185.09322 | frobenius_norm = 42377.03125 | spectral_norm = 8272.36523 | nuclear_norm = 1049325.62500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 84.26087 | spectral_norm = 10.51557 | nuclear_norm = 1973.03979
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 81.98602 | spectral_norm = 12.72352 | nuclear_norm = 1908.41968
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 164.75247 | spectral_norm = 10.41516 | nuclear_norm = 3940.92261
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 145.95369 | spectral_norm = 12.25517 | nuclear_norm = 3419.15430
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 175.44116 | spectral_norm = 13.07471 | nuclear_norm = 4662.44873
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 90.19026 | spectral_norm = 6.79388 | nuclear_norm = 2392.42432
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 82.47447 | spectral_norm = 7.59254 | nuclear_norm = 1928.57275
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 80.90915 | spectral_norm = 8.64687 | nuclear_norm = 1892.78882
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 170.04169 | spectral_norm = 14.25239 | nuclear_norm = 3927.29785
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 169.93884 | spectral_norm = 12.76320 | nuclear_norm = 3985.30664
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 183.22041 | spectral_norm = 12.02442 | nuclear_norm = 4873.78174
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 92.13214 | spectral_norm = 7.89493 | nuclear_norm = 2435.64575
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 81.88745 | spectral_norm = 6.79733 | nuclear_norm = 1891.42041
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 81.46927 | spectral_norm = 7.32569 | nuclear_norm = 1883.98560
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 177.10362 | spectral_norm = 15.38596 | nuclear_norm = 4063.89111
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 177.20769 | spectral_norm = 13.17380 | nuclear_norm = 4181.62207
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 185.54889 | spectral_norm = 12.80150 | nuclear_norm = 4938.95312
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 92.79468 | spectral_norm = 7.80472 | nuclear_norm = 2449.33032
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 81.44609 | spectral_norm = 7.28326 | nuclear_norm = 1889.73730
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 81.06932 | spectral_norm = 7.61007 | nuclear_norm = 1878.65222
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 174.44408 | spectral_norm = 14.31295 | nuclear_norm = 3989.98193
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 178.37991 | spectral_norm = 13.24059 | nuclear_norm = 4187.76758
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 190.64244 | spectral_norm = 13.24831 | nuclear_norm = 5069.21973
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 93.00566 | spectral_norm = 7.65812 | nuclear_norm = 2450.68140
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 81.12690 | spectral_norm = 7.42853 | nuclear_norm = 1891.77417
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 80.81269 | spectral_norm = 7.40077 | nuclear_norm = 1888.49414
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 173.95441 | spectral_norm = 14.87035 | nuclear_norm = 3952.25220
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 177.16054 | spectral_norm = 13.55448 | nuclear_norm = 4136.17725
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 191.96201 | spectral_norm = 13.84210 | nuclear_norm = 5099.01953
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 92.92382 | spectral_norm = 7.61595 | nuclear_norm = 2441.22852
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 81.05745 | spectral_norm = 6.96541 | nuclear_norm = 1879.78687
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 80.92406 | spectral_norm = 7.29819 | nuclear_norm = 1873.03137
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 168.82811 | spectral_norm = 13.74351 | nuclear_norm = 3847.57324
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 175.21036 | spectral_norm = 13.26543 | nuclear_norm = 4112.66455
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 194.64565 | spectral_norm = 13.14996 | nuclear_norm = 5172.63867
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 92.71494 | spectral_norm = 7.27322 | nuclear_norm = 2442.94629
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 81.43341 | spectral_norm = 7.35432 | nuclear_norm = 1877.06018
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 80.76512 | spectral_norm = 6.82735 | nuclear_norm = 1862.95483
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 178.75327 | spectral_norm = 15.58881 | nuclear_norm = 4052.77710
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 176.63673 | spectral_norm = 13.84160 | nuclear_norm = 4169.24805
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 187.03857 | spectral_norm = 13.08096 | nuclear_norm = 4975.66113
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 92.36114 | spectral_norm = 7.63684 | nuclear_norm = 2440.21729
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 82.70282 | spectral_norm = 7.03188 | nuclear_norm = 1903.76855
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 82.73766 | spectral_norm = 6.83422 | nuclear_norm = 1900.02197
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 187.41568 | spectral_norm = 15.72964 | nuclear_norm = 4299.79443
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 184.13333 | spectral_norm = 12.83081 | nuclear_norm = 4359.90479
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 185.72818 | spectral_norm = 13.99072 | nuclear_norm = 4935.81250
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 92.85259 | spectral_norm = 7.72517 | nuclear_norm = 2454.49512
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 82.84975 | spectral_norm = 7.10111 | nuclear_norm = 1911.28223
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 81.99242 | spectral_norm = 7.25272 | nuclear_norm = 1891.55396
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 183.45946 | spectral_norm = 15.49508 | nuclear_norm = 4208.79150
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 181.62173 | spectral_norm = 13.07768 | nuclear_norm = 4283.86328
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 186.14848 | spectral_norm = 14.11613 | nuclear_norm = 4946.13379
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 93.00315 | spectral_norm = 8.05987 | nuclear_norm = 2458.72363
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 82.76697 | spectral_norm = 7.58582 | nuclear_norm = 1914.02148
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 82.14612 | spectral_norm = 7.21722 | nuclear_norm = 1889.74561
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 183.89813 | spectral_norm = 15.65343 | nuclear_norm = 4218.20361
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 185.16795 | spectral_norm = 13.28997 | nuclear_norm = 4367.65820
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 188.33907 | spectral_norm = 13.77728 | nuclear_norm = 5009.71533
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 93.07066 | spectral_norm = 8.20255 | nuclear_norm = 2462.68359
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 83.21367 | spectral_norm = 8.23861 | nuclear_norm = 1915.36475
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 81.45124 | spectral_norm = 8.09814 | nuclear_norm = 1863.98315
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 183.33398 | spectral_norm = 14.19115 | nuclear_norm = 4257.06348
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 192.57561 | spectral_norm = 12.82607 | nuclear_norm = 4590.49023
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 189.51431 | spectral_norm = 12.91632 | nuclear_norm = 5042.21436
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 92.23251 | spectral_norm = 8.57829 | nuclear_norm = 2437.58984
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 83.92372 | spectral_norm = 7.78961 | nuclear_norm = 1943.23413
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 83.64137 | spectral_norm = 7.37299 | nuclear_norm = 1931.94727
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 159.23788 | spectral_norm = 14.50490 | nuclear_norm = 3627.77832
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 175.71092 | spectral_norm = 13.26149 | nuclear_norm = 4099.85742
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 195.22852 | spectral_norm = 14.43724 | nuclear_norm = 5190.52344
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 94.55893 | spectral_norm = 8.49247 | nuclear_norm = 2495.50757
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 695.20044 | spectral_norm = 175.17218 | nuclear_norm = 17570.72266
===========================================
step:376/1750 train_loss:3.8761 train_time:125532ms step_avg:342.98ms
step:377/1750 train_loss:3.7980 train_time:125898ms step_avg:343.05ms
step:378/1750 train_loss:3.8541 train_time:126364ms step_avg:343.38ms
step:379/1750 train_loss:3.8746 train_time:126841ms step_avg:343.74ms
step:380/1750 train_loss:3.9634 train_time:127215ms step_avg:343.83ms
step:381/1750 train_loss:3.8469 train_time:127562ms step_avg:343.83ms
step:382/1750 train_loss:3.8178 train_time:127910ms step_avg:343.85ms
step:383/1750 train_loss:3.8071 train_time:128261ms step_avg:343.86ms
step:384/1750 train_loss:3.8762 train_time:128608ms step_avg:343.87ms
step:385/1750 train_loss:3.7938 train_time:128959ms step_avg:343.89ms
step:386/1750 train_loss:3.8964 train_time:129307ms step_avg:343.90ms
step:387/1750 train_loss:4.0680 train_time:129657ms step_avg:343.92ms
step:388/1750 train_loss:3.7988 train_time:130006ms step_avg:343.93ms
step:389/1750 train_loss:3.8055 train_time:130356ms step_avg:343.95ms
step:390/1750 train_loss:3.9014 train_time:130711ms step_avg:343.98ms
step:391/1750 train_loss:3.8158 train_time:131068ms step_avg:344.01ms
step:392/1750 train_loss:3.9260 train_time:131424ms step_avg:344.04ms
step:393/1750 train_loss:3.7607 train_time:131782ms step_avg:344.08ms
step:394/1750 train_loss:3.8901 train_time:132141ms step_avg:344.12ms
step:395/1750 train_loss:3.6240 train_time:132500ms step_avg:344.16ms
step:396/1750 train_loss:3.8418 train_time:132859ms step_avg:344.19ms
step:397/1750 train_loss:3.8619 train_time:133217ms step_avg:344.23ms
step:398/1750 train_loss:3.8817 train_time:133573ms step_avg:344.26ms
step:399/1750 train_loss:3.7737 train_time:133928ms step_avg:344.29ms
step:400/1750 train_loss:3.8301 train_time:134291ms step_avg:344.34ms
step:401/1750 train_loss:3.9161 train_time:134646ms step_avg:344.36ms
step:402/1750 train_loss:3.8457 train_time:135005ms step_avg:344.40ms
step:403/1750 train_loss:3.9606 train_time:135362ms step_avg:344.43ms
step:404/1750 train_loss:3.6881 train_time:135718ms step_avg:344.46ms
step:405/1750 train_loss:3.7887 train_time:136074ms step_avg:344.49ms
step:406/1750 train_loss:4.0982 train_time:136430ms step_avg:344.52ms
step:407/1750 train_loss:3.7855 train_time:136786ms step_avg:344.55ms
step:408/1750 train_loss:3.8213 train_time:137141ms step_avg:344.57ms
step:409/1750 train_loss:3.8704 train_time:137499ms step_avg:344.61ms
step:410/1750 train_loss:3.7624 train_time:137855ms step_avg:344.64ms
step:411/1750 train_loss:3.7628 train_time:138212ms step_avg:344.67ms
step:412/1750 train_loss:4.1892 train_time:138569ms step_avg:344.70ms
step:413/1750 train_loss:3.6466 train_time:138925ms step_avg:344.73ms
step:414/1750 train_loss:4.0198 train_time:139281ms step_avg:344.75ms
step:415/1750 train_loss:3.7564 train_time:139638ms step_avg:344.79ms
step:416/1750 train_loss:3.7675 train_time:139994ms step_avg:344.81ms
step:417/1750 train_loss:3.9675 train_time:140353ms step_avg:344.85ms
step:418/1750 train_loss:3.6936 train_time:140710ms step_avg:344.88ms
step:419/1750 train_loss:3.8142 train_time:141066ms step_avg:344.90ms
step:420/1750 train_loss:3.7146 train_time:141424ms step_avg:344.94ms
step:421/1750 train_loss:3.6606 train_time:141781ms step_avg:344.97ms
step:422/1750 train_loss:3.7921 train_time:142136ms step_avg:344.99ms
step:423/1750 train_loss:3.8836 train_time:142494ms step_avg:345.02ms
step:424/1750 train_loss:3.6198 train_time:142853ms step_avg:345.06ms
step:425/1750 train_loss:3.8019 train_time:143211ms step_avg:345.09ms
step:426/1750 train_loss:3.6762 train_time:143566ms step_avg:345.11ms
step:427/1750 train_loss:3.9004 train_time:143922ms step_avg:345.14ms
step:428/1750 train_loss:3.8195 train_time:144280ms step_avg:345.17ms
step:429/1750 train_loss:3.7618 train_time:144638ms step_avg:345.20ms
step:430/1750 train_loss:3.7175 train_time:144996ms step_avg:345.23ms
step:431/1750 train_loss:3.6263 train_time:145353ms step_avg:345.26ms
step:432/1750 train_loss:3.7792 train_time:145710ms step_avg:345.28ms
step:433/1750 train_loss:3.8263 train_time:146067ms step_avg:345.31ms
step:434/1750 train_loss:3.7852 train_time:146423ms step_avg:345.34ms
step:435/1750 train_loss:3.8209 train_time:146780ms step_avg:345.36ms
step:436/1750 train_loss:3.8435 train_time:147139ms step_avg:345.40ms
step:437/1750 train_loss:3.7196 train_time:147498ms step_avg:345.43ms
step:438/1750 train_loss:3.7215 train_time:147854ms step_avg:345.45ms
step:439/1750 train_loss:3.7189 train_time:148211ms step_avg:345.48ms
step:440/1750 train_loss:3.9010 train_time:148567ms step_avg:345.50ms
step:441/1750 train_loss:3.7638 train_time:148923ms step_avg:345.53ms
step:442/1750 train_loss:3.7413 train_time:149278ms step_avg:345.55ms
step:443/1750 train_loss:3.6268 train_time:149636ms step_avg:345.58ms
step:444/1750 train_loss:3.9329 train_time:149994ms step_avg:345.61ms
step:445/1750 train_loss:3.8532 train_time:150352ms step_avg:345.64ms
step:446/1750 train_loss:3.8454 train_time:150711ms step_avg:345.67ms
step:447/1750 train_loss:3.7596 train_time:151071ms step_avg:345.70ms
step:448/1750 train_loss:3.8636 train_time:151430ms step_avg:345.73ms
step:449/1750 train_loss:3.6998 train_time:151789ms step_avg:345.76ms
step:450/1750 train_loss:3.7219 train_time:152145ms step_avg:345.78ms
step:451/1750 train_loss:3.5913 train_time:152503ms step_avg:345.81ms
step:452/1750 train_loss:3.7197 train_time:152859ms step_avg:345.83ms
step:453/1750 train_loss:3.6863 train_time:153217ms step_avg:345.86ms
step:454/1750 train_loss:3.6455 train_time:153573ms step_avg:345.89ms
step:455/1750 train_loss:3.8480 train_time:153929ms step_avg:345.91ms
step:456/1750 train_loss:3.7383 train_time:154286ms step_avg:345.93ms
step:457/1750 train_loss:3.7871 train_time:154641ms step_avg:345.95ms
step:458/1750 train_loss:3.8341 train_time:154996ms step_avg:345.97ms
step:459/1750 train_loss:3.6423 train_time:155354ms step_avg:346.00ms
step:460/1750 train_loss:3.8057 train_time:155709ms step_avg:346.02ms
step:461/1750 train_loss:3.6978 train_time:156067ms step_avg:346.05ms
step:462/1750 train_loss:3.7435 train_time:156424ms step_avg:346.07ms
step:463/1750 train_loss:3.7852 train_time:156779ms step_avg:346.09ms
step:464/1750 train_loss:3.7194 train_time:157133ms step_avg:346.11ms
step:465/1750 train_loss:3.7292 train_time:157488ms step_avg:346.13ms
step:466/1750 train_loss:3.8115 train_time:157843ms step_avg:346.15ms
step:467/1750 train_loss:3.8236 train_time:158201ms step_avg:346.17ms
step:468/1750 train_loss:3.8024 train_time:158556ms step_avg:346.19ms
step:469/1750 train_loss:3.6915 train_time:158911ms step_avg:346.21ms
step:470/1750 train_loss:3.7762 train_time:159265ms step_avg:346.23ms
step:471/1750 train_loss:3.8196 train_time:159620ms step_avg:346.25ms
step:472/1750 train_loss:3.7846 train_time:159977ms step_avg:346.27ms
step:473/1750 train_loss:3.7267 train_time:160333ms step_avg:346.29ms
step:474/1750 train_loss:3.5997 train_time:160687ms step_avg:346.31ms
step:475/1750 train_loss:4.0239 train_time:161040ms step_avg:346.32ms
step:476/1750 train_loss:3.7722 train_time:161397ms step_avg:346.35ms
step:477/1750 train_loss:3.5962 train_time:161756ms step_avg:346.37ms
step:478/1750 train_loss:3.8331 train_time:162112ms step_avg:346.39ms
step:479/1750 train_loss:3.7774 train_time:162470ms step_avg:346.42ms
step:480/1750 train_loss:3.9202 train_time:162826ms step_avg:346.44ms
step:481/1750 train_loss:3.7377 train_time:163181ms step_avg:346.46ms
step:482/1750 train_loss:3.5428 train_time:163538ms step_avg:346.48ms
step:483/1750 train_loss:3.8233 train_time:163893ms step_avg:346.50ms
step:484/1750 train_loss:3.6730 train_time:164251ms step_avg:346.52ms
step:485/1750 train_loss:3.6665 train_time:164607ms step_avg:346.54ms
step:486/1750 train_loss:3.5915 train_time:164964ms step_avg:346.56ms
step:487/1750 train_loss:3.6909 train_time:165318ms step_avg:346.58ms
step:488/1750 train_loss:3.8882 train_time:165673ms step_avg:346.60ms
step:489/1750 train_loss:3.7267 train_time:166029ms step_avg:346.62ms
step:490/1750 train_loss:3.6067 train_time:166384ms step_avg:346.63ms
step:491/1750 train_loss:3.6277 train_time:166739ms step_avg:346.65ms
step:492/1750 train_loss:3.7408 train_time:167096ms step_avg:346.67ms
step:493/1750 train_loss:3.5806 train_time:167454ms step_avg:346.70ms
step:494/1750 train_loss:3.7130 train_time:167811ms step_avg:346.72ms
step:495/1750 train_loss:3.6693 train_time:168168ms step_avg:346.74ms
step:496/1750 train_loss:3.5205 train_time:168524ms step_avg:346.76ms
step:497/1750 train_loss:3.7395 train_time:168877ms step_avg:346.77ms
step:498/1750 train_loss:3.8034 train_time:169233ms step_avg:346.79ms
step:499/1750 train_loss:3.8244 train_time:169588ms step_avg:346.81ms
step:500/1750 train_loss:3.7429 train_time:169948ms step_avg:346.83ms
step:500/1750 val_loss:3.7169 train_time:170038ms step_avg:347.02ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 207.04985 | frobenius_norm = 47487.03516 | spectral_norm = 8937.83789 | nuclear_norm = 1180422.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 105.65128 | spectral_norm = 14.48947 | nuclear_norm = 2464.85254
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 102.37766 | spectral_norm = 16.74764 | nuclear_norm = 2372.47705
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 200.54689 | spectral_norm = 12.53805 | nuclear_norm = 4816.92090
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 170.44870 | spectral_norm = 14.78573 | nuclear_norm = 3982.33789
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 220.18765 | spectral_norm = 16.86568 | nuclear_norm = 5851.11035
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 113.40701 | spectral_norm = 9.07290 | nuclear_norm = 3006.40991
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 103.64536 | spectral_norm = 9.68265 | nuclear_norm = 2414.08862
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 101.46388 | spectral_norm = 10.81065 | nuclear_norm = 2362.39478
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 197.87193 | spectral_norm = 16.88137 | nuclear_norm = 4562.89648
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 198.78613 | spectral_norm = 15.16180 | nuclear_norm = 4650.84619
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 226.41641 | spectral_norm = 15.12950 | nuclear_norm = 6023.81250
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 113.76045 | spectral_norm = 10.40726 | nuclear_norm = 3002.52759
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 102.77097 | spectral_norm = 8.76472 | nuclear_norm = 2357.31641
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 102.14360 | spectral_norm = 9.10420 | nuclear_norm = 2347.05225
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 208.56337 | spectral_norm = 18.86699 | nuclear_norm = 4776.05273
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 209.28732 | spectral_norm = 15.83842 | nuclear_norm = 4929.47656
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 229.07253 | spectral_norm = 16.31865 | nuclear_norm = 6098.12695
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 114.80251 | spectral_norm = 10.21871 | nuclear_norm = 3028.02148
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 102.44794 | spectral_norm = 9.47606 | nuclear_norm = 2361.69409
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 101.86163 | spectral_norm = 9.61527 | nuclear_norm = 2346.57764
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 207.15535 | spectral_norm = 17.15546 | nuclear_norm = 4733.12793
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 211.50670 | spectral_norm = 15.78982 | nuclear_norm = 4958.90820
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 235.46561 | spectral_norm = 17.21617 | nuclear_norm = 6263.09082
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 114.42466 | spectral_norm = 9.89360 | nuclear_norm = 3010.02393
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 102.21219 | spectral_norm = 9.63565 | nuclear_norm = 2372.23901
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 101.69002 | spectral_norm = 9.52583 | nuclear_norm = 2366.99854
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 207.60886 | spectral_norm = 17.82511 | nuclear_norm = 4707.39893
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 211.05843 | spectral_norm = 16.32553 | nuclear_norm = 4914.00342
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 236.63910 | spectral_norm = 17.96568 | nuclear_norm = 6288.24121
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 114.64288 | spectral_norm = 9.93937 | nuclear_norm = 3006.42529
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 101.69817 | spectral_norm = 9.13846 | nuclear_norm = 2345.14917
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 101.44994 | spectral_norm = 9.22954 | nuclear_norm = 2334.01074
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 202.19641 | spectral_norm = 16.45514 | nuclear_norm = 4603.78711
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 208.15446 | spectral_norm = 15.77227 | nuclear_norm = 4870.38867
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 241.83269 | spectral_norm = 16.72949 | nuclear_norm = 6428.04248
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 115.20360 | spectral_norm = 9.67989 | nuclear_norm = 3033.27612
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 102.23691 | spectral_norm = 9.58853 | nuclear_norm = 2342.55225
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 101.15230 | spectral_norm = 8.72517 | nuclear_norm = 2318.90430
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 213.87979 | spectral_norm = 19.00669 | nuclear_norm = 4823.98340
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 210.10512 | spectral_norm = 16.63401 | nuclear_norm = 4946.69727
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 232.78474 | spectral_norm = 16.57560 | nuclear_norm = 6196.04150
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 115.52840 | spectral_norm = 9.83745 | nuclear_norm = 3053.52393
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 104.35561 | spectral_norm = 9.19129 | nuclear_norm = 2389.57324
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 104.12033 | spectral_norm = 8.79564 | nuclear_norm = 2373.37158
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 224.29457 | spectral_norm = 19.45414 | nuclear_norm = 5126.63574
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 220.35619 | spectral_norm = 15.34375 | nuclear_norm = 5213.04248
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 230.26004 | spectral_norm = 18.11906 | nuclear_norm = 6122.45898
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 116.51409 | spectral_norm = 10.12876 | nuclear_norm = 3082.85986
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 104.40002 | spectral_norm = 9.25523 | nuclear_norm = 2390.69043
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 103.30734 | spectral_norm = 9.41428 | nuclear_norm = 2362.30908
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 219.62357 | spectral_norm = 18.96003 | nuclear_norm = 5021.83057
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 216.31767 | spectral_norm = 15.78471 | nuclear_norm = 5088.25537
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 231.23001 | spectral_norm = 18.39066 | nuclear_norm = 6146.90625
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 117.01702 | spectral_norm = 10.60073 | nuclear_norm = 3097.81396
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 104.48956 | spectral_norm = 10.14755 | nuclear_norm = 2397.90771
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 103.76296 | spectral_norm = 9.51658 | nuclear_norm = 2370.48389
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 219.06596 | spectral_norm = 19.45749 | nuclear_norm = 5005.79785
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 219.10487 | spectral_norm = 15.73984 | nuclear_norm = 5152.66895
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 234.06720 | spectral_norm = 17.92181 | nuclear_norm = 6229.94482
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 116.92818 | spectral_norm = 10.81959 | nuclear_norm = 3098.17944
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 104.99375 | spectral_norm = 11.09454 | nuclear_norm = 2399.35986
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 102.49747 | spectral_norm = 10.89062 | nuclear_norm = 2326.32324
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 217.09563 | spectral_norm = 17.21699 | nuclear_norm = 5033.75488
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 226.78767 | spectral_norm = 15.19555 | nuclear_norm = 5388.52930
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 236.40665 | spectral_norm = 16.83472 | nuclear_norm = 6296.88086
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 114.54825 | spectral_norm = 11.72893 | nuclear_norm = 3027.75391
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 105.84583 | spectral_norm = 10.11516 | nuclear_norm = 2434.27588
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 105.68610 | spectral_norm = 9.68088 | nuclear_norm = 2421.72510
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 188.67702 | spectral_norm = 18.26484 | nuclear_norm = 4291.14844
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 207.59068 | spectral_norm = 15.65942 | nuclear_norm = 4830.56152
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 246.24220 | spectral_norm = 19.03434 | nuclear_norm = 6551.71094
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 117.82955 | spectral_norm = 11.80325 | nuclear_norm = 3108.36035
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 815.99481 | spectral_norm = 186.07994 | nuclear_norm = 20847.24805
===========================================
step:501/1750 train_loss:3.8177 train_time:170298ms step_avg:346.84ms
step:502/1750 train_loss:3.7591 train_time:170649ms step_avg:346.85ms
step:503/1750 train_loss:3.7870 train_time:171003ms step_avg:346.86ms
step:504/1750 train_loss:3.7406 train_time:171353ms step_avg:346.87ms
step:505/1750 train_loss:3.8061 train_time:171708ms step_avg:346.88ms
step:506/1750 train_loss:3.6602 train_time:172061ms step_avg:346.90ms
step:507/1750 train_loss:3.7787 train_time:172415ms step_avg:346.91ms
step:508/1750 train_loss:3.8465 train_time:172772ms step_avg:346.93ms
step:509/1750 train_loss:3.7893 train_time:173125ms step_avg:346.94ms
step:510/1750 train_loss:3.5865 train_time:173479ms step_avg:346.96ms
step:511/1750 train_loss:3.7962 train_time:173837ms step_avg:346.98ms
step:512/1750 train_loss:3.7372 train_time:174196ms step_avg:347.00ms
step:513/1750 train_loss:3.6739 train_time:174551ms step_avg:347.02ms
step:514/1750 train_loss:3.7828 train_time:174907ms step_avg:347.04ms
step:515/1750 train_loss:3.7480 train_time:175263ms step_avg:347.06ms
step:516/1750 train_loss:4.0908 train_time:175618ms step_avg:347.07ms
step:517/1750 train_loss:3.6975 train_time:175972ms step_avg:347.09ms
step:518/1750 train_loss:3.7831 train_time:176326ms step_avg:347.10ms
step:519/1750 train_loss:3.6707 train_time:176681ms step_avg:347.11ms
step:520/1750 train_loss:3.6941 train_time:177040ms step_avg:347.14ms
step:521/1750 train_loss:3.6713 train_time:177403ms step_avg:347.17ms
step:522/1750 train_loss:3.6691 train_time:177767ms step_avg:347.20ms
step:523/1750 train_loss:4.2840 train_time:178129ms step_avg:347.23ms
step:524/1750 train_loss:3.7456 train_time:178491ms step_avg:347.26ms
step:525/1750 train_loss:3.6892 train_time:178854ms step_avg:347.29ms
step:526/1750 train_loss:3.7094 train_time:179216ms step_avg:347.32ms
step:527/1750 train_loss:3.6729 train_time:179578ms step_avg:347.35ms
step:528/1750 train_loss:3.6402 train_time:179938ms step_avg:347.37ms
step:529/1750 train_loss:3.8604 train_time:180302ms step_avg:347.40ms
step:530/1750 train_loss:3.6542 train_time:180666ms step_avg:347.44ms
step:531/1750 train_loss:3.9313 train_time:181031ms step_avg:347.47ms
step:532/1750 train_loss:3.7453 train_time:181391ms step_avg:347.49ms
step:533/1750 train_loss:3.6647 train_time:181752ms step_avg:347.52ms
step:534/1750 train_loss:3.6806 train_time:182112ms step_avg:347.54ms
step:535/1750 train_loss:3.6154 train_time:182475ms step_avg:347.57ms
step:536/1750 train_loss:3.7622 train_time:182840ms step_avg:347.60ms
step:537/1750 train_loss:3.7347 train_time:183204ms step_avg:347.64ms
step:538/1750 train_loss:3.6393 train_time:183571ms step_avg:347.67ms
step:539/1750 train_loss:4.1156 train_time:183938ms step_avg:347.71ms
step:540/1750 train_loss:3.6842 train_time:184300ms step_avg:347.74ms
step:541/1750 train_loss:3.7970 train_time:184662ms step_avg:347.76ms
step:542/1750 train_loss:3.6015 train_time:185027ms step_avg:347.80ms
step:543/1750 train_loss:3.5953 train_time:185390ms step_avg:347.82ms
step:544/1750 train_loss:3.6484 train_time:185753ms step_avg:347.85ms
step:545/1750 train_loss:3.5993 train_time:186115ms step_avg:347.88ms
step:546/1750 train_loss:3.6421 train_time:186479ms step_avg:347.91ms
step:547/1750 train_loss:3.6537 train_time:186841ms step_avg:347.94ms
step:548/1750 train_loss:3.6263 train_time:187205ms step_avg:347.96ms
step:549/1750 train_loss:3.7355 train_time:187568ms step_avg:347.99ms
step:550/1750 train_loss:3.6242 train_time:187932ms step_avg:348.02ms
step:551/1750 train_loss:3.6459 train_time:188291ms step_avg:348.04ms
step:552/1750 train_loss:3.9355 train_time:188655ms step_avg:348.07ms
step:553/1750 train_loss:3.7685 train_time:189016ms step_avg:348.10ms
step:554/1750 train_loss:3.7252 train_time:189376ms step_avg:348.12ms
step:555/1750 train_loss:3.6458 train_time:189738ms step_avg:348.14ms
step:556/1750 train_loss:3.7052 train_time:190096ms step_avg:348.16ms
step:557/1750 train_loss:3.3305 train_time:190460ms step_avg:348.19ms
step:558/1750 train_loss:3.6229 train_time:190822ms step_avg:348.22ms
step:559/1750 train_loss:3.6658 train_time:191182ms step_avg:348.24ms
step:560/1750 train_loss:3.7003 train_time:191544ms step_avg:348.26ms
step:561/1750 train_loss:3.6198 train_time:191904ms step_avg:348.28ms
step:562/1750 train_loss:3.5690 train_time:192266ms step_avg:348.31ms
step:563/1750 train_loss:3.7735 train_time:192632ms step_avg:348.34ms
step:564/1750 train_loss:3.5828 train_time:192998ms step_avg:348.37ms
step:565/1750 train_loss:3.6922 train_time:193359ms step_avg:348.39ms
step:566/1750 train_loss:3.6274 train_time:193769ms step_avg:348.50ms
step:567/1750 train_loss:3.6134 train_time:194213ms step_avg:348.68ms
step:568/1750 train_loss:3.7050 train_time:194576ms step_avg:348.70ms
step:569/1750 train_loss:3.6585 train_time:195057ms step_avg:348.94ms
step:570/1750 train_loss:3.7013 train_time:195449ms step_avg:349.02ms
step:571/1750 train_loss:3.7709 train_time:195807ms step_avg:349.03ms
step:572/1750 train_loss:3.7361 train_time:196167ms step_avg:349.05ms
step:573/1750 train_loss:3.7465 train_time:196535ms step_avg:349.08ms
step:574/1750 train_loss:3.7932 train_time:196903ms step_avg:349.12ms
step:575/1750 train_loss:3.7514 train_time:197263ms step_avg:349.14ms
step:576/1750 train_loss:3.7770 train_time:197624ms step_avg:349.16ms
step:577/1750 train_loss:3.6878 train_time:197985ms step_avg:349.18ms
step:578/1750 train_loss:3.6858 train_time:198347ms step_avg:349.20ms
step:579/1750 train_loss:3.6870 train_time:198708ms step_avg:349.22ms
step:580/1750 train_loss:3.6103 train_time:199070ms step_avg:349.25ms
step:581/1750 train_loss:3.6553 train_time:199433ms step_avg:349.27ms
step:582/1750 train_loss:3.8669 train_time:199796ms step_avg:349.29ms
step:583/1750 train_loss:3.6464 train_time:200160ms step_avg:349.32ms
step:584/1750 train_loss:3.6036 train_time:200523ms step_avg:349.34ms
step:585/1750 train_loss:3.8003 train_time:200883ms step_avg:349.36ms
step:586/1750 train_loss:3.5272 train_time:201244ms step_avg:349.38ms
step:587/1750 train_loss:3.6838 train_time:201605ms step_avg:349.40ms
step:588/1750 train_loss:3.6596 train_time:201966ms step_avg:349.42ms
step:589/1750 train_loss:4.0046 train_time:202327ms step_avg:349.44ms
step:590/1750 train_loss:3.7905 train_time:202688ms step_avg:349.46ms
step:591/1750 train_loss:3.5252 train_time:203050ms step_avg:349.48ms
step:592/1750 train_loss:3.5483 train_time:203415ms step_avg:349.51ms
step:593/1750 train_loss:3.5184 train_time:203778ms step_avg:349.53ms
step:594/1750 train_loss:3.5714 train_time:204138ms step_avg:349.55ms
step:595/1750 train_loss:3.9284 train_time:204501ms step_avg:349.57ms
step:596/1750 train_loss:3.6532 train_time:204863ms step_avg:349.60ms
step:597/1750 train_loss:3.5936 train_time:205222ms step_avg:349.61ms
step:598/1750 train_loss:3.6734 train_time:205581ms step_avg:349.63ms
step:599/1750 train_loss:3.4905 train_time:205941ms step_avg:349.64ms
step:600/1750 train_loss:3.6091 train_time:206305ms step_avg:349.67ms
step:601/1750 train_loss:3.6551 train_time:206666ms step_avg:349.69ms
step:602/1750 train_loss:3.6752 train_time:207027ms step_avg:349.71ms
step:603/1750 train_loss:3.7983 train_time:207390ms step_avg:349.73ms
step:604/1750 train_loss:3.6229 train_time:207750ms step_avg:349.75ms
step:605/1750 train_loss:3.6266 train_time:208112ms step_avg:349.77ms
step:606/1750 train_loss:3.5861 train_time:208475ms step_avg:349.79ms
step:607/1750 train_loss:3.8438 train_time:208835ms step_avg:349.81ms
step:608/1750 train_loss:3.6501 train_time:209196ms step_avg:349.83ms
step:609/1750 train_loss:3.6268 train_time:209557ms step_avg:349.84ms
step:610/1750 train_loss:3.7176 train_time:209915ms step_avg:349.86ms
step:611/1750 train_loss:3.6170 train_time:210276ms step_avg:349.88ms
step:612/1750 train_loss:3.5836 train_time:210637ms step_avg:349.89ms
step:613/1750 train_loss:3.7770 train_time:210999ms step_avg:349.92ms
step:614/1750 train_loss:3.7204 train_time:211362ms step_avg:349.94ms
step:615/1750 train_loss:3.7046 train_time:211722ms step_avg:349.95ms
step:616/1750 train_loss:3.6446 train_time:212080ms step_avg:349.97ms
step:617/1750 train_loss:3.5671 train_time:212442ms step_avg:349.99ms
step:618/1750 train_loss:3.7025 train_time:212802ms step_avg:350.00ms
step:619/1750 train_loss:3.5649 train_time:213163ms step_avg:350.02ms
step:620/1750 train_loss:3.5958 train_time:213526ms step_avg:350.04ms
step:621/1750 train_loss:3.9380 train_time:213890ms step_avg:350.06ms
step:622/1750 train_loss:3.5836 train_time:214252ms step_avg:350.09ms
step:623/1750 train_loss:3.6220 train_time:214616ms step_avg:350.11ms
step:624/1750 train_loss:3.7091 train_time:214976ms step_avg:350.12ms
step:625/1750 train_loss:3.7207 train_time:215337ms step_avg:350.14ms
step:625/1750 val_loss:3.6375 train_time:215434ms step_avg:350.30ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 225.49660 | frobenius_norm = 51793.36328 | spectral_norm = 9524.69922 | nuclear_norm = 1291411.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 122.92342 | spectral_norm = 18.23310 | nuclear_norm = 2856.90259
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 118.75689 | spectral_norm = 20.58506 | nuclear_norm = 2741.33838
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 231.85930 | spectral_norm = 14.55516 | nuclear_norm = 5590.14746
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 191.25168 | spectral_norm = 17.09735 | nuclear_norm = 4459.27588
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 257.07001 | spectral_norm = 20.07261 | nuclear_norm = 6832.39355
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 132.71518 | spectral_norm = 11.10984 | nuclear_norm = 3515.84912
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 120.91416 | spectral_norm = 11.33805 | nuclear_norm = 2805.24683
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 118.43907 | spectral_norm = 12.58084 | nuclear_norm = 2748.96289
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 222.30905 | spectral_norm = 19.22465 | nuclear_norm = 5119.85938
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 223.99051 | spectral_norm = 17.10700 | nuclear_norm = 5236.12793
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 262.56058 | spectral_norm = 17.64506 | nuclear_norm = 6986.76074
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 131.58524 | spectral_norm = 12.69558 | nuclear_norm = 3469.04541
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 119.64137 | spectral_norm = 10.54332 | nuclear_norm = 2726.44580
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 118.84795 | spectral_norm = 10.61880 | nuclear_norm = 2715.03662
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 236.69131 | spectral_norm = 21.87450 | nuclear_norm = 5413.52393
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 237.92715 | spectral_norm = 18.44956 | nuclear_norm = 5601.21094
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 264.89182 | spectral_norm = 19.44157 | nuclear_norm = 7051.82324
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 133.19118 | spectral_norm = 12.45753 | nuclear_norm = 3511.05908
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 119.37130 | spectral_norm = 11.39796 | nuclear_norm = 2736.71265
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 118.64045 | spectral_norm = 11.42100 | nuclear_norm = 2718.95386
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 236.95244 | spectral_norm = 19.72847 | nuclear_norm = 5411.76270
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 241.52516 | spectral_norm = 18.17941 | nuclear_norm = 5658.52197
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 272.33142 | spectral_norm = 20.85062 | nuclear_norm = 7243.36865
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 132.28828 | spectral_norm = 11.88139 | nuclear_norm = 3477.78027
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 119.31477 | spectral_norm = 11.51358 | nuclear_norm = 2756.14307
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 118.73225 | spectral_norm = 11.25852 | nuclear_norm = 2754.61279
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 238.29695 | spectral_norm = 20.37187 | nuclear_norm = 5398.16455
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 241.52988 | spectral_norm = 18.92811 | nuclear_norm = 5617.02734
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 273.36676 | spectral_norm = 21.74941 | nuclear_norm = 7264.70117
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 132.63969 | spectral_norm = 12.00128 | nuclear_norm = 3475.17480
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 118.41203 | spectral_norm = 10.92039 | nuclear_norm = 2718.28784
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 117.98891 | spectral_norm = 10.96437 | nuclear_norm = 2702.71680
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 231.51575 | spectral_norm = 19.10184 | nuclear_norm = 5267.93555
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 237.09329 | spectral_norm = 17.95773 | nuclear_norm = 5532.46289
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 280.53488 | spectral_norm = 20.06093 | nuclear_norm = 7455.20801
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 133.61421 | spectral_norm = 11.89602 | nuclear_norm = 3515.45093
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 118.80993 | spectral_norm = 11.60336 | nuclear_norm = 2705.20947
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 117.37838 | spectral_norm = 10.34796 | nuclear_norm = 2677.95947
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 244.45856 | spectral_norm = 22.07799 | nuclear_norm = 5495.50684
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 239.04753 | spectral_norm = 18.89826 | nuclear_norm = 5616.98535
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 270.76297 | spectral_norm = 19.45337 | nuclear_norm = 7208.65186
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 134.59253 | spectral_norm = 12.33494 | nuclear_norm = 3555.91260
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 121.67645 | spectral_norm = 11.01057 | nuclear_norm = 2768.90381
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 121.36756 | spectral_norm = 10.51003 | nuclear_norm = 2747.96191
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 256.85837 | spectral_norm = 22.88244 | nuclear_norm = 5850.13770
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 252.25813 | spectral_norm = 17.57723 | nuclear_norm = 5963.14844
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 267.50998 | spectral_norm = 21.66121 | nuclear_norm = 7112.38965
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 136.10114 | spectral_norm = 12.46767 | nuclear_norm = 3600.98633
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 121.65182 | spectral_norm = 11.22220 | nuclear_norm = 2766.40869
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 120.61617 | spectral_norm = 11.29597 | nuclear_norm = 2738.14453
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 251.30403 | spectral_norm = 21.95257 | nuclear_norm = 5728.78076
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 246.91653 | spectral_norm = 18.11872 | nuclear_norm = 5799.05518
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 268.64923 | spectral_norm = 22.01915 | nuclear_norm = 7143.02588
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 137.06154 | spectral_norm = 12.88611 | nuclear_norm = 3631.02417
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 122.07025 | spectral_norm = 12.27406 | nuclear_norm = 2787.02490
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 121.44373 | spectral_norm = 11.43940 | nuclear_norm = 2757.65063
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 249.76727 | spectral_norm = 22.82235 | nuclear_norm = 5688.54297
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 249.01736 | spectral_norm = 17.91789 | nuclear_norm = 5844.59277
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 272.16132 | spectral_norm = 21.58781 | nuclear_norm = 7244.58154
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 137.15575 | spectral_norm = 13.22722 | nuclear_norm = 3637.11670
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 122.62674 | spectral_norm = 13.66570 | nuclear_norm = 2782.53784
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 119.61124 | spectral_norm = 13.24405 | nuclear_norm = 2696.78760
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 246.76546 | spectral_norm = 19.93957 | nuclear_norm = 5707.29736
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 256.90741 | spectral_norm = 17.37444 | nuclear_norm = 6093.00488
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 276.18372 | spectral_norm = 20.15100 | nuclear_norm = 7361.16357
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 133.02927 | spectral_norm = 14.57468 | nuclear_norm = 3516.43604
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 123.49860 | spectral_norm = 12.42548 | nuclear_norm = 2822.52344
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 123.36365 | spectral_norm = 11.88157 | nuclear_norm = 2809.72925
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 215.00227 | spectral_norm = 21.74638 | nuclear_norm = 4877.47461
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 236.43404 | spectral_norm = 17.98497 | nuclear_norm = 5495.35059
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 288.55017 | spectral_norm = 22.78563 | nuclear_norm = 7677.50293
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 136.93871 | spectral_norm = 14.78983 | nuclear_norm = 3609.48633
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 920.92108 | spectral_norm = 193.17950 | nuclear_norm = 23710.56641
===========================================
step:626/1750 train_loss:3.7559 train_time:215697ms step_avg:350.16ms
step:627/1750 train_loss:3.7332 train_time:216053ms step_avg:350.17ms
step:628/1750 train_loss:3.7840 train_time:216410ms step_avg:350.18ms
step:629/1750 train_loss:3.6050 train_time:216766ms step_avg:350.19ms
step:630/1750 train_loss:3.7360 train_time:217123ms step_avg:350.20ms
step:631/1750 train_loss:3.7616 train_time:217481ms step_avg:350.21ms
step:632/1750 train_loss:3.6616 train_time:217842ms step_avg:350.23ms
step:633/1750 train_loss:3.6134 train_time:218202ms step_avg:350.24ms
step:634/1750 train_loss:3.7110 train_time:218561ms step_avg:350.26ms
step:635/1750 train_loss:3.9644 train_time:218919ms step_avg:350.27ms
step:636/1750 train_loss:3.5596 train_time:219280ms step_avg:350.29ms
step:637/1750 train_loss:3.3635 train_time:219642ms step_avg:350.31ms
step:638/1750 train_loss:3.6068 train_time:220001ms step_avg:350.32ms
step:639/1750 train_loss:3.6527 train_time:220359ms step_avg:350.33ms
step:640/1750 train_loss:3.5844 train_time:220720ms step_avg:350.35ms
step:641/1750 train_loss:3.5983 train_time:221080ms step_avg:350.36ms
step:642/1750 train_loss:3.6459 train_time:221439ms step_avg:350.38ms
step:643/1750 train_loss:3.6223 train_time:221798ms step_avg:350.39ms
step:644/1750 train_loss:3.5708 train_time:222158ms step_avg:350.41ms
step:645/1750 train_loss:3.7947 train_time:222520ms step_avg:350.43ms
step:646/1750 train_loss:3.7007 train_time:222881ms step_avg:350.44ms
step:647/1750 train_loss:3.6825 train_time:223242ms step_avg:350.46ms
step:648/1750 train_loss:3.7290 train_time:223606ms step_avg:350.48ms
step:649/1750 train_loss:3.7810 train_time:223965ms step_avg:350.49ms
step:650/1750 train_loss:3.6387 train_time:224330ms step_avg:350.52ms
step:651/1750 train_loss:3.7869 train_time:224699ms step_avg:350.54ms
step:652/1750 train_loss:3.5972 train_time:225066ms step_avg:350.57ms
step:653/1750 train_loss:3.6730 train_time:225433ms step_avg:350.60ms
step:654/1750 train_loss:3.4448 train_time:225800ms step_avg:350.62ms
step:655/1750 train_loss:3.5894 train_time:226164ms step_avg:350.64ms
step:656/1750 train_loss:3.5881 train_time:226528ms step_avg:350.66ms
step:657/1750 train_loss:3.5162 train_time:226894ms step_avg:350.69ms
step:658/1750 train_loss:3.7019 train_time:227260ms step_avg:350.71ms
step:659/1750 train_loss:3.6019 train_time:227625ms step_avg:350.73ms
step:660/1750 train_loss:3.6932 train_time:227989ms step_avg:350.75ms
step:661/1750 train_loss:3.7628 train_time:228359ms step_avg:350.78ms
step:662/1750 train_loss:3.6811 train_time:228723ms step_avg:350.80ms
step:663/1750 train_loss:3.5653 train_time:229090ms step_avg:350.83ms
step:664/1750 train_loss:3.6285 train_time:229458ms step_avg:350.85ms
step:665/1750 train_loss:3.5044 train_time:229826ms step_avg:350.88ms
step:666/1750 train_loss:3.8011 train_time:230192ms step_avg:350.90ms
step:667/1750 train_loss:3.6239 train_time:230560ms step_avg:350.93ms
step:668/1750 train_loss:3.6630 train_time:230931ms step_avg:350.96ms
step:669/1750 train_loss:3.4982 train_time:231302ms step_avg:350.99ms
step:670/1750 train_loss:3.6193 train_time:231668ms step_avg:351.01ms
step:671/1750 train_loss:3.5751 train_time:232038ms step_avg:351.04ms
step:672/1750 train_loss:3.5843 train_time:232405ms step_avg:351.07ms
step:673/1750 train_loss:3.8616 train_time:232772ms step_avg:351.09ms
step:674/1750 train_loss:3.6437 train_time:233139ms step_avg:351.11ms
step:675/1750 train_loss:3.7268 train_time:233507ms step_avg:351.14ms
step:676/1750 train_loss:3.5013 train_time:233873ms step_avg:351.16ms
step:677/1750 train_loss:3.6083 train_time:234240ms step_avg:351.19ms
step:678/1750 train_loss:3.5652 train_time:234609ms step_avg:351.21ms
step:679/1750 train_loss:3.6960 train_time:234977ms step_avg:351.24ms
step:680/1750 train_loss:3.6041 train_time:235344ms step_avg:351.26ms
step:681/1750 train_loss:3.6319 train_time:235713ms step_avg:351.29ms
step:682/1750 train_loss:3.6780 train_time:236084ms step_avg:351.32ms
step:683/1750 train_loss:3.7474 train_time:236449ms step_avg:351.34ms
step:684/1750 train_loss:3.6587 train_time:236813ms step_avg:351.35ms
step:685/1750 train_loss:3.7078 train_time:237180ms step_avg:351.38ms
step:686/1750 train_loss:3.6456 train_time:237545ms step_avg:351.40ms
step:687/1750 train_loss:3.6845 train_time:237908ms step_avg:351.42ms
step:688/1750 train_loss:3.2190 train_time:238281ms step_avg:351.45ms
step:689/1750 train_loss:3.4202 train_time:238652ms step_avg:351.48ms
step:690/1750 train_loss:3.5594 train_time:239022ms step_avg:351.50ms
step:691/1750 train_loss:3.4327 train_time:239386ms step_avg:351.52ms
step:692/1750 train_loss:3.6460 train_time:239754ms step_avg:351.54ms
step:693/1750 train_loss:3.6637 train_time:240122ms step_avg:351.57ms
step:694/1750 train_loss:3.5674 train_time:240489ms step_avg:351.59ms
step:695/1750 train_loss:3.5541 train_time:240850ms step_avg:351.61ms
step:696/1750 train_loss:3.8647 train_time:241215ms step_avg:351.63ms
step:697/1750 train_loss:3.5985 train_time:241582ms step_avg:351.65ms
step:698/1750 train_loss:3.6638 train_time:241947ms step_avg:351.67ms
step:699/1750 train_loss:3.7845 train_time:242317ms step_avg:351.69ms
step:700/1750 train_loss:3.5854 train_time:242687ms step_avg:351.72ms
step:701/1750 train_loss:3.5568 train_time:243051ms step_avg:351.74ms
step:702/1750 train_loss:3.5294 train_time:243421ms step_avg:351.76ms
step:703/1750 train_loss:3.5150 train_time:243788ms step_avg:351.79ms
step:704/1750 train_loss:3.5866 train_time:244153ms step_avg:351.81ms
step:705/1750 train_loss:3.5727 train_time:244528ms step_avg:351.84ms
step:706/1750 train_loss:3.5991 train_time:244903ms step_avg:351.87ms
step:707/1750 train_loss:3.6703 train_time:245269ms step_avg:351.89ms
step:708/1750 train_loss:3.6153 train_time:245634ms step_avg:351.91ms
step:709/1750 train_loss:3.6000 train_time:246000ms step_avg:351.93ms
step:710/1750 train_loss:3.5598 train_time:246368ms step_avg:351.95ms
step:711/1750 train_loss:3.6074 train_time:246740ms step_avg:351.98ms
step:712/1750 train_loss:3.6621 train_time:247111ms step_avg:352.01ms
step:713/1750 train_loss:3.6656 train_time:247483ms step_avg:352.04ms
step:714/1750 train_loss:3.5794 train_time:247847ms step_avg:352.05ms
step:715/1750 train_loss:3.5864 train_time:248210ms step_avg:352.07ms
step:716/1750 train_loss:3.6020 train_time:248575ms step_avg:352.09ms
step:717/1750 train_loss:3.7315 train_time:248944ms step_avg:352.11ms
step:718/1750 train_loss:3.6148 train_time:249308ms step_avg:352.13ms
step:719/1750 train_loss:3.6983 train_time:249671ms step_avg:352.14ms
step:720/1750 train_loss:3.8535 train_time:250038ms step_avg:352.17ms
step:721/1750 train_loss:3.4787 train_time:250402ms step_avg:352.18ms
step:722/1750 train_loss:3.7456 train_time:250768ms step_avg:352.20ms
step:723/1750 train_loss:3.7872 train_time:251132ms step_avg:352.22ms
step:724/1750 train_loss:3.5808 train_time:251499ms step_avg:352.24ms
step:725/1750 train_loss:3.6703 train_time:251864ms step_avg:352.26ms
step:726/1750 train_loss:3.5582 train_time:252232ms step_avg:352.28ms
step:727/1750 train_loss:3.5920 train_time:252601ms step_avg:352.30ms
step:728/1750 train_loss:3.7560 train_time:252968ms step_avg:352.32ms
step:729/1750 train_loss:3.6862 train_time:253333ms step_avg:352.34ms
step:730/1750 train_loss:3.6840 train_time:253699ms step_avg:352.36ms
step:731/1750 train_loss:3.5714 train_time:254063ms step_avg:352.38ms
step:732/1750 train_loss:3.6155 train_time:254426ms step_avg:352.39ms
step:733/1750 train_loss:3.8507 train_time:254795ms step_avg:352.41ms
step:734/1750 train_loss:3.5755 train_time:255162ms step_avg:352.43ms
step:735/1750 train_loss:3.6238 train_time:255529ms step_avg:352.45ms
step:736/1750 train_loss:3.7556 train_time:255893ms step_avg:352.47ms
step:737/1750 train_loss:3.6938 train_time:256254ms step_avg:352.48ms
step:738/1750 train_loss:3.6175 train_time:256617ms step_avg:352.50ms
step:739/1750 train_loss:3.5215 train_time:256984ms step_avg:352.52ms
step:740/1750 train_loss:4.1306 train_time:257359ms step_avg:352.55ms
step:741/1750 train_loss:3.5111 train_time:257724ms step_avg:352.56ms
step:742/1750 train_loss:3.5785 train_time:258087ms step_avg:352.58ms
step:743/1750 train_loss:3.6068 train_time:258449ms step_avg:352.59ms
step:744/1750 train_loss:3.6670 train_time:258816ms step_avg:352.61ms
step:745/1750 train_loss:3.6153 train_time:259185ms step_avg:352.63ms
step:746/1750 train_loss:3.6150 train_time:259547ms step_avg:352.65ms
step:747/1750 train_loss:3.6578 train_time:259916ms step_avg:352.67ms
step:748/1750 train_loss:3.5925 train_time:260290ms step_avg:352.70ms
step:749/1750 train_loss:3.5787 train_time:260654ms step_avg:352.71ms
step:750/1750 train_loss:3.6219 train_time:261019ms step_avg:352.73ms
step:750/1750 val_loss:3.5836 train_time:261116ms step_avg:352.86ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 241.60695 | frobenius_norm = 55558.73828 | spectral_norm = 10069.37402 | nuclear_norm = 1388990.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 137.83394 | spectral_norm = 21.94799 | nuclear_norm = 3195.27148
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 133.02319 | spectral_norm = 24.43428 | nuclear_norm = 3062.12109
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 258.02612 | spectral_norm = 16.25084 | nuclear_norm = 6240.73291
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 205.16216 | spectral_norm = 18.92328 | nuclear_norm = 4775.06348
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 289.70029 | spectral_norm = 23.10524 | nuclear_norm = 7703.19238
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 149.43579 | spectral_norm = 12.94964 | nuclear_norm = 3957.37305
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 136.38794 | spectral_norm = 12.86047 | nuclear_norm = 3156.58179
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 133.57248 | spectral_norm = 13.86056 | nuclear_norm = 3092.15576
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 244.14273 | spectral_norm = 21.25120 | nuclear_norm = 5617.82910
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 246.26779 | spectral_norm = 18.91479 | nuclear_norm = 5759.89551
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 294.46448 | spectral_norm = 20.00136 | nuclear_norm = 7839.00586
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 147.07513 | spectral_norm = 14.64057 | nuclear_norm = 3874.60449
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 134.37057 | spectral_norm = 12.05716 | nuclear_norm = 3047.48682
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 133.52863 | spectral_norm = 11.96285 | nuclear_norm = 3038.28052
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 262.29483 | spectral_norm = 24.38231 | nuclear_norm = 5991.44824
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 263.27017 | spectral_norm = 20.69970 | nuclear_norm = 6197.81738
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 296.45212 | spectral_norm = 22.41062 | nuclear_norm = 7894.72559
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 149.24214 | spectral_norm = 14.45430 | nuclear_norm = 3932.62671
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 134.00581 | spectral_norm = 13.14515 | nuclear_norm = 3060.90479
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 133.11990 | spectral_norm = 12.90649 | nuclear_norm = 3040.42578
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 264.06229 | spectral_norm = 21.90656 | nuclear_norm = 6030.39844
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 268.48367 | spectral_norm = 20.31217 | nuclear_norm = 6288.13330
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 304.67044 | spectral_norm = 24.31554 | nuclear_norm = 8104.87109
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 147.96759 | spectral_norm = 13.64344 | nuclear_norm = 3888.89062
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 134.24821 | spectral_norm = 13.33068 | nuclear_norm = 3091.28027
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 133.40935 | spectral_norm = 12.82892 | nuclear_norm = 3089.24609
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 266.42517 | spectral_norm = 22.71873 | nuclear_norm = 6037.58447
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 269.22845 | spectral_norm = 21.42566 | nuclear_norm = 6258.74316
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 305.29544 | spectral_norm = 25.21693 | nuclear_norm = 8114.00244
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 148.29471 | spectral_norm = 13.87142 | nuclear_norm = 3883.08643
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 132.79854 | spectral_norm = 12.71195 | nuclear_norm = 3036.48584
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 132.21925 | spectral_norm = 12.42628 | nuclear_norm = 3017.45435
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 258.48062 | spectral_norm = 21.54985 | nuclear_norm = 5880.28906
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 263.40225 | spectral_norm = 19.98822 | nuclear_norm = 6135.75879
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 314.50378 | spectral_norm = 23.34633 | nuclear_norm = 8357.16211
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 149.64314 | spectral_norm = 13.90702 | nuclear_norm = 3934.04883
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 132.91664 | spectral_norm = 13.19616 | nuclear_norm = 3010.85083
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 131.35536 | spectral_norm = 11.82315 | nuclear_norm = 2981.62695
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 271.53802 | spectral_norm = 24.91627 | nuclear_norm = 6086.96436
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 264.67578 | spectral_norm = 20.68120 | nuclear_norm = 6208.73438
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 304.35861 | spectral_norm = 22.05854 | nuclear_norm = 8102.34131
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 151.22012 | spectral_norm = 14.58753 | nuclear_norm = 3993.27051
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 136.51390 | spectral_norm = 12.63707 | nuclear_norm = 3092.68799
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 136.34526 | spectral_norm = 12.00434 | nuclear_norm = 3073.45410
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 285.54218 | spectral_norm = 25.89449 | nuclear_norm = 6484.60156
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 280.75516 | spectral_norm = 19.87713 | nuclear_norm = 6631.29102
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 300.44470 | spectral_norm = 24.89624 | nuclear_norm = 7986.20459
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 153.19044 | spectral_norm = 14.60239 | nuclear_norm = 4052.58105
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 136.43239 | spectral_norm = 13.02878 | nuclear_norm = 3084.85596
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 135.64296 | spectral_norm = 13.01995 | nuclear_norm = 3063.96680
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 279.65775 | spectral_norm = 24.94567 | nuclear_norm = 6359.01758
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 274.30298 | spectral_norm = 20.13116 | nuclear_norm = 6434.96729
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 301.83347 | spectral_norm = 25.25938 | nuclear_norm = 8024.60986
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 154.56128 | spectral_norm = 15.00634 | nuclear_norm = 4096.21777
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 137.13676 | spectral_norm = 14.21955 | nuclear_norm = 3114.49854
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 136.82968 | spectral_norm = 13.18977 | nuclear_norm = 3090.73584
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 277.36502 | spectral_norm = 26.12570 | nuclear_norm = 6296.16699
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 275.80859 | spectral_norm = 19.91899 | nuclear_norm = 6468.56348
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 306.15677 | spectral_norm = 25.01662 | nuclear_norm = 8147.83057
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 155.02434 | spectral_norm = 15.47882 | nuclear_norm = 4112.85010
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 137.68884 | spectral_norm = 15.94911 | nuclear_norm = 3106.29028
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 134.12587 | spectral_norm = 15.45554 | nuclear_norm = 3003.85156
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 273.92160 | spectral_norm = 22.74442 | nuclear_norm = 6323.82031
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 284.06622 | spectral_norm = 19.37645 | nuclear_norm = 6730.30029
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 311.10916 | spectral_norm = 23.11631 | nuclear_norm = 8295.08594
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 149.22052 | spectral_norm = 17.05414 | nuclear_norm = 3944.29834
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 138.66805 | spectral_norm = 14.42797 | nuclear_norm = 3153.63965
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 138.72893 | spectral_norm = 13.89763 | nuclear_norm = 3144.31592
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 239.50381 | spectral_norm = 24.99587 | nuclear_norm = 5418.58984
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 263.24966 | spectral_norm = 20.11955 | nuclear_norm = 6116.17676
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 326.00909 | spectral_norm = 25.92757 | nuclear_norm = 8673.38867
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 153.87250 | spectral_norm = 17.44341 | nuclear_norm = 4053.06738
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1014.06812 | spectral_norm = 197.57538 | nuclear_norm = 26267.28516
===========================================
step:751/1750 train_loss:3.5832 train_time:261382ms step_avg:352.74ms
step:752/1750 train_loss:3.6287 train_time:261739ms step_avg:352.75ms
step:753/1750 train_loss:3.6365 train_time:262101ms step_avg:352.76ms
step:754/1750 train_loss:3.6054 train_time:262467ms step_avg:352.78ms
step:755/1750 train_loss:3.6984 train_time:262852ms step_avg:352.82ms
step:756/1750 train_loss:3.4797 train_time:263349ms step_avg:353.01ms
step:757/1750 train_loss:3.7382 train_time:263715ms step_avg:353.03ms
step:758/1750 train_loss:3.6742 train_time:264078ms step_avg:353.05ms
step:759/1750 train_loss:3.6046 train_time:264578ms step_avg:353.24ms
step:760/1750 train_loss:3.7207 train_time:264951ms step_avg:353.27ms
step:761/1750 train_loss:3.4171 train_time:265313ms step_avg:353.28ms
step:762/1750 train_loss:3.5584 train_time:265677ms step_avg:353.29ms
step:763/1750 train_loss:3.6805 train_time:266042ms step_avg:353.31ms
step:764/1750 train_loss:3.3337 train_time:266405ms step_avg:353.32ms
step:765/1750 train_loss:3.7493 train_time:266771ms step_avg:353.34ms
step:766/1750 train_loss:3.5882 train_time:267140ms step_avg:353.36ms
step:767/1750 train_loss:3.5852 train_time:267504ms step_avg:353.37ms
step:768/1750 train_loss:3.5862 train_time:267871ms step_avg:353.39ms
step:769/1750 train_loss:3.5995 train_time:268239ms step_avg:353.41ms
step:770/1750 train_loss:3.6599 train_time:268602ms step_avg:353.42ms
step:771/1750 train_loss:3.8970 train_time:268966ms step_avg:353.44ms
step:772/1750 train_loss:3.4669 train_time:269328ms step_avg:353.45ms
step:773/1750 train_loss:3.6491 train_time:269692ms step_avg:353.46ms
step:774/1750 train_loss:3.6613 train_time:270055ms step_avg:353.48ms
step:775/1750 train_loss:3.6278 train_time:270418ms step_avg:353.49ms
step:776/1750 train_loss:3.4138 train_time:270785ms step_avg:353.51ms
step:777/1750 train_loss:3.4104 train_time:271153ms step_avg:353.52ms
step:778/1750 train_loss:3.5003 train_time:271515ms step_avg:353.54ms
step:779/1750 train_loss:3.5929 train_time:271886ms step_avg:353.56ms
step:780/1750 train_loss:3.6090 train_time:272258ms step_avg:353.58ms
step:781/1750 train_loss:3.6833 train_time:272626ms step_avg:353.60ms
step:782/1750 train_loss:3.6124 train_time:272997ms step_avg:353.62ms
step:783/1750 train_loss:3.5894 train_time:273367ms step_avg:353.64ms
step:784/1750 train_loss:3.6159 train_time:273739ms step_avg:353.67ms
step:785/1750 train_loss:3.5800 train_time:274107ms step_avg:353.69ms
step:786/1750 train_loss:3.4593 train_time:274478ms step_avg:353.71ms
step:787/1750 train_loss:3.8231 train_time:274852ms step_avg:353.73ms
step:788/1750 train_loss:3.5124 train_time:275227ms step_avg:353.76ms
step:789/1750 train_loss:3.5701 train_time:275595ms step_avg:353.78ms
step:790/1750 train_loss:3.6415 train_time:275969ms step_avg:353.81ms
step:791/1750 train_loss:3.7943 train_time:276345ms step_avg:353.84ms
step:792/1750 train_loss:3.7801 train_time:276716ms step_avg:353.86ms
step:793/1750 train_loss:3.4752 train_time:277083ms step_avg:353.87ms
step:794/1750 train_loss:3.6160 train_time:277454ms step_avg:353.90ms
step:795/1750 train_loss:3.6879 train_time:277828ms step_avg:353.92ms
step:796/1750 train_loss:3.7493 train_time:278205ms step_avg:353.95ms
step:797/1750 train_loss:3.5414 train_time:278576ms step_avg:353.97ms
step:798/1750 train_loss:3.6650 train_time:278953ms step_avg:354.00ms
step:799/1750 train_loss:3.5571 train_time:279332ms step_avg:354.03ms
step:800/1750 train_loss:3.5538 train_time:279706ms step_avg:354.06ms
step:801/1750 train_loss:3.6530 train_time:280074ms step_avg:354.08ms
step:802/1750 train_loss:3.5115 train_time:280448ms step_avg:354.10ms
step:803/1750 train_loss:3.5254 train_time:280816ms step_avg:354.12ms
step:804/1750 train_loss:3.6466 train_time:281186ms step_avg:354.14ms
step:805/1750 train_loss:3.5409 train_time:281561ms step_avg:354.16ms
step:806/1750 train_loss:3.5762 train_time:281928ms step_avg:354.18ms
step:807/1750 train_loss:3.6651 train_time:282298ms step_avg:354.20ms
step:808/1750 train_loss:3.5717 train_time:282669ms step_avg:354.22ms
step:809/1750 train_loss:3.5150 train_time:283037ms step_avg:354.24ms
step:810/1750 train_loss:3.5816 train_time:283406ms step_avg:354.26ms
step:811/1750 train_loss:3.6068 train_time:283776ms step_avg:354.28ms
step:812/1750 train_loss:3.6177 train_time:284143ms step_avg:354.29ms
step:813/1750 train_loss:3.6444 train_time:284508ms step_avg:354.31ms
step:814/1750 train_loss:3.5879 train_time:284878ms step_avg:354.33ms
step:815/1750 train_loss:3.5795 train_time:285250ms step_avg:354.35ms
step:816/1750 train_loss:3.7008 train_time:285624ms step_avg:354.37ms
step:817/1750 train_loss:3.7852 train_time:285993ms step_avg:354.39ms
step:818/1750 train_loss:3.5384 train_time:286364ms step_avg:354.41ms
step:819/1750 train_loss:3.7363 train_time:286738ms step_avg:354.43ms
step:820/1750 train_loss:3.5242 train_time:287111ms step_avg:354.46ms
step:821/1750 train_loss:3.5777 train_time:287481ms step_avg:354.48ms
step:822/1750 train_loss:3.7117 train_time:287854ms step_avg:354.50ms
step:823/1750 train_loss:3.5949 train_time:288226ms step_avg:354.52ms
step:824/1750 train_loss:3.5276 train_time:288597ms step_avg:354.54ms
step:825/1750 train_loss:3.6387 train_time:288971ms step_avg:354.57ms
step:826/1750 train_loss:3.4978 train_time:289347ms step_avg:354.59ms
step:827/1750 train_loss:3.7508 train_time:289720ms step_avg:354.61ms
step:828/1750 train_loss:3.6381 train_time:290092ms step_avg:354.64ms
step:829/1750 train_loss:3.6529 train_time:290465ms step_avg:354.66ms
step:830/1750 train_loss:3.5500 train_time:290836ms step_avg:354.68ms
step:831/1750 train_loss:3.6193 train_time:291204ms step_avg:354.69ms
step:832/1750 train_loss:3.5279 train_time:291574ms step_avg:354.71ms
step:833/1750 train_loss:3.6681 train_time:291945ms step_avg:354.73ms
step:834/1750 train_loss:3.4943 train_time:292318ms step_avg:354.76ms
step:835/1750 train_loss:3.4773 train_time:292693ms step_avg:354.78ms
step:836/1750 train_loss:3.7389 train_time:293070ms step_avg:354.81ms
step:837/1750 train_loss:3.4233 train_time:293441ms step_avg:354.83ms
step:838/1750 train_loss:3.6080 train_time:293808ms step_avg:354.84ms
step:839/1750 train_loss:3.4360 train_time:294179ms step_avg:354.86ms
step:840/1750 train_loss:3.4860 train_time:294549ms step_avg:354.88ms
step:841/1750 train_loss:3.5867 train_time:294922ms step_avg:354.90ms
step:842/1750 train_loss:3.6011 train_time:295295ms step_avg:354.92ms
step:843/1750 train_loss:3.5911 train_time:295663ms step_avg:354.94ms
step:844/1750 train_loss:3.4445 train_time:296035ms step_avg:354.96ms
step:845/1750 train_loss:3.6800 train_time:296403ms step_avg:354.97ms
step:846/1750 train_loss:3.5331 train_time:296774ms step_avg:354.99ms
step:847/1750 train_loss:3.5065 train_time:297147ms step_avg:355.01ms
step:848/1750 train_loss:3.6554 train_time:297518ms step_avg:355.03ms
step:849/1750 train_loss:3.5121 train_time:297891ms step_avg:355.05ms
step:850/1750 train_loss:3.4521 train_time:298262ms step_avg:355.07ms
step:851/1750 train_loss:3.7531 train_time:298631ms step_avg:355.09ms
step:852/1750 train_loss:3.4665 train_time:298998ms step_avg:355.10ms
step:853/1750 train_loss:3.5861 train_time:299366ms step_avg:355.12ms
step:854/1750 train_loss:3.6777 train_time:299737ms step_avg:355.14ms
step:855/1750 train_loss:3.5347 train_time:300104ms step_avg:355.15ms
step:856/1750 train_loss:3.5621 train_time:300471ms step_avg:355.17ms
step:857/1750 train_loss:3.6238 train_time:300844ms step_avg:355.19ms
step:858/1750 train_loss:3.4847 train_time:301219ms step_avg:355.21ms
step:859/1750 train_loss:3.5882 train_time:301589ms step_avg:355.23ms
step:860/1750 train_loss:3.6097 train_time:301955ms step_avg:355.24ms
step:861/1750 train_loss:3.6488 train_time:302332ms step_avg:355.27ms
step:862/1750 train_loss:3.6186 train_time:302710ms step_avg:355.29ms
step:863/1750 train_loss:3.5942 train_time:303082ms step_avg:355.31ms
step:864/1750 train_loss:3.3973 train_time:303454ms step_avg:355.33ms
step:865/1750 train_loss:3.6207 train_time:303820ms step_avg:355.34ms
step:866/1750 train_loss:3.9215 train_time:304194ms step_avg:355.37ms
step:867/1750 train_loss:3.4713 train_time:304563ms step_avg:355.38ms
step:868/1750 train_loss:3.6575 train_time:304931ms step_avg:355.40ms
step:869/1750 train_loss:3.6365 train_time:305304ms step_avg:355.42ms
step:870/1750 train_loss:3.4686 train_time:305676ms step_avg:355.44ms
step:871/1750 train_loss:3.4466 train_time:306043ms step_avg:355.45ms
step:872/1750 train_loss:3.6747 train_time:306412ms step_avg:355.47ms
step:873/1750 train_loss:3.4723 train_time:306779ms step_avg:355.48ms
step:874/1750 train_loss:3.2425 train_time:307156ms step_avg:355.50ms
step:875/1750 train_loss:3.6588 train_time:307525ms step_avg:355.52ms
step:875/1750 val_loss:3.5401 train_time:307623ms step_avg:355.63ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 255.89078 | frobenius_norm = 58904.71094 | spectral_norm = 10578.33203 | nuclear_norm = 1475905.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 151.39459 | spectral_norm = 25.46657 | nuclear_norm = 3501.97021
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 146.08734 | spectral_norm = 28.17151 | nuclear_norm = 3354.17627
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 281.49023 | spectral_norm = 18.00268 | nuclear_norm = 6824.84961
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 216.40486 | spectral_norm = 20.57954 | nuclear_norm = 5023.71631
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 320.84158 | spectral_norm = 26.20216 | nuclear_norm = 8534.88477
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 164.58269 | spectral_norm = 14.63147 | nuclear_norm = 4355.90527
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 150.37492 | spectral_norm = 14.45319 | nuclear_norm = 3469.44922
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 147.54262 | spectral_norm = 15.19609 | nuclear_norm = 3408.68750
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 264.65771 | spectral_norm = 23.40705 | nuclear_norm = 6084.62012
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 267.18015 | spectral_norm = 20.75435 | nuclear_norm = 6247.21777
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 323.99484 | spectral_norm = 22.42230 | nuclear_norm = 8627.57227
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 161.13483 | spectral_norm = 16.36106 | nuclear_norm = 4242.75000
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 147.68671 | spectral_norm = 13.55506 | nuclear_norm = 3331.00049
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 146.77670 | spectral_norm = 13.18144 | nuclear_norm = 3325.03662
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 286.50897 | spectral_norm = 26.71334 | nuclear_norm = 6537.17676
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 287.28992 | spectral_norm = 22.69244 | nuclear_norm = 6763.07812
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 325.80444 | spectral_norm = 25.30981 | nuclear_norm = 8677.56152
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 164.04778 | spectral_norm = 16.24281 | nuclear_norm = 4321.62988
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 147.45938 | spectral_norm = 14.87171 | nuclear_norm = 3354.76611
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 146.14339 | spectral_norm = 14.29502 | nuclear_norm = 3327.82520
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 289.80231 | spectral_norm = 24.12322 | nuclear_norm = 6619.32129
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 293.91440 | spectral_norm = 22.43580 | nuclear_norm = 6880.97168
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 334.59329 | spectral_norm = 27.72346 | nuclear_norm = 8903.82129
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 162.34480 | spectral_norm = 15.20286 | nuclear_norm = 4266.39795
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 147.71104 | spectral_norm = 14.99170 | nuclear_norm = 3391.03101
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 146.71988 | spectral_norm = 14.36393 | nuclear_norm = 3390.42603
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 293.03000 | spectral_norm = 24.80048 | nuclear_norm = 6642.84521
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 295.51553 | spectral_norm = 23.46255 | nuclear_norm = 6867.27148
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 334.85074 | spectral_norm = 28.36264 | nuclear_norm = 8902.24414
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 162.59685 | spectral_norm = 15.58377 | nuclear_norm = 4256.18945
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 146.13037 | spectral_norm = 14.25159 | nuclear_norm = 3330.55908
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 145.19881 | spectral_norm = 13.69713 | nuclear_norm = 3305.26758
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 283.76370 | spectral_norm = 23.86514 | nuclear_norm = 6453.71729
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 288.14850 | spectral_norm = 21.96281 | nuclear_norm = 6708.37012
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 345.82452 | spectral_norm = 26.32225 | nuclear_norm = 9188.05273
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 164.14839 | spectral_norm = 15.76523 | nuclear_norm = 4313.09033
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 145.80751 | spectral_norm = 14.72487 | nuclear_norm = 3288.65576
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 144.12143 | spectral_norm = 13.16957 | nuclear_norm = 3261.98706
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 297.03049 | spectral_norm = 27.39321 | nuclear_norm = 6648.95508
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 288.75653 | spectral_norm = 22.44565 | nuclear_norm = 6765.78369
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 335.84326 | spectral_norm = 24.76624 | nuclear_norm = 8939.63672
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 166.21719 | spectral_norm = 16.70318 | nuclear_norm = 4386.56445
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 150.00569 | spectral_norm = 14.05275 | nuclear_norm = 3383.59619
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 149.96986 | spectral_norm = 13.51345 | nuclear_norm = 3367.77393
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 312.12839 | spectral_norm = 28.76016 | nuclear_norm = 7071.08740
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 307.06802 | spectral_norm = 21.87967 | nuclear_norm = 7249.22559
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 330.74619 | spectral_norm = 28.11585 | nuclear_norm = 8790.19043
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 168.57748 | spectral_norm = 16.61305 | nuclear_norm = 4457.96875
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 149.76706 | spectral_norm = 14.61368 | nuclear_norm = 3372.51807
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 149.26193 | spectral_norm = 14.43196 | nuclear_norm = 3357.42578
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 305.93408 | spectral_norm = 27.76568 | nuclear_norm = 6935.34570
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 299.62418 | spectral_norm = 22.22031 | nuclear_norm = 7021.29492
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 332.56555 | spectral_norm = 28.25107 | nuclear_norm = 8840.47559
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 170.47516 | spectral_norm = 17.01023 | nuclear_norm = 4518.23877
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 150.93756 | spectral_norm = 16.03458 | nuclear_norm = 3413.71704
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 150.76091 | spectral_norm = 14.76504 | nuclear_norm = 3390.58276
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 302.79492 | spectral_norm = 29.38696 | nuclear_norm = 6855.56836
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 300.59305 | spectral_norm = 21.68534 | nuclear_norm = 7045.07861
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 337.64059 | spectral_norm = 28.19658 | nuclear_norm = 8983.40723
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 171.28931 | spectral_norm = 17.53712 | nuclear_norm = 4546.27393
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 151.40216 | spectral_norm = 17.87493 | nuclear_norm = 3395.21973
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 147.35432 | spectral_norm = 17.51206 | nuclear_norm = 3279.32397
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 299.65448 | spectral_norm = 25.39847 | nuclear_norm = 6909.20215
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 309.78293 | spectral_norm = 21.22466 | nuclear_norm = 7331.38770
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 343.94220 | spectral_norm = 25.92803 | nuclear_norm = 9173.28125
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 163.89723 | spectral_norm = 19.34469 | nuclear_norm = 4332.40869
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 152.31702 | spectral_norm = 16.11573 | nuclear_norm = 3448.61670
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 152.57228 | spectral_norm = 15.73254 | nuclear_norm = 3445.50488
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 262.81076 | spectral_norm = 28.12765 | nuclear_norm = 5933.35156
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 288.94562 | spectral_norm = 22.16245 | nuclear_norm = 6713.86035
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 360.14703 | spectral_norm = 28.84418 | nuclear_norm = 9578.57129
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 169.20941 | spectral_norm = 19.90573 | nuclear_norm = 4454.21387
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1097.97742 | spectral_norm = 199.97003 | nuclear_norm = 28576.20312
===========================================
step:876/1750 train_loss:3.4575 train_time:307886ms step_avg:355.53ms
step:877/1750 train_loss:3.6405 train_time:308246ms step_avg:355.53ms
step:878/1750 train_loss:3.4918 train_time:308614ms step_avg:355.55ms
step:879/1750 train_loss:3.6704 train_time:308982ms step_avg:355.56ms
step:880/1750 train_loss:3.3240 train_time:309347ms step_avg:355.57ms
step:881/1750 train_loss:3.5007 train_time:309715ms step_avg:355.59ms
step:882/1750 train_loss:3.7138 train_time:310085ms step_avg:355.60ms
step:883/1750 train_loss:3.8588 train_time:310452ms step_avg:355.62ms
step:884/1750 train_loss:3.5863 train_time:310822ms step_avg:355.63ms
step:885/1750 train_loss:3.5116 train_time:311192ms step_avg:355.65ms
step:886/1750 train_loss:3.5903 train_time:311563ms step_avg:355.66ms
step:887/1750 train_loss:4.1011 train_time:311929ms step_avg:355.68ms
step:888/1750 train_loss:3.8645 train_time:312307ms step_avg:355.70ms
step:889/1750 train_loss:3.5437 train_time:312677ms step_avg:355.72ms
step:890/1750 train_loss:3.5490 train_time:313042ms step_avg:355.73ms
step:891/1750 train_loss:3.3839 train_time:313409ms step_avg:355.74ms
step:892/1750 train_loss:3.7373 train_time:313776ms step_avg:355.75ms
step:893/1750 train_loss:3.4420 train_time:314141ms step_avg:355.77ms
step:894/1750 train_loss:3.6517 train_time:314515ms step_avg:355.79ms
step:895/1750 train_loss:3.7039 train_time:314886ms step_avg:355.80ms
step:896/1750 train_loss:3.5263 train_time:315255ms step_avg:355.82ms
step:897/1750 train_loss:3.5587 train_time:315625ms step_avg:355.83ms
step:898/1750 train_loss:3.6111 train_time:315995ms step_avg:355.85ms
step:899/1750 train_loss:3.4960 train_time:316361ms step_avg:355.86ms
step:900/1750 train_loss:3.4370 train_time:316732ms step_avg:355.88ms
step:901/1750 train_loss:3.6406 train_time:317098ms step_avg:355.89ms
step:902/1750 train_loss:3.6574 train_time:317466ms step_avg:355.90ms
step:903/1750 train_loss:3.5555 train_time:317841ms step_avg:355.92ms
step:904/1750 train_loss:3.5154 train_time:318211ms step_avg:355.94ms
step:905/1750 train_loss:3.5247 train_time:318577ms step_avg:355.95ms
step:906/1750 train_loss:3.7318 train_time:318951ms step_avg:355.97ms
step:907/1750 train_loss:3.5337 train_time:319324ms step_avg:355.99ms
step:908/1750 train_loss:3.5909 train_time:319691ms step_avg:356.00ms
step:909/1750 train_loss:3.4695 train_time:320070ms step_avg:356.03ms
step:910/1750 train_loss:3.5503 train_time:320455ms step_avg:356.06ms
step:911/1750 train_loss:3.6615 train_time:320827ms step_avg:356.08ms
step:912/1750 train_loss:3.6155 train_time:321204ms step_avg:356.10ms
step:913/1750 train_loss:3.4864 train_time:321582ms step_avg:356.13ms
step:914/1750 train_loss:3.7679 train_time:321963ms step_avg:356.15ms
step:915/1750 train_loss:3.5560 train_time:322344ms step_avg:356.18ms
step:916/1750 train_loss:3.6379 train_time:322718ms step_avg:356.20ms
step:917/1750 train_loss:3.6202 train_time:323093ms step_avg:356.22ms
step:918/1750 train_loss:4.8365 train_time:323475ms step_avg:356.25ms
step:919/1750 train_loss:3.5129 train_time:323856ms step_avg:356.28ms
step:920/1750 train_loss:3.6079 train_time:324228ms step_avg:356.29ms
step:921/1750 train_loss:3.5670 train_time:324606ms step_avg:356.32ms
step:922/1750 train_loss:3.6047 train_time:324986ms step_avg:356.34ms
step:923/1750 train_loss:3.6334 train_time:325358ms step_avg:356.36ms
step:924/1750 train_loss:3.7011 train_time:325733ms step_avg:356.38ms
step:925/1750 train_loss:3.6715 train_time:326109ms step_avg:356.40ms
step:926/1750 train_loss:3.5739 train_time:326480ms step_avg:356.42ms
step:927/1750 train_loss:3.5683 train_time:326851ms step_avg:356.43ms
step:928/1750 train_loss:3.8029 train_time:327226ms step_avg:356.46ms
step:929/1750 train_loss:3.6310 train_time:327602ms step_avg:356.48ms
step:930/1750 train_loss:3.4148 train_time:327977ms step_avg:356.50ms
step:931/1750 train_loss:3.5204 train_time:328345ms step_avg:356.51ms
step:932/1750 train_loss:3.6732 train_time:328720ms step_avg:356.53ms
step:933/1750 train_loss:3.4000 train_time:329095ms step_avg:356.55ms
step:934/1750 train_loss:3.6044 train_time:329472ms step_avg:356.57ms
step:935/1750 train_loss:3.4579 train_time:329850ms step_avg:356.59ms
step:936/1750 train_loss:3.5365 train_time:330227ms step_avg:356.62ms
step:937/1750 train_loss:3.6434 train_time:330605ms step_avg:356.64ms
step:938/1750 train_loss:3.5679 train_time:330979ms step_avg:356.66ms
step:939/1750 train_loss:3.6918 train_time:331363ms step_avg:356.69ms
step:940/1750 train_loss:3.5030 train_time:331738ms step_avg:356.71ms
step:941/1750 train_loss:3.5669 train_time:332112ms step_avg:356.73ms
step:942/1750 train_loss:3.3881 train_time:332486ms step_avg:356.74ms
step:943/1750 train_loss:3.7300 train_time:332867ms step_avg:356.77ms
step:944/1750 train_loss:3.4324 train_time:333273ms step_avg:356.82ms
step:945/1750 train_loss:3.4423 train_time:333753ms step_avg:356.96ms
step:946/1750 train_loss:5.0839 train_time:334137ms step_avg:356.98ms
step:947/1750 train_loss:3.6232 train_time:334513ms step_avg:357.00ms
step:948/1750 train_loss:3.5099 train_time:334886ms step_avg:357.02ms
step:949/1750 train_loss:3.4064 train_time:335391ms step_avg:357.18ms
step:950/1750 train_loss:3.4606 train_time:335768ms step_avg:357.20ms
step:951/1750 train_loss:3.4283 train_time:336146ms step_avg:357.22ms
step:952/1750 train_loss:3.4967 train_time:336517ms step_avg:357.24ms
step:953/1750 train_loss:3.5898 train_time:336898ms step_avg:357.26ms
step:954/1750 train_loss:3.4628 train_time:337280ms step_avg:357.29ms
step:955/1750 train_loss:3.4999 train_time:337649ms step_avg:357.30ms
step:956/1750 train_loss:3.4646 train_time:338025ms step_avg:357.32ms
step:957/1750 train_loss:3.5215 train_time:338411ms step_avg:357.35ms
step:958/1750 train_loss:3.5294 train_time:338794ms step_avg:357.38ms
step:959/1750 train_loss:3.5326 train_time:339169ms step_avg:357.40ms
step:960/1750 train_loss:3.4258 train_time:339544ms step_avg:357.42ms
step:961/1750 train_loss:3.6691 train_time:339918ms step_avg:357.43ms
step:962/1750 train_loss:3.6285 train_time:340292ms step_avg:357.45ms
step:963/1750 train_loss:3.6472 train_time:340669ms step_avg:357.47ms
step:964/1750 train_loss:3.4489 train_time:341050ms step_avg:357.49ms
step:965/1750 train_loss:3.5053 train_time:341422ms step_avg:357.51ms
step:966/1750 train_loss:3.7396 train_time:341797ms step_avg:357.53ms
step:967/1750 train_loss:3.5526 train_time:342168ms step_avg:357.54ms
step:968/1750 train_loss:3.5418 train_time:342542ms step_avg:357.56ms
step:969/1750 train_loss:3.6086 train_time:342919ms step_avg:357.58ms
step:970/1750 train_loss:3.3968 train_time:343293ms step_avg:357.60ms
step:971/1750 train_loss:3.5573 train_time:343667ms step_avg:357.61ms
step:972/1750 train_loss:3.5077 train_time:344038ms step_avg:357.63ms
step:973/1750 train_loss:3.5688 train_time:344408ms step_avg:357.64ms
step:974/1750 train_loss:3.6197 train_time:344784ms step_avg:357.66ms
step:975/1750 train_loss:3.5068 train_time:345159ms step_avg:357.68ms
step:976/1750 train_loss:3.6971 train_time:345530ms step_avg:357.69ms
step:977/1750 train_loss:3.5987 train_time:345900ms step_avg:357.70ms
step:978/1750 train_loss:3.3864 train_time:346273ms step_avg:357.72ms
step:979/1750 train_loss:3.6592 train_time:346647ms step_avg:357.74ms
step:980/1750 train_loss:3.4404 train_time:347027ms step_avg:357.76ms
step:981/1750 train_loss:3.6024 train_time:347406ms step_avg:357.78ms
step:982/1750 train_loss:3.5811 train_time:347779ms step_avg:357.80ms
step:983/1750 train_loss:3.5431 train_time:348153ms step_avg:357.81ms
step:984/1750 train_loss:3.5226 train_time:348527ms step_avg:357.83ms
step:985/1750 train_loss:3.6112 train_time:348904ms step_avg:357.85ms
step:986/1750 train_loss:3.4452 train_time:349278ms step_avg:357.87ms
step:987/1750 train_loss:3.5157 train_time:349647ms step_avg:357.88ms
step:988/1750 train_loss:3.5167 train_time:350018ms step_avg:357.89ms
step:989/1750 train_loss:3.4445 train_time:350387ms step_avg:357.90ms
step:990/1750 train_loss:3.6788 train_time:350760ms step_avg:357.92ms
step:991/1750 train_loss:3.5043 train_time:351136ms step_avg:357.94ms
step:992/1750 train_loss:3.4736 train_time:351525ms step_avg:357.97ms
step:993/1750 train_loss:3.5379 train_time:351910ms step_avg:358.00ms
step:994/1750 train_loss:3.6263 train_time:352279ms step_avg:358.01ms
step:995/1750 train_loss:3.5636 train_time:352649ms step_avg:358.02ms
step:996/1750 train_loss:3.4881 train_time:353017ms step_avg:358.03ms
step:997/1750 train_loss:3.8054 train_time:353388ms step_avg:358.04ms
step:998/1750 train_loss:3.4765 train_time:353759ms step_avg:358.06ms
step:999/1750 train_loss:3.6186 train_time:354133ms step_avg:358.07ms
step:1000/1750 train_loss:3.4722 train_time:354511ms step_avg:358.09ms
step:1000/1750 val_loss:3.5026 train_time:354605ms step_avg:358.19ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 268.75009 | frobenius_norm = 61922.36719 | spectral_norm = 11056.98340 | nuclear_norm = 1554421.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 163.50885 | spectral_norm = 28.77374 | nuclear_norm = 3773.92554
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 158.03046 | spectral_norm = 31.67677 | nuclear_norm = 3621.77515
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 303.31128 | spectral_norm = 19.60756 | nuclear_norm = 7370.62354
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 225.98410 | spectral_norm = 22.20154 | nuclear_norm = 5230.78662
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 349.95670 | spectral_norm = 29.03679 | nuclear_norm = 9312.91406
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 178.53218 | spectral_norm = 16.11125 | nuclear_norm = 4722.92578
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 163.20992 | spectral_norm = 15.86381 | nuclear_norm = 3758.38940
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 160.35512 | spectral_norm = 16.32015 | nuclear_norm = 3699.51465
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 283.89532 | spectral_norm = 25.24857 | nuclear_norm = 6520.24023
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 286.89145 | spectral_norm = 22.36806 | nuclear_norm = 6708.02393
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 351.11615 | spectral_norm = 24.65817 | nuclear_norm = 9352.53906
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 173.87398 | spectral_norm = 17.98536 | nuclear_norm = 4576.07471
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 159.88005 | spectral_norm = 14.94039 | nuclear_norm = 3590.77271
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 159.01392 | spectral_norm = 14.36857 | nuclear_norm = 3589.60400
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 309.09872 | spectral_norm = 28.75961 | nuclear_norm = 7045.03467
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 309.64948 | spectral_norm = 24.45414 | nuclear_norm = 7289.63818
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 352.29401 | spectral_norm = 28.31153 | nuclear_norm = 9383.15820
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 177.56505 | spectral_norm = 17.90754 | nuclear_norm = 4676.99902
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 159.57906 | spectral_norm = 16.33958 | nuclear_norm = 3619.86523
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 158.14598 | spectral_norm = 15.64563 | nuclear_norm = 3592.54541
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 313.74768 | spectral_norm = 26.28741 | nuclear_norm = 7167.50732
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 317.52539 | spectral_norm = 24.48626 | nuclear_norm = 7432.67285
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 361.70355 | spectral_norm = 31.04407 | nuclear_norm = 9625.07422
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 175.52444 | spectral_norm = 16.74148 | nuclear_norm = 4612.23340
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 160.16653 | spectral_norm = 16.56570 | nuclear_norm = 3667.70508
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 159.04224 | spectral_norm = 15.69724 | nuclear_norm = 3670.38965
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 318.13007 | spectral_norm = 26.99842 | nuclear_norm = 7213.64355
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 319.92834 | spectral_norm = 25.50292 | nuclear_norm = 7434.62402
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 361.51508 | spectral_norm = 31.42616 | nuclear_norm = 9611.69238
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 175.67973 | spectral_norm = 17.16942 | nuclear_norm = 4597.53271
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 158.45714 | spectral_norm = 15.74131 | nuclear_norm = 3601.83887
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 157.06863 | spectral_norm = 15.00668 | nuclear_norm = 3568.42651
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 307.21405 | spectral_norm = 26.13761 | nuclear_norm = 6986.78906
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 311.17975 | spectral_norm = 23.77553 | nuclear_norm = 7241.19189
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 374.58194 | spectral_norm = 29.27510 | nuclear_norm = 9950.20508
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 177.51141 | spectral_norm = 17.63484 | nuclear_norm = 4661.59473
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 157.57109 | spectral_norm = 16.01509 | nuclear_norm = 3541.78027
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 155.72600 | spectral_norm = 14.47935 | nuclear_norm = 3515.21753
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 320.52045 | spectral_norm = 29.86757 | nuclear_norm = 7164.99414
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 310.53714 | spectral_norm = 23.94685 | nuclear_norm = 7268.99902
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 365.13364 | spectral_norm = 27.45632 | nuclear_norm = 9716.32422
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 180.20490 | spectral_norm = 18.57548 | nuclear_norm = 4753.04199
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 162.27713 | spectral_norm = 15.43717 | nuclear_norm = 3646.14697
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 162.34401 | spectral_norm = 14.77092 | nuclear_norm = 3631.52515
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 336.77249 | spectral_norm = 31.53115 | nuclear_norm = 7615.26074
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 331.64383 | spectral_norm = 23.76725 | nuclear_norm = 7824.65820
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 358.88770 | spectral_norm = 31.18431 | nuclear_norm = 9534.34473
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 182.81252 | spectral_norm = 18.45896 | nuclear_norm = 4832.84033
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 162.02226 | spectral_norm = 16.01035 | nuclear_norm = 3634.41431
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 161.62584 | spectral_norm = 15.80971 | nuclear_norm = 3621.80005
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 330.38553 | spectral_norm = 30.47976 | nuclear_norm = 7469.76855
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 323.57980 | spectral_norm = 23.95594 | nuclear_norm = 7575.88770
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 361.15717 | spectral_norm = 31.08653 | nuclear_norm = 9598.56836
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 185.09300 | spectral_norm = 18.86545 | nuclear_norm = 4905.16406
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 163.65045 | spectral_norm = 17.68414 | nuclear_norm = 3687.60693
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 163.52214 | spectral_norm = 16.17383 | nuclear_norm = 3663.21289
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 326.55637 | spectral_norm = 32.46088 | nuclear_norm = 7378.59082
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 324.14371 | spectral_norm = 23.49201 | nuclear_norm = 7593.78223
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 366.91373 | spectral_norm = 31.16541 | nuclear_norm = 9758.47266
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 186.27734 | spectral_norm = 19.48002 | nuclear_norm = 4944.32275
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 164.25189 | spectral_norm = 19.86450 | nuclear_norm = 3665.52710
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 159.47894 | spectral_norm = 19.41617 | nuclear_norm = 3531.67529
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 323.77158 | spectral_norm = 28.09407 | nuclear_norm = 7455.85742
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 334.48129 | spectral_norm = 22.94605 | nuclear_norm = 7910.25293
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 373.63794 | spectral_norm = 28.68480 | nuclear_norm = 9965.61328
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 177.37468 | spectral_norm = 21.48037 | nuclear_norm = 4688.42285
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 164.79898 | spectral_norm = 17.80139 | nuclear_norm = 3716.11450
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 165.32536 | spectral_norm = 17.37058 | nuclear_norm = 3719.72461
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 285.17120 | spectral_norm = 31.04053 | nuclear_norm = 6429.19141
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 314.13638 | spectral_norm = 24.15780 | nuclear_norm = 7296.90088
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 390.98795 | spectral_norm = 31.53625 | nuclear_norm = 10397.07812
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 183.34203 | spectral_norm = 22.20555 | nuclear_norm = 4823.41113
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1175.19067 | spectral_norm = 201.15744 | nuclear_norm = 30704.48047
===========================================
step:1001/1750 train_loss:3.5358 train_time:354872ms step_avg:358.09ms
step:1002/1750 train_loss:3.4086 train_time:355235ms step_avg:358.10ms
step:1003/1750 train_loss:3.5935 train_time:355612ms step_avg:358.12ms
step:1004/1750 train_loss:3.6457 train_time:355987ms step_avg:358.14ms
step:1005/1750 train_loss:3.4205 train_time:356357ms step_avg:358.15ms
step:1006/1750 train_loss:3.4994 train_time:356730ms step_avg:358.16ms
step:1007/1750 train_loss:3.4756 train_time:357102ms step_avg:358.18ms
step:1008/1750 train_loss:3.5964 train_time:357477ms step_avg:358.19ms
step:1009/1750 train_loss:3.7015 train_time:357857ms step_avg:358.22ms
step:1010/1750 train_loss:3.5957 train_time:358229ms step_avg:358.23ms
step:1011/1750 train_loss:3.5702 train_time:358600ms step_avg:358.24ms
step:1012/1750 train_loss:3.4243 train_time:358970ms step_avg:358.25ms
step:1013/1750 train_loss:3.5740 train_time:359345ms step_avg:358.27ms
step:1014/1750 train_loss:3.6605 train_time:359722ms step_avg:358.29ms
step:1015/1750 train_loss:3.3638 train_time:360100ms step_avg:358.31ms
step:1016/1750 train_loss:3.4462 train_time:360472ms step_avg:358.32ms
step:1017/1750 train_loss:3.4411 train_time:360847ms step_avg:358.34ms
step:1018/1750 train_loss:3.4238 train_time:361224ms step_avg:358.36ms
step:1019/1750 train_loss:3.5625 train_time:361598ms step_avg:358.37ms
step:1020/1750 train_loss:3.4259 train_time:361971ms step_avg:358.39ms
step:1021/1750 train_loss:3.3881 train_time:362339ms step_avg:358.40ms
step:1022/1750 train_loss:3.5215 train_time:362712ms step_avg:358.41ms
step:1023/1750 train_loss:3.5460 train_time:363086ms step_avg:358.43ms
step:1024/1750 train_loss:3.5162 train_time:363459ms step_avg:358.44ms
step:1025/1750 train_loss:3.5163 train_time:363832ms step_avg:358.46ms
step:1026/1750 train_loss:3.6639 train_time:364202ms step_avg:358.47ms
step:1027/1750 train_loss:3.3592 train_time:364573ms step_avg:358.48ms
step:1028/1750 train_loss:3.4316 train_time:364950ms step_avg:358.50ms
step:1029/1750 train_loss:3.3581 train_time:365328ms step_avg:358.52ms
step:1030/1750 train_loss:3.5772 train_time:365701ms step_avg:358.53ms
step:1031/1750 train_loss:3.5570 train_time:366076ms step_avg:358.55ms
step:1032/1750 train_loss:3.7404 train_time:366456ms step_avg:358.57ms
step:1033/1750 train_loss:3.5399 train_time:366825ms step_avg:358.58ms
step:1034/1750 train_loss:3.4452 train_time:367198ms step_avg:358.59ms
step:1035/1750 train_loss:3.4880 train_time:367570ms step_avg:358.60ms
step:1036/1750 train_loss:3.5311 train_time:367942ms step_avg:358.62ms
step:1037/1750 train_loss:3.8328 train_time:368314ms step_avg:358.63ms
step:1038/1750 train_loss:3.6632 train_time:368687ms step_avg:358.65ms
step:1039/1750 train_loss:3.5505 train_time:369069ms step_avg:358.67ms
step:1040/1750 train_loss:3.4562 train_time:369445ms step_avg:358.68ms
step:1041/1750 train_loss:3.5247 train_time:369822ms step_avg:358.70ms
step:1042/1750 train_loss:3.5715 train_time:370192ms step_avg:358.71ms
step:1043/1750 train_loss:3.4836 train_time:370565ms step_avg:358.73ms
step:1044/1750 train_loss:3.5004 train_time:370944ms step_avg:358.75ms
step:1045/1750 train_loss:3.5594 train_time:371321ms step_avg:358.76ms
step:1046/1750 train_loss:3.4684 train_time:371698ms step_avg:358.78ms
step:1047/1750 train_loss:3.6846 train_time:372076ms step_avg:358.80ms
step:1048/1750 train_loss:3.5457 train_time:372455ms step_avg:358.82ms
step:1049/1750 train_loss:3.4485 train_time:372836ms step_avg:358.84ms
step:1050/1750 train_loss:3.4349 train_time:373221ms step_avg:358.87ms
step:1051/1750 train_loss:3.5450 train_time:373604ms step_avg:358.89ms
step:1052/1750 train_loss:3.4028 train_time:373986ms step_avg:358.91ms
step:1053/1750 train_loss:3.7366 train_time:374366ms step_avg:358.93ms
step:1054/1750 train_loss:3.5887 train_time:374748ms step_avg:358.95ms
step:1055/1750 train_loss:3.4291 train_time:375122ms step_avg:358.97ms
step:1056/1750 train_loss:3.5447 train_time:375499ms step_avg:358.99ms
step:1057/1750 train_loss:3.6274 train_time:375880ms step_avg:359.01ms
step:1058/1750 train_loss:3.3549 train_time:376260ms step_avg:359.03ms
step:1059/1750 train_loss:3.4200 train_time:376645ms step_avg:359.05ms
step:1060/1750 train_loss:3.4865 train_time:377024ms step_avg:359.07ms
step:1061/1750 train_loss:3.4625 train_time:377399ms step_avg:359.09ms
step:1062/1750 train_loss:3.4326 train_time:377777ms step_avg:359.10ms
step:1063/1750 train_loss:3.5113 train_time:378152ms step_avg:359.12ms
step:1064/1750 train_loss:3.4310 train_time:378526ms step_avg:359.13ms
step:1065/1750 train_loss:3.4080 train_time:378908ms step_avg:359.15ms
step:1066/1750 train_loss:3.4589 train_time:379290ms step_avg:359.18ms
step:1067/1750 train_loss:3.3358 train_time:379670ms step_avg:359.20ms
step:1068/1750 train_loss:3.4846 train_time:380050ms step_avg:359.22ms
step:1069/1750 train_loss:3.3522 train_time:380435ms step_avg:359.24ms
step:1070/1750 train_loss:3.6200 train_time:380812ms step_avg:359.26ms
step:1071/1750 train_loss:3.5621 train_time:381194ms step_avg:359.28ms
step:1072/1750 train_loss:3.4890 train_time:381567ms step_avg:359.29ms
step:1073/1750 train_loss:3.5715 train_time:381940ms step_avg:359.30ms
step:1074/1750 train_loss:3.4911 train_time:382317ms step_avg:359.32ms
step:1075/1750 train_loss:3.4451 train_time:382694ms step_avg:359.34ms
step:1076/1750 train_loss:3.8458 train_time:383067ms step_avg:359.35ms
step:1077/1750 train_loss:3.4868 train_time:383443ms step_avg:359.37ms
step:1078/1750 train_loss:3.1562 train_time:383840ms step_avg:359.40ms
step:1079/1750 train_loss:3.5860 train_time:384225ms step_avg:359.42ms
step:1080/1750 train_loss:3.4800 train_time:384606ms step_avg:359.44ms
step:1081/1750 train_loss:3.5636 train_time:384979ms step_avg:359.46ms
step:1082/1750 train_loss:3.6470 train_time:385356ms step_avg:359.47ms
step:1083/1750 train_loss:3.5568 train_time:385730ms step_avg:359.49ms
step:1084/1750 train_loss:3.5275 train_time:386111ms step_avg:359.51ms
step:1085/1750 train_loss:3.4843 train_time:386489ms step_avg:359.52ms
step:1086/1750 train_loss:3.6862 train_time:386870ms step_avg:359.54ms
step:1087/1750 train_loss:3.5684 train_time:387249ms step_avg:359.56ms
step:1088/1750 train_loss:3.4199 train_time:387632ms step_avg:359.58ms
step:1089/1750 train_loss:3.4361 train_time:388024ms step_avg:359.61ms
step:1090/1750 train_loss:3.5392 train_time:388411ms step_avg:359.64ms
step:1091/1750 train_loss:3.3374 train_time:388792ms step_avg:359.66ms
step:1092/1750 train_loss:3.5485 train_time:389176ms step_avg:359.68ms
step:1093/1750 train_loss:3.6700 train_time:389556ms step_avg:359.70ms
step:1094/1750 train_loss:3.5023 train_time:389933ms step_avg:359.72ms
step:1095/1750 train_loss:3.4744 train_time:390311ms step_avg:359.73ms
step:1096/1750 train_loss:3.4846 train_time:390698ms step_avg:359.76ms
step:1097/1750 train_loss:3.5445 train_time:391081ms step_avg:359.78ms
step:1098/1750 train_loss:3.6163 train_time:391460ms step_avg:359.80ms
step:1099/1750 train_loss:3.5816 train_time:391840ms step_avg:359.82ms
step:1100/1750 train_loss:3.4896 train_time:392229ms step_avg:359.84ms
step:1101/1750 train_loss:3.3436 train_time:392610ms step_avg:359.86ms
step:1102/1750 train_loss:3.3779 train_time:392995ms step_avg:359.89ms
step:1103/1750 train_loss:3.5078 train_time:393382ms step_avg:359.91ms
step:1104/1750 train_loss:3.3746 train_time:393756ms step_avg:359.92ms
step:1105/1750 train_loss:4.1201 train_time:394135ms step_avg:359.94ms
step:1106/1750 train_loss:3.2873 train_time:394510ms step_avg:359.95ms
step:1107/1750 train_loss:3.6313 train_time:394886ms step_avg:359.97ms
step:1108/1750 train_loss:3.4008 train_time:395259ms step_avg:359.98ms
step:1109/1750 train_loss:3.5626 train_time:395636ms step_avg:360.00ms
step:1110/1750 train_loss:3.4913 train_time:396013ms step_avg:360.01ms
step:1111/1750 train_loss:3.5457 train_time:396391ms step_avg:360.03ms
step:1112/1750 train_loss:3.6245 train_time:396777ms step_avg:360.05ms
step:1113/1750 train_loss:3.5001 train_time:397168ms step_avg:360.08ms
step:1114/1750 train_loss:3.4200 train_time:397547ms step_avg:360.10ms
step:1115/1750 train_loss:3.3142 train_time:397925ms step_avg:360.11ms
step:1116/1750 train_loss:3.4858 train_time:398299ms step_avg:360.13ms
step:1117/1750 train_loss:3.6612 train_time:398682ms step_avg:360.15ms
step:1118/1750 train_loss:3.6895 train_time:399062ms step_avg:360.16ms
step:1119/1750 train_loss:3.5355 train_time:399438ms step_avg:360.18ms
step:1120/1750 train_loss:3.5528 train_time:399817ms step_avg:360.20ms
step:1121/1750 train_loss:3.4472 train_time:400197ms step_avg:360.21ms
step:1122/1750 train_loss:3.5169 train_time:400572ms step_avg:360.23ms
step:1123/1750 train_loss:3.6503 train_time:400949ms step_avg:360.24ms
step:1124/1750 train_loss:3.4080 train_time:401326ms step_avg:360.26ms
step:1125/1750 train_loss:3.2955 train_time:401704ms step_avg:360.27ms
step:1125/1750 val_loss:3.4734 train_time:401804ms step_avg:360.36ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 280.49551 | frobenius_norm = 64680.94922 | spectral_norm = 11498.26562 | nuclear_norm = 1626507.12500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 174.72002 | spectral_norm = 31.89864 | nuclear_norm = 4025.62256
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 169.26538 | spectral_norm = 35.06496 | nuclear_norm = 3872.29321
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 323.44992 | spectral_norm = 21.13501 | nuclear_norm = 7877.30127
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 235.35960 | spectral_norm = 23.77114 | nuclear_norm = 5435.23730
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 377.94675 | spectral_norm = 31.86516 | nuclear_norm = 10059.60156
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 191.52121 | spectral_norm = 17.57158 | nuclear_norm = 5064.43652
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 175.12070 | spectral_norm = 17.29967 | nuclear_norm = 4024.30151
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 172.08554 | spectral_norm = 17.48231 | nuclear_norm = 3966.08691
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 302.02701 | spectral_norm = 27.13232 | nuclear_norm = 6932.35400
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 305.57568 | spectral_norm = 23.85730 | nuclear_norm = 7144.87402
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 376.39175 | spectral_norm = 26.77776 | nuclear_norm = 10028.46289
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 185.79794 | spectral_norm = 19.44963 | nuclear_norm = 4887.58691
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 171.13913 | spectral_norm = 16.19826 | nuclear_norm = 3832.16577
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 170.37894 | spectral_norm = 15.41209 | nuclear_norm = 3834.47583
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 330.63080 | spectral_norm = 30.82416 | nuclear_norm = 7533.92676
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 330.82224 | spectral_norm = 26.38391 | nuclear_norm = 7789.95850
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 377.00220 | spectral_norm = 31.15716 | nuclear_norm = 10041.79688
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 190.14421 | spectral_norm = 19.49127 | nuclear_norm = 5007.25781
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 170.85361 | spectral_norm = 17.64291 | nuclear_norm = 3865.58643
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 169.31807 | spectral_norm = 16.90166 | nuclear_norm = 3837.15894
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 336.53589 | spectral_norm = 28.34431 | nuclear_norm = 7688.75488
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 339.96359 | spectral_norm = 26.52667 | nuclear_norm = 7955.33594
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 386.77670 | spectral_norm = 34.17342 | nuclear_norm = 10291.83203
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 187.77867 | spectral_norm = 18.11320 | nuclear_norm = 4933.68506
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 171.77586 | spectral_norm = 17.94478 | nuclear_norm = 3925.85693
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 170.45464 | spectral_norm = 16.99308 | nuclear_norm = 3927.54004
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 341.87854 | spectral_norm = 28.92908 | nuclear_norm = 7759.07715
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 342.96603 | spectral_norm = 27.44263 | nuclear_norm = 7971.81592
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 386.34302 | spectral_norm = 34.25042 | nuclear_norm = 10272.53906
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 187.83051 | spectral_norm = 18.70614 | nuclear_norm = 4914.03320
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 169.72040 | spectral_norm = 17.18378 | nuclear_norm = 3847.02686
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 168.18813 | spectral_norm = 16.23862 | nuclear_norm = 3814.00342
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 329.71216 | spectral_norm = 28.12403 | nuclear_norm = 7501.33691
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 333.07657 | spectral_norm = 25.37380 | nuclear_norm = 7749.02100
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 401.27478 | spectral_norm = 32.02325 | nuclear_norm = 10657.16211
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 189.82959 | spectral_norm = 19.28666 | nuclear_norm = 4982.96094
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 168.56303 | spectral_norm = 17.27869 | nuclear_norm = 3780.11499
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 166.74580 | spectral_norm = 15.79878 | nuclear_norm = 3756.83643
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 342.35007 | spectral_norm = 32.08209 | nuclear_norm = 7648.39453
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 331.00131 | spectral_norm = 25.37449 | nuclear_norm = 7740.02246
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 392.66464 | spectral_norm = 30.11968 | nuclear_norm = 10446.72656
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 193.12315 | spectral_norm = 20.43762 | nuclear_norm = 5090.76758
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 173.78400 | spectral_norm = 16.71591 | nuclear_norm = 3893.13477
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 174.00142 | spectral_norm = 15.84063 | nuclear_norm = 3884.24561
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 359.67053 | spectral_norm = 34.30624 | nuclear_norm = 8116.87695
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 354.58569 | spectral_norm = 25.42549 | nuclear_norm = 8363.28125
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 385.22440 | spectral_norm = 34.16473 | nuclear_norm = 10230.90820
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 195.97456 | spectral_norm = 20.20992 | nuclear_norm = 5179.24805
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 173.46321 | spectral_norm = 17.41467 | nuclear_norm = 3877.89844
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 173.29095 | spectral_norm = 17.12260 | nuclear_norm = 3867.70557
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 353.20038 | spectral_norm = 33.03725 | nuclear_norm = 7966.60547
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 345.88852 | spectral_norm = 25.69307 | nuclear_norm = 8093.85352
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 387.68335 | spectral_norm = 33.69872 | nuclear_norm = 10301.44531
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 198.57401 | spectral_norm = 20.56544 | nuclear_norm = 5262.58447
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 175.54123 | spectral_norm = 19.27062 | nuclear_norm = 3942.19165
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 175.34848 | spectral_norm = 17.56434 | nuclear_norm = 3917.12451
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 349.16272 | spectral_norm = 35.00541 | nuclear_norm = 7874.70752
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 346.36908 | spectral_norm = 25.21741 | nuclear_norm = 8111.16699
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 394.10284 | spectral_norm = 33.93807 | nuclear_norm = 10478.45996
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 200.15172 | spectral_norm = 21.36872 | nuclear_norm = 5313.35449
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 175.90717 | spectral_norm = 21.63514 | nuclear_norm = 3907.26465
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 170.89201 | spectral_norm = 21.29584 | nuclear_norm = 3770.44678
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 346.59222 | spectral_norm = 30.63198 | nuclear_norm = 7971.70752
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 357.34912 | spectral_norm = 24.76779 | nuclear_norm = 8444.90625
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 401.30374 | spectral_norm = 31.18466 | nuclear_norm = 10704.97656
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 189.81696 | spectral_norm = 23.51751 | nuclear_norm = 5017.04102
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 176.40875 | spectral_norm = 19.36265 | nuclear_norm = 3961.93530
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 177.02534 | spectral_norm = 18.99439 | nuclear_norm = 3972.69141
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 306.53510 | spectral_norm = 34.01048 | nuclear_norm = 6901.27441
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 338.19479 | spectral_norm = 26.33461 | nuclear_norm = 7855.77344
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 419.73135 | spectral_norm = 33.99144 | nuclear_norm = 11160.51367
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 196.49098 | spectral_norm = 24.41240 | nuclear_norm = 5166.08887
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1245.68457 | spectral_norm = 200.80540 | nuclear_norm = 32660.55859
===========================================
step:1126/1750 train_loss:3.5394 train_time:402070ms step_avg:360.28ms
step:1127/1750 train_loss:3.7435 train_time:402437ms step_avg:360.28ms
step:1128/1750 train_loss:3.2976 train_time:402813ms step_avg:360.30ms
step:1129/1750 train_loss:3.6260 train_time:403191ms step_avg:360.31ms
step:1130/1750 train_loss:3.4462 train_time:403569ms step_avg:360.33ms
step:1131/1750 train_loss:3.4562 train_time:403954ms step_avg:360.35ms
step:1132/1750 train_loss:3.4298 train_time:404322ms step_avg:360.36ms
step:1133/1750 train_loss:3.5607 train_time:404757ms step_avg:360.42ms
step:1134/1750 train_loss:3.5152 train_time:405207ms step_avg:360.50ms
step:1135/1750 train_loss:3.5816 train_time:405582ms step_avg:360.52ms
step:1136/1750 train_loss:3.6227 train_time:405957ms step_avg:360.53ms
step:1137/1750 train_loss:3.5253 train_time:406331ms step_avg:360.54ms
step:1138/1750 train_loss:3.4182 train_time:406708ms step_avg:360.56ms
step:1139/1750 train_loss:3.7196 train_time:407212ms step_avg:360.68ms
step:1140/1750 train_loss:3.5268 train_time:407605ms step_avg:360.71ms
step:1141/1750 train_loss:3.6579 train_time:407988ms step_avg:360.73ms
step:1142/1750 train_loss:3.5192 train_time:408368ms step_avg:360.75ms
step:1143/1750 train_loss:3.4293 train_time:408752ms step_avg:360.77ms
step:1144/1750 train_loss:3.5140 train_time:409127ms step_avg:360.78ms
step:1145/1750 train_loss:3.6614 train_time:409501ms step_avg:360.79ms
step:1146/1750 train_loss:3.6142 train_time:409883ms step_avg:360.81ms
step:1147/1750 train_loss:3.5636 train_time:410259ms step_avg:360.83ms
step:1148/1750 train_loss:3.5640 train_time:410632ms step_avg:360.84ms
step:1149/1750 train_loss:3.3980 train_time:411010ms step_avg:360.85ms
step:1150/1750 train_loss:3.4313 train_time:411381ms step_avg:360.86ms
step:1151/1750 train_loss:3.3851 train_time:411759ms step_avg:360.88ms
step:1152/1750 train_loss:3.4660 train_time:412140ms step_avg:360.89ms
step:1153/1750 train_loss:3.4951 train_time:412519ms step_avg:360.91ms
step:1154/1750 train_loss:3.5831 train_time:412891ms step_avg:360.92ms
step:1155/1750 train_loss:3.3938 train_time:413272ms step_avg:360.94ms
step:1156/1750 train_loss:3.6046 train_time:413659ms step_avg:360.96ms
step:1157/1750 train_loss:3.5642 train_time:414037ms step_avg:360.97ms
step:1158/1750 train_loss:3.3260 train_time:414412ms step_avg:360.99ms
step:1159/1750 train_loss:3.4051 train_time:414788ms step_avg:361.00ms
step:1160/1750 train_loss:3.3989 train_time:415156ms step_avg:361.01ms
step:1161/1750 train_loss:3.1469 train_time:415535ms step_avg:361.02ms
step:1162/1750 train_loss:3.4882 train_time:415912ms step_avg:361.03ms
step:1163/1750 train_loss:3.4494 train_time:416287ms step_avg:361.05ms
step:1164/1750 train_loss:3.3491 train_time:416662ms step_avg:361.06ms
step:1165/1750 train_loss:3.3166 train_time:417034ms step_avg:361.07ms
step:1166/1750 train_loss:3.4524 train_time:417410ms step_avg:361.08ms
step:1167/1750 train_loss:3.4628 train_time:417783ms step_avg:361.09ms
step:1168/1750 train_loss:3.7909 train_time:418160ms step_avg:361.11ms
step:1169/1750 train_loss:3.4439 train_time:418541ms step_avg:361.12ms
step:1170/1750 train_loss:3.4504 train_time:418922ms step_avg:361.14ms
step:1171/1750 train_loss:3.4087 train_time:419303ms step_avg:361.16ms
step:1172/1750 train_loss:3.4863 train_time:419681ms step_avg:361.17ms
step:1173/1750 train_loss:3.6047 train_time:420071ms step_avg:361.20ms
step:1174/1750 train_loss:3.4426 train_time:420469ms step_avg:361.23ms
step:1175/1750 train_loss:3.4380 train_time:420855ms step_avg:361.25ms
step:1176/1750 train_loss:3.4907 train_time:421249ms step_avg:361.28ms
step:1177/1750 train_loss:3.5134 train_time:421641ms step_avg:361.30ms
step:1178/1750 train_loss:3.5670 train_time:422020ms step_avg:361.32ms
step:1179/1750 train_loss:3.4712 train_time:422403ms step_avg:361.34ms
step:1180/1750 train_loss:3.4144 train_time:422805ms step_avg:361.37ms
step:1181/1750 train_loss:3.4011 train_time:423188ms step_avg:361.39ms
step:1182/1750 train_loss:3.4601 train_time:423568ms step_avg:361.41ms
step:1183/1750 train_loss:3.3996 train_time:423950ms step_avg:361.42ms
step:1184/1750 train_loss:3.5751 train_time:424333ms step_avg:361.44ms
step:1185/1750 train_loss:3.6130 train_time:424723ms step_avg:361.47ms
step:1186/1750 train_loss:3.4263 train_time:425109ms step_avg:361.49ms
step:1187/1750 train_loss:3.4776 train_time:425508ms step_avg:361.52ms
step:1188/1750 train_loss:3.5046 train_time:425887ms step_avg:361.53ms
step:1189/1750 train_loss:3.3351 train_time:426273ms step_avg:361.56ms
step:1190/1750 train_loss:3.5064 train_time:426660ms step_avg:361.58ms
step:1191/1750 train_loss:3.6405 train_time:427048ms step_avg:361.60ms
step:1192/1750 train_loss:3.4602 train_time:427429ms step_avg:361.62ms
step:1193/1750 train_loss:3.3400 train_time:427810ms step_avg:361.63ms
step:1194/1750 train_loss:3.6219 train_time:428191ms step_avg:361.65ms
step:1195/1750 train_loss:3.4428 train_time:428584ms step_avg:361.67ms
step:1196/1750 train_loss:3.4490 train_time:428990ms step_avg:361.71ms
step:1197/1750 train_loss:3.3534 train_time:429379ms step_avg:361.73ms
step:1198/1750 train_loss:3.3714 train_time:429776ms step_avg:361.76ms
step:1199/1750 train_loss:3.4062 train_time:430161ms step_avg:361.78ms
step:1200/1750 train_loss:3.5082 train_time:430546ms step_avg:361.80ms
step:1201/1750 train_loss:3.5451 train_time:430926ms step_avg:361.82ms
step:1202/1750 train_loss:3.7443 train_time:431334ms step_avg:361.86ms
step:1203/1750 train_loss:3.4786 train_time:431724ms step_avg:361.88ms
step:1204/1750 train_loss:3.3731 train_time:432110ms step_avg:361.90ms
step:1205/1750 train_loss:3.4951 train_time:432492ms step_avg:361.92ms
step:1206/1750 train_loss:3.5361 train_time:432871ms step_avg:361.93ms
step:1207/1750 train_loss:3.5844 train_time:433250ms step_avg:361.95ms
step:1208/1750 train_loss:3.4670 train_time:433626ms step_avg:361.96ms
step:1209/1750 train_loss:3.3039 train_time:434013ms step_avg:361.98ms
step:1210/1750 train_loss:3.3690 train_time:434402ms step_avg:362.00ms
step:1211/1750 train_loss:3.4653 train_time:434781ms step_avg:362.02ms
step:1212/1750 train_loss:3.4553 train_time:435160ms step_avg:362.03ms
step:1213/1750 train_loss:3.4840 train_time:435544ms step_avg:362.05ms
step:1214/1750 train_loss:3.3362 train_time:435934ms step_avg:362.07ms
step:1215/1750 train_loss:3.4556 train_time:436314ms step_avg:362.09ms
step:1216/1750 train_loss:3.3948 train_time:436696ms step_avg:362.10ms
step:1217/1750 train_loss:3.3901 train_time:437080ms step_avg:362.12ms
step:1218/1750 train_loss:3.4775 train_time:437465ms step_avg:362.14ms
step:1219/1750 train_loss:3.3382 train_time:437859ms step_avg:362.17ms
step:1220/1750 train_loss:3.5374 train_time:438239ms step_avg:362.18ms
step:1221/1750 train_loss:3.5705 train_time:438618ms step_avg:362.19ms
step:1222/1750 train_loss:3.5047 train_time:438997ms step_avg:362.21ms
step:1223/1750 train_loss:3.3578 train_time:439380ms step_avg:362.23ms
step:1224/1750 train_loss:3.3235 train_time:439769ms step_avg:362.25ms
step:1225/1750 train_loss:3.4403 train_time:440153ms step_avg:362.27ms
step:1226/1750 train_loss:3.3944 train_time:440540ms step_avg:362.29ms
step:1227/1750 train_loss:3.3326 train_time:440927ms step_avg:362.31ms
step:1228/1750 train_loss:3.5174 train_time:441305ms step_avg:362.32ms
step:1229/1750 train_loss:3.4325 train_time:441689ms step_avg:362.34ms
step:1230/1750 train_loss:3.4646 train_time:442083ms step_avg:362.36ms
step:1231/1750 train_loss:3.6474 train_time:442473ms step_avg:362.39ms
step:1232/1750 train_loss:3.5575 train_time:442859ms step_avg:362.41ms
step:1233/1750 train_loss:3.4893 train_time:443236ms step_avg:362.42ms
step:1234/1750 train_loss:3.6552 train_time:443615ms step_avg:362.43ms
step:1235/1750 train_loss:3.3892 train_time:444001ms step_avg:362.45ms
step:1236/1750 train_loss:3.3576 train_time:444379ms step_avg:362.46ms
step:1237/1750 train_loss:3.3373 train_time:444758ms step_avg:362.48ms
step:1238/1750 train_loss:3.3557 train_time:445152ms step_avg:362.50ms
step:1239/1750 train_loss:3.3930 train_time:445532ms step_avg:362.52ms
step:1240/1750 train_loss:3.4473 train_time:445918ms step_avg:362.54ms
step:1241/1750 train_loss:3.4938 train_time:446303ms step_avg:362.55ms
step:1242/1750 train_loss:3.3622 train_time:446679ms step_avg:362.56ms
step:1243/1750 train_loss:3.4749 train_time:447061ms step_avg:362.58ms
step:1244/1750 train_loss:3.4747 train_time:447436ms step_avg:362.59ms
step:1245/1750 train_loss:3.4844 train_time:447814ms step_avg:362.60ms
step:1246/1750 train_loss:3.3045 train_time:448197ms step_avg:362.62ms
step:1247/1750 train_loss:3.4448 train_time:448576ms step_avg:362.63ms
step:1248/1750 train_loss:3.5029 train_time:448951ms step_avg:362.64ms
step:1249/1750 train_loss:3.4878 train_time:449327ms step_avg:362.65ms
step:1250/1750 train_loss:3.3662 train_time:449705ms step_avg:362.67ms
step:1250/1750 val_loss:3.4219 train_time:449809ms step_avg:362.75ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 288.94351 | frobenius_norm = 66670.69531 | spectral_norm = 11834.54297 | nuclear_norm = 1678828.87500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 182.88412 | spectral_norm = 34.67087 | nuclear_norm = 4204.27100
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 177.66895 | spectral_norm = 37.82088 | nuclear_norm = 4057.79712
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 338.84918 | spectral_norm = 22.30331 | nuclear_norm = 8268.69922
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 241.47630 | spectral_norm = 24.92678 | nuclear_norm = 5562.20020
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 399.10297 | spectral_norm = 34.17022 | nuclear_norm = 10621.30664
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 201.53250 | spectral_norm = 18.70531 | nuclear_norm = 5327.96094
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 184.29694 | spectral_norm = 18.56544 | nuclear_norm = 4227.87256
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 181.37486 | spectral_norm = 18.39574 | nuclear_norm = 4175.38574
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 316.20999 | spectral_norm = 28.61073 | nuclear_norm = 7255.96777
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 319.94510 | spectral_norm = 25.25491 | nuclear_norm = 7484.52002
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 395.72162 | spectral_norm = 28.42325 | nuclear_norm = 10543.56250
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 195.00833 | spectral_norm = 20.69662 | nuclear_norm = 5128.06885
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 179.71150 | spectral_norm = 17.33516 | nuclear_norm = 4012.57666
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 178.85443 | spectral_norm = 16.35407 | nuclear_norm = 4015.30762
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 347.54422 | spectral_norm = 32.50493 | nuclear_norm = 7916.59424
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 347.29758 | spectral_norm = 27.69856 | nuclear_norm = 8180.04688
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 395.64172 | spectral_norm = 33.55294 | nuclear_norm = 10536.22656
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 199.84200 | spectral_norm = 20.68157 | nuclear_norm = 5261.77930
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 179.34268 | spectral_norm = 18.86702 | nuclear_norm = 4048.55518
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 177.78612 | spectral_norm = 17.90623 | nuclear_norm = 4019.95557
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 354.76251 | spectral_norm = 29.90581 | nuclear_norm = 8109.66309
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 357.77808 | spectral_norm = 28.11709 | nuclear_norm = 8375.36914
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 405.79065 | spectral_norm = 36.74968 | nuclear_norm = 10796.88477
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 197.28697 | spectral_norm = 19.26454 | nuclear_norm = 5183.36865
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 180.63734 | spectral_norm = 19.18666 | nuclear_norm = 4121.44824
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 178.95142 | spectral_norm = 18.01264 | nuclear_norm = 4120.49512
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 361.00104 | spectral_norm = 30.63070 | nuclear_norm = 8199.78125
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 361.44858 | spectral_norm = 28.89089 | nuclear_norm = 8404.79492
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 404.97128 | spectral_norm = 36.60663 | nuclear_norm = 10766.85547
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 197.18420 | spectral_norm = 19.98702 | nuclear_norm = 5158.26953
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 178.29358 | spectral_norm = 18.42443 | nuclear_norm = 4030.43604
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 176.60457 | spectral_norm = 17.17897 | nuclear_norm = 3996.74365
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 347.72162 | spectral_norm = 29.63910 | nuclear_norm = 7916.45410
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 350.36078 | spectral_norm = 26.65113 | nuclear_norm = 8150.24707
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 421.47787 | spectral_norm = 34.26798 | nuclear_norm = 11190.11133
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 199.38229 | spectral_norm = 20.68355 | nuclear_norm = 5231.96143
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 176.90083 | spectral_norm = 18.45877 | nuclear_norm = 3956.78418
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 175.02281 | spectral_norm = 16.80056 | nuclear_norm = 3933.65576
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 359.86133 | spectral_norm = 33.85786 | nuclear_norm = 8040.41016
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 346.85632 | spectral_norm = 26.60362 | nuclear_norm = 8106.69141
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 413.64209 | spectral_norm = 32.26174 | nuclear_norm = 11000.75488
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 203.02579 | spectral_norm = 21.93758 | nuclear_norm = 5348.98584
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 182.45280 | spectral_norm = 17.59648 | nuclear_norm = 4076.50342
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 182.81027 | spectral_norm = 16.73826 | nuclear_norm = 4069.83398
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 377.85724 | spectral_norm = 36.49060 | nuclear_norm = 8517.73438
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 372.28113 | spectral_norm = 26.80833 | nuclear_norm = 8777.20312
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 405.07379 | spectral_norm = 36.57019 | nuclear_norm = 10752.59668
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 205.99327 | spectral_norm = 21.58214 | nuclear_norm = 5442.03906
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 182.04404 | spectral_norm = 18.49883 | nuclear_norm = 4054.11621
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 182.07097 | spectral_norm = 18.01216 | nuclear_norm = 4049.24365
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 371.57495 | spectral_norm = 35.21443 | nuclear_norm = 8370.83203
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 363.25864 | spectral_norm = 26.93620 | nuclear_norm = 8492.13965
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 407.85944 | spectral_norm = 35.87778 | nuclear_norm = 10833.79785
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 208.85986 | spectral_norm = 21.97211 | nuclear_norm = 5534.48633
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 184.48018 | spectral_norm = 20.45518 | nuclear_norm = 4129.37598
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 184.28116 | spectral_norm = 18.57811 | nuclear_norm = 4103.87012
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 367.80533 | spectral_norm = 37.06221 | nuclear_norm = 8287.97656
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 363.57077 | spectral_norm = 26.73427 | nuclear_norm = 8513.95703
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 414.66571 | spectral_norm = 36.24877 | nuclear_norm = 11020.53516
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 210.78987 | spectral_norm = 22.81203 | nuclear_norm = 5595.86133
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 184.71149 | spectral_norm = 23.24080 | nuclear_norm = 4084.99512
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 179.34824 | spectral_norm = 22.79678 | nuclear_norm = 3938.22339
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 365.63507 | spectral_norm = 32.89439 | nuclear_norm = 8404.19336
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 375.21368 | spectral_norm = 26.10958 | nuclear_norm = 8863.62500
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 422.02243 | spectral_norm = 33.12970 | nuclear_norm = 11256.08594
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 199.52519 | spectral_norm = 25.17641 | nuclear_norm = 5272.90527
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 185.26672 | spectral_norm = 20.71432 | nuclear_norm = 4149.46582
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 185.97852 | spectral_norm = 20.27327 | nuclear_norm = 4162.27051
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 324.98563 | spectral_norm = 36.50778 | nuclear_norm = 7306.92139
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 357.88968 | spectral_norm = 28.08988 | nuclear_norm = 8315.18066
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 440.90894 | spectral_norm = 35.93253 | nuclear_norm = 11720.00977
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 206.38919 | spectral_norm = 26.06852 | nuclear_norm = 5423.71387
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1295.54333 | spectral_norm = 199.22063 | nuclear_norm = 34060.60938
===========================================
step:1251/1750 train_loss:3.5638 train_time:450091ms step_avg:362.68ms
step:1252/1750 train_loss:3.4356 train_time:450464ms step_avg:362.69ms
step:1253/1750 train_loss:3.3785 train_time:450837ms step_avg:362.70ms
step:1254/1750 train_loss:3.4835 train_time:451217ms step_avg:362.71ms
step:1255/1750 train_loss:3.5863 train_time:451612ms step_avg:362.74ms
step:1256/1750 train_loss:3.3785 train_time:451995ms step_avg:362.76ms
step:1257/1750 train_loss:3.4350 train_time:452373ms step_avg:362.77ms
step:1258/1750 train_loss:3.4233 train_time:452760ms step_avg:362.79ms
step:1259/1750 train_loss:3.4006 train_time:453137ms step_avg:362.80ms
step:1260/1750 train_loss:3.2738 train_time:453510ms step_avg:362.81ms
step:1261/1750 train_loss:3.3632 train_time:453891ms step_avg:362.82ms
step:1262/1750 train_loss:3.3902 train_time:454281ms step_avg:362.84ms
step:1263/1750 train_loss:3.2955 train_time:454665ms step_avg:362.86ms
step:1264/1750 train_loss:3.5089 train_time:455038ms step_avg:362.87ms
step:1265/1750 train_loss:3.4956 train_time:455414ms step_avg:362.88ms
step:1266/1750 train_loss:3.5061 train_time:455791ms step_avg:362.89ms
step:1267/1750 train_loss:3.4339 train_time:456167ms step_avg:362.90ms
step:1268/1750 train_loss:3.4698 train_time:456545ms step_avg:362.91ms
step:1269/1750 train_loss:3.3228 train_time:456931ms step_avg:362.93ms
step:1270/1750 train_loss:3.1624 train_time:457308ms step_avg:362.94ms
step:1271/1750 train_loss:3.4630 train_time:457688ms step_avg:362.96ms
step:1272/1750 train_loss:3.4205 train_time:458066ms step_avg:362.97ms
step:1273/1750 train_loss:3.4548 train_time:458451ms step_avg:362.99ms
step:1274/1750 train_loss:3.4222 train_time:458835ms step_avg:363.00ms
step:1275/1750 train_loss:3.5032 train_time:459209ms step_avg:363.01ms
step:1276/1750 train_loss:3.5408 train_time:459580ms step_avg:363.02ms
step:1277/1750 train_loss:3.4752 train_time:459959ms step_avg:363.03ms
step:1278/1750 train_loss:3.4684 train_time:460331ms step_avg:363.04ms
step:1279/1750 train_loss:3.3237 train_time:460712ms step_avg:363.05ms
step:1280/1750 train_loss:3.4343 train_time:461102ms step_avg:363.07ms
step:1281/1750 train_loss:3.4860 train_time:461480ms step_avg:363.08ms
step:1282/1750 train_loss:3.5365 train_time:461852ms step_avg:363.09ms
step:1283/1750 train_loss:3.4012 train_time:462234ms step_avg:363.11ms
step:1284/1750 train_loss:3.4344 train_time:462615ms step_avg:363.12ms
step:1285/1750 train_loss:3.4236 train_time:462993ms step_avg:363.13ms
step:1286/1750 train_loss:3.4027 train_time:463373ms step_avg:363.14ms
step:1287/1750 train_loss:3.5542 train_time:463751ms step_avg:363.16ms
step:1288/1750 train_loss:3.3644 train_time:464134ms step_avg:363.17ms
step:1289/1750 train_loss:3.4481 train_time:464525ms step_avg:363.19ms
step:1290/1750 train_loss:3.5260 train_time:464918ms step_avg:363.22ms
step:1291/1750 train_loss:3.4508 train_time:465301ms step_avg:363.23ms
step:1292/1750 train_loss:3.5434 train_time:465685ms step_avg:363.25ms
step:1293/1750 train_loss:3.5836 train_time:466067ms step_avg:363.26ms
step:1294/1750 train_loss:3.5259 train_time:466449ms step_avg:363.28ms
step:1295/1750 train_loss:3.3510 train_time:466828ms step_avg:363.29ms
step:1296/1750 train_loss:3.4407 train_time:467210ms step_avg:363.30ms
step:1297/1750 train_loss:3.3433 train_time:467590ms step_avg:363.32ms
step:1298/1750 train_loss:3.3385 train_time:467974ms step_avg:363.33ms
step:1299/1750 train_loss:3.4552 train_time:468355ms step_avg:363.35ms
step:1300/1750 train_loss:3.4761 train_time:468739ms step_avg:363.36ms
step:1301/1750 train_loss:3.4711 train_time:469118ms step_avg:363.38ms
step:1302/1750 train_loss:3.6380 train_time:469510ms step_avg:363.40ms
step:1303/1750 train_loss:3.3694 train_time:469903ms step_avg:363.42ms
step:1304/1750 train_loss:3.5774 train_time:470291ms step_avg:363.44ms
step:1305/1750 train_loss:3.3339 train_time:470673ms step_avg:363.45ms
step:1306/1750 train_loss:3.5086 train_time:471064ms step_avg:363.48ms
step:1307/1750 train_loss:3.5224 train_time:471440ms step_avg:363.48ms
step:1308/1750 train_loss:3.3615 train_time:471821ms step_avg:363.50ms
step:1309/1750 train_loss:3.3681 train_time:472211ms step_avg:363.52ms
step:1310/1750 train_loss:3.3626 train_time:472595ms step_avg:363.53ms
step:1311/1750 train_loss:3.3652 train_time:472978ms step_avg:363.55ms
step:1312/1750 train_loss:3.4513 train_time:473367ms step_avg:363.57ms
step:1313/1750 train_loss:3.4088 train_time:473749ms step_avg:363.58ms
step:1314/1750 train_loss:3.1026 train_time:474140ms step_avg:363.60ms
step:1315/1750 train_loss:3.3403 train_time:474522ms step_avg:363.62ms
step:1316/1750 train_loss:3.4596 train_time:474897ms step_avg:363.63ms
step:1317/1750 train_loss:3.4856 train_time:475276ms step_avg:363.64ms
step:1318/1750 train_loss:3.3623 train_time:475673ms step_avg:363.66ms
step:1319/1750 train_loss:3.4941 train_time:476064ms step_avg:363.69ms
step:1320/1750 train_loss:3.5200 train_time:476458ms step_avg:363.71ms
step:1321/1750 train_loss:3.4286 train_time:476846ms step_avg:363.73ms
step:1322/1750 train_loss:3.3859 train_time:477255ms step_avg:363.76ms
step:1323/1750 train_loss:3.3920 train_time:477744ms step_avg:363.86ms
step:1324/1750 train_loss:3.5009 train_time:478133ms step_avg:363.88ms
step:1325/1750 train_loss:3.5595 train_time:478532ms step_avg:363.90ms
step:1326/1750 train_loss:3.2870 train_time:478921ms step_avg:363.92ms
step:1327/1750 train_loss:3.2260 train_time:479301ms step_avg:363.93ms
step:1328/1750 train_loss:3.5539 train_time:479694ms step_avg:363.96ms
step:1329/1750 train_loss:3.3558 train_time:480227ms step_avg:364.08ms
step:1330/1750 train_loss:3.4881 train_time:480621ms step_avg:364.11ms
step:1331/1750 train_loss:3.4019 train_time:480998ms step_avg:364.12ms
step:1332/1750 train_loss:3.8059 train_time:481387ms step_avg:364.14ms
step:1333/1750 train_loss:3.5359 train_time:481777ms step_avg:364.15ms
step:1334/1750 train_loss:3.4363 train_time:482160ms step_avg:364.17ms
step:1335/1750 train_loss:3.3611 train_time:482543ms step_avg:364.18ms
step:1336/1750 train_loss:3.3576 train_time:482938ms step_avg:364.21ms
step:1337/1750 train_loss:3.6165 train_time:483327ms step_avg:364.22ms
step:1338/1750 train_loss:3.5869 train_time:483715ms step_avg:364.24ms
step:1339/1750 train_loss:3.4077 train_time:484107ms step_avg:364.26ms
step:1340/1750 train_loss:3.3530 train_time:484495ms step_avg:364.28ms
step:1341/1750 train_loss:3.6611 train_time:484879ms step_avg:364.30ms
step:1342/1750 train_loss:3.4185 train_time:485266ms step_avg:364.31ms
step:1343/1750 train_loss:3.4255 train_time:485644ms step_avg:364.32ms
step:1344/1750 train_loss:3.4826 train_time:486034ms step_avg:364.34ms
step:1345/1750 train_loss:3.4498 train_time:486429ms step_avg:364.37ms
step:1346/1750 train_loss:3.3650 train_time:486812ms step_avg:364.38ms
step:1347/1750 train_loss:3.3358 train_time:487195ms step_avg:364.39ms
step:1348/1750 train_loss:3.4106 train_time:487580ms step_avg:364.41ms
step:1349/1750 train_loss:3.3385 train_time:487965ms step_avg:364.43ms
step:1350/1750 train_loss:3.4557 train_time:488356ms step_avg:364.44ms
step:1351/1750 train_loss:3.3081 train_time:488735ms step_avg:364.46ms
step:1352/1750 train_loss:3.3672 train_time:489118ms step_avg:364.47ms
step:1353/1750 train_loss:3.4766 train_time:489511ms step_avg:364.49ms
step:1354/1750 train_loss:3.3172 train_time:489896ms step_avg:364.51ms
step:1355/1750 train_loss:3.2515 train_time:490280ms step_avg:364.52ms
step:1356/1750 train_loss:3.5800 train_time:490668ms step_avg:364.54ms
step:1357/1750 train_loss:3.4921 train_time:491059ms step_avg:364.56ms
step:1358/1750 train_loss:3.2435 train_time:491446ms step_avg:364.57ms
step:1359/1750 train_loss:3.5028 train_time:491834ms step_avg:364.59ms
step:1360/1750 train_loss:3.4158 train_time:492222ms step_avg:364.61ms
step:1361/1750 train_loss:3.2018 train_time:492613ms step_avg:364.63ms
step:1362/1750 train_loss:3.4568 train_time:493001ms step_avg:364.65ms
step:1363/1750 train_loss:3.3361 train_time:493393ms step_avg:364.67ms
step:1364/1750 train_loss:3.3718 train_time:493775ms step_avg:364.68ms
step:1365/1750 train_loss:3.3774 train_time:494156ms step_avg:364.69ms
step:1366/1750 train_loss:3.4882 train_time:494543ms step_avg:364.71ms
step:1367/1750 train_loss:3.4595 train_time:494927ms step_avg:364.72ms
step:1368/1750 train_loss:3.4159 train_time:495314ms step_avg:364.74ms
step:1369/1750 train_loss:3.3327 train_time:495712ms step_avg:364.76ms
step:1370/1750 train_loss:3.6704 train_time:496099ms step_avg:364.78ms
step:1371/1750 train_loss:3.3785 train_time:496487ms step_avg:364.80ms
step:1372/1750 train_loss:3.4339 train_time:496875ms step_avg:364.81ms
step:1373/1750 train_loss:3.4274 train_time:497256ms step_avg:364.82ms
step:1374/1750 train_loss:3.2212 train_time:497641ms step_avg:364.84ms
step:1375/1750 train_loss:3.6094 train_time:498023ms step_avg:364.85ms
step:1375/1750 val_loss:3.3762 train_time:498123ms step_avg:364.93ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 293.59912 | frobenius_norm = 67772.46875 | spectral_norm = 12030.06055 | nuclear_norm = 1708340.12500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 187.41066 | spectral_norm = 36.65971 | nuclear_norm = 4300.80420
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 182.45923 | spectral_norm = 39.72972 | nuclear_norm = 4159.13672
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 348.17358 | spectral_norm = 23.07863 | nuclear_norm = 8509.40332
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 244.55594 | spectral_norm = 25.73693 | nuclear_norm = 5621.73926
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 412.58832 | spectral_norm = 35.66508 | nuclear_norm = 10980.03711
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 207.58365 | spectral_norm = 19.48965 | nuclear_norm = 5487.94824
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 189.87802 | spectral_norm = 19.35300 | nuclear_norm = 4351.34570
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 186.78076 | spectral_norm = 18.90956 | nuclear_norm = 4295.90723
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 325.05719 | spectral_norm = 29.54995 | nuclear_norm = 7458.02100
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 328.91116 | spectral_norm = 26.00110 | nuclear_norm = 7699.95117
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 407.58942 | spectral_norm = 29.53348 | nuclear_norm = 10860.40625
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 200.64989 | spectral_norm = 21.50081 | nuclear_norm = 5275.11621
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 184.91264 | spectral_norm = 18.02853 | nuclear_norm = 4118.01953
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 183.96669 | spectral_norm = 16.89077 | nuclear_norm = 4120.53857
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 358.40662 | spectral_norm = 33.33365 | nuclear_norm = 8165.22021
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 357.66840 | spectral_norm = 28.40397 | nuclear_norm = 8428.38477
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 407.25507 | spectral_norm = 35.03476 | nuclear_norm = 10843.85742
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 205.73616 | spectral_norm = 21.44192 | nuclear_norm = 5416.53809
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 184.55147 | spectral_norm = 19.60518 | nuclear_norm = 4157.88281
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 182.87793 | spectral_norm = 18.41696 | nuclear_norm = 4128.50586
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 366.54181 | spectral_norm = 30.91678 | nuclear_norm = 8387.20410
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 369.28732 | spectral_norm = 29.08178 | nuclear_norm = 8649.92578
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 417.29382 | spectral_norm = 38.39246 | nuclear_norm = 11102.29102
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 203.14894 | spectral_norm = 19.96549 | nuclear_norm = 5338.13818
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 186.01347 | spectral_norm = 19.91084 | nuclear_norm = 4236.98145
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 184.29332 | spectral_norm = 18.61047 | nuclear_norm = 4240.93555
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 373.46500 | spectral_norm = 31.75127 | nuclear_norm = 8490.94922
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 373.38928 | spectral_norm = 29.87019 | nuclear_norm = 8688.11035
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 416.18796 | spectral_norm = 38.10780 | nuclear_norm = 11064.54980
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 202.87225 | spectral_norm = 20.71685 | nuclear_norm = 5306.91699
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 183.50562 | spectral_norm = 19.18448 | nuclear_norm = 4138.63379
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 181.68369 | spectral_norm = 17.74965 | nuclear_norm = 4104.78564
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 359.64404 | spectral_norm = 30.78410 | nuclear_norm = 8197.59473
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 361.63837 | spectral_norm = 27.49435 | nuclear_norm = 8416.79102
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 433.62729 | spectral_norm = 35.79123 | nuclear_norm = 11509.50000
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 205.16866 | spectral_norm = 21.59850 | nuclear_norm = 5382.72656
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 181.90031 | spectral_norm = 19.16814 | nuclear_norm = 4057.64404
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 179.94608 | spectral_norm = 17.47183 | nuclear_norm = 4035.07202
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 371.01328 | spectral_norm = 34.91888 | nuclear_norm = 8295.56348
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 356.79367 | spectral_norm = 27.38363 | nuclear_norm = 8338.50879
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 426.36206 | spectral_norm = 33.69296 | nuclear_norm = 11334.25781
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 208.96603 | spectral_norm = 22.89516 | nuclear_norm = 5502.88184
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 187.55621 | spectral_norm = 18.18770 | nuclear_norm = 4179.82080
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 188.03003 | spectral_norm = 17.26352 | nuclear_norm = 4175.00488
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 389.69363 | spectral_norm = 37.81942 | nuclear_norm = 8781.29492
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 383.29526 | spectral_norm = 27.77799 | nuclear_norm = 9032.94727
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 417.01041 | spectral_norm = 38.15600 | nuclear_norm = 11064.20020
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 211.92117 | spectral_norm = 22.45864 | nuclear_norm = 5597.33936
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 187.12941 | spectral_norm = 19.30890 | nuclear_norm = 4152.85645
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 187.37274 | spectral_norm = 18.63027 | nuclear_norm = 4154.68945
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 383.26831 | spectral_norm = 36.50722 | nuclear_norm = 8630.83203
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 373.80777 | spectral_norm = 27.92401 | nuclear_norm = 8732.51367
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 419.90112 | spectral_norm = 37.31091 | nuclear_norm = 11149.09180
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 214.95290 | spectral_norm = 22.76651 | nuclear_norm = 5695.43359
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 189.67940 | spectral_norm = 21.36300 | nuclear_norm = 4232.20312
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 189.59610 | spectral_norm = 19.40533 | nuclear_norm = 4208.58789
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 380.47479 | spectral_norm = 38.54465 | nuclear_norm = 8569.85938
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 374.34262 | spectral_norm = 27.75858 | nuclear_norm = 8762.31250
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 427.03906 | spectral_norm = 37.68520 | nuclear_norm = 11344.06055
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 217.23991 | spectral_norm = 23.74173 | nuclear_norm = 5766.85449
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 189.80330 | spectral_norm = 24.18688 | nuclear_norm = 4180.95752
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 184.34195 | spectral_norm = 23.81060 | nuclear_norm = 4030.01807
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 378.83008 | spectral_norm = 34.51062 | nuclear_norm = 8703.69922
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 386.28656 | spectral_norm = 26.94483 | nuclear_norm = 9119.94629
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 433.55896 | spectral_norm = 34.35120 | nuclear_norm = 11563.28418
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 205.62180 | spectral_norm = 26.13683 | nuclear_norm = 5434.29785
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 190.44064 | spectral_norm = 21.54167 | nuclear_norm = 4254.04736
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 191.14351 | spectral_norm = 21.11891 | nuclear_norm = 4263.62207
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 338.68396 | spectral_norm = 38.34043 | nuclear_norm = 7610.50684
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 370.53891 | spectral_norm = 29.00844 | nuclear_norm = 8609.30664
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 452.43561 | spectral_norm = 37.02247 | nuclear_norm = 12022.57227
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 212.23721 | spectral_norm = 26.98736 | nuclear_norm = 5575.33643
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1319.80933 | spectral_norm = 196.66748 | nuclear_norm = 34777.90625
===========================================
step:1376/1750 train_loss:3.4005 train_time:498397ms step_avg:364.86ms
step:1377/1750 train_loss:3.5413 train_time:498772ms step_avg:364.87ms
step:1378/1750 train_loss:3.5418 train_time:499152ms step_avg:364.88ms
step:1379/1750 train_loss:3.1890 train_time:499540ms step_avg:364.89ms
step:1380/1750 train_loss:3.3688 train_time:499921ms step_avg:364.91ms
step:1381/1750 train_loss:3.7747 train_time:500311ms step_avg:364.92ms
step:1382/1750 train_loss:3.2829 train_time:500691ms step_avg:364.94ms
step:1383/1750 train_loss:3.4572 train_time:501077ms step_avg:364.95ms
step:1384/1750 train_loss:3.5407 train_time:501462ms step_avg:364.97ms
step:1385/1750 train_loss:3.4644 train_time:501837ms step_avg:364.97ms
step:1386/1750 train_loss:3.4085 train_time:502221ms step_avg:364.99ms
step:1387/1750 train_loss:3.2597 train_time:502606ms step_avg:365.00ms
step:1388/1750 train_loss:3.4054 train_time:502985ms step_avg:365.01ms
step:1389/1750 train_loss:3.3843 train_time:503369ms step_avg:365.02ms
step:1390/1750 train_loss:3.6380 train_time:503747ms step_avg:365.03ms
step:1391/1750 train_loss:3.3505 train_time:504129ms step_avg:365.05ms
step:1392/1750 train_loss:3.3524 train_time:504511ms step_avg:365.06ms
step:1393/1750 train_loss:3.3086 train_time:504888ms step_avg:365.07ms
step:1394/1750 train_loss:3.5737 train_time:505265ms step_avg:365.08ms
step:1395/1750 train_loss:3.4598 train_time:505647ms step_avg:365.09ms
step:1396/1750 train_loss:3.4738 train_time:506026ms step_avg:365.10ms
step:1397/1750 train_loss:3.3642 train_time:506401ms step_avg:365.11ms
step:1398/1750 train_loss:3.3192 train_time:506781ms step_avg:365.12ms
step:1399/1750 train_loss:3.3953 train_time:507165ms step_avg:365.13ms
step:1400/1750 train_loss:3.3773 train_time:507559ms step_avg:365.15ms
step:1401/1750 train_loss:3.3997 train_time:507928ms step_avg:365.15ms
step:1402/1750 train_loss:3.3611 train_time:508306ms step_avg:365.16ms
step:1403/1750 train_loss:3.5615 train_time:508696ms step_avg:365.18ms
step:1404/1750 train_loss:3.3437 train_time:509075ms step_avg:365.19ms
step:1405/1750 train_loss:3.3760 train_time:509457ms step_avg:365.20ms
step:1406/1750 train_loss:3.3702 train_time:509840ms step_avg:365.22ms
step:1407/1750 train_loss:3.2371 train_time:510217ms step_avg:365.22ms
step:1408/1750 train_loss:3.3691 train_time:510601ms step_avg:365.24ms
step:1409/1750 train_loss:3.3563 train_time:511004ms step_avg:365.26ms
step:1410/1750 train_loss:3.3426 train_time:511381ms step_avg:365.27ms
step:1411/1750 train_loss:3.4239 train_time:511757ms step_avg:365.28ms
step:1412/1750 train_loss:3.3891 train_time:512136ms step_avg:365.29ms
step:1413/1750 train_loss:3.4210 train_time:512520ms step_avg:365.30ms
step:1414/1750 train_loss:3.4016 train_time:512904ms step_avg:365.32ms
step:1415/1750 train_loss:3.4709 train_time:513300ms step_avg:365.34ms
step:1416/1750 train_loss:3.2891 train_time:513705ms step_avg:365.37ms
step:1417/1750 train_loss:3.3511 train_time:514094ms step_avg:365.38ms
step:1418/1750 train_loss:3.4487 train_time:514478ms step_avg:365.40ms
step:1419/1750 train_loss:3.4036 train_time:514866ms step_avg:365.41ms
step:1420/1750 train_loss:3.4226 train_time:515254ms step_avg:365.43ms
step:1421/1750 train_loss:3.4357 train_time:515639ms step_avg:365.44ms
step:1422/1750 train_loss:3.4019 train_time:516018ms step_avg:365.45ms
step:1423/1750 train_loss:3.3846 train_time:516398ms step_avg:365.46ms
step:1424/1750 train_loss:3.3863 train_time:516789ms step_avg:365.48ms
step:1425/1750 train_loss:3.2431 train_time:517186ms step_avg:365.50ms
step:1426/1750 train_loss:3.3927 train_time:517569ms step_avg:365.51ms
step:1427/1750 train_loss:3.3407 train_time:517959ms step_avg:365.53ms
step:1428/1750 train_loss:3.4389 train_time:518340ms step_avg:365.54ms
step:1429/1750 train_loss:3.4190 train_time:518721ms step_avg:365.55ms
step:1430/1750 train_loss:3.3202 train_time:519111ms step_avg:365.57ms
step:1431/1750 train_loss:3.3829 train_time:519504ms step_avg:365.59ms
step:1432/1750 train_loss:3.3959 train_time:519899ms step_avg:365.61ms
step:1433/1750 train_loss:3.1994 train_time:520300ms step_avg:365.64ms
step:1434/1750 train_loss:3.3524 train_time:520699ms step_avg:365.66ms
step:1435/1750 train_loss:3.1758 train_time:521088ms step_avg:365.68ms
step:1436/1750 train_loss:3.2873 train_time:521475ms step_avg:365.69ms
step:1437/1750 train_loss:3.4673 train_time:521857ms step_avg:365.70ms
step:1438/1750 train_loss:3.4377 train_time:522243ms step_avg:365.72ms
step:1439/1750 train_loss:3.3721 train_time:522632ms step_avg:365.73ms
step:1440/1750 train_loss:3.2472 train_time:523014ms step_avg:365.74ms
step:1441/1750 train_loss:3.4071 train_time:523402ms step_avg:365.76ms
step:1442/1750 train_loss:3.4459 train_time:523797ms step_avg:365.78ms
step:1443/1750 train_loss:3.5342 train_time:524201ms step_avg:365.81ms
step:1444/1750 train_loss:3.5051 train_time:524584ms step_avg:365.82ms
step:1445/1750 train_loss:3.3886 train_time:524971ms step_avg:365.83ms
step:1446/1750 train_loss:3.2612 train_time:525365ms step_avg:365.85ms
step:1447/1750 train_loss:3.3483 train_time:525759ms step_avg:365.87ms
step:1448/1750 train_loss:3.3576 train_time:526142ms step_avg:365.88ms
step:1449/1750 train_loss:3.4601 train_time:526526ms step_avg:365.90ms
step:1450/1750 train_loss:3.4526 train_time:526915ms step_avg:365.91ms
step:1451/1750 train_loss:3.2681 train_time:527300ms step_avg:365.93ms
step:1452/1750 train_loss:3.3859 train_time:527690ms step_avg:365.94ms
step:1453/1750 train_loss:3.3132 train_time:528068ms step_avg:365.95ms
step:1454/1750 train_loss:3.3439 train_time:528451ms step_avg:365.96ms
step:1455/1750 train_loss:3.3827 train_time:528843ms step_avg:365.98ms
step:1456/1750 train_loss:3.3374 train_time:529225ms step_avg:365.99ms
step:1457/1750 train_loss:3.2180 train_time:529609ms step_avg:366.00ms
step:1458/1750 train_loss:3.4773 train_time:529994ms step_avg:366.02ms
step:1459/1750 train_loss:3.3307 train_time:530385ms step_avg:366.03ms
step:1460/1750 train_loss:3.3705 train_time:530769ms step_avg:366.05ms
step:1461/1750 train_loss:3.4938 train_time:531155ms step_avg:366.06ms
step:1462/1750 train_loss:3.3208 train_time:531536ms step_avg:366.07ms
step:1463/1750 train_loss:3.5261 train_time:531929ms step_avg:366.09ms
step:1464/1750 train_loss:3.4149 train_time:532320ms step_avg:366.11ms
step:1465/1750 train_loss:3.4126 train_time:532706ms step_avg:366.12ms
step:1466/1750 train_loss:3.3442 train_time:533091ms step_avg:366.13ms
step:1467/1750 train_loss:3.4522 train_time:533482ms step_avg:366.15ms
step:1468/1750 train_loss:3.3450 train_time:533866ms step_avg:366.16ms
step:1469/1750 train_loss:3.3244 train_time:534257ms step_avg:366.18ms
step:1470/1750 train_loss:3.3894 train_time:534654ms step_avg:366.20ms
step:1471/1750 train_loss:3.3050 train_time:535059ms step_avg:366.23ms
step:1472/1750 train_loss:3.3066 train_time:535458ms step_avg:366.25ms
step:1473/1750 train_loss:3.4952 train_time:535841ms step_avg:366.26ms
step:1474/1750 train_loss:3.3722 train_time:536238ms step_avg:366.28ms
step:1475/1750 train_loss:3.2013 train_time:536638ms step_avg:366.31ms
step:1476/1750 train_loss:3.3172 train_time:537022ms step_avg:366.32ms
step:1477/1750 train_loss:3.2979 train_time:537419ms step_avg:366.34ms
step:1478/1750 train_loss:3.3658 train_time:537816ms step_avg:366.36ms
step:1479/1750 train_loss:3.4481 train_time:538204ms step_avg:366.37ms
step:1480/1750 train_loss:3.3342 train_time:538585ms step_avg:366.38ms
step:1481/1750 train_loss:3.5030 train_time:538974ms step_avg:366.40ms
step:1482/1750 train_loss:3.4231 train_time:539377ms step_avg:366.42ms
step:1483/1750 train_loss:3.3321 train_time:539786ms step_avg:366.45ms
step:1484/1750 train_loss:3.3147 train_time:540183ms step_avg:366.47ms
step:1485/1750 train_loss:3.3371 train_time:540568ms step_avg:366.49ms
step:1486/1750 train_loss:3.2767 train_time:540961ms step_avg:366.50ms
step:1487/1750 train_loss:3.3937 train_time:541355ms step_avg:366.52ms
step:1488/1750 train_loss:3.2860 train_time:541750ms step_avg:366.54ms
step:1489/1750 train_loss:3.3763 train_time:542139ms step_avg:366.56ms
step:1490/1750 train_loss:3.3031 train_time:542529ms step_avg:366.57ms
step:1491/1750 train_loss:3.2145 train_time:542916ms step_avg:366.59ms
step:1492/1750 train_loss:3.3193 train_time:543301ms step_avg:366.60ms
step:1493/1750 train_loss:3.4862 train_time:543680ms step_avg:366.61ms
step:1494/1750 train_loss:3.3527 train_time:544061ms step_avg:366.62ms
step:1495/1750 train_loss:3.0864 train_time:544453ms step_avg:366.63ms
step:1496/1750 train_loss:3.4100 train_time:544842ms step_avg:366.65ms
step:1497/1750 train_loss:3.3644 train_time:545233ms step_avg:366.67ms
step:1498/1750 train_loss:3.3973 train_time:545629ms step_avg:366.69ms
step:1499/1750 train_loss:3.3622 train_time:546031ms step_avg:366.71ms
step:1500/1750 train_loss:3.3436 train_time:546444ms step_avg:366.74ms
step:1500/1750 val_loss:3.3338 train_time:546549ms step_avg:366.81ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 295.64423 | frobenius_norm = 68258.11719 | spectral_norm = 12123.37695 | nuclear_norm = 1721742.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 189.51323 | spectral_norm = 37.90778 | nuclear_norm = 4342.49561
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 184.76962 | spectral_norm = 40.85144 | nuclear_norm = 4205.20605
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 353.65393 | spectral_norm = 23.30716 | nuclear_norm = 8652.69336
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 245.85136 | spectral_norm = 26.07321 | nuclear_norm = 5642.44580
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 419.81180 | spectral_norm = 36.55857 | nuclear_norm = 11172.39746
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 210.89659 | spectral_norm = 19.91809 | nuclear_norm = 5575.88525
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 192.78513 | spectral_norm = 19.86733 | nuclear_norm = 4413.80713
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 189.71304 | spectral_norm = 19.30008 | nuclear_norm = 4361.05273
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 330.21579 | spectral_norm = 29.98034 | nuclear_norm = 7578.56201
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 333.94962 | spectral_norm = 26.35230 | nuclear_norm = 7822.68945
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 414.01895 | spectral_norm = 30.15855 | nuclear_norm = 11031.85254
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 203.71838 | spectral_norm = 21.95431 | nuclear_norm = 5355.33496
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 187.61777 | spectral_norm = 18.39782 | nuclear_norm = 4170.23535
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 186.68054 | spectral_norm = 17.15827 | nuclear_norm = 4173.16016
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 364.60873 | spectral_norm = 33.87698 | nuclear_norm = 8308.94727
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 363.46045 | spectral_norm = 28.82715 | nuclear_norm = 8569.92676
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 413.42294 | spectral_norm = 35.82496 | nuclear_norm = 11007.20508
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 208.87167 | spectral_norm = 21.86840 | nuclear_norm = 5498.86084
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 187.14992 | spectral_norm = 19.97484 | nuclear_norm = 4209.29834
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 185.46013 | spectral_norm = 18.78500 | nuclear_norm = 4181.69238
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 373.32965 | spectral_norm = 31.44127 | nuclear_norm = 8550.14160
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 375.82825 | spectral_norm = 29.75201 | nuclear_norm = 8807.51270
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 423.32321 | spectral_norm = 39.24484 | nuclear_norm = 11262.42285
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 206.28230 | spectral_norm = 20.38064 | nuclear_norm = 5421.26660
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 188.83304 | spectral_norm = 20.27397 | nuclear_norm = 4295.44043
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 186.99696 | spectral_norm = 18.93056 | nuclear_norm = 4301.13184
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 380.87558 | spectral_norm = 32.45043 | nuclear_norm = 8671.52246
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 380.38904 | spectral_norm = 30.39762 | nuclear_norm = 8857.29590
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 422.02307 | spectral_norm = 38.85710 | nuclear_norm = 11219.28906
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 205.91451 | spectral_norm = 21.16905 | nuclear_norm = 5386.30859
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 186.30943 | spectral_norm = 19.68864 | nuclear_norm = 4196.12012
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 184.30649 | spectral_norm = 18.05598 | nuclear_norm = 4159.05322
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 366.79672 | spectral_norm = 31.36166 | nuclear_norm = 8370.93457
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 368.32565 | spectral_norm = 27.96389 | nuclear_norm = 8578.06836
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 439.94928 | spectral_norm = 36.61875 | nuclear_norm = 11673.80566
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 208.18646 | spectral_norm = 22.13077 | nuclear_norm = 5461.25293
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 184.36882 | spectral_norm = 19.61029 | nuclear_norm = 4102.22363
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 182.49794 | spectral_norm = 17.82249 | nuclear_norm = 4084.80615
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 377.46716 | spectral_norm = 35.53035 | nuclear_norm = 8448.08301
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 362.37146 | spectral_norm = 27.96197 | nuclear_norm = 8466.13281
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 433.17877 | spectral_norm = 34.38718 | nuclear_norm = 11511.91211
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 212.09077 | spectral_norm = 23.40051 | nuclear_norm = 5583.62207
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 190.24936 | spectral_norm = 18.53949 | nuclear_norm = 4230.27686
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 190.75050 | spectral_norm = 17.57167 | nuclear_norm = 4226.20605
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 396.43091 | spectral_norm = 38.68641 | nuclear_norm = 8933.08887
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 389.50610 | spectral_norm = 28.39512 | nuclear_norm = 9175.76367
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 423.15714 | spectral_norm = 39.06533 | nuclear_norm = 11222.43652
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 215.00319 | spectral_norm = 22.91460 | nuclear_norm = 5677.47607
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 189.70834 | spectral_norm = 19.75818 | nuclear_norm = 4198.79883
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 190.13913 | spectral_norm = 18.88446 | nuclear_norm = 4206.53223
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 390.12888 | spectral_norm = 37.31701 | nuclear_norm = 8785.25293
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 379.77805 | spectral_norm = 28.45751 | nuclear_norm = 8867.17383
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 426.19577 | spectral_norm = 38.09427 | nuclear_norm = 11312.81348
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 218.10960 | spectral_norm = 23.19144 | nuclear_norm = 5778.49414
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 192.33951 | spectral_norm = 21.90955 | nuclear_norm = 4280.87305
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 192.35396 | spectral_norm = 19.77164 | nuclear_norm = 4258.54883
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 388.32147 | spectral_norm = 39.52977 | nuclear_norm = 8744.33496
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 380.33426 | spectral_norm = 28.37321 | nuclear_norm = 8900.89453
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 433.24490 | spectral_norm = 38.49962 | nuclear_norm = 11505.37012
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 220.55229 | spectral_norm = 24.19400 | nuclear_norm = 5855.12305
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 192.32999 | spectral_norm = 24.79974 | nuclear_norm = 4220.02002
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 186.83324 | spectral_norm = 24.46212 | nuclear_norm = 4068.17334
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 387.07828 | spectral_norm = 35.57805 | nuclear_norm = 8888.72266
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 392.74695 | spectral_norm = 27.41692 | nuclear_norm = 9269.46387
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 438.90204 | spectral_norm = 34.99189 | nuclear_norm = 11705.21484
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 208.91695 | spectral_norm = 26.59690 | nuclear_norm = 5521.35791
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 193.18227 | spectral_norm = 22.09738 | nuclear_norm = 4305.85645
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 193.75642 | spectral_norm = 21.63068 | nuclear_norm = 4310.53613
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 347.84290 | spectral_norm = 39.63455 | nuclear_norm = 7815.10547
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 378.03583 | spectral_norm = 29.63975 | nuclear_norm = 8782.13965
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 457.79895 | spectral_norm = 37.46874 | nuclear_norm = 12162.22070
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 215.43883 | spectral_norm = 27.40507 | nuclear_norm = 5658.16504
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1327.70752 | spectral_norm = 193.66565 | nuclear_norm = 35048.67969
===========================================
step:1501/1750 train_loss:3.1383 train_time:546828ms step_avg:366.75ms
step:1502/1750 train_loss:3.4161 train_time:547203ms step_avg:366.76ms
step:1503/1750 train_loss:3.2947 train_time:547583ms step_avg:366.77ms
step:1504/1750 train_loss:3.2984 train_time:547966ms step_avg:366.78ms
step:1505/1750 train_loss:3.2627 train_time:548348ms step_avg:366.79ms
step:1506/1750 train_loss:3.3333 train_time:548737ms step_avg:366.80ms
step:1507/1750 train_loss:3.2255 train_time:549145ms step_avg:366.83ms
step:1508/1750 train_loss:3.5299 train_time:549531ms step_avg:366.84ms
step:1509/1750 train_loss:3.3291 train_time:549911ms step_avg:366.85ms
step:1510/1750 train_loss:3.3253 train_time:550295ms step_avg:366.86ms
step:1511/1750 train_loss:3.4624 train_time:550730ms step_avg:366.91ms
step:1512/1750 train_loss:3.4714 train_time:551190ms step_avg:366.97ms
step:1513/1750 train_loss:3.3212 train_time:551578ms step_avg:366.98ms
step:1514/1750 train_loss:3.1379 train_time:551967ms step_avg:367.00ms
step:1515/1750 train_loss:3.2876 train_time:552355ms step_avg:367.01ms
step:1516/1750 train_loss:3.3021 train_time:552751ms step_avg:367.03ms
step:1517/1750 train_loss:3.3549 train_time:553137ms step_avg:367.05ms
step:1518/1750 train_loss:3.2594 train_time:553527ms step_avg:367.06ms
step:1519/1750 train_loss:3.5544 train_time:554024ms step_avg:367.15ms
step:1520/1750 train_loss:3.1786 train_time:554436ms step_avg:367.18ms
step:1521/1750 train_loss:3.2599 train_time:554820ms step_avg:367.19ms
step:1522/1750 train_loss:3.4007 train_time:555211ms step_avg:367.20ms
step:1523/1750 train_loss:3.2756 train_time:555594ms step_avg:367.21ms
step:1524/1750 train_loss:3.3969 train_time:555982ms step_avg:367.23ms
step:1525/1750 train_loss:3.3832 train_time:556384ms step_avg:367.25ms
step:1526/1750 train_loss:3.3196 train_time:556792ms step_avg:367.28ms
step:1527/1750 train_loss:3.3410 train_time:557181ms step_avg:367.29ms
step:1528/1750 train_loss:3.4549 train_time:557566ms step_avg:367.30ms
step:1529/1750 train_loss:3.4502 train_time:557946ms step_avg:367.31ms
step:1530/1750 train_loss:3.2806 train_time:558327ms step_avg:367.32ms
step:1531/1750 train_loss:3.2352 train_time:558714ms step_avg:367.33ms
step:1532/1750 train_loss:3.3906 train_time:559100ms step_avg:367.35ms
step:1533/1750 train_loss:3.3234 train_time:559500ms step_avg:367.37ms
step:1534/1750 train_loss:3.3221 train_time:559898ms step_avg:367.39ms
step:1535/1750 train_loss:3.3285 train_time:560286ms step_avg:367.40ms
step:1536/1750 train_loss:3.2733 train_time:560679ms step_avg:367.42ms
step:1537/1750 train_loss:3.3198 train_time:561065ms step_avg:367.43ms
step:1538/1750 train_loss:3.4733 train_time:561467ms step_avg:367.45ms
step:1539/1750 train_loss:3.4432 train_time:561861ms step_avg:367.47ms
step:1540/1750 train_loss:3.3228 train_time:562249ms step_avg:367.48ms
step:1541/1750 train_loss:3.2759 train_time:562640ms step_avg:367.50ms
step:1542/1750 train_loss:3.2991 train_time:563031ms step_avg:367.51ms
step:1543/1750 train_loss:3.1971 train_time:563417ms step_avg:367.53ms
step:1544/1750 train_loss:3.3411 train_time:563797ms step_avg:367.53ms
step:1545/1750 train_loss:3.3120 train_time:564189ms step_avg:367.55ms
step:1546/1750 train_loss:3.3066 train_time:564594ms step_avg:367.57ms
step:1547/1750 train_loss:3.2649 train_time:564988ms step_avg:367.59ms
step:1548/1750 train_loss:3.3143 train_time:565387ms step_avg:367.61ms
step:1549/1750 train_loss:3.3728 train_time:565771ms step_avg:367.62ms
step:1550/1750 train_loss:3.3403 train_time:566153ms step_avg:367.63ms
step:1551/1750 train_loss:3.2486 train_time:566543ms step_avg:367.65ms
step:1552/1750 train_loss:3.2663 train_time:566932ms step_avg:367.66ms
step:1553/1750 train_loss:3.2727 train_time:567315ms step_avg:367.67ms
step:1554/1750 train_loss:3.4044 train_time:567704ms step_avg:367.68ms
step:1555/1750 train_loss:3.3813 train_time:568095ms step_avg:367.70ms
step:1556/1750 train_loss:3.3249 train_time:568475ms step_avg:367.71ms
step:1557/1750 train_loss:3.3624 train_time:568855ms step_avg:367.71ms
step:1558/1750 train_loss:3.3053 train_time:569243ms step_avg:367.73ms
step:1559/1750 train_loss:3.1716 train_time:569647ms step_avg:367.75ms
step:1560/1750 train_loss:3.4773 train_time:570030ms step_avg:367.76ms
step:1561/1750 train_loss:3.2696 train_time:570417ms step_avg:367.77ms
step:1562/1750 train_loss:3.2529 train_time:570801ms step_avg:367.78ms
step:1563/1750 train_loss:3.3684 train_time:571188ms step_avg:367.80ms
step:1564/1750 train_loss:3.1986 train_time:571589ms step_avg:367.82ms
step:1565/1750 train_loss:3.2142 train_time:571988ms step_avg:367.84ms
step:1566/1750 train_loss:3.4111 train_time:572378ms step_avg:367.85ms
step:1567/1750 train_loss:3.2783 train_time:572765ms step_avg:367.86ms
step:1568/1750 train_loss:3.2822 train_time:573164ms step_avg:367.88ms
step:1569/1750 train_loss:3.3701 train_time:573584ms step_avg:367.92ms
step:1570/1750 train_loss:3.3238 train_time:573990ms step_avg:367.94ms
step:1571/1750 train_loss:3.2067 train_time:574387ms step_avg:367.96ms
step:1572/1750 train_loss:3.2438 train_time:574775ms step_avg:367.97ms
step:1573/1750 train_loss:3.3608 train_time:575169ms step_avg:367.99ms
step:1574/1750 train_loss:3.2148 train_time:575552ms step_avg:368.00ms
step:1575/1750 train_loss:3.3701 train_time:575938ms step_avg:368.01ms
step:1576/1750 train_loss:3.2770 train_time:576326ms step_avg:368.02ms
step:1577/1750 train_loss:3.3240 train_time:576725ms step_avg:368.04ms
step:1578/1750 train_loss:3.3113 train_time:577117ms step_avg:368.06ms
step:1579/1750 train_loss:3.2874 train_time:577514ms step_avg:368.08ms
step:1580/1750 train_loss:3.2475 train_time:577900ms step_avg:368.09ms
step:1581/1750 train_loss:3.4453 train_time:578297ms step_avg:368.11ms
step:1582/1750 train_loss:3.2650 train_time:578707ms step_avg:368.13ms
step:1583/1750 train_loss:3.4210 train_time:579113ms step_avg:368.16ms
step:1584/1750 train_loss:3.2438 train_time:579501ms step_avg:368.17ms
step:1585/1750 train_loss:3.4120 train_time:579898ms step_avg:368.19ms
step:1586/1750 train_loss:3.1936 train_time:580286ms step_avg:368.20ms
step:1587/1750 train_loss:3.3992 train_time:580671ms step_avg:368.21ms
step:1588/1750 train_loss:3.2749 train_time:581065ms step_avg:368.23ms
step:1589/1750 train_loss:3.4360 train_time:581454ms step_avg:368.24ms
step:1590/1750 train_loss:3.2773 train_time:581843ms step_avg:368.26ms
step:1591/1750 train_loss:3.2885 train_time:582235ms step_avg:368.27ms
step:1592/1750 train_loss:3.3626 train_time:582624ms step_avg:368.28ms
step:1593/1750 train_loss:3.3362 train_time:583028ms step_avg:368.31ms
step:1594/1750 train_loss:3.3096 train_time:583420ms step_avg:368.32ms
step:1595/1750 train_loss:3.4459 train_time:583811ms step_avg:368.34ms
step:1596/1750 train_loss:3.1588 train_time:584215ms step_avg:368.36ms
step:1597/1750 train_loss:3.3338 train_time:584617ms step_avg:368.38ms
step:1598/1750 train_loss:3.3806 train_time:585019ms step_avg:368.40ms
step:1599/1750 train_loss:3.4459 train_time:585425ms step_avg:368.42ms
step:1600/1750 train_loss:3.2677 train_time:585824ms step_avg:368.44ms
step:1601/1750 train_loss:3.5746 train_time:586211ms step_avg:368.45ms
step:1602/1750 train_loss:3.4546 train_time:586610ms step_avg:368.47ms
step:1603/1750 train_loss:3.2245 train_time:587014ms step_avg:368.50ms
step:1604/1750 train_loss:3.2639 train_time:587408ms step_avg:368.51ms
step:1605/1750 train_loss:3.1585 train_time:587819ms step_avg:368.54ms
step:1606/1750 train_loss:3.4686 train_time:588225ms step_avg:368.56ms
step:1607/1750 train_loss:3.3014 train_time:588617ms step_avg:368.58ms
step:1608/1750 train_loss:3.3075 train_time:589013ms step_avg:368.59ms
step:1609/1750 train_loss:3.2408 train_time:589412ms step_avg:368.61ms
step:1610/1750 train_loss:3.7475 train_time:589826ms step_avg:368.64ms
step:1611/1750 train_loss:3.5024 train_time:590228ms step_avg:368.66ms
step:1612/1750 train_loss:3.3959 train_time:590636ms step_avg:368.69ms
step:1613/1750 train_loss:3.2628 train_time:591049ms step_avg:368.71ms
step:1614/1750 train_loss:3.2925 train_time:591442ms step_avg:368.73ms
step:1615/1750 train_loss:3.3112 train_time:591847ms step_avg:368.75ms
step:1616/1750 train_loss:3.2818 train_time:592276ms step_avg:368.79ms
step:1617/1750 train_loss:3.3515 train_time:592690ms step_avg:368.82ms
step:1618/1750 train_loss:3.2822 train_time:593074ms step_avg:368.83ms
step:1619/1750 train_loss:3.1877 train_time:593466ms step_avg:368.84ms
step:1620/1750 train_loss:3.4588 train_time:593857ms step_avg:368.86ms
step:1621/1750 train_loss:3.3798 train_time:594259ms step_avg:368.88ms
step:1622/1750 train_loss:3.1597 train_time:594653ms step_avg:368.89ms
step:1623/1750 train_loss:3.2595 train_time:595046ms step_avg:368.91ms
step:1624/1750 train_loss:3.2108 train_time:595427ms step_avg:368.91ms
step:1625/1750 train_loss:3.3186 train_time:595811ms step_avg:368.92ms
step:1625/1750 val_loss:3.2976 train_time:595915ms step_avg:368.99ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.14233 | frobenius_norm = 68376.38281 | spectral_norm = 12158.52832 | nuclear_norm = 1725330.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 190.02156 | spectral_norm = 38.63552 | nuclear_norm = 4349.49121
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 185.49835 | spectral_norm = 41.41218 | nuclear_norm = 4217.83594
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 356.26453 | spectral_norm = 23.36645 | nuclear_norm = 8722.99805
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 246.10916 | spectral_norm = 26.18250 | nuclear_norm = 5643.04297
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 422.87347 | spectral_norm = 37.00226 | nuclear_norm = 11254.55371
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 212.27554 | spectral_norm = 20.08493 | nuclear_norm = 5613.05322
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 193.95447 | spectral_norm = 20.05467 | nuclear_norm = 4438.29102
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 190.95148 | spectral_norm = 19.44957 | nuclear_norm = 4388.25732
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 332.37442 | spectral_norm = 30.14893 | nuclear_norm = 7629.27783
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 336.12726 | spectral_norm = 26.57642 | nuclear_norm = 7876.39648
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 416.69403 | spectral_norm = 30.35195 | nuclear_norm = 11103.18066
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 204.93997 | spectral_norm = 22.14378 | nuclear_norm = 5387.28076
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 188.57990 | spectral_norm = 18.62743 | nuclear_norm = 4185.87207
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 187.66811 | spectral_norm = 17.27125 | nuclear_norm = 4189.19092
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 367.42899 | spectral_norm = 33.99480 | nuclear_norm = 8375.31250
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 366.02652 | spectral_norm = 28.92611 | nuclear_norm = 8633.24023
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 416.00583 | spectral_norm = 36.14415 | nuclear_norm = 11075.41504
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 210.12221 | spectral_norm = 22.02667 | nuclear_norm = 5531.45117
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 188.16972 | spectral_norm = 20.07092 | nuclear_norm = 4227.81250
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 186.47807 | spectral_norm = 18.98189 | nuclear_norm = 4200.56738
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 376.38190 | spectral_norm = 31.68832 | nuclear_norm = 8625.48047
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 378.73560 | spectral_norm = 30.02317 | nuclear_norm = 8879.85547
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 425.79092 | spectral_norm = 39.54758 | nuclear_norm = 11328.14844
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 207.53302 | spectral_norm = 20.56507 | nuclear_norm = 5454.56982
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 189.91617 | spectral_norm = 20.46243 | nuclear_norm = 4315.76855
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 188.09541 | spectral_norm = 19.12396 | nuclear_norm = 4324.67773
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 384.35745 | spectral_norm = 32.78545 | nuclear_norm = 8757.72852
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 383.66302 | spectral_norm = 30.59881 | nuclear_norm = 8938.06934
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 424.36725 | spectral_norm = 39.20944 | nuclear_norm = 11280.87695
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 207.10248 | spectral_norm = 21.38928 | nuclear_norm = 5417.22070
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 187.33868 | spectral_norm = 19.88114 | nuclear_norm = 4214.21680
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 185.26111 | spectral_norm = 18.19124 | nuclear_norm = 4175.55078
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 370.18417 | spectral_norm = 31.61531 | nuclear_norm = 8454.73535
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 371.48019 | spectral_norm = 28.19156 | nuclear_norm = 8655.25586
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 442.50317 | spectral_norm = 37.01435 | nuclear_norm = 11739.43066
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 209.36165 | spectral_norm = 22.38458 | nuclear_norm = 5491.59717
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 185.26411 | spectral_norm = 19.82022 | nuclear_norm = 4115.81250
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 183.45888 | spectral_norm = 17.94400 | nuclear_norm = 4101.45654
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 380.54465 | spectral_norm = 35.73792 | nuclear_norm = 8522.87402
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 364.93835 | spectral_norm = 28.10996 | nuclear_norm = 8525.54492
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 436.03369 | spectral_norm = 34.73219 | nuclear_norm = 11584.81152
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 213.31409 | spectral_norm = 23.62760 | nuclear_norm = 5614.75439
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 191.21901 | spectral_norm = 18.70446 | nuclear_norm = 4244.41602
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 191.79784 | spectral_norm = 17.75685 | nuclear_norm = 4242.32812
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 399.63647 | spectral_norm = 39.05005 | nuclear_norm = 9006.19336
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 392.43607 | spectral_norm = 28.67816 | nuclear_norm = 9241.85742
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 425.60251 | spectral_norm = 39.45689 | nuclear_norm = 11284.31250
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 216.17795 | spectral_norm = 23.11502 | nuclear_norm = 5707.58203
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 190.62421 | spectral_norm = 20.00906 | nuclear_norm = 4210.69189
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 191.15215 | spectral_norm = 18.95725 | nuclear_norm = 4220.34766
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 393.24496 | spectral_norm = 37.65107 | nuclear_norm = 8854.47656
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 382.50140 | spectral_norm = 28.71646 | nuclear_norm = 8927.18750
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 428.77982 | spectral_norm = 38.46059 | nuclear_norm = 11378.85059
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 219.35364 | spectral_norm = 23.36235 | nuclear_norm = 5811.13525
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 193.28278 | spectral_norm = 22.20436 | nuclear_norm = 4293.10449
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 193.36557 | spectral_norm = 19.97006 | nuclear_norm = 4272.21484
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 391.98636 | spectral_norm = 39.96952 | nuclear_norm = 8825.15625
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 383.04190 | spectral_norm = 28.61769 | nuclear_norm = 8961.56055
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 435.75418 | spectral_norm = 38.84490 | nuclear_norm = 11568.96484
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 221.86348 | spectral_norm = 24.37133 | nuclear_norm = 5890.12500
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 193.17819 | spectral_norm = 25.13480 | nuclear_norm = 4226.64990
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 187.65291 | spectral_norm = 24.76584 | nuclear_norm = 4074.17480
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 391.06845 | spectral_norm = 36.10564 | nuclear_norm = 8977.71094
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 395.72742 | spectral_norm = 27.69444 | nuclear_norm = 9337.22266
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 440.76913 | spectral_norm = 35.25703 | nuclear_norm = 11753.86133
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 210.21597 | spectral_norm = 26.70094 | nuclear_norm = 5555.84473
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 194.11465 | spectral_norm = 22.37560 | nuclear_norm = 4319.36035
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 194.66490 | spectral_norm = 21.84125 | nuclear_norm = 4323.37451
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 352.37259 | spectral_norm = 40.30745 | nuclear_norm = 7916.61816
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 381.63834 | spectral_norm = 29.92016 | nuclear_norm = 8864.78516
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 459.59848 | spectral_norm = 37.59462 | nuclear_norm = 12208.91797
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 216.73489 | spectral_norm = 27.50661 | nuclear_norm = 5691.08496
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1326.23169 | spectral_norm = 190.86328 | nuclear_norm = 35055.89844
===========================================
step:1626/1750 train_loss:3.2396 train_time:596198ms step_avg:368.93ms
step:1627/1750 train_loss:3.2381 train_time:596578ms step_avg:368.94ms
step:1628/1750 train_loss:3.3612 train_time:596966ms step_avg:368.95ms
step:1629/1750 train_loss:3.2472 train_time:597354ms step_avg:368.96ms
step:1630/1750 train_loss:3.3213 train_time:597752ms step_avg:368.98ms
step:1631/1750 train_loss:3.1733 train_time:598174ms step_avg:369.02ms
step:1632/1750 train_loss:3.1471 train_time:598560ms step_avg:369.03ms
step:1633/1750 train_loss:3.3011 train_time:598947ms step_avg:369.04ms
step:1634/1750 train_loss:3.3087 train_time:599330ms step_avg:369.05ms
step:1635/1750 train_loss:3.2518 train_time:599734ms step_avg:369.07ms
step:1636/1750 train_loss:3.3275 train_time:600125ms step_avg:369.08ms
step:1637/1750 train_loss:3.3732 train_time:600511ms step_avg:369.09ms
step:1638/1750 train_loss:3.4005 train_time:600904ms step_avg:369.11ms
step:1639/1750 train_loss:3.5685 train_time:601305ms step_avg:369.13ms
step:1640/1750 train_loss:3.3491 train_time:601702ms step_avg:369.14ms
step:1641/1750 train_loss:3.2958 train_time:602096ms step_avg:369.16ms
step:1642/1750 train_loss:3.4072 train_time:602486ms step_avg:369.17ms
step:1643/1750 train_loss:3.2733 train_time:602889ms step_avg:369.19ms
step:1644/1750 train_loss:3.3122 train_time:603280ms step_avg:369.20ms
step:1645/1750 train_loss:3.3145 train_time:603664ms step_avg:369.21ms
step:1646/1750 train_loss:3.0728 train_time:604052ms step_avg:369.23ms
step:1647/1750 train_loss:3.3218 train_time:604436ms step_avg:369.23ms
step:1648/1750 train_loss:3.2111 train_time:604826ms step_avg:369.25ms
step:1649/1750 train_loss:3.2857 train_time:605211ms step_avg:369.26ms
step:1650/1750 train_loss:3.2689 train_time:605598ms step_avg:369.27ms
step:1651/1750 train_loss:3.3443 train_time:605984ms step_avg:369.28ms
step:1652/1750 train_loss:3.2612 train_time:606372ms step_avg:369.29ms
step:1653/1750 train_loss:3.3867 train_time:606772ms step_avg:369.31ms
step:1654/1750 train_loss:3.3869 train_time:607161ms step_avg:369.32ms
step:1655/1750 train_loss:3.1767 train_time:607559ms step_avg:369.34ms
step:1656/1750 train_loss:3.3256 train_time:607970ms step_avg:369.36ms
step:1657/1750 train_loss:3.2507 train_time:608368ms step_avg:369.38ms
step:1658/1750 train_loss:3.2198 train_time:608755ms step_avg:369.39ms
step:1659/1750 train_loss:3.3026 train_time:609144ms step_avg:369.40ms
step:1660/1750 train_loss:3.3456 train_time:609533ms step_avg:369.41ms
step:1661/1750 train_loss:3.2512 train_time:609923ms step_avg:369.43ms
step:1662/1750 train_loss:3.3597 train_time:610308ms step_avg:369.44ms
step:1663/1750 train_loss:3.3513 train_time:610713ms step_avg:369.46ms
step:1664/1750 train_loss:3.4085 train_time:611136ms step_avg:369.49ms
step:1665/1750 train_loss:3.3314 train_time:611533ms step_avg:369.51ms
step:1666/1750 train_loss:3.4988 train_time:611926ms step_avg:369.52ms
step:1667/1750 train_loss:3.2010 train_time:612322ms step_avg:369.54ms
step:1668/1750 train_loss:3.2924 train_time:612717ms step_avg:369.55ms
step:1669/1750 train_loss:3.2057 train_time:613105ms step_avg:369.56ms
step:1670/1750 train_loss:3.2202 train_time:613496ms step_avg:369.58ms
step:1671/1750 train_loss:3.3712 train_time:613891ms step_avg:369.59ms
step:1672/1750 train_loss:3.5745 train_time:614283ms step_avg:369.60ms
step:1673/1750 train_loss:3.2770 train_time:614675ms step_avg:369.62ms
step:1674/1750 train_loss:3.2618 train_time:615066ms step_avg:369.63ms
step:1675/1750 train_loss:3.1259 train_time:615469ms step_avg:369.65ms
step:1676/1750 train_loss:3.3462 train_time:615871ms step_avg:369.67ms
step:1677/1750 train_loss:3.2773 train_time:616262ms step_avg:369.68ms
step:1678/1750 train_loss:3.2979 train_time:616657ms step_avg:369.70ms
step:1679/1750 train_loss:3.2988 train_time:617048ms step_avg:369.71ms
step:1680/1750 train_loss:3.0844 train_time:617465ms step_avg:369.74ms
step:1681/1750 train_loss:3.3012 train_time:617863ms step_avg:369.76ms
step:1682/1750 train_loss:3.2868 train_time:618261ms step_avg:369.77ms
step:1683/1750 train_loss:3.3012 train_time:618653ms step_avg:369.79ms
step:1684/1750 train_loss:3.3426 train_time:619040ms step_avg:369.80ms
step:1685/1750 train_loss:3.2408 train_time:619428ms step_avg:369.81ms
step:1686/1750 train_loss:3.3673 train_time:619825ms step_avg:369.82ms
step:1687/1750 train_loss:3.2425 train_time:620219ms step_avg:369.84ms
step:1688/1750 train_loss:3.3139 train_time:620628ms step_avg:369.86ms
step:1689/1750 train_loss:3.2249 train_time:621029ms step_avg:369.88ms
step:1690/1750 train_loss:3.0716 train_time:621431ms step_avg:369.90ms
step:1691/1750 train_loss:3.3058 train_time:621822ms step_avg:369.91ms
step:1692/1750 train_loss:3.2931 train_time:622210ms step_avg:369.92ms
step:1693/1750 train_loss:3.2082 train_time:622600ms step_avg:369.93ms
step:1694/1750 train_loss:3.6068 train_time:623003ms step_avg:369.95ms
step:1695/1750 train_loss:3.3281 train_time:623404ms step_avg:369.97ms
step:1696/1750 train_loss:3.3362 train_time:623797ms step_avg:369.99ms
step:1697/1750 train_loss:3.2532 train_time:624179ms step_avg:369.99ms
step:1698/1750 train_loss:3.1261 train_time:624569ms step_avg:370.01ms
step:1699/1750 train_loss:3.2295 train_time:624961ms step_avg:370.02ms
step:1700/1750 train_loss:3.2441 train_time:625395ms step_avg:370.06ms
step:1701/1750 train_loss:3.3189 train_time:625858ms step_avg:370.11ms
step:1702/1750 train_loss:3.2383 train_time:626244ms step_avg:370.12ms
step:1703/1750 train_loss:3.4143 train_time:626627ms step_avg:370.13ms
step:1704/1750 train_loss:3.2096 train_time:627013ms step_avg:370.14ms
step:1705/1750 train_loss:3.4359 train_time:627397ms step_avg:370.15ms
step:1706/1750 train_loss:3.2527 train_time:627780ms step_avg:370.15ms
step:1707/1750 train_loss:3.0518 train_time:628175ms step_avg:370.17ms
step:1708/1750 train_loss:3.3937 train_time:628565ms step_avg:370.18ms
step:1709/1750 train_loss:3.2968 train_time:629064ms step_avg:370.26ms
step:1710/1750 train_loss:3.2790 train_time:629498ms step_avg:370.29ms
step:1711/1750 train_loss:3.2857 train_time:629896ms step_avg:370.31ms
step:1712/1750 train_loss:3.3185 train_time:630292ms step_avg:370.32ms
step:1713/1750 train_loss:3.3347 train_time:630686ms step_avg:370.34ms
step:1714/1750 train_loss:3.2290 train_time:631088ms step_avg:370.36ms
step:1715/1750 train_loss:3.2834 train_time:631513ms step_avg:370.39ms
step:1716/1750 train_loss:3.0979 train_time:631898ms step_avg:370.40ms
step:1717/1750 train_loss:3.2467 train_time:632279ms step_avg:370.40ms
step:1718/1750 train_loss:3.2620 train_time:632668ms step_avg:370.41ms
step:1719/1750 train_loss:3.2162 train_time:633064ms step_avg:370.43ms
step:1720/1750 train_loss:3.3802 train_time:633476ms step_avg:370.45ms
step:1721/1750 train_loss:3.1655 train_time:633903ms step_avg:370.49ms
step:1722/1750 train_loss:3.3201 train_time:634297ms step_avg:370.50ms
step:1723/1750 train_loss:3.4054 train_time:634709ms step_avg:370.52ms
step:1724/1750 train_loss:3.2567 train_time:635102ms step_avg:370.54ms
step:1725/1750 train_loss:3.4869 train_time:635508ms step_avg:370.56ms
step:1726/1750 train_loss:3.2598 train_time:635917ms step_avg:370.58ms
step:1727/1750 train_loss:3.3313 train_time:636300ms step_avg:370.59ms
step:1728/1750 train_loss:3.2973 train_time:636691ms step_avg:370.60ms
step:1729/1750 train_loss:3.2755 train_time:637093ms step_avg:370.62ms
step:1730/1750 train_loss:3.6505 train_time:637493ms step_avg:370.64ms
step:1731/1750 train_loss:3.2976 train_time:637884ms step_avg:370.65ms
step:1732/1750 train_loss:3.4308 train_time:638278ms step_avg:370.66ms
step:1733/1750 train_loss:3.2089 train_time:638658ms step_avg:370.67ms
step:1734/1750 train_loss:3.2470 train_time:639047ms step_avg:370.68ms
step:1735/1750 train_loss:3.2745 train_time:639444ms step_avg:370.69ms
step:1736/1750 train_loss:3.2566 train_time:639845ms step_avg:370.71ms
step:1737/1750 train_loss:3.3817 train_time:640244ms step_avg:370.73ms
step:1738/1750 train_loss:3.2245 train_time:640663ms step_avg:370.75ms
step:1739/1750 train_loss:3.2870 train_time:641070ms step_avg:370.77ms
step:1740/1750 train_loss:3.3704 train_time:641468ms step_avg:370.79ms
step:1741/1750 train_loss:3.1631 train_time:641860ms step_avg:370.80ms
step:1742/1750 train_loss:3.0650 train_time:642257ms step_avg:370.82ms
step:1743/1750 train_loss:2.9540 train_time:642669ms step_avg:370.84ms
step:1744/1750 train_loss:3.2898 train_time:643060ms step_avg:370.85ms
step:1745/1750 train_loss:3.3148 train_time:643444ms step_avg:370.86ms
step:1746/1750 train_loss:3.2758 train_time:643831ms step_avg:370.87ms
step:1747/1750 train_loss:3.2963 train_time:644235ms step_avg:370.89ms
step:1748/1750 train_loss:3.4949 train_time:644659ms step_avg:370.92ms
step:1749/1750 train_loss:3.2249 train_time:645056ms step_avg:370.94ms
step:1750/1750 train_loss:3.2812 train_time:645464ms step_avg:370.96ms
step:1750/1750 val_loss:3.2763 train_time:645580ms step_avg:371.02ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.16684 | frobenius_norm = 68382.24219 | spectral_norm = 12164.29883 | nuclear_norm = 1725583.37500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 189.93834 | spectral_norm = 38.87524 | nuclear_norm = 4345.83984
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 185.51530 | spectral_norm = 41.57304 | nuclear_norm = 4216.12891
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 356.94565 | spectral_norm = 23.36252 | nuclear_norm = 8742.06836
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 246.03978 | spectral_norm = 26.19146 | nuclear_norm = 5639.29248
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 423.49805 | spectral_norm = 37.11436 | nuclear_norm = 11271.63867
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 212.56158 | spectral_norm = 20.13839 | nuclear_norm = 5620.96680
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 194.13710 | spectral_norm = 20.11289 | nuclear_norm = 4441.74707
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 191.17787 | spectral_norm = 19.48586 | nuclear_norm = 4392.82471
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 332.87057 | spectral_norm = 30.21420 | nuclear_norm = 7640.81934
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 336.61914 | spectral_norm = 26.59165 | nuclear_norm = 7889.04297
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 417.27768 | spectral_norm = 30.37460 | nuclear_norm = 11118.71680
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 205.17697 | spectral_norm = 22.19243 | nuclear_norm = 5393.35938
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 188.71245 | spectral_norm = 18.66931 | nuclear_norm = 4186.61523
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 187.84126 | spectral_norm = 17.29868 | nuclear_norm = 4191.06641
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 368.10406 | spectral_norm = 33.98734 | nuclear_norm = 8391.63770
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 366.62762 | spectral_norm = 28.95629 | nuclear_norm = 8648.42969
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 416.51880 | spectral_norm = 36.22496 | nuclear_norm = 11088.86133
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 210.36400 | spectral_norm = 22.06907 | nuclear_norm = 5537.74512
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 188.32385 | spectral_norm = 20.10193 | nuclear_norm = 4229.33789
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 186.63028 | spectral_norm = 19.01403 | nuclear_norm = 4202.28174
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 377.15982 | spectral_norm = 31.77071 | nuclear_norm = 8645.39648
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 379.47827 | spectral_norm = 30.10187 | nuclear_norm = 8899.11230
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 426.30612 | spectral_norm = 39.60236 | nuclear_norm = 11341.96777
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 207.77905 | spectral_norm = 20.61311 | nuclear_norm = 5461.26221
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 190.11748 | spectral_norm = 20.50727 | nuclear_norm = 4318.83447
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 188.31999 | spectral_norm = 19.17023 | nuclear_norm = 4329.23730
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 385.24792 | spectral_norm = 32.88194 | nuclear_norm = 8780.72656
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 384.48947 | spectral_norm = 30.67481 | nuclear_norm = 8959.08789
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 424.80786 | spectral_norm = 39.26676 | nuclear_norm = 11292.36523
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 207.30493 | spectral_norm = 21.42536 | nuclear_norm = 5422.45703
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 187.50313 | spectral_norm = 19.94330 | nuclear_norm = 4215.40234
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 185.41414 | spectral_norm = 18.23172 | nuclear_norm = 4177.39746
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 371.07135 | spectral_norm = 31.67737 | nuclear_norm = 8477.09570
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 372.29395 | spectral_norm = 28.26142 | nuclear_norm = 8675.64844
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 443.01715 | spectral_norm = 37.08584 | nuclear_norm = 11752.02539
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 209.55722 | spectral_norm = 22.44619 | nuclear_norm = 5496.44678
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 185.38783 | spectral_norm = 19.87890 | nuclear_norm = 4115.41846
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 183.59737 | spectral_norm = 17.97581 | nuclear_norm = 4102.67676
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 381.33524 | spectral_norm = 35.76646 | nuclear_norm = 8542.24902
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 365.58472 | spectral_norm = 28.13657 | nuclear_norm = 8540.29395
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 436.62143 | spectral_norm = 34.82165 | nuclear_norm = 11599.19922
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 213.51825 | spectral_norm = 23.68001 | nuclear_norm = 5619.67578
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 191.36940 | spectral_norm = 18.76577 | nuclear_norm = 4244.46191
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 191.97552 | spectral_norm = 17.78325 | nuclear_norm = 4243.12354
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 400.44962 | spectral_norm = 39.14046 | nuclear_norm = 9024.62695
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 393.21036 | spectral_norm = 28.74589 | nuclear_norm = 9259.21680
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 426.06262 | spectral_norm = 39.55849 | nuclear_norm = 11295.28906
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 216.37080 | spectral_norm = 23.15993 | nuclear_norm = 5712.32031
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 190.72729 | spectral_norm = 20.07132 | nuclear_norm = 4209.24805
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 191.32451 | spectral_norm = 18.97086 | nuclear_norm = 4220.95752
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 394.06155 | spectral_norm = 37.69985 | nuclear_norm = 8872.49316
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 383.20059 | spectral_norm = 28.78933 | nuclear_norm = 8941.65527
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 429.25574 | spectral_norm = 38.53279 | nuclear_norm = 11390.35254
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 219.55644 | spectral_norm = 23.38838 | nuclear_norm = 5816.32373
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 193.43150 | spectral_norm = 22.29356 | nuclear_norm = 4292.80469
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 193.53236 | spectral_norm = 20.00927 | nuclear_norm = 4272.69775
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 392.93900 | spectral_norm = 40.14389 | nuclear_norm = 8845.83008
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 383.71198 | spectral_norm = 28.70265 | nuclear_norm = 8976.02734
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 436.18811 | spectral_norm = 38.94225 | nuclear_norm = 11579.34668
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 222.08894 | spectral_norm = 24.39994 | nuclear_norm = 5896.06934
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 193.26492 | spectral_norm = 25.25832 | nuclear_norm = 4223.69531
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 187.74832 | spectral_norm = 24.83260 | nuclear_norm = 4071.65503
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 392.15176 | spectral_norm = 36.28676 | nuclear_norm = 9002.03906
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 396.47784 | spectral_norm = 27.75767 | nuclear_norm = 9354.30371
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 441.02304 | spectral_norm = 35.31481 | nuclear_norm = 11760.28320
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 210.44263 | spectral_norm = 26.68874 | nuclear_norm = 5561.81104
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 194.23093 | spectral_norm = 22.45490 | nuclear_norm = 4318.80469
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 194.81728 | spectral_norm = 21.90443 | nuclear_norm = 4323.69775
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 353.59253 | spectral_norm = 40.47643 | nuclear_norm = 7943.51367
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 382.60318 | spectral_norm = 29.98186 | nuclear_norm = 8885.98828
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 459.82022 | spectral_norm = 37.59598 | nuclear_norm = 12214.37500
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 216.98299 | spectral_norm = 27.50505 | nuclear_norm = 5697.27637
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1323.73840 | spectral_norm = 189.50356 | nuclear_norm = 35008.18750
===========================================

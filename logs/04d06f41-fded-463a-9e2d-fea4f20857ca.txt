====================================================================================================
import os
import sys
with open(sys.argv[0]) as f:
    code = f.read() # read the code of this file ASAP, for logging
import uuid
import glob
import time
from dataclasses import dataclass

import numpy as np
import torch
from torch import nn
import torch.nn.functional as F
import torch.distributed as dist
import torch._inductor.config as config
from torch.nn.parallel import DistributedDataParallel as DDP
# Use of FlexAttention contributed by @KoszarskyB
from torch.nn.attention.flex_attention import flex_attention, create_block_mask, BlockMask, _score_mod_signature
from torch._inductor.lowering import make_pointwise, register_lowering
# Some internal torch.compile details
from torch._inductor.virtualized import ops
from functools import partial
flex_attention = torch.compile(flex_attention, dynamic=False)
create_block_mask = torch.compile(create_block_mask, dynamic=False)

# -----------------------------------------------------------------------------
# Muon optimizer

def zeropower_via_svd(G, steps=None):
    U, S, V = G.svd()
    return U @ V.T

@torch.compile
def zeropower_via_newtonschulz5(G, steps=10, eps=1e-7):
    """
    Newton-Schulz iteration to compute the zeroth power / orthogonalization of G. We opt to use a
    quintic iteration whose coefficients are selected to maximize the slope at zero. For the purpose
    of minimizing steps, it turns out to be empirically effective to keep increasing the slope at
    zero even beyond the point where the iteration no longer converges all the way to one everywhere
    on the interval. This iteration therefore does not produce UV^T but rather something like US'V^T
    where S' is diagonal with S_{ii}' ~ Uniform(0.5, 1.5), which turns out not to hurt model
    performance at all relative to UV^T, where USV^T = G is the SVD.
    """
    assert len(G.shape) == 2
    a, b, c = (3.4445, -4.7750,  2.0315)
    X = G.bfloat16()
    X /= (X.norm() + eps) # ensure top singular value <= 1
    if G.size(0) > G.size(1):
        X = X.T
    for _ in range(steps):
        A = X @ X.T
        B = b * A + c * A @ A # adapted from suggestion by @jxbz, @leloykun, and @YouJiacheng
        X = a * X + B @ X
    if G.size(0) > G.size(1):
        X = X.T
    return X

zeropower_backends = dict(svd=zeropower_via_svd, newtonschulz5=zeropower_via_newtonschulz5)

class Muon(torch.optim.Optimizer):
    """
    Muon - MomentUm Orthogonalized by Newton-schulz

    Muon internally runs standard SGD-momentum, and then performs an orthogonalization post-
    processing step, in which each 2D parameter's update is replaced with the nearest orthogonal
    matrix. To efficiently orthogonalize each update, we use a Newton-Schulz iteration, which has
    the advantage that it can be stably run in bfloat16 on the GPU.

    Some warnings:
    - This optimizer assumes that all parameters passed in are 2D.
    - It should not be used for the embedding layer, the final fully connected layer, or any {0,1}-D
    parameters; those should all be optimized by a standard method (e.g., AdamW).
    - To use it with 4D convolutional filters, it works well to just flatten their last 3 dimensions.
    - We believe it is unlikely to work well for training with small batch size.
    - We believe it may not work well for finetuning pretrained models, but we haven't tested this.
    - We have not yet tried this optimizer for training scenarios larger than NanoGPT (124M).

    Arguments:
        lr: The learning rate used by the internal SGD.
        momentum: The momentum used by the internal SGD.
        nesterov: Whether to use Nesterov-style momentum in the internal SGD. (recommended)
        backend: The chosen backend for the orthogonalization step. (recommended: 'newtonschulz5')
        backend_steps: The number of iteration steps to use in the backend, if it is iterative.
    """
    def __init__(self, params, lr=0.02, momentum=0.95, nesterov=True,
                 backend='newtonschulz5', backend_steps=5):
        defaults = dict(lr=lr, momentum=momentum, nesterov=nesterov, backend=backend, backend_steps=backend_steps)
        super().__init__(params, defaults)

    def step(self):

        for group in self.param_groups:

            lr = group['lr']
            momentum = group['momentum']
            zeropower_backend = zeropower_backends[group['backend']]

            # generate weight updates in distributed fashion
            total_params = sum(p.numel() for p in group['params'])
            updates_flat = torch.zeros(total_params, device='cuda', dtype=torch.bfloat16)
            curr_idx = 0
            for i, p in enumerate(group['params']):
                # luckily this will perfectly distribute a transformer with multiple of 4 layers to 8 GPUs
                if i % int(os.environ['WORLD_SIZE']) == int(os.environ['RANK']):
                    g = p.grad
                    assert g is not None
                    state = self.state[p]
                    if 'momentum_buffer' not in state:
                        state['momentum_buffer'] = torch.zeros_like(g)
                    buf = state['momentum_buffer']
                    buf.mul_(momentum).add_(g)
                    if group['nesterov']:
                        g = g.add(buf, alpha=momentum)
                    g = zeropower_backend(g, steps=group['backend_steps'])
                    g *= max(1, g.size(0)/g.size(1))**0.5
                    updates_flat[curr_idx:curr_idx+p.numel()] = g.flatten()
                curr_idx += p.numel()

            # sync updates across devices. we are not memory-constrained so can do this simple deserialization
            dist.all_reduce(updates_flat, op=dist.ReduceOp.SUM)

            # deserialize and apply updates
            curr_idx = 0
            for p in group['params']:
                g = updates_flat[curr_idx:curr_idx+p.numel()].view_as(p.data).type_as(p.data)
                p.data.add_(g, alpha=-lr)
                curr_idx += p.numel()

# -----------------------------------------------------------------------------
# Attention Tanh softcapping

@torch.library.custom_op("approx::tanh", mutates_args=())
def _tanh_approx(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

@_tanh_approx.register_fake
def _(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

def _tanh_approx_lowering(inp):
    fn = partial(ops.inline_asm_elementwise, asm="tanh.approx.f32 $0, $1;")
    return make_pointwise(fn)(inp)

register_lowering(torch.ops.approx.tanh)(_tanh_approx_lowering)

class _TanhApprox(torch.autograd.Function):
    @staticmethod
    def forward(x):
        return torch.ops.approx.tanh(x)

    @staticmethod
    def setup_context(ctx, inputs, output):
        (x,) = inputs
        result = output
        ctx.save_for_backward(result)

    @staticmethod
    def backward(ctx, grad_output):
        (result,) = ctx.saved_tensors
        return grad_output * (1 - result * result)

    @staticmethod
    def vmap(info, in_dims, x):
        return torch.tanh(x), 0

_tanh_approx = _TanhApprox.apply

def generate_tanh_softcap(soft_cap: int, approx: bool=True) -> _score_mod_signature:
    tanh = _tanh_approx if approx else torch.tanh

    def tanh_softcap(score, b, h, q_idx, kv_idx):
        return soft_cap * tanh(score / soft_cap)

    prefix = "tanh_softcap_approx" if approx else "tanh_softcap"
    tanh_softcap.__name__ = f"{prefix}_{soft_cap}"

    return tanh_softcap

# -----------------------------------------------------------------------------
# PyTorch nn.Module definitions for the GPT-2 model

class Rotary(torch.nn.Module):

    def __init__(self, dim, base=10000):
        super().__init__()
        self.dim = dim
        self.base = base
        self.inv_freq = None
        self.seq_len_cached = None
        self.cos_cached = None
        self.sin_cached = None

    def forward(self, x):
        seq_len = x.shape[1]
        if seq_len != self.seq_len_cached:
            self.inv_freq = 1.0 / (self.base ** (torch.arange(0, self.dim, 2, device=x.device).float() / self.dim))
            self.seq_len_cached = seq_len
            t = torch.arange(seq_len, device=x.device).type_as(self.inv_freq)
            freqs = torch.outer(t, self.inv_freq)
            self.cos_cached = freqs.cos().bfloat16()
            self.sin_cached = freqs.sin().bfloat16()
        return self.cos_cached[None, :, None, :], self.sin_cached[None, :, None, :]

def apply_rotary_emb(x, cos, sin):
    assert x.ndim == 4 # multihead attention
    d = x.shape[3]//2
    x1 = x[..., :d]
    x2 = x[..., d:]
    y1 = x1 * cos + x2 * sin
    y2 = x1 * (-sin) + x2 * cos
    return torch.cat([y1, y2], 3).type_as(x)

class CastedLinear(nn.Linear):
    def forward(self, x):
        return F.linear(x, self.weight.to(x.dtype))

class CausalSelfAttention(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.n_head = config.n_head
        self.n_embd = config.n_embd
        self.head_dim = self.n_embd // self.n_head
        assert self.n_embd % self.n_head == 0
        self.c_q = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_k = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_v = CastedLinear(self.n_embd, self.n_embd, bias=False)
        # output projection
        self.c_proj = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977
        self.rotary = Rotary(self.head_dim)
        self.lamb = nn.Parameter(torch.tensor(0.5)) # @Grad62304977

    def forward(self, x, v1, block_mask: BlockMask, score_mod: _score_mod_signature):
        B, T, C = x.size() # batch size, sequence length, embedding dimensionality (n_embd)
        q = self.c_q(x).view(B, T, self.n_head, self.head_dim)
        k = self.c_k(x).view(B, T, self.n_head, self.head_dim)
        v = self.c_v(x).view(B, T, self.n_head, self.head_dim)
        if v1 is None:
            v1 = v # This happens if we are in the first block. v needs to be accessed by subsequent blocks
        v = (1 - self.lamb) * v + self.lamb * v1.view_as(v) # @Grad62304977
        cos, sin = self.rotary(q)
        q, k = F.rms_norm(q, (q.size(-1),)), F.rms_norm(k, (k.size(-1),)) # QK norm suggested by @Grad62304977
        q, k = apply_rotary_emb(q, cos, sin), apply_rotary_emb(k, cos, sin)
        y = flex_attention(q.transpose(1, 2), k.transpose(1, 2), v.transpose(1, 2), score_mod=score_mod, block_mask=block_mask)
        y = y.transpose(1, 2).contiguous().view_as(x) # re-assemble all head outputs side by side
        y = self.c_proj(y)
        return y, v1

class MLP(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.c_fc    = CastedLinear(config.n_embd, 4 * config.n_embd, bias=False)
        self.c_proj  = CastedLinear(4 * config.n_embd, config.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977

    def forward(self, x):
        x = self.c_fc(x)
        x = F.relu(x).square() # https://arxiv.org/abs/2109.08668v2; ~1-2% better than GELU; suggested by @SKYLINEZ007 and @Grad62304977
        x = self.c_proj(x)
        return x

class Block(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.attn = CausalSelfAttention(config)
        self.mlp = MLP(config)
        self.lambdas = nn.Parameter(torch.tensor([1., 0.]))

    def forward(self, x, v1, x0, block_mask: BlockMask, score_mod: _score_mod_signature):
        x = self.lambdas[0] * x + self.lambdas[1] * x0
        x1, v1 = self.attn(F.rms_norm(x, (x.size(-1),)), v1, block_mask, score_mod)
        x = x + x1
        x = x + self.mlp(F.rms_norm(x, (x.size(-1),)))
        return x, v1

# -----------------------------------------------------------------------------
# The main GPT-2 model

@dataclass
class GPTConfig:
    vocab_size : int = 50304
    n_layer : int = 12
    n_head : int = 6 # head dim 128 suggested by @Grad62304977
    n_embd : int = 768
    attention_soft_cap : int = 50
    lm_head_soft_cap : int = 30

class GPT(nn.Module):

    def __init__(self, config: GPTConfig):
        super().__init__()
        self.attention_soft_cap = config.attention_soft_cap
        self.lm_head_soft_cap = config.lm_head_soft_cap

        # U-net design by @brendanh0gan
        self.num_encoder_layers = config.n_layer // 2 # Half of the layers for encoder
        self.num_decoder_layers = config.n_layer - self.num_encoder_layers # Remaining for decoder
        # Add learnable skip connection weights for decoder layers
        self.skip_weights = nn.Parameter(torch.ones(self.num_decoder_layers))

        self.transformer = nn.ModuleDict(dict(
            wte = nn.Embedding(config.vocab_size, config.n_embd),
            h = nn.ModuleList([Block(config) for _ in range(config.n_layer)]),
        ))
        self.lm_head = CastedLinear(config.n_embd, config.vocab_size, bias=False)
        self.lm_head.weight.data.zero_() # @Grad62304977

    def forward(self, idx, target, attn_blocksize: int):

        docs = (idx == 50256).cumsum(0)
        def document_causal_mask(b, h, q_idx, kv_idx):
            causal_mask = q_idx >= kv_idx
            document_mask = docs[q_idx] == docs[kv_idx]
            window_mask = q_idx - kv_idx < attn_blocksize
            return causal_mask & document_mask & window_mask

        softcap_mod = generate_tanh_softcap(self.attention_soft_cap, approx=True)  # @leloykun

        S = len(idx)
        block_mask = create_block_mask(document_causal_mask, None, None, S, S, device="cuda", _compile=True)

        # forward the GPT model itself
        x = self.transformer.wte(idx[None]) # token embeddings of shape (b, t, n_embd)
        x = F.rms_norm(x, (x.size(-1),)) # @Grad62304977
        x0 = x
        v1 = None

        # Store outputs for U-Net skip connections
        skip_connections = []
        # Encoder pass - process only the first half of the blocks
        for i in range(self.num_encoder_layers):
            x, v1 = self.transformer.h[i](x, v1, x0, block_mask, softcap_mod)
            skip_connections.append(x)
        # Decoder pass - process the remaining blocks with weighted skip connections
        for i in range(self.num_decoder_layers):
            x = x + self.skip_weights[i] * skip_connections.pop()
            x, v1 = self.transformer.h[self.num_encoder_layers + i](x, v1, x0, block_mask, softcap_mod)

        x = F.rms_norm(x, (x.size(-1),))
        logits = self.lm_head(x)
        logits = self.lm_head_soft_cap * torch.tanh(logits / self.lm_head_soft_cap) # @Grad62304977
        logits = logits.float()
        loss = F.cross_entropy(logits.view(-1, logits.size(-1)), target.view(-1))
        return loss

# -----------------------------------------------------------------------------
# Our own simple Distributed Data Loader

def _peek_data_shard(filename):
    # only reads the header, returns header data
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
    if header[0] != 20240520:
        print("ERROR: magic number mismatch in the data .bin file!")
        print("---> HINT: Are you passing in a correct file with --input_bin?")
        print("---> HINT: Dataset encoding changed recently, re-run data prepro or refer again to README")
        print("---> HINT: For example re-run: `python dev/data/tinyshakespeare.py`, then re-try")
        exit(1)
    assert header[1] == 1, "unsupported version"
    ntok = header[2] # number of tokens (claimed)
    return ntok # for now just return the number of tokens

def _load_data_shard(filename):
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
        assert header[0] == 20240520, "magic number mismatch in the data .bin file"
        assert header[1] == 1, "unsupported version"
        ntok = header[2] # number of tokens (claimed)
        # the rest of it are tokens, stored as uint16
        tokens = np.frombuffer(f.read(), dtype=np.uint16)
    assert len(tokens) == ntok, "number of tokens read does not match header?"
    return tokens

class DistributedDataLoader:
    def __init__(self, filename_pattern, B, T, process_rank, num_processes):
        self.process_rank = process_rank
        self.num_processes = num_processes
        self.B = B
        self.T = T

        # glob files that match the pattern
        self.files = sorted(glob.glob(filename_pattern))
        assert len(self.files) > 0, f"did not find any files that match the pattern {filename_pattern}"

        # load and validate all data shards, count number of tokens in total
        ntok_total = 0
        for fname in self.files:
            shard_ntok = _peek_data_shard(fname)
            assert shard_ntok >= num_processes * B * T + 1
            ntok_total += int(shard_ntok)
        self.ntok_total = ntok_total

        self.reset()

    def reset(self):
        self.current_shard = -1
        self.advance()

    def advance(self): # advance to next data shard
        self.current_shard = (self.current_shard + 1) % len(self.files)
        self.current_position = self.process_rank * self.B * self.T
        self.tokens = _load_data_shard(self.files[self.current_shard])

    def next_batch(self):
        batch_size = self.B * self.T * self.num_processes
        buf = self.tokens[self.current_position:self.current_position+self.B*self.T+1]
        buf = torch.tensor(buf.astype(np.int32), dtype=torch.long)
        x = buf[:-1] # inputs
        y = buf[1:] # targets
        # advance current position and load next shard if necessary
        self.current_position += batch_size
        if self.current_position + batch_size >= len(self.tokens):
            self.advance()
        return x.cuda(), y.cuda()

# -----------------------------------------------------------------------------
# int main

@dataclass
class Hyperparameters:
    # data hyperparams
    input_bin : str = 'data/fineweb10B/fineweb_train_*.bin' # input .bin to train on
    input_val_bin : str = 'data/fineweb10B/fineweb_val_*.bin' # input .bin to eval validation loss on
    # optimization hyperparams
    batch_size : int = 8 # batch size, in sequences, across all devices
    device_batch_size : int = 1 # batch size, in sequences, per device
    sequence_length : int = 64*1024 # sequence length, in tokens
    num_iterations : int = 1750 # number of iterations to run
    warmup_iters : int = 0
    cooldown_iters : int = 640 # number of iterations of linear warmup/cooldown for triangular or trapezoidal schedule
    block_size_warmup_iters = 1000
    weight_decay : float = 0
    # evaluation and logging hyperparams
    val_loss_every : int = 125 # every how many steps to evaluate val loss? 0 for only at the end
    val_tokens : int = 10485760 # how many tokens of validation data? it's important to keep this fixed for consistent comparisons
    save_every : int = 0 # every how many steps to save the checkpoint? 0 for only at the end
args = Hyperparameters()

# set up DDP (distributed data parallel). torchrun sets this env variable
assert torch.cuda.is_available()
dist.init_process_group(backend='nccl')
ddp_rank = int(os.environ['RANK'])
ddp_local_rank = int(os.environ['LOCAL_RANK'])
ddp_world_size = int(os.environ['WORLD_SIZE'])
device = f'cuda:{ddp_local_rank}'
torch.cuda.set_device(device)
print(f"using device: {device}")
master_process = (ddp_rank == 0) # this process will do logging, checkpointing etc.

# begin logging
logfile = None
if master_process:
    run_id = str(uuid.uuid4())
    logdir = 'logs/%s/' % run_id
    os.makedirs(logdir, exist_ok=True)
    logfile = 'logs/%s.txt' % run_id
    # create the log file
    with open(logfile, "w") as f:
        # begin the log by printing this file (the Python code)
        f.write('='*100 + '\n')
        f.write(code)
        f.write('='*100 + '\n')
def print0(s, logonly=False):
    if master_process:
        with open(logfile, "a") as f:
            if not logonly:
                print(s)
            f.write(s+'\n')
# log information about the hardware/software environment this is running on
# and print the full `nvidia-smi` to file
print0(f"Running pytorch {torch.version.__version__} compiled for CUDA {torch.version.cuda}\nnvidia-smi:")
import subprocess
result = subprocess.run(['nvidia-smi'], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
print0(f'{result.stdout}', logonly=True)
print0('='*100, logonly=True)

# convenience variables
B, T = args.device_batch_size, args.sequence_length
# calculate the number of steps to take in the val loop.
assert args.val_tokens % (B * T * ddp_world_size) == 0
val_steps = args.val_tokens // (B * T * ddp_world_size)
# calculate the steps of gradient accumulation required to attain the desired global batch size.
assert args.batch_size % (B * ddp_world_size) == 0
train_accumulation_steps = args.batch_size // (B * ddp_world_size)

# load tokens
train_loader = DistributedDataLoader(args.input_bin, B, T, ddp_rank, ddp_world_size)
val_loader = DistributedDataLoader(args.input_val_bin, B, T, ddp_rank, ddp_world_size)
print0(f"Training DataLoader: total number of tokens: {train_loader.ntok_total} across {len(train_loader.files)} files")
print0(f"Validation DataLoader: total number of tokens: {val_loader.ntok_total} across {len(val_loader.files)} files")
print0('='*100, logonly=True)
x, y = train_loader.next_batch()

# there are only 50257 unique GPT-2 tokens; we extend to nearest multiple of 128 for efficiency. suggested to me by @Grad62304977.
# this originates from Karpathy's experiments.
num_vocab = 50304
model = GPT(GPTConfig(vocab_size=num_vocab, n_layer=12, n_head=6, n_embd=768))
model = model.cuda().bfloat16()
for m in model.modules():
    if isinstance(m, CastedLinear):
        m.float()
if hasattr(config, "coordinate_descent_tuning"):
    config.coordinate_descent_tuning = True # suggested by @Chillee
model = torch.compile(model)
# here we wrap model into DDP container
model = DDP(model, device_ids=[ddp_local_rank])
raw_model = model.module # always contains the "raw" unwrapped model

# CUDNN attention is ~4ms faster than Flash, but doesn't get selected by default in PyTorch 2.5.1
from torch.backends.cuda import enable_cudnn_sdp, enable_flash_sdp, enable_math_sdp, enable_mem_efficient_sdp
enable_cudnn_sdp(True)
enable_flash_sdp(False)
enable_mem_efficient_sdp(False)
enable_math_sdp(False)

# init the optimizer(s)
optimizer1 = torch.optim.Adam([raw_model.transformer.wte.weight], lr=0.6,   betas=(0.8, 0.95), fused=True)
optimizer2 = torch.optim.Adam([raw_model.lm_head.weight],         lr=0.008, betas=(0.8, 0.95), fused=True)
param_names = [name for name, _ in raw_model.named_parameters()]
params = list(raw_model.transformer.h.parameters())
qk_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and ("c_q" in n or "c_k" in n)]
matrix_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and "c_q" not in n and "c_k" not in n]
scalar_params = [p for p in params if p.ndim < 2] + [raw_model.skip_weights]
optimizer5 = Muon(qk_params, lr=0.08, momentum=0.95)
optimizer3 = Muon(matrix_params, lr=0.05, momentum=0.95)
optimizer4 = torch.optim.Adam(scalar_params, lr=0.04, betas=(0.8, 0.95), fused=True) # note that this learning rate is neither sensitive nor tuned
optimizers = [optimizer1, optimizer2, optimizer3, optimizer4, optimizer5]
# learning rate decay scheduler (linear warmup and cooldown)
def get_lr(it):
    assert it <= args.num_iterations
    # 1) linear warmup for warmup_iters steps
    if it < args.warmup_iters:
        return (it+1) / args.warmup_iters
    # 2) constant lr for a while
    elif it < args.num_iterations - args.cooldown_iters:
        return 1.0
    # 3) linear cooldown
    else:
        decay_ratio = (args.num_iterations - it) / args.cooldown_iters
        return decay_ratio
schedulers = [torch.optim.lr_scheduler.LambdaLR(opt, get_lr) for opt in optimizers]

# Start training loop
training_time_ms = 0
# start the clock
torch.cuda.synchronize()
t0 = time.time()
# begin training
for step in range(args.num_iterations + 1):
    last_step = (step == args.num_iterations)
    # Set the attention blocksize for the current step, in chunks of 64
    attn_blocksize = torch.tensor(64*((min(step/args.block_size_warmup_iters, 1) * (1792 - 64) + 64)//64), dtype=torch.int, device='cuda')
    # This effectively ignores timing first 10 steps, which are slower for weird reasons.
    # Alternately, and slightly more correctly in terms of benchmarking, we could do 10
    # steps with dummy data first, and then re-initialize the model and reset the loader.
    if step == 10:
        training_time_ms = 0
        t0 = time.time()
    timed_steps = float('nan') if step <= 11 else (step - 10) + 1 # <= 11 to avoid bug in val

    # once in a while evaluate the validation dataset
    if (last_step or (args.val_loss_every > 0 and step % args.val_loss_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # run validation batches
        model.eval()
        val_loader.reset()
        val_loss = 0.0
        for _ in range(val_steps):
            with torch.no_grad():
                x_val, y_val = val_loader.next_batch()
                val_loss += model(x_val, y_val, attn_blocksize=attn_blocksize)
        dist.all_reduce(val_loss, op=dist.ReduceOp.AVG)
        val_loss /= val_steps
        # log val loss to console and to logfile
        print0(f'step:{step}/{args.num_iterations} val_loss:{val_loss:.4f} train_time:{training_time_ms:.0f}ms step_avg:{training_time_ms/(timed_steps-1):.2f}ms')
        if master_process:
            print("============== Weight norms: ==============")
            with open(logfile, "a") as f:
                f.write("============== Weight norms: ==============\n")
                for name, p in model.named_parameters():
                    if p.ndim != 2:
                        continue
                    if "transformer.wte" in name:
                        l1_to_l2_norm = torch.norm(p.data.float(), p=2, dim=1).mean().item()
                    frobenius_norm = torch.linalg.norm(p.data.float(), ord='fro').item()
                    spectral_norm = torch.linalg.matrix_norm(p.data.float(), ord=2).item()
                    nuclear_norm = torch.linalg.matrix_norm(p.data.float(), ord="nuc").item()
                    if "transformer.wte" in name:
                        print(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                    else:
                        print(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                f.write("===========================================\n")
            print("===========================================")
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    if master_process and (last_step or (args.save_every > 0 and step % args.save_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # save the state of the training process
        log = dict(step=step, code=code, model=raw_model.state_dict(), optimizers=[opt.state_dict() for opt in optimizers])
        torch.save(log, 'logs/%s/state_step%06d.pt' % (run_id, step))
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    # bit confusing: we want to make sure to eval on 0th iteration
    # but also after the very last iteration. so we loop for step <= num_iterations
    # instead of just < num_iterations (one extra due to <=), only to do
    # the validation/sampling one last time, and then we break right here as we're done.
    if last_step:
        break

    # --------------- TRAINING SECTION BEGIN -----------------
    model.train()
    for i in range(1, train_accumulation_steps+1):
        # forward pass
        loss = model(x, y, attn_blocksize=attn_blocksize)
        train_loss = loss.detach()
        # advance the dataset for the next batch
        x, y = train_loader.next_batch()
        # backward pass
        if i < train_accumulation_steps:
            with model.no_sync(): # there's no need to sync gradients every accumulation step
                loss.backward()
        else:
            loss.backward() # just sync on the last step
    for name, p in model.named_parameters():
        p.grad /= train_accumulation_steps
    # momentum warmup for Muon
    frac = min(step/300, 1)
    optimizer3.param_groups[0]['momentum'] = (1 - frac) * 0.85 + frac * 0.95
    # step the optimizers and schedulers
    for opt, sched in zip(optimizers, schedulers):
        opt.step()
        sched.step()
    # null the gradients
    model.zero_grad(set_to_none=True)
    # --------------- TRAINING SECTION END -------------------
    # everything that follows now is just diagnostics, prints, logging, etc.

    #dist.all_reduce(train_loss, op=dist.ReduceOp.AVG) # all-reducing the training loss would be more correct in terms of logging, but slower
    approx_time = training_time_ms + 1000 * (time.time() - t0)
    print0(f"step:{step+1}/{args.num_iterations} train_loss:{train_loss.item():.4f} train_time:{approx_time:.0f}ms step_avg:{approx_time/timed_steps:.2f}ms")

if master_process:
    print(f"peak memory consumption: {torch.cuda.max_memory_allocated() // 1024 // 1024} MiB")

# -------------------------------------------------------------------------
# clean up nice
dist.destroy_process_group()
====================================================================================================
Running pytorch 2.6.0.dev20241125+cu124 compiled for CUDA 12.4
nvidia-smi:
Tue Nov 26 00:02:16 2024       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:07:00.0 Off |                    0 |
| N/A   30C    P0             62W /  400W |       4MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:4E:00.0 Off |                    0 |
| N/A   30C    P0             69W /  400W |   32924MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:87:00.0 Off |                    0 |
| N/A   34C    P0             69W /  400W |      21MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:90:00.0 Off |                    0 |
| N/A   33C    P0             68W /  400W |      21MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
+-----------------------------------------------------------------------------------------+

====================================================================================================
Training DataLoader: total number of tokens: 1200000000 across 12 files
Validation DataLoader: total number of tokens: 100000000 across 1 files
====================================================================================================
step:0/1750 val_loss:10.8258 train_time:0ms step_avg:nanms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 27.70308 | frobenius_norm = 6215.42969 | spectral_norm = 251.84871 | nuclear_norm = 171940.53125
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 16.02109 | spectral_norm = 1.15274 | nuclear_norm = 376.87738
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 16.00379 | spectral_norm = 1.13937 | nuclear_norm = 376.34747
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 15.99738 | spectral_norm = 1.14753 | nuclear_norm = 376.41965
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 31.99940 | spectral_norm = 1.72882 | nuclear_norm = 858.24060
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 15.98145 | spectral_norm = 1.14277 | nuclear_norm = 376.05560
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 15.99565 | spectral_norm = 1.14080 | nuclear_norm = 376.10095
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 16.01684 | spectral_norm = 1.14364 | nuclear_norm = 376.85992
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 32.01658 | spectral_norm = 1.72613 | nuclear_norm = 858.71967
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 15.98995 | spectral_norm = 1.15226 | nuclear_norm = 376.09119
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 16.00005 | spectral_norm = 1.14441 | nuclear_norm = 376.47046
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 15.99235 | spectral_norm = 1.14895 | nuclear_norm = 376.32925
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 31.99576 | spectral_norm = 1.72789 | nuclear_norm = 858.11719
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 16.01898 | spectral_norm = 1.15378 | nuclear_norm = 376.71069
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 16.02097 | spectral_norm = 1.15694 | nuclear_norm = 376.92200
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 16.00303 | spectral_norm = 1.15401 | nuclear_norm = 376.53748
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 31.97913 | spectral_norm = 1.73146 | nuclear_norm = 857.74829
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 15.98694 | spectral_norm = 1.14747 | nuclear_norm = 376.11255
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 15.99871 | spectral_norm = 1.14023 | nuclear_norm = 376.36890
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 15.99714 | spectral_norm = 1.14164 | nuclear_norm = 376.12952
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 32.00703 | spectral_norm = 1.72144 | nuclear_norm = 858.44116
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 15.98931 | spectral_norm = 1.14469 | nuclear_norm = 375.79575
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 16.00724 | spectral_norm = 1.15159 | nuclear_norm = 376.64215
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 15.99500 | spectral_norm = 1.14781 | nuclear_norm = 376.04358
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 31.99739 | spectral_norm = 1.72548 | nuclear_norm = 858.27155
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 16.00332 | spectral_norm = 1.14139 | nuclear_norm = 376.62708
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 16.01240 | spectral_norm = 1.14624 | nuclear_norm = 376.74063
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 16.01101 | spectral_norm = 1.14512 | nuclear_norm = 376.64365
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 31.99084 | spectral_norm = 1.72896 | nuclear_norm = 858.04382
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 16.00448 | spectral_norm = 1.14994 | nuclear_norm = 376.45193
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 16.00533 | spectral_norm = 1.14552 | nuclear_norm = 376.42038
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 15.99609 | spectral_norm = 1.15745 | nuclear_norm = 376.27335
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 32.01400 | spectral_norm = 1.71812 | nuclear_norm = 858.65295
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 15.98948 | spectral_norm = 1.13465 | nuclear_norm = 376.26312
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 16.00620 | spectral_norm = 1.14983 | nuclear_norm = 376.54874
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 15.99583 | spectral_norm = 1.15166 | nuclear_norm = 376.39713
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 31.99838 | spectral_norm = 1.72378 | nuclear_norm = 858.19604
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 16.00364 | spectral_norm = 1.14477 | nuclear_norm = 376.19617
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 16.01256 | spectral_norm = 1.15926 | nuclear_norm = 376.69641
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 15.99361 | spectral_norm = 1.13941 | nuclear_norm = 376.31323
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 31.99801 | spectral_norm = 1.72514 | nuclear_norm = 858.22925
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 16.00746 | spectral_norm = 1.14960 | nuclear_norm = 376.57269
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 16.00059 | spectral_norm = 1.14382 | nuclear_norm = 376.49884
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 15.98465 | spectral_norm = 1.15090 | nuclear_norm = 376.22095
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 31.99956 | spectral_norm = 1.72000 | nuclear_norm = 858.23602
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 15.98926 | spectral_norm = 1.15143 | nuclear_norm = 376.14658
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 15.99697 | spectral_norm = 1.14805 | nuclear_norm = 376.55115
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 15.99647 | spectral_norm = 1.14520 | nuclear_norm = 376.10019
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 32.00571 | spectral_norm = 1.72576 | nuclear_norm = 858.47852
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
===========================================
step:1/1750 train_loss:10.8258 train_time:159799ms step_avg:nanms
step:2/1750 train_loss:10.1130 train_time:168256ms step_avg:nanms
step:3/1750 train_loss:8.3453 train_time:168910ms step_avg:nanms
step:4/1750 train_loss:7.6447 train_time:169563ms step_avg:nanms
step:5/1750 train_loss:7.4783 train_time:170217ms step_avg:nanms
step:6/1750 train_loss:7.0671 train_time:170874ms step_avg:nanms
step:7/1750 train_loss:7.0098 train_time:171528ms step_avg:nanms
step:8/1750 train_loss:6.4479 train_time:172184ms step_avg:nanms
step:9/1750 train_loss:6.7643 train_time:172840ms step_avg:nanms
step:10/1750 train_loss:6.5724 train_time:173497ms step_avg:nanms
step:11/1750 train_loss:6.5179 train_time:645ms step_avg:nanms
step:12/1750 train_loss:6.2867 train_time:1302ms step_avg:nanms
step:13/1750 train_loss:6.2954 train_time:1959ms step_avg:653.10ms
step:14/1750 train_loss:6.2057 train_time:2617ms step_avg:654.21ms
step:15/1750 train_loss:6.2038 train_time:3273ms step_avg:654.62ms
step:16/1750 train_loss:5.9650 train_time:3930ms step_avg:654.95ms
step:17/1750 train_loss:5.9339 train_time:4587ms step_avg:655.23ms
step:18/1750 train_loss:6.5522 train_time:5243ms step_avg:655.42ms
step:19/1750 train_loss:5.9684 train_time:5900ms step_avg:655.57ms
step:20/1750 train_loss:6.0667 train_time:6559ms step_avg:655.89ms
step:21/1750 train_loss:6.0031 train_time:7217ms step_avg:656.08ms
step:22/1750 train_loss:5.7542 train_time:7875ms step_avg:656.21ms
step:23/1750 train_loss:5.8103 train_time:8532ms step_avg:656.32ms
step:24/1750 train_loss:5.8636 train_time:9190ms step_avg:656.43ms
step:25/1750 train_loss:5.6410 train_time:9847ms step_avg:656.46ms
step:26/1750 train_loss:5.7467 train_time:10505ms step_avg:656.55ms
step:27/1750 train_loss:5.6967 train_time:11164ms step_avg:656.69ms
step:28/1750 train_loss:5.6633 train_time:11825ms step_avg:656.94ms
step:29/1750 train_loss:5.7209 train_time:12486ms step_avg:657.17ms
step:30/1750 train_loss:5.7451 train_time:13146ms step_avg:657.29ms
step:31/1750 train_loss:6.0814 train_time:13805ms step_avg:657.38ms
step:32/1750 train_loss:5.5620 train_time:14464ms step_avg:657.46ms
step:33/1750 train_loss:5.4148 train_time:15125ms step_avg:657.63ms
step:34/1750 train_loss:5.4347 train_time:15786ms step_avg:657.77ms
step:35/1750 train_loss:5.6576 train_time:16449ms step_avg:657.95ms
step:36/1750 train_loss:5.5607 train_time:17109ms step_avg:658.02ms
step:37/1750 train_loss:5.5701 train_time:17772ms step_avg:658.21ms
step:38/1750 train_loss:5.3941 train_time:18432ms step_avg:658.29ms
step:39/1750 train_loss:5.4814 train_time:19093ms step_avg:658.38ms
step:40/1750 train_loss:5.2664 train_time:19754ms step_avg:658.47ms
step:41/1750 train_loss:5.4582 train_time:20416ms step_avg:658.59ms
step:42/1750 train_loss:5.3169 train_time:21078ms step_avg:658.68ms
step:43/1750 train_loss:5.3515 train_time:21738ms step_avg:658.73ms
step:44/1750 train_loss:5.2265 train_time:22399ms step_avg:658.80ms
step:45/1750 train_loss:5.1117 train_time:23062ms step_avg:658.90ms
step:46/1750 train_loss:5.2312 train_time:23724ms step_avg:659.00ms
step:47/1750 train_loss:5.1245 train_time:24386ms step_avg:659.08ms
step:48/1750 train_loss:5.2618 train_time:25047ms step_avg:659.13ms
step:49/1750 train_loss:5.1007 train_time:25708ms step_avg:659.18ms
step:50/1750 train_loss:5.1552 train_time:26369ms step_avg:659.22ms
step:51/1750 train_loss:5.1546 train_time:27031ms step_avg:659.28ms
step:52/1750 train_loss:5.2902 train_time:27694ms step_avg:659.38ms
step:53/1750 train_loss:5.0799 train_time:28358ms step_avg:659.50ms
step:54/1750 train_loss:5.1230 train_time:29018ms step_avg:659.49ms
step:55/1750 train_loss:5.0425 train_time:29679ms step_avg:659.53ms
step:56/1750 train_loss:5.0608 train_time:30340ms step_avg:659.57ms
step:57/1750 train_loss:5.0685 train_time:31003ms step_avg:659.63ms
step:58/1750 train_loss:5.1025 train_time:31665ms step_avg:659.68ms
step:59/1750 train_loss:5.1143 train_time:32328ms step_avg:659.76ms
step:60/1750 train_loss:4.9829 train_time:32992ms step_avg:659.84ms
step:61/1750 train_loss:5.0767 train_time:33654ms step_avg:659.89ms
step:62/1750 train_loss:5.0873 train_time:34318ms step_avg:659.96ms
step:63/1750 train_loss:5.0112 train_time:34982ms step_avg:660.05ms
step:64/1750 train_loss:4.9810 train_time:35645ms step_avg:660.09ms
step:65/1750 train_loss:4.8342 train_time:36308ms step_avg:660.15ms
step:66/1750 train_loss:4.8744 train_time:36970ms step_avg:660.18ms
step:67/1750 train_loss:4.9794 train_time:37632ms step_avg:660.21ms
step:68/1750 train_loss:4.9773 train_time:38294ms step_avg:660.24ms
step:69/1750 train_loss:4.9817 train_time:38957ms step_avg:660.28ms
step:70/1750 train_loss:4.8559 train_time:39620ms step_avg:660.33ms
step:71/1750 train_loss:4.9113 train_time:40280ms step_avg:660.33ms
step:72/1750 train_loss:4.9071 train_time:40943ms step_avg:660.37ms
step:73/1750 train_loss:4.8902 train_time:41605ms step_avg:660.40ms
step:74/1750 train_loss:4.7534 train_time:42267ms step_avg:660.42ms
step:75/1750 train_loss:4.7739 train_time:42928ms step_avg:660.42ms
step:76/1750 train_loss:4.6836 train_time:43612ms step_avg:660.79ms
step:77/1750 train_loss:4.8885 train_time:44294ms step_avg:661.11ms
step:78/1750 train_loss:4.8127 train_time:44976ms step_avg:661.41ms
step:79/1750 train_loss:4.5389 train_time:45659ms step_avg:661.72ms
step:80/1750 train_loss:4.8037 train_time:46340ms step_avg:661.99ms
step:81/1750 train_loss:4.7449 train_time:47021ms step_avg:662.26ms
step:82/1750 train_loss:4.7905 train_time:47703ms step_avg:662.55ms
step:83/1750 train_loss:4.7777 train_time:48388ms step_avg:662.85ms
step:84/1750 train_loss:4.6611 train_time:49073ms step_avg:663.15ms
step:85/1750 train_loss:4.6385 train_time:49757ms step_avg:663.42ms
step:86/1750 train_loss:4.7554 train_time:50438ms step_avg:663.66ms
step:87/1750 train_loss:4.7602 train_time:51121ms step_avg:663.90ms
step:88/1750 train_loss:4.6143 train_time:51807ms step_avg:664.19ms
step:89/1750 train_loss:4.6280 train_time:52492ms step_avg:664.46ms
step:90/1750 train_loss:4.5377 train_time:53175ms step_avg:664.69ms
step:91/1750 train_loss:4.6902 train_time:53858ms step_avg:664.91ms
step:92/1750 train_loss:4.6561 train_time:54542ms step_avg:665.14ms
step:93/1750 train_loss:4.7347 train_time:55224ms step_avg:665.35ms
step:94/1750 train_loss:4.8780 train_time:55907ms step_avg:665.56ms
step:95/1750 train_loss:4.6175 train_time:56588ms step_avg:665.74ms
step:96/1750 train_loss:4.5044 train_time:57270ms step_avg:665.93ms
step:97/1750 train_loss:4.6511 train_time:57952ms step_avg:666.11ms
step:98/1750 train_loss:4.5120 train_time:58633ms step_avg:666.29ms
step:99/1750 train_loss:4.5079 train_time:59316ms step_avg:666.48ms
step:100/1750 train_loss:4.5213 train_time:59997ms step_avg:666.63ms
step:101/1750 train_loss:4.3972 train_time:60679ms step_avg:666.80ms
step:102/1750 train_loss:4.5796 train_time:61359ms step_avg:666.95ms
step:103/1750 train_loss:4.5126 train_time:62041ms step_avg:667.11ms
step:104/1750 train_loss:4.5611 train_time:62724ms step_avg:667.28ms
step:105/1750 train_loss:4.5547 train_time:63405ms step_avg:667.42ms
step:106/1750 train_loss:4.7233 train_time:64085ms step_avg:667.55ms
step:107/1750 train_loss:4.5031 train_time:64767ms step_avg:667.70ms
step:108/1750 train_loss:4.3615 train_time:65447ms step_avg:667.83ms
step:109/1750 train_loss:4.7354 train_time:66127ms step_avg:667.95ms
step:110/1750 train_loss:4.5235 train_time:66807ms step_avg:668.07ms
step:111/1750 train_loss:4.4453 train_time:67488ms step_avg:668.20ms
step:112/1750 train_loss:4.6795 train_time:68171ms step_avg:668.34ms
step:113/1750 train_loss:4.3340 train_time:68851ms step_avg:668.45ms
step:114/1750 train_loss:4.5317 train_time:69531ms step_avg:668.57ms
step:115/1750 train_loss:4.4567 train_time:70211ms step_avg:668.68ms
step:116/1750 train_loss:4.4776 train_time:70890ms step_avg:668.77ms
step:117/1750 train_loss:4.2732 train_time:71567ms step_avg:668.85ms
step:118/1750 train_loss:4.5019 train_time:72245ms step_avg:668.94ms
step:119/1750 train_loss:4.3213 train_time:72923ms step_avg:669.01ms
step:120/1750 train_loss:4.4349 train_time:73601ms step_avg:669.10ms
step:121/1750 train_loss:4.4080 train_time:74279ms step_avg:669.18ms
step:122/1750 train_loss:4.2957 train_time:74955ms step_avg:669.25ms
step:123/1750 train_loss:4.3921 train_time:75632ms step_avg:669.31ms
step:124/1750 train_loss:4.2666 train_time:76310ms step_avg:669.39ms
step:125/1750 train_loss:4.2653 train_time:76990ms step_avg:669.47ms
step:125/1750 val_loss:4.3566 train_time:77004ms step_avg:669.60ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 118.70933 | frobenius_norm = 27060.35742 | spectral_norm = 6726.67578 | nuclear_norm = 656701.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 38.29755 | spectral_norm = 3.33196 | nuclear_norm = 901.82214
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 36.91186 | spectral_norm = 4.31632 | nuclear_norm = 867.04120
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 84.62580 | spectral_norm = 5.75241 | nuclear_norm = 1972.53418
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 86.77374 | spectral_norm = 8.79757 | nuclear_norm = 2067.48242
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 76.54092 | spectral_norm = 5.48232 | nuclear_norm = 2033.44751
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 41.35420 | spectral_norm = 2.68676 | nuclear_norm = 1098.91943
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 35.88755 | spectral_norm = 3.10617 | nuclear_norm = 842.73077
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 35.27491 | spectral_norm = 4.06344 | nuclear_norm = 827.73877
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 91.55482 | spectral_norm = 7.55177 | nuclear_norm = 2115.86523
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 95.73421 | spectral_norm = 8.70313 | nuclear_norm = 2284.35767
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 83.94055 | spectral_norm = 5.50498 | nuclear_norm = 2232.43433
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 43.64093 | spectral_norm = 2.95603 | nuclear_norm = 1159.51074
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 35.52851 | spectral_norm = 3.01303 | nuclear_norm = 833.20569
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 35.28725 | spectral_norm = 3.37337 | nuclear_norm = 826.48755
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 100.25875 | spectral_norm = 8.79255 | nuclear_norm = 2264.66724
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 95.01393 | spectral_norm = 8.74279 | nuclear_norm = 2260.14111
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 85.65256 | spectral_norm = 5.46962 | nuclear_norm = 2276.79980
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 44.02223 | spectral_norm = 3.05809 | nuclear_norm = 1167.30200
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 34.18221 | spectral_norm = 3.19672 | nuclear_norm = 800.14880
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 34.41433 | spectral_norm = 3.35673 | nuclear_norm = 805.14441
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 86.64069 | spectral_norm = 8.09673 | nuclear_norm = 1933.20483
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 91.21998 | spectral_norm = 8.28681 | nuclear_norm = 2145.23901
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 87.15981 | spectral_norm = 5.39388 | nuclear_norm = 2312.51245
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 44.00545 | spectral_norm = 3.09072 | nuclear_norm = 1163.04321
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 34.02779 | spectral_norm = 3.24612 | nuclear_norm = 795.77234
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 33.89674 | spectral_norm = 3.49788 | nuclear_norm = 791.85999
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 78.81247 | spectral_norm = 7.48429 | nuclear_norm = 1754.74170
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 86.29359 | spectral_norm = 7.90979 | nuclear_norm = 2029.30493
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 85.23679 | spectral_norm = 5.31539 | nuclear_norm = 2260.22388
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 43.11249 | spectral_norm = 3.03093 | nuclear_norm = 1139.02942
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 33.62308 | spectral_norm = 2.71386 | nuclear_norm = 774.58521
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 34.29205 | spectral_norm = 2.82344 | nuclear_norm = 792.42371
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 86.91805 | spectral_norm = 8.79587 | nuclear_norm = 1838.92896
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 84.71404 | spectral_norm = 7.61236 | nuclear_norm = 2008.58398
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 80.41605 | spectral_norm = 5.19104 | nuclear_norm = 2132.27271
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 41.76382 | spectral_norm = 3.00983 | nuclear_norm = 1103.13208
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 32.64186 | spectral_norm = 3.04314 | nuclear_norm = 757.69879
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 33.79810 | spectral_norm = 2.97869 | nuclear_norm = 786.63385
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 79.54124 | spectral_norm = 7.36545 | nuclear_norm = 1759.75024
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 86.27287 | spectral_norm = 7.96738 | nuclear_norm = 2042.03186
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 82.58646 | spectral_norm = 5.40307 | nuclear_norm = 2182.61230
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 42.16020 | spectral_norm = 2.97245 | nuclear_norm = 1108.83484
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 33.55650 | spectral_norm = 2.88909 | nuclear_norm = 779.03375
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 34.31269 | spectral_norm = 2.85556 | nuclear_norm = 798.26581
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 82.27319 | spectral_norm = 7.82278 | nuclear_norm = 1808.62866
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 89.78397 | spectral_norm = 8.02218 | nuclear_norm = 2142.20752
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 81.98838 | spectral_norm = 5.56188 | nuclear_norm = 2164.01367
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 41.83644 | spectral_norm = 2.92386 | nuclear_norm = 1098.41479
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 33.22680 | spectral_norm = 2.95127 | nuclear_norm = 770.01978
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 34.17953 | spectral_norm = 2.92015 | nuclear_norm = 793.46893
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 80.66025 | spectral_norm = 7.48699 | nuclear_norm = 1775.76855
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 90.39873 | spectral_norm = 8.49268 | nuclear_norm = 2155.19653
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 83.34030 | spectral_norm = 5.77376 | nuclear_norm = 2201.36475
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 42.12690 | spectral_norm = 2.85904 | nuclear_norm = 1107.43982
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 33.38477 | spectral_norm = 2.80434 | nuclear_norm = 767.07971
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 34.28498 | spectral_norm = 2.86280 | nuclear_norm = 789.61792
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 87.02570 | spectral_norm = 7.76915 | nuclear_norm = 1936.79260
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 95.12008 | spectral_norm = 8.29138 | nuclear_norm = 2279.53833
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 82.54066 | spectral_norm = 5.81164 | nuclear_norm = 2181.05103
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 41.51297 | spectral_norm = 2.81877 | nuclear_norm = 1090.40088
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 33.57977 | spectral_norm = 2.97673 | nuclear_norm = 774.63074
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 34.26636 | spectral_norm = 2.94732 | nuclear_norm = 790.34912
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 84.20453 | spectral_norm = 7.29254 | nuclear_norm = 1888.99487
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 95.33100 | spectral_norm = 7.71145 | nuclear_norm = 2298.49438
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 82.05217 | spectral_norm = 6.07436 | nuclear_norm = 2169.03125
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 40.93204 | spectral_norm = 2.79164 | nuclear_norm = 1073.15259
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 34.00621 | spectral_norm = 2.93880 | nuclear_norm = 789.93201
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 34.22367 | spectral_norm = 3.11093 | nuclear_norm = 793.11865
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 78.44375 | spectral_norm = 8.19656 | nuclear_norm = 1733.90076
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 90.99516 | spectral_norm = 6.68667 | nuclear_norm = 2188.18628
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 81.37017 | spectral_norm = 6.27064 | nuclear_norm = 2151.67847
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 40.40632 | spectral_norm = 2.80172 | nuclear_norm = 1057.56445
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 383.62704 | spectral_norm = 129.46913 | nuclear_norm = 9165.54102
===========================================
step:126/1750 train_loss:4.1990 train_time:77659ms step_avg:669.48ms
step:127/1750 train_loss:4.4153 train_time:78337ms step_avg:669.55ms
step:128/1750 train_loss:4.4106 train_time:79011ms step_avg:669.58ms
step:129/1750 train_loss:4.4187 train_time:79690ms step_avg:669.67ms
step:130/1750 train_loss:4.3347 train_time:80367ms step_avg:669.73ms
step:131/1750 train_loss:4.5006 train_time:81045ms step_avg:669.79ms
step:132/1750 train_loss:4.2793 train_time:81722ms step_avg:669.85ms
step:133/1750 train_loss:4.2588 train_time:82398ms step_avg:669.90ms
step:134/1750 train_loss:4.4072 train_time:83078ms step_avg:669.98ms
step:135/1750 train_loss:4.2455 train_time:83755ms step_avg:670.04ms
step:136/1750 train_loss:4.2560 train_time:84434ms step_avg:670.11ms
step:137/1750 train_loss:4.2926 train_time:85112ms step_avg:670.17ms
step:138/1750 train_loss:4.3313 train_time:85791ms step_avg:670.24ms
step:139/1750 train_loss:4.4380 train_time:86470ms step_avg:670.31ms
step:140/1750 train_loss:4.3303 train_time:87146ms step_avg:670.36ms
step:141/1750 train_loss:4.2200 train_time:87825ms step_avg:670.42ms
step:142/1750 train_loss:4.3462 train_time:88502ms step_avg:670.47ms
step:143/1750 train_loss:4.4160 train_time:89183ms step_avg:670.55ms
step:144/1750 train_loss:4.4664 train_time:89860ms step_avg:670.59ms
step:145/1750 train_loss:4.2841 train_time:90537ms step_avg:670.65ms
step:146/1750 train_loss:4.3017 train_time:91214ms step_avg:670.69ms
step:147/1750 train_loss:4.3255 train_time:91892ms step_avg:670.75ms
step:148/1750 train_loss:4.1217 train_time:92571ms step_avg:670.80ms
step:149/1750 train_loss:4.2684 train_time:93248ms step_avg:670.85ms
step:150/1750 train_loss:4.2336 train_time:93949ms step_avg:671.06ms
step:151/1750 train_loss:4.2399 train_time:94645ms step_avg:671.24ms
step:152/1750 train_loss:4.0839 train_time:95341ms step_avg:671.41ms
step:153/1750 train_loss:4.3236 train_time:96038ms step_avg:671.60ms
step:154/1750 train_loss:4.1172 train_time:96733ms step_avg:671.75ms
step:155/1750 train_loss:4.1155 train_time:97428ms step_avg:671.92ms
step:156/1750 train_loss:4.2316 train_time:98122ms step_avg:672.07ms
step:157/1750 train_loss:4.3196 train_time:98819ms step_avg:672.24ms
step:158/1750 train_loss:4.2183 train_time:99515ms step_avg:672.40ms
step:159/1750 train_loss:4.1749 train_time:100210ms step_avg:672.55ms
step:160/1750 train_loss:4.1156 train_time:100905ms step_avg:672.70ms
step:161/1750 train_loss:4.1744 train_time:101602ms step_avg:672.86ms
step:162/1750 train_loss:4.1976 train_time:102296ms step_avg:673.00ms
step:163/1750 train_loss:4.1658 train_time:102991ms step_avg:673.14ms
step:164/1750 train_loss:4.1193 train_time:103686ms step_avg:673.28ms
step:165/1750 train_loss:4.2047 train_time:104379ms step_avg:673.42ms
step:166/1750 train_loss:4.3335 train_time:105075ms step_avg:673.56ms
step:167/1750 train_loss:4.2579 train_time:105774ms step_avg:673.72ms
step:168/1750 train_loss:4.1714 train_time:106468ms step_avg:673.85ms
step:169/1750 train_loss:4.2243 train_time:107164ms step_avg:673.99ms
step:170/1750 train_loss:4.2778 train_time:107862ms step_avg:674.14ms
step:171/1750 train_loss:3.7568 train_time:108562ms step_avg:674.30ms
step:172/1750 train_loss:4.1046 train_time:109255ms step_avg:674.41ms
step:173/1750 train_loss:4.1049 train_time:109951ms step_avg:674.54ms
step:174/1750 train_loss:4.3139 train_time:110646ms step_avg:674.67ms
step:175/1750 train_loss:4.1309 train_time:111342ms step_avg:674.80ms
step:176/1750 train_loss:4.1935 train_time:112046ms step_avg:674.98ms
step:177/1750 train_loss:4.3231 train_time:112742ms step_avg:675.10ms
step:178/1750 train_loss:4.2009 train_time:113439ms step_avg:675.23ms
step:179/1750 train_loss:4.1408 train_time:114133ms step_avg:675.34ms
step:180/1750 train_loss:4.1966 train_time:114825ms step_avg:675.44ms
step:181/1750 train_loss:4.0891 train_time:115519ms step_avg:675.55ms
step:182/1750 train_loss:4.1349 train_time:116215ms step_avg:675.67ms
step:183/1750 train_loss:4.0940 train_time:116913ms step_avg:675.80ms
step:184/1750 train_loss:4.2456 train_time:117607ms step_avg:675.90ms
step:185/1750 train_loss:4.1591 train_time:118305ms step_avg:676.03ms
step:186/1750 train_loss:4.2613 train_time:119002ms step_avg:676.15ms
step:187/1750 train_loss:4.1624 train_time:119694ms step_avg:676.23ms
step:188/1750 train_loss:4.1340 train_time:120385ms step_avg:676.32ms
step:189/1750 train_loss:3.9622 train_time:121079ms step_avg:676.42ms
step:190/1750 train_loss:4.0790 train_time:121969ms step_avg:677.61ms
step:191/1750 train_loss:4.0638 train_time:122669ms step_avg:677.73ms
step:192/1750 train_loss:4.0108 train_time:123362ms step_avg:677.81ms
step:193/1750 train_loss:4.2263 train_time:124060ms step_avg:677.93ms
step:194/1750 train_loss:4.1465 train_time:124753ms step_avg:678.00ms
step:195/1750 train_loss:4.3320 train_time:125444ms step_avg:678.08ms
step:196/1750 train_loss:4.1636 train_time:126136ms step_avg:678.15ms
step:197/1750 train_loss:4.0240 train_time:126833ms step_avg:678.25ms
step:198/1750 train_loss:4.1716 train_time:127524ms step_avg:678.32ms
step:199/1750 train_loss:4.0133 train_time:128216ms step_avg:678.39ms
step:200/1750 train_loss:4.1029 train_time:128907ms step_avg:678.46ms
step:201/1750 train_loss:3.9687 train_time:129597ms step_avg:678.52ms
step:202/1750 train_loss:4.2259 train_time:130288ms step_avg:678.58ms
step:203/1750 train_loss:4.0330 train_time:130979ms step_avg:678.65ms
step:204/1750 train_loss:4.1749 train_time:131672ms step_avg:678.72ms
step:205/1750 train_loss:4.2282 train_time:132364ms step_avg:678.79ms
step:206/1750 train_loss:3.9310 train_time:133053ms step_avg:678.84ms
step:207/1750 train_loss:4.0654 train_time:133744ms step_avg:678.90ms
step:208/1750 train_loss:4.0698 train_time:134435ms step_avg:678.96ms
step:209/1750 train_loss:4.2249 train_time:135124ms step_avg:679.01ms
step:210/1750 train_loss:4.1577 train_time:135815ms step_avg:679.07ms
step:211/1750 train_loss:4.0364 train_time:136504ms step_avg:679.12ms
step:212/1750 train_loss:4.0514 train_time:137195ms step_avg:679.19ms
step:213/1750 train_loss:4.0175 train_time:137887ms step_avg:679.24ms
step:214/1750 train_loss:4.0886 train_time:138577ms step_avg:679.30ms
step:215/1750 train_loss:3.9102 train_time:139268ms step_avg:679.36ms
step:216/1750 train_loss:3.9732 train_time:139958ms step_avg:679.41ms
step:217/1750 train_loss:3.9785 train_time:140647ms step_avg:679.46ms
step:218/1750 train_loss:4.0731 train_time:141336ms step_avg:679.50ms
step:219/1750 train_loss:4.0540 train_time:142025ms step_avg:679.55ms
step:220/1750 train_loss:4.0615 train_time:142716ms step_avg:679.60ms
step:221/1750 train_loss:4.0825 train_time:143405ms step_avg:679.65ms
step:222/1750 train_loss:3.9798 train_time:144096ms step_avg:679.70ms
step:223/1750 train_loss:3.9451 train_time:144785ms step_avg:679.74ms
step:224/1750 train_loss:4.2729 train_time:145490ms step_avg:679.86ms
step:225/1750 train_loss:3.8751 train_time:146192ms step_avg:679.96ms
step:226/1750 train_loss:3.9705 train_time:146893ms step_avg:680.06ms
step:227/1750 train_loss:3.9704 train_time:147598ms step_avg:680.17ms
step:228/1750 train_loss:4.1250 train_time:148300ms step_avg:680.28ms
step:229/1750 train_loss:3.9027 train_time:149014ms step_avg:680.43ms
step:230/1750 train_loss:4.0293 train_time:149716ms step_avg:680.53ms
step:231/1750 train_loss:3.8790 train_time:150419ms step_avg:680.63ms
step:232/1750 train_loss:3.9504 train_time:151120ms step_avg:680.72ms
step:233/1750 train_loss:4.0680 train_time:151823ms step_avg:680.82ms
step:234/1750 train_loss:4.0193 train_time:152536ms step_avg:680.96ms
step:235/1750 train_loss:3.8540 train_time:153243ms step_avg:681.08ms
step:236/1750 train_loss:4.0482 train_time:153947ms step_avg:681.18ms
step:237/1750 train_loss:4.0645 train_time:154656ms step_avg:681.30ms
step:238/1750 train_loss:3.9240 train_time:155365ms step_avg:681.43ms
step:239/1750 train_loss:4.0494 train_time:156067ms step_avg:681.52ms
step:240/1750 train_loss:4.0991 train_time:156775ms step_avg:681.63ms
step:241/1750 train_loss:3.9446 train_time:157481ms step_avg:681.73ms
step:242/1750 train_loss:4.1213 train_time:158186ms step_avg:681.84ms
step:243/1750 train_loss:4.0052 train_time:158892ms step_avg:681.94ms
step:244/1750 train_loss:4.0539 train_time:159600ms step_avg:682.05ms
step:245/1750 train_loss:4.1279 train_time:160306ms step_avg:682.15ms
step:246/1750 train_loss:4.0472 train_time:161013ms step_avg:682.26ms
step:247/1750 train_loss:3.9927 train_time:161720ms step_avg:682.36ms
step:248/1750 train_loss:4.0788 train_time:162423ms step_avg:682.45ms
step:249/1750 train_loss:3.9056 train_time:163132ms step_avg:682.56ms
step:250/1750 train_loss:3.9535 train_time:163838ms step_avg:682.66ms
step:250/1750 val_loss:3.9844 train_time:163852ms step_avg:682.71ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 157.44487 | frobenius_norm = 35966.50000 | spectral_norm = 7524.59229 | nuclear_norm = 883682.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 58.70472 | spectral_norm = 6.68742 | nuclear_norm = 1375.35803
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 57.11462 | spectral_norm = 8.12559 | nuclear_norm = 1330.38110
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 128.38837 | spectral_norm = 8.37318 | nuclear_norm = 3040.81982
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 120.84836 | spectral_norm = 10.53562 | nuclear_norm = 2845.43018
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 121.10394 | spectral_norm = 9.13539 | nuclear_norm = 3215.43237
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 63.26426 | spectral_norm = 4.48401 | nuclear_norm = 1679.25330
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 57.53087 | spectral_norm = 5.09392 | nuclear_norm = 1347.19080
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 56.85106 | spectral_norm = 6.53230 | nuclear_norm = 1330.53125
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 140.27391 | spectral_norm = 11.63986 | nuclear_norm = 3260.06470
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 139.19673 | spectral_norm = 11.23094 | nuclear_norm = 3289.37085
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 130.41165 | spectral_norm = 8.59315 | nuclear_norm = 3466.48267
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 65.99448 | spectral_norm = 5.19716 | nuclear_norm = 1747.93042
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 57.23969 | spectral_norm = 4.80774 | nuclear_norm = 1340.46765
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 56.37138 | spectral_norm = 5.39934 | nuclear_norm = 1318.12524
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 145.71719 | spectral_norm = 11.72085 | nuclear_norm = 3342.73022
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 141.00215 | spectral_norm = 11.22554 | nuclear_norm = 3328.72607
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 133.74254 | spectral_norm = 8.75385 | nuclear_norm = 3558.18384
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 66.61055 | spectral_norm = 5.22067 | nuclear_norm = 1760.68298
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 55.47610 | spectral_norm = 5.23910 | nuclear_norm = 1295.89880
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 54.71646 | spectral_norm = 5.47773 | nuclear_norm = 1279.72156
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 136.07336 | spectral_norm = 11.37577 | nuclear_norm = 3106.35742
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 138.91743 | spectral_norm = 10.81852 | nuclear_norm = 3262.07129
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 137.45349 | spectral_norm = 9.14000 | nuclear_norm = 3649.16309
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 67.33846 | spectral_norm = 5.31263 | nuclear_norm = 1774.26257
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 54.80219 | spectral_norm = 5.48969 | nuclear_norm = 1278.25708
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 54.23842 | spectral_norm = 5.68188 | nuclear_norm = 1264.30176
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 130.90656 | spectral_norm = 10.88058 | nuclear_norm = 2995.85010
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 137.23923 | spectral_norm = 10.27170 | nuclear_norm = 3201.84277
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 136.47871 | spectral_norm = 9.14429 | nuclear_norm = 3619.80493
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 66.71426 | spectral_norm = 5.30628 | nuclear_norm = 1758.48987
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 55.05200 | spectral_norm = 4.76798 | nuclear_norm = 1252.60205
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 55.75800 | spectral_norm = 4.51037 | nuclear_norm = 1279.05725
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 129.01633 | spectral_norm = 11.89595 | nuclear_norm = 2876.16553
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 137.77943 | spectral_norm = 9.75815 | nuclear_norm = 3254.74805
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 129.72383 | spectral_norm = 8.58247 | nuclear_norm = 3451.85986
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 64.41993 | spectral_norm = 5.20101 | nuclear_norm = 1702.31128
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 53.95749 | spectral_norm = 5.19500 | nuclear_norm = 1250.90405
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 54.38110 | spectral_norm = 4.88963 | nuclear_norm = 1265.33569
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 134.61263 | spectral_norm = 11.20382 | nuclear_norm = 3068.66919
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 137.06731 | spectral_norm = 10.94722 | nuclear_norm = 3226.58350
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 133.05667 | spectral_norm = 9.05615 | nuclear_norm = 3526.31836
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 66.13583 | spectral_norm = 5.26766 | nuclear_norm = 1741.85718
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 55.00183 | spectral_norm = 4.82847 | nuclear_norm = 1276.72388
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 55.22747 | spectral_norm = 4.61458 | nuclear_norm = 1284.47583
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 137.00499 | spectral_norm = 11.61729 | nuclear_norm = 3107.25464
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 140.93257 | spectral_norm = 10.48202 | nuclear_norm = 3332.25854
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 132.48306 | spectral_norm = 9.55866 | nuclear_norm = 3509.19922
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 65.94551 | spectral_norm = 5.16761 | nuclear_norm = 1736.46692
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 55.52738 | spectral_norm = 5.30095 | nuclear_norm = 1289.59485
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 55.64191 | spectral_norm = 4.84949 | nuclear_norm = 1294.63245
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 135.70984 | spectral_norm = 11.31670 | nuclear_norm = 3082.74707
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 140.75192 | spectral_norm = 10.33642 | nuclear_norm = 3334.90967
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 134.42413 | spectral_norm = 9.66575 | nuclear_norm = 3562.92627
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 66.35719 | spectral_norm = 5.22837 | nuclear_norm = 1749.90283
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 55.63345 | spectral_norm = 4.91304 | nuclear_norm = 1277.60669
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 56.05066 | spectral_norm = 4.65062 | nuclear_norm = 1284.25049
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 146.78899 | spectral_norm = 11.73996 | nuclear_norm = 3368.85986
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 151.58490 | spectral_norm = 10.52024 | nuclear_norm = 3594.03760
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 132.22342 | spectral_norm = 9.51478 | nuclear_norm = 3508.08838
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 65.57632 | spectral_norm = 5.15576 | nuclear_norm = 1731.17444
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 56.00127 | spectral_norm = 5.01174 | nuclear_norm = 1289.84155
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 55.98668 | spectral_norm = 4.83109 | nuclear_norm = 1285.64526
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 142.19525 | spectral_norm = 11.31798 | nuclear_norm = 3271.02881
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 152.19145 | spectral_norm = 10.28646 | nuclear_norm = 3631.29492
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 132.92647 | spectral_norm = 9.56761 | nuclear_norm = 3529.58350
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 66.13943 | spectral_norm = 5.31201 | nuclear_norm = 1745.73120
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 56.77885 | spectral_norm = 5.46417 | nuclear_norm = 1316.24841
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 55.84081 | spectral_norm = 5.40124 | nuclear_norm = 1288.16772
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 128.57394 | spectral_norm = 10.34780 | nuclear_norm = 2965.89526
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 144.14626 | spectral_norm = 9.81687 | nuclear_norm = 3433.95264
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 133.48018 | spectral_norm = 9.44655 | nuclear_norm = 3544.75293
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 65.92837 | spectral_norm = 5.40088 | nuclear_norm = 1733.42456
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 547.32288 | spectral_norm = 144.55374 | nuclear_norm = 13686.48340
===========================================
step:251/1750 train_loss:4.0542 train_time:164536ms step_avg:682.72ms
step:252/1750 train_loss:4.1470 train_time:165236ms step_avg:682.79ms
step:253/1750 train_loss:3.9112 train_time:165938ms step_avg:682.87ms
step:254/1750 train_loss:3.8482 train_time:166645ms step_avg:682.97ms
step:255/1750 train_loss:4.0479 train_time:167348ms step_avg:683.05ms
step:256/1750 train_loss:3.9678 train_time:168051ms step_avg:683.13ms
step:257/1750 train_loss:3.9686 train_time:168753ms step_avg:683.21ms
step:258/1750 train_loss:3.9654 train_time:169459ms step_avg:683.30ms
step:259/1750 train_loss:4.0230 train_time:170162ms step_avg:683.38ms
step:260/1750 train_loss:4.0521 train_time:170864ms step_avg:683.46ms
step:261/1750 train_loss:4.0022 train_time:171573ms step_avg:683.56ms
step:262/1750 train_loss:3.9737 train_time:172275ms step_avg:683.63ms
step:263/1750 train_loss:3.8806 train_time:172973ms step_avg:683.69ms
step:264/1750 train_loss:3.9668 train_time:173670ms step_avg:683.74ms
step:265/1750 train_loss:3.8462 train_time:174371ms step_avg:683.81ms
step:266/1750 train_loss:3.9082 train_time:175071ms step_avg:683.87ms
step:267/1750 train_loss:3.9051 train_time:175772ms step_avg:683.94ms
step:268/1750 train_loss:3.9452 train_time:176470ms step_avg:683.99ms
step:269/1750 train_loss:3.8339 train_time:177173ms step_avg:684.07ms
step:270/1750 train_loss:4.0804 train_time:177872ms step_avg:684.12ms
step:271/1750 train_loss:3.9552 train_time:178571ms step_avg:684.18ms
step:272/1750 train_loss:3.9113 train_time:179271ms step_avg:684.24ms
step:273/1750 train_loss:3.9307 train_time:179971ms step_avg:684.30ms
step:274/1750 train_loss:4.0159 train_time:180670ms step_avg:684.36ms
step:275/1750 train_loss:4.0374 train_time:181377ms step_avg:684.44ms
step:276/1750 train_loss:4.1979 train_time:182081ms step_avg:684.52ms
step:277/1750 train_loss:4.0153 train_time:182781ms step_avg:684.57ms
step:278/1750 train_loss:4.0587 train_time:183481ms step_avg:684.63ms
step:279/1750 train_loss:3.9826 train_time:184182ms step_avg:684.69ms
step:280/1750 train_loss:4.1751 train_time:184884ms step_avg:684.75ms
step:281/1750 train_loss:3.9479 train_time:185586ms step_avg:684.82ms
step:282/1750 train_loss:3.9045 train_time:186287ms step_avg:684.88ms
step:283/1750 train_loss:3.8899 train_time:186985ms step_avg:684.93ms
step:284/1750 train_loss:4.0244 train_time:187690ms step_avg:685.00ms
step:285/1750 train_loss:4.0494 train_time:188390ms step_avg:685.06ms
step:286/1750 train_loss:4.0721 train_time:189089ms step_avg:685.10ms
step:287/1750 train_loss:3.8888 train_time:189790ms step_avg:685.16ms
step:288/1750 train_loss:4.0010 train_time:190491ms step_avg:685.22ms
step:289/1750 train_loss:3.8548 train_time:191195ms step_avg:685.29ms
step:290/1750 train_loss:3.8382 train_time:191897ms step_avg:685.35ms
step:291/1750 train_loss:3.9059 train_time:192598ms step_avg:685.40ms
step:292/1750 train_loss:3.8564 train_time:193296ms step_avg:685.45ms
step:293/1750 train_loss:3.8807 train_time:193995ms step_avg:685.49ms
step:294/1750 train_loss:3.9276 train_time:194696ms step_avg:685.55ms
step:295/1750 train_loss:3.8288 train_time:195396ms step_avg:685.60ms
step:296/1750 train_loss:3.8563 train_time:196096ms step_avg:685.65ms
step:297/1750 train_loss:3.8488 train_time:196797ms step_avg:685.70ms
step:298/1750 train_loss:3.9627 train_time:197508ms step_avg:685.79ms
step:299/1750 train_loss:3.8034 train_time:198220ms step_avg:685.88ms
step:300/1750 train_loss:3.9347 train_time:198936ms step_avg:685.99ms
step:301/1750 train_loss:3.9547 train_time:199647ms step_avg:686.07ms
step:302/1750 train_loss:3.9154 train_time:200356ms step_avg:686.15ms
step:303/1750 train_loss:3.9634 train_time:201068ms step_avg:686.24ms
step:304/1750 train_loss:3.9511 train_time:201777ms step_avg:686.32ms
step:305/1750 train_loss:4.4506 train_time:202489ms step_avg:686.40ms
step:306/1750 train_loss:3.9348 train_time:203201ms step_avg:686.49ms
step:307/1750 train_loss:3.8208 train_time:203916ms step_avg:686.59ms
step:308/1750 train_loss:3.9610 train_time:204630ms step_avg:686.68ms
step:309/1750 train_loss:3.8531 train_time:205340ms step_avg:686.76ms
step:310/1750 train_loss:4.0570 train_time:206050ms step_avg:686.83ms
step:311/1750 train_loss:3.8940 train_time:206764ms step_avg:686.92ms
step:312/1750 train_loss:3.8410 train_time:207474ms step_avg:687.00ms
step:313/1750 train_loss:3.9198 train_time:208192ms step_avg:687.10ms
step:314/1750 train_loss:4.0513 train_time:208904ms step_avg:687.18ms
step:315/1750 train_loss:3.9314 train_time:209615ms step_avg:687.26ms
step:316/1750 train_loss:3.7682 train_time:210327ms step_avg:687.34ms
step:317/1750 train_loss:3.8594 train_time:211042ms step_avg:687.43ms
step:318/1750 train_loss:3.9161 train_time:211759ms step_avg:687.53ms
step:319/1750 train_loss:3.8778 train_time:212470ms step_avg:687.61ms
step:320/1750 train_loss:4.0080 train_time:213186ms step_avg:687.70ms
step:321/1750 train_loss:3.9392 train_time:213895ms step_avg:687.77ms
step:322/1750 train_loss:3.9144 train_time:214607ms step_avg:687.84ms
step:323/1750 train_loss:3.9858 train_time:215323ms step_avg:687.93ms
step:324/1750 train_loss:3.9240 train_time:216040ms step_avg:688.03ms
step:325/1750 train_loss:4.0056 train_time:216759ms step_avg:688.12ms
step:326/1750 train_loss:3.8824 train_time:217472ms step_avg:688.20ms
step:327/1750 train_loss:4.3894 train_time:218191ms step_avg:688.30ms
step:328/1750 train_loss:4.0649 train_time:218916ms step_avg:688.41ms
step:329/1750 train_loss:3.7912 train_time:219640ms step_avg:688.53ms
step:330/1750 train_loss:3.7227 train_time:220352ms step_avg:688.60ms
step:331/1750 train_loss:3.9615 train_time:221064ms step_avg:688.67ms
step:332/1750 train_loss:3.8947 train_time:221776ms step_avg:688.75ms
step:333/1750 train_loss:3.8565 train_time:222484ms step_avg:688.81ms
step:334/1750 train_loss:3.8246 train_time:223197ms step_avg:688.88ms
step:335/1750 train_loss:3.9964 train_time:223907ms step_avg:688.94ms
step:336/1750 train_loss:3.9503 train_time:224616ms step_avg:689.01ms
step:337/1750 train_loss:4.3772 train_time:225340ms step_avg:689.11ms
step:338/1750 train_loss:3.9290 train_time:226056ms step_avg:689.19ms
step:339/1750 train_loss:3.8317 train_time:226767ms step_avg:689.26ms
step:340/1750 train_loss:3.9128 train_time:227478ms step_avg:689.33ms
step:341/1750 train_loss:3.8395 train_time:228190ms step_avg:689.40ms
step:342/1750 train_loss:3.7940 train_time:228897ms step_avg:689.45ms
step:343/1750 train_loss:3.8124 train_time:229613ms step_avg:689.53ms
step:344/1750 train_loss:3.9848 train_time:230321ms step_avg:689.58ms
step:345/1750 train_loss:3.8071 train_time:231031ms step_avg:689.65ms
step:346/1750 train_loss:3.7465 train_time:231744ms step_avg:689.71ms
step:347/1750 train_loss:3.7754 train_time:232461ms step_avg:689.79ms
step:348/1750 train_loss:3.8414 train_time:233168ms step_avg:689.85ms
step:349/1750 train_loss:3.8158 train_time:233875ms step_avg:689.90ms
step:350/1750 train_loss:3.5572 train_time:234588ms step_avg:689.97ms
step:351/1750 train_loss:3.8219 train_time:235296ms step_avg:690.02ms
step:352/1750 train_loss:4.1763 train_time:236002ms step_avg:690.07ms
step:353/1750 train_loss:3.6354 train_time:236712ms step_avg:690.12ms
step:354/1750 train_loss:3.9258 train_time:237427ms step_avg:690.19ms
step:355/1750 train_loss:3.7638 train_time:238139ms step_avg:690.26ms
step:356/1750 train_loss:3.8690 train_time:238849ms step_avg:690.32ms
step:357/1750 train_loss:3.7448 train_time:239560ms step_avg:690.38ms
step:358/1750 train_loss:3.8454 train_time:240269ms step_avg:690.43ms
step:359/1750 train_loss:3.7540 train_time:240982ms step_avg:690.49ms
step:360/1750 train_loss:3.4033 train_time:241694ms step_avg:690.55ms
step:361/1750 train_loss:4.0071 train_time:242404ms step_avg:690.61ms
step:362/1750 train_loss:3.8841 train_time:243119ms step_avg:690.68ms
step:363/1750 train_loss:3.8238 train_time:243825ms step_avg:690.72ms
step:364/1750 train_loss:3.7235 train_time:244542ms step_avg:690.80ms
step:365/1750 train_loss:3.9025 train_time:245251ms step_avg:690.85ms
step:366/1750 train_loss:3.8555 train_time:245961ms step_avg:690.90ms
step:367/1750 train_loss:3.8487 train_time:246674ms step_avg:690.96ms
step:368/1750 train_loss:3.8421 train_time:247385ms step_avg:691.02ms
step:369/1750 train_loss:3.7281 train_time:248092ms step_avg:691.07ms
step:370/1750 train_loss:3.8824 train_time:248802ms step_avg:691.12ms
step:371/1750 train_loss:3.7213 train_time:249507ms step_avg:691.15ms
step:372/1750 train_loss:3.6758 train_time:250230ms step_avg:691.24ms
step:373/1750 train_loss:3.9072 train_time:250947ms step_avg:691.31ms
step:374/1750 train_loss:3.8197 train_time:251665ms step_avg:691.39ms
step:375/1750 train_loss:3.7939 train_time:252384ms step_avg:691.46ms
step:375/1750 val_loss:3.8116 train_time:252397ms step_avg:691.50ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 185.20586 | frobenius_norm = 42395.84375 | spectral_norm = 8266.18945 | nuclear_norm = 1047579.62500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 83.59840 | spectral_norm = 10.98040 | nuclear_norm = 1955.41748
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 81.04482 | spectral_norm = 12.09792 | nuclear_norm = 1882.66956
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 166.16165 | spectral_norm = 10.73522 | nuclear_norm = 3962.49902
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 149.29469 | spectral_norm = 12.64498 | nuclear_norm = 3501.70312
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 173.98817 | spectral_norm = 13.30078 | nuclear_norm = 4623.68164
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 90.44814 | spectral_norm = 6.57296 | nuclear_norm = 2403.52979
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 83.43040 | spectral_norm = 7.36899 | nuclear_norm = 1951.15881
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 82.79230 | spectral_norm = 8.79201 | nuclear_norm = 1937.58411
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 173.49881 | spectral_norm = 15.14378 | nuclear_norm = 4020.22583
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 171.67857 | spectral_norm = 13.33750 | nuclear_norm = 4041.74731
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 181.74551 | spectral_norm = 12.51084 | nuclear_norm = 4831.26318
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 91.40408 | spectral_norm = 7.67870 | nuclear_norm = 2417.60083
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 82.64033 | spectral_norm = 6.98469 | nuclear_norm = 1935.42212
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 81.43896 | spectral_norm = 7.59663 | nuclear_norm = 1905.04126
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 182.15529 | spectral_norm = 14.97879 | nuclear_norm = 4178.29102
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 176.76369 | spectral_norm = 12.83166 | nuclear_norm = 4159.00830
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 185.99385 | spectral_norm = 12.58335 | nuclear_norm = 4952.56738
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 91.90764 | spectral_norm = 7.58944 | nuclear_norm = 2425.31641
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 80.79560 | spectral_norm = 7.82085 | nuclear_norm = 1885.27332
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 79.49287 | spectral_norm = 7.84722 | nuclear_norm = 1857.29736
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 173.17801 | spectral_norm = 14.65013 | nuclear_norm = 3949.41943
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 175.35269 | spectral_norm = 13.56916 | nuclear_norm = 4103.65918
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 190.83107 | spectral_norm = 13.28737 | nuclear_norm = 5071.52441
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 92.27686 | spectral_norm = 7.72049 | nuclear_norm = 2423.93945
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 79.57965 | spectral_norm = 7.92306 | nuclear_norm = 1852.33667
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 78.84630 | spectral_norm = 8.07705 | nuclear_norm = 1837.95361
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 167.13057 | spectral_norm = 14.24397 | nuclear_norm = 3808.78223
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 173.39461 | spectral_norm = 13.33506 | nuclear_norm = 4018.23975
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 190.76233 | spectral_norm = 13.23037 | nuclear_norm = 5062.65430
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 93.15248 | spectral_norm = 7.92087 | nuclear_norm = 2450.84717
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 79.53963 | spectral_norm = 6.98626 | nuclear_norm = 1798.76709
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 79.87619 | spectral_norm = 6.61293 | nuclear_norm = 1820.60596
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 168.33434 | spectral_norm = 15.94807 | nuclear_norm = 3775.01221
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 178.01701 | spectral_norm = 12.84196 | nuclear_norm = 4206.86133
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 184.76767 | spectral_norm = 12.38169 | nuclear_norm = 4925.85400
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 90.22865 | spectral_norm = 7.39647 | nuclear_norm = 2383.45166
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 79.17141 | spectral_norm = 7.77399 | nuclear_norm = 1832.31958
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 78.56684 | spectral_norm = 7.27397 | nuclear_norm = 1826.04517
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 175.13797 | spectral_norm = 15.74639 | nuclear_norm = 3988.10059
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 175.75844 | spectral_norm = 14.30216 | nuclear_norm = 4116.53125
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 187.12537 | spectral_norm = 13.23951 | nuclear_norm = 4966.84521
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 92.55501 | spectral_norm = 7.67816 | nuclear_norm = 2438.18359
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 79.87266 | spectral_norm = 7.20940 | nuclear_norm = 1848.62793
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 79.66557 | spectral_norm = 6.95690 | nuclear_norm = 1847.49524
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 178.67296 | spectral_norm = 15.76508 | nuclear_norm = 4048.18994
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 179.77274 | spectral_norm = 13.55690 | nuclear_norm = 4222.55469
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 186.72862 | spectral_norm = 14.02934 | nuclear_norm = 4955.58984
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 92.69066 | spectral_norm = 7.55207 | nuclear_norm = 2443.81934
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 81.50848 | spectral_norm = 7.88880 | nuclear_norm = 1894.29248
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 80.96349 | spectral_norm = 7.24129 | nuclear_norm = 1884.09277
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 176.11017 | spectral_norm = 14.91920 | nuclear_norm = 4004.56250
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 177.84413 | spectral_norm = 13.39680 | nuclear_norm = 4185.83301
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 189.35464 | spectral_norm = 14.00815 | nuclear_norm = 5029.55566
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 93.24131 | spectral_norm = 7.72204 | nuclear_norm = 2462.06079
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 81.25362 | spectral_norm = 7.57160 | nuclear_norm = 1861.31494
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 81.41988 | spectral_norm = 6.92877 | nuclear_norm = 1853.34583
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 191.21916 | spectral_norm = 15.63185 | nuclear_norm = 4391.44189
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 192.79733 | spectral_norm = 13.25350 | nuclear_norm = 4532.15332
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 184.24150 | spectral_norm = 13.46326 | nuclear_norm = 4899.95898
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 91.98717 | spectral_norm = 7.83442 | nuclear_norm = 2434.61401
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 82.36421 | spectral_norm = 7.59787 | nuclear_norm = 1892.37817
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 81.48578 | spectral_norm = 7.20791 | nuclear_norm = 1864.48389
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 183.99199 | spectral_norm = 15.54028 | nuclear_norm = 4231.45996
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 192.41364 | spectral_norm = 13.28742 | nuclear_norm = 4564.69629
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 188.18777 | spectral_norm = 13.09164 | nuclear_norm = 5011.15918
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 91.94923 | spectral_norm = 8.32157 | nuclear_norm = 2430.91309
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 83.23790 | spectral_norm = 8.52826 | nuclear_norm = 1924.55847
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 81.04181 | spectral_norm = 8.20241 | nuclear_norm = 1863.51355
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 164.40230 | spectral_norm = 13.61880 | nuclear_norm = 3809.26392
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 181.70428 | spectral_norm = 12.61376 | nuclear_norm = 4307.28369
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 194.41313 | spectral_norm = 13.92447 | nuclear_norm = 5176.44922
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 95.03008 | spectral_norm = 8.64977 | nuclear_norm = 2502.52759
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 687.62000 | spectral_norm = 153.19107 | nuclear_norm = 17509.69141
===========================================
step:376/1750 train_loss:3.8608 train_time:253094ms step_avg:691.51ms
step:377/1750 train_loss:3.7702 train_time:253820ms step_avg:691.61ms
step:378/1750 train_loss:3.8340 train_time:254548ms step_avg:691.71ms
step:379/1750 train_loss:3.8662 train_time:255263ms step_avg:691.77ms
step:380/1750 train_loss:3.9342 train_time:256169ms step_avg:692.35ms
step:381/1750 train_loss:3.6743 train_time:257097ms step_avg:692.98ms
step:382/1750 train_loss:3.7512 train_time:257831ms step_avg:693.09ms
step:383/1750 train_loss:3.7739 train_time:258552ms step_avg:693.17ms
step:384/1750 train_loss:3.8785 train_time:259273ms step_avg:693.24ms
step:385/1750 train_loss:3.6519 train_time:259993ms step_avg:693.32ms
step:386/1750 train_loss:3.8519 train_time:260713ms step_avg:693.38ms
step:387/1750 train_loss:3.7862 train_time:261432ms step_avg:693.45ms
step:388/1750 train_loss:3.9376 train_time:262151ms step_avg:693.52ms
step:389/1750 train_loss:3.7947 train_time:262863ms step_avg:693.57ms
step:390/1750 train_loss:3.8449 train_time:263589ms step_avg:693.65ms
step:391/1750 train_loss:3.6868 train_time:264313ms step_avg:693.73ms
step:392/1750 train_loss:3.7541 train_time:265030ms step_avg:693.80ms
step:393/1750 train_loss:3.8062 train_time:265747ms step_avg:693.86ms
step:394/1750 train_loss:3.7887 train_time:266466ms step_avg:693.92ms
step:395/1750 train_loss:3.8053 train_time:267181ms step_avg:693.98ms
step:396/1750 train_loss:3.7023 train_time:267908ms step_avg:694.06ms
step:397/1750 train_loss:3.5737 train_time:268631ms step_avg:694.14ms
step:398/1750 train_loss:3.8168 train_time:269349ms step_avg:694.20ms
step:399/1750 train_loss:3.7706 train_time:270074ms step_avg:694.28ms
step:400/1750 train_loss:3.7057 train_time:270795ms step_avg:694.35ms
step:401/1750 train_loss:3.8007 train_time:271516ms step_avg:694.41ms
step:402/1750 train_loss:3.6727 train_time:272233ms step_avg:694.47ms
step:403/1750 train_loss:3.9649 train_time:272959ms step_avg:694.55ms
step:404/1750 train_loss:3.8579 train_time:273678ms step_avg:694.62ms
step:405/1750 train_loss:3.8333 train_time:274403ms step_avg:694.69ms
step:406/1750 train_loss:3.8456 train_time:275118ms step_avg:694.74ms
step:407/1750 train_loss:3.8312 train_time:275840ms step_avg:694.81ms
step:408/1750 train_loss:3.7313 train_time:276563ms step_avg:694.88ms
step:409/1750 train_loss:3.7917 train_time:277272ms step_avg:694.92ms
step:410/1750 train_loss:3.7440 train_time:277994ms step_avg:694.99ms
step:411/1750 train_loss:3.7504 train_time:278707ms step_avg:695.03ms
step:412/1750 train_loss:3.7606 train_time:279418ms step_avg:695.07ms
step:413/1750 train_loss:3.7558 train_time:280137ms step_avg:695.13ms
step:414/1750 train_loss:3.8714 train_time:280858ms step_avg:695.19ms
step:415/1750 train_loss:3.7089 train_time:281571ms step_avg:695.24ms
step:416/1750 train_loss:3.7917 train_time:282293ms step_avg:695.30ms
step:417/1750 train_loss:3.8636 train_time:283011ms step_avg:695.36ms
step:418/1750 train_loss:3.6639 train_time:283734ms step_avg:695.43ms
step:419/1750 train_loss:3.9105 train_time:284451ms step_avg:695.48ms
step:420/1750 train_loss:3.9844 train_time:285170ms step_avg:695.54ms
step:421/1750 train_loss:3.7478 train_time:285884ms step_avg:695.58ms
step:422/1750 train_loss:3.8902 train_time:286601ms step_avg:695.63ms
step:423/1750 train_loss:3.5718 train_time:287323ms step_avg:695.70ms
step:424/1750 train_loss:3.7738 train_time:288037ms step_avg:695.74ms
step:425/1750 train_loss:3.6394 train_time:288758ms step_avg:695.80ms
step:426/1750 train_loss:3.8432 train_time:289474ms step_avg:695.85ms
step:427/1750 train_loss:3.8225 train_time:290196ms step_avg:695.91ms
step:428/1750 train_loss:3.7577 train_time:290915ms step_avg:695.97ms
step:429/1750 train_loss:3.8659 train_time:291644ms step_avg:696.05ms
step:430/1750 train_loss:3.6866 train_time:292367ms step_avg:696.11ms
step:431/1750 train_loss:3.6150 train_time:293095ms step_avg:696.19ms
step:432/1750 train_loss:3.8289 train_time:293810ms step_avg:696.23ms
step:433/1750 train_loss:3.8527 train_time:294535ms step_avg:696.30ms
step:434/1750 train_loss:3.8395 train_time:295258ms step_avg:696.36ms
step:435/1750 train_loss:3.7445 train_time:295974ms step_avg:696.41ms
step:436/1750 train_loss:3.8255 train_time:296686ms step_avg:696.45ms
step:437/1750 train_loss:3.8164 train_time:297400ms step_avg:696.49ms
step:438/1750 train_loss:3.7814 train_time:298114ms step_avg:696.53ms
step:439/1750 train_loss:3.8566 train_time:298834ms step_avg:696.58ms
step:440/1750 train_loss:3.6927 train_time:299551ms step_avg:696.63ms
step:441/1750 train_loss:3.7981 train_time:300278ms step_avg:696.70ms
step:442/1750 train_loss:3.7104 train_time:301002ms step_avg:696.76ms
step:443/1750 train_loss:3.6042 train_time:301718ms step_avg:696.81ms
step:444/1750 train_loss:3.7558 train_time:302431ms step_avg:696.85ms
step:445/1750 train_loss:4.0055 train_time:303147ms step_avg:696.89ms
step:446/1750 train_loss:3.6437 train_time:303871ms step_avg:696.95ms
step:447/1750 train_loss:3.8183 train_time:304596ms step_avg:697.02ms
step:448/1750 train_loss:3.8729 train_time:305334ms step_avg:697.11ms
step:449/1750 train_loss:3.7012 train_time:306069ms step_avg:697.19ms
step:450/1750 train_loss:3.6622 train_time:306793ms step_avg:697.26ms
step:451/1750 train_loss:3.7028 train_time:307525ms step_avg:697.34ms
step:452/1750 train_loss:4.0387 train_time:308261ms step_avg:697.42ms
step:453/1750 train_loss:3.9364 train_time:308992ms step_avg:697.50ms
step:454/1750 train_loss:3.7926 train_time:309729ms step_avg:697.59ms
step:455/1750 train_loss:3.6959 train_time:310459ms step_avg:697.66ms
step:456/1750 train_loss:3.8127 train_time:311185ms step_avg:697.72ms
step:457/1750 train_loss:3.7398 train_time:311909ms step_avg:697.78ms
step:458/1750 train_loss:3.7579 train_time:312633ms step_avg:697.84ms
step:459/1750 train_loss:3.8531 train_time:313358ms step_avg:697.90ms
step:460/1750 train_loss:3.6589 train_time:314094ms step_avg:697.99ms
step:461/1750 train_loss:3.7715 train_time:314823ms step_avg:698.06ms
step:462/1750 train_loss:3.7365 train_time:315557ms step_avg:698.13ms
step:463/1750 train_loss:3.5873 train_time:316284ms step_avg:698.20ms
step:464/1750 train_loss:3.7353 train_time:317008ms step_avg:698.26ms
step:465/1750 train_loss:3.8117 train_time:317732ms step_avg:698.31ms
step:466/1750 train_loss:3.6996 train_time:318466ms step_avg:698.39ms
step:467/1750 train_loss:3.7062 train_time:319189ms step_avg:698.44ms
step:468/1750 train_loss:3.6895 train_time:319922ms step_avg:698.52ms
step:469/1750 train_loss:3.8979 train_time:320642ms step_avg:698.57ms
step:470/1750 train_loss:3.7469 train_time:321369ms step_avg:698.63ms
step:471/1750 train_loss:3.6021 train_time:322119ms step_avg:698.74ms
step:472/1750 train_loss:3.8178 train_time:322838ms step_avg:698.78ms
step:473/1750 train_loss:3.6702 train_time:323563ms step_avg:698.84ms
step:474/1750 train_loss:3.7893 train_time:324298ms step_avg:698.92ms
step:475/1750 train_loss:3.8675 train_time:325023ms step_avg:698.97ms
step:476/1750 train_loss:4.0202 train_time:325752ms step_avg:699.04ms
step:477/1750 train_loss:3.7981 train_time:326475ms step_avg:699.09ms
step:478/1750 train_loss:3.7786 train_time:327202ms step_avg:699.15ms
step:479/1750 train_loss:3.7248 train_time:327928ms step_avg:699.21ms
step:480/1750 train_loss:3.6724 train_time:328662ms step_avg:699.28ms
step:481/1750 train_loss:3.7120 train_time:329389ms step_avg:699.34ms
step:482/1750 train_loss:3.8228 train_time:330117ms step_avg:699.40ms
step:483/1750 train_loss:3.7533 train_time:330841ms step_avg:699.45ms
step:484/1750 train_loss:3.8266 train_time:331570ms step_avg:699.51ms
step:485/1750 train_loss:3.7605 train_time:332300ms step_avg:699.58ms
step:486/1750 train_loss:3.5969 train_time:333021ms step_avg:699.62ms
step:487/1750 train_loss:3.7158 train_time:333747ms step_avg:699.68ms
step:488/1750 train_loss:3.7378 train_time:334472ms step_avg:699.73ms
step:489/1750 train_loss:3.7437 train_time:335190ms step_avg:699.77ms
step:490/1750 train_loss:3.9498 train_time:335925ms step_avg:699.84ms
step:491/1750 train_loss:3.6882 train_time:336648ms step_avg:699.89ms
step:492/1750 train_loss:3.6433 train_time:337366ms step_avg:699.93ms
step:493/1750 train_loss:3.7777 train_time:338090ms step_avg:699.98ms
step:494/1750 train_loss:3.5499 train_time:338823ms step_avg:700.05ms
step:495/1750 train_loss:3.7088 train_time:339554ms step_avg:700.11ms
step:496/1750 train_loss:3.8756 train_time:340289ms step_avg:700.18ms
step:497/1750 train_loss:3.7345 train_time:341026ms step_avg:700.26ms
step:498/1750 train_loss:3.7147 train_time:341752ms step_avg:700.31ms
step:499/1750 train_loss:3.7017 train_time:342471ms step_avg:700.35ms
step:500/1750 train_loss:3.8018 train_time:343195ms step_avg:700.40ms
step:500/1750 val_loss:3.6998 train_time:343208ms step_avg:700.43ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 207.17796 | frobenius_norm = 47507.78125 | spectral_norm = 8915.60547 | nuclear_norm = 1178474.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 104.67654 | spectral_norm = 14.97281 | nuclear_norm = 2437.08057
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 100.71280 | spectral_norm = 15.87587 | nuclear_norm = 2326.77051
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 202.50630 | spectral_norm = 12.85596 | nuclear_norm = 4858.93164
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 174.16171 | spectral_norm = 15.57248 | nuclear_norm = 4075.36206
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 219.59721 | spectral_norm = 17.32203 | nuclear_norm = 5837.47363
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 114.34457 | spectral_norm = 8.96429 | nuclear_norm = 3038.54980
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 105.72842 | spectral_norm = 9.43545 | nuclear_norm = 2463.76904
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 104.95609 | spectral_norm = 10.63190 | nuclear_norm = 2448.15552
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 202.42253 | spectral_norm = 18.12853 | nuclear_norm = 4685.79590
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 200.33788 | spectral_norm = 15.75901 | nuclear_norm = 4708.71777
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 225.57014 | spectral_norm = 15.99973 | nuclear_norm = 5998.92676
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 113.75922 | spectral_norm = 10.06804 | nuclear_norm = 3007.97510
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 104.12390 | spectral_norm = 9.04035 | nuclear_norm = 2430.19629
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 102.66439 | spectral_norm = 9.67077 | nuclear_norm = 2392.91626
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 214.54745 | spectral_norm = 17.95211 | nuclear_norm = 4914.02344
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 208.71579 | spectral_norm = 15.25329 | nuclear_norm = 4905.80371
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 230.19708 | spectral_norm = 16.15695 | nuclear_norm = 6130.81689
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 114.13284 | spectral_norm = 9.80897 | nuclear_norm = 3010.80469
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 101.63588 | spectral_norm = 10.19719 | nuclear_norm = 2360.74243
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 99.92237 | spectral_norm = 9.89911 | nuclear_norm = 2327.92188
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 205.76054 | spectral_norm = 17.73413 | nuclear_norm = 4684.90723
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 207.81381 | spectral_norm = 16.37328 | nuclear_norm = 4856.07812
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 235.56932 | spectral_norm = 17.17735 | nuclear_norm = 6263.32129
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 113.53068 | spectral_norm = 10.05811 | nuclear_norm = 2976.95923
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 100.09761 | spectral_norm = 10.33633 | nuclear_norm = 2316.87939
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 99.09724 | spectral_norm = 10.20113 | nuclear_norm = 2298.56934
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 198.20349 | spectral_norm = 17.14110 | nuclear_norm = 4504.51660
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 204.98012 | spectral_norm = 15.98318 | nuclear_norm = 4739.07031
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 235.90187 | spectral_norm = 16.74175 | nuclear_norm = 6260.53271
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 115.78851 | spectral_norm = 10.37600 | nuclear_norm = 3043.16699
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 99.45935 | spectral_norm = 8.84143 | nuclear_norm = 2230.56665
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 99.48243 | spectral_norm = 8.57855 | nuclear_norm = 2244.04199
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 202.56424 | spectral_norm = 19.15119 | nuclear_norm = 4542.63867
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 212.49530 | spectral_norm = 15.56591 | nuclear_norm = 5027.61426
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 231.22189 | spectral_norm = 16.09403 | nuclear_norm = 6165.74414
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 112.48269 | spectral_norm = 9.42369 | nuclear_norm = 2970.33350
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 99.75742 | spectral_norm = 10.12288 | nuclear_norm = 2291.92090
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 98.48901 | spectral_norm = 9.63233 | nuclear_norm = 2277.21045
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 210.26044 | spectral_norm = 19.58801 | nuclear_norm = 4785.34570
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 210.33148 | spectral_norm = 17.17709 | nuclear_norm = 4922.37061
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 231.72421 | spectral_norm = 16.82249 | nuclear_norm = 6155.52148
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 115.21074 | spectral_norm = 9.64589 | nuclear_norm = 3035.67920
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 100.26317 | spectral_norm = 9.37332 | nuclear_norm = 2303.70337
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 99.56280 | spectral_norm = 8.97450 | nuclear_norm = 2293.41553
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 214.38409 | spectral_norm = 19.22983 | nuclear_norm = 4841.34082
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 214.29877 | spectral_norm = 16.28048 | nuclear_norm = 5015.78076
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 232.05766 | spectral_norm = 17.88943 | nuclear_norm = 6161.30566
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 115.70821 | spectral_norm = 9.65662 | nuclear_norm = 3052.02539
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 102.88158 | spectral_norm = 10.10235 | nuclear_norm = 2375.96191
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 101.81728 | spectral_norm = 9.48207 | nuclear_norm = 2357.62500
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 210.43314 | spectral_norm = 17.68956 | nuclear_norm = 4778.05615
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 210.60271 | spectral_norm = 16.20902 | nuclear_norm = 4942.26660
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 235.59038 | spectral_norm = 18.28577 | nuclear_norm = 6260.51465
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 116.66861 | spectral_norm = 9.94813 | nuclear_norm = 3082.86426
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 102.56281 | spectral_norm = 9.94148 | nuclear_norm = 2330.00928
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 102.69415 | spectral_norm = 9.20130 | nuclear_norm = 2315.91016
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 228.45107 | spectral_norm = 19.19839 | nuclear_norm = 5234.75488
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 228.68236 | spectral_norm = 15.85075 | nuclear_norm = 5354.20020
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 227.54594 | spectral_norm = 17.15168 | nuclear_norm = 6055.47754
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 115.40614 | spectral_norm = 10.38078 | nuclear_norm = 3060.29590
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 104.36319 | spectral_norm = 10.08256 | nuclear_norm = 2379.86230
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 103.00893 | spectral_norm = 9.63029 | nuclear_norm = 2336.63135
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 220.34399 | spectral_norm = 19.53914 | nuclear_norm = 5058.67676
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 227.64037 | spectral_norm = 15.88119 | nuclear_norm = 5385.64551
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 234.54959 | spectral_norm = 16.40348 | nuclear_norm = 6250.06006
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 114.09985 | spectral_norm = 11.28137 | nuclear_norm = 3018.49316
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 105.25894 | spectral_norm = 11.60215 | nuclear_norm = 2414.47827
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 102.12893 | spectral_norm = 10.96328 | nuclear_norm = 2330.27686
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 193.72624 | spectral_norm = 17.27191 | nuclear_norm = 4491.32471
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 214.77884 | spectral_norm = 15.30542 | nuclear_norm = 5079.17578
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 247.51546 | spectral_norm = 17.84546 | nuclear_norm = 6594.08057
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 120.20261 | spectral_norm = 12.02009 | nuclear_norm = 3164.27490
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 807.90271 | spectral_norm = 159.28059 | nuclear_norm = 20781.23242
===========================================
step:501/1750 train_loss:3.6995 train_time:343920ms step_avg:700.45ms
step:502/1750 train_loss:3.6380 train_time:344644ms step_avg:700.50ms
step:503/1750 train_loss:3.7352 train_time:345362ms step_avg:700.53ms
step:504/1750 train_loss:3.5975 train_time:346087ms step_avg:700.58ms
step:505/1750 train_loss:4.0232 train_time:346806ms step_avg:700.62ms
step:506/1750 train_loss:3.6756 train_time:347525ms step_avg:700.65ms
step:507/1750 train_loss:3.7591 train_time:348247ms step_avg:700.70ms
step:508/1750 train_loss:3.9283 train_time:348971ms step_avg:700.75ms
step:509/1750 train_loss:3.6411 train_time:349694ms step_avg:700.79ms
step:510/1750 train_loss:3.7424 train_time:350418ms step_avg:700.84ms
step:511/1750 train_loss:3.7358 train_time:351155ms step_avg:700.91ms
step:512/1750 train_loss:3.5549 train_time:351877ms step_avg:700.95ms
step:513/1750 train_loss:3.5435 train_time:352613ms step_avg:701.02ms
step:514/1750 train_loss:3.7840 train_time:353333ms step_avg:701.06ms
step:515/1750 train_loss:3.8898 train_time:354069ms step_avg:701.13ms
step:516/1750 train_loss:3.7913 train_time:354790ms step_avg:701.17ms
step:517/1750 train_loss:3.6179 train_time:355518ms step_avg:701.22ms
step:518/1750 train_loss:3.7783 train_time:356241ms step_avg:701.26ms
step:519/1750 train_loss:3.5264 train_time:356962ms step_avg:701.30ms
step:520/1750 train_loss:3.7760 train_time:357697ms step_avg:701.37ms
step:521/1750 train_loss:3.6562 train_time:358437ms step_avg:701.44ms
step:522/1750 train_loss:3.5545 train_time:359170ms step_avg:701.50ms
step:523/1750 train_loss:3.8082 train_time:359911ms step_avg:701.58ms
step:524/1750 train_loss:3.5987 train_time:360644ms step_avg:701.64ms
step:525/1750 train_loss:3.6625 train_time:361378ms step_avg:701.70ms
step:526/1750 train_loss:3.7030 train_time:362123ms step_avg:701.79ms
step:527/1750 train_loss:3.9633 train_time:362856ms step_avg:701.85ms
step:528/1750 train_loss:3.6801 train_time:363590ms step_avg:701.91ms
step:529/1750 train_loss:3.6661 train_time:364322ms step_avg:701.97ms
step:530/1750 train_loss:3.6730 train_time:365061ms step_avg:702.04ms
step:531/1750 train_loss:3.7735 train_time:365796ms step_avg:702.10ms
step:532/1750 train_loss:3.7382 train_time:366548ms step_avg:702.20ms
step:533/1750 train_loss:3.7409 train_time:367293ms step_avg:702.28ms
step:534/1750 train_loss:3.8081 train_time:368023ms step_avg:702.33ms
step:535/1750 train_loss:3.7555 train_time:368789ms step_avg:702.46ms
step:536/1750 train_loss:3.6176 train_time:369521ms step_avg:702.51ms
step:537/1750 train_loss:3.6950 train_time:370269ms step_avg:702.60ms
step:538/1750 train_loss:3.6376 train_time:371016ms step_avg:702.68ms
step:539/1750 train_loss:3.6335 train_time:371760ms step_avg:702.76ms
step:540/1750 train_loss:3.7064 train_time:372521ms step_avg:702.87ms
step:541/1750 train_loss:3.6167 train_time:373257ms step_avg:702.93ms
step:542/1750 train_loss:3.6567 train_time:373998ms step_avg:703.00ms
step:543/1750 train_loss:3.7198 train_time:374732ms step_avg:703.06ms
step:544/1750 train_loss:3.6929 train_time:375469ms step_avg:703.13ms
step:545/1750 train_loss:3.7315 train_time:376204ms step_avg:703.18ms
step:546/1750 train_loss:3.7627 train_time:376938ms step_avg:703.24ms
step:547/1750 train_loss:3.6044 train_time:377690ms step_avg:703.33ms
step:548/1750 train_loss:3.8573 train_time:378426ms step_avg:703.39ms
step:549/1750 train_loss:3.2614 train_time:379166ms step_avg:703.46ms
step:550/1750 train_loss:3.7295 train_time:379914ms step_avg:703.54ms
step:551/1750 train_loss:3.7356 train_time:380643ms step_avg:703.59ms
step:552/1750 train_loss:3.6650 train_time:381371ms step_avg:703.64ms
step:553/1750 train_loss:3.7582 train_time:382115ms step_avg:703.71ms
step:554/1750 train_loss:3.6726 train_time:382847ms step_avg:703.76ms
step:555/1750 train_loss:3.6616 train_time:383586ms step_avg:703.83ms
step:556/1750 train_loss:3.7916 train_time:384325ms step_avg:703.89ms
step:557/1750 train_loss:3.6913 train_time:385054ms step_avg:703.94ms
step:558/1750 train_loss:3.6205 train_time:385782ms step_avg:703.98ms
step:559/1750 train_loss:3.7216 train_time:386515ms step_avg:704.03ms
step:560/1750 train_loss:3.6270 train_time:387240ms step_avg:704.07ms
step:561/1750 train_loss:3.6679 train_time:387971ms step_avg:704.12ms
step:562/1750 train_loss:3.6753 train_time:388699ms step_avg:704.16ms
step:563/1750 train_loss:3.4793 train_time:389429ms step_avg:704.21ms
step:564/1750 train_loss:3.7414 train_time:390163ms step_avg:704.26ms
step:565/1750 train_loss:3.6057 train_time:390902ms step_avg:704.33ms
step:566/1750 train_loss:3.6532 train_time:391639ms step_avg:704.39ms
step:567/1750 train_loss:3.7217 train_time:392378ms step_avg:704.45ms
step:568/1750 train_loss:3.6495 train_time:393116ms step_avg:704.51ms
step:569/1750 train_loss:3.9901 train_time:393849ms step_avg:704.56ms
step:570/1750 train_loss:3.6940 train_time:394764ms step_avg:704.94ms
step:571/1750 train_loss:3.6609 train_time:395501ms step_avg:704.99ms
step:572/1750 train_loss:3.7571 train_time:396240ms step_avg:705.05ms
step:573/1750 train_loss:3.7243 train_time:396972ms step_avg:705.10ms
step:574/1750 train_loss:3.7401 train_time:397705ms step_avg:705.15ms
step:575/1750 train_loss:3.7784 train_time:398459ms step_avg:705.24ms
step:576/1750 train_loss:3.7323 train_time:399191ms step_avg:705.28ms
step:577/1750 train_loss:3.7635 train_time:399919ms step_avg:705.33ms
step:578/1750 train_loss:3.6738 train_time:400647ms step_avg:705.37ms
step:579/1750 train_loss:3.6709 train_time:401384ms step_avg:705.42ms
step:580/1750 train_loss:3.6720 train_time:402124ms step_avg:705.48ms
step:581/1750 train_loss:3.5975 train_time:402855ms step_avg:705.53ms
step:582/1750 train_loss:3.6465 train_time:403588ms step_avg:705.57ms
step:583/1750 train_loss:3.8536 train_time:404324ms step_avg:705.63ms
step:584/1750 train_loss:3.6282 train_time:405055ms step_avg:705.67ms
step:585/1750 train_loss:3.5889 train_time:405792ms step_avg:705.72ms
step:586/1750 train_loss:3.7986 train_time:406527ms step_avg:705.78ms
step:587/1750 train_loss:3.5085 train_time:407264ms step_avg:705.83ms
step:588/1750 train_loss:3.6754 train_time:407992ms step_avg:705.87ms
step:589/1750 train_loss:3.6518 train_time:408733ms step_avg:705.93ms
step:590/1750 train_loss:4.0020 train_time:409473ms step_avg:705.99ms
step:591/1750 train_loss:3.7725 train_time:410208ms step_avg:706.04ms
step:592/1750 train_loss:3.5170 train_time:410936ms step_avg:706.08ms
step:593/1750 train_loss:3.5432 train_time:411670ms step_avg:706.12ms
step:594/1750 train_loss:3.4931 train_time:412428ms step_avg:706.21ms
step:595/1750 train_loss:3.5478 train_time:413178ms step_avg:706.29ms
step:596/1750 train_loss:3.9180 train_time:413936ms step_avg:706.38ms
step:597/1750 train_loss:3.6420 train_time:414681ms step_avg:706.44ms
step:598/1750 train_loss:3.5862 train_time:415417ms step_avg:706.49ms
step:599/1750 train_loss:3.6636 train_time:416163ms step_avg:706.56ms
step:600/1750 train_loss:3.4862 train_time:416900ms step_avg:706.61ms
step:601/1750 train_loss:3.6000 train_time:417642ms step_avg:706.67ms
step:602/1750 train_loss:3.6511 train_time:418379ms step_avg:706.72ms
step:603/1750 train_loss:3.6727 train_time:419127ms step_avg:706.79ms
step:604/1750 train_loss:3.7815 train_time:419887ms step_avg:706.88ms
step:605/1750 train_loss:3.6083 train_time:420621ms step_avg:706.93ms
step:606/1750 train_loss:3.6129 train_time:421363ms step_avg:706.98ms
step:607/1750 train_loss:3.5731 train_time:422125ms step_avg:707.08ms
step:608/1750 train_loss:3.8367 train_time:422857ms step_avg:707.12ms
step:609/1750 train_loss:3.6493 train_time:423597ms step_avg:707.17ms
step:610/1750 train_loss:3.6144 train_time:424330ms step_avg:707.22ms
step:611/1750 train_loss:3.7093 train_time:425076ms step_avg:707.28ms
step:612/1750 train_loss:3.6059 train_time:425817ms step_avg:707.34ms
step:613/1750 train_loss:3.5692 train_time:426552ms step_avg:707.38ms
step:614/1750 train_loss:3.7593 train_time:427297ms step_avg:707.45ms
step:615/1750 train_loss:3.6982 train_time:428035ms step_avg:707.50ms
step:616/1750 train_loss:3.7021 train_time:428771ms step_avg:707.54ms
step:617/1750 train_loss:3.6467 train_time:429510ms step_avg:707.59ms
step:618/1750 train_loss:3.5687 train_time:430250ms step_avg:707.65ms
step:619/1750 train_loss:3.6966 train_time:430993ms step_avg:707.71ms
step:620/1750 train_loss:3.5550 train_time:431744ms step_avg:707.78ms
step:621/1750 train_loss:3.5879 train_time:432496ms step_avg:707.85ms
step:622/1750 train_loss:3.9199 train_time:433232ms step_avg:707.90ms
step:623/1750 train_loss:3.5775 train_time:433992ms step_avg:707.98ms
step:624/1750 train_loss:3.6053 train_time:434728ms step_avg:708.03ms
step:625/1750 train_loss:3.7054 train_time:435473ms step_avg:708.09ms
step:625/1750 val_loss:3.6276 train_time:435486ms step_avg:708.11ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 225.58014 | frobenius_norm = 51801.79688 | spectral_norm = 9473.37793 | nuclear_norm = 1289097.62500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 121.49795 | spectral_norm = 18.68518 | nuclear_norm = 2815.73584
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 116.23553 | spectral_norm = 19.58634 | nuclear_norm = 2671.89893
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 234.40617 | spectral_norm = 14.90231 | nuclear_norm = 5652.79492
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 194.89273 | spectral_norm = 18.42330 | nuclear_norm = 4548.66748
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 255.72993 | spectral_norm = 20.65906 | nuclear_norm = 6797.09863
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 133.80365 | spectral_norm = 11.09334 | nuclear_norm = 3555.76074
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 124.00742 | spectral_norm = 11.21531 | nuclear_norm = 2880.10767
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 123.27877 | spectral_norm = 12.04923 | nuclear_norm = 2870.54761
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 227.62743 | spectral_norm = 20.60619 | nuclear_norm = 5265.76416
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 225.03300 | spectral_norm = 17.77314 | nuclear_norm = 5285.92676
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 261.60013 | spectral_norm = 19.04633 | nuclear_norm = 6959.77588
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 132.52715 | spectral_norm = 12.24916 | nuclear_norm = 3504.70923
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 121.50598 | spectral_norm = 10.99471 | nuclear_norm = 2826.82715
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 119.70222 | spectral_norm = 11.42271 | nuclear_norm = 2783.28491
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 243.27353 | spectral_norm = 20.52120 | nuclear_norm = 5566.71387
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 236.93243 | spectral_norm = 17.33200 | nuclear_norm = 5571.58447
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 266.28320 | spectral_norm = 19.42328 | nuclear_norm = 7093.81641
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 132.73889 | spectral_norm = 11.79683 | nuclear_norm = 3501.22803
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 118.55549 | spectral_norm = 12.24294 | nuclear_norm = 2740.90088
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 116.65526 | spectral_norm = 11.52244 | nuclear_norm = 2710.82446
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 235.08189 | spectral_norm = 20.40420 | nuclear_norm = 5347.45947
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 237.07198 | spectral_norm = 18.81163 | nuclear_norm = 5532.46045
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 272.18158 | spectral_norm = 20.48557 | nuclear_norm = 7237.13184
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 131.12531 | spectral_norm = 12.16102 | nuclear_norm = 3433.85156
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 116.73119 | spectral_norm = 12.30351 | nuclear_norm = 2687.53027
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 115.43208 | spectral_norm = 11.93685 | nuclear_norm = 2668.13257
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 225.87692 | spectral_norm = 19.59988 | nuclear_norm = 5127.66406
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 233.19920 | spectral_norm = 18.32058 | nuclear_norm = 5385.25195
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 272.70709 | spectral_norm = 19.92036 | nuclear_norm = 7235.15332
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 134.48706 | spectral_norm = 12.56471 | nuclear_norm = 3531.00391
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 115.44460 | spectral_norm = 10.46200 | nuclear_norm = 2571.04932
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 115.21622 | spectral_norm = 10.17741 | nuclear_norm = 2580.44263
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 232.60710 | spectral_norm = 21.79046 | nuclear_norm = 5215.41992
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 242.03625 | spectral_norm = 18.02073 | nuclear_norm = 5731.40088
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 269.19687 | spectral_norm = 19.31997 | nuclear_norm = 7178.72217
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 130.88147 | spectral_norm = 11.19820 | nuclear_norm = 3455.05786
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 116.40372 | spectral_norm = 12.07877 | nuclear_norm = 2658.88232
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 114.69228 | spectral_norm = 11.57829 | nuclear_norm = 2640.39453
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 241.43727 | spectral_norm = 22.76032 | nuclear_norm = 5493.53174
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 241.08452 | spectral_norm = 19.66396 | nuclear_norm = 5640.81689
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 268.35257 | spectral_norm = 19.93871 | nuclear_norm = 7132.17773
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 133.89352 | spectral_norm = 11.70326 | nuclear_norm = 3527.86230
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 116.56763 | spectral_norm = 11.24511 | nuclear_norm = 2660.93164
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 115.64059 | spectral_norm = 10.88353 | nuclear_norm = 2648.95508
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 246.16846 | spectral_norm = 21.95503 | nuclear_norm = 5550.44775
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 244.86015 | spectral_norm = 18.55697 | nuclear_norm = 5721.41602
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 269.32736 | spectral_norm = 21.07341 | nuclear_norm = 7151.95117
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 134.69293 | spectral_norm = 11.89487 | nuclear_norm = 3552.68970
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 120.26670 | spectral_norm = 12.12902 | nuclear_norm = 2765.82178
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 118.88789 | spectral_norm = 11.29858 | nuclear_norm = 2743.03760
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 240.93196 | spectral_norm = 20.16378 | nuclear_norm = 5466.17334
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 239.96504 | spectral_norm = 18.48745 | nuclear_norm = 5615.63379
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 274.04089 | spectral_norm = 21.77391 | nuclear_norm = 7280.50879
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 136.11571 | spectral_norm = 12.12682 | nuclear_norm = 3597.12451
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 119.70681 | spectral_norm = 12.07812 | nuclear_norm = 2701.50439
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 119.96303 | spectral_norm = 11.02035 | nuclear_norm = 2679.78809
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 261.08743 | spectral_norm = 23.08155 | nuclear_norm = 5965.87305
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 259.51941 | spectral_norm = 17.95281 | nuclear_norm = 6063.76953
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 263.34875 | spectral_norm = 20.34877 | nuclear_norm = 7007.99902
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 135.02948 | spectral_norm = 12.78438 | nuclear_norm = 3583.47388
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 122.03901 | spectral_norm = 12.20401 | nuclear_norm = 2765.08521
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 120.46861 | spectral_norm = 11.67568 | nuclear_norm = 2716.26807
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 252.55048 | spectral_norm = 23.17349 | nuclear_norm = 5785.06982
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 258.67343 | spectral_norm = 18.05884 | nuclear_norm = 6111.54980
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 273.11139 | spectral_norm = 19.71506 | nuclear_norm = 7277.47070
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 132.49628 | spectral_norm = 13.97209 | nuclear_norm = 3505.33008
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 123.00338 | spectral_norm = 14.24750 | nuclear_norm = 2800.91699
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 119.11311 | spectral_norm = 13.40752 | nuclear_norm = 2700.89111
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 219.04042 | spectral_norm = 20.60916 | nuclear_norm = 5075.06641
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 244.08612 | spectral_norm = 17.41852 | nuclear_norm = 5766.53857
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 291.88638 | spectral_norm = 21.29281 | nuclear_norm = 7775.43359
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 141.61339 | spectral_norm = 15.07730 | nuclear_norm = 3726.59985
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 912.98120 | spectral_norm = 163.22055 | nuclear_norm = 23644.55664
===========================================
step:626/1750 train_loss:3.7056 train_time:436206ms step_avg:708.13ms
step:627/1750 train_loss:3.7492 train_time:436947ms step_avg:708.18ms
step:628/1750 train_loss:3.7148 train_time:437701ms step_avg:708.25ms
step:629/1750 train_loss:3.7741 train_time:438434ms step_avg:708.29ms
step:630/1750 train_loss:3.5994 train_time:439164ms step_avg:708.33ms
step:631/1750 train_loss:3.7238 train_time:439897ms step_avg:708.37ms
step:632/1750 train_loss:3.7493 train_time:440636ms step_avg:708.42ms
step:633/1750 train_loss:3.6524 train_time:441379ms step_avg:708.47ms
step:634/1750 train_loss:3.6081 train_time:442122ms step_avg:708.53ms
step:635/1750 train_loss:3.7036 train_time:442873ms step_avg:708.60ms
step:636/1750 train_loss:3.9590 train_time:443600ms step_avg:708.63ms
step:637/1750 train_loss:3.5483 train_time:444332ms step_avg:708.66ms
step:638/1750 train_loss:3.3537 train_time:445070ms step_avg:708.71ms
step:639/1750 train_loss:3.5943 train_time:445815ms step_avg:708.77ms
step:640/1750 train_loss:3.6370 train_time:446550ms step_avg:708.81ms
step:641/1750 train_loss:3.5766 train_time:447284ms step_avg:708.85ms
step:642/1750 train_loss:3.5819 train_time:448024ms step_avg:708.90ms
step:643/1750 train_loss:3.6464 train_time:448763ms step_avg:708.95ms
step:644/1750 train_loss:3.6108 train_time:449501ms step_avg:708.99ms
step:645/1750 train_loss:3.5688 train_time:450228ms step_avg:709.02ms
step:646/1750 train_loss:3.7733 train_time:450964ms step_avg:709.06ms
step:647/1750 train_loss:3.6796 train_time:451713ms step_avg:709.13ms
step:648/1750 train_loss:3.6667 train_time:452447ms step_avg:709.16ms
step:649/1750 train_loss:3.7085 train_time:453206ms step_avg:709.24ms
step:650/1750 train_loss:3.7782 train_time:453949ms step_avg:709.30ms
step:651/1750 train_loss:3.6273 train_time:454697ms step_avg:709.36ms
step:652/1750 train_loss:3.7728 train_time:455438ms step_avg:709.41ms
step:653/1750 train_loss:3.5924 train_time:456179ms step_avg:709.45ms
step:654/1750 train_loss:3.6734 train_time:456912ms step_avg:709.49ms
step:655/1750 train_loss:3.4329 train_time:457648ms step_avg:709.53ms
step:656/1750 train_loss:3.5797 train_time:458376ms step_avg:709.56ms
step:657/1750 train_loss:3.5766 train_time:459118ms step_avg:709.61ms
step:658/1750 train_loss:3.5001 train_time:459859ms step_avg:709.66ms
step:659/1750 train_loss:3.6915 train_time:460601ms step_avg:709.71ms
step:660/1750 train_loss:3.5949 train_time:461344ms step_avg:709.76ms
step:661/1750 train_loss:3.6831 train_time:462085ms step_avg:709.81ms
step:662/1750 train_loss:3.7517 train_time:462826ms step_avg:709.86ms
step:663/1750 train_loss:3.6802 train_time:463568ms step_avg:709.91ms
step:664/1750 train_loss:3.5605 train_time:464303ms step_avg:709.94ms
step:665/1750 train_loss:3.6110 train_time:465043ms step_avg:709.99ms
step:666/1750 train_loss:3.5041 train_time:465786ms step_avg:710.04ms
step:667/1750 train_loss:3.7884 train_time:466519ms step_avg:710.07ms
step:668/1750 train_loss:3.6149 train_time:467276ms step_avg:710.15ms
step:669/1750 train_loss:3.6512 train_time:468031ms step_avg:710.21ms
step:670/1750 train_loss:3.4922 train_time:468786ms step_avg:710.28ms
step:671/1750 train_loss:3.6053 train_time:469543ms step_avg:710.35ms
step:672/1750 train_loss:3.5690 train_time:470282ms step_avg:710.40ms
step:673/1750 train_loss:3.5705 train_time:471033ms step_avg:710.46ms
step:674/1750 train_loss:3.8535 train_time:471792ms step_avg:710.53ms
step:675/1750 train_loss:3.6331 train_time:472541ms step_avg:710.59ms
step:676/1750 train_loss:3.7184 train_time:473296ms step_avg:710.65ms
step:677/1750 train_loss:3.4904 train_time:474040ms step_avg:710.71ms
step:678/1750 train_loss:3.6052 train_time:474788ms step_avg:710.76ms
step:679/1750 train_loss:3.5672 train_time:475539ms step_avg:710.82ms
step:680/1750 train_loss:3.6843 train_time:476302ms step_avg:710.90ms
step:681/1750 train_loss:3.5957 train_time:477064ms step_avg:710.97ms
step:682/1750 train_loss:3.6199 train_time:477813ms step_avg:711.03ms
step:683/1750 train_loss:3.6590 train_time:478571ms step_avg:711.10ms
step:684/1750 train_loss:3.7444 train_time:479334ms step_avg:711.18ms
step:685/1750 train_loss:3.6545 train_time:480099ms step_avg:711.26ms
step:686/1750 train_loss:3.6932 train_time:480849ms step_avg:711.32ms
step:687/1750 train_loss:3.6422 train_time:481600ms step_avg:711.37ms
step:688/1750 train_loss:3.6764 train_time:482364ms step_avg:711.45ms
step:689/1750 train_loss:3.2002 train_time:483151ms step_avg:711.56ms
step:690/1750 train_loss:3.4079 train_time:483889ms step_avg:711.60ms
step:691/1750 train_loss:3.5496 train_time:484635ms step_avg:711.65ms
step:692/1750 train_loss:3.4276 train_time:485372ms step_avg:711.69ms
step:693/1750 train_loss:3.6339 train_time:486122ms step_avg:711.75ms
step:694/1750 train_loss:3.6530 train_time:486866ms step_avg:711.79ms
step:695/1750 train_loss:3.5581 train_time:487605ms step_avg:711.83ms
step:696/1750 train_loss:3.5424 train_time:488350ms step_avg:711.88ms
step:697/1750 train_loss:3.8758 train_time:489107ms step_avg:711.95ms
step:698/1750 train_loss:3.5918 train_time:489855ms step_avg:712.00ms
step:699/1750 train_loss:3.6501 train_time:490607ms step_avg:712.06ms
step:700/1750 train_loss:3.7585 train_time:491361ms step_avg:712.12ms
step:701/1750 train_loss:3.5801 train_time:492097ms step_avg:712.15ms
step:702/1750 train_loss:3.5540 train_time:492833ms step_avg:712.19ms
step:703/1750 train_loss:3.5209 train_time:493590ms step_avg:712.25ms
step:704/1750 train_loss:3.5066 train_time:494343ms step_avg:712.31ms
step:705/1750 train_loss:3.5834 train_time:495118ms step_avg:712.40ms
step:706/1750 train_loss:3.5716 train_time:495858ms step_avg:712.44ms
step:707/1750 train_loss:3.5883 train_time:496625ms step_avg:712.52ms
step:708/1750 train_loss:3.6530 train_time:497385ms step_avg:712.59ms
step:709/1750 train_loss:3.6125 train_time:498150ms step_avg:712.66ms
step:710/1750 train_loss:3.5879 train_time:498899ms step_avg:712.71ms
step:711/1750 train_loss:3.5538 train_time:499652ms step_avg:712.77ms
step:712/1750 train_loss:3.6015 train_time:500419ms step_avg:712.85ms
step:713/1750 train_loss:3.6601 train_time:501159ms step_avg:712.89ms
step:714/1750 train_loss:3.6459 train_time:501916ms step_avg:712.95ms
step:715/1750 train_loss:3.5681 train_time:502671ms step_avg:713.01ms
step:716/1750 train_loss:3.5830 train_time:503420ms step_avg:713.06ms
step:717/1750 train_loss:3.5967 train_time:504169ms step_avg:713.11ms
step:718/1750 train_loss:3.7014 train_time:504911ms step_avg:713.15ms
step:719/1750 train_loss:3.6080 train_time:505655ms step_avg:713.19ms
step:720/1750 train_loss:3.6932 train_time:506392ms step_avg:713.23ms
step:721/1750 train_loss:3.8447 train_time:507148ms step_avg:713.29ms
step:722/1750 train_loss:3.4758 train_time:507887ms step_avg:713.32ms
step:723/1750 train_loss:3.7410 train_time:508632ms step_avg:713.37ms
step:724/1750 train_loss:3.7776 train_time:509361ms step_avg:713.39ms
step:725/1750 train_loss:3.5759 train_time:510112ms step_avg:713.44ms
step:726/1750 train_loss:3.6678 train_time:510883ms step_avg:713.52ms
step:727/1750 train_loss:3.5484 train_time:511625ms step_avg:713.56ms
step:728/1750 train_loss:3.5776 train_time:512367ms step_avg:713.60ms
step:729/1750 train_loss:3.7475 train_time:513107ms step_avg:713.64ms
step:730/1750 train_loss:3.6668 train_time:513857ms step_avg:713.69ms
step:731/1750 train_loss:3.6769 train_time:514614ms step_avg:713.75ms
step:732/1750 train_loss:3.5664 train_time:515361ms step_avg:713.80ms
step:733/1750 train_loss:3.6026 train_time:516090ms step_avg:713.82ms
step:734/1750 train_loss:3.8365 train_time:516835ms step_avg:713.86ms
step:735/1750 train_loss:3.5657 train_time:517574ms step_avg:713.90ms
step:736/1750 train_loss:3.6190 train_time:518341ms step_avg:713.97ms
step:737/1750 train_loss:3.7439 train_time:519083ms step_avg:714.01ms
step:738/1750 train_loss:3.6900 train_time:519823ms step_avg:714.04ms
step:739/1750 train_loss:3.6077 train_time:520559ms step_avg:714.07ms
step:740/1750 train_loss:3.5168 train_time:521304ms step_avg:714.12ms
step:741/1750 train_loss:4.1153 train_time:522086ms step_avg:714.21ms
step:742/1750 train_loss:3.5064 train_time:522846ms step_avg:714.27ms
step:743/1750 train_loss:3.5554 train_time:523608ms step_avg:714.34ms
step:744/1750 train_loss:3.5919 train_time:524392ms step_avg:714.43ms
step:745/1750 train_loss:3.6602 train_time:525159ms step_avg:714.50ms
step:746/1750 train_loss:3.5746 train_time:525910ms step_avg:714.55ms
step:747/1750 train_loss:3.6037 train_time:526651ms step_avg:714.59ms
step:748/1750 train_loss:3.6629 train_time:527409ms step_avg:714.65ms
step:749/1750 train_loss:3.5744 train_time:528178ms step_avg:714.72ms
step:750/1750 train_loss:3.5635 train_time:528956ms step_avg:714.81ms
step:750/1750 val_loss:3.5767 train_time:528970ms step_avg:714.82ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 241.63817 | frobenius_norm = 55553.78516 | spectral_norm = 9993.85938 | nuclear_norm = 1386291.12500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 135.93141 | spectral_norm = 22.31893 | nuclear_norm = 3140.01953
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 129.94444 | spectral_norm = 23.38286 | nuclear_norm = 2978.93604
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 262.13641 | spectral_norm = 16.61999 | nuclear_norm = 6349.84082
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 209.83636 | spectral_norm = 20.64490 | nuclear_norm = 4886.66504
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 287.87466 | spectral_norm = 23.68419 | nuclear_norm = 7653.31445
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 150.79813 | spectral_norm = 12.99500 | nuclear_norm = 4007.03857
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 140.04861 | spectral_norm = 12.69442 | nuclear_norm = 3247.13354
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 139.28311 | spectral_norm = 13.19827 | nuclear_norm = 3237.20288
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 250.14651 | spectral_norm = 22.59575 | nuclear_norm = 5783.10254
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 246.70497 | spectral_norm = 19.52612 | nuclear_norm = 5793.78174
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 293.50781 | spectral_norm = 21.59182 | nuclear_norm = 7813.76123
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 148.99956 | spectral_norm = 14.17755 | nuclear_norm = 3940.63818
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 136.69804 | spectral_norm = 12.50028 | nuclear_norm = 3172.15771
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 134.31746 | spectral_norm = 13.05997 | nuclear_norm = 3114.72119
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 269.18723 | spectral_norm = 22.96138 | nuclear_norm = 6153.39551
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 262.25177 | spectral_norm = 19.32677 | nuclear_norm = 6171.29102
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 298.02036 | spectral_norm = 22.43223 | nuclear_norm = 7943.44238
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 149.04054 | spectral_norm = 13.57713 | nuclear_norm = 3931.16797
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 133.37325 | spectral_norm = 14.09473 | nuclear_norm = 3074.32837
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 131.11209 | spectral_norm = 12.93564 | nuclear_norm = 3038.37109
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 261.76700 | spectral_norm = 22.77230 | nuclear_norm = 5952.95850
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 263.56366 | spectral_norm = 20.96819 | nuclear_norm = 6149.01953
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 304.25729 | spectral_norm = 23.57452 | nuclear_norm = 8093.77734
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 146.52997 | spectral_norm = 13.94838 | nuclear_norm = 3835.44629
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 131.16426 | spectral_norm = 14.09644 | nuclear_norm = 3009.10498
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 129.62224 | spectral_norm = 13.43385 | nuclear_norm = 2989.07080
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 251.04521 | spectral_norm = 21.98870 | nuclear_norm = 5695.31543
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 258.78488 | spectral_norm = 20.45871 | nuclear_norm = 5975.19678
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 304.78674 | spectral_norm = 22.75395 | nuclear_norm = 8085.56592
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 150.78612 | spectral_norm = 14.58141 | nuclear_norm = 3956.09863
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 129.25760 | spectral_norm = 11.87548 | nuclear_norm = 2863.53442
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 128.81024 | spectral_norm = 11.66934 | nuclear_norm = 2868.52051
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 259.88214 | spectral_norm = 24.14027 | nuclear_norm = 5827.88965
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 268.73779 | spectral_norm = 20.13907 | nuclear_norm = 6369.72754
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 302.55188 | spectral_norm = 22.36955 | nuclear_norm = 8068.51953
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 146.91057 | spectral_norm = 12.87576 | nuclear_norm = 3877.82690
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 130.85780 | spectral_norm = 13.90830 | nuclear_norm = 2974.31543
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 128.61104 | spectral_norm = 13.21805 | nuclear_norm = 2951.56055
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 270.04568 | spectral_norm = 25.33805 | nuclear_norm = 6145.82715
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 269.18158 | spectral_norm = 21.67944 | nuclear_norm = 6301.20801
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 300.67758 | spectral_norm = 22.99025 | nuclear_norm = 7995.88477
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 150.14565 | spectral_norm = 13.73035 | nuclear_norm = 3956.16748
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 130.70566 | spectral_norm = 12.98236 | nuclear_norm = 2967.33057
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 129.47226 | spectral_norm = 12.53977 | nuclear_norm = 2951.70288
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 274.99988 | spectral_norm = 24.40057 | nuclear_norm = 6194.85840
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 272.52740 | spectral_norm = 20.59076 | nuclear_norm = 6361.78809
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 302.26584 | spectral_norm = 23.79058 | nuclear_norm = 8026.81836
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 151.23581 | spectral_norm = 13.95715 | nuclear_norm = 3988.35938
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 135.25371 | spectral_norm = 13.81802 | nuclear_norm = 3098.62646
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 133.64482 | spectral_norm = 12.83549 | nuclear_norm = 3075.43872
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 268.28677 | spectral_norm = 22.50065 | nuclear_norm = 6085.83008
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 266.33148 | spectral_norm = 20.42524 | nuclear_norm = 6220.42383
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 307.88397 | spectral_norm = 24.89872 | nuclear_norm = 8178.33789
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 153.07289 | spectral_norm = 14.13138 | nuclear_norm = 4044.87085
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 134.42850 | spectral_norm = 13.96734 | nuclear_norm = 3013.29443
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 135.06828 | spectral_norm = 12.70795 | nuclear_norm = 2994.39014
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 290.10446 | spectral_norm = 26.65512 | nuclear_norm = 6609.85645
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 287.01810 | spectral_norm = 19.83230 | nuclear_norm = 6700.27051
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 294.90518 | spectral_norm = 23.18412 | nuclear_norm = 7845.07617
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 152.20596 | spectral_norm = 14.89426 | nuclear_norm = 4041.45874
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 137.43987 | spectral_norm = 14.21553 | nuclear_norm = 3097.31836
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 135.61224 | spectral_norm = 13.55647 | nuclear_norm = 3041.01416
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 282.00940 | spectral_norm = 26.55879 | nuclear_norm = 6449.08301
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 287.09833 | spectral_norm = 20.21395 | nuclear_norm = 6774.69043
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 307.18854 | spectral_norm = 22.93999 | nuclear_norm = 8183.92969
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 148.70876 | spectral_norm = 16.42519 | nuclear_norm = 3934.08862
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 138.31818 | spectral_norm = 16.57770 | nuclear_norm = 3129.53516
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 133.69130 | spectral_norm = 15.54677 | nuclear_norm = 3013.71484
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 241.84038 | spectral_norm = 23.66893 | nuclear_norm = 5597.94238
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 271.15286 | spectral_norm = 19.36951 | nuclear_norm = 6400.67920
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 330.66464 | spectral_norm = 24.31823 | nuclear_norm = 8807.79688
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 160.97151 | spectral_norm = 17.99250 | nuclear_norm = 4234.83105
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1006.85089 | spectral_norm = 165.26848 | nuclear_norm = 26211.10352
===========================================
step:751/1750 train_loss:3.6172 train_time:529697ms step_avg:714.84ms
step:752/1750 train_loss:3.5725 train_time:530450ms step_avg:714.89ms
step:753/1750 train_loss:3.6253 train_time:531201ms step_avg:714.94ms
step:754/1750 train_loss:3.6257 train_time:531963ms step_avg:715.00ms
step:755/1750 train_loss:3.6053 train_time:532697ms step_avg:715.03ms
step:756/1750 train_loss:3.6955 train_time:533458ms step_avg:715.09ms
step:757/1750 train_loss:3.4684 train_time:534226ms step_avg:715.16ms
step:758/1750 train_loss:3.7360 train_time:535013ms step_avg:715.26ms
step:759/1750 train_loss:3.6642 train_time:535749ms step_avg:715.29ms
step:760/1750 train_loss:3.5970 train_time:536679ms step_avg:715.57ms
step:761/1750 train_loss:3.7153 train_time:537425ms step_avg:715.61ms
step:762/1750 train_loss:3.6127 train_time:538360ms step_avg:715.90ms
step:763/1750 train_loss:3.4456 train_time:539122ms step_avg:715.96ms
step:764/1750 train_loss:3.4404 train_time:539876ms step_avg:716.02ms
step:765/1750 train_loss:3.5507 train_time:540632ms step_avg:716.07ms
step:766/1750 train_loss:3.5499 train_time:541382ms step_avg:716.11ms
step:767/1750 train_loss:4.5882 train_time:542164ms step_avg:716.20ms
step:768/1750 train_loss:3.5577 train_time:542927ms step_avg:716.26ms
step:769/1750 train_loss:3.6051 train_time:543681ms step_avg:716.31ms
step:770/1750 train_loss:3.6837 train_time:544435ms step_avg:716.36ms
step:771/1750 train_loss:4.1917 train_time:545186ms step_avg:716.41ms
step:772/1750 train_loss:3.6095 train_time:545960ms step_avg:716.48ms
step:773/1750 train_loss:3.6176 train_time:546710ms step_avg:716.53ms
step:774/1750 train_loss:3.5702 train_time:547473ms step_avg:716.59ms
step:775/1750 train_loss:3.7084 train_time:548220ms step_avg:716.63ms
step:776/1750 train_loss:3.4930 train_time:548974ms step_avg:716.68ms
step:777/1750 train_loss:3.6375 train_time:549724ms step_avg:716.72ms
step:778/1750 train_loss:3.6245 train_time:550484ms step_avg:716.78ms
step:779/1750 train_loss:3.5938 train_time:551249ms step_avg:716.84ms
step:780/1750 train_loss:3.5899 train_time:552006ms step_avg:716.89ms
step:781/1750 train_loss:3.4837 train_time:552764ms step_avg:716.94ms
step:782/1750 train_loss:3.6413 train_time:553512ms step_avg:716.98ms
step:783/1750 train_loss:3.5762 train_time:554271ms step_avg:717.04ms
step:784/1750 train_loss:3.5507 train_time:555019ms step_avg:717.08ms
step:785/1750 train_loss:3.5547 train_time:555780ms step_avg:717.14ms
step:786/1750 train_loss:3.5758 train_time:556528ms step_avg:717.17ms
step:787/1750 train_loss:3.5333 train_time:557278ms step_avg:717.22ms
step:788/1750 train_loss:3.5934 train_time:558023ms step_avg:717.25ms
step:789/1750 train_loss:3.5450 train_time:558772ms step_avg:717.29ms
step:790/1750 train_loss:3.4817 train_time:559522ms step_avg:717.34ms
step:791/1750 train_loss:3.5445 train_time:560297ms step_avg:717.41ms
step:792/1750 train_loss:3.6136 train_time:561041ms step_avg:717.44ms
step:793/1750 train_loss:3.6218 train_time:561798ms step_avg:717.49ms
step:794/1750 train_loss:3.6476 train_time:562571ms step_avg:717.57ms
step:795/1750 train_loss:3.5785 train_time:563331ms step_avg:717.62ms
step:796/1750 train_loss:3.6908 train_time:564098ms step_avg:717.68ms
step:797/1750 train_loss:3.5976 train_time:564855ms step_avg:717.73ms
step:798/1750 train_loss:3.4030 train_time:565613ms step_avg:717.78ms
step:799/1750 train_loss:3.4789 train_time:566365ms step_avg:717.83ms
step:800/1750 train_loss:4.1968 train_time:567145ms step_avg:717.90ms
step:801/1750 train_loss:3.7141 train_time:567896ms step_avg:717.95ms
step:802/1750 train_loss:3.5629 train_time:568638ms step_avg:717.98ms
step:803/1750 train_loss:3.6099 train_time:569395ms step_avg:718.03ms
step:804/1750 train_loss:3.5973 train_time:570158ms step_avg:718.08ms
step:805/1750 train_loss:3.5444 train_time:570914ms step_avg:718.13ms
step:806/1750 train_loss:3.5414 train_time:571679ms step_avg:718.19ms
step:807/1750 train_loss:3.5696 train_time:572436ms step_avg:718.24ms
step:808/1750 train_loss:3.6417 train_time:573183ms step_avg:718.27ms
step:809/1750 train_loss:3.8422 train_time:573945ms step_avg:718.33ms
step:810/1750 train_loss:3.6905 train_time:574684ms step_avg:718.35ms
step:811/1750 train_loss:3.4930 train_time:575446ms step_avg:718.41ms
step:812/1750 train_loss:3.6168 train_time:576193ms step_avg:718.45ms
step:813/1750 train_loss:3.6310 train_time:576937ms step_avg:718.48ms
step:814/1750 train_loss:3.5721 train_time:577682ms step_avg:718.51ms
step:815/1750 train_loss:3.4238 train_time:578443ms step_avg:718.56ms
step:816/1750 train_loss:3.7592 train_time:579196ms step_avg:718.61ms
step:817/1750 train_loss:3.5900 train_time:579945ms step_avg:718.64ms
step:818/1750 train_loss:3.5464 train_time:580721ms step_avg:718.71ms
step:819/1750 train_loss:3.5615 train_time:581484ms step_avg:718.77ms
step:820/1750 train_loss:3.5432 train_time:582229ms step_avg:718.80ms
step:821/1750 train_loss:3.4291 train_time:582989ms step_avg:718.85ms
step:822/1750 train_loss:3.5607 train_time:583746ms step_avg:718.90ms
step:823/1750 train_loss:3.6578 train_time:584494ms step_avg:718.93ms
step:824/1750 train_loss:3.3919 train_time:585248ms step_avg:718.98ms
step:825/1750 train_loss:3.5952 train_time:586014ms step_avg:719.04ms
step:826/1750 train_loss:3.6997 train_time:586772ms step_avg:719.08ms
step:827/1750 train_loss:3.4385 train_time:587563ms step_avg:719.17ms
step:828/1750 train_loss:3.5121 train_time:588333ms step_avg:719.23ms
step:829/1750 train_loss:3.5181 train_time:589089ms step_avg:719.28ms
step:830/1750 train_loss:3.6221 train_time:589841ms step_avg:719.32ms
step:831/1750 train_loss:3.4625 train_time:590605ms step_avg:719.37ms
step:832/1750 train_loss:3.5801 train_time:591373ms step_avg:719.43ms
step:833/1750 train_loss:3.6072 train_time:592144ms step_avg:719.49ms
step:834/1750 train_loss:3.6237 train_time:592895ms step_avg:719.53ms
step:835/1750 train_loss:3.4652 train_time:593693ms step_avg:719.63ms
step:836/1750 train_loss:3.6940 train_time:594453ms step_avg:719.68ms
step:837/1750 train_loss:3.4755 train_time:595207ms step_avg:719.72ms
step:838/1750 train_loss:3.3959 train_time:595955ms step_avg:719.75ms
step:839/1750 train_loss:3.6316 train_time:596708ms step_avg:719.79ms
step:840/1750 train_loss:3.5539 train_time:597463ms step_avg:719.84ms
step:841/1750 train_loss:3.6413 train_time:598220ms step_avg:719.88ms
step:842/1750 train_loss:3.5153 train_time:598976ms step_avg:719.92ms
step:843/1750 train_loss:3.5754 train_time:599739ms step_avg:719.97ms
step:844/1750 train_loss:3.5310 train_time:600489ms step_avg:720.01ms
step:845/1750 train_loss:3.5537 train_time:601259ms step_avg:720.07ms
step:846/1750 train_loss:3.5649 train_time:602020ms step_avg:720.12ms
step:847/1750 train_loss:3.6050 train_time:602783ms step_avg:720.17ms
step:848/1750 train_loss:3.5579 train_time:603545ms step_avg:720.22ms
step:849/1750 train_loss:3.3739 train_time:604307ms step_avg:720.27ms
step:850/1750 train_loss:3.5994 train_time:605068ms step_avg:720.32ms
step:851/1750 train_loss:3.4742 train_time:605829ms step_avg:720.37ms
step:852/1750 train_loss:3.5947 train_time:606608ms step_avg:720.44ms
step:853/1750 train_loss:3.3753 train_time:607350ms step_avg:720.46ms
step:854/1750 train_loss:3.6714 train_time:608100ms step_avg:720.50ms
step:855/1750 train_loss:3.5991 train_time:608840ms step_avg:720.52ms
step:856/1750 train_loss:3.3773 train_time:609593ms step_avg:720.56ms
step:857/1750 train_loss:3.6780 train_time:610375ms step_avg:720.63ms
step:858/1750 train_loss:3.6635 train_time:611147ms step_avg:720.69ms
step:859/1750 train_loss:3.3714 train_time:611913ms step_avg:720.75ms
step:860/1750 train_loss:3.5661 train_time:612675ms step_avg:720.79ms
step:861/1750 train_loss:3.6179 train_time:613440ms step_avg:720.85ms
step:862/1750 train_loss:3.4364 train_time:614195ms step_avg:720.89ms
step:863/1750 train_loss:3.5133 train_time:614968ms step_avg:720.95ms
step:864/1750 train_loss:3.8092 train_time:615747ms step_avg:721.02ms
step:865/1750 train_loss:3.7469 train_time:616546ms step_avg:721.11ms
step:866/1750 train_loss:3.5635 train_time:617296ms step_avg:721.14ms
step:867/1750 train_loss:3.5257 train_time:618039ms step_avg:721.17ms
step:868/1750 train_loss:3.7092 train_time:618809ms step_avg:721.22ms
step:869/1750 train_loss:3.4537 train_time:619584ms step_avg:721.28ms
step:870/1750 train_loss:3.4092 train_time:620356ms step_avg:721.34ms
step:871/1750 train_loss:3.5736 train_time:621108ms step_avg:721.38ms
step:872/1750 train_loss:3.5341 train_time:621869ms step_avg:721.43ms
step:873/1750 train_loss:3.4802 train_time:622623ms step_avg:721.46ms
step:874/1750 train_loss:3.6261 train_time:623375ms step_avg:721.50ms
step:875/1750 train_loss:3.5291 train_time:624140ms step_avg:721.55ms
step:875/1750 val_loss:3.5326 train_time:624154ms step_avg:721.57ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 255.88069 | frobenius_norm = 58889.07812 | spectral_norm = 10480.39355 | nuclear_norm = 1472939.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 148.82735 | spectral_norm = 25.79061 | nuclear_norm = 3425.85132
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 142.68147 | spectral_norm = 27.20978 | nuclear_norm = 3259.71631
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 287.14478 | spectral_norm = 18.28645 | nuclear_norm = 6983.19141
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 221.65811 | spectral_norm = 22.76076 | nuclear_norm = 5146.84521
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 319.39429 | spectral_norm = 26.82622 | nuclear_norm = 8493.75879
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 166.00542 | spectral_norm = 14.76418 | nuclear_norm = 4409.65723
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 154.56490 | spectral_norm = 14.19642 | nuclear_norm = 3577.49829
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 153.86568 | spectral_norm = 14.38647 | nuclear_norm = 3572.68359
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 270.87653 | spectral_norm = 24.51348 | nuclear_norm = 6257.87500
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 266.78574 | spectral_norm = 21.31146 | nuclear_norm = 6262.93848
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 323.22302 | spectral_norm = 23.89945 | nuclear_norm = 8610.07031
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 163.99005 | spectral_norm = 15.99645 | nuclear_norm = 4337.60840
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 150.58812 | spectral_norm = 13.99166 | nuclear_norm = 3487.48633
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 147.80956 | spectral_norm = 14.49640 | nuclear_norm = 3423.39307
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 293.89148 | spectral_norm = 25.50747 | nuclear_norm = 6713.54639
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 286.02802 | spectral_norm = 21.10505 | nuclear_norm = 6734.80615
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 327.57901 | spectral_norm = 25.27453 | nuclear_norm = 8735.48242
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 163.93864 | spectral_norm = 15.27391 | nuclear_norm = 4323.82910
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 146.69647 | spectral_norm = 15.91536 | nuclear_norm = 3371.37378
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 144.46277 | spectral_norm = 14.31731 | nuclear_norm = 3341.18335
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 287.02966 | spectral_norm = 25.08293 | nuclear_norm = 6525.34277
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 288.50888 | spectral_norm = 22.93086 | nuclear_norm = 6730.44043
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 334.18799 | spectral_norm = 26.48956 | nuclear_norm = 8893.64551
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 160.77690 | spectral_norm = 15.55635 | nuclear_norm = 4206.95215
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 144.27219 | spectral_norm = 15.92585 | nuclear_norm = 3298.69336
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 142.60892 | spectral_norm = 14.97720 | nuclear_norm = 3281.13428
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 275.39413 | spectral_norm = 24.16005 | nuclear_norm = 6247.30566
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 283.37814 | spectral_norm = 22.42142 | nuclear_norm = 6538.84473
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 334.20483 | spectral_norm = 25.40282 | nuclear_norm = 8864.92969
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 165.64920 | spectral_norm = 16.35968 | nuclear_norm = 4343.62988
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 141.85796 | spectral_norm = 13.12452 | nuclear_norm = 3124.62573
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 141.26738 | spectral_norm = 12.93867 | nuclear_norm = 3129.85376
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 286.26422 | spectral_norm = 26.57819 | nuclear_norm = 6421.73926
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 294.06387 | spectral_norm = 22.20887 | nuclear_norm = 6967.60449
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 333.67786 | spectral_norm = 25.19297 | nuclear_norm = 8898.86523
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 161.65213 | spectral_norm = 14.44360 | nuclear_norm = 4266.86621
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 144.00555 | spectral_norm = 15.56874 | nuclear_norm = 3261.64307
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 141.41776 | spectral_norm = 14.69314 | nuclear_norm = 3238.22119
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 297.21741 | spectral_norm = 27.85044 | nuclear_norm = 6769.49805
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 295.85040 | spectral_norm = 23.78453 | nuclear_norm = 6927.49609
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 330.79871 | spectral_norm = 25.81327 | nuclear_norm = 8800.85547
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 165.00404 | spectral_norm = 15.63476 | nuclear_norm = 4347.30273
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 143.44267 | spectral_norm = 14.45714 | nuclear_norm = 3242.45776
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 142.11740 | spectral_norm = 13.99352 | nuclear_norm = 3228.31104
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 302.38559 | spectral_norm = 26.47413 | nuclear_norm = 6813.51660
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 298.66953 | spectral_norm = 22.46204 | nuclear_norm = 6967.73389
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 332.63245 | spectral_norm = 26.39947 | nuclear_norm = 8834.13965
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 166.18439 | spectral_norm = 15.86715 | nuclear_norm = 4382.15918
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 148.93266 | spectral_norm = 15.43723 | nuclear_norm = 3401.41431
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 147.31888 | spectral_norm = 14.33902 | nuclear_norm = 3382.85425
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 293.68411 | spectral_norm = 24.71058 | nuclear_norm = 6659.94189
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 290.85773 | spectral_norm = 22.41286 | nuclear_norm = 6785.04102
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 339.37057 | spectral_norm = 27.74693 | nuclear_norm = 9013.16895
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 168.43816 | spectral_norm = 16.10285 | nuclear_norm = 4449.69629
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 147.89667 | spectral_norm = 15.60552 | nuclear_norm = 3299.25269
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 148.84862 | spectral_norm = 14.18301 | nuclear_norm = 3280.60400
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 316.78699 | spectral_norm = 30.21774 | nuclear_norm = 7199.65869
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 312.39011 | spectral_norm = 21.58925 | nuclear_norm = 7288.58838
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 324.09735 | spectral_norm = 25.92661 | nuclear_norm = 8617.79492
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 167.78209 | spectral_norm = 16.79441 | nuclear_norm = 4455.95215
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 151.38779 | spectral_norm = 16.06128 | nuclear_norm = 3394.13623
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 149.28169 | spectral_norm = 15.34444 | nuclear_norm = 3332.65430
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 309.74216 | spectral_norm = 29.93633 | nuclear_norm = 7072.81348
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 313.53571 | spectral_norm = 22.06400 | nuclear_norm = 7393.10547
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 338.77994 | spectral_norm = 25.87630 | nuclear_norm = 9024.20312
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 163.51794 | spectral_norm = 18.69335 | nuclear_norm = 4325.22754
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 152.25009 | spectral_norm = 18.81161 | nuclear_norm = 3425.48608
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 147.03838 | spectral_norm = 17.54366 | nuclear_norm = 3296.33740
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 263.15781 | spectral_norm = 26.18504 | nuclear_norm = 6086.54150
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 296.83630 | spectral_norm = 21.05890 | nuclear_norm = 7003.93164
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 366.00571 | spectral_norm = 27.08120 | nuclear_norm = 9747.21484
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 179.18629 | spectral_norm = 20.81790 | nuclear_norm = 4712.94287
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1091.74866 | spectral_norm = 166.57767 | nuclear_norm = 28534.60547
===========================================
step:876/1750 train_loss:3.6315 train_time:624911ms step_avg:721.61ms
step:877/1750 train_loss:3.4259 train_time:625669ms step_avg:721.65ms
step:878/1750 train_loss:3.6403 train_time:626427ms step_avg:721.69ms
step:879/1750 train_loss:3.5143 train_time:627174ms step_avg:721.72ms
step:880/1750 train_loss:3.8618 train_time:627928ms step_avg:721.76ms
step:881/1750 train_loss:3.5711 train_time:628675ms step_avg:721.79ms
step:882/1750 train_loss:3.3957 train_time:629418ms step_avg:721.81ms
step:883/1750 train_loss:3.7114 train_time:630185ms step_avg:721.86ms
step:884/1750 train_loss:3.4230 train_time:630940ms step_avg:721.90ms
step:885/1750 train_loss:3.6761 train_time:631689ms step_avg:721.93ms
step:886/1750 train_loss:3.5444 train_time:632463ms step_avg:721.99ms
step:887/1750 train_loss:3.5954 train_time:633234ms step_avg:722.05ms
step:888/1750 train_loss:3.5929 train_time:633987ms step_avg:722.08ms
step:889/1750 train_loss:3.6247 train_time:634743ms step_avg:722.12ms
step:890/1750 train_loss:3.5852 train_time:635539ms step_avg:722.20ms
step:891/1750 train_loss:3.4252 train_time:636302ms step_avg:722.25ms
step:892/1750 train_loss:3.5900 train_time:637068ms step_avg:722.30ms
step:893/1750 train_loss:3.5116 train_time:637832ms step_avg:722.35ms
step:894/1750 train_loss:3.5685 train_time:638587ms step_avg:722.38ms
step:895/1750 train_loss:3.4029 train_time:639341ms step_avg:722.42ms
step:896/1750 train_loss:3.3047 train_time:640129ms step_avg:722.49ms
step:897/1750 train_loss:3.4749 train_time:640913ms step_avg:722.56ms
step:898/1750 train_loss:3.6615 train_time:641697ms step_avg:722.63ms
step:899/1750 train_loss:3.5235 train_time:642458ms step_avg:722.68ms
step:900/1750 train_loss:3.5846 train_time:643236ms step_avg:722.74ms
step:901/1750 train_loss:3.7311 train_time:643988ms step_avg:722.77ms
step:902/1750 train_loss:3.5114 train_time:644759ms step_avg:722.82ms
step:903/1750 train_loss:3.4615 train_time:645518ms step_avg:722.86ms
step:904/1750 train_loss:3.6865 train_time:646307ms step_avg:722.94ms
step:905/1750 train_loss:3.6345 train_time:647059ms step_avg:722.97ms
step:906/1750 train_loss:3.4761 train_time:647822ms step_avg:723.02ms
step:907/1750 train_loss:3.4901 train_time:648584ms step_avg:723.06ms
step:908/1750 train_loss:3.7692 train_time:649382ms step_avg:723.14ms
step:909/1750 train_loss:3.4976 train_time:650148ms step_avg:723.19ms
step:910/1750 train_loss:3.6798 train_time:650912ms step_avg:723.24ms
step:911/1750 train_loss:3.8617 train_time:651706ms step_avg:723.31ms
step:912/1750 train_loss:3.3272 train_time:652454ms step_avg:723.34ms
step:913/1750 train_loss:3.6447 train_time:653214ms step_avg:723.38ms
step:914/1750 train_loss:3.5009 train_time:654002ms step_avg:723.45ms
step:915/1750 train_loss:3.5826 train_time:654790ms step_avg:723.52ms
step:916/1750 train_loss:3.7162 train_time:655574ms step_avg:723.59ms
step:917/1750 train_loss:3.4894 train_time:656339ms step_avg:723.64ms
step:918/1750 train_loss:3.4842 train_time:657137ms step_avg:723.72ms
step:919/1750 train_loss:3.5650 train_time:657911ms step_avg:723.77ms
step:920/1750 train_loss:3.4614 train_time:658693ms step_avg:723.84ms
step:921/1750 train_loss:3.5141 train_time:659481ms step_avg:723.91ms
step:922/1750 train_loss:3.4733 train_time:660235ms step_avg:723.94ms
step:923/1750 train_loss:3.6291 train_time:661000ms step_avg:723.99ms
step:924/1750 train_loss:3.4964 train_time:661747ms step_avg:724.01ms
step:925/1750 train_loss:3.4883 train_time:662502ms step_avg:724.05ms
step:926/1750 train_loss:3.6155 train_time:663286ms step_avg:724.11ms
step:927/1750 train_loss:3.4745 train_time:664051ms step_avg:724.16ms
step:928/1750 train_loss:3.6702 train_time:664825ms step_avg:724.21ms
step:929/1750 train_loss:3.5431 train_time:665572ms step_avg:724.24ms
step:930/1750 train_loss:3.3793 train_time:666346ms step_avg:724.29ms
step:931/1750 train_loss:3.6943 train_time:667102ms step_avg:724.32ms
step:932/1750 train_loss:3.3938 train_time:667858ms step_avg:724.36ms
step:933/1750 train_loss:3.3760 train_time:668626ms step_avg:724.40ms
step:934/1750 train_loss:3.5988 train_time:669402ms step_avg:724.46ms
step:935/1750 train_loss:3.5445 train_time:670162ms step_avg:724.50ms
step:936/1750 train_loss:3.4008 train_time:670978ms step_avg:724.60ms
step:937/1750 train_loss:3.3515 train_time:671751ms step_avg:724.65ms
step:938/1750 train_loss:3.5169 train_time:672511ms step_avg:724.69ms
step:939/1750 train_loss:3.3193 train_time:673272ms step_avg:724.73ms
step:940/1750 train_loss:3.6007 train_time:674020ms step_avg:724.75ms
step:941/1750 train_loss:3.4439 train_time:674809ms step_avg:724.82ms
step:942/1750 train_loss:3.4404 train_time:675592ms step_avg:724.88ms
step:943/1750 train_loss:3.5661 train_time:676385ms step_avg:724.96ms
step:944/1750 train_loss:3.4439 train_time:677141ms step_avg:724.99ms
step:945/1750 train_loss:3.4563 train_time:677913ms step_avg:725.04ms
step:946/1750 train_loss:3.6211 train_time:678692ms step_avg:725.10ms
step:947/1750 train_loss:3.5337 train_time:679461ms step_avg:725.14ms
step:948/1750 train_loss:3.6027 train_time:680242ms step_avg:725.20ms
step:949/1750 train_loss:3.7613 train_time:681007ms step_avg:725.25ms
step:950/1750 train_loss:3.3953 train_time:681947ms step_avg:725.48ms
step:951/1750 train_loss:3.4645 train_time:682706ms step_avg:725.51ms
step:952/1750 train_loss:3.7025 train_time:683472ms step_avg:725.55ms
step:953/1750 train_loss:3.4273 train_time:684216ms step_avg:725.57ms
step:954/1750 train_loss:3.4864 train_time:684999ms step_avg:725.64ms
step:955/1750 train_loss:3.5797 train_time:685794ms step_avg:725.71ms
step:956/1750 train_loss:3.4589 train_time:686558ms step_avg:725.75ms
step:957/1750 train_loss:3.4932 train_time:687307ms step_avg:725.77ms
step:958/1750 train_loss:3.4588 train_time:688102ms step_avg:725.85ms
step:959/1750 train_loss:3.5146 train_time:688883ms step_avg:725.90ms
step:960/1750 train_loss:3.5225 train_time:689645ms step_avg:725.94ms
step:961/1750 train_loss:3.5279 train_time:690411ms step_avg:725.98ms
step:962/1750 train_loss:3.4117 train_time:691208ms step_avg:726.06ms
step:963/1750 train_loss:3.6635 train_time:691972ms step_avg:726.10ms
step:964/1750 train_loss:3.6209 train_time:692727ms step_avg:726.13ms
step:965/1750 train_loss:3.4079 train_time:693493ms step_avg:726.17ms
step:966/1750 train_loss:3.4396 train_time:694279ms step_avg:726.23ms
step:967/1750 train_loss:3.4998 train_time:695031ms step_avg:726.26ms
step:968/1750 train_loss:3.7254 train_time:695802ms step_avg:726.31ms
step:969/1750 train_loss:3.5387 train_time:696566ms step_avg:726.35ms
step:970/1750 train_loss:3.5386 train_time:697317ms step_avg:726.37ms
step:971/1750 train_loss:3.6005 train_time:698105ms step_avg:726.44ms
step:972/1750 train_loss:3.3955 train_time:698881ms step_avg:726.49ms
step:973/1750 train_loss:3.5522 train_time:699648ms step_avg:726.53ms
step:974/1750 train_loss:3.5032 train_time:700410ms step_avg:726.57ms
step:975/1750 train_loss:3.5600 train_time:701187ms step_avg:726.62ms
step:976/1750 train_loss:3.6082 train_time:701945ms step_avg:726.65ms
step:977/1750 train_loss:3.4812 train_time:702712ms step_avg:726.69ms
step:978/1750 train_loss:3.6865 train_time:703464ms step_avg:726.72ms
step:979/1750 train_loss:3.5895 train_time:704218ms step_avg:726.75ms
step:980/1750 train_loss:3.3765 train_time:704978ms step_avg:726.78ms
step:981/1750 train_loss:3.6339 train_time:705741ms step_avg:726.82ms
step:982/1750 train_loss:3.4408 train_time:706501ms step_avg:726.85ms
step:983/1750 train_loss:3.5979 train_time:707250ms step_avg:726.88ms
step:984/1750 train_loss:3.5626 train_time:708024ms step_avg:726.92ms
step:985/1750 train_loss:3.5189 train_time:708831ms step_avg:727.01ms
step:986/1750 train_loss:3.5172 train_time:709600ms step_avg:727.05ms
step:987/1750 train_loss:3.5950 train_time:710378ms step_avg:727.10ms
step:988/1750 train_loss:3.4412 train_time:711137ms step_avg:727.13ms
step:989/1750 train_loss:3.5152 train_time:711910ms step_avg:727.18ms
step:990/1750 train_loss:3.5126 train_time:712666ms step_avg:727.21ms
step:991/1750 train_loss:3.4369 train_time:713460ms step_avg:727.28ms
step:992/1750 train_loss:3.6902 train_time:714262ms step_avg:727.35ms
step:993/1750 train_loss:3.4955 train_time:715016ms step_avg:727.38ms
step:994/1750 train_loss:3.4662 train_time:715776ms step_avg:727.41ms
step:995/1750 train_loss:3.5336 train_time:716597ms step_avg:727.51ms
step:996/1750 train_loss:3.6207 train_time:717355ms step_avg:727.54ms
step:997/1750 train_loss:3.5589 train_time:718106ms step_avg:727.56ms
step:998/1750 train_loss:3.4868 train_time:718866ms step_avg:727.60ms
step:999/1750 train_loss:3.7834 train_time:719620ms step_avg:727.62ms
step:1000/1750 train_loss:3.4661 train_time:720393ms step_avg:727.67ms
step:1000/1750 val_loss:3.4961 train_time:720407ms step_avg:727.68ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 268.71695 | frobenius_norm = 61900.52344 | spectral_norm = 10939.24512 | nuclear_norm = 1551431.62500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 160.71727 | spectral_norm = 29.10349 | nuclear_norm = 3688.94678
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 154.44833 | spectral_norm = 30.78801 | nuclear_norm = 3519.68433
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 309.44104 | spectral_norm = 19.83833 | nuclear_norm = 7553.17969
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 231.33540 | spectral_norm = 24.66737 | nuclear_norm = 5356.40723
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 348.21268 | spectral_norm = 29.73563 | nuclear_norm = 9260.72070
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 180.14899 | spectral_norm = 16.53672 | nuclear_norm = 4784.61182
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 168.07800 | spectral_norm = 15.58547 | nuclear_norm = 3887.20410
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 167.38307 | spectral_norm = 15.41734 | nuclear_norm = 3881.51221
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 289.94635 | spectral_norm = 26.36624 | nuclear_norm = 6694.06641
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 284.97849 | spectral_norm = 22.92194 | nuclear_norm = 6685.43848
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 349.98083 | spectral_norm = 26.10994 | nuclear_norm = 9327.08105
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 177.84491 | spectral_norm = 17.64015 | nuclear_norm = 4705.34375
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 163.28354 | spectral_norm = 15.42457 | nuclear_norm = 3775.06909
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 160.25720 | spectral_norm = 16.05166 | nuclear_norm = 3707.09033
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 316.85782 | spectral_norm = 27.57030 | nuclear_norm = 7233.41016
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 307.98013 | spectral_norm = 22.67159 | nuclear_norm = 7254.23633
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 353.90137 | spectral_norm = 27.93164 | nuclear_norm = 9439.90820
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 177.66629 | spectral_norm = 16.80818 | nuclear_norm = 4686.66309
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 159.13989 | spectral_norm = 17.50939 | nuclear_norm = 3651.16089
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 156.67613 | spectral_norm = 15.51047 | nuclear_norm = 3619.39868
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 310.65799 | spectral_norm = 27.11970 | nuclear_norm = 7063.19922
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 311.89771 | spectral_norm = 24.88955 | nuclear_norm = 7277.90820
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 360.85306 | spectral_norm = 29.28932 | nuclear_norm = 9604.80469
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 173.64403 | spectral_norm = 17.12191 | nuclear_norm = 4541.89453
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 156.52554 | spectral_norm = 17.49906 | nuclear_norm = 3570.64111
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 154.63741 | spectral_norm = 16.33016 | nuclear_norm = 3552.79492
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 297.80020 | spectral_norm = 26.19516 | nuclear_norm = 6756.23682
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 306.02286 | spectral_norm = 24.18099 | nuclear_norm = 7060.21143
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 360.90872 | spectral_norm = 28.03660 | nuclear_norm = 9571.04004
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 179.28680 | spectral_norm = 18.05836 | nuclear_norm = 4698.16992
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 153.37816 | spectral_norm = 14.31491 | nuclear_norm = 3368.15845
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 152.69600 | spectral_norm = 14.16803 | nuclear_norm = 3370.30518
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 310.18689 | spectral_norm = 28.81408 | nuclear_norm = 6959.51562
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 317.17514 | spectral_norm = 24.17072 | nuclear_norm = 7519.11914
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 361.47424 | spectral_norm = 27.90190 | nuclear_norm = 9638.09570
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 175.15250 | spectral_norm = 15.91364 | nuclear_norm = 4623.12207
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 156.01961 | spectral_norm = 17.32357 | nuclear_norm = 3520.40405
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 153.05992 | spectral_norm = 16.12185 | nuclear_norm = 3496.09473
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 322.44916 | spectral_norm = 30.05803 | nuclear_norm = 7349.21289
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 320.42386 | spectral_norm = 25.69272 | nuclear_norm = 7509.16650
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 357.81070 | spectral_norm = 28.55614 | nuclear_norm = 9521.79297
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 178.61906 | spectral_norm = 17.36026 | nuclear_norm = 4706.59375
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 155.34053 | spectral_norm = 15.97080 | nuclear_norm = 3499.60352
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 153.75681 | spectral_norm = 15.29456 | nuclear_norm = 3483.50073
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 327.60306 | spectral_norm = 28.62122 | nuclear_norm = 7381.95264
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 322.32385 | spectral_norm = 24.27160 | nuclear_norm = 7514.75195
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 360.63342 | spectral_norm = 29.02691 | nuclear_norm = 9577.14062
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 180.06317 | spectral_norm = 17.71733 | nuclear_norm = 4747.10889
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 161.37346 | spectral_norm = 16.90848 | nuclear_norm = 3675.81909
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 159.74994 | spectral_norm = 15.58904 | nuclear_norm = 3660.44214
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 317.15292 | spectral_norm = 26.67760 | nuclear_norm = 7190.90576
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 313.42212 | spectral_norm = 24.33322 | nuclear_norm = 7303.60645
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 368.40891 | spectral_norm = 30.49437 | nuclear_norm = 9780.44336
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 182.68626 | spectral_norm = 17.96101 | nuclear_norm = 4824.34277
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 160.09492 | spectral_norm = 17.25172 | nuclear_norm = 3555.54346
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 161.50171 | spectral_norm = 15.70081 | nuclear_norm = 3542.18799
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 341.76553 | spectral_norm = 33.53163 | nuclear_norm = 7748.91748
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 335.56000 | spectral_norm = 23.33439 | nuclear_norm = 7828.12500
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 351.47546 | spectral_norm = 28.55232 | nuclear_norm = 9341.13867
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 182.25427 | spectral_norm = 18.55866 | nuclear_norm = 4841.04541
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 164.14932 | spectral_norm = 17.74164 | nuclear_norm = 3667.60938
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 161.78050 | spectral_norm = 16.97328 | nuclear_norm = 3599.27783
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 335.95181 | spectral_norm = 33.18711 | nuclear_norm = 7660.97217
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 338.30115 | spectral_norm = 23.88163 | nuclear_norm = 7974.69434
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 367.79364 | spectral_norm = 28.73607 | nuclear_norm = 9794.61523
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 177.12944 | spectral_norm = 20.81433 | nuclear_norm = 4684.76758
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 165.01187 | spectral_norm = 20.83050 | nuclear_norm = 3693.76660
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 159.16409 | spectral_norm = 19.35690 | nuclear_norm = 3549.84668
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 282.81363 | spectral_norm = 28.61001 | nuclear_norm = 6538.89746
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 320.87189 | spectral_norm = 22.54891 | nuclear_norm = 7565.87793
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 398.32150 | spectral_norm = 29.75130 | nuclear_norm = 10604.81641
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 196.17067 | spectral_norm = 23.56837 | nuclear_norm = 5158.43115
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1169.27881 | spectral_norm = 167.35036 | nuclear_norm = 30658.67383
===========================================
step:1001/1750 train_loss:3.6117 train_time:721143ms step_avg:727.69ms
step:1002/1750 train_loss:3.4758 train_time:721886ms step_avg:727.71ms
step:1003/1750 train_loss:3.5304 train_time:722643ms step_avg:727.74ms
step:1004/1750 train_loss:3.4092 train_time:723433ms step_avg:727.80ms
step:1005/1750 train_loss:3.5690 train_time:724214ms step_avg:727.85ms
step:1006/1750 train_loss:3.6318 train_time:724996ms step_avg:727.91ms
step:1007/1750 train_loss:3.4209 train_time:725762ms step_avg:727.95ms
step:1008/1750 train_loss:3.4973 train_time:726526ms step_avg:727.98ms
step:1009/1750 train_loss:3.4732 train_time:727293ms step_avg:728.02ms
step:1010/1750 train_loss:3.5896 train_time:728076ms step_avg:728.08ms
step:1011/1750 train_loss:3.6911 train_time:728882ms step_avg:728.15ms
step:1012/1750 train_loss:3.5840 train_time:729656ms step_avg:728.20ms
step:1013/1750 train_loss:3.5645 train_time:730414ms step_avg:728.23ms
step:1014/1750 train_loss:3.4172 train_time:731195ms step_avg:728.28ms
step:1015/1750 train_loss:3.5651 train_time:731940ms step_avg:728.30ms
step:1016/1750 train_loss:3.6597 train_time:732696ms step_avg:728.33ms
step:1017/1750 train_loss:3.3565 train_time:733460ms step_avg:728.36ms
step:1018/1750 train_loss:3.4341 train_time:734251ms step_avg:728.42ms
step:1019/1750 train_loss:3.4302 train_time:735045ms step_avg:728.49ms
step:1020/1750 train_loss:3.4322 train_time:735798ms step_avg:728.51ms
step:1021/1750 train_loss:3.5570 train_time:736561ms step_avg:728.55ms
step:1022/1750 train_loss:3.4185 train_time:737330ms step_avg:728.59ms
step:1023/1750 train_loss:3.3859 train_time:738102ms step_avg:728.63ms
step:1024/1750 train_loss:3.5108 train_time:738867ms step_avg:728.67ms
step:1025/1750 train_loss:3.5395 train_time:739655ms step_avg:728.72ms
step:1026/1750 train_loss:3.5033 train_time:740440ms step_avg:728.78ms
step:1027/1750 train_loss:3.5122 train_time:741219ms step_avg:728.83ms
step:1028/1750 train_loss:3.6598 train_time:741977ms step_avg:728.86ms
step:1029/1750 train_loss:3.3580 train_time:742763ms step_avg:728.91ms
step:1030/1750 train_loss:3.4269 train_time:743580ms step_avg:729.00ms
step:1031/1750 train_loss:3.3451 train_time:744355ms step_avg:729.05ms
step:1032/1750 train_loss:3.5684 train_time:745101ms step_avg:729.06ms
step:1033/1750 train_loss:3.5484 train_time:745874ms step_avg:729.10ms
step:1034/1750 train_loss:3.7332 train_time:746664ms step_avg:729.16ms
step:1035/1750 train_loss:3.5272 train_time:747432ms step_avg:729.20ms
step:1036/1750 train_loss:3.4525 train_time:748230ms step_avg:729.27ms
step:1037/1750 train_loss:3.4847 train_time:749009ms step_avg:729.32ms
step:1038/1750 train_loss:3.5156 train_time:749773ms step_avg:729.35ms
step:1039/1750 train_loss:3.8187 train_time:750541ms step_avg:729.39ms
step:1040/1750 train_loss:3.6560 train_time:751308ms step_avg:729.43ms
step:1041/1750 train_loss:3.5470 train_time:752074ms step_avg:729.46ms
step:1042/1750 train_loss:3.4478 train_time:752841ms step_avg:729.50ms
step:1043/1750 train_loss:3.5201 train_time:753627ms step_avg:729.55ms
step:1044/1750 train_loss:3.5580 train_time:754418ms step_avg:729.61ms
step:1045/1750 train_loss:3.4842 train_time:755170ms step_avg:729.63ms
step:1046/1750 train_loss:3.4927 train_time:755926ms step_avg:729.66ms
step:1047/1750 train_loss:3.5510 train_time:756706ms step_avg:729.71ms
step:1048/1750 train_loss:3.4672 train_time:757473ms step_avg:729.74ms
step:1049/1750 train_loss:3.6726 train_time:758245ms step_avg:729.78ms
step:1050/1750 train_loss:3.5375 train_time:759026ms step_avg:729.83ms
step:1051/1750 train_loss:3.4411 train_time:759792ms step_avg:729.87ms
step:1052/1750 train_loss:3.4404 train_time:760564ms step_avg:729.91ms
step:1053/1750 train_loss:3.5372 train_time:761325ms step_avg:729.94ms
step:1054/1750 train_loss:3.3944 train_time:762090ms step_avg:729.97ms
step:1055/1750 train_loss:3.7355 train_time:762837ms step_avg:729.99ms
step:1056/1750 train_loss:3.5747 train_time:763610ms step_avg:730.03ms
step:1057/1750 train_loss:3.4194 train_time:764380ms step_avg:730.07ms
step:1058/1750 train_loss:3.5391 train_time:765158ms step_avg:730.11ms
step:1059/1750 train_loss:3.6296 train_time:765911ms step_avg:730.13ms
step:1060/1750 train_loss:3.3451 train_time:766695ms step_avg:730.19ms
step:1061/1750 train_loss:3.3961 train_time:767492ms step_avg:730.25ms
step:1062/1750 train_loss:3.4872 train_time:768251ms step_avg:730.28ms
step:1063/1750 train_loss:3.4577 train_time:769017ms step_avg:730.31ms
step:1064/1750 train_loss:3.4180 train_time:769781ms step_avg:730.34ms
step:1065/1750 train_loss:3.5081 train_time:770541ms step_avg:730.37ms
step:1066/1750 train_loss:3.4296 train_time:771303ms step_avg:730.40ms
step:1067/1750 train_loss:3.4021 train_time:772068ms step_avg:730.43ms
step:1068/1750 train_loss:3.4578 train_time:772843ms step_avg:730.48ms
step:1069/1750 train_loss:3.3303 train_time:773622ms step_avg:730.52ms
step:1070/1750 train_loss:3.4814 train_time:774380ms step_avg:730.55ms
step:1071/1750 train_loss:3.3500 train_time:775168ms step_avg:730.60ms
step:1072/1750 train_loss:3.6180 train_time:775918ms step_avg:730.62ms
step:1073/1750 train_loss:3.5589 train_time:776718ms step_avg:730.68ms
step:1074/1750 train_loss:3.4857 train_time:777479ms step_avg:730.71ms
step:1075/1750 train_loss:3.5674 train_time:778239ms step_avg:730.74ms
step:1076/1750 train_loss:3.4862 train_time:779026ms step_avg:730.79ms
step:1077/1750 train_loss:3.4465 train_time:779784ms step_avg:730.82ms
step:1078/1750 train_loss:3.8392 train_time:780536ms step_avg:730.84ms
step:1079/1750 train_loss:3.4867 train_time:781298ms step_avg:730.87ms
step:1080/1750 train_loss:3.1156 train_time:782120ms step_avg:730.95ms
step:1081/1750 train_loss:3.5773 train_time:782877ms step_avg:730.98ms
step:1082/1750 train_loss:3.4758 train_time:783654ms step_avg:731.02ms
step:1083/1750 train_loss:3.5630 train_time:784459ms step_avg:731.09ms
step:1084/1750 train_loss:3.6386 train_time:785230ms step_avg:731.13ms
step:1085/1750 train_loss:3.5511 train_time:785985ms step_avg:731.15ms
step:1086/1750 train_loss:3.5192 train_time:786748ms step_avg:731.18ms
step:1087/1750 train_loss:3.4773 train_time:787511ms step_avg:731.21ms
step:1088/1750 train_loss:3.6847 train_time:788303ms step_avg:731.26ms
step:1089/1750 train_loss:3.5624 train_time:789099ms step_avg:731.32ms
step:1090/1750 train_loss:3.4155 train_time:789861ms step_avg:731.35ms
step:1091/1750 train_loss:3.4292 train_time:790640ms step_avg:731.40ms
step:1092/1750 train_loss:3.5391 train_time:791409ms step_avg:731.43ms
step:1093/1750 train_loss:3.3342 train_time:792174ms step_avg:731.46ms
step:1094/1750 train_loss:3.5436 train_time:792930ms step_avg:731.49ms
step:1095/1750 train_loss:3.6493 train_time:793692ms step_avg:731.51ms
step:1096/1750 train_loss:3.4965 train_time:794476ms step_avg:731.56ms
step:1097/1750 train_loss:3.4705 train_time:795236ms step_avg:731.59ms
step:1098/1750 train_loss:3.4835 train_time:796015ms step_avg:731.63ms
step:1099/1750 train_loss:3.5435 train_time:796767ms step_avg:731.65ms
step:1100/1750 train_loss:3.6077 train_time:797560ms step_avg:731.71ms
step:1101/1750 train_loss:3.5800 train_time:798342ms step_avg:731.75ms
step:1102/1750 train_loss:3.4887 train_time:799126ms step_avg:731.80ms
step:1103/1750 train_loss:3.3403 train_time:799891ms step_avg:731.83ms
step:1104/1750 train_loss:3.3585 train_time:800681ms step_avg:731.88ms
step:1105/1750 train_loss:3.5008 train_time:801466ms step_avg:731.93ms
step:1106/1750 train_loss:3.3715 train_time:802223ms step_avg:731.96ms
step:1107/1750 train_loss:4.1236 train_time:803022ms step_avg:732.02ms
step:1108/1750 train_loss:3.2875 train_time:803788ms step_avg:732.05ms
step:1109/1750 train_loss:3.6213 train_time:804561ms step_avg:732.08ms
step:1110/1750 train_loss:3.3959 train_time:805317ms step_avg:732.11ms
step:1111/1750 train_loss:3.5586 train_time:806063ms step_avg:732.12ms
step:1112/1750 train_loss:3.4934 train_time:806820ms step_avg:732.14ms
step:1113/1750 train_loss:3.5450 train_time:807608ms step_avg:732.19ms
step:1114/1750 train_loss:3.6238 train_time:808377ms step_avg:732.23ms
step:1115/1750 train_loss:3.4953 train_time:809128ms step_avg:732.24ms
step:1116/1750 train_loss:3.4268 train_time:809900ms step_avg:732.28ms
step:1117/1750 train_loss:3.2922 train_time:810734ms step_avg:732.37ms
step:1118/1750 train_loss:3.4835 train_time:811473ms step_avg:732.38ms
step:1119/1750 train_loss:3.6487 train_time:812279ms step_avg:732.44ms
step:1120/1750 train_loss:3.6823 train_time:813046ms step_avg:732.47ms
step:1121/1750 train_loss:3.5398 train_time:813799ms step_avg:732.49ms
step:1122/1750 train_loss:3.5492 train_time:814566ms step_avg:732.52ms
step:1123/1750 train_loss:3.4387 train_time:815320ms step_avg:732.54ms
step:1124/1750 train_loss:3.5182 train_time:816061ms step_avg:732.55ms
step:1125/1750 train_loss:3.6519 train_time:816855ms step_avg:732.61ms
step:1125/1750 val_loss:3.4694 train_time:816869ms step_avg:732.62ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 280.44720 | frobenius_norm = 64654.41016 | spectral_norm = 11366.07617 | nuclear_norm = 1623480.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 171.80959 | spectral_norm = 32.14702 | nuclear_norm = 3933.72754
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 165.41881 | spectral_norm = 33.98335 | nuclear_norm = 3761.30347
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 330.26099 | spectral_norm = 21.29907 | nuclear_norm = 8085.30225
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 240.00226 | spectral_norm = 26.57463 | nuclear_norm = 5543.13867
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 375.94260 | spectral_norm = 32.56586 | nuclear_norm = 9997.75293
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 193.29558 | spectral_norm = 18.14278 | nuclear_norm = 5132.95312
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 180.62430 | spectral_norm = 16.81652 | nuclear_norm = 4173.58789
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 179.88356 | spectral_norm = 16.44404 | nuclear_norm = 4168.44678
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 307.60995 | spectral_norm = 28.01772 | nuclear_norm = 7098.10938
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 301.83087 | spectral_norm = 24.16091 | nuclear_norm = 7081.69434
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 375.06927 | spectral_norm = 28.04002 | nuclear_norm = 10000.91016
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 190.79469 | spectral_norm = 19.18323 | nuclear_norm = 5048.36084
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 175.17381 | spectral_norm = 16.73295 | nuclear_norm = 4044.59863
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 171.87042 | spectral_norm = 17.26687 | nuclear_norm = 3970.07983
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 338.55368 | spectral_norm = 29.57240 | nuclear_norm = 7720.38281
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 328.61084 | spectral_norm = 24.21037 | nuclear_norm = 7744.87158
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 378.53241 | spectral_norm = 30.60521 | nuclear_norm = 10099.51172
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 190.45381 | spectral_norm = 18.22326 | nuclear_norm = 5024.63965
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 170.53496 | spectral_norm = 19.10275 | nuclear_norm = 3905.63770
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 168.11269 | spectral_norm = 16.74076 | nuclear_norm = 3880.45947
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 332.92410 | spectral_norm = 28.92733 | nuclear_norm = 7568.40088
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 333.91074 | spectral_norm = 26.67949 | nuclear_norm = 7791.22021
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 385.56931 | spectral_norm = 31.77026 | nuclear_norm = 10264.79688
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 185.61220 | spectral_norm = 18.59134 | nuclear_norm = 4854.39258
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 167.77863 | spectral_norm = 18.93490 | nuclear_norm = 3817.43140
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 165.79712 | spectral_norm = 17.58900 | nuclear_norm = 3805.86279
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 318.94537 | spectral_norm = 28.07873 | nuclear_norm = 7241.16260
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 327.32996 | spectral_norm = 26.12589 | nuclear_norm = 7555.51758
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 385.48096 | spectral_norm = 30.60848 | nuclear_norm = 10220.42480
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 191.92015 | spectral_norm = 19.64248 | nuclear_norm = 5027.07031
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 164.16620 | spectral_norm = 15.33998 | nuclear_norm = 3595.53906
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 163.49362 | spectral_norm = 15.32393 | nuclear_norm = 3600.27344
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 332.56595 | spectral_norm = 31.00647 | nuclear_norm = 7468.01953
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 338.58896 | spectral_norm = 26.01805 | nuclear_norm = 8030.65137
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 387.25351 | spectral_norm = 30.43892 | nuclear_norm = 10323.77344
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 187.67633 | spectral_norm = 17.31869 | nuclear_norm = 4953.79785
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 167.31381 | spectral_norm = 18.76300 | nuclear_norm = 3766.95288
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 164.06075 | spectral_norm = 17.27195 | nuclear_norm = 3741.69727
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 346.01471 | spectral_norm = 32.04686 | nuclear_norm = 7892.01855
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 343.46017 | spectral_norm = 27.39083 | nuclear_norm = 8054.82471
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 383.15515 | spectral_norm = 31.30601 | nuclear_norm = 10198.83789
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 191.30214 | spectral_norm = 18.98788 | nuclear_norm = 5041.76465
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 166.39700 | spectral_norm = 17.32959 | nuclear_norm = 3739.90186
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 164.66148 | spectral_norm = 16.59412 | nuclear_norm = 3722.32568
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 351.21725 | spectral_norm = 30.50646 | nuclear_norm = 7917.67383
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 344.43936 | spectral_norm = 25.86905 | nuclear_norm = 8026.92188
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 386.75433 | spectral_norm = 31.65075 | nuclear_norm = 10269.12500
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 192.87065 | spectral_norm = 19.43187 | nuclear_norm = 5083.65283
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 172.88277 | spectral_norm = 18.43713 | nuclear_norm = 3928.84521
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 171.35957 | spectral_norm = 16.89016 | nuclear_norm = 3922.78271
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 339.27509 | spectral_norm = 28.78231 | nuclear_norm = 7692.65137
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 334.48083 | spectral_norm = 26.05391 | nuclear_norm = 7788.02295
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 395.71964 | spectral_norm = 33.12652 | nuclear_norm = 10502.27051
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 195.92567 | spectral_norm = 19.70128 | nuclear_norm = 5171.75000
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 171.61485 | spectral_norm = 18.83326 | nuclear_norm = 3799.12134
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 173.29289 | spectral_norm = 17.05778 | nuclear_norm = 3784.97046
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 365.01715 | spectral_norm = 36.61042 | nuclear_norm = 8260.38086
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 357.36069 | spectral_norm = 24.93782 | nuclear_norm = 8334.15527
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 377.26987 | spectral_norm = 31.05308 | nuclear_norm = 10021.73438
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 195.72415 | spectral_norm = 20.22342 | nuclear_norm = 5199.17822
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 176.17134 | spectral_norm = 19.19894 | nuclear_norm = 3925.91797
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 173.49857 | spectral_norm = 18.48900 | nuclear_norm = 3848.82983
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 360.72284 | spectral_norm = 36.41302 | nuclear_norm = 8214.36035
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 361.60562 | spectral_norm = 25.50724 | nuclear_norm = 8522.29297
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 394.95663 | spectral_norm = 31.28059 | nuclear_norm = 10515.21484
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 189.89661 | spectral_norm = 22.79795 | nuclear_norm = 5022.44092
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 176.62560 | spectral_norm = 22.73323 | nuclear_norm = 3935.23853
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 170.30794 | spectral_norm = 21.15700 | nuclear_norm = 3782.80005
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 301.50015 | spectral_norm = 30.92142 | nuclear_norm = 6965.95361
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 343.90579 | spectral_norm = 24.18951 | nuclear_norm = 8104.43945
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 427.82901 | spectral_norm = 32.08714 | nuclear_norm = 11387.40625
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 212.08823 | spectral_norm = 26.12276 | nuclear_norm = 5575.70898
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1241.27173 | spectral_norm = 168.07404 | nuclear_norm = 32633.94727
===========================================
step:1126/1750 train_loss:3.4063 train_time:817625ms step_avg:732.64ms
step:1127/1750 train_loss:3.2652 train_time:818410ms step_avg:732.69ms
step:1128/1750 train_loss:3.5375 train_time:819205ms step_avg:732.74ms
step:1129/1750 train_loss:3.7327 train_time:819973ms step_avg:732.77ms
step:1130/1750 train_loss:3.2933 train_time:820754ms step_avg:732.82ms
step:1131/1750 train_loss:3.6161 train_time:821522ms step_avg:732.85ms
step:1132/1750 train_loss:3.4359 train_time:822273ms step_avg:732.86ms
step:1133/1750 train_loss:3.4572 train_time:823034ms step_avg:732.89ms
step:1134/1750 train_loss:3.4254 train_time:823788ms step_avg:732.91ms
step:1135/1750 train_loss:3.5464 train_time:824599ms step_avg:732.98ms
step:1136/1750 train_loss:3.5041 train_time:825359ms step_avg:733.00ms
step:1137/1750 train_loss:3.5813 train_time:826132ms step_avg:733.04ms
step:1138/1750 train_loss:3.6193 train_time:826916ms step_avg:733.08ms
step:1139/1750 train_loss:3.5136 train_time:827697ms step_avg:733.12ms
step:1140/1750 train_loss:3.4038 train_time:828626ms step_avg:733.30ms
step:1141/1750 train_loss:3.7123 train_time:829393ms step_avg:733.33ms
step:1142/1750 train_loss:3.5264 train_time:830149ms step_avg:733.35ms
step:1143/1750 train_loss:3.5841 train_time:831084ms step_avg:733.52ms
step:1144/1750 train_loss:3.6261 train_time:831843ms step_avg:733.55ms
step:1145/1750 train_loss:3.2118 train_time:832620ms step_avg:733.59ms
step:1146/1750 train_loss:3.5519 train_time:833400ms step_avg:733.63ms
step:1147/1750 train_loss:3.4069 train_time:834165ms step_avg:733.65ms
step:1148/1750 train_loss:3.4576 train_time:834915ms step_avg:733.67ms
step:1149/1750 train_loss:3.5154 train_time:835674ms step_avg:733.69ms
step:1150/1750 train_loss:3.5957 train_time:836432ms step_avg:733.71ms
step:1151/1750 train_loss:3.5603 train_time:837192ms step_avg:733.74ms
step:1152/1750 train_loss:3.4535 train_time:837982ms step_avg:733.78ms
step:1153/1750 train_loss:3.4146 train_time:838773ms step_avg:733.83ms
step:1154/1750 train_loss:3.6430 train_time:839536ms step_avg:733.86ms
step:1155/1750 train_loss:3.6487 train_time:840314ms step_avg:733.90ms
step:1156/1750 train_loss:3.3564 train_time:841077ms step_avg:733.92ms
step:1157/1750 train_loss:3.3548 train_time:841827ms step_avg:733.94ms
step:1158/1750 train_loss:3.5069 train_time:842628ms step_avg:734.00ms
step:1159/1750 train_loss:3.5235 train_time:843400ms step_avg:734.03ms
step:1160/1750 train_loss:3.2824 train_time:844159ms step_avg:734.05ms
step:1161/1750 train_loss:3.3564 train_time:844915ms step_avg:734.07ms
step:1162/1750 train_loss:3.3509 train_time:845674ms step_avg:734.09ms
step:1163/1750 train_loss:3.5665 train_time:846438ms step_avg:734.12ms
step:1164/1750 train_loss:3.3751 train_time:847217ms step_avg:734.16ms
step:1165/1750 train_loss:3.4990 train_time:847989ms step_avg:734.19ms
step:1166/1750 train_loss:3.4593 train_time:848751ms step_avg:734.21ms
step:1167/1750 train_loss:3.4678 train_time:849524ms step_avg:734.25ms
step:1168/1750 train_loss:3.4510 train_time:850282ms step_avg:734.27ms
step:1169/1750 train_loss:3.4450 train_time:851044ms step_avg:734.29ms
step:1170/1750 train_loss:3.6540 train_time:851822ms step_avg:734.33ms
step:1171/1750 train_loss:3.4239 train_time:852596ms step_avg:734.36ms
step:1172/1750 train_loss:3.5091 train_time:853355ms step_avg:734.38ms
step:1173/1750 train_loss:3.4826 train_time:854137ms step_avg:734.43ms
step:1174/1750 train_loss:3.3791 train_time:854895ms step_avg:734.45ms
step:1175/1750 train_loss:3.4736 train_time:855653ms step_avg:734.47ms
step:1176/1750 train_loss:3.8145 train_time:856512ms step_avg:734.57ms
step:1177/1750 train_loss:3.4453 train_time:857286ms step_avg:734.61ms
step:1178/1750 train_loss:3.4539 train_time:858057ms step_avg:734.64ms
step:1179/1750 train_loss:3.3337 train_time:858868ms step_avg:734.70ms
step:1180/1750 train_loss:3.4749 train_time:859635ms step_avg:734.73ms
step:1181/1750 train_loss:3.4917 train_time:860392ms step_avg:734.75ms
step:1182/1750 train_loss:3.4219 train_time:861166ms step_avg:734.78ms
step:1183/1750 train_loss:3.3427 train_time:861948ms step_avg:734.82ms
step:1184/1750 train_loss:3.4775 train_time:862727ms step_avg:734.86ms
step:1185/1750 train_loss:3.5863 train_time:863500ms step_avg:734.89ms
step:1186/1750 train_loss:3.7558 train_time:864274ms step_avg:734.93ms
step:1187/1750 train_loss:3.5971 train_time:865047ms step_avg:734.96ms
step:1188/1750 train_loss:3.4374 train_time:865836ms step_avg:735.01ms
step:1189/1750 train_loss:3.2976 train_time:866658ms step_avg:735.08ms
step:1190/1750 train_loss:3.4294 train_time:867435ms step_avg:735.11ms
step:1191/1750 train_loss:3.4235 train_time:868194ms step_avg:735.13ms
step:1192/1750 train_loss:3.4712 train_time:868963ms step_avg:735.16ms
step:1193/1750 train_loss:3.3895 train_time:869728ms step_avg:735.19ms
step:1194/1750 train_loss:3.5503 train_time:870495ms step_avg:735.22ms
step:1195/1750 train_loss:3.4146 train_time:871252ms step_avg:735.23ms
step:1196/1750 train_loss:3.4014 train_time:872040ms step_avg:735.28ms
step:1197/1750 train_loss:3.3912 train_time:872826ms step_avg:735.32ms
step:1198/1750 train_loss:3.4768 train_time:873591ms step_avg:735.35ms
step:1199/1750 train_loss:3.4468 train_time:874348ms step_avg:735.36ms
step:1200/1750 train_loss:3.4039 train_time:875144ms step_avg:735.42ms
step:1201/1750 train_loss:3.8204 train_time:875975ms step_avg:735.50ms
step:1202/1750 train_loss:3.3560 train_time:876746ms step_avg:735.52ms
step:1203/1750 train_loss:3.4459 train_time:877508ms step_avg:735.55ms
step:1204/1750 train_loss:3.4434 train_time:878291ms step_avg:735.59ms
step:1205/1750 train_loss:3.5140 train_time:879120ms step_avg:735.66ms
step:1206/1750 train_loss:3.5140 train_time:879893ms step_avg:735.70ms
step:1207/1750 train_loss:3.4789 train_time:880685ms step_avg:735.74ms
step:1208/1750 train_loss:3.3950 train_time:881456ms step_avg:735.77ms
step:1209/1750 train_loss:3.4610 train_time:882221ms step_avg:735.80ms
step:1210/1750 train_loss:3.3985 train_time:882998ms step_avg:735.83ms
step:1211/1750 train_loss:3.4732 train_time:883766ms step_avg:735.86ms
step:1212/1750 train_loss:3.6984 train_time:884560ms step_avg:735.91ms
step:1213/1750 train_loss:3.3863 train_time:885323ms step_avg:735.93ms
step:1214/1750 train_loss:3.6369 train_time:886083ms step_avg:735.95ms
step:1215/1750 train_loss:3.4383 train_time:886845ms step_avg:735.97ms
step:1216/1750 train_loss:3.5233 train_time:887615ms step_avg:736.00ms
step:1217/1750 train_loss:3.4767 train_time:888394ms step_avg:736.03ms
step:1218/1750 train_loss:3.4817 train_time:889148ms step_avg:736.05ms
step:1219/1750 train_loss:3.5160 train_time:889923ms step_avg:736.08ms
step:1220/1750 train_loss:3.4332 train_time:890685ms step_avg:736.10ms
step:1221/1750 train_loss:3.4880 train_time:891440ms step_avg:736.12ms
step:1222/1750 train_loss:3.4967 train_time:892218ms step_avg:736.15ms
step:1223/1750 train_loss:3.4981 train_time:892983ms step_avg:736.18ms
step:1224/1750 train_loss:3.4591 train_time:893795ms step_avg:736.24ms
step:1225/1750 train_loss:3.4442 train_time:894559ms step_avg:736.26ms
step:1226/1750 train_loss:3.3450 train_time:895333ms step_avg:736.29ms
step:1227/1750 train_loss:3.5005 train_time:896110ms step_avg:736.33ms
step:1228/1750 train_loss:3.2956 train_time:896864ms step_avg:736.34ms
step:1229/1750 train_loss:3.5904 train_time:897641ms step_avg:736.37ms
step:1230/1750 train_loss:3.4041 train_time:898412ms step_avg:736.40ms
step:1231/1750 train_loss:3.4174 train_time:899214ms step_avg:736.46ms
step:1232/1750 train_loss:3.5736 train_time:900017ms step_avg:736.51ms
step:1233/1750 train_loss:3.3068 train_time:900797ms step_avg:736.55ms
step:1234/1750 train_loss:3.3812 train_time:901566ms step_avg:736.57ms
step:1235/1750 train_loss:3.4319 train_time:902330ms step_avg:736.60ms
step:1236/1750 train_loss:3.4468 train_time:903100ms step_avg:736.62ms
step:1237/1750 train_loss:3.4353 train_time:903890ms step_avg:736.67ms
step:1238/1750 train_loss:3.4071 train_time:904660ms step_avg:736.69ms
step:1239/1750 train_loss:3.6374 train_time:905417ms step_avg:736.71ms
step:1240/1750 train_loss:3.3899 train_time:906231ms step_avg:736.77ms
step:1241/1750 train_loss:3.2649 train_time:906993ms step_avg:736.79ms
step:1242/1750 train_loss:3.5389 train_time:907791ms step_avg:736.84ms
step:1243/1750 train_loss:3.2615 train_time:908569ms step_avg:736.88ms
step:1244/1750 train_loss:3.4360 train_time:909330ms step_avg:736.90ms
step:1245/1750 train_loss:3.6794 train_time:910092ms step_avg:736.92ms
step:1246/1750 train_loss:3.3639 train_time:910862ms step_avg:736.94ms
step:1247/1750 train_loss:3.4518 train_time:911613ms step_avg:736.95ms
step:1248/1750 train_loss:3.5423 train_time:912360ms step_avg:736.96ms
step:1249/1750 train_loss:3.2505 train_time:913127ms step_avg:736.99ms
step:1250/1750 train_loss:3.3665 train_time:913900ms step_avg:737.02ms
step:1250/1750 val_loss:3.4178 train_time:913913ms step_avg:737.03ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 288.88547 | frobenius_norm = 66640.52344 | spectral_norm = 11675.86523 | nuclear_norm = 1675983.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 180.10577 | spectral_norm = 34.68995 | nuclear_norm = 4116.48730
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 173.86723 | spectral_norm = 36.57353 | nuclear_norm = 3946.33447
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 346.20303 | spectral_norm = 22.27479 | nuclear_norm = 8501.33984
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 245.45018 | spectral_norm = 27.90223 | nuclear_norm = 5652.53613
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 397.60312 | spectral_norm = 34.80745 | nuclear_norm = 10570.96094
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 203.39333 | spectral_norm = 19.47249 | nuclear_norm = 5401.13135
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 190.34085 | spectral_norm = 17.76845 | nuclear_norm = 4394.62061
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 189.68359 | spectral_norm = 17.14418 | nuclear_norm = 4396.04297
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 320.97260 | spectral_norm = 29.30121 | nuclear_norm = 7406.86230
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 314.36716 | spectral_norm = 25.34293 | nuclear_norm = 7377.33594
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 394.50504 | spectral_norm = 29.68977 | nuclear_norm = 10522.47266
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 200.79048 | spectral_norm = 20.42066 | nuclear_norm = 5313.96289
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 184.40025 | spectral_norm = 17.83357 | nuclear_norm = 4254.74414
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 180.75902 | spectral_norm = 18.29473 | nuclear_norm = 4171.91992
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 355.78000 | spectral_norm = 31.30624 | nuclear_norm = 8113.75537
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 344.82739 | spectral_norm = 25.53606 | nuclear_norm = 8130.68555
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 397.35321 | spectral_norm = 32.74838 | nuclear_norm = 10603.77148
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 200.35722 | spectral_norm = 19.37179 | nuclear_norm = 5287.16113
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 179.42702 | spectral_norm = 20.27338 | nuclear_norm = 4103.59668
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 177.05702 | spectral_norm = 17.66092 | nuclear_norm = 4083.80078
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 350.73401 | spectral_norm = 30.53910 | nuclear_norm = 7978.16992
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 351.46747 | spectral_norm = 28.18230 | nuclear_norm = 8206.95508
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 404.42853 | spectral_norm = 33.93864 | nuclear_norm = 10767.77539
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 194.91925 | spectral_norm = 19.76629 | nuclear_norm = 5096.71094
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 176.55284 | spectral_norm = 20.06444 | nuclear_norm = 4010.25220
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 174.48282 | spectral_norm = 18.53448 | nuclear_norm = 4001.55518
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 335.96664 | spectral_norm = 29.68126 | nuclear_norm = 7632.20898
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 344.18341 | spectral_norm = 27.40982 | nuclear_norm = 7946.96289
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 404.43970 | spectral_norm = 32.50888 | nuclear_norm = 10719.70117
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 201.64008 | spectral_norm = 20.88246 | nuclear_norm = 5278.84082
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 172.45758 | spectral_norm = 16.19870 | nuclear_norm = 3769.78467
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 171.64714 | spectral_norm = 16.28548 | nuclear_norm = 3769.08057
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 350.28635 | spectral_norm = 32.60715 | nuclear_norm = 7872.26807
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 355.25687 | spectral_norm = 27.22496 | nuclear_norm = 8429.00391
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 406.76434 | spectral_norm = 32.50702 | nuclear_norm = 10841.54980
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 197.40761 | spectral_norm = 18.46367 | nuclear_norm = 5211.33154
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 176.07309 | spectral_norm = 20.03132 | nuclear_norm = 3956.47900
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 172.60701 | spectral_norm = 18.29828 | nuclear_norm = 3933.25098
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 364.92032 | spectral_norm = 33.73672 | nuclear_norm = 8334.46094
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 361.65005 | spectral_norm = 28.92941 | nuclear_norm = 8486.63672
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 402.27460 | spectral_norm = 33.47892 | nuclear_norm = 10708.21289
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 201.14195 | spectral_norm = 20.38713 | nuclear_norm = 5301.63330
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 174.96007 | spectral_norm = 18.42909 | nuclear_norm = 3922.66016
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 173.19911 | spectral_norm = 17.51940 | nuclear_norm = 3909.84302
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 369.92630 | spectral_norm = 31.96214 | nuclear_norm = 8347.78809
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 361.83630 | spectral_norm = 27.14672 | nuclear_norm = 8431.36621
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 406.73898 | spectral_norm = 33.81522 | nuclear_norm = 10797.80469
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 202.81677 | spectral_norm = 20.83594 | nuclear_norm = 5345.03271
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 181.82341 | spectral_norm = 19.62278 | nuclear_norm = 4120.44971
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 180.30934 | spectral_norm = 17.98939 | nuclear_norm = 4122.88379
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 356.78360 | spectral_norm = 30.27237 | nuclear_norm = 8094.05762
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 350.69095 | spectral_norm = 27.50754 | nuclear_norm = 8159.64209
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 416.71890 | spectral_norm = 35.27037 | nuclear_norm = 11055.39062
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 206.08696 | spectral_norm = 21.10760 | nuclear_norm = 5437.84619
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 180.44749 | spectral_norm = 20.01485 | nuclear_norm = 3980.75244
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 182.39246 | spectral_norm = 18.10330 | nuclear_norm = 3967.83521
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 384.09827 | spectral_norm = 39.27445 | nuclear_norm = 8680.00684
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 374.24191 | spectral_norm = 26.15706 | nuclear_norm = 8727.03711
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 396.93643 | spectral_norm = 33.13546 | nuclear_norm = 10537.19043
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 205.94608 | spectral_norm = 21.41753 | nuclear_norm = 5471.00293
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 185.23688 | spectral_norm = 20.62942 | nuclear_norm = 4112.37598
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 182.46562 | spectral_norm = 19.64793 | nuclear_norm = 4034.82104
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 381.42798 | spectral_norm = 38.88499 | nuclear_norm = 8676.85547
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 380.03488 | spectral_norm = 26.97295 | nuclear_norm = 8951.41211
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 415.25867 | spectral_norm = 33.39460 | nuclear_norm = 11053.01758
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 199.84322 | spectral_norm = 24.38469 | nuclear_norm = 5284.82178
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 185.56732 | spectral_norm = 24.27665 | nuclear_norm = 4118.81299
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 178.84549 | spectral_norm = 22.46938 | nuclear_norm = 3956.74707
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 316.77744 | spectral_norm = 32.55322 | nuclear_norm = 7316.86914
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 361.70264 | spectral_norm = 25.33878 | nuclear_norm = 8521.78418
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 449.70593 | spectral_norm = 33.90488 | nuclear_norm = 11966.18457
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 224.13976 | spectral_norm = 28.14627 | nuclear_norm = 5889.92188
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1291.77625 | spectral_norm = 167.60603 | nuclear_norm = 34037.83984
===========================================
step:1251/1750 train_loss:3.3772 train_time:914657ms step_avg:737.03ms
step:1252/1750 train_loss:3.2498 train_time:915414ms step_avg:737.05ms
step:1253/1750 train_loss:3.5005 train_time:916171ms step_avg:737.06ms
step:1254/1750 train_loss:3.5956 train_time:916998ms step_avg:737.14ms
step:1255/1750 train_loss:3.3486 train_time:917757ms step_avg:737.15ms
step:1256/1750 train_loss:3.5508 train_time:918507ms step_avg:737.16ms
step:1257/1750 train_loss:3.3009 train_time:919289ms step_avg:737.20ms
step:1258/1750 train_loss:3.4730 train_time:920063ms step_avg:737.23ms
step:1259/1750 train_loss:3.5585 train_time:920823ms step_avg:737.25ms
step:1260/1750 train_loss:3.4056 train_time:921585ms step_avg:737.27ms
step:1261/1750 train_loss:3.4599 train_time:922376ms step_avg:737.31ms
step:1262/1750 train_loss:3.5855 train_time:923148ms step_avg:737.34ms
step:1263/1750 train_loss:3.2540 train_time:923916ms step_avg:737.36ms
step:1264/1750 train_loss:3.5026 train_time:924687ms step_avg:737.39ms
step:1265/1750 train_loss:3.4330 train_time:925460ms step_avg:737.42ms
step:1266/1750 train_loss:3.4134 train_time:926232ms step_avg:737.45ms
step:1267/1750 train_loss:3.3394 train_time:927001ms step_avg:737.47ms
step:1268/1750 train_loss:3.3397 train_time:927791ms step_avg:737.51ms
step:1269/1750 train_loss:3.4514 train_time:928551ms step_avg:737.53ms
step:1270/1750 train_loss:3.3473 train_time:929326ms step_avg:737.56ms
step:1271/1750 train_loss:3.4666 train_time:930088ms step_avg:737.58ms
step:1272/1750 train_loss:3.4096 train_time:930864ms step_avg:737.61ms
step:1273/1750 train_loss:3.4537 train_time:931619ms step_avg:737.62ms
step:1274/1750 train_loss:3.3534 train_time:932393ms step_avg:737.65ms
step:1275/1750 train_loss:3.4801 train_time:933144ms step_avg:737.66ms
step:1276/1750 train_loss:3.4163 train_time:933897ms step_avg:737.68ms
step:1277/1750 train_loss:3.5078 train_time:934660ms step_avg:737.70ms
step:1278/1750 train_loss:3.4500 train_time:935420ms step_avg:737.71ms
step:1279/1750 train_loss:3.3752 train_time:936236ms step_avg:737.77ms
step:1280/1750 train_loss:3.3258 train_time:937000ms step_avg:737.79ms
step:1281/1750 train_loss:3.4039 train_time:937754ms step_avg:737.81ms
step:1282/1750 train_loss:3.3705 train_time:938527ms step_avg:737.84ms
step:1283/1750 train_loss:3.5471 train_time:939281ms step_avg:737.85ms
step:1284/1750 train_loss:3.3778 train_time:940047ms step_avg:737.87ms
step:1285/1750 train_loss:3.5284 train_time:940819ms step_avg:737.90ms
step:1286/1750 train_loss:3.3886 train_time:941596ms step_avg:737.93ms
step:1287/1750 train_loss:3.4735 train_time:942345ms step_avg:737.94ms
step:1288/1750 train_loss:3.4385 train_time:943098ms step_avg:737.95ms
step:1289/1750 train_loss:3.4407 train_time:943881ms step_avg:737.98ms
step:1290/1750 train_loss:3.4503 train_time:944663ms step_avg:738.02ms
step:1291/1750 train_loss:3.5925 train_time:945460ms step_avg:738.06ms
step:1292/1750 train_loss:3.4058 train_time:946249ms step_avg:738.10ms
step:1293/1750 train_loss:3.2079 train_time:947034ms step_avg:738.14ms
step:1294/1750 train_loss:3.4342 train_time:947787ms step_avg:738.15ms
step:1295/1750 train_loss:3.4103 train_time:948602ms step_avg:738.21ms
step:1296/1750 train_loss:3.4568 train_time:949370ms step_avg:738.23ms
step:1297/1750 train_loss:3.4983 train_time:950140ms step_avg:738.26ms
step:1298/1750 train_loss:3.4980 train_time:950895ms step_avg:738.27ms
step:1299/1750 train_loss:3.4501 train_time:951662ms step_avg:738.29ms
step:1300/1750 train_loss:3.4421 train_time:952419ms step_avg:738.31ms
step:1301/1750 train_loss:3.5772 train_time:953175ms step_avg:738.32ms
step:1302/1750 train_loss:3.4208 train_time:953934ms step_avg:738.34ms
step:1303/1750 train_loss:3.5112 train_time:954697ms step_avg:738.36ms
step:1304/1750 train_loss:3.4370 train_time:955447ms step_avg:738.37ms
step:1305/1750 train_loss:3.5198 train_time:956233ms step_avg:738.40ms
step:1306/1750 train_loss:3.6051 train_time:957022ms step_avg:738.44ms
step:1307/1750 train_loss:3.3955 train_time:957806ms step_avg:738.48ms
step:1308/1750 train_loss:3.3530 train_time:958568ms step_avg:738.50ms
step:1309/1750 train_loss:3.3695 train_time:959344ms step_avg:738.53ms
step:1310/1750 train_loss:3.4215 train_time:960101ms step_avg:738.54ms
step:1311/1750 train_loss:3.3614 train_time:960865ms step_avg:738.56ms
step:1312/1750 train_loss:3.5277 train_time:961628ms step_avg:738.58ms
step:1313/1750 train_loss:3.4096 train_time:962394ms step_avg:738.60ms
step:1314/1750 train_loss:3.4702 train_time:963157ms step_avg:738.62ms
step:1315/1750 train_loss:3.4445 train_time:963926ms step_avg:738.64ms
step:1316/1750 train_loss:3.4775 train_time:964691ms step_avg:738.66ms
step:1317/1750 train_loss:3.3094 train_time:965488ms step_avg:738.71ms
step:1318/1750 train_loss:3.5948 train_time:966233ms step_avg:738.71ms
step:1319/1750 train_loss:3.5039 train_time:967008ms step_avg:738.74ms
step:1320/1750 train_loss:3.3816 train_time:967762ms step_avg:738.75ms
step:1321/1750 train_loss:3.4936 train_time:968543ms step_avg:738.78ms
step:1322/1750 train_loss:3.4656 train_time:969293ms step_avg:738.79ms
step:1323/1750 train_loss:3.4496 train_time:970058ms step_avg:738.81ms
step:1324/1750 train_loss:3.6305 train_time:970851ms step_avg:738.85ms
step:1325/1750 train_loss:3.4919 train_time:971642ms step_avg:738.89ms
step:1326/1750 train_loss:3.5397 train_time:972402ms step_avg:738.91ms
step:1327/1750 train_loss:3.5515 train_time:973152ms step_avg:738.92ms
step:1328/1750 train_loss:3.2990 train_time:973933ms step_avg:738.95ms
step:1329/1750 train_loss:3.3851 train_time:974695ms step_avg:738.97ms
step:1330/1750 train_loss:3.4369 train_time:975688ms step_avg:739.16ms
step:1331/1750 train_loss:2.6802 train_time:976503ms step_avg:739.22ms
step:1332/1750 train_loss:3.4452 train_time:977284ms step_avg:739.25ms
step:1333/1750 train_loss:3.4148 train_time:978058ms step_avg:739.27ms
step:1334/1750 train_loss:3.3964 train_time:978812ms step_avg:739.28ms
step:1335/1750 train_loss:3.8066 train_time:979636ms step_avg:739.35ms
step:1336/1750 train_loss:3.5363 train_time:980394ms step_avg:739.36ms
step:1337/1750 train_loss:3.4345 train_time:981160ms step_avg:739.38ms
step:1338/1750 train_loss:3.3648 train_time:981944ms step_avg:739.42ms
step:1339/1750 train_loss:3.3535 train_time:982724ms step_avg:739.45ms
step:1340/1750 train_loss:3.6120 train_time:983505ms step_avg:739.48ms
step:1341/1750 train_loss:3.5804 train_time:984272ms step_avg:739.50ms
step:1342/1750 train_loss:3.4030 train_time:985055ms step_avg:739.53ms
step:1343/1750 train_loss:3.3432 train_time:985810ms step_avg:739.54ms
step:1344/1750 train_loss:3.6610 train_time:986583ms step_avg:739.57ms
step:1345/1750 train_loss:3.4172 train_time:987343ms step_avg:739.58ms
step:1346/1750 train_loss:3.4300 train_time:988118ms step_avg:739.61ms
step:1347/1750 train_loss:3.4805 train_time:988875ms step_avg:739.62ms
step:1348/1750 train_loss:3.4493 train_time:989641ms step_avg:739.64ms
step:1349/1750 train_loss:3.3547 train_time:990389ms step_avg:739.65ms
step:1350/1750 train_loss:3.3333 train_time:991150ms step_avg:739.66ms
step:1351/1750 train_loss:3.3990 train_time:991938ms step_avg:739.70ms
step:1352/1750 train_loss:3.3369 train_time:992711ms step_avg:739.73ms
step:1353/1750 train_loss:3.4510 train_time:993469ms step_avg:739.74ms
step:1354/1750 train_loss:3.3024 train_time:994227ms step_avg:739.75ms
step:1355/1750 train_loss:3.3642 train_time:994979ms step_avg:739.76ms
step:1356/1750 train_loss:3.4689 train_time:995756ms step_avg:739.79ms
step:1357/1750 train_loss:3.3166 train_time:996533ms step_avg:739.82ms
step:1358/1750 train_loss:3.2561 train_time:997289ms step_avg:739.83ms
step:1359/1750 train_loss:3.5720 train_time:998063ms step_avg:739.85ms
step:1360/1750 train_loss:3.4821 train_time:998835ms step_avg:739.88ms
step:1361/1750 train_loss:3.2369 train_time:999604ms step_avg:739.90ms
step:1362/1750 train_loss:3.5049 train_time:1000399ms step_avg:739.94ms
step:1363/1750 train_loss:3.4152 train_time:1001177ms step_avg:739.97ms
step:1364/1750 train_loss:3.1923 train_time:1001964ms step_avg:740.00ms
step:1365/1750 train_loss:3.4522 train_time:1002738ms step_avg:740.03ms
step:1366/1750 train_loss:3.3360 train_time:1003518ms step_avg:740.06ms
step:1367/1750 train_loss:3.3678 train_time:1004277ms step_avg:740.07ms
step:1368/1750 train_loss:3.3751 train_time:1005075ms step_avg:740.11ms
step:1369/1750 train_loss:3.4858 train_time:1005821ms step_avg:740.12ms
step:1370/1750 train_loss:3.4583 train_time:1006597ms step_avg:740.14ms
step:1371/1750 train_loss:3.4111 train_time:1007379ms step_avg:740.18ms
step:1372/1750 train_loss:3.3244 train_time:1008169ms step_avg:740.21ms
step:1373/1750 train_loss:3.6728 train_time:1008950ms step_avg:740.24ms
step:1374/1750 train_loss:3.3759 train_time:1009704ms step_avg:740.25ms
step:1375/1750 train_loss:3.4305 train_time:1010477ms step_avg:740.28ms
step:1375/1750 val_loss:3.3717 train_time:1010491ms step_avg:740.29ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 293.51617 | frobenius_norm = 67735.98438 | spectral_norm = 11859.90430 | nuclear_norm = 1705481.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 184.81937 | spectral_norm = 36.49083 | nuclear_norm = 4215.79590
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 178.76587 | spectral_norm = 38.40310 | nuclear_norm = 4050.68164
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 355.90039 | spectral_norm = 22.89582 | nuclear_norm = 8758.23926
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 247.84862 | spectral_norm = 28.76418 | nuclear_norm = 5694.79736
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 411.28027 | spectral_norm = 36.21259 | nuclear_norm = 10932.45020
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 209.49004 | spectral_norm = 20.31084 | nuclear_norm = 5563.68799
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 196.29933 | spectral_norm = 18.33430 | nuclear_norm = 4529.68848
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 195.62352 | spectral_norm = 17.67270 | nuclear_norm = 4532.60645
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 329.22449 | spectral_norm = 30.23220 | nuclear_norm = 7598.58252
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 321.88770 | spectral_norm = 25.89968 | nuclear_norm = 7555.07031
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 406.42090 | spectral_norm = 30.80431 | nuclear_norm = 10843.51660
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 206.87857 | spectral_norm = 21.14507 | nuclear_norm = 5477.30469
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 189.92978 | spectral_norm = 18.40449 | nuclear_norm = 4378.10400
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 186.17584 | spectral_norm = 19.01799 | nuclear_norm = 4294.84863
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 366.73331 | spectral_norm = 32.29572 | nuclear_norm = 8365.52734
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 355.06097 | spectral_norm = 26.23149 | nuclear_norm = 8378.36914
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 409.11932 | spectral_norm = 33.94920 | nuclear_norm = 10920.59668
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 206.38507 | spectral_norm = 20.10783 | nuclear_norm = 5447.45215
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 185.02650 | spectral_norm = 21.01203 | nuclear_norm = 4229.44824
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 182.60721 | spectral_norm = 18.22742 | nuclear_norm = 4209.56738
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 362.12857 | spectral_norm = 31.59663 | nuclear_norm = 8244.87109
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 362.64218 | spectral_norm = 29.09861 | nuclear_norm = 8472.68652
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 415.96854 | spectral_norm = 35.20628 | nuclear_norm = 11076.20703
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 200.62578 | spectral_norm = 20.53866 | nuclear_norm = 5246.80908
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 181.81070 | spectral_norm = 20.86622 | nuclear_norm = 4123.66602
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 179.52902 | spectral_norm = 19.08450 | nuclear_norm = 4115.04199
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 347.28680 | spectral_norm = 30.55353 | nuclear_norm = 7898.58545
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 355.30453 | spectral_norm = 28.28071 | nuclear_norm = 8210.78613
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 415.81522 | spectral_norm = 33.74014 | nuclear_norm = 11018.59375
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 207.45752 | spectral_norm = 21.68410 | nuclear_norm = 5428.49902
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 177.27849 | spectral_norm = 16.79790 | nuclear_norm = 3864.46582
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 176.54428 | spectral_norm = 16.74808 | nuclear_norm = 3867.46777
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 361.53439 | spectral_norm = 33.59765 | nuclear_norm = 8136.55176
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 365.85919 | spectral_norm = 28.00525 | nuclear_norm = 8683.34766
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 418.79044 | spectral_norm = 33.81442 | nuclear_norm = 11159.28027
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 203.34825 | spectral_norm = 19.19536 | nuclear_norm = 5369.23633
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 181.44522 | spectral_norm = 20.70711 | nuclear_norm = 4069.78125
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 177.89304 | spectral_norm = 18.84482 | nuclear_norm = 4049.40381
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 376.80035 | spectral_norm = 34.79338 | nuclear_norm = 8620.78906
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 373.16730 | spectral_norm = 29.64822 | nuclear_norm = 8763.23047
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 413.73834 | spectral_norm = 34.97248 | nuclear_norm = 11013.16602
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 207.04991 | spectral_norm = 21.29710 | nuclear_norm = 5458.45215
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 180.30595 | spectral_norm = 19.08423 | nuclear_norm = 4033.43872
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 178.42589 | spectral_norm = 18.02565 | nuclear_norm = 4021.47607
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 381.84515 | spectral_norm = 32.91612 | nuclear_norm = 8627.68164
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 372.82233 | spectral_norm = 27.92323 | nuclear_norm = 8688.42188
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 418.77209 | spectral_norm = 35.32555 | nuclear_norm = 11114.35645
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 208.79248 | spectral_norm = 21.70086 | nuclear_norm = 5502.07861
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 187.30399 | spectral_norm = 20.30085 | nuclear_norm = 4237.72363
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 185.81064 | spectral_norm = 18.55311 | nuclear_norm = 4243.48535
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 368.06573 | spectral_norm = 31.30780 | nuclear_norm = 8360.75000
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 360.91882 | spectral_norm = 28.36147 | nuclear_norm = 8396.65820
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 429.43655 | spectral_norm = 36.70002 | nuclear_norm = 11387.80566
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 212.23376 | spectral_norm = 21.99419 | nuclear_norm = 5598.12598
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 185.86134 | spectral_norm = 20.65569 | nuclear_norm = 4088.04443
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 187.98560 | spectral_norm = 18.78003 | nuclear_norm = 4073.09473
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 396.41916 | spectral_norm = 41.05391 | nuclear_norm = 8951.58789
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 384.46786 | spectral_norm = 27.09357 | nuclear_norm = 8964.90820
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 408.61365 | spectral_norm = 34.48341 | nuclear_norm = 10839.82422
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 212.07295 | spectral_norm = 22.16266 | nuclear_norm = 5633.90918
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 190.70500 | spectral_norm = 21.54020 | nuclear_norm = 4220.50684
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 187.94826 | spectral_norm = 20.42384 | nuclear_norm = 4142.01807
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 395.43622 | spectral_norm = 40.62856 | nuclear_norm = 8993.91602
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 391.47318 | spectral_norm = 27.84946 | nuclear_norm = 9218.20996
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 426.91104 | spectral_norm = 34.71057 | nuclear_norm = 11360.34277
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 206.04195 | spectral_norm = 25.31100 | nuclear_norm = 5449.10645
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 190.85718 | spectral_norm = 25.37356 | nuclear_norm = 4219.81787
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 183.86632 | spectral_norm = 23.60782 | nuclear_norm = 4050.20337
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 326.74054 | spectral_norm = 33.61403 | nuclear_norm = 7547.12695
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 372.91391 | spectral_norm = 26.06389 | nuclear_norm = 8781.18945
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 462.03180 | spectral_norm = 35.01313 | nuclear_norm = 12291.71387
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 231.12813 | spectral_norm = 29.43276 | nuclear_norm = 6070.59277
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1316.92688 | spectral_norm = 165.82191 | nuclear_norm = 34767.74219
===========================================
step:1376/1750 train_loss:3.4222 train_time:1011219ms step_avg:740.28ms
step:1377/1750 train_loss:3.2168 train_time:1012004ms step_avg:740.31ms
step:1378/1750 train_loss:3.6017 train_time:1012763ms step_avg:740.32ms
step:1379/1750 train_loss:3.4029 train_time:1013510ms step_avg:740.33ms
step:1380/1750 train_loss:3.5369 train_time:1014296ms step_avg:740.36ms
step:1381/1750 train_loss:3.5406 train_time:1015047ms step_avg:740.37ms
step:1382/1750 train_loss:3.1697 train_time:1015816ms step_avg:740.39ms
step:1383/1750 train_loss:3.3750 train_time:1016618ms step_avg:740.44ms
step:1384/1750 train_loss:3.7583 train_time:1017392ms step_avg:740.46ms
step:1385/1750 train_loss:3.2752 train_time:1018153ms step_avg:740.47ms
step:1386/1750 train_loss:3.4544 train_time:1018906ms step_avg:740.48ms
step:1387/1750 train_loss:3.5377 train_time:1019670ms step_avg:740.50ms
step:1388/1750 train_loss:3.4629 train_time:1020416ms step_avg:740.50ms
step:1389/1750 train_loss:3.4012 train_time:1021180ms step_avg:740.52ms
step:1390/1750 train_loss:3.2526 train_time:1021944ms step_avg:740.54ms
step:1391/1750 train_loss:3.4008 train_time:1022710ms step_avg:740.56ms
step:1392/1750 train_loss:3.3777 train_time:1023467ms step_avg:740.57ms
step:1393/1750 train_loss:3.6327 train_time:1024216ms step_avg:740.58ms
step:1394/1750 train_loss:3.3480 train_time:1024978ms step_avg:740.59ms
step:1395/1750 train_loss:3.3529 train_time:1025749ms step_avg:740.61ms
step:1396/1750 train_loss:3.3057 train_time:1026501ms step_avg:740.62ms
step:1397/1750 train_loss:3.5657 train_time:1027267ms step_avg:740.64ms
step:1398/1750 train_loss:3.4533 train_time:1028030ms step_avg:740.66ms
step:1399/1750 train_loss:3.4646 train_time:1028794ms step_avg:740.67ms
step:1400/1750 train_loss:3.3633 train_time:1029533ms step_avg:740.67ms
step:1401/1750 train_loss:3.3171 train_time:1030299ms step_avg:740.69ms
step:1402/1750 train_loss:3.3889 train_time:1031066ms step_avg:740.71ms
step:1403/1750 train_loss:3.3745 train_time:1031834ms step_avg:740.73ms
step:1404/1750 train_loss:3.4059 train_time:1032583ms step_avg:740.73ms
step:1405/1750 train_loss:3.3608 train_time:1033348ms step_avg:740.75ms
step:1406/1750 train_loss:3.5561 train_time:1034127ms step_avg:740.78ms
step:1407/1750 train_loss:3.3404 train_time:1034869ms step_avg:740.78ms
step:1408/1750 train_loss:3.3721 train_time:1035649ms step_avg:740.81ms
step:1409/1750 train_loss:3.3658 train_time:1036405ms step_avg:740.82ms
step:1410/1750 train_loss:3.2299 train_time:1037164ms step_avg:740.83ms
step:1411/1750 train_loss:3.3702 train_time:1037912ms step_avg:740.84ms
step:1412/1750 train_loss:3.3573 train_time:1038717ms step_avg:740.88ms
step:1413/1750 train_loss:3.3444 train_time:1039476ms step_avg:740.89ms
step:1414/1750 train_loss:3.4258 train_time:1040237ms step_avg:740.91ms
step:1415/1750 train_loss:3.3854 train_time:1040996ms step_avg:740.92ms
step:1416/1750 train_loss:3.4174 train_time:1041764ms step_avg:740.94ms
step:1417/1750 train_loss:3.3897 train_time:1042525ms step_avg:740.96ms
step:1418/1750 train_loss:3.4700 train_time:1043288ms step_avg:740.97ms
step:1419/1750 train_loss:3.2832 train_time:1044100ms step_avg:741.02ms
step:1420/1750 train_loss:3.3428 train_time:1044886ms step_avg:741.05ms
step:1421/1750 train_loss:3.4503 train_time:1045635ms step_avg:741.06ms
step:1422/1750 train_loss:3.4026 train_time:1046402ms step_avg:741.08ms
step:1423/1750 train_loss:3.4175 train_time:1047182ms step_avg:741.11ms
step:1424/1750 train_loss:3.4289 train_time:1047960ms step_avg:741.13ms
step:1425/1750 train_loss:3.3963 train_time:1048728ms step_avg:741.15ms
step:1426/1750 train_loss:3.3777 train_time:1049480ms step_avg:741.16ms
step:1427/1750 train_loss:3.3835 train_time:1050252ms step_avg:741.18ms
step:1428/1750 train_loss:3.2426 train_time:1051051ms step_avg:741.22ms
step:1429/1750 train_loss:3.3887 train_time:1051810ms step_avg:741.23ms
step:1430/1750 train_loss:3.3328 train_time:1052581ms step_avg:741.25ms
step:1431/1750 train_loss:3.4316 train_time:1053343ms step_avg:741.27ms
step:1432/1750 train_loss:3.4153 train_time:1054090ms step_avg:741.27ms
step:1433/1750 train_loss:3.3190 train_time:1054861ms step_avg:741.29ms
step:1434/1750 train_loss:3.3746 train_time:1055628ms step_avg:741.31ms
step:1435/1750 train_loss:3.3927 train_time:1056393ms step_avg:741.33ms
step:1436/1750 train_loss:3.1980 train_time:1057183ms step_avg:741.36ms
step:1437/1750 train_loss:3.3470 train_time:1057964ms step_avg:741.39ms
step:1438/1750 train_loss:3.1793 train_time:1058722ms step_avg:741.40ms
step:1439/1750 train_loss:3.2817 train_time:1059477ms step_avg:741.41ms
step:1440/1750 train_loss:3.4687 train_time:1060262ms step_avg:741.44ms
step:1441/1750 train_loss:3.4380 train_time:1061026ms step_avg:741.46ms
step:1442/1750 train_loss:3.3705 train_time:1061803ms step_avg:741.48ms
step:1443/1750 train_loss:3.2474 train_time:1062564ms step_avg:741.50ms
step:1444/1750 train_loss:3.4038 train_time:1063333ms step_avg:741.52ms
step:1445/1750 train_loss:3.4452 train_time:1064124ms step_avg:741.55ms
step:1446/1750 train_loss:3.5334 train_time:1064913ms step_avg:741.58ms
step:1447/1750 train_loss:3.5075 train_time:1065678ms step_avg:741.60ms
step:1448/1750 train_loss:3.3898 train_time:1066440ms step_avg:741.61ms
step:1449/1750 train_loss:3.2624 train_time:1067219ms step_avg:741.64ms
step:1450/1750 train_loss:3.3524 train_time:1067985ms step_avg:741.66ms
step:1451/1750 train_loss:3.3539 train_time:1068751ms step_avg:741.67ms
step:1452/1750 train_loss:3.4478 train_time:1069502ms step_avg:741.68ms
step:1453/1750 train_loss:3.4480 train_time:1070260ms step_avg:741.69ms
step:1454/1750 train_loss:3.2640 train_time:1071034ms step_avg:741.71ms
step:1455/1750 train_loss:3.3813 train_time:1071803ms step_avg:741.73ms
step:1456/1750 train_loss:3.3108 train_time:1072581ms step_avg:741.76ms
step:1457/1750 train_loss:3.3391 train_time:1073344ms step_avg:741.77ms
step:1458/1750 train_loss:3.3835 train_time:1074132ms step_avg:741.80ms
step:1459/1750 train_loss:3.3323 train_time:1074893ms step_avg:741.82ms
step:1460/1750 train_loss:3.2166 train_time:1075661ms step_avg:741.84ms
step:1461/1750 train_loss:3.4781 train_time:1076431ms step_avg:741.85ms
step:1462/1750 train_loss:3.3255 train_time:1077188ms step_avg:741.87ms
step:1463/1750 train_loss:3.3705 train_time:1077966ms step_avg:741.89ms
step:1464/1750 train_loss:3.4869 train_time:1078716ms step_avg:741.90ms
step:1465/1750 train_loss:3.3138 train_time:1079488ms step_avg:741.92ms
step:1466/1750 train_loss:3.5227 train_time:1080255ms step_avg:741.93ms
step:1467/1750 train_loss:3.4151 train_time:1081013ms step_avg:741.94ms
step:1468/1750 train_loss:3.4065 train_time:1081771ms step_avg:741.96ms
step:1469/1750 train_loss:3.3458 train_time:1082558ms step_avg:741.99ms
step:1470/1750 train_loss:3.4418 train_time:1083317ms step_avg:742.00ms
step:1471/1750 train_loss:3.3349 train_time:1084088ms step_avg:742.02ms
step:1472/1750 train_loss:3.3239 train_time:1084864ms step_avg:742.04ms
step:1473/1750 train_loss:3.3877 train_time:1085671ms step_avg:742.09ms
step:1474/1750 train_loss:3.3032 train_time:1086445ms step_avg:742.11ms
step:1475/1750 train_loss:3.2823 train_time:1087233ms step_avg:742.14ms
step:1476/1750 train_loss:3.4897 train_time:1087987ms step_avg:742.15ms
step:1477/1750 train_loss:3.3648 train_time:1088751ms step_avg:742.16ms
step:1478/1750 train_loss:3.1954 train_time:1089517ms step_avg:742.18ms
step:1479/1750 train_loss:3.3146 train_time:1090299ms step_avg:742.20ms
step:1480/1750 train_loss:3.2954 train_time:1091096ms step_avg:742.24ms
step:1481/1750 train_loss:3.3674 train_time:1091886ms step_avg:742.27ms
step:1482/1750 train_loss:3.4458 train_time:1092651ms step_avg:742.29ms
step:1483/1750 train_loss:3.3267 train_time:1093404ms step_avg:742.30ms
step:1484/1750 train_loss:3.5057 train_time:1094167ms step_avg:742.31ms
step:1485/1750 train_loss:3.4190 train_time:1094925ms step_avg:742.32ms
step:1486/1750 train_loss:3.3293 train_time:1095726ms step_avg:742.36ms
step:1487/1750 train_loss:3.3119 train_time:1096494ms step_avg:742.38ms
step:1488/1750 train_loss:3.3293 train_time:1097264ms step_avg:742.40ms
step:1489/1750 train_loss:3.2756 train_time:1098052ms step_avg:742.43ms
step:1490/1750 train_loss:3.3886 train_time:1098840ms step_avg:742.46ms
step:1491/1750 train_loss:3.2844 train_time:1099623ms step_avg:742.49ms
step:1492/1750 train_loss:3.3667 train_time:1100379ms step_avg:742.50ms
step:1493/1750 train_loss:3.3025 train_time:1101160ms step_avg:742.52ms
step:1494/1750 train_loss:3.2149 train_time:1101907ms step_avg:742.53ms
step:1495/1750 train_loss:3.3078 train_time:1102680ms step_avg:742.55ms
step:1496/1750 train_loss:3.4809 train_time:1103443ms step_avg:742.56ms
step:1497/1750 train_loss:3.3535 train_time:1104219ms step_avg:742.58ms
step:1498/1750 train_loss:3.0830 train_time:1104990ms step_avg:742.60ms
step:1499/1750 train_loss:3.4088 train_time:1105759ms step_avg:742.62ms
step:1500/1750 train_loss:3.3565 train_time:1106528ms step_avg:742.64ms
step:1500/1750 val_loss:3.3290 train_time:1106542ms step_avg:742.65ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 295.55289 | frobenius_norm = 68219.45312 | spectral_norm = 11943.41016 | nuclear_norm = 1718954.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 187.05424 | spectral_norm = 37.61086 | nuclear_norm = 4260.19531
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 181.25163 | spectral_norm = 39.48120 | nuclear_norm = 4101.31641
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 361.28305 | spectral_norm = 23.15159 | nuclear_norm = 8904.85938
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 248.46761 | spectral_norm = 29.19586 | nuclear_norm = 5698.06250
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 418.52646 | spectral_norm = 37.03271 | nuclear_norm = 11123.26074
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 212.77538 | spectral_norm = 20.78819 | nuclear_norm = 5651.93213
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 199.54013 | spectral_norm = 18.66662 | nuclear_norm = 4602.15088
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 198.81178 | spectral_norm = 17.96086 | nuclear_norm = 4606.45312
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 333.65622 | spectral_norm = 30.47121 | nuclear_norm = 7703.84570
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 325.92914 | spectral_norm = 26.19662 | nuclear_norm = 7652.13477
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 412.72186 | spectral_norm = 31.35632 | nuclear_norm = 11013.82031
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 210.17279 | spectral_norm = 21.60201 | nuclear_norm = 5566.39502
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 192.99704 | spectral_norm = 18.78395 | nuclear_norm = 4446.67578
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 189.19409 | spectral_norm = 19.31629 | nuclear_norm = 4363.19336
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 372.93051 | spectral_norm = 32.85627 | nuclear_norm = 8509.20312
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 360.66919 | spectral_norm = 26.71422 | nuclear_norm = 8515.32812
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 415.29074 | spectral_norm = 34.65273 | nuclear_norm = 11087.17188
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 209.59656 | spectral_norm = 20.53267 | nuclear_norm = 5533.24805
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 188.06487 | spectral_norm = 21.46918 | nuclear_norm = 4296.07275
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 185.56621 | spectral_norm = 18.58174 | nuclear_norm = 4276.44238
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 368.71658 | spectral_norm = 32.10406 | nuclear_norm = 8402.05859
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 369.10849 | spectral_norm = 29.58031 | nuclear_norm = 8628.56543
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 422.11563 | spectral_norm = 35.93319 | nuclear_norm = 11241.27734
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 203.68797 | spectral_norm = 20.97573 | nuclear_norm = 5327.11816
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 184.60393 | spectral_norm = 21.22002 | nuclear_norm = 4181.82959
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 182.19902 | spectral_norm = 19.47444 | nuclear_norm = 4174.31543
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 354.03879 | spectral_norm = 31.11627 | nuclear_norm = 8060.69092
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 361.80505 | spectral_norm = 28.69097 | nuclear_norm = 8366.57812
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 421.84857 | spectral_norm = 34.43267 | nuclear_norm = 11175.38281
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 210.46312 | spectral_norm = 22.14695 | nuclear_norm = 5504.72559
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 179.80461 | spectral_norm = 16.99602 | nuclear_norm = 3910.57300
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 179.09564 | spectral_norm = 17.08187 | nuclear_norm = 3914.62842
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 368.04459 | spectral_norm = 34.19786 | nuclear_norm = 8293.58008
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 371.84052 | spectral_norm = 28.54644 | nuclear_norm = 8830.60547
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 425.07141 | spectral_norm = 34.61586 | nuclear_norm = 11323.80762
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 206.51241 | spectral_norm = 19.56068 | nuclear_norm = 5454.24219
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 184.34865 | spectral_norm = 21.13958 | nuclear_norm = 4128.48730
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 180.69606 | spectral_norm = 19.14475 | nuclear_norm = 4110.45020
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 383.71692 | spectral_norm = 35.28901 | nuclear_norm = 8791.41211
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 379.83810 | spectral_norm = 30.09890 | nuclear_norm = 8924.73633
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 419.78265 | spectral_norm = 35.66840 | nuclear_norm = 11174.13281
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 210.16681 | spectral_norm = 21.77596 | nuclear_norm = 5541.10840
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 183.19690 | spectral_norm = 19.48326 | nuclear_norm = 4089.76343
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 181.23872 | spectral_norm = 18.33442 | nuclear_norm = 4079.40723
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 388.78714 | spectral_norm = 33.42385 | nuclear_norm = 8796.62793
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 379.15845 | spectral_norm = 28.37820 | nuclear_norm = 8839.04102
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 425.18976 | spectral_norm = 36.13928 | nuclear_norm = 11281.84375
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 211.88976 | spectral_norm = 22.14229 | nuclear_norm = 5583.00488
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 190.21436 | spectral_norm = 20.70876 | nuclear_norm = 4297.93896
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 188.84474 | spectral_norm = 18.89984 | nuclear_norm = 4310.03809
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 374.50696 | spectral_norm = 31.78766 | nuclear_norm = 8516.52344
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 366.55716 | spectral_norm = 28.83731 | nuclear_norm = 8526.28027
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 436.25336 | spectral_norm = 37.43916 | nuclear_norm = 11564.34180
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 215.42245 | spectral_norm = 22.47036 | nuclear_norm = 5680.45898
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 188.63120 | spectral_norm = 21.04536 | nuclear_norm = 4138.22266
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 190.85416 | spectral_norm = 19.16301 | nuclear_norm = 4121.16504
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 403.94867 | spectral_norm = 42.15189 | nuclear_norm = 9117.60742
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 390.14090 | spectral_norm = 27.65679 | nuclear_norm = 9096.15039
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 414.77280 | spectral_norm = 35.24014 | nuclear_norm = 10998.25488
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 215.25816 | spectral_norm = 22.55311 | nuclear_norm = 5718.62988
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 193.64828 | spectral_norm = 22.15259 | nuclear_norm = 4274.04590
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 190.83636 | spectral_norm = 20.78078 | nuclear_norm = 4194.69971
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 403.88974 | spectral_norm = 41.70150 | nuclear_norm = 9185.56152
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 397.95908 | spectral_norm = 28.38047 | nuclear_norm = 9368.49219
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 432.57092 | spectral_norm = 35.43764 | nuclear_norm = 11507.96289
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 209.35069 | spectral_norm = 25.78216 | nuclear_norm = 5536.78467
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 193.53267 | spectral_norm = 26.05530 | nuclear_norm = 4265.10938
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 186.37694 | spectral_norm = 24.21430 | nuclear_norm = 4090.48926
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 332.50333 | spectral_norm = 34.12056 | nuclear_norm = 7680.69141
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 379.17200 | spectral_norm = 26.57442 | nuclear_norm = 8924.36328
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 467.84772 | spectral_norm = 35.51330 | nuclear_norm = 12444.18945
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 234.57333 | spectral_norm = 30.09179 | nuclear_norm = 6158.59473
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1325.19983 | spectral_norm = 163.02647 | nuclear_norm = 35041.74219
===========================================
step:1501/1750 train_loss:3.3953 train_time:1107275ms step_avg:742.64ms
step:1502/1750 train_loss:3.3584 train_time:1108079ms step_avg:742.68ms
step:1503/1750 train_loss:3.3384 train_time:1108854ms step_avg:742.70ms
step:1504/1750 train_loss:3.1309 train_time:1109668ms step_avg:742.75ms
step:1505/1750 train_loss:3.4121 train_time:1110449ms step_avg:742.78ms
step:1506/1750 train_loss:3.2948 train_time:1111255ms step_avg:742.82ms
step:1507/1750 train_loss:3.3018 train_time:1112038ms step_avg:742.84ms
step:1508/1750 train_loss:3.2574 train_time:1112800ms step_avg:742.86ms
step:1509/1750 train_loss:3.3273 train_time:1113552ms step_avg:742.86ms
step:1510/1750 train_loss:3.2184 train_time:1114321ms step_avg:742.88ms
step:1511/1750 train_loss:3.5338 train_time:1115089ms step_avg:742.90ms
step:1512/1750 train_loss:3.3266 train_time:1115838ms step_avg:742.90ms
step:1513/1750 train_loss:3.3257 train_time:1116605ms step_avg:742.92ms
step:1514/1750 train_loss:3.4639 train_time:1117345ms step_avg:742.92ms
step:1515/1750 train_loss:3.4681 train_time:1118131ms step_avg:742.94ms
step:1516/1750 train_loss:3.3105 train_time:1118898ms step_avg:742.96ms
step:1517/1750 train_loss:3.1326 train_time:1119692ms step_avg:742.99ms
step:1518/1750 train_loss:3.2814 train_time:1120445ms step_avg:743.00ms
step:1519/1750 train_loss:3.2955 train_time:1121243ms step_avg:743.04ms
step:1520/1750 train_loss:3.3503 train_time:1122206ms step_avg:743.18ms
step:1521/1750 train_loss:3.2522 train_time:1122964ms step_avg:743.19ms
step:1522/1750 train_loss:3.5535 train_time:1123729ms step_avg:743.21ms
step:1523/1750 train_loss:3.1735 train_time:1124492ms step_avg:743.22ms
step:1524/1750 train_loss:3.2884 train_time:1125491ms step_avg:743.39ms
step:1525/1750 train_loss:3.3448 train_time:1126268ms step_avg:743.41ms
step:1526/1750 train_loss:3.3399 train_time:1127048ms step_avg:743.44ms
step:1527/1750 train_loss:3.3921 train_time:1127817ms step_avg:743.45ms
step:1528/1750 train_loss:3.2893 train_time:1128581ms step_avg:743.47ms
step:1529/1750 train_loss:3.2603 train_time:1129339ms step_avg:743.48ms
step:1530/1750 train_loss:3.3108 train_time:1130094ms step_avg:743.48ms
step:1531/1750 train_loss:3.3255 train_time:1130859ms step_avg:743.50ms
step:1532/1750 train_loss:3.3319 train_time:1131627ms step_avg:743.51ms
step:1533/1750 train_loss:3.2851 train_time:1132473ms step_avg:743.58ms
step:1534/1750 train_loss:3.4494 train_time:1133237ms step_avg:743.59ms
step:1535/1750 train_loss:3.2296 train_time:1134013ms step_avg:743.61ms
step:1536/1750 train_loss:3.3794 train_time:1134767ms step_avg:743.62ms
step:1537/1750 train_loss:3.2907 train_time:1135540ms step_avg:743.64ms
step:1538/1750 train_loss:3.1712 train_time:1136325ms step_avg:743.67ms
step:1539/1750 train_loss:3.1386 train_time:1137107ms step_avg:743.69ms
step:1540/1750 train_loss:3.2371 train_time:1137860ms step_avg:743.70ms
step:1541/1750 train_loss:3.2507 train_time:1138646ms step_avg:743.73ms
step:1542/1750 train_loss:3.1594 train_time:1139417ms step_avg:743.74ms
step:1543/1750 train_loss:3.4360 train_time:1140184ms step_avg:743.76ms
step:1544/1750 train_loss:3.2593 train_time:1140943ms step_avg:743.77ms
step:1545/1750 train_loss:3.1358 train_time:1141777ms step_avg:743.83ms
step:1546/1750 train_loss:3.3232 train_time:1142553ms step_avg:743.85ms
step:1547/1750 train_loss:3.3371 train_time:1143324ms step_avg:743.87ms
step:1548/1750 train_loss:3.1153 train_time:1144088ms step_avg:743.88ms
step:1549/1750 train_loss:3.4754 train_time:1144850ms step_avg:743.89ms
step:1550/1750 train_loss:3.4421 train_time:1145639ms step_avg:743.92ms
step:1551/1750 train_loss:3.2898 train_time:1146441ms step_avg:743.96ms
step:1552/1750 train_loss:3.4603 train_time:1147213ms step_avg:743.98ms
step:1553/1750 train_loss:3.3599 train_time:1147978ms step_avg:743.99ms
step:1554/1750 train_loss:3.2884 train_time:1148756ms step_avg:744.01ms
step:1555/1750 train_loss:3.4455 train_time:1149527ms step_avg:744.03ms
step:1556/1750 train_loss:3.4088 train_time:1150281ms step_avg:744.04ms
step:1557/1750 train_loss:3.2847 train_time:1151039ms step_avg:744.05ms
step:1558/1750 train_loss:3.2346 train_time:1151805ms step_avg:744.06ms
step:1559/1750 train_loss:3.2389 train_time:1152566ms step_avg:744.07ms
step:1560/1750 train_loss:3.2853 train_time:1153337ms step_avg:744.09ms
step:1561/1750 train_loss:3.3092 train_time:1154106ms step_avg:744.10ms
step:1562/1750 train_loss:3.3152 train_time:1154894ms step_avg:744.13ms
step:1563/1750 train_loss:3.3626 train_time:1155673ms step_avg:744.16ms
step:1564/1750 train_loss:3.2702 train_time:1156425ms step_avg:744.16ms
step:1565/1750 train_loss:3.3880 train_time:1157197ms step_avg:744.18ms
step:1566/1750 train_loss:3.2550 train_time:1157972ms step_avg:744.20ms
step:1567/1750 train_loss:3.4065 train_time:1158740ms step_avg:744.21ms
step:1568/1750 train_loss:3.2133 train_time:1159515ms step_avg:744.23ms
step:1569/1750 train_loss:3.2409 train_time:1160283ms step_avg:744.25ms
step:1570/1750 train_loss:3.1658 train_time:1161041ms step_avg:744.26ms
step:1571/1750 train_loss:3.1734 train_time:1161825ms step_avg:744.28ms
step:1572/1750 train_loss:3.2221 train_time:1162592ms step_avg:744.30ms
step:1573/1750 train_loss:3.2990 train_time:1163356ms step_avg:744.31ms
step:1574/1750 train_loss:3.0772 train_time:1164128ms step_avg:744.33ms
step:1575/1750 train_loss:3.2975 train_time:1164892ms step_avg:744.34ms
step:1576/1750 train_loss:3.3072 train_time:1165709ms step_avg:744.39ms
step:1577/1750 train_loss:3.2792 train_time:1166481ms step_avg:744.40ms
step:1578/1750 train_loss:3.3127 train_time:1167282ms step_avg:744.44ms
step:1579/1750 train_loss:3.3029 train_time:1168052ms step_avg:744.46ms
step:1580/1750 train_loss:3.2510 train_time:1168809ms step_avg:744.46ms
step:1581/1750 train_loss:3.4704 train_time:1169578ms step_avg:744.48ms
step:1582/1750 train_loss:3.3431 train_time:1170357ms step_avg:744.50ms
step:1583/1750 train_loss:3.3963 train_time:1171115ms step_avg:744.51ms
step:1584/1750 train_loss:3.1274 train_time:1171918ms step_avg:744.55ms
step:1585/1750 train_loss:3.2777 train_time:1172713ms step_avg:744.58ms
step:1586/1750 train_loss:3.2053 train_time:1173471ms step_avg:744.59ms
step:1587/1750 train_loss:3.3717 train_time:1174228ms step_avg:744.60ms
step:1588/1750 train_loss:3.2769 train_time:1174993ms step_avg:744.61ms
step:1589/1750 train_loss:3.2393 train_time:1175749ms step_avg:744.62ms
step:1590/1750 train_loss:3.2330 train_time:1176544ms step_avg:744.65ms
step:1591/1750 train_loss:3.2766 train_time:1177298ms step_avg:744.65ms
step:1592/1750 train_loss:3.1020 train_time:1178080ms step_avg:744.68ms
step:1593/1750 train_loss:3.2262 train_time:1178840ms step_avg:744.69ms
step:1594/1750 train_loss:3.5688 train_time:1179618ms step_avg:744.71ms
step:1595/1750 train_loss:3.2049 train_time:1180386ms step_avg:744.72ms
step:1596/1750 train_loss:3.1559 train_time:1181197ms step_avg:744.76ms
step:1597/1750 train_loss:3.3400 train_time:1181953ms step_avg:744.77ms
step:1598/1750 train_loss:3.2633 train_time:1182765ms step_avg:744.81ms
step:1599/1750 train_loss:3.1174 train_time:1183546ms step_avg:744.84ms
step:1600/1750 train_loss:3.2752 train_time:1184329ms step_avg:744.86ms
step:1601/1750 train_loss:3.2718 train_time:1185083ms step_avg:744.87ms
step:1602/1750 train_loss:3.3419 train_time:1185857ms step_avg:744.88ms
step:1603/1750 train_loss:3.2356 train_time:1186611ms step_avg:744.89ms
step:1604/1750 train_loss:3.1438 train_time:1187412ms step_avg:744.93ms
step:1605/1750 train_loss:3.3184 train_time:1188193ms step_avg:744.95ms
step:1606/1750 train_loss:3.0989 train_time:1188997ms step_avg:744.99ms
step:1607/1750 train_loss:3.3141 train_time:1189767ms step_avg:745.00ms
step:1608/1750 train_loss:3.1895 train_time:1190549ms step_avg:745.02ms
step:1609/1750 train_loss:3.2770 train_time:1191308ms step_avg:745.03ms
step:1610/1750 train_loss:3.2997 train_time:1192122ms step_avg:745.08ms
step:1611/1750 train_loss:3.1565 train_time:1192885ms step_avg:745.09ms
step:1612/1750 train_loss:3.2898 train_time:1193715ms step_avg:745.14ms
step:1613/1750 train_loss:3.2815 train_time:1194479ms step_avg:745.15ms
step:1614/1750 train_loss:3.1135 train_time:1195337ms step_avg:745.22ms
step:1615/1750 train_loss:3.3663 train_time:1196151ms step_avg:745.27ms
step:1616/1750 train_loss:3.3282 train_time:1196926ms step_avg:745.28ms
step:1617/1750 train_loss:3.2997 train_time:1197691ms step_avg:745.30ms
step:1618/1750 train_loss:3.2092 train_time:1198477ms step_avg:745.32ms
step:1619/1750 train_loss:3.3982 train_time:1199245ms step_avg:745.34ms
step:1620/1750 train_loss:3.3544 train_time:1199998ms step_avg:745.34ms
step:1621/1750 train_loss:3.2760 train_time:1200763ms step_avg:745.35ms
step:1622/1750 train_loss:3.5216 train_time:1201528ms step_avg:745.36ms
step:1623/1750 train_loss:3.2304 train_time:1202304ms step_avg:745.38ms
step:1624/1750 train_loss:3.5193 train_time:1203125ms step_avg:745.43ms
step:1625/1750 train_loss:3.2709 train_time:1203887ms step_avg:745.44ms
step:1625/1750 val_loss:3.2944 train_time:1203901ms step_avg:745.45ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.04977 | frobenius_norm = 68337.49219 | spectral_norm = 11964.96191 | nuclear_norm = 1722635.12500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 187.76669 | spectral_norm = 38.22201 | nuclear_norm = 4271.32031
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 182.15489 | spectral_norm = 40.00220 | nuclear_norm = 4117.84424
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 363.69431 | spectral_norm = 23.17333 | nuclear_norm = 8973.05859
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 248.24133 | spectral_norm = 29.28152 | nuclear_norm = 5685.96631
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 421.46561 | spectral_norm = 37.41808 | nuclear_norm = 11201.11328
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 214.15286 | spectral_norm = 21.01098 | nuclear_norm = 5689.60254
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 200.84906 | spectral_norm = 18.77343 | nuclear_norm = 4631.02637
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 200.12531 | spectral_norm = 18.12561 | nuclear_norm = 4636.88379
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 335.59558 | spectral_norm = 30.61610 | nuclear_norm = 7750.32715
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 327.63550 | spectral_norm = 26.34553 | nuclear_norm = 7694.62207
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 415.41113 | spectral_norm = 31.59615 | nuclear_norm = 11087.11523
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 211.56438 | spectral_norm = 21.76120 | nuclear_norm = 5604.65576
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 194.23982 | spectral_norm = 18.89061 | nuclear_norm = 4473.78809
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 190.40887 | spectral_norm = 19.48127 | nuclear_norm = 4390.78174
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 375.61444 | spectral_norm = 33.12468 | nuclear_norm = 8573.21387
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 363.05844 | spectral_norm = 26.90451 | nuclear_norm = 8574.72168
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 417.86349 | spectral_norm = 34.96108 | nuclear_norm = 11157.29102
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 210.92319 | spectral_norm = 20.69425 | nuclear_norm = 5569.18555
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 189.27864 | spectral_norm = 21.73152 | nuclear_norm = 4322.17480
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 186.79578 | spectral_norm = 18.74028 | nuclear_norm = 4304.08789
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 371.67807 | spectral_norm = 32.32337 | nuclear_norm = 8474.52637
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 372.00650 | spectral_norm = 29.79814 | nuclear_norm = 8701.30078
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 424.63547 | spectral_norm = 36.18351 | nuclear_norm = 11309.45508
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 204.93996 | spectral_norm = 21.19545 | nuclear_norm = 5360.40674
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 185.76328 | spectral_norm = 21.39617 | nuclear_norm = 4205.25293
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 183.30566 | spectral_norm = 19.64013 | nuclear_norm = 4198.48633
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 357.13611 | spectral_norm = 31.35167 | nuclear_norm = 8137.28174
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 364.74911 | spectral_norm = 28.87287 | nuclear_norm = 8439.45801
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 424.28809 | spectral_norm = 34.73343 | nuclear_norm = 11237.54688
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 211.63820 | spectral_norm = 22.37300 | nuclear_norm = 5533.83545
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 180.70070 | spectral_norm = 17.15995 | nuclear_norm = 3922.77148
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 180.04248 | spectral_norm = 17.23084 | nuclear_norm = 3928.74121
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 371.05017 | spectral_norm = 34.41454 | nuclear_norm = 8366.91406
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 374.58194 | spectral_norm = 28.69335 | nuclear_norm = 8899.19824
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 427.51395 | spectral_norm = 34.96500 | nuclear_norm = 11386.52637
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 207.78072 | spectral_norm = 19.74009 | nuclear_norm = 5488.92578
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 185.56070 | spectral_norm = 21.33333 | nuclear_norm = 4150.75684
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 181.79803 | spectral_norm = 19.24443 | nuclear_norm = 4133.47705
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 386.95374 | spectral_norm = 35.46465 | nuclear_norm = 8873.23828
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 383.01215 | spectral_norm = 30.30979 | nuclear_norm = 9003.60742
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 422.16754 | spectral_norm = 35.99392 | nuclear_norm = 11237.40234
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 211.41000 | spectral_norm = 22.01940 | nuclear_norm = 5574.28320
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 184.33714 | spectral_norm = 19.62200 | nuclear_norm = 4110.16455
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 182.27097 | spectral_norm = 18.46615 | nuclear_norm = 4098.98633
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 391.97595 | spectral_norm = 33.66706 | nuclear_norm = 8875.65234
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 382.05563 | spectral_norm = 28.65641 | nuclear_norm = 8907.82129
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 427.76877 | spectral_norm = 36.51037 | nuclear_norm = 11348.37305
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 213.11771 | spectral_norm = 22.33380 | nuclear_norm = 5615.11084
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 191.36430 | spectral_norm = 20.93459 | nuclear_norm = 4319.75537
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 190.03348 | spectral_norm = 19.01342 | nuclear_norm = 4335.06836
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 377.45731 | spectral_norm = 32.03853 | nuclear_norm = 8590.48340
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 369.15051 | spectral_norm = 29.05577 | nuclear_norm = 8586.25391
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 439.13455 | spectral_norm = 37.73592 | nuclear_norm = 11637.93848
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 216.68355 | spectral_norm = 22.66139 | nuclear_norm = 5712.40186
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 189.75131 | spectral_norm = 21.20665 | nuclear_norm = 4154.61426
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 191.96573 | spectral_norm = 19.30379 | nuclear_norm = 4135.19922
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 407.63260 | spectral_norm = 42.63639 | nuclear_norm = 9198.60156
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 392.68027 | spectral_norm = 27.99037 | nuclear_norm = 9154.32422
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 417.19452 | spectral_norm = 35.59750 | nuclear_norm = 11058.86328
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 216.50023 | spectral_norm = 22.70099 | nuclear_norm = 5751.73828
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 194.73959 | spectral_norm = 22.44998 | nuclear_norm = 4289.82715
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 191.89543 | spectral_norm = 20.99635 | nuclear_norm = 4210.18164
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 407.93250 | spectral_norm = 42.28805 | nuclear_norm = 9275.95117
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 400.90662 | spectral_norm = 28.63200 | nuclear_norm = 9435.68359
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 434.64120 | spectral_norm = 35.75940 | nuclear_norm = 11561.51758
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 210.68010 | spectral_norm = 25.92716 | nuclear_norm = 5572.05371
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 194.54967 | spectral_norm = 26.44411 | nuclear_norm = 4277.13965
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 187.33037 | spectral_norm = 24.53285 | nuclear_norm = 4101.02783
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 334.91702 | spectral_norm = 34.37047 | nuclear_norm = 7735.41846
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 381.80652 | spectral_norm = 26.79512 | nuclear_norm = 8983.18457
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 469.94391 | spectral_norm = 35.61425 | nuclear_norm = 12498.84180
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 235.91731 | spectral_norm = 30.31649 | nuclear_norm = 6192.52637
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1323.92712 | spectral_norm = 160.11687 | nuclear_norm = 35050.60156
===========================================
step:1626/1750 train_loss:3.3443 train_time:1204629ms step_avg:745.44ms
step:1627/1750 train_loss:3.3662 train_time:1205391ms step_avg:745.45ms
step:1628/1750 train_loss:3.3941 train_time:1206151ms step_avg:745.46ms
step:1629/1750 train_loss:3.2399 train_time:1206923ms step_avg:745.47ms
step:1630/1750 train_loss:3.3096 train_time:1207695ms step_avg:745.49ms
step:1631/1750 train_loss:3.2714 train_time:1208465ms step_avg:745.51ms
step:1632/1750 train_loss:3.1597 train_time:1209233ms step_avg:745.52ms
step:1633/1750 train_loss:3.2854 train_time:1209996ms step_avg:745.53ms
step:1634/1750 train_loss:3.2923 train_time:1210759ms step_avg:745.54ms
step:1635/1750 train_loss:3.2776 train_time:1211540ms step_avg:745.56ms
step:1636/1750 train_loss:3.3631 train_time:1212301ms step_avg:745.57ms
step:1637/1750 train_loss:3.6263 train_time:1213085ms step_avg:745.60ms
step:1638/1750 train_loss:3.2541 train_time:1213923ms step_avg:745.65ms
step:1639/1750 train_loss:3.2227 train_time:1214698ms step_avg:745.67ms
step:1640/1750 train_loss:3.2495 train_time:1215468ms step_avg:745.69ms
step:1641/1750 train_loss:3.3586 train_time:1216211ms step_avg:745.68ms
step:1642/1750 train_loss:3.3170 train_time:1216973ms step_avg:745.69ms
step:1643/1750 train_loss:3.2986 train_time:1217758ms step_avg:745.72ms
step:1644/1750 train_loss:3.2117 train_time:1218513ms step_avg:745.72ms
step:1645/1750 train_loss:3.1998 train_time:1219286ms step_avg:745.74ms
step:1646/1750 train_loss:3.2902 train_time:1220058ms step_avg:745.76ms
step:1647/1750 train_loss:3.1580 train_time:1220859ms step_avg:745.79ms
step:1648/1750 train_loss:3.3166 train_time:1221620ms step_avg:745.80ms
step:1649/1750 train_loss:3.3524 train_time:1222373ms step_avg:745.80ms
step:1650/1750 train_loss:3.2442 train_time:1223142ms step_avg:745.82ms
step:1651/1750 train_loss:3.3267 train_time:1223909ms step_avg:745.83ms
step:1652/1750 train_loss:3.2875 train_time:1224686ms step_avg:745.85ms
step:1653/1750 train_loss:3.2212 train_time:1225437ms step_avg:745.85ms
step:1654/1750 train_loss:3.3550 train_time:1226209ms step_avg:745.87ms
step:1655/1750 train_loss:3.1981 train_time:1226971ms step_avg:745.88ms
step:1656/1750 train_loss:2.9743 train_time:1227763ms step_avg:745.91ms
step:1657/1750 train_loss:3.3001 train_time:1228525ms step_avg:745.92ms
step:1658/1750 train_loss:3.3314 train_time:1229283ms step_avg:745.92ms
step:1659/1750 train_loss:3.2747 train_time:1230059ms step_avg:745.94ms
step:1660/1750 train_loss:3.5185 train_time:1230851ms step_avg:745.97ms
step:1661/1750 train_loss:3.3650 train_time:1231621ms step_avg:745.99ms
step:1662/1750 train_loss:3.3329 train_time:1232384ms step_avg:746.00ms
step:1663/1750 train_loss:3.3106 train_time:1233167ms step_avg:746.02ms
step:1664/1750 train_loss:3.3385 train_time:1233923ms step_avg:746.02ms
step:1665/1750 train_loss:3.1585 train_time:1234693ms step_avg:746.04ms
step:1666/1750 train_loss:3.3157 train_time:1235455ms step_avg:746.05ms
step:1667/1750 train_loss:3.1053 train_time:1236228ms step_avg:746.06ms
step:1668/1750 train_loss:3.2750 train_time:1236994ms step_avg:746.08ms
step:1669/1750 train_loss:3.3045 train_time:1237756ms step_avg:746.09ms
step:1670/1750 train_loss:3.1198 train_time:1238520ms step_avg:746.10ms
step:1671/1750 train_loss:3.2728 train_time:1239360ms step_avg:746.15ms
step:1672/1750 train_loss:3.1671 train_time:1240144ms step_avg:746.18ms
step:1673/1750 train_loss:3.4549 train_time:1240912ms step_avg:746.19ms
step:1674/1750 train_loss:3.3175 train_time:1241675ms step_avg:746.20ms
step:1675/1750 train_loss:3.2856 train_time:1242431ms step_avg:746.21ms
step:1676/1750 train_loss:3.1665 train_time:1243210ms step_avg:746.22ms
step:1677/1750 train_loss:3.2292 train_time:1244000ms step_avg:746.25ms
step:1678/1750 train_loss:3.5715 train_time:1244769ms step_avg:746.26ms
step:1679/1750 train_loss:3.2892 train_time:1245539ms step_avg:746.28ms
step:1680/1750 train_loss:3.2766 train_time:1246318ms step_avg:746.30ms
step:1681/1750 train_loss:3.4077 train_time:1247090ms step_avg:746.31ms
step:1682/1750 train_loss:3.3242 train_time:1247864ms step_avg:746.33ms
step:1683/1750 train_loss:3.2400 train_time:1248668ms step_avg:746.36ms
step:1684/1750 train_loss:3.3364 train_time:1249438ms step_avg:746.38ms
step:1685/1750 train_loss:3.1657 train_time:1250208ms step_avg:746.39ms
step:1686/1750 train_loss:3.3303 train_time:1250979ms step_avg:746.41ms
step:1687/1750 train_loss:3.2231 train_time:1251785ms step_avg:746.44ms
step:1688/1750 train_loss:3.0386 train_time:1252559ms step_avg:746.46ms
step:1689/1750 train_loss:3.3723 train_time:1253348ms step_avg:746.48ms
step:1690/1750 train_loss:3.3192 train_time:1254112ms step_avg:746.50ms
step:1691/1750 train_loss:3.3164 train_time:1254881ms step_avg:746.51ms
step:1692/1750 train_loss:3.2138 train_time:1255703ms step_avg:746.55ms
step:1693/1750 train_loss:3.2164 train_time:1256478ms step_avg:746.57ms
step:1694/1750 train_loss:3.3068 train_time:1257241ms step_avg:746.58ms
step:1695/1750 train_loss:3.2299 train_time:1258011ms step_avg:746.59ms
step:1696/1750 train_loss:3.3200 train_time:1258788ms step_avg:746.61ms
step:1697/1750 train_loss:3.2690 train_time:1259569ms step_avg:746.63ms
step:1698/1750 train_loss:3.3726 train_time:1260328ms step_avg:746.64ms
step:1699/1750 train_loss:3.2046 train_time:1261116ms step_avg:746.66ms
step:1700/1750 train_loss:3.2624 train_time:1261888ms step_avg:746.68ms
step:1701/1750 train_loss:3.1847 train_time:1262645ms step_avg:746.69ms
step:1702/1750 train_loss:3.1982 train_time:1263413ms step_avg:746.70ms
step:1703/1750 train_loss:3.2846 train_time:1264169ms step_avg:746.70ms
step:1704/1750 train_loss:3.3079 train_time:1264927ms step_avg:746.71ms
step:1705/1750 train_loss:3.2764 train_time:1265684ms step_avg:746.72ms
step:1706/1750 train_loss:3.3134 train_time:1266458ms step_avg:746.73ms
step:1707/1750 train_loss:3.2672 train_time:1267245ms step_avg:746.76ms
step:1708/1750 train_loss:3.4240 train_time:1268007ms step_avg:746.77ms
step:1709/1750 train_loss:3.1298 train_time:1268777ms step_avg:746.78ms
step:1710/1750 train_loss:3.2304 train_time:1269748ms step_avg:746.91ms
step:1711/1750 train_loss:3.2247 train_time:1270538ms step_avg:746.94ms
step:1712/1750 train_loss:3.2311 train_time:1271296ms step_avg:746.94ms
step:1713/1750 train_loss:3.7026 train_time:1272087ms step_avg:746.97ms
step:1714/1750 train_loss:3.2763 train_time:1272880ms step_avg:747.00ms
step:1715/1750 train_loss:3.2820 train_time:1273645ms step_avg:747.01ms
step:1716/1750 train_loss:3.3153 train_time:1274408ms step_avg:747.02ms
step:1717/1750 train_loss:3.3330 train_time:1275172ms step_avg:747.03ms
step:1718/1750 train_loss:3.2162 train_time:1275943ms step_avg:747.04ms
step:1719/1750 train_loss:3.2845 train_time:1276733ms step_avg:747.06ms
step:1720/1750 train_loss:3.0953 train_time:1277494ms step_avg:747.07ms
step:1721/1750 train_loss:3.2447 train_time:1278246ms step_avg:747.08ms
step:1722/1750 train_loss:3.2588 train_time:1279002ms step_avg:747.08ms
step:1723/1750 train_loss:3.2153 train_time:1279756ms step_avg:747.08ms
step:1724/1750 train_loss:3.3773 train_time:1280529ms step_avg:747.10ms
step:1725/1750 train_loss:3.1580 train_time:1281346ms step_avg:747.14ms
step:1726/1750 train_loss:3.3121 train_time:1282138ms step_avg:747.17ms
step:1727/1750 train_loss:3.3974 train_time:1282901ms step_avg:747.18ms
step:1728/1750 train_loss:3.2583 train_time:1283672ms step_avg:747.19ms
step:1729/1750 train_loss:3.4847 train_time:1284456ms step_avg:747.21ms
step:1730/1750 train_loss:3.2530 train_time:1285228ms step_avg:747.23ms
step:1731/1750 train_loss:3.3286 train_time:1285980ms step_avg:747.23ms
step:1732/1750 train_loss:3.2947 train_time:1286746ms step_avg:747.24ms
step:1733/1750 train_loss:3.2702 train_time:1287517ms step_avg:747.25ms
step:1734/1750 train_loss:3.6480 train_time:1288309ms step_avg:747.28ms
step:1735/1750 train_loss:3.2944 train_time:1289083ms step_avg:747.29ms
step:1736/1750 train_loss:3.4306 train_time:1289854ms step_avg:747.31ms
step:1737/1750 train_loss:3.2014 train_time:1290635ms step_avg:747.33ms
step:1738/1750 train_loss:3.2461 train_time:1291399ms step_avg:747.34ms
step:1739/1750 train_loss:3.2662 train_time:1292154ms step_avg:747.34ms
step:1740/1750 train_loss:3.2559 train_time:1292924ms step_avg:747.35ms
step:1741/1750 train_loss:3.3831 train_time:1293685ms step_avg:747.36ms
step:1742/1750 train_loss:3.2135 train_time:1294461ms step_avg:747.38ms
step:1743/1750 train_loss:3.2862 train_time:1295250ms step_avg:747.40ms
step:1744/1750 train_loss:3.3658 train_time:1296001ms step_avg:747.41ms
step:1745/1750 train_loss:3.1588 train_time:1296769ms step_avg:747.42ms
step:1746/1750 train_loss:3.0548 train_time:1297530ms step_avg:747.42ms
step:1747/1750 train_loss:2.9492 train_time:1298343ms step_avg:747.46ms
step:1748/1750 train_loss:3.2882 train_time:1299111ms step_avg:747.47ms
step:1749/1750 train_loss:3.3097 train_time:1299864ms step_avg:747.48ms
step:1750/1750 train_loss:3.2685 train_time:1300619ms step_avg:747.48ms
step:1750/1750 val_loss:3.2731 train_time:1300632ms step_avg:747.49ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.07419 | frobenius_norm = 68343.25781 | spectral_norm = 11968.19824 | nuclear_norm = 1722923.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 187.78528 | spectral_norm = 38.42400 | nuclear_norm = 4269.75781
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 182.24577 | spectral_norm = 40.15344 | nuclear_norm = 4118.55664
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 364.27356 | spectral_norm = 23.16063 | nuclear_norm = 8990.77051
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 247.99464 | spectral_norm = 29.28902 | nuclear_norm = 5677.59082
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 422.09592 | spectral_norm = 37.52061 | nuclear_norm = 11217.75879
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 214.43782 | spectral_norm = 21.05983 | nuclear_norm = 5697.66260
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 201.12579 | spectral_norm = 18.77365 | nuclear_norm = 4637.06152
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 200.37810 | spectral_norm = 18.18177 | nuclear_norm = 4642.81445
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 335.99265 | spectral_norm = 30.60638 | nuclear_norm = 7760.68066
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 327.99954 | spectral_norm = 26.35611 | nuclear_norm = 7704.21484
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 415.95499 | spectral_norm = 31.62644 | nuclear_norm = 11102.23242
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 211.84483 | spectral_norm = 21.80561 | nuclear_norm = 5612.63428
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 194.49197 | spectral_norm = 18.91710 | nuclear_norm = 4479.31787
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 190.66809 | spectral_norm = 19.51768 | nuclear_norm = 4396.21924
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 376.26175 | spectral_norm = 33.15876 | nuclear_norm = 8588.55664
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 363.59579 | spectral_norm = 26.94389 | nuclear_norm = 8588.59766
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 418.40579 | spectral_norm = 35.01840 | nuclear_norm = 11172.46191
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 211.18456 | spectral_norm = 20.73155 | nuclear_norm = 5576.44287
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 189.52328 | spectral_norm = 21.80294 | nuclear_norm = 4327.13770
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 187.03938 | spectral_norm = 18.78343 | nuclear_norm = 4309.58301
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 372.36569 | spectral_norm = 32.39577 | nuclear_norm = 8492.32129
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 372.68643 | spectral_norm = 29.85795 | nuclear_norm = 8719.12988
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 425.14359 | spectral_norm = 36.24630 | nuclear_norm = 11323.76465
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 205.17505 | spectral_norm = 21.24486 | nuclear_norm = 5366.70996
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 185.96638 | spectral_norm = 21.44349 | nuclear_norm = 4208.73340
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 183.49223 | spectral_norm = 19.68645 | nuclear_norm = 4202.22168
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 357.94070 | spectral_norm = 31.42699 | nuclear_norm = 8157.39746
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 365.50906 | spectral_norm = 28.89202 | nuclear_norm = 8458.96289
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 424.77814 | spectral_norm = 34.78656 | nuclear_norm = 11249.65039
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 211.83031 | spectral_norm = 22.42052 | nuclear_norm = 5538.15234
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 180.85310 | spectral_norm = 17.18022 | nuclear_norm = 3922.98975
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 180.19925 | spectral_norm = 17.26985 | nuclear_norm = 3929.47656
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 371.77072 | spectral_norm = 34.48375 | nuclear_norm = 8385.37305
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 375.24820 | spectral_norm = 28.73841 | nuclear_norm = 8916.53125
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 427.99356 | spectral_norm = 35.02319 | nuclear_norm = 11398.48633
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 208.02246 | spectral_norm = 19.76407 | nuclear_norm = 5495.77637
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 185.80463 | spectral_norm = 21.37917 | nuclear_norm = 4154.53516
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 182.02867 | spectral_norm = 19.25729 | nuclear_norm = 4138.14062
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 387.78333 | spectral_norm = 35.49493 | nuclear_norm = 8895.56055
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 383.83398 | spectral_norm = 30.36676 | nuclear_norm = 9024.71875
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 422.62778 | spectral_norm = 36.05698 | nuclear_norm = 11249.71875
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 211.62718 | spectral_norm = 22.05648 | nuclear_norm = 5580.20898
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 184.54303 | spectral_norm = 19.67807 | nuclear_norm = 4112.38281
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 182.46613 | spectral_norm = 18.49069 | nuclear_norm = 4101.74414
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 392.79266 | spectral_norm = 33.67814 | nuclear_norm = 8896.76172
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 382.82108 | spectral_norm = 28.70013 | nuclear_norm = 8926.58691
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 428.30331 | spectral_norm = 36.59353 | nuclear_norm = 11361.75586
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 213.32938 | spectral_norm = 22.37164 | nuclear_norm = 5620.45703
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 191.57970 | spectral_norm = 20.98496 | nuclear_norm = 4322.91504
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 190.27466 | spectral_norm = 19.05018 | nuclear_norm = 4339.57959
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 378.19565 | spectral_norm = 32.08508 | nuclear_norm = 8609.62598
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 369.80109 | spectral_norm = 29.10342 | nuclear_norm = 8601.14941
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 439.74139 | spectral_norm = 37.78771 | nuclear_norm = 11652.84180
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 216.89162 | spectral_norm = 22.69960 | nuclear_norm = 5717.35840
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 189.92662 | spectral_norm = 21.25428 | nuclear_norm = 4155.03760
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 192.17612 | spectral_norm = 19.36660 | nuclear_norm = 4135.28027
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 408.58804 | spectral_norm = 42.76474 | nuclear_norm = 9219.62305
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 393.25864 | spectral_norm = 28.06141 | nuclear_norm = 9166.61621
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 417.63535 | spectral_norm = 35.66024 | nuclear_norm = 11069.14160
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 216.71407 | spectral_norm = 22.72133 | nuclear_norm = 5757.40137
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 194.93579 | spectral_norm = 22.56061 | nuclear_norm = 4290.66309
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 192.07553 | spectral_norm = 21.02001 | nuclear_norm = 4210.81348
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 408.94653 | spectral_norm = 42.41339 | nuclear_norm = 9298.38281
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 401.62085 | spectral_norm = 28.70742 | nuclear_norm = 9451.42188
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 434.95929 | spectral_norm = 35.82777 | nuclear_norm = 11569.26660
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 210.91428 | spectral_norm = 25.94172 | nuclear_norm = 5578.31299
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 194.69638 | spectral_norm = 26.57070 | nuclear_norm = 4276.14648
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 187.45752 | spectral_norm = 24.62988 | nuclear_norm = 4099.60742
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 335.42865 | spectral_norm = 34.43574 | nuclear_norm = 7746.94336
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 382.46008 | spectral_norm = 26.84146 | nuclear_norm = 8997.13672
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 470.26364 | spectral_norm = 35.64549 | nuclear_norm = 12506.84668
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 236.18842 | spectral_norm = 30.35739 | nuclear_norm = 6199.12695
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1321.50098 | spectral_norm = 158.55008 | nuclear_norm = 35004.18359
===========================================

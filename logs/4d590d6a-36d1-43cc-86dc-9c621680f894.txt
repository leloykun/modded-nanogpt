import os
import sys
with open(sys.argv[0]) as f:
    code = f.read() # read the code of this file ASAP, for logging
import uuid
import time
import contextlib
from dataclasses import dataclass
from pathlib import Path

import torch
from torch import nn
import torch.nn.functional as F
import torch.distributed as dist
import torch._inductor.config as config
from torch.nn.parallel import DistributedDataParallel as DDP
# Use of FlexAttention contributed by @KoszarskyB
from torch.nn.attention.flex_attention import BlockMask, flex_attention

# -----------------------------------------------------------------------------
# Muon optimizer

@torch.compile
def zeropower_via_newtonschulz5(G, steps=10, eps=1e-7):
    """
    Newton-Schulz iteration to compute the zeroth power / orthogonalization of G. We opt to use a
    quintic iteration whose coefficients are selected to maximize the slope at zero. For the purpose
    of minimizing steps, it turns out to be empirically effective to keep increasing the slope at
    zero even beyond the point where the iteration no longer converges all the way to one everywhere
    on the interval. This iteration therefore does not produce UV^T but rather something like US'V^T
    where S' is diagonal with S_{ii}' ~ Uniform(0.5, 1.5), which turns out not to hurt model
    performance at all relative to UV^T, where USV^T = G is the SVD.
    """
    assert len(G.shape) == 2
    a, b, c = (3.4445, -4.7750,  2.0315)
    X = G.bfloat16()
    X /= (X.norm() + eps) # ensure top singular value <= 1
    if G.size(0) > G.size(1):
        X = X.T
    for _ in range(steps):
        A = X @ X.T
        B = b * A + c * A @ A # adapted from suggestion by @jxbz, @leloykun, and @YouJiacheng
        X = a * X + B @ X
    if G.size(0) > G.size(1):
        X = X.T
    return X

class Muon(torch.optim.Optimizer):
    """
    Muon - MomentUm Orthogonalized by Newton-schulz

    Muon internally runs standard SGD-momentum, and then performs an orthogonalization post-
    processing step, in which each 2D parameter's update is replaced with the nearest orthogonal
    matrix. To efficiently orthogonalize each update, we use a Newton-Schulz iteration, which has
    the advantage that it can be stably run in bfloat16 on the GPU.

    Some warnings:
    - This optimizer assumes that all parameters passed in are 2D.
    - It should not be used for the embedding layer, the final fully connected layer, or any {0,1}-D
    parameters; those should all be optimized by a standard method (e.g., AdamW).
    - To use it with 4D convolutional filters, it works well to just flatten their last 3 dimensions.
    - We believe it is unlikely to work well for training with small batch size.
    - We believe it may not work well for finetuning pretrained models, but we haven't tested this.
    - We have not yet tried this optimizer for training scenarios larger than NanoGPT (124M).

    Arguments:
        lr: The learning rate used by the internal SGD.
        momentum: The momentum used by the internal SGD.
        nesterov: Whether to use Nesterov-style momentum in the internal SGD. (recommended)
        ns_steps: The number of Newton-Schulz iteration steps to use.
    """
    def __init__(self, params, lr=0.02, momentum=0.95, nesterov=True, ns_steps=5):
        self.world_size = int(os.environ['WORLD_SIZE'])
        self.rank = int(os.environ['RANK'])
        defaults = dict(lr=lr, momentum=momentum, nesterov=nesterov, ns_steps=ns_steps)
        params = list(params)
        assert all(isinstance(p, torch.Tensor) for p in params)
        sizes = {p.numel() for p in params}
        param_groups = [
            {
                'params': [p for p in params if p.numel() == size],
                'update_buffer': [
                    torch.empty(size, device='cuda', dtype=torch.bfloat16)
                    for _ in range(self.world_size)
                ],
            }
            for size in sizes
        ]
        super().__init__(param_groups, defaults)

    def step(self):

        for group in self.param_groups:

            lr = group['lr']
            momentum = group['momentum']
            nesterov = group['nesterov']
            ns_steps = group['ns_steps']
            update_buffers = group['update_buffer']
            # generate weight updates in distributed fashion
            params = group['params']
            assert len(params) % self.world_size == 0
            handle = None
            params_world = None
            def update_prev():
                if params_world is None:
                    return
                assert handle is not None
                handle.wait()
                for p_world, g_world in zip(params_world, update_buffers):
                    p_world.data.add_(
                        g_world.view_as(p_world),
                        alpha=-lr * max(1, p_world.size(0) / p_world.size(1)) ** 0.5,
                    )
            for base_i in range(len(params))[::self.world_size]:
                p = params[base_i + self.rank]
                g = p.grad
                assert g is not None
                state = self.state[p]
                if 'momentum_buffer' not in state:
                    state['momentum_buffer'] = torch.zeros_like(g)
                buf = state['momentum_buffer']
                buf.lerp_(g, 1 - momentum)
                g = g.lerp_(buf, momentum) if nesterov else buf
                g = zeropower_via_newtonschulz5(g, steps=ns_steps).flatten()
                update_prev()
                handle = dist.all_gather(update_buffers, g, async_op=True)
                params_world = params[base_i : base_i + self.world_size]
            update_prev()

# -----------------------------------------------------------------------------
# PyTorch nn.Module definitions for the GPT-2 model

def norm(x):
    return F.rms_norm(x, (x.size(-1),))

class CastedLinear(nn.Linear):

    def __init__(self, in_features, out_features):
        super().__init__(in_features, out_features, bias=False)

    def forward(self, x):
        return F.linear(x, self.weight.to(x.dtype))

class Rotary(torch.nn.Module):

    def __init__(self, dim, base=10000):
        super().__init__()
        self.register_buffer('inv_freq', (1 / base) ** (torch.arange(0, dim, 2) / dim))
        self.seq_len_cached = None
        self.cos_cached = None
        self.sin_cached = None

    def forward(self, x):
        seq_len = x.shape[1]
        if seq_len != self.seq_len_cached:
            t = torch.arange(seq_len, device=x.device)
            freqs = torch.outer(t, self.inv_freq)
            self.seq_len_cached = seq_len
            self.cos_cached = freqs.cos()
            self.sin_cached = freqs.sin()
        cos, sin = self.cos_cached[None, :, None, :], self.sin_cached[None, :, None, :]
        # apply_rotary_emb(x, cos, sin)
        x1, x2 = x.chunk(2, dim=3)
        y1 = x1 * cos + x2 * sin
        y2 = x1 * (-sin) + x2 * cos
        return torch.cat((y1, y2), 3).type_as(x)

class CausalSelfAttention(nn.Module):

    def __init__(self, dim, num_heads):
        super().__init__()
        assert dim % num_heads == 0
        self.num_heads = num_heads
        self.c_q = CastedLinear(dim, dim)
        self.c_k = CastedLinear(dim, dim)
        self.c_v = CastedLinear(dim, dim)
        self.lambdas = nn.Parameter(torch.tensor([0.5, 0.5]))
        self.rotary = Rotary(dim // num_heads) # dim // num_heads = head_dim
        self.c_proj = CastedLinear(dim, dim)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977

    def forward(self, x, vi, block_mask):
        B, T = x.size(0), x.size(1) # batch size, sequence length
        assert B == 1, "Must use batch size = 1 for FlexAttention"
        q = self.c_q(x).view(B, T, self.num_heads, -1)
        k = self.c_k(x).view(B, T, self.num_heads, -1)
        v = self.c_v(x).view(B, T, self.num_heads, -1)
        v = self.lambdas[0] * v + self.lambdas[1] * vi.view_as(v) # @KoszarskyB & @Grad62304977
        q, k = norm(q), norm(k) # QK norm @Grad62304977
        q, k = self.rotary(q), self.rotary(k)
        y = flex_attention(q.transpose(1, 2), k.transpose(1, 2), v.transpose(1, 2), block_mask=block_mask)
        y = y.transpose(1, 2).contiguous().view_as(x) # re-assemble all head outputs side by side
        y = self.c_proj(y)
        return y

class MLP(nn.Module):

    def __init__(self, dim):
        super().__init__()
        self.c_fc   = CastedLinear(dim, 4 * dim)
        self.c_proj = CastedLinear(4 * dim, dim)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977

    def forward(self, x):
        x = self.c_fc(x)
        x = F.relu(x).square() # https://arxiv.org/abs/2109.08668v2; ~1-2% better than GELU; suggested by @SKYLINEZ007 and @Grad62304977
        x = self.c_proj(x)
        return x

class Block(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.attn = CausalSelfAttention(config.model_dim, config.num_heads)
        self.mlp = MLP(config.model_dim)
        self.lambdas = nn.Parameter(torch.tensor([1., 0.]))

    def forward(self, x, vi, x0, block_mask):
        x = self.lambdas[0] * x + self.lambdas[1] * x0
        x = x + self.attn(norm(x), vi, block_mask)
        x = x + self.mlp(norm(x))
        return x

# -----------------------------------------------------------------------------
# The main GPT-2 model

@dataclass
class GPTConfig:
    vocab_size : int = 50304
    num_layers : int = 12
    num_heads : int = 6 # head dim 128 suggested by @Grad62304977
    model_dim : int = 768

class GPT(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.num_layers = config.num_layers

        # U-net design by @brendanh0gan
        self.num_encoder_layers = config.num_layers // 2 # Half of the layers for encoder
        self.num_decoder_layers = config.num_layers - self.num_encoder_layers # Remaining for decoder
        # Add learnable skip connection weights for decoder layers
        self.skip_weights = nn.Parameter(torch.ones(self.num_decoder_layers))

        self.embed = nn.Embedding(config.vocab_size, config.model_dim)
        self.blocks = nn.ModuleList([Block(config) for _ in range(config.num_layers)])
        # token value embeddings by @KoszarskyB - inspired by @Grad62304977's value residual learning
        # U-net structure on token value embeddings by @leloykun
        self.value_embeds = nn.Embedding(config.vocab_size, config.model_dim*self.num_encoder_layers)
        self.lm_head = CastedLinear(config.model_dim, config.vocab_size)
        self.lm_head.weight.data.zero_() # @Grad62304977

    def forward(self, inputs, targets, sliding_window_size):

        BLOCK_SIZE = 128
        assert inputs.ndim == 1
        docs = (inputs == 50256).cumsum(0)
        docs_low = docs.reshape(-1, BLOCK_SIZE)[:, 0].contiguous()
        docs_high = docs.reshape(-1, BLOCK_SIZE)[:, -1].contiguous()
        def document_sliding_window_causal(b, h, q_idx, kv_idx):
            causal_mask = q_idx >= kv_idx
            document_mask = docs[q_idx] == docs[kv_idx]
            window_mask = q_idx - kv_idx < sliding_window_size
            return causal_mask & document_mask & window_mask

        S = len(inputs)
        def create_sliding_window_causal_mask(S, sliding_window_size):
            kv_idx = block_idx = torch.arange(S // BLOCK_SIZE, dtype=torch.int32, device="cuda")
            q_idx = block_idx[:, None]
            causal_mask = q_idx >= kv_idx
            document_mask = (docs_low[q_idx] <= docs_high[kv_idx]) & (docs_low[kv_idx] <= docs_high[q_idx])
            window_mask = q_idx - kv_idx < ((sliding_window_size + BLOCK_SIZE - 1) // BLOCK_SIZE)
            dense_mask = causal_mask & document_mask & window_mask
            dense_mask = dense_mask.to(torch.int32)
            num_blocks = dense_mask.sum(dim=-1).to(torch.int32)
            indices = torch.argsort(dense_mask, dim=-1, descending=True, stable=True).to(torch.int32)
            num_blocks = num_blocks[None, None, :].contiguous()
            indices = indices[None, None, :].contiguous()
            return BlockMask.from_kv_blocks(num_blocks, indices, BLOCK_SIZE=BLOCK_SIZE, mask_mod=document_sliding_window_causal)
        block_mask = create_sliding_window_causal_mask(S, sliding_window_size)

        # forward the GPT model itself
        x = self.embed(inputs[None]) # token embeddings of shape (b, t, model_dim)
        x = norm(x) # @Grad62304977
        x0 = x
        vi = self.value_embeds(inputs[None]).chunk(self.num_encoder_layers, dim=-1)

        # Store outputs for U-Net skip connections
        skip_connections = []
        # Encoder pass - process only the first half of the blocks
        for i in range(self.num_encoder_layers):
            x = self.blocks[i](x, vi[i], x0, block_mask)
            skip_connections.append(x)
        # Decoder pass - process the remaining blocks with weighted skip connections
        for i in range(self.num_decoder_layers):
            x = x + self.skip_weights[i] * skip_connections.pop()
            # U-net structure on token value embeddings by @leloykun
            x = self.blocks[self.num_encoder_layers + i](x, vi[self.num_encoder_layers-1-i], x0, block_mask)

        x = norm(x)
        logits = self.lm_head(x)
        logits = 30 * torch.tanh(logits / 30) # @Grad62304977
        logits = logits.float()
        loss = F.cross_entropy(logits.view(-1, logits.size(-1)), targets.view(-1))
        return loss

# -----------------------------------------------------------------------------
# Our own simple Distributed Data Loader

def _peek_data_shard(file: Path):
    # only reads the header, returns header data
    # header is 256 int32
    header = torch.from_file(f"{file}", False, 256, dtype=torch.int32)
    assert header[0] == 20240520, "magic number mismatch in the data .bin file"
    assert header[1] == 1, "unsupported version"
    return int(header[2]) # number of tokens (claimed)

def _load_data_shard(path, num_tokens):
    with path.open("rb") as f:
        tokens = torch.empty(num_tokens, dtype=torch.uint16, pin_memory=True)
        f.seek(256 * 4)
        nbytes = f.readinto(tokens.numpy())
        assert nbytes == 2 * num_tokens, "number of tokens read does not match header?"
    return tokens

class DistributedDataLoader:
    def __init__(self, filename_pattern, seq_len, process_rank, num_processes):
        self.process_rank = process_rank
        self.num_processes = num_processes
        self.seq_len = seq_len

        # glob files that match the pattern
        self.files = sorted(Path.cwd().glob(filename_pattern))
        assert len(self.files) > 0, f"did not find any files that match the pattern {filename_pattern}"

        # load and validate all data shards, count number of tokens in total
        self.files_num_tokens = [_peek_data_shard(file) for file in self.files]
        assert min(self.files_num_tokens) >= num_processes * seq_len + 1
        self.total_num_tokens = sum(self.files_num_tokens)

        self.reset()

    def reset(self):
        self.current_shard = -1
        self.advance()

    def advance(self): # advance to next data shard
        self.current_shard = (self.current_shard + 1) % len(self.files)
        self.current_position = self.process_rank * self.seq_len
        self.tokens = _load_data_shard(self.files[self.current_shard], self.files_num_tokens[self.current_shard])

    def next_batch(self):
        batch_size = self.seq_len * self.num_processes
        buf = self.tokens[self.current_position:self.current_position+self.seq_len+1]
        # host side async is sufficient;
        # no performance improvement was observed when introducing a separate stream.
        inputs = buf[:-1].to(device="cuda", dtype=torch.int32, non_blocking=True) # inputs
        targets = buf[1:].to(device="cuda", dtype=torch.int64, non_blocking=True) # targets
        # advance current position and load next shard if necessary
        self.current_position += batch_size
        if self.current_position + batch_size + 1 >= len(self.tokens):
            self.advance()
        return inputs, targets

# -----------------------------------------------------------------------------
# int main

@dataclass
class Hyperparameters:
    # data hyperparams
    input_bin : str = 'data/fineweb10B/fineweb_train_*.bin' # input .bin to train on
    input_val_bin : str = 'data/fineweb10B/fineweb_val_*.bin' # input .bin to eval validation loss on
    # optimization hyperparams
    batch_size : int = 8 # batch size, in sequences, across all devices
    sequence_length : int = 64*1024 # sequence length, in tokens
    num_iterations : int = 1480 # number of iterations to run
    warmup_iters : int = 0
    cooldown_iters : int = 600 # number of iterations of linear warmup/cooldown for triangular or trapezoidal schedule
    weight_decay : float = 0
    # evaluation and logging hyperparams
    val_loss_every : int = 125 # every how many steps to evaluate val loss? 0 for only at the end
    val_tokens : int = 10485760 # how many tokens of validation data? it's important to keep this fixed for consistent comparisons
    save_every : int = 0 # every how many steps to save the checkpoint? 0 for only at the end
args = Hyperparameters()

# set up DDP (distributed data parallel). torchrun sets this env variable
assert torch.cuda.is_available()
dist.init_process_group(backend='nccl')
ddp_rank = int(os.environ['RANK'])
ddp_local_rank = int(os.environ['LOCAL_RANK'])
ddp_world_size = int(os.environ['WORLD_SIZE'])
device = f'cuda:{ddp_local_rank}'
torch.cuda.set_device(device)
print(f"using device: {device}")
master_process = (ddp_rank == 0) # this process will do logging, checkpointing etc.

# begin logging
logfile = None
if master_process:
    run_id = str(uuid.uuid4())
    logdir = 'logs/%s/' % run_id
    os.makedirs(logdir, exist_ok=True)
    logfile = 'logs/%s.txt' % run_id
    # create the log file
    with open(logfile, "w") as f:
        # begin the log by printing this file (the Python code)
        f.write(code)
        f.write('='*100 + '\n')
def print0(s, logonly=False):
    if master_process:
        with open(logfile, "a") as f:
            if not logonly:
                print(s)
            f.write(s+'\n')
# log information about the hardware/software environment this is running on
# and print the full `nvidia-smi` to file
print0(f"Running python {sys.version}")
print0(f"Running pytorch {torch.version.__version__} compiled for CUDA {torch.version.cuda}\nnvidia-smi:")
import subprocess
result = subprocess.run(['nvidia-smi'], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
print0(f'{result.stdout}', logonly=True)
print0('='*100, logonly=True)

# calculate the number of steps to take in the val loop.
assert args.val_tokens % (args.sequence_length * ddp_world_size) == 0
val_steps = args.val_tokens // (args.sequence_length * ddp_world_size)
# calculate the steps of gradient accumulation required to attain the desired global batch size.
assert args.batch_size % (ddp_world_size) == 0
train_accumulation_steps = args.batch_size // ddp_world_size

# load tokens
train_loader = DistributedDataLoader(args.input_bin, args.sequence_length, ddp_rank, ddp_world_size)
val_loader = DistributedDataLoader(args.input_val_bin, args.sequence_length, ddp_rank, ddp_world_size)
print0(f"Training DataLoader: total number of tokens: {train_loader.total_num_tokens} across {len(train_loader.files)} files")
print0(f"Validation DataLoader: total number of tokens: {val_loader.total_num_tokens} across {len(val_loader.files)} files")
print0('='*100, logonly=True)
inputs_train, targets_train = train_loader.next_batch()

# there are only 50257 unique GPT-2 tokens; we extend to nearest multiple of 128 for efficiency. suggested to me by @Grad62304977.
# this originates from Karpathy's experiments.
num_vocab = 50304
model = GPT(GPTConfig(vocab_size=num_vocab, num_layers=12, num_heads=6, model_dim=768))
model = model.cuda().bfloat16()
for m in model.modules():
    if isinstance(m, CastedLinear):
        m.float()
if hasattr(config, "coordinate_descent_tuning"):
    config.coordinate_descent_tuning = True # suggested by @Chillee
model = torch.compile(model)
# here we wrap model into DDP container
model = DDP(model, device_ids=[ddp_local_rank])
raw_model = model.module # always contains the "raw" unwrapped model

# init the optimizer(s)
optimizer1 = torch.optim.Adam([raw_model.embed.weight, raw_model.value_embeds.weight], lr=0.6, betas=(0.8, 0.95), fused=True)
optimizer2 = torch.optim.Adam([raw_model.lm_head.weight], lr=0.008, betas=(0.8, 0.95), fused=True)
params = list(raw_model.blocks.parameters())
matrix_params = [p for p in params if p.ndim == 2]
scalar_params = [p for p in params if p.ndim < 2] + [raw_model.skip_weights]
optimizer3 = Muon(matrix_params, lr=0.05, momentum=0.95)
optimizer4 = torch.optim.Adam(scalar_params, lr=0.04, betas=(0.8, 0.95), fused=True)
optimizers = [optimizer1, optimizer2, optimizer3, optimizer4]
# learning rate decay scheduler (linear warmup and cooldown)
def get_lr(it):
    assert it <= args.num_iterations
    # 1) linear warmup for warmup_iters steps
    if it < args.warmup_iters:
        return (it+1) / args.warmup_iters
    # 2) constant lr for a while
    elif it < args.num_iterations - args.cooldown_iters:
        return 1.0
    # 3) linear cooldown
    else:
        decay_ratio = (args.num_iterations - it) / args.cooldown_iters
        return decay_ratio
schedulers = [torch.optim.lr_scheduler.LambdaLR(opt, get_lr) for opt in optimizers]

sliding_window_size = torch.tensor(64, dtype=torch.int32, device="cuda")
sw_size_prev = 64
# Start training loop
training_time_ms = 0
# start the clock
torch.cuda.synchronize()
t0 = time.perf_counter()
# begin training
for step in range(args.num_iterations + 1):
    last_step = (step == args.num_iterations)
    # This effectively ignores timing first 10 steps, which are slower for weird reasons.
    # Alternately, and slightly more correctly in terms of benchmarking, we could do 10
    # steps with dummy data first, and then re-initialize the model and reset the loader.
    if step == 10:
        training_time_ms = 0
        t0 = time.perf_counter()
    timed_steps = float('nan') if step <= 11 else (step - 10) + 1 # <= 11 to avoid bug in val

    # Linearly increase the sliding window size over training in chunks of 64 from 64 -> 1792. By @fernbear.bsky.social
    frac_done = step / args.num_iterations # training progress
    sw_size = 64 * (((1 - frac_done) * 64 + frac_done * 1792) // 64)
    if sw_size != sw_size_prev:
        sliding_window_size.copy_(sw_size, non_blocking=True)
        sw_size_prev = sw_size

    # once in a while evaluate the validation dataset
    if (last_step or (args.val_loss_every > 0 and step % args.val_loss_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.perf_counter() - t0)
        # run validation batches
        model.eval()
        val_loader.reset()
        val_loss = 0.0
        for _ in range(val_steps):
            with torch.no_grad():
                inputs_val, targets_val = val_loader.next_batch()
                val_loss += model(inputs_val, targets_val, sliding_window_size)
        dist.all_reduce(val_loss, op=dist.ReduceOp.AVG)
        val_loss /= val_steps
        # log val loss to console and to logfile
        print0(f'step:{step}/{args.num_iterations} val_loss:{val_loss:.4f} train_time:{training_time_ms:.0f}ms step_avg:{training_time_ms/(timed_steps-1):.2f}ms')
        if master_process:
            print0("============== Weight norms: ==============")
            for name, p in model.named_parameters():
                if p.ndim != 2:
                    continue
                frobenius_norm = torch.linalg.norm(p.data.float(), ord='fro').item()
                spectral_norm = torch.linalg.matrix_norm(p.data.float(), ord=2).item()
                median_sv = torch.median(p.data.float().svd(compute_uv=False).S).item()
                if "embed" in name:
                    l1_to_l2_norm = torch.norm(p.data.float(), p=2, dim=1).mean().item()
                    print0(f"W {name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {median_sv = :.5f} | {l1_to_l2_norm = :.5f}")
                else:
                    print0(f"W {name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {median_sv = :.5f}")
            print0("===========================================")
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.perf_counter()

    if master_process and (last_step or (args.save_every > 0 and step % args.save_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.perf_counter() - t0)
        # save the state of the training process
        log = dict(step=step, code=code, model=raw_model.state_dict(), optimizers=[opt.state_dict() for opt in optimizers])
        torch.save(log, 'logs/%s/state_step%06d.pt' % (run_id, step))
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.perf_counter()

    # bit confusing: we want to make sure to eval on 0th iteration
    # but also after the very last iteration. so we loop for step <= num_iterations
    # instead of just < num_iterations (one extra due to <=), only to do
    # the validation/sampling one last time, and then we break right here as we're done.
    if last_step:
        break

    # --------------- TRAINING SECTION BEGIN -----------------
    model.train()
    for i in range(1, train_accumulation_steps+1):
        ctx = model.no_sync() if i < train_accumulation_steps else contextlib.nullcontext()
        with ctx: # there's no need to sync gradients every accumulation step
            loss = model(inputs_train, targets_train, sliding_window_size)
            loss.backward()
            del loss
            inputs_train, targets_train = train_loader.next_batch()
    if train_accumulation_steps != 1:
        for p in model.parameters():
            p.grad /= train_accumulation_steps
    if master_process and (last_step or (args.val_loss_every > 0 and step % args.val_loss_every == 0)):
        print0("============== Gradient norms: ==============")
        for name, p in model.named_parameters():
            if p.ndim != 2:
                continue
            if p.grad is None:
                continue
            frobenius_norm = torch.linalg.norm(p.grad.float(), ord='fro').item()
            spectral_norm = torch.linalg.matrix_norm(p.grad.float(), ord=2).item()
            median_sv = torch.median(p.grad.float().svd(compute_uv=False).S).item()
            if "embed" in name:
                l1_to_l2_norm = torch.norm(p.grad.float(), p=2, dim=1).mean().item()
                print0(f"G {name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {median_sv = :.5f} | {l1_to_l2_norm = :.5f}")
            else:
                print0(f"G {name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {median_sv = :.5f}")
        print0("===========================================")
    # momentum warmup for Muon
    frac = min(step/300, 1)
    for group in optimizer3.param_groups:
        group['momentum'] = (1 - frac) * 0.85 + frac * 0.95
    # step the optimizers and schedulers
    for opt, sched in zip(optimizers, schedulers):
        opt.step()
        sched.step()
    # null the gradients
    model.zero_grad(set_to_none=True)
    # --------------- TRAINING SECTION END -------------------
    # everything that follows now is just diagnostics, prints, logging, etc.
    approx_time = training_time_ms + 1000 * (time.perf_counter() - t0)
    print0(f"step:{step+1}/{args.num_iterations} train_time:{approx_time:.0f}ms step_avg:{approx_time/timed_steps:.2f}ms")

print0(f"peak memory consumption: {torch.cuda.max_memory_allocated() // 1024 // 1024} MiB")

# -------------------------------------------------------------------------
# clean up nice
dist.destroy_process_group()
====================================================================================================
Running python 3.10.12 (main, Sep 11 2024, 15:47:36) [GCC 11.4.0]
Running pytorch 2.6.0.dev20241203+cu124 compiled for CUDA 12.4
nvidia-smi:
Tue Dec 10 18:03:05 2024       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 560.35.03              Driver Version: 560.35.03      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H100 80GB HBM3          On  |   00000000:0B:00.0 Off |                    0 |
| N/A   23C    P0             67W /  700W |       4MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA H100 80GB HBM3          On  |   00000000:0C:00.0 Off |                    0 |
| N/A   24C    P0             90W /  700W |      23MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA H100 80GB HBM3          On  |   00000000:0D:00.0 Off |                    0 |
| N/A   23C    P0            105W /  700W |      23MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA H100 80GB HBM3          On  |   00000000:11:00.0 Off |                    0 |
| N/A   22C    P0            100W /  700W |      23MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
+-----------------------------------------------------------------------------------------+

====================================================================================================
Training DataLoader: total number of tokens: 900000000 across 9 files
Validation DataLoader: total number of tokens: 100000000 across 1 files
====================================================================================================
step:0/1480 val_loss:10.8258 train_time:0ms step_avg:nanms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | frobenius_norm = 6215.71631 | spectral_norm = 251.64417 | median_sv = 223.68825 | l1_to_l2_norm = 27.70433
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 16.00943 | spectral_norm = 1.14913 | median_sv = 0.46678
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 15.99936 | spectral_norm = 1.14827 | median_sv = 0.46781
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 15.99444 | spectral_norm = 1.15175 | median_sv = 0.46609
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 31.98703 | spectral_norm = 1.72301 | median_sv = 1.10587
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 15.99322 | spectral_norm = 1.15588 | median_sv = 0.46549
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 15.99887 | spectral_norm = 1.14366 | median_sv = 0.46374
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 15.98331 | spectral_norm = 1.16328 | median_sv = 0.46576
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 31.99877 | spectral_norm = 1.72194 | median_sv = 1.10482
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 16.01388 | spectral_norm = 1.15088 | median_sv = 0.46814
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 16.00582 | spectral_norm = 1.14563 | median_sv = 0.46585
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 16.00009 | spectral_norm = 1.14904 | median_sv = 0.46512
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 32.00503 | spectral_norm = 1.72333 | median_sv = 1.10450
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 15.99286 | spectral_norm = 1.15096 | median_sv = 0.46324
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 15.99667 | spectral_norm = 1.13794 | median_sv = 0.46660
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 15.98719 | spectral_norm = 1.14071 | median_sv = 0.46461
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 31.98642 | spectral_norm = 1.73271 | median_sv = 1.10640
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 16.00027 | spectral_norm = 1.16471 | median_sv = 0.46501
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 16.00135 | spectral_norm = 1.16371 | median_sv = 0.46837
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 15.99361 | spectral_norm = 1.14767 | median_sv = 0.46447
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 32.02052 | spectral_norm = 1.72441 | median_sv = 1.10380
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 16.01183 | spectral_norm = 1.15646 | median_sv = 0.46709
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 15.99967 | spectral_norm = 1.14722 | median_sv = 0.46577
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 15.99200 | spectral_norm = 1.14160 | median_sv = 0.46599
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 31.99808 | spectral_norm = 1.72519 | median_sv = 1.10304
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 15.99279 | spectral_norm = 1.14081 | median_sv = 0.46458
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 15.99111 | spectral_norm = 1.14192 | median_sv = 0.46489
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 16.00302 | spectral_norm = 1.14791 | median_sv = 0.46672
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 32.00591 | spectral_norm = 1.72838 | median_sv = 1.10395
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 16.00780 | spectral_norm = 1.14988 | median_sv = 0.46646
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 15.99518 | spectral_norm = 1.15681 | median_sv = 0.46498
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 15.99061 | spectral_norm = 1.15605 | median_sv = 0.46410
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 31.99136 | spectral_norm = 1.72699 | median_sv = 1.10555
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 16.00226 | spectral_norm = 1.14538 | median_sv = 0.46482
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 16.00312 | spectral_norm = 1.14461 | median_sv = 0.46627
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 16.00833 | spectral_norm = 1.14429 | median_sv = 0.46892
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 31.99516 | spectral_norm = 1.72200 | median_sv = 1.10533
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 15.99934 | spectral_norm = 1.13608 | median_sv = 0.46598
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 16.00366 | spectral_norm = 1.14413 | median_sv = 0.46702
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 16.00744 | spectral_norm = 1.13979 | median_sv = 0.46576
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 32.00000 | spectral_norm = 1.72832 | median_sv = 1.10566
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 16.00282 | spectral_norm = 1.14730 | median_sv = 0.46618
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 16.00234 | spectral_norm = 1.14973 | median_sv = 0.46554
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 16.01576 | spectral_norm = 1.15105 | median_sv = 0.46686
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 31.98577 | spectral_norm = 1.72881 | median_sv = 1.10446
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 15.99039 | spectral_norm = 1.14287 | median_sv = 0.46767
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 15.99424 | spectral_norm = 1.14768 | median_sv = 0.46550
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 16.00223 | spectral_norm = 1.15327 | median_sv = 0.46824
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 31.99815 | spectral_norm = 1.73238 | median_sv = 1.10509
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
W name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 15225.55078 | spectral_norm = 292.01920 | median_sv = 220.92535 | l1_to_l2_norm = 67.88103
W name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.00000 | spectral_norm = -0.00000 | median_sv = -0.00000
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | frobenius_norm = 0.00000 | spectral_norm = -0.00000 | median_sv = -0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | median_sv = 0.00000
G name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 0.00000 | spectral_norm = -0.00000 | median_sv = -0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.44040 | spectral_norm = 0.30855 | median_sv = 0.00107
===========================================
step:1/1480 train_time:314123ms step_avg:nanms
step:2/1480 train_time:314381ms step_avg:nanms
step:3/1480 train_time:314656ms step_avg:nanms
step:4/1480 train_time:314930ms step_avg:nanms
step:5/1480 train_time:315206ms step_avg:nanms
step:6/1480 train_time:315487ms step_avg:nanms
step:7/1480 train_time:315764ms step_avg:nanms
step:8/1480 train_time:316040ms step_avg:nanms
step:9/1480 train_time:316314ms step_avg:nanms
step:10/1480 train_time:316592ms step_avg:nanms
step:11/1480 train_time:280ms step_avg:nanms
step:12/1480 train_time:558ms step_avg:nanms
step:13/1480 train_time:835ms step_avg:278.49ms
step:14/1480 train_time:1112ms step_avg:278.04ms
step:15/1480 train_time:1391ms step_avg:278.13ms
step:16/1480 train_time:1666ms step_avg:277.75ms
step:17/1480 train_time:1943ms step_avg:277.57ms
step:18/1480 train_time:2223ms step_avg:277.83ms
step:19/1480 train_time:2503ms step_avg:278.15ms
step:20/1480 train_time:2782ms step_avg:278.21ms
step:21/1480 train_time:3059ms step_avg:278.10ms
step:22/1480 train_time:3335ms step_avg:277.92ms
step:23/1480 train_time:3612ms step_avg:277.84ms
step:24/1480 train_time:3887ms step_avg:277.62ms
step:25/1480 train_time:4168ms step_avg:277.89ms
step:26/1480 train_time:4442ms step_avg:277.61ms
step:27/1480 train_time:4719ms step_avg:277.59ms
step:28/1480 train_time:4998ms step_avg:277.67ms
step:29/1480 train_time:5277ms step_avg:277.76ms
step:30/1480 train_time:5555ms step_avg:277.75ms
step:31/1480 train_time:5834ms step_avg:277.79ms
step:32/1480 train_time:6109ms step_avg:277.67ms
step:33/1480 train_time:6385ms step_avg:277.61ms
step:34/1480 train_time:6663ms step_avg:277.63ms
step:35/1480 train_time:6943ms step_avg:277.71ms
step:36/1480 train_time:7219ms step_avg:277.67ms
step:37/1480 train_time:7497ms step_avg:277.66ms
step:38/1480 train_time:7774ms step_avg:277.63ms
step:39/1480 train_time:8051ms step_avg:277.62ms
step:40/1480 train_time:8326ms step_avg:277.54ms
step:41/1480 train_time:8602ms step_avg:277.47ms
step:42/1480 train_time:8878ms step_avg:277.45ms
step:43/1480 train_time:9155ms step_avg:277.42ms
step:44/1480 train_time:9431ms step_avg:277.37ms
step:45/1480 train_time:9708ms step_avg:277.38ms
step:46/1480 train_time:9984ms step_avg:277.35ms
step:47/1480 train_time:10261ms step_avg:277.34ms
step:48/1480 train_time:10538ms step_avg:277.31ms
step:49/1480 train_time:10815ms step_avg:277.30ms
step:50/1480 train_time:11092ms step_avg:277.29ms
step:51/1480 train_time:11369ms step_avg:277.29ms
step:52/1480 train_time:11647ms step_avg:277.30ms
step:53/1480 train_time:11926ms step_avg:277.35ms
step:54/1480 train_time:12201ms step_avg:277.29ms
step:55/1480 train_time:12477ms step_avg:277.28ms
step:56/1480 train_time:12755ms step_avg:277.29ms
step:57/1480 train_time:13033ms step_avg:277.30ms
step:58/1480 train_time:13314ms step_avg:277.38ms
step:59/1480 train_time:13589ms step_avg:277.33ms
step:60/1480 train_time:13866ms step_avg:277.32ms
step:61/1480 train_time:14142ms step_avg:277.30ms
step:62/1480 train_time:14421ms step_avg:277.32ms
step:63/1480 train_time:14697ms step_avg:277.30ms
step:64/1480 train_time:14975ms step_avg:277.31ms
step:65/1480 train_time:15252ms step_avg:277.30ms
step:66/1480 train_time:15531ms step_avg:277.34ms
step:67/1480 train_time:15808ms step_avg:277.33ms
step:68/1480 train_time:16085ms step_avg:277.32ms
step:69/1480 train_time:16363ms step_avg:277.33ms
step:70/1480 train_time:16641ms step_avg:277.35ms
step:71/1480 train_time:16917ms step_avg:277.32ms
step:72/1480 train_time:17193ms step_avg:277.31ms
step:73/1480 train_time:17471ms step_avg:277.32ms
step:74/1480 train_time:17749ms step_avg:277.32ms
step:75/1480 train_time:18026ms step_avg:277.32ms
step:76/1480 train_time:18302ms step_avg:277.31ms
step:77/1480 train_time:18579ms step_avg:277.30ms
step:78/1480 train_time:18856ms step_avg:277.29ms
step:79/1480 train_time:19131ms step_avg:277.26ms
step:80/1480 train_time:19408ms step_avg:277.26ms
step:81/1480 train_time:19686ms step_avg:277.26ms
step:82/1480 train_time:19963ms step_avg:277.26ms
step:83/1480 train_time:20241ms step_avg:277.27ms
step:84/1480 train_time:20518ms step_avg:277.27ms
step:85/1480 train_time:20796ms step_avg:277.28ms
step:86/1480 train_time:21072ms step_avg:277.26ms
step:87/1480 train_time:21350ms step_avg:277.27ms
step:88/1480 train_time:21628ms step_avg:277.28ms
step:89/1480 train_time:21903ms step_avg:277.26ms
step:90/1480 train_time:22181ms step_avg:277.26ms
step:91/1480 train_time:22457ms step_avg:277.25ms
step:92/1480 train_time:22734ms step_avg:277.24ms
step:93/1480 train_time:23010ms step_avg:277.23ms
step:94/1480 train_time:23286ms step_avg:277.22ms
step:95/1480 train_time:23563ms step_avg:277.22ms
step:96/1480 train_time:23840ms step_avg:277.20ms
step:97/1480 train_time:24116ms step_avg:277.20ms
step:98/1480 train_time:24393ms step_avg:277.19ms
step:99/1480 train_time:24669ms step_avg:277.18ms
step:100/1480 train_time:24947ms step_avg:277.19ms
step:101/1480 train_time:25225ms step_avg:277.20ms
step:102/1480 train_time:25500ms step_avg:277.18ms
step:103/1480 train_time:25777ms step_avg:277.17ms
step:104/1480 train_time:26055ms step_avg:277.18ms
step:105/1480 train_time:26333ms step_avg:277.19ms
step:106/1480 train_time:26611ms step_avg:277.20ms
step:107/1480 train_time:26888ms step_avg:277.19ms
step:108/1480 train_time:27163ms step_avg:277.18ms
step:109/1480 train_time:27441ms step_avg:277.18ms
step:110/1480 train_time:27718ms step_avg:277.18ms
step:111/1480 train_time:28004ms step_avg:277.27ms
step:112/1480 train_time:28290ms step_avg:277.35ms
step:113/1480 train_time:28575ms step_avg:277.43ms
step:114/1480 train_time:28864ms step_avg:277.54ms
step:115/1480 train_time:29146ms step_avg:277.58ms
step:116/1480 train_time:29431ms step_avg:277.65ms
step:117/1480 train_time:29719ms step_avg:277.75ms
step:118/1480 train_time:30005ms step_avg:277.82ms
step:119/1480 train_time:30290ms step_avg:277.89ms
step:120/1480 train_time:30576ms step_avg:277.96ms
step:121/1480 train_time:30862ms step_avg:278.03ms
step:122/1480 train_time:31148ms step_avg:278.11ms
step:123/1480 train_time:31433ms step_avg:278.17ms
step:124/1480 train_time:31719ms step_avg:278.23ms
step:125/1480 train_time:32005ms step_avg:278.30ms
step:125/1480 val_loss:4.4318 train_time:32019ms step_avg:278.43ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | frobenius_norm = 25211.24609 | spectral_norm = 7825.12451 | median_sv = 682.14655 | l1_to_l2_norm = 110.42782
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 35.89989 | spectral_norm = 3.71488 | median_sv = 1.04148
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 33.32625 | spectral_norm = 4.59703 | median_sv = 0.94112
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 35.30011 | spectral_norm = 3.10258 | median_sv = 0.95878
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 35.93775 | spectral_norm = 2.63449 | median_sv = 1.07093
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 70.77307 | spectral_norm = 5.66967 | median_sv = 2.38159
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 38.96238 | spectral_norm = 2.89277 | median_sv = 1.31078
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 34.85593 | spectral_norm = 3.16954 | median_sv = 0.99223
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 34.25844 | spectral_norm = 3.51230 | median_sv = 0.96591
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 36.99627 | spectral_norm = 3.56105 | median_sv = 0.96314
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 38.23228 | spectral_norm = 2.58660 | median_sv = 1.16241
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 77.36551 | spectral_norm = 5.65088 | median_sv = 2.62523
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 41.90228 | spectral_norm = 3.05140 | median_sv = 1.41421
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 34.11486 | spectral_norm = 3.02745 | median_sv = 0.95893
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 34.25018 | spectral_norm = 2.93827 | median_sv = 0.96065
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 37.47141 | spectral_norm = 3.60837 | median_sv = 0.95693
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 39.15211 | spectral_norm = 2.71975 | median_sv = 1.17319
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 79.52884 | spectral_norm = 5.60081 | median_sv = 2.69620
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 42.65064 | spectral_norm = 3.07508 | median_sv = 1.43851
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 34.28008 | spectral_norm = 3.06520 | median_sv = 0.96034
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 34.27024 | spectral_norm = 3.04351 | median_sv = 0.95495
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 37.47727 | spectral_norm = 3.53736 | median_sv = 0.93710
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 39.11430 | spectral_norm = 2.75629 | median_sv = 1.17681
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 80.52001 | spectral_norm = 5.45985 | median_sv = 2.72001
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 42.80774 | spectral_norm = 3.10015 | median_sv = 1.43813
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 33.68698 | spectral_norm = 3.20060 | median_sv = 0.94593
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 33.88484 | spectral_norm = 3.17594 | median_sv = 0.95443
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 36.54718 | spectral_norm = 3.58735 | median_sv = 0.89054
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 37.46275 | spectral_norm = 2.94341 | median_sv = 1.07909
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 81.75119 | spectral_norm = 5.58128 | median_sv = 2.75484
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 42.78148 | spectral_norm = 3.11496 | median_sv = 1.43156
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 33.38743 | spectral_norm = 2.94476 | median_sv = 0.93218
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 34.13771 | spectral_norm = 2.89172 | median_sv = 0.94852
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 36.42094 | spectral_norm = 3.53323 | median_sv = 0.87758
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 37.45316 | spectral_norm = 2.85728 | median_sv = 1.06914
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 81.33067 | spectral_norm = 5.54610 | median_sv = 2.72760
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 42.20416 | spectral_norm = 2.99947 | median_sv = 1.40424
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 32.90540 | spectral_norm = 3.07151 | median_sv = 0.92123
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 33.78566 | spectral_norm = 2.91891 | median_sv = 0.94419
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 36.10851 | spectral_norm = 3.74397 | median_sv = 0.85220
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 37.13773 | spectral_norm = 3.07824 | median_sv = 1.04837
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 82.57761 | spectral_norm = 5.76849 | median_sv = 2.76242
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 41.92669 | spectral_norm = 2.95901 | median_sv = 1.38328
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 33.34014 | spectral_norm = 3.08823 | median_sv = 0.93140
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 34.18066 | spectral_norm = 3.00437 | median_sv = 0.95962
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 35.95898 | spectral_norm = 3.54980 | median_sv = 0.86551
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 37.03059 | spectral_norm = 2.79226 | median_sv = 1.06738
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 82.47108 | spectral_norm = 5.83200 | median_sv = 2.75375
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 41.53088 | spectral_norm = 2.97432 | median_sv = 1.36491
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 33.50953 | spectral_norm = 2.90252 | median_sv = 0.93002
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 34.38110 | spectral_norm = 2.99988 | median_sv = 0.95090
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 35.34885 | spectral_norm = 3.49381 | median_sv = 0.83259
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 37.57074 | spectral_norm = 2.97067 | median_sv = 1.06562
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 81.46245 | spectral_norm = 5.97094 | median_sv = 2.71558
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 40.89203 | spectral_norm = 2.98114 | median_sv = 1.34137
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 33.02000 | spectral_norm = 2.91563 | median_sv = 0.90405
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 33.61860 | spectral_norm = 2.98800 | median_sv = 0.91342
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 35.23427 | spectral_norm = 3.28275 | median_sv = 0.85374
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 39.96024 | spectral_norm = 2.81121 | median_sv = 1.17687
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 81.09177 | spectral_norm = 6.12093 | median_sv = 2.71007
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 40.41166 | spectral_norm = 2.98377 | median_sv = 1.32620
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 33.01519 | spectral_norm = 3.05242 | median_sv = 0.90599
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 33.16063 | spectral_norm = 3.10697 | median_sv = 0.90187
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 34.93328 | spectral_norm = 3.16361 | median_sv = 0.86042
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 39.89870 | spectral_norm = 2.76093 | median_sv = 1.18557
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 79.97586 | spectral_norm = 6.04304 | median_sv = 2.66554
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 39.50838 | spectral_norm = 2.98133 | median_sv = 1.28750
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 33.53388 | spectral_norm = 3.06199 | median_sv = 0.93165
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 33.90438 | spectral_norm = 3.19732 | median_sv = 0.93577
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 33.99505 | spectral_norm = 3.10945 | median_sv = 0.82747
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 38.13567 | spectral_norm = 2.73631 | median_sv = 1.08287
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 79.26108 | spectral_norm = 6.10090 | median_sv = 2.63832
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 38.26719 | spectral_norm = 2.95110 | median_sv = 1.23842
W name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 33761.28125 | spectral_norm = 3803.37256 | median_sv = 346.37506 | l1_to_l2_norm = 142.51929
W name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 386.52179 | spectral_norm = 133.34483 | median_sv = 10.46389
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | frobenius_norm = 0.00056 | spectral_norm = 0.00036 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 0.00910 | spectral_norm = 0.00758 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 0.00919 | spectral_norm = 0.00544 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 0.03253 | spectral_norm = 0.03067 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 0.04385 | spectral_norm = 0.04135 | median_sv = 0.00008
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 0.01606 | spectral_norm = 0.01344 | median_sv = 0.00012
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 0.02880 | spectral_norm = 0.02527 | median_sv = 0.00019
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 0.01223 | spectral_norm = 0.01099 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 0.01033 | spectral_norm = 0.00702 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 0.04279 | spectral_norm = 0.04184 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 0.02829 | spectral_norm = 0.02322 | median_sv = 0.00009
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 0.01657 | spectral_norm = 0.01384 | median_sv = 0.00009
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 0.02596 | spectral_norm = 0.02261 | median_sv = 0.00015
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 0.01450 | spectral_norm = 0.01284 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 0.01219 | spectral_norm = 0.00775 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 0.03693 | spectral_norm = 0.03603 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 0.02377 | spectral_norm = 0.01995 | median_sv = 0.00008
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 0.01591 | spectral_norm = 0.01338 | median_sv = 0.00008
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 0.02481 | spectral_norm = 0.02182 | median_sv = 0.00013
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 0.00866 | spectral_norm = 0.00774 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 0.00778 | spectral_norm = 0.00487 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 0.02044 | spectral_norm = 0.01999 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 0.01423 | spectral_norm = 0.01139 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 0.01473 | spectral_norm = 0.01249 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 0.02241 | spectral_norm = 0.01966 | median_sv = 0.00011
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 0.00757 | spectral_norm = 0.00649 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 0.00741 | spectral_norm = 0.00476 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 0.02564 | spectral_norm = 0.02496 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 0.01190 | spectral_norm = 0.00933 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 0.01357 | spectral_norm = 0.01133 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 0.02050 | spectral_norm = 0.01782 | median_sv = 0.00010
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 0.00750 | spectral_norm = 0.00665 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 0.00708 | spectral_norm = 0.00403 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 0.01506 | spectral_norm = 0.01454 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 0.01053 | spectral_norm = 0.00797 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 0.01206 | spectral_norm = 0.00995 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 0.01858 | spectral_norm = 0.01621 | median_sv = 0.00008
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 0.00572 | spectral_norm = 0.00478 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 0.00624 | spectral_norm = 0.00379 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 0.01064 | spectral_norm = 0.01029 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 0.00803 | spectral_norm = 0.00653 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 0.00903 | spectral_norm = 0.00747 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 0.01653 | spectral_norm = 0.01472 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 0.00421 | spectral_norm = 0.00319 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 0.00419 | spectral_norm = 0.00212 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 0.00776 | spectral_norm = 0.00741 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 0.00837 | spectral_norm = 0.00695 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 0.00867 | spectral_norm = 0.00713 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 0.01821 | spectral_norm = 0.01637 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 0.00859 | spectral_norm = 0.00770 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 0.01003 | spectral_norm = 0.00699 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 0.00985 | spectral_norm = 0.00956 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 0.01250 | spectral_norm = 0.01163 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 0.00928 | spectral_norm = 0.00789 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 0.01984 | spectral_norm = 0.01804 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 0.01253 | spectral_norm = 0.01133 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 0.01153 | spectral_norm = 0.00757 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 0.01208 | spectral_norm = 0.01173 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 0.02298 | spectral_norm = 0.02186 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 0.01141 | spectral_norm = 0.00987 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 0.02734 | spectral_norm = 0.02527 | median_sv = 0.00008
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 0.01484 | spectral_norm = 0.01371 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 0.01145 | spectral_norm = 0.00741 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 0.01160 | spectral_norm = 0.01125 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 0.02966 | spectral_norm = 0.02855 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 0.01543 | spectral_norm = 0.01364 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 0.03974 | spectral_norm = 0.03725 | median_sv = 0.00010
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 0.01444 | spectral_norm = 0.01363 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 0.00997 | spectral_norm = 0.00720 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 0.01681 | spectral_norm = 0.01649 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 0.04913 | spectral_norm = 0.04856 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 0.02282 | spectral_norm = 0.02070 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 0.06726 | spectral_norm = 0.06414 | median_sv = 0.00013
G name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 0.00051 | spectral_norm = 0.00040 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.36114 | spectral_norm = 0.34487 | median_sv = 0.00054
===========================================
step:126/1480 train_time:41690ms step_avg:359.39ms
step:127/1480 train_time:41962ms step_avg:358.65ms
step:128/1480 train_time:42245ms step_avg:358.01ms
step:129/1480 train_time:42528ms step_avg:357.38ms
step:130/1480 train_time:42815ms step_avg:356.79ms
step:131/1480 train_time:43100ms step_avg:356.20ms
step:132/1480 train_time:43383ms step_avg:355.60ms
step:133/1480 train_time:43671ms step_avg:355.05ms
step:134/1480 train_time:43951ms step_avg:354.45ms
step:135/1480 train_time:44235ms step_avg:353.88ms
step:136/1480 train_time:44521ms step_avg:353.34ms
step:137/1480 train_time:44804ms step_avg:352.79ms
step:138/1480 train_time:45090ms step_avg:352.26ms
step:139/1480 train_time:45373ms step_avg:351.73ms
step:140/1480 train_time:45659ms step_avg:351.22ms
step:141/1480 train_time:45944ms step_avg:350.72ms
step:142/1480 train_time:46228ms step_avg:350.21ms
step:143/1480 train_time:46512ms step_avg:349.72ms
step:144/1480 train_time:46797ms step_avg:349.23ms
step:145/1480 train_time:47082ms step_avg:348.76ms
step:146/1480 train_time:47367ms step_avg:348.29ms
step:147/1480 train_time:47653ms step_avg:347.83ms
step:148/1480 train_time:47941ms step_avg:347.40ms
step:149/1480 train_time:48222ms step_avg:346.92ms
step:150/1480 train_time:48507ms step_avg:346.48ms
step:151/1480 train_time:48793ms step_avg:346.05ms
step:152/1480 train_time:49078ms step_avg:345.62ms
step:153/1480 train_time:49362ms step_avg:345.19ms
step:154/1480 train_time:49647ms step_avg:344.77ms
step:155/1480 train_time:49932ms step_avg:344.36ms
step:156/1480 train_time:50218ms step_avg:343.96ms
step:157/1480 train_time:50502ms step_avg:343.55ms
step:158/1480 train_time:50786ms step_avg:343.15ms
step:159/1480 train_time:51071ms step_avg:342.76ms
step:160/1480 train_time:51356ms step_avg:342.37ms
step:161/1480 train_time:51642ms step_avg:342.00ms
step:162/1480 train_time:51927ms step_avg:341.62ms
step:163/1480 train_time:52211ms step_avg:341.25ms
step:164/1480 train_time:52497ms step_avg:340.89ms
step:165/1480 train_time:52782ms step_avg:340.53ms
step:166/1480 train_time:53066ms step_avg:340.17ms
step:167/1480 train_time:53350ms step_avg:339.81ms
step:168/1480 train_time:53637ms step_avg:339.48ms
step:169/1480 train_time:53922ms step_avg:339.13ms
step:170/1480 train_time:54208ms step_avg:338.80ms
step:171/1480 train_time:54494ms step_avg:338.47ms
step:172/1480 train_time:54779ms step_avg:338.14ms
step:173/1480 train_time:55064ms step_avg:337.82ms
step:174/1480 train_time:55349ms step_avg:337.49ms
step:175/1480 train_time:55635ms step_avg:337.18ms
step:176/1480 train_time:55920ms step_avg:336.87ms
step:177/1480 train_time:56205ms step_avg:336.56ms
step:178/1480 train_time:56490ms step_avg:336.25ms
step:179/1480 train_time:56776ms step_avg:335.95ms
step:180/1480 train_time:57062ms step_avg:335.66ms
step:181/1480 train_time:57347ms step_avg:335.36ms
step:182/1480 train_time:57634ms step_avg:335.08ms
step:183/1480 train_time:57919ms step_avg:334.79ms
step:184/1480 train_time:58204ms step_avg:334.51ms
step:185/1480 train_time:58490ms step_avg:334.23ms
step:186/1480 train_time:58775ms step_avg:333.95ms
step:187/1480 train_time:59061ms step_avg:333.68ms
step:188/1480 train_time:59346ms step_avg:333.40ms
step:189/1480 train_time:59630ms step_avg:333.13ms
step:190/1480 train_time:59915ms step_avg:332.86ms
step:191/1480 train_time:60202ms step_avg:332.61ms
step:192/1480 train_time:60487ms step_avg:332.34ms
step:193/1480 train_time:60772ms step_avg:332.09ms
step:194/1480 train_time:61058ms step_avg:331.83ms
step:195/1480 train_time:61343ms step_avg:331.58ms
step:196/1480 train_time:61627ms step_avg:331.33ms
step:197/1480 train_time:61912ms step_avg:331.08ms
step:198/1480 train_time:62198ms step_avg:330.84ms
step:199/1480 train_time:62483ms step_avg:330.60ms
step:200/1480 train_time:62768ms step_avg:330.36ms
step:201/1480 train_time:63054ms step_avg:330.13ms
step:202/1480 train_time:63340ms step_avg:329.90ms
step:203/1480 train_time:63625ms step_avg:329.66ms
step:204/1480 train_time:63911ms step_avg:329.44ms
step:205/1480 train_time:64195ms step_avg:329.21ms
step:206/1480 train_time:64480ms step_avg:328.98ms
step:207/1480 train_time:64765ms step_avg:328.76ms
step:208/1480 train_time:65051ms step_avg:328.54ms
step:209/1480 train_time:65339ms step_avg:328.34ms
step:210/1480 train_time:65624ms step_avg:328.12ms
step:211/1480 train_time:65910ms step_avg:327.91ms
step:212/1480 train_time:66195ms step_avg:327.70ms
step:213/1480 train_time:66481ms step_avg:327.49ms
step:214/1480 train_time:66767ms step_avg:327.29ms
step:215/1480 train_time:67051ms step_avg:327.08ms
step:216/1480 train_time:67336ms step_avg:326.87ms
step:217/1480 train_time:67622ms step_avg:326.68ms
step:218/1480 train_time:67907ms step_avg:326.48ms
step:219/1480 train_time:68193ms step_avg:326.28ms
step:220/1480 train_time:68479ms step_avg:326.09ms
step:221/1480 train_time:68771ms step_avg:325.93ms
step:222/1480 train_time:69067ms step_avg:325.79ms
step:223/1480 train_time:69362ms step_avg:325.64ms
step:224/1480 train_time:69654ms step_avg:325.49ms
step:225/1480 train_time:69947ms step_avg:325.34ms
step:226/1480 train_time:70243ms step_avg:325.20ms
step:227/1480 train_time:70535ms step_avg:325.05ms
step:228/1480 train_time:70828ms step_avg:324.90ms
step:229/1480 train_time:71123ms step_avg:324.76ms
step:230/1480 train_time:71415ms step_avg:324.61ms
step:231/1480 train_time:71709ms step_avg:324.48ms
step:232/1480 train_time:72003ms step_avg:324.34ms
step:233/1480 train_time:72295ms step_avg:324.19ms
step:234/1480 train_time:72590ms step_avg:324.06ms
step:235/1480 train_time:72884ms step_avg:323.93ms
step:236/1480 train_time:73177ms step_avg:323.79ms
step:237/1480 train_time:73471ms step_avg:323.66ms
step:238/1480 train_time:73766ms step_avg:323.53ms
step:239/1480 train_time:74059ms step_avg:323.40ms
step:240/1480 train_time:74351ms step_avg:323.26ms
step:241/1480 train_time:74647ms step_avg:323.15ms
step:242/1480 train_time:74943ms step_avg:323.03ms
step:243/1480 train_time:75235ms step_avg:322.90ms
step:244/1480 train_time:75528ms step_avg:322.77ms
step:245/1480 train_time:75821ms step_avg:322.64ms
step:246/1480 train_time:76115ms step_avg:322.52ms
step:247/1480 train_time:76410ms step_avg:322.40ms
step:248/1480 train_time:76704ms step_avg:322.29ms
step:249/1480 train_time:76997ms step_avg:322.16ms
step:250/1480 train_time:77289ms step_avg:322.04ms
step:250/1480 val_loss:3.9875 train_time:77304ms step_avg:322.10ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | frobenius_norm = 32845.80859 | spectral_norm = 8995.68848 | median_sv = 907.30261 | l1_to_l2_norm = 143.35597
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 57.07255 | spectral_norm = 6.60075 | median_sv = 1.63680
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 53.50045 | spectral_norm = 8.84084 | median_sv = 1.49772
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 55.43972 | spectral_norm = 4.95734 | median_sv = 1.52538
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 56.87578 | spectral_norm = 4.40737 | median_sv = 1.66497
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 111.66915 | spectral_norm = 8.41626 | median_sv = 3.75867
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 59.75278 | spectral_norm = 4.71932 | median_sv = 1.97489
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 56.97527 | spectral_norm = 5.35219 | median_sv = 1.61592
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 55.35790 | spectral_norm = 6.05799 | median_sv = 1.56177
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 57.56480 | spectral_norm = 5.25891 | median_sv = 1.47459
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 61.08896 | spectral_norm = 4.26779 | median_sv = 1.79788
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 124.39375 | spectral_norm = 8.77703 | median_sv = 4.21510
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 64.77912 | spectral_norm = 5.38797 | median_sv = 2.14944
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 56.36546 | spectral_norm = 4.69834 | median_sv = 1.56406
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 56.14102 | spectral_norm = 4.68398 | median_sv = 1.56275
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 60.14687 | spectral_norm = 6.12912 | median_sv = 1.50074
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 63.92183 | spectral_norm = 4.62336 | median_sv = 1.86135
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 128.06508 | spectral_norm = 8.86774 | median_sv = 4.36444
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 65.48075 | spectral_norm = 5.43407 | median_sv = 2.18822
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 57.09328 | spectral_norm = 5.07322 | median_sv = 1.59433
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 56.43601 | spectral_norm = 5.03123 | median_sv = 1.58449
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 63.10168 | spectral_norm = 5.94449 | median_sv = 1.57985
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 63.01522 | spectral_norm = 4.34403 | median_sv = 1.88254
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 129.76448 | spectral_norm = 8.90287 | median_sv = 4.40319
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 66.09950 | spectral_norm = 5.46048 | median_sv = 2.20357
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 55.36591 | spectral_norm = 5.53514 | median_sv = 1.55764
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 54.85877 | spectral_norm = 5.35443 | median_sv = 1.55370
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 60.75197 | spectral_norm = 5.64360 | median_sv = 1.50755
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 61.56580 | spectral_norm = 4.81451 | median_sv = 1.76437
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 132.45775 | spectral_norm = 8.93565 | median_sv = 4.49368
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 66.65441 | spectral_norm = 5.32893 | median_sv = 2.22488
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 55.43654 | spectral_norm = 4.96738 | median_sv = 1.55091
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 55.69118 | spectral_norm = 4.86094 | median_sv = 1.55864
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 61.95959 | spectral_norm = 5.90068 | median_sv = 1.49968
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 62.37471 | spectral_norm = 4.69901 | median_sv = 1.79804
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 132.87933 | spectral_norm = 9.32354 | median_sv = 4.51658
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 66.27454 | spectral_norm = 5.20351 | median_sv = 2.20334
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 55.57052 | spectral_norm = 5.24112 | median_sv = 1.57279
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 55.78038 | spectral_norm = 4.92782 | median_sv = 1.58581
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 62.06169 | spectral_norm = 6.23690 | median_sv = 1.50957
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 62.13337 | spectral_norm = 4.80787 | median_sv = 1.79008
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 134.81291 | spectral_norm = 9.69339 | median_sv = 4.56011
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 66.70696 | spectral_norm = 5.25618 | median_sv = 2.20729
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 56.02106 | spectral_norm = 5.24328 | median_sv = 1.58372
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 56.26087 | spectral_norm = 4.93221 | median_sv = 1.59544
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 62.63955 | spectral_norm = 6.58444 | median_sv = 1.54327
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 62.28194 | spectral_norm = 4.58263 | median_sv = 1.84949
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 135.29494 | spectral_norm = 9.70497 | median_sv = 4.56867
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 66.48389 | spectral_norm = 5.35495 | median_sv = 2.19959
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 56.89338 | spectral_norm = 4.96540 | median_sv = 1.60279
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 57.37488 | spectral_norm = 4.86237 | median_sv = 1.61026
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 61.22141 | spectral_norm = 6.03603 | median_sv = 1.47985
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 63.10126 | spectral_norm = 4.59774 | median_sv = 1.84314
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 134.67143 | spectral_norm = 9.42167 | median_sv = 4.54434
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 66.01575 | spectral_norm = 5.47555 | median_sv = 2.18749
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 56.72721 | spectral_norm = 5.21893 | median_sv = 1.56226
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 56.66167 | spectral_norm = 5.07623 | median_sv = 1.52630
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 60.37232 | spectral_norm = 5.55423 | median_sv = 1.54940
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 67.25064 | spectral_norm = 4.62591 | median_sv = 2.00113
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 133.12704 | spectral_norm = 9.62094 | median_sv = 4.50834
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 65.40068 | spectral_norm = 5.64988 | median_sv = 2.17092
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 56.67775 | spectral_norm = 5.18782 | median_sv = 1.55029
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 55.69730 | spectral_norm = 5.32719 | median_sv = 1.48756
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 58.94977 | spectral_norm = 5.32452 | median_sv = 1.54407
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 67.91396 | spectral_norm = 4.73887 | median_sv = 1.99122
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 132.45300 | spectral_norm = 9.60157 | median_sv = 4.48803
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 64.82978 | spectral_norm = 5.75167 | median_sv = 2.15419
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 57.93104 | spectral_norm = 5.51023 | median_sv = 1.63111
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 57.12250 | spectral_norm = 5.43792 | median_sv = 1.58191
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 56.18151 | spectral_norm = 5.21895 | median_sv = 1.42945
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 65.66061 | spectral_norm = 4.78375 | median_sv = 1.86938
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 132.06535 | spectral_norm = 10.03834 | median_sv = 4.46353
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 64.33076 | spectral_norm = 5.72622 | median_sv = 2.12663
W name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 47745.52734 | spectral_norm = 4559.19336 | median_sv = 505.89758 | l1_to_l2_norm = 201.65179
W name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 558.33392 | spectral_norm = 151.38249 | median_sv = 16.23388
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | frobenius_norm = 0.00025 | spectral_norm = 0.00014 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 0.00304 | spectral_norm = 0.00189 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 0.00329 | spectral_norm = 0.00167 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 0.01162 | spectral_norm = 0.01089 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 0.02087 | spectral_norm = 0.01998 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 0.00916 | spectral_norm = 0.00780 | median_sv = 0.00008
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 0.01167 | spectral_norm = 0.00853 | median_sv = 0.00013
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 0.00586 | spectral_norm = 0.00555 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 0.00423 | spectral_norm = 0.00349 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 0.02519 | spectral_norm = 0.02478 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 0.01248 | spectral_norm = 0.01037 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 0.00807 | spectral_norm = 0.00674 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 0.00976 | spectral_norm = 0.00751 | median_sv = 0.00010
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 0.00910 | spectral_norm = 0.00835 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 0.00589 | spectral_norm = 0.00314 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 0.02398 | spectral_norm = 0.02347 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 0.01321 | spectral_norm = 0.01144 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 0.00982 | spectral_norm = 0.00846 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 0.01148 | spectral_norm = 0.00888 | median_sv = 0.00011
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 0.00372 | spectral_norm = 0.00321 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 0.00335 | spectral_norm = 0.00203 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 0.01358 | spectral_norm = 0.01336 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 0.00751 | spectral_norm = 0.00609 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 0.01055 | spectral_norm = 0.00911 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 0.01335 | spectral_norm = 0.01070 | median_sv = 0.00011
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 0.00353 | spectral_norm = 0.00308 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 0.00338 | spectral_norm = 0.00216 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 0.02102 | spectral_norm = 0.02053 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 0.00860 | spectral_norm = 0.00695 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 0.00999 | spectral_norm = 0.00842 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 0.01252 | spectral_norm = 0.01005 | median_sv = 0.00010
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 0.00407 | spectral_norm = 0.00354 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 0.00373 | spectral_norm = 0.00199 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 0.01603 | spectral_norm = 0.01565 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 0.00785 | spectral_norm = 0.00665 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 0.00890 | spectral_norm = 0.00755 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 0.01063 | spectral_norm = 0.00830 | median_sv = 0.00009
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 0.00352 | spectral_norm = 0.00310 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 0.00309 | spectral_norm = 0.00183 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 0.01269 | spectral_norm = 0.01234 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 0.00673 | spectral_norm = 0.00577 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 0.00720 | spectral_norm = 0.00604 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 0.00915 | spectral_norm = 0.00709 | median_sv = 0.00008
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 0.00352 | spectral_norm = 0.00305 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 0.00290 | spectral_norm = 0.00170 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 0.00806 | spectral_norm = 0.00784 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 0.00650 | spectral_norm = 0.00573 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 0.00706 | spectral_norm = 0.00597 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 0.00919 | spectral_norm = 0.00714 | median_sv = 0.00008
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 0.00541 | spectral_norm = 0.00494 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 0.00442 | spectral_norm = 0.00274 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 0.01015 | spectral_norm = 0.00996 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 0.01029 | spectral_norm = 0.00982 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 0.00731 | spectral_norm = 0.00632 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 0.00931 | spectral_norm = 0.00723 | median_sv = 0.00008
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 0.00774 | spectral_norm = 0.00690 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 0.00652 | spectral_norm = 0.00437 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 0.00814 | spectral_norm = 0.00800 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 0.02233 | spectral_norm = 0.02187 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 0.00913 | spectral_norm = 0.00829 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 0.01054 | spectral_norm = 0.00848 | median_sv = 0.00009
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 0.00891 | spectral_norm = 0.00810 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 0.00671 | spectral_norm = 0.00517 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 0.00714 | spectral_norm = 0.00703 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 0.02865 | spectral_norm = 0.02825 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 0.01542 | spectral_norm = 0.01461 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 0.01574 | spectral_norm = 0.01347 | median_sv = 0.00010
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 0.01096 | spectral_norm = 0.01051 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 0.00736 | spectral_norm = 0.00636 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 0.01346 | spectral_norm = 0.01331 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 0.04626 | spectral_norm = 0.04600 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 0.02513 | spectral_norm = 0.02413 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 0.03782 | spectral_norm = 0.03476 | median_sv = 0.00013
G name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 0.00033 | spectral_norm = 0.00025 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.25899 | spectral_norm = 0.25393 | median_sv = 0.00038
===========================================
step:251/1480 train_time:86840ms step_avg:360.33ms
step:252/1480 train_time:87125ms step_avg:360.02ms
step:253/1480 train_time:87416ms step_avg:359.74ms
step:254/1480 train_time:87709ms step_avg:359.46ms
step:255/1480 train_time:88001ms step_avg:359.19ms
step:256/1480 train_time:88293ms step_avg:358.91ms
step:257/1480 train_time:88586ms step_avg:358.65ms
step:258/1480 train_time:88878ms step_avg:358.38ms
step:259/1480 train_time:89172ms step_avg:358.12ms
step:260/1480 train_time:89468ms step_avg:357.87ms
step:261/1480 train_time:89760ms step_avg:357.61ms
step:262/1480 train_time:90052ms step_avg:357.35ms
step:263/1480 train_time:90346ms step_avg:357.10ms
step:264/1480 train_time:90637ms step_avg:356.84ms
step:265/1480 train_time:90935ms step_avg:356.61ms
step:266/1480 train_time:91225ms step_avg:356.35ms
step:267/1480 train_time:91517ms step_avg:356.10ms
step:268/1480 train_time:91811ms step_avg:355.86ms
step:269/1480 train_time:92103ms step_avg:355.61ms
step:270/1480 train_time:92395ms step_avg:355.37ms
step:271/1480 train_time:92689ms step_avg:355.13ms
step:272/1480 train_time:92981ms step_avg:354.89ms
step:273/1480 train_time:93274ms step_avg:354.65ms
step:274/1480 train_time:93568ms step_avg:354.42ms
step:275/1480 train_time:93860ms step_avg:354.19ms
step:276/1480 train_time:94152ms step_avg:353.96ms
step:277/1480 train_time:94446ms step_avg:353.73ms
step:278/1480 train_time:94739ms step_avg:353.50ms
step:279/1480 train_time:95032ms step_avg:353.28ms
step:280/1480 train_time:95326ms step_avg:353.06ms
step:281/1480 train_time:95619ms step_avg:352.84ms
step:282/1480 train_time:95912ms step_avg:352.62ms
step:283/1480 train_time:96205ms step_avg:352.40ms
step:284/1480 train_time:96498ms step_avg:352.18ms
step:285/1480 train_time:96791ms step_avg:351.97ms
step:286/1480 train_time:97083ms step_avg:351.75ms
step:287/1480 train_time:97375ms step_avg:351.53ms
step:288/1480 train_time:97671ms step_avg:351.34ms
step:289/1480 train_time:97961ms step_avg:351.12ms
step:290/1480 train_time:98253ms step_avg:350.90ms
step:291/1480 train_time:98547ms step_avg:350.70ms
step:292/1480 train_time:98841ms step_avg:350.50ms
step:293/1480 train_time:99133ms step_avg:350.29ms
step:294/1480 train_time:99427ms step_avg:350.09ms
step:295/1480 train_time:99719ms step_avg:349.89ms
step:296/1480 train_time:100012ms step_avg:349.69ms
step:297/1480 train_time:100306ms step_avg:349.50ms
step:298/1480 train_time:100598ms step_avg:349.30ms
step:299/1480 train_time:100892ms step_avg:349.11ms
step:300/1480 train_time:101187ms step_avg:348.92ms
step:301/1480 train_time:101478ms step_avg:348.72ms
step:302/1480 train_time:101771ms step_avg:348.53ms
step:303/1480 train_time:102065ms step_avg:348.34ms
step:304/1480 train_time:102356ms step_avg:348.15ms
step:305/1480 train_time:102651ms step_avg:347.97ms
step:306/1480 train_time:102945ms step_avg:347.79ms
step:307/1480 train_time:103238ms step_avg:347.60ms
step:308/1480 train_time:103530ms step_avg:347.42ms
step:309/1480 train_time:103825ms step_avg:347.24ms
step:310/1480 train_time:104117ms step_avg:347.06ms
step:311/1480 train_time:104411ms step_avg:346.88ms
step:312/1480 train_time:104704ms step_avg:346.70ms
step:313/1480 train_time:104996ms step_avg:346.52ms
step:314/1480 train_time:105289ms step_avg:346.35ms
step:315/1480 train_time:105583ms step_avg:346.17ms
step:316/1480 train_time:105875ms step_avg:346.00ms
step:317/1480 train_time:106171ms step_avg:345.83ms
step:318/1480 train_time:106463ms step_avg:345.66ms
step:319/1480 train_time:106754ms step_avg:345.48ms
step:320/1480 train_time:107048ms step_avg:345.31ms
step:321/1480 train_time:107343ms step_avg:345.15ms
step:322/1480 train_time:107632ms step_avg:344.97ms
step:323/1480 train_time:107924ms step_avg:344.80ms
step:324/1480 train_time:108216ms step_avg:344.64ms
step:325/1480 train_time:108510ms step_avg:344.48ms
step:326/1480 train_time:108805ms step_avg:344.32ms
step:327/1480 train_time:109098ms step_avg:344.16ms
step:328/1480 train_time:109392ms step_avg:344.00ms
step:329/1480 train_time:109687ms step_avg:343.85ms
step:330/1480 train_time:109988ms step_avg:343.71ms
step:331/1480 train_time:110289ms step_avg:343.58ms
step:332/1480 train_time:110589ms step_avg:343.44ms
step:333/1480 train_time:110889ms step_avg:343.31ms
step:334/1480 train_time:111188ms step_avg:343.17ms
step:335/1480 train_time:111489ms step_avg:343.04ms
step:336/1480 train_time:111789ms step_avg:342.91ms
step:337/1480 train_time:112091ms step_avg:342.79ms
step:338/1480 train_time:112392ms step_avg:342.66ms
step:339/1480 train_time:112695ms step_avg:342.54ms
step:340/1480 train_time:112997ms step_avg:342.41ms
step:341/1480 train_time:113297ms step_avg:342.29ms
step:342/1480 train_time:113597ms step_avg:342.16ms
step:343/1480 train_time:113899ms step_avg:342.04ms
step:344/1480 train_time:114198ms step_avg:341.91ms
step:345/1480 train_time:114500ms step_avg:341.79ms
step:346/1480 train_time:114797ms step_avg:341.66ms
step:347/1480 train_time:115098ms step_avg:341.54ms
step:348/1480 train_time:115397ms step_avg:341.41ms
step:349/1480 train_time:115697ms step_avg:341.29ms
step:350/1480 train_time:115997ms step_avg:341.17ms
step:351/1480 train_time:116297ms step_avg:341.05ms
step:352/1480 train_time:116597ms step_avg:340.93ms
step:353/1480 train_time:116897ms step_avg:340.81ms
step:354/1480 train_time:117198ms step_avg:340.69ms
step:355/1480 train_time:117498ms step_avg:340.57ms
step:356/1480 train_time:117797ms step_avg:340.45ms
step:357/1480 train_time:118097ms step_avg:340.34ms
step:358/1480 train_time:118397ms step_avg:340.22ms
step:359/1480 train_time:118698ms step_avg:340.11ms
step:360/1480 train_time:118998ms step_avg:340.00ms
step:361/1480 train_time:119298ms step_avg:339.88ms
step:362/1480 train_time:119597ms step_avg:339.77ms
step:363/1480 train_time:119897ms step_avg:339.65ms
step:364/1480 train_time:120197ms step_avg:339.54ms
step:365/1480 train_time:120497ms step_avg:339.43ms
step:366/1480 train_time:120797ms step_avg:339.32ms
step:367/1480 train_time:121096ms step_avg:339.20ms
step:368/1480 train_time:121396ms step_avg:339.10ms
step:369/1480 train_time:121697ms step_avg:338.99ms
step:370/1480 train_time:121996ms step_avg:338.88ms
step:371/1480 train_time:122299ms step_avg:338.78ms
step:372/1480 train_time:122598ms step_avg:338.67ms
step:373/1480 train_time:122897ms step_avg:338.56ms
step:374/1480 train_time:123196ms step_avg:338.45ms
step:375/1480 train_time:123496ms step_avg:338.35ms
step:375/1480 val_loss:3.8002 train_time:123512ms step_avg:338.39ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | frobenius_norm = 38226.48438 | spectral_norm = 9888.03418 | median_sv = 1061.52319 | l1_to_l2_norm = 166.36977
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 81.84837 | spectral_norm = 9.92876 | median_sv = 2.33463
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 77.92414 | spectral_norm = 13.58814 | median_sv = 2.17991
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 79.84851 | spectral_norm = 7.64316 | median_sv = 2.26985
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 80.95924 | spectral_norm = 6.52532 | median_sv = 2.35448
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 164.05168 | spectral_norm = 11.71795 | median_sv = 5.51872
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 86.52494 | spectral_norm = 7.20483 | median_sv = 2.84943
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 82.59698 | spectral_norm = 7.85262 | median_sv = 2.34476
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 80.83353 | spectral_norm = 8.84585 | median_sv = 2.27647
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 82.15529 | spectral_norm = 7.37309 | median_sv = 2.14857
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 86.83287 | spectral_norm = 6.35632 | median_sv = 2.49914
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 180.55017 | spectral_norm = 12.58507 | median_sv = 6.11330
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 93.05696 | spectral_norm = 7.98110 | median_sv = 3.07591
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 82.53628 | spectral_norm = 6.86534 | median_sv = 2.27959
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 82.02537 | spectral_norm = 6.94114 | median_sv = 2.28795
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 87.81593 | spectral_norm = 8.57699 | median_sv = 2.25792
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 92.01788 | spectral_norm = 6.62428 | median_sv = 2.69770
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 184.40286 | spectral_norm = 12.52034 | median_sv = 6.28387
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 93.15889 | spectral_norm = 7.94994 | median_sv = 3.10564
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 83.92340 | spectral_norm = 7.59387 | median_sv = 2.35693
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 82.81137 | spectral_norm = 7.39373 | median_sv = 2.33566
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 92.49264 | spectral_norm = 8.58869 | median_sv = 2.37771
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 90.88747 | spectral_norm = 6.47599 | median_sv = 2.71729
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 186.29868 | spectral_norm = 13.12399 | median_sv = 6.31815
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 93.27925 | spectral_norm = 7.76855 | median_sv = 3.08693
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 81.29516 | spectral_norm = 8.11377 | median_sv = 2.28986
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 80.08381 | spectral_norm = 7.99129 | median_sv = 2.27074
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 88.73351 | spectral_norm = 7.91268 | median_sv = 2.32661
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 88.87157 | spectral_norm = 6.88561 | median_sv = 2.53001
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 190.47479 | spectral_norm = 12.88083 | median_sv = 6.47570
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 94.29968 | spectral_norm = 7.62555 | median_sv = 3.12770
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 81.17734 | spectral_norm = 7.34385 | median_sv = 2.26095
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 81.15974 | spectral_norm = 7.30811 | median_sv = 2.25311
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 91.06426 | spectral_norm = 8.33047 | median_sv = 2.32026
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 90.50784 | spectral_norm = 6.98550 | median_sv = 2.61893
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 191.29713 | spectral_norm = 13.46337 | median_sv = 6.52912
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 93.72404 | spectral_norm = 7.51555 | median_sv = 3.09188
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 81.63651 | spectral_norm = 7.81250 | median_sv = 2.30570
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 81.28809 | spectral_norm = 7.39675 | median_sv = 2.31549
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 91.00201 | spectral_norm = 8.38777 | median_sv = 2.34926
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 89.83056 | spectral_norm = 6.85287 | median_sv = 2.58760
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 192.29688 | spectral_norm = 14.20401 | median_sv = 6.53716
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 94.54795 | spectral_norm = 7.58750 | median_sv = 3.11663
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 82.71702 | spectral_norm = 7.84519 | median_sv = 2.33878
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 82.47668 | spectral_norm = 7.34951 | median_sv = 2.34477
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 93.22581 | spectral_norm = 9.42558 | median_sv = 2.40669
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 91.03275 | spectral_norm = 6.56215 | median_sv = 2.73103
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 192.96500 | spectral_norm = 14.38599 | median_sv = 6.53796
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 94.45882 | spectral_norm = 7.95526 | median_sv = 3.11616
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 83.78753 | spectral_norm = 7.36493 | median_sv = 2.35404
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 83.95702 | spectral_norm = 7.20424 | median_sv = 2.34809
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 91.65368 | spectral_norm = 8.46630 | median_sv = 2.31038
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 91.66660 | spectral_norm = 6.46772 | median_sv = 2.71278
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 192.99501 | spectral_norm = 13.80210 | median_sv = 6.54927
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 94.29562 | spectral_norm = 8.29909 | median_sv = 3.13306
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 84.00936 | spectral_norm = 7.99858 | median_sv = 2.29112
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 83.76492 | spectral_norm = 7.55225 | median_sv = 2.23125
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 90.85309 | spectral_norm = 8.00027 | median_sv = 2.41031
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 95.54408 | spectral_norm = 6.49473 | median_sv = 2.86226
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 191.28421 | spectral_norm = 13.73448 | median_sv = 6.49171
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 93.69012 | spectral_norm = 8.54007 | median_sv = 3.12682
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 84.14986 | spectral_norm = 7.93972 | median_sv = 2.28212
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 82.34787 | spectral_norm = 8.12599 | median_sv = 2.18135
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 87.88066 | spectral_norm = 8.17258 | median_sv = 2.37804
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 96.77533 | spectral_norm = 6.69969 | median_sv = 2.84526
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 192.31560 | spectral_norm = 13.49297 | median_sv = 6.55992
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 91.45757 | spectral_norm = 8.96204 | median_sv = 3.04116
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 85.74140 | spectral_norm = 8.47453 | median_sv = 2.40291
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 84.11201 | spectral_norm = 8.19510 | median_sv = 2.33768
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 83.14561 | spectral_norm = 8.10668 | median_sv = 2.20409
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 96.12119 | spectral_norm = 6.87428 | median_sv = 2.76912
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 194.57690 | spectral_norm = 14.96975 | median_sv = 6.62554
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 92.75268 | spectral_norm = 9.12293 | median_sv = 3.06612
W name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 57247.12500 | spectral_norm = 5066.85938 | median_sv = 619.43536 | l1_to_l2_norm = 241.65625
W name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 702.61975 | spectral_norm = 161.94292 | median_sv = 20.92047
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | frobenius_norm = 0.00017 | spectral_norm = 0.00009 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 0.00177 | spectral_norm = 0.00108 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 0.00186 | spectral_norm = 0.00086 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 0.00668 | spectral_norm = 0.00621 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 0.01293 | spectral_norm = 0.01246 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 0.00646 | spectral_norm = 0.00578 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 0.00687 | spectral_norm = 0.00459 | median_sv = 0.00009
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 0.00239 | spectral_norm = 0.00206 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 0.00216 | spectral_norm = 0.00150 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 0.01458 | spectral_norm = 0.01435 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 0.00722 | spectral_norm = 0.00613 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 0.00455 | spectral_norm = 0.00378 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 0.00483 | spectral_norm = 0.00314 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 0.00375 | spectral_norm = 0.00323 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 0.00304 | spectral_norm = 0.00185 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 0.01343 | spectral_norm = 0.01315 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 0.00778 | spectral_norm = 0.00681 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 0.00589 | spectral_norm = 0.00503 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 0.00656 | spectral_norm = 0.00427 | median_sv = 0.00009
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 0.00256 | spectral_norm = 0.00230 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 0.00212 | spectral_norm = 0.00148 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 0.00922 | spectral_norm = 0.00906 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 0.00428 | spectral_norm = 0.00337 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 0.00680 | spectral_norm = 0.00586 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 0.00798 | spectral_norm = 0.00562 | median_sv = 0.00009
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 0.00174 | spectral_norm = 0.00141 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 0.00168 | spectral_norm = 0.00096 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 0.01158 | spectral_norm = 0.01127 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 0.00515 | spectral_norm = 0.00414 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 0.00659 | spectral_norm = 0.00559 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 0.00757 | spectral_norm = 0.00553 | median_sv = 0.00008
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 0.00224 | spectral_norm = 0.00181 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 0.00237 | spectral_norm = 0.00128 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 0.01090 | spectral_norm = 0.01061 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 0.00582 | spectral_norm = 0.00505 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 0.00633 | spectral_norm = 0.00544 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 0.00691 | spectral_norm = 0.00503 | median_sv = 0.00008
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 0.00193 | spectral_norm = 0.00160 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 0.00172 | spectral_norm = 0.00101 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 0.00959 | spectral_norm = 0.00929 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 0.00505 | spectral_norm = 0.00429 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 0.00528 | spectral_norm = 0.00442 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 0.00591 | spectral_norm = 0.00401 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 0.00291 | spectral_norm = 0.00264 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 0.00218 | spectral_norm = 0.00134 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 0.00634 | spectral_norm = 0.00615 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 0.00483 | spectral_norm = 0.00424 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 0.00522 | spectral_norm = 0.00436 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 0.00599 | spectral_norm = 0.00410 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 0.00344 | spectral_norm = 0.00304 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 0.00337 | spectral_norm = 0.00215 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 0.00939 | spectral_norm = 0.00922 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 0.00852 | spectral_norm = 0.00822 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 0.00597 | spectral_norm = 0.00523 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 0.00657 | spectral_norm = 0.00452 | median_sv = 0.00008
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 0.00516 | spectral_norm = 0.00475 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 0.00449 | spectral_norm = 0.00300 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 0.00586 | spectral_norm = 0.00574 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 0.01681 | spectral_norm = 0.01653 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 0.00709 | spectral_norm = 0.00649 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 0.00657 | spectral_norm = 0.00461 | median_sv = 0.00008
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 0.00679 | spectral_norm = 0.00645 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 0.00516 | spectral_norm = 0.00428 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 0.00553 | spectral_norm = 0.00545 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 0.02160 | spectral_norm = 0.02136 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 0.01502 | spectral_norm = 0.01453 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 0.01043 | spectral_norm = 0.00812 | median_sv = 0.00009
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 0.01087 | spectral_norm = 0.01065 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 0.00565 | spectral_norm = 0.00496 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 0.00933 | spectral_norm = 0.00924 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 0.03186 | spectral_norm = 0.03162 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 0.02171 | spectral_norm = 0.02102 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 0.02275 | spectral_norm = 0.01952 | median_sv = 0.00011
G name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 0.00029 | spectral_norm = 0.00023 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.22590 | spectral_norm = 0.22123 | median_sv = 0.00031
===========================================
step:376/1480 train_time:133088ms step_avg:363.63ms
step:377/1480 train_time:133375ms step_avg:363.42ms
step:378/1480 train_time:133677ms step_avg:363.25ms
step:379/1480 train_time:133976ms step_avg:363.08ms
step:380/1480 train_time:134276ms step_avg:362.91ms
step:381/1480 train_time:134577ms step_avg:362.74ms
step:382/1480 train_time:134878ms step_avg:362.57ms
step:383/1480 train_time:135178ms step_avg:362.41ms
step:384/1480 train_time:135478ms step_avg:362.24ms
step:385/1480 train_time:135778ms step_avg:362.07ms
step:386/1480 train_time:136077ms step_avg:361.91ms
step:387/1480 train_time:136378ms step_avg:361.75ms
step:388/1480 train_time:136680ms step_avg:361.59ms
step:389/1480 train_time:136979ms step_avg:361.42ms
step:390/1480 train_time:137279ms step_avg:361.26ms
step:391/1480 train_time:137580ms step_avg:361.10ms
step:392/1480 train_time:137881ms step_avg:360.95ms
step:393/1480 train_time:138180ms step_avg:360.78ms
step:394/1480 train_time:138480ms step_avg:360.62ms
step:395/1480 train_time:138780ms step_avg:360.47ms
step:396/1480 train_time:139079ms step_avg:360.31ms
step:397/1480 train_time:139381ms step_avg:360.16ms
step:398/1480 train_time:139681ms step_avg:360.00ms
step:399/1480 train_time:139982ms step_avg:359.85ms
step:400/1480 train_time:140281ms step_avg:359.69ms
step:401/1480 train_time:140580ms step_avg:359.54ms
step:402/1480 train_time:140880ms step_avg:359.39ms
step:403/1480 train_time:141180ms step_avg:359.24ms
step:404/1480 train_time:141482ms step_avg:359.09ms
step:405/1480 train_time:141782ms step_avg:358.94ms
step:406/1480 train_time:142082ms step_avg:358.79ms
step:407/1480 train_time:142381ms step_avg:358.64ms
step:408/1480 train_time:142681ms step_avg:358.50ms
step:409/1480 train_time:142981ms step_avg:358.35ms
step:410/1480 train_time:143280ms step_avg:358.20ms
step:411/1480 train_time:143579ms step_avg:358.05ms
step:412/1480 train_time:143879ms step_avg:357.91ms
step:413/1480 train_time:144180ms step_avg:357.77ms
step:414/1480 train_time:144481ms step_avg:357.63ms
step:415/1480 train_time:144781ms step_avg:357.48ms
step:416/1480 train_time:145081ms step_avg:357.34ms
step:417/1480 train_time:145380ms step_avg:357.20ms
step:418/1480 train_time:145681ms step_avg:357.06ms
step:419/1480 train_time:145981ms step_avg:356.92ms
step:420/1480 train_time:146280ms step_avg:356.78ms
step:421/1480 train_time:146581ms step_avg:356.64ms
step:422/1480 train_time:146881ms step_avg:356.51ms
step:423/1480 train_time:147181ms step_avg:356.37ms
step:424/1480 train_time:147480ms step_avg:356.23ms
step:425/1480 train_time:147780ms step_avg:356.10ms
step:426/1480 train_time:148081ms step_avg:355.96ms
step:427/1480 train_time:148382ms step_avg:355.83ms
step:428/1480 train_time:148682ms step_avg:355.70ms
step:429/1480 train_time:148981ms step_avg:355.56ms
step:430/1480 train_time:149281ms step_avg:355.43ms
step:431/1480 train_time:149580ms step_avg:355.30ms
step:432/1480 train_time:149880ms step_avg:355.17ms
step:433/1480 train_time:150180ms step_avg:355.04ms
step:434/1480 train_time:150480ms step_avg:354.91ms
step:435/1480 train_time:150781ms step_avg:354.78ms
step:436/1480 train_time:151080ms step_avg:354.65ms
step:437/1480 train_time:151380ms step_avg:354.52ms
step:438/1480 train_time:151679ms step_avg:354.39ms
step:439/1480 train_time:151979ms step_avg:354.26ms
step:440/1480 train_time:152286ms step_avg:354.15ms
step:441/1480 train_time:152591ms step_avg:354.04ms
step:442/1480 train_time:152899ms step_avg:353.93ms
step:443/1480 train_time:153204ms step_avg:353.82ms
step:444/1480 train_time:153509ms step_avg:353.71ms
step:445/1480 train_time:153815ms step_avg:353.60ms
step:446/1480 train_time:154120ms step_avg:353.49ms
step:447/1480 train_time:154424ms step_avg:353.37ms
step:448/1480 train_time:154731ms step_avg:353.27ms
step:449/1480 train_time:155037ms step_avg:353.16ms
step:450/1480 train_time:155342ms step_avg:353.05ms
step:451/1480 train_time:155650ms step_avg:352.95ms
step:452/1480 train_time:155957ms step_avg:352.84ms
step:453/1480 train_time:156262ms step_avg:352.74ms
step:454/1480 train_time:156569ms step_avg:352.63ms
step:455/1480 train_time:156876ms step_avg:352.53ms
step:456/1480 train_time:157182ms step_avg:352.43ms
step:457/1480 train_time:157488ms step_avg:352.32ms
step:458/1480 train_time:157793ms step_avg:352.22ms
step:459/1480 train_time:158098ms step_avg:352.11ms
step:460/1480 train_time:158405ms step_avg:352.01ms
step:461/1480 train_time:158712ms step_avg:351.91ms
step:462/1480 train_time:159021ms step_avg:351.82ms
step:463/1480 train_time:159325ms step_avg:351.71ms
step:464/1480 train_time:159630ms step_avg:351.61ms
step:465/1480 train_time:159937ms step_avg:351.51ms
step:466/1480 train_time:160242ms step_avg:351.41ms
step:467/1480 train_time:160547ms step_avg:351.31ms
step:468/1480 train_time:160852ms step_avg:351.21ms
step:469/1480 train_time:161158ms step_avg:351.11ms
step:470/1480 train_time:161462ms step_avg:351.01ms
step:471/1480 train_time:161771ms step_avg:350.91ms
step:472/1480 train_time:162078ms step_avg:350.82ms
step:473/1480 train_time:162382ms step_avg:350.72ms
step:474/1480 train_time:162687ms step_avg:350.62ms
step:475/1480 train_time:162992ms step_avg:350.52ms
step:476/1480 train_time:163297ms step_avg:350.42ms
step:477/1480 train_time:163604ms step_avg:350.33ms
step:478/1480 train_time:163909ms step_avg:350.23ms
step:479/1480 train_time:164214ms step_avg:350.14ms
step:480/1480 train_time:164521ms step_avg:350.04ms
step:481/1480 train_time:164826ms step_avg:349.95ms
step:482/1480 train_time:165131ms step_avg:349.85ms
step:483/1480 train_time:165437ms step_avg:349.76ms
step:484/1480 train_time:165743ms step_avg:349.67ms
step:485/1480 train_time:166048ms step_avg:349.57ms
step:486/1480 train_time:166353ms step_avg:349.48ms
step:487/1480 train_time:166659ms step_avg:349.39ms
step:488/1480 train_time:166967ms step_avg:349.30ms
step:489/1480 train_time:167271ms step_avg:349.21ms
step:490/1480 train_time:167578ms step_avg:349.12ms
step:491/1480 train_time:167885ms step_avg:349.03ms
step:492/1480 train_time:168191ms step_avg:348.94ms
step:493/1480 train_time:168497ms step_avg:348.86ms
step:494/1480 train_time:168804ms step_avg:348.77ms
step:495/1480 train_time:169110ms step_avg:348.68ms
step:496/1480 train_time:169420ms step_avg:348.60ms
step:497/1480 train_time:169725ms step_avg:348.51ms
step:498/1480 train_time:170029ms step_avg:348.42ms
step:499/1480 train_time:170335ms step_avg:348.33ms
step:500/1480 train_time:170641ms step_avg:348.25ms
step:500/1480 val_loss:3.6791 train_time:170655ms step_avg:348.28ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | frobenius_norm = 42366.91406 | spectral_norm = 10605.92188 | median_sv = 1179.49963 | l1_to_l2_norm = 183.97678
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 101.73516 | spectral_norm = 13.24282 | median_sv = 2.85743
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 97.00280 | spectral_norm = 17.93477 | median_sv = 2.65871
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 98.56339 | spectral_norm = 9.93223 | median_sv = 2.79274
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 99.81556 | spectral_norm = 8.22867 | median_sv = 2.86144
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 206.60684 | spectral_norm = 14.92108 | median_sv = 6.93734
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 108.27093 | spectral_norm = 9.47947 | median_sv = 3.55526
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 102.80968 | spectral_norm = 9.97873 | median_sv = 2.88791
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 101.04673 | spectral_norm = 11.15773 | median_sv = 2.80086
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 102.07876 | spectral_norm = 9.37370 | median_sv = 2.67757
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 107.75900 | spectral_norm = 8.17282 | median_sv = 3.05662
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 226.12433 | spectral_norm = 16.10604 | median_sv = 7.62848
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 116.46751 | spectral_norm = 10.50520 | median_sv = 3.82814
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 103.02094 | spectral_norm = 8.81005 | median_sv = 2.79033
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 102.24277 | spectral_norm = 8.81250 | median_sv = 2.80610
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 110.53274 | spectral_norm = 10.78363 | median_sv = 2.85257
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 115.08365 | spectral_norm = 8.18136 | median_sv = 3.38592
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 230.18565 | spectral_norm = 16.04239 | median_sv = 7.83616
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 116.38266 | spectral_norm = 10.18101 | median_sv = 3.87501
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 105.21415 | spectral_norm = 9.68966 | median_sv = 2.91324
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 103.64307 | spectral_norm = 9.37175 | median_sv = 2.88584
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 116.36413 | spectral_norm = 11.04184 | median_sv = 3.02805
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 113.73071 | spectral_norm = 8.23575 | median_sv = 3.40267
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 233.09271 | spectral_norm = 17.26482 | median_sv = 7.91547
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 116.05212 | spectral_norm = 9.75651 | median_sv = 3.82997
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 101.70280 | spectral_norm = 10.48397 | median_sv = 2.83333
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 99.85320 | spectral_norm = 10.30673 | median_sv = 2.77854
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 111.48412 | spectral_norm = 9.89573 | median_sv = 2.96503
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 111.37574 | spectral_norm = 8.62784 | median_sv = 3.17455
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 237.90680 | spectral_norm = 16.44960 | median_sv = 8.08837
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 117.40366 | spectral_norm = 9.75043 | median_sv = 3.87093
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 101.39538 | spectral_norm = 9.52700 | median_sv = 2.76934
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 101.23353 | spectral_norm = 9.39056 | median_sv = 2.76352
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 114.93867 | spectral_norm = 10.24580 | median_sv = 2.96478
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 113.56929 | spectral_norm = 8.70671 | median_sv = 3.28084
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 239.01347 | spectral_norm = 16.97967 | median_sv = 8.15485
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 116.60257 | spectral_norm = 9.45619 | median_sv = 3.84259
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 101.81305 | spectral_norm = 10.05299 | median_sv = 2.83641
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 100.93938 | spectral_norm = 9.56966 | median_sv = 2.84995
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 114.45558 | spectral_norm = 10.15147 | median_sv = 3.00855
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 112.17367 | spectral_norm = 8.65427 | median_sv = 3.20805
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 239.04559 | spectral_norm = 17.77468 | median_sv = 8.11729
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 117.86139 | spectral_norm = 9.53931 | median_sv = 3.88547
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 103.77596 | spectral_norm = 9.84267 | median_sv = 2.89341
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 102.96232 | spectral_norm = 9.30892 | median_sv = 2.87947
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 117.85639 | spectral_norm = 11.64415 | median_sv = 3.05527
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 114.67758 | spectral_norm = 8.58412 | median_sv = 3.45243
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 239.75258 | spectral_norm = 18.36588 | median_sv = 8.11627
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 117.99583 | spectral_norm = 10.08137 | median_sv = 3.89355
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 104.96051 | spectral_norm = 9.49942 | median_sv = 2.90831
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 104.72310 | spectral_norm = 9.19216 | median_sv = 2.87820
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 116.53817 | spectral_norm = 10.47890 | median_sv = 2.93934
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 115.31156 | spectral_norm = 8.10722 | median_sv = 3.42248
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 240.26646 | spectral_norm = 17.68242 | median_sv = 8.15889
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 118.12923 | spectral_norm = 10.66638 | median_sv = 3.92235
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 105.39263 | spectral_norm = 10.47357 | median_sv = 2.82774
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 105.25719 | spectral_norm = 9.75586 | median_sv = 2.73843
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 115.99938 | spectral_norm = 10.23933 | median_sv = 3.08334
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 118.43537 | spectral_norm = 8.05614 | median_sv = 3.56017
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 238.17543 | spectral_norm = 17.55155 | median_sv = 8.09523
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 117.71587 | spectral_norm = 11.13935 | median_sv = 3.93354
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 105.38394 | spectral_norm = 10.63822 | median_sv = 2.75421
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 103.28013 | spectral_norm = 10.69415 | median_sv = 2.63662
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 111.19887 | spectral_norm = 10.60709 | median_sv = 3.03035
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 119.62864 | spectral_norm = 8.31757 | median_sv = 3.50729
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 241.30978 | spectral_norm = 16.99638 | median_sv = 8.28389
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 113.39005 | spectral_norm = 11.99012 | median_sv = 3.77934
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 107.22124 | spectral_norm = 11.24603 | median_sv = 2.95358
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 104.79211 | spectral_norm = 10.80516 | median_sv = 2.84320
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 105.53776 | spectral_norm = 10.68478 | median_sv = 2.81654
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 121.43243 | spectral_norm = 8.69285 | median_sv = 3.53850
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 245.52795 | spectral_norm = 19.84753 | median_sv = 8.35803
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 115.81120 | spectral_norm = 12.46562 | median_sv = 3.82665
W name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 64569.74609 | spectral_norm = 5399.32275 | median_sv = 707.71332 | l1_to_l2_norm = 272.35724
W name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 824.84082 | spectral_norm = 168.57602 | median_sv = 24.94526
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | frobenius_norm = 0.00014 | spectral_norm = 0.00006 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 0.00125 | spectral_norm = 0.00059 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 0.00134 | spectral_norm = 0.00066 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 0.00445 | spectral_norm = 0.00408 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 0.00956 | spectral_norm = 0.00920 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 0.00580 | spectral_norm = 0.00529 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 0.00495 | spectral_norm = 0.00300 | median_sv = 0.00008
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 0.00145 | spectral_norm = 0.00116 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 0.00136 | spectral_norm = 0.00085 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 0.01147 | spectral_norm = 0.01130 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 0.00567 | spectral_norm = 0.00478 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 0.00409 | spectral_norm = 0.00350 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 0.00367 | spectral_norm = 0.00219 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 0.00261 | spectral_norm = 0.00221 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 0.00235 | spectral_norm = 0.00140 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 0.01091 | spectral_norm = 0.01070 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 0.00603 | spectral_norm = 0.00528 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 0.00498 | spectral_norm = 0.00431 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 0.00503 | spectral_norm = 0.00311 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 0.00199 | spectral_norm = 0.00173 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 0.00162 | spectral_norm = 0.00098 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 0.00822 | spectral_norm = 0.00809 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 0.00354 | spectral_norm = 0.00281 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 0.00574 | spectral_norm = 0.00501 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 0.00654 | spectral_norm = 0.00454 | median_sv = 0.00008
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 0.00129 | spectral_norm = 0.00101 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 0.00122 | spectral_norm = 0.00066 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 0.01004 | spectral_norm = 0.00977 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 0.00453 | spectral_norm = 0.00365 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 0.00601 | spectral_norm = 0.00524 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 0.00642 | spectral_norm = 0.00471 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 0.00210 | spectral_norm = 0.00169 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 0.00212 | spectral_norm = 0.00118 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 0.00974 | spectral_norm = 0.00948 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 0.00496 | spectral_norm = 0.00430 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 0.00569 | spectral_norm = 0.00494 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 0.00583 | spectral_norm = 0.00413 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 0.00191 | spectral_norm = 0.00167 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 0.00150 | spectral_norm = 0.00083 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 0.00845 | spectral_norm = 0.00817 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 0.00441 | spectral_norm = 0.00375 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 0.00431 | spectral_norm = 0.00359 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 0.00478 | spectral_norm = 0.00301 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 0.00215 | spectral_norm = 0.00196 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 0.00164 | spectral_norm = 0.00108 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 0.00571 | spectral_norm = 0.00554 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 0.00407 | spectral_norm = 0.00358 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 0.00411 | spectral_norm = 0.00341 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 0.00467 | spectral_norm = 0.00293 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 0.00329 | spectral_norm = 0.00297 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 0.00326 | spectral_norm = 0.00197 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 0.00826 | spectral_norm = 0.00807 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 0.00754 | spectral_norm = 0.00725 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 0.00481 | spectral_norm = 0.00421 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 0.00495 | spectral_norm = 0.00315 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 0.00519 | spectral_norm = 0.00488 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 0.00435 | spectral_norm = 0.00330 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 0.00479 | spectral_norm = 0.00469 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 0.01507 | spectral_norm = 0.01475 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 0.00568 | spectral_norm = 0.00516 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 0.00565 | spectral_norm = 0.00409 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 0.00471 | spectral_norm = 0.00436 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 0.00344 | spectral_norm = 0.00269 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 0.00438 | spectral_norm = 0.00431 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 0.01981 | spectral_norm = 0.01953 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 0.01152 | spectral_norm = 0.01106 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 0.00939 | spectral_norm = 0.00743 | median_sv = 0.00008
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 0.00669 | spectral_norm = 0.00653 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 0.00354 | spectral_norm = 0.00305 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 0.00703 | spectral_norm = 0.00694 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 0.02667 | spectral_norm = 0.02638 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 0.02428 | spectral_norm = 0.02376 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 0.02393 | spectral_norm = 0.02138 | median_sv = 0.00010
G name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 0.00025 | spectral_norm = 0.00018 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.22911 | spectral_norm = 0.22474 | median_sv = 0.00027
===========================================
step:501/1480 train_time:180222ms step_avg:367.05ms
step:502/1480 train_time:180510ms step_avg:366.89ms
step:503/1480 train_time:180814ms step_avg:366.76ms
step:504/1480 train_time:181118ms step_avg:366.64ms
step:505/1480 train_time:181424ms step_avg:366.51ms
step:506/1480 train_time:181730ms step_avg:366.39ms
step:507/1480 train_time:182035ms step_avg:366.27ms
step:508/1480 train_time:182340ms step_avg:366.15ms
step:509/1480 train_time:182647ms step_avg:366.03ms
step:510/1480 train_time:182951ms step_avg:365.90ms
step:511/1480 train_time:183258ms step_avg:365.78ms
step:512/1480 train_time:183561ms step_avg:365.66ms
step:513/1480 train_time:183869ms step_avg:365.54ms
step:514/1480 train_time:184175ms step_avg:365.43ms
step:515/1480 train_time:184481ms step_avg:365.31ms
step:516/1480 train_time:184787ms step_avg:365.19ms
step:517/1480 train_time:185094ms step_avg:365.08ms
step:518/1480 train_time:185397ms step_avg:364.95ms
step:519/1480 train_time:185702ms step_avg:364.84ms
step:520/1480 train_time:186009ms step_avg:364.72ms
step:521/1480 train_time:186314ms step_avg:364.61ms
step:522/1480 train_time:186620ms step_avg:364.49ms
step:523/1480 train_time:186925ms step_avg:364.38ms
step:524/1480 train_time:187234ms step_avg:364.27ms
step:525/1480 train_time:187538ms step_avg:364.15ms
step:526/1480 train_time:187844ms step_avg:364.04ms
step:527/1480 train_time:188149ms step_avg:363.93ms
step:528/1480 train_time:188454ms step_avg:363.81ms
step:529/1480 train_time:188759ms step_avg:363.70ms
step:530/1480 train_time:189064ms step_avg:363.59ms
step:531/1480 train_time:189371ms step_avg:363.48ms
step:532/1480 train_time:189678ms step_avg:363.37ms
step:533/1480 train_time:189984ms step_avg:363.26ms
step:534/1480 train_time:190289ms step_avg:363.15ms
step:535/1480 train_time:190596ms step_avg:363.04ms
step:536/1480 train_time:190901ms step_avg:362.93ms
step:537/1480 train_time:191207ms step_avg:362.82ms
step:538/1480 train_time:191513ms step_avg:362.71ms
step:539/1480 train_time:191818ms step_avg:362.61ms
step:540/1480 train_time:192127ms step_avg:362.50ms
step:541/1480 train_time:192432ms step_avg:362.40ms
step:542/1480 train_time:192737ms step_avg:362.29ms
step:543/1480 train_time:193042ms step_avg:362.18ms
step:544/1480 train_time:193348ms step_avg:362.07ms
step:545/1480 train_time:193653ms step_avg:361.97ms
step:546/1480 train_time:193959ms step_avg:361.86ms
step:547/1480 train_time:194266ms step_avg:361.76ms
step:548/1480 train_time:194573ms step_avg:361.66ms
step:549/1480 train_time:194880ms step_avg:361.56ms
step:550/1480 train_time:195190ms step_avg:361.46ms
step:551/1480 train_time:195502ms step_avg:361.37ms
step:552/1480 train_time:195812ms step_avg:361.28ms
step:553/1480 train_time:196124ms step_avg:361.19ms
step:554/1480 train_time:196436ms step_avg:361.10ms
step:555/1480 train_time:196745ms step_avg:361.00ms
step:556/1480 train_time:197055ms step_avg:360.91ms
step:557/1480 train_time:197364ms step_avg:360.81ms
step:558/1480 train_time:197675ms step_avg:360.72ms
step:559/1480 train_time:197984ms step_avg:360.63ms
step:560/1480 train_time:198296ms step_avg:360.54ms
step:561/1480 train_time:198605ms step_avg:360.44ms
step:562/1480 train_time:198914ms step_avg:360.35ms
step:563/1480 train_time:199226ms step_avg:360.26ms
step:564/1480 train_time:199535ms step_avg:360.17ms
step:565/1480 train_time:199848ms step_avg:360.09ms
step:566/1480 train_time:200159ms step_avg:360.00ms
step:567/1480 train_time:200471ms step_avg:359.91ms
step:568/1480 train_time:200781ms step_avg:359.82ms
step:569/1480 train_time:201091ms step_avg:359.73ms
step:570/1480 train_time:201400ms step_avg:359.64ms
step:571/1480 train_time:201713ms step_avg:359.56ms
step:572/1480 train_time:202023ms step_avg:359.47ms
step:573/1480 train_time:202335ms step_avg:359.39ms
step:574/1480 train_time:202647ms step_avg:359.30ms
step:575/1480 train_time:202963ms step_avg:359.23ms
step:576/1480 train_time:203274ms step_avg:359.14ms
step:577/1480 train_time:203585ms step_avg:359.06ms
step:578/1480 train_time:203896ms step_avg:358.97ms
step:579/1480 train_time:204210ms step_avg:358.89ms
step:580/1480 train_time:204519ms step_avg:358.81ms
step:581/1480 train_time:204830ms step_avg:358.72ms
step:582/1480 train_time:205140ms step_avg:358.64ms
step:583/1480 train_time:205453ms step_avg:358.56ms
step:584/1480 train_time:205762ms step_avg:358.47ms
step:585/1480 train_time:206075ms step_avg:358.39ms
step:586/1480 train_time:206386ms step_avg:358.31ms
step:587/1480 train_time:206697ms step_avg:358.23ms
step:588/1480 train_time:207006ms step_avg:358.14ms
step:589/1480 train_time:207317ms step_avg:358.06ms
step:590/1480 train_time:207629ms step_avg:357.98ms
step:591/1480 train_time:207940ms step_avg:357.90ms
step:592/1480 train_time:208250ms step_avg:357.82ms
step:593/1480 train_time:208561ms step_avg:357.74ms
step:594/1480 train_time:208873ms step_avg:357.66ms
step:595/1480 train_time:209187ms step_avg:357.58ms
step:596/1480 train_time:209499ms step_avg:357.51ms
step:597/1480 train_time:209811ms step_avg:357.43ms
step:598/1480 train_time:210120ms step_avg:357.35ms
step:599/1480 train_time:210434ms step_avg:357.27ms
step:600/1480 train_time:210744ms step_avg:357.19ms
step:601/1480 train_time:211058ms step_avg:357.12ms
step:602/1480 train_time:211368ms step_avg:357.04ms
step:603/1480 train_time:211680ms step_avg:356.96ms
step:604/1480 train_time:211993ms step_avg:356.89ms
step:605/1480 train_time:212303ms step_avg:356.81ms
step:606/1480 train_time:212617ms step_avg:356.74ms
step:607/1480 train_time:212930ms step_avg:356.67ms
step:608/1480 train_time:213241ms step_avg:356.59ms
step:609/1480 train_time:213552ms step_avg:356.51ms
step:610/1480 train_time:213861ms step_avg:356.44ms
step:611/1480 train_time:214173ms step_avg:356.36ms
step:612/1480 train_time:214484ms step_avg:356.29ms
step:613/1480 train_time:214795ms step_avg:356.21ms
step:614/1480 train_time:215109ms step_avg:356.14ms
step:615/1480 train_time:215418ms step_avg:356.06ms
step:616/1480 train_time:215728ms step_avg:355.99ms
step:617/1480 train_time:216040ms step_avg:355.91ms
step:618/1480 train_time:216353ms step_avg:355.84ms
step:619/1480 train_time:216662ms step_avg:355.77ms
step:620/1480 train_time:216975ms step_avg:355.70ms
step:621/1480 train_time:217287ms step_avg:355.63ms
step:622/1480 train_time:217598ms step_avg:355.55ms
step:623/1480 train_time:217915ms step_avg:355.49ms
step:624/1480 train_time:218227ms step_avg:355.42ms
step:625/1480 train_time:218539ms step_avg:355.35ms
step:625/1480 val_loss:3.5992 train_time:218555ms step_avg:355.37ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | frobenius_norm = 45773.91016 | spectral_norm = 11189.80664 | median_sv = 1277.30713 | l1_to_l2_norm = 198.41025
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 118.14261 | spectral_norm = 16.35566 | median_sv = 3.29664
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 112.60452 | spectral_norm = 21.70602 | median_sv = 3.05673
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 113.59064 | spectral_norm = 11.79722 | median_sv = 3.22612
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 115.09181 | spectral_norm = 9.68562 | median_sv = 3.29250
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 242.17384 | spectral_norm = 17.57782 | median_sv = 8.12147
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 126.24957 | spectral_norm = 11.46971 | median_sv = 4.13396
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 119.41158 | spectral_norm = 11.93769 | median_sv = 3.29938
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 117.48738 | spectral_norm = 13.12088 | median_sv = 3.21303
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 118.34710 | spectral_norm = 11.07075 | median_sv = 3.11151
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 125.14134 | spectral_norm = 9.71166 | median_sv = 3.54049
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 263.61356 | spectral_norm = 19.32594 | median_sv = 8.88369
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 135.97946 | spectral_norm = 12.72808 | median_sv = 4.45503
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 119.63354 | spectral_norm = 10.35239 | median_sv = 3.19816
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 118.51726 | spectral_norm = 10.38335 | median_sv = 3.21765
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 129.61234 | spectral_norm = 12.60950 | median_sv = 3.34613
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 134.17871 | spectral_norm = 9.43430 | median_sv = 3.95023
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 267.88403 | spectral_norm = 19.32213 | median_sv = 9.11608
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 135.71771 | spectral_norm = 12.21274 | median_sv = 4.51183
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 122.68417 | spectral_norm = 11.49399 | median_sv = 3.35481
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 120.63256 | spectral_norm = 10.90860 | median_sv = 3.34371
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 136.22220 | spectral_norm = 12.95781 | median_sv = 3.55737
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 132.75070 | spectral_norm = 9.56399 | median_sv = 3.94787
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 271.81308 | spectral_norm = 20.87922 | median_sv = 9.19872
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 135.15674 | spectral_norm = 11.36566 | median_sv = 4.45234
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 118.21550 | spectral_norm = 12.60731 | median_sv = 3.24182
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 116.09772 | spectral_norm = 12.28467 | median_sv = 3.21555
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 130.41496 | spectral_norm = 11.47773 | median_sv = 3.47230
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 130.13881 | spectral_norm = 10.10587 | median_sv = 3.70873
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 277.63168 | spectral_norm = 19.47353 | median_sv = 9.41598
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 136.91200 | spectral_norm = 11.72362 | median_sv = 4.50930
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 117.66621 | spectral_norm = 11.26124 | median_sv = 3.15303
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 117.56852 | spectral_norm = 11.15992 | median_sv = 3.15530
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 134.98204 | spectral_norm = 11.82365 | median_sv = 3.51305
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 132.84467 | spectral_norm = 10.09127 | median_sv = 3.85633
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 279.19421 | spectral_norm = 19.94654 | median_sv = 9.52004
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 135.91867 | spectral_norm = 11.16467 | median_sv = 4.47951
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 118.04278 | spectral_norm = 12.01228 | median_sv = 3.24790
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 116.91349 | spectral_norm = 11.45679 | median_sv = 3.26255
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 134.03314 | spectral_norm = 11.75062 | median_sv = 3.56197
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 130.84232 | spectral_norm = 10.16814 | median_sv = 3.73445
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 278.18170 | spectral_norm = 20.68359 | median_sv = 9.44396
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 137.49640 | spectral_norm = 11.28820 | median_sv = 4.52190
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 120.93838 | spectral_norm = 11.65442 | median_sv = 3.33552
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 119.70472 | spectral_norm = 10.97742 | median_sv = 3.31640
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 138.38298 | spectral_norm = 13.44031 | median_sv = 3.59611
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 134.37234 | spectral_norm = 10.05602 | median_sv = 4.03889
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 278.29071 | spectral_norm = 21.64668 | median_sv = 9.42743
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 137.79709 | spectral_norm = 11.91761 | median_sv = 4.54024
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 122.21568 | spectral_norm = 11.20443 | median_sv = 3.33723
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 121.48947 | spectral_norm = 10.87119 | median_sv = 3.30777
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 137.41919 | spectral_norm = 12.45736 | median_sv = 3.45544
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 135.12439 | spectral_norm = 9.49529 | median_sv = 4.00423
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 279.39236 | spectral_norm = 21.11605 | median_sv = 9.50283
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 138.21741 | spectral_norm = 12.67018 | median_sv = 4.59527
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 122.74742 | spectral_norm = 12.66295 | median_sv = 3.21600
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 122.73514 | spectral_norm = 11.51438 | median_sv = 3.14393
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 137.04906 | spectral_norm = 12.37142 | median_sv = 3.62950
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 137.35101 | spectral_norm = 9.32019 | median_sv = 4.10454
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 277.05508 | spectral_norm = 21.05314 | median_sv = 9.39472
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 137.76201 | spectral_norm = 13.43012 | median_sv = 4.61383
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 122.48985 | spectral_norm = 13.04262 | median_sv = 3.12408
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 120.25140 | spectral_norm = 12.84852 | median_sv = 2.99051
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 130.59996 | spectral_norm = 12.72685 | median_sv = 3.54832
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 138.42703 | spectral_norm = 9.59112 | median_sv = 4.07455
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 282.33530 | spectral_norm = 19.95808 | median_sv = 9.68202
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 131.75995 | spectral_norm = 14.72992 | median_sv = 4.38458
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 124.62328 | spectral_norm = 13.58120 | median_sv = 3.36425
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 121.62034 | spectral_norm = 13.00201 | median_sv = 3.26752
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 124.02919 | spectral_norm = 13.00831 | median_sv = 3.32088
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 142.19316 | spectral_norm = 10.20778 | median_sv = 4.17956
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 288.31171 | spectral_norm = 24.09000 | median_sv = 9.80065
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 135.52492 | spectral_norm = 15.48831 | median_sv = 4.45656
W name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 70645.53125 | spectral_norm = 5677.07227 | median_sv = 781.33649 | l1_to_l2_norm = 297.79474
W name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 932.04456 | spectral_norm = 172.21385 | median_sv = 28.50463
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | frobenius_norm = 0.00011 | spectral_norm = 0.00005 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 0.00109 | spectral_norm = 0.00065 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 0.00117 | spectral_norm = 0.00063 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 0.00351 | spectral_norm = 0.00317 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 0.00781 | spectral_norm = 0.00749 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 0.00491 | spectral_norm = 0.00452 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 0.00408 | spectral_norm = 0.00230 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 0.00210 | spectral_norm = 0.00175 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 0.00172 | spectral_norm = 0.00128 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 0.00924 | spectral_norm = 0.00909 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 0.00450 | spectral_norm = 0.00372 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 0.00351 | spectral_norm = 0.00303 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 0.00306 | spectral_norm = 0.00162 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 0.00405 | spectral_norm = 0.00383 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 0.00253 | spectral_norm = 0.00172 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 0.00916 | spectral_norm = 0.00897 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 0.00526 | spectral_norm = 0.00456 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 0.00488 | spectral_norm = 0.00437 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 0.00426 | spectral_norm = 0.00256 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 0.00195 | spectral_norm = 0.00173 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 0.00162 | spectral_norm = 0.00115 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 0.00720 | spectral_norm = 0.00709 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 0.00292 | spectral_norm = 0.00216 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 0.00530 | spectral_norm = 0.00466 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 0.00567 | spectral_norm = 0.00350 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 0.00126 | spectral_norm = 0.00100 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 0.00120 | spectral_norm = 0.00078 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 0.00781 | spectral_norm = 0.00754 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 0.00352 | spectral_norm = 0.00263 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 0.00508 | spectral_norm = 0.00435 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 0.00543 | spectral_norm = 0.00370 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 0.00179 | spectral_norm = 0.00147 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 0.00198 | spectral_norm = 0.00130 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 0.00769 | spectral_norm = 0.00742 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 0.00405 | spectral_norm = 0.00339 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 0.00529 | spectral_norm = 0.00462 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 0.00511 | spectral_norm = 0.00350 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 0.00136 | spectral_norm = 0.00112 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 0.00113 | spectral_norm = 0.00055 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 0.00709 | spectral_norm = 0.00682 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 0.00383 | spectral_norm = 0.00324 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 0.00424 | spectral_norm = 0.00360 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 0.00435 | spectral_norm = 0.00282 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 0.00191 | spectral_norm = 0.00171 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 0.00148 | spectral_norm = 0.00095 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 0.00495 | spectral_norm = 0.00479 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 0.00373 | spectral_norm = 0.00330 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 0.00417 | spectral_norm = 0.00356 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 0.00425 | spectral_norm = 0.00270 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 0.00277 | spectral_norm = 0.00256 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 0.00245 | spectral_norm = 0.00171 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 0.00755 | spectral_norm = 0.00740 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 0.00738 | spectral_norm = 0.00717 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 0.00485 | spectral_norm = 0.00433 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 0.00453 | spectral_norm = 0.00296 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 0.00333 | spectral_norm = 0.00310 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 0.00280 | spectral_norm = 0.00200 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 0.00420 | spectral_norm = 0.00411 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 0.01409 | spectral_norm = 0.01395 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 0.00569 | spectral_norm = 0.00529 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 0.00519 | spectral_norm = 0.00396 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 0.00405 | spectral_norm = 0.00386 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 0.00284 | spectral_norm = 0.00233 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 0.00361 | spectral_norm = 0.00355 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 0.01890 | spectral_norm = 0.01877 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 0.01212 | spectral_norm = 0.01183 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 0.00858 | spectral_norm = 0.00705 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 0.00918 | spectral_norm = 0.00909 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 0.00440 | spectral_norm = 0.00393 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 0.00606 | spectral_norm = 0.00599 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 0.02455 | spectral_norm = 0.02426 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 0.01808 | spectral_norm = 0.01761 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 0.02058 | spectral_norm = 0.01872 | median_sv = 0.00008
G name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 0.00023 | spectral_norm = 0.00018 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.12735 | spectral_norm = 0.12360 | median_sv = 0.00024
===========================================
step:626/1480 train_time:228110ms step_avg:370.31ms
step:627/1480 train_time:228412ms step_avg:370.20ms
step:628/1480 train_time:228723ms step_avg:370.10ms
step:629/1480 train_time:229030ms step_avg:370.00ms
step:630/1480 train_time:229341ms step_avg:369.90ms
step:631/1480 train_time:229647ms step_avg:369.80ms
step:632/1480 train_time:229958ms step_avg:369.71ms
step:633/1480 train_time:230266ms step_avg:369.61ms
step:634/1480 train_time:230579ms step_avg:369.52ms
step:635/1480 train_time:230889ms step_avg:369.42ms
step:636/1480 train_time:231199ms step_avg:369.33ms
step:637/1480 train_time:231510ms step_avg:369.24ms
step:638/1480 train_time:231822ms step_avg:369.14ms
step:639/1480 train_time:232132ms step_avg:369.05ms
step:640/1480 train_time:232442ms step_avg:368.96ms
step:641/1480 train_time:232751ms step_avg:368.86ms
step:642/1480 train_time:233061ms step_avg:368.77ms
step:643/1480 train_time:233371ms step_avg:368.67ms
step:644/1480 train_time:233681ms step_avg:368.58ms
step:645/1480 train_time:233990ms step_avg:368.49ms
step:646/1480 train_time:234301ms step_avg:368.40ms
step:647/1480 train_time:234612ms step_avg:368.31ms
step:648/1480 train_time:234924ms step_avg:368.22ms
step:649/1480 train_time:235240ms step_avg:368.14ms
step:650/1480 train_time:235551ms step_avg:368.05ms
step:651/1480 train_time:235865ms step_avg:367.96ms
step:652/1480 train_time:236177ms step_avg:367.88ms
step:653/1480 train_time:236487ms step_avg:367.79ms
step:654/1480 train_time:236797ms step_avg:367.70ms
step:655/1480 train_time:237110ms step_avg:367.61ms
step:656/1480 train_time:237419ms step_avg:367.52ms
step:657/1480 train_time:237729ms step_avg:367.43ms
step:658/1480 train_time:238039ms step_avg:367.34ms
step:659/1480 train_time:238357ms step_avg:367.27ms
step:660/1480 train_time:238674ms step_avg:367.19ms
step:661/1480 train_time:238989ms step_avg:367.11ms
step:662/1480 train_time:239308ms step_avg:367.04ms
step:663/1480 train_time:239622ms step_avg:366.95ms
step:664/1480 train_time:239936ms step_avg:366.88ms
step:665/1480 train_time:240257ms step_avg:366.80ms
step:666/1480 train_time:240574ms step_avg:366.73ms
step:667/1480 train_time:240887ms step_avg:366.65ms
step:668/1480 train_time:241207ms step_avg:366.58ms
step:669/1480 train_time:241526ms step_avg:366.50ms
step:670/1480 train_time:241842ms step_avg:366.43ms
step:671/1480 train_time:242161ms step_avg:366.36ms
step:672/1480 train_time:242479ms step_avg:366.28ms
step:673/1480 train_time:242795ms step_avg:366.21ms
step:674/1480 train_time:243112ms step_avg:366.13ms
step:675/1480 train_time:243430ms step_avg:366.06ms
step:676/1480 train_time:243745ms step_avg:365.98ms
step:677/1480 train_time:244060ms step_avg:365.91ms
step:678/1480 train_time:244375ms step_avg:365.83ms
step:679/1480 train_time:244688ms step_avg:365.75ms
step:680/1480 train_time:245009ms step_avg:365.69ms
step:681/1480 train_time:245329ms step_avg:365.62ms
step:682/1480 train_time:245645ms step_avg:365.54ms
step:683/1480 train_time:245963ms step_avg:365.47ms
step:684/1480 train_time:246279ms step_avg:365.40ms
step:685/1480 train_time:246597ms step_avg:365.33ms
step:686/1480 train_time:246916ms step_avg:365.26ms
step:687/1480 train_time:247234ms step_avg:365.19ms
step:688/1480 train_time:247553ms step_avg:365.12ms
step:689/1480 train_time:247877ms step_avg:365.06ms
step:690/1480 train_time:248190ms step_avg:364.98ms
step:691/1480 train_time:248511ms step_avg:364.92ms
step:692/1480 train_time:248825ms step_avg:364.85ms
step:693/1480 train_time:249140ms step_avg:364.77ms
step:694/1480 train_time:249454ms step_avg:364.70ms
step:695/1480 train_time:249771ms step_avg:364.63ms
step:696/1480 train_time:250085ms step_avg:364.56ms
step:697/1480 train_time:250402ms step_avg:364.49ms
step:698/1480 train_time:250717ms step_avg:364.41ms
step:699/1480 train_time:251033ms step_avg:364.34ms
step:700/1480 train_time:251353ms step_avg:364.28ms
step:701/1480 train_time:251666ms step_avg:364.21ms
step:702/1480 train_time:251980ms step_avg:364.13ms
step:703/1480 train_time:252298ms step_avg:364.07ms
step:704/1480 train_time:252612ms step_avg:363.99ms
step:705/1480 train_time:252935ms step_avg:363.94ms
step:706/1480 train_time:253252ms step_avg:363.87ms
step:707/1480 train_time:253569ms step_avg:363.80ms
step:708/1480 train_time:253885ms step_avg:363.73ms
step:709/1480 train_time:254203ms step_avg:363.67ms
step:710/1480 train_time:254521ms step_avg:363.60ms
step:711/1480 train_time:254836ms step_avg:363.53ms
step:712/1480 train_time:255156ms step_avg:363.47ms
step:713/1480 train_time:255474ms step_avg:363.41ms
step:714/1480 train_time:255795ms step_avg:363.34ms
step:715/1480 train_time:256110ms step_avg:363.28ms
step:716/1480 train_time:256428ms step_avg:363.21ms
step:717/1480 train_time:256743ms step_avg:363.14ms
step:718/1480 train_time:257059ms step_avg:363.08ms
step:719/1480 train_time:257372ms step_avg:363.01ms
step:720/1480 train_time:257686ms step_avg:362.94ms
step:721/1480 train_time:258007ms step_avg:362.88ms
step:722/1480 train_time:258322ms step_avg:362.81ms
step:723/1480 train_time:258640ms step_avg:362.75ms
step:724/1480 train_time:258952ms step_avg:362.68ms
step:725/1480 train_time:259269ms step_avg:362.61ms
step:726/1480 train_time:259595ms step_avg:362.56ms
step:727/1480 train_time:259914ms step_avg:362.50ms
step:728/1480 train_time:260230ms step_avg:362.44ms
step:729/1480 train_time:260545ms step_avg:362.37ms
step:730/1480 train_time:260861ms step_avg:362.31ms
step:731/1480 train_time:261182ms step_avg:362.25ms
step:732/1480 train_time:261498ms step_avg:362.19ms
step:733/1480 train_time:261809ms step_avg:362.12ms
step:734/1480 train_time:262125ms step_avg:362.05ms
step:735/1480 train_time:262443ms step_avg:361.99ms
step:736/1480 train_time:262761ms step_avg:361.93ms
step:737/1480 train_time:263078ms step_avg:361.87ms
step:738/1480 train_time:263390ms step_avg:361.80ms
step:739/1480 train_time:263704ms step_avg:361.73ms
step:740/1480 train_time:264018ms step_avg:361.67ms
step:741/1480 train_time:264343ms step_avg:361.62ms
step:742/1480 train_time:264654ms step_avg:361.55ms
step:743/1480 train_time:264976ms step_avg:361.50ms
step:744/1480 train_time:265295ms step_avg:361.44ms
step:745/1480 train_time:265616ms step_avg:361.38ms
step:746/1480 train_time:265933ms step_avg:361.32ms
step:747/1480 train_time:266246ms step_avg:361.26ms
step:748/1480 train_time:266562ms step_avg:361.19ms
step:749/1480 train_time:266879ms step_avg:361.14ms
step:750/1480 train_time:267202ms step_avg:361.08ms
step:750/1480 val_loss:3.5466 train_time:267219ms step_avg:361.11ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | frobenius_norm = 48684.83203 | spectral_norm = 11717.72168 | median_sv = 1359.15344 | l1_to_l2_norm = 210.71933
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 132.50259 | spectral_norm = 19.39490 | median_sv = 3.67050
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 126.00117 | spectral_norm = 25.16633 | median_sv = 3.39692
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 126.31438 | spectral_norm = 13.59326 | median_sv = 3.56554
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 128.21904 | spectral_norm = 10.89909 | median_sv = 3.66469
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 273.28168 | spectral_norm = 19.77721 | median_sv = 9.18038
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 141.75616 | spectral_norm = 13.21444 | median_sv = 4.63097
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 133.97160 | spectral_norm = 13.69190 | median_sv = 3.67072
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 132.05324 | spectral_norm = 14.76146 | median_sv = 3.57279
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 132.81662 | spectral_norm = 12.56791 | median_sv = 3.48012
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 140.47569 | spectral_norm = 10.97812 | median_sv = 3.94513
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 296.52585 | spectral_norm = 22.20182 | median_sv = 9.98664
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 153.04663 | spectral_norm = 14.67322 | median_sv = 5.00586
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 134.15117 | spectral_norm = 11.75081 | median_sv = 3.56306
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 132.88255 | spectral_norm = 11.77783 | median_sv = 3.55950
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 146.57976 | spectral_norm = 14.17279 | median_sv = 3.78446
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 150.64578 | spectral_norm = 10.50514 | median_sv = 4.45946
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 301.05969 | spectral_norm = 22.41142 | median_sv = 10.22405
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 152.57503 | spectral_norm = 14.00106 | median_sv = 5.06631
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 137.96637 | spectral_norm = 13.08465 | median_sv = 3.76161
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 135.55359 | spectral_norm = 12.34351 | median_sv = 3.73273
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 153.58218 | spectral_norm = 14.59771 | median_sv = 4.00625
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 149.31137 | spectral_norm = 10.68324 | median_sv = 4.45607
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 305.80212 | spectral_norm = 24.25761 | median_sv = 10.35651
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 151.93645 | spectral_norm = 13.05578 | median_sv = 4.99614
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 132.65398 | spectral_norm = 14.40371 | median_sv = 3.59671
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 130.34355 | spectral_norm = 14.04125 | median_sv = 3.59462
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 146.93991 | spectral_norm = 12.89916 | median_sv = 3.93111
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 146.48805 | spectral_norm = 11.39492 | median_sv = 4.15819
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 312.38181 | spectral_norm = 22.51447 | median_sv = 10.58705
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 154.11491 | spectral_norm = 13.46195 | median_sv = 5.06853
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 131.92154 | spectral_norm = 12.84188 | median_sv = 3.48747
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 131.81793 | spectral_norm = 12.70715 | median_sv = 3.51260
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 152.47241 | spectral_norm = 13.21540 | median_sv = 3.99229
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 149.69276 | spectral_norm = 11.14416 | median_sv = 4.34048
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 314.26968 | spectral_norm = 22.63995 | median_sv = 10.73591
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 152.90344 | spectral_norm = 12.76825 | median_sv = 5.03520
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 132.24799 | spectral_norm = 13.71444 | median_sv = 3.58966
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 130.85265 | spectral_norm = 13.12882 | median_sv = 3.63535
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 151.24693 | spectral_norm = 13.25220 | median_sv = 4.04302
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 147.18719 | spectral_norm = 11.44302 | median_sv = 4.19855
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 312.50522 | spectral_norm = 23.21250 | median_sv = 10.62492
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 154.82623 | spectral_norm = 13.01098 | median_sv = 5.09771
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 135.84077 | spectral_norm = 13.09414 | median_sv = 3.70955
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 134.30151 | spectral_norm = 12.41961 | median_sv = 3.68165
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 156.30444 | spectral_norm = 14.95708 | median_sv = 4.04616
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 151.51666 | spectral_norm = 11.31715 | median_sv = 4.57765
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 312.05978 | spectral_norm = 24.35441 | median_sv = 10.55915
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 155.26387 | spectral_norm = 13.49861 | median_sv = 5.11094
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 137.03285 | spectral_norm = 12.72846 | median_sv = 3.69240
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 136.12965 | spectral_norm = 12.26529 | median_sv = 3.66667
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 155.50470 | spectral_norm = 14.26616 | median_sv = 3.90150
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 152.23759 | spectral_norm = 10.85326 | median_sv = 4.49660
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 313.45950 | spectral_norm = 23.93472 | median_sv = 10.63461
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 155.92137 | spectral_norm = 14.46233 | median_sv = 5.18462
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 137.70367 | spectral_norm = 14.50074 | median_sv = 3.56224
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 137.76009 | spectral_norm = 13.14108 | median_sv = 3.47345
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 155.67046 | spectral_norm = 14.26552 | median_sv = 4.11581
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 154.05238 | spectral_norm = 10.50488 | median_sv = 4.63366
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 311.01663 | spectral_norm = 24.25807 | median_sv = 10.54906
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 155.48981 | spectral_norm = 15.51832 | median_sv = 5.20754
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 137.19197 | spectral_norm = 15.19269 | median_sv = 3.44130
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 134.66393 | spectral_norm = 14.75781 | median_sv = 3.28781
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 147.94658 | spectral_norm = 14.57051 | median_sv = 4.00358
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 154.85440 | spectral_norm = 10.70546 | median_sv = 4.53511
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 318.16592 | spectral_norm = 22.72650 | median_sv = 10.90941
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 148.19650 | spectral_norm = 17.23952 | median_sv = 4.93582
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 139.50552 | spectral_norm = 15.71223 | median_sv = 3.68834
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 136.14174 | spectral_norm = 15.11168 | median_sv = 3.60385
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 140.56613 | spectral_norm = 15.18054 | median_sv = 3.74984
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 160.22989 | spectral_norm = 11.43317 | median_sv = 4.69056
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 325.83545 | spectral_norm = 27.87217 | median_sv = 11.04891
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 153.30251 | spectral_norm = 18.29747 | median_sv = 5.03597
W name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 75903.27344 | spectral_norm = 5910.10059 | median_sv = 845.79767 | l1_to_l2_norm = 319.80847
W name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1027.78381 | spectral_norm = 173.88989 | median_sv = 31.70988
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | frobenius_norm = 0.00009 | spectral_norm = 0.00004 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 0.00098 | spectral_norm = 0.00055 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 0.00107 | spectral_norm = 0.00058 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 0.00387 | spectral_norm = 0.00356 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 0.00866 | spectral_norm = 0.00842 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 0.00556 | spectral_norm = 0.00525 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 0.00410 | spectral_norm = 0.00249 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 0.00178 | spectral_norm = 0.00166 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 0.00141 | spectral_norm = 0.00115 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 0.01029 | spectral_norm = 0.01018 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 0.00450 | spectral_norm = 0.00390 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 0.00338 | spectral_norm = 0.00295 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 0.00290 | spectral_norm = 0.00166 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 0.00291 | spectral_norm = 0.00272 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 0.00180 | spectral_norm = 0.00125 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 0.00957 | spectral_norm = 0.00941 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 0.00531 | spectral_norm = 0.00486 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 0.00455 | spectral_norm = 0.00409 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 0.00406 | spectral_norm = 0.00257 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 0.00163 | spectral_norm = 0.00144 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 0.00126 | spectral_norm = 0.00073 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 0.00884 | spectral_norm = 0.00873 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 0.00308 | spectral_norm = 0.00249 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 0.00535 | spectral_norm = 0.00478 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 0.00594 | spectral_norm = 0.00408 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 0.00120 | spectral_norm = 0.00102 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 0.00102 | spectral_norm = 0.00062 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 0.00908 | spectral_norm = 0.00887 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 0.00380 | spectral_norm = 0.00312 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 0.00516 | spectral_norm = 0.00456 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 0.00555 | spectral_norm = 0.00426 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 0.00153 | spectral_norm = 0.00123 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 0.00145 | spectral_norm = 0.00077 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 0.00883 | spectral_norm = 0.00859 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 0.00436 | spectral_norm = 0.00386 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 0.00502 | spectral_norm = 0.00444 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 0.00517 | spectral_norm = 0.00385 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 0.00114 | spectral_norm = 0.00090 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 0.00106 | spectral_norm = 0.00064 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 0.00749 | spectral_norm = 0.00724 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 0.00374 | spectral_norm = 0.00324 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 0.00398 | spectral_norm = 0.00339 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 0.00428 | spectral_norm = 0.00293 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 0.00153 | spectral_norm = 0.00132 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 0.00133 | spectral_norm = 0.00084 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 0.00549 | spectral_norm = 0.00534 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 0.00365 | spectral_norm = 0.00323 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 0.00408 | spectral_norm = 0.00346 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 0.00427 | spectral_norm = 0.00278 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 0.00248 | spectral_norm = 0.00225 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 0.00265 | spectral_norm = 0.00179 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 0.00825 | spectral_norm = 0.00810 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 0.00669 | spectral_norm = 0.00648 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 0.00450 | spectral_norm = 0.00398 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 0.00428 | spectral_norm = 0.00267 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 0.00255 | spectral_norm = 0.00229 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 0.00260 | spectral_norm = 0.00180 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 0.00442 | spectral_norm = 0.00433 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 0.01239 | spectral_norm = 0.01223 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 0.00511 | spectral_norm = 0.00472 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 0.00484 | spectral_norm = 0.00357 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 0.00340 | spectral_norm = 0.00318 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 0.00283 | spectral_norm = 0.00239 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 0.00369 | spectral_norm = 0.00363 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 0.01721 | spectral_norm = 0.01707 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 0.00982 | spectral_norm = 0.00952 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 0.00785 | spectral_norm = 0.00626 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 0.00679 | spectral_norm = 0.00671 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 0.00407 | spectral_norm = 0.00375 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 0.00592 | spectral_norm = 0.00584 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 0.02257 | spectral_norm = 0.02228 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 0.01709 | spectral_norm = 0.01666 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 0.02082 | spectral_norm = 0.01860 | median_sv = 0.00008
G name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 0.00025 | spectral_norm = 0.00020 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.18403 | spectral_norm = 0.18053 | median_sv = 0.00022
===========================================
step:751/1480 train_time:276671ms step_avg:373.37ms
step:752/1480 train_time:276974ms step_avg:373.28ms
step:753/1480 train_time:277289ms step_avg:373.20ms
step:754/1480 train_time:277604ms step_avg:373.12ms
step:755/1480 train_time:277916ms step_avg:373.04ms
step:756/1480 train_time:278232ms step_avg:372.97ms
step:757/1480 train_time:278552ms step_avg:372.89ms
step:758/1480 train_time:278874ms step_avg:372.83ms
step:759/1480 train_time:279189ms step_avg:372.75ms
step:760/1480 train_time:279505ms step_avg:372.67ms
step:761/1480 train_time:279817ms step_avg:372.59ms
step:762/1480 train_time:280132ms step_avg:372.52ms
step:763/1480 train_time:280449ms step_avg:372.44ms
step:764/1480 train_time:280765ms step_avg:372.37ms
step:765/1480 train_time:281083ms step_avg:372.29ms
step:766/1480 train_time:281399ms step_avg:372.22ms
step:767/1480 train_time:281719ms step_avg:372.15ms
step:768/1480 train_time:282036ms step_avg:372.08ms
step:769/1480 train_time:282353ms step_avg:372.01ms
step:770/1480 train_time:282674ms step_avg:371.94ms
step:771/1480 train_time:282994ms step_avg:371.87ms
step:772/1480 train_time:283317ms step_avg:371.81ms
step:773/1480 train_time:283639ms step_avg:371.74ms
step:774/1480 train_time:283961ms step_avg:371.68ms
step:775/1480 train_time:284277ms step_avg:371.60ms
step:776/1480 train_time:284598ms step_avg:371.54ms
step:777/1480 train_time:284919ms step_avg:371.47ms
step:778/1480 train_time:285243ms step_avg:371.41ms
step:779/1480 train_time:285564ms step_avg:371.34ms
step:780/1480 train_time:285882ms step_avg:371.28ms
step:781/1480 train_time:286207ms step_avg:371.22ms
step:782/1480 train_time:286527ms step_avg:371.15ms
step:783/1480 train_time:286848ms step_avg:371.08ms
step:784/1480 train_time:287169ms step_avg:371.02ms
step:785/1480 train_time:287489ms step_avg:370.95ms
step:786/1480 train_time:287811ms step_avg:370.89ms
step:787/1480 train_time:288130ms step_avg:370.82ms
step:788/1480 train_time:288450ms step_avg:370.76ms
step:789/1480 train_time:288769ms step_avg:370.69ms
step:790/1480 train_time:289087ms step_avg:370.62ms
step:791/1480 train_time:289410ms step_avg:370.56ms
step:792/1480 train_time:289731ms step_avg:370.50ms
step:793/1480 train_time:290051ms step_avg:370.44ms
step:794/1480 train_time:290375ms step_avg:370.38ms
step:795/1480 train_time:290700ms step_avg:370.32ms
step:796/1480 train_time:291027ms step_avg:370.26ms
step:797/1480 train_time:291348ms step_avg:370.20ms
step:798/1480 train_time:291667ms step_avg:370.14ms
step:799/1480 train_time:291991ms step_avg:370.08ms
step:800/1480 train_time:292321ms step_avg:370.03ms
step:801/1480 train_time:292640ms step_avg:369.96ms
step:802/1480 train_time:292960ms step_avg:369.90ms
step:803/1480 train_time:293285ms step_avg:369.84ms
step:804/1480 train_time:293612ms step_avg:369.79ms
step:805/1480 train_time:293934ms step_avg:369.73ms
step:806/1480 train_time:294259ms step_avg:369.67ms
step:807/1480 train_time:294584ms step_avg:369.62ms
step:808/1480 train_time:294899ms step_avg:369.55ms
step:809/1480 train_time:295225ms step_avg:369.49ms
step:810/1480 train_time:295542ms step_avg:369.43ms
step:811/1480 train_time:295864ms step_avg:369.37ms
step:812/1480 train_time:296183ms step_avg:369.31ms
step:813/1480 train_time:296503ms step_avg:369.24ms
step:814/1480 train_time:296823ms step_avg:369.18ms
step:815/1480 train_time:297148ms step_avg:369.13ms
step:816/1480 train_time:297468ms step_avg:369.07ms
step:817/1480 train_time:297788ms step_avg:369.01ms
step:818/1480 train_time:298108ms step_avg:368.95ms
step:819/1480 train_time:298429ms step_avg:368.89ms
step:820/1480 train_time:298745ms step_avg:368.82ms
step:821/1480 train_time:299066ms step_avg:368.76ms
step:822/1480 train_time:299385ms step_avg:368.70ms
step:823/1480 train_time:299707ms step_avg:368.64ms
step:824/1480 train_time:300029ms step_avg:368.59ms
step:825/1480 train_time:300351ms step_avg:368.53ms
step:826/1480 train_time:300674ms step_avg:368.47ms
step:827/1480 train_time:300996ms step_avg:368.42ms
step:828/1480 train_time:301322ms step_avg:368.36ms
step:829/1480 train_time:301640ms step_avg:368.30ms
step:830/1480 train_time:301957ms step_avg:368.24ms
step:831/1480 train_time:302282ms step_avg:368.19ms
step:832/1480 train_time:302606ms step_avg:368.13ms
step:833/1480 train_time:302929ms step_avg:368.08ms
step:834/1480 train_time:303252ms step_avg:368.02ms
step:835/1480 train_time:303573ms step_avg:367.97ms
step:836/1480 train_time:303901ms step_avg:367.92ms
step:837/1480 train_time:304222ms step_avg:367.86ms
step:838/1480 train_time:304545ms step_avg:367.81ms
step:839/1480 train_time:304863ms step_avg:367.75ms
step:840/1480 train_time:305182ms step_avg:367.69ms
step:841/1480 train_time:305503ms step_avg:367.63ms
step:842/1480 train_time:305822ms step_avg:367.57ms
step:843/1480 train_time:306144ms step_avg:367.52ms
step:844/1480 train_time:306465ms step_avg:367.46ms
step:845/1480 train_time:306786ms step_avg:367.41ms
step:846/1480 train_time:307109ms step_avg:367.36ms
step:847/1480 train_time:307429ms step_avg:367.30ms
step:848/1480 train_time:307754ms step_avg:367.25ms
step:849/1480 train_time:308078ms step_avg:367.20ms
step:850/1480 train_time:308396ms step_avg:367.14ms
step:851/1480 train_time:308718ms step_avg:367.08ms
step:852/1480 train_time:309044ms step_avg:367.04ms
step:853/1480 train_time:309364ms step_avg:366.98ms
step:854/1480 train_time:309684ms step_avg:366.92ms
step:855/1480 train_time:310002ms step_avg:366.87ms
step:856/1480 train_time:310323ms step_avg:366.81ms
step:857/1480 train_time:310652ms step_avg:366.77ms
step:858/1480 train_time:310980ms step_avg:366.72ms
step:859/1480 train_time:311308ms step_avg:366.68ms
step:860/1480 train_time:311629ms step_avg:366.62ms
step:861/1480 train_time:311950ms step_avg:366.57ms
step:862/1480 train_time:312267ms step_avg:366.51ms
step:863/1480 train_time:312593ms step_avg:366.46ms
step:864/1480 train_time:312922ms step_avg:366.42ms
step:865/1480 train_time:313252ms step_avg:366.38ms
step:866/1480 train_time:313575ms step_avg:366.33ms
step:867/1480 train_time:313895ms step_avg:366.27ms
step:868/1480 train_time:314225ms step_avg:366.23ms
step:869/1480 train_time:314548ms step_avg:366.18ms
step:870/1480 train_time:314870ms step_avg:366.13ms
step:871/1480 train_time:315191ms step_avg:366.08ms
step:872/1480 train_time:315512ms step_avg:366.02ms
step:873/1480 train_time:315830ms step_avg:365.97ms
step:874/1480 train_time:316149ms step_avg:365.91ms
step:875/1480 train_time:316469ms step_avg:365.86ms
step:875/1480 val_loss:3.4983 train_time:316487ms step_avg:365.88ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | frobenius_norm = 51218.92578 | spectral_norm = 12200.00781 | median_sv = 1430.37769 | l1_to_l2_norm = 221.40573
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 145.85442 | spectral_norm = 22.14297 | median_sv = 4.04043
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 138.38168 | spectral_norm = 28.45438 | median_sv = 3.70723
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 137.83510 | spectral_norm = 15.45327 | median_sv = 3.87387
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 140.19595 | spectral_norm = 12.12412 | median_sv = 3.96253
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 301.83725 | spectral_norm = 21.85905 | median_sv = 10.16706
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 155.67857 | spectral_norm = 14.71824 | median_sv = 5.07326
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 147.24744 | spectral_norm = 15.40214 | median_sv = 3.99849
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 145.46460 | spectral_norm = 16.12208 | median_sv = 3.90990
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 146.21616 | spectral_norm = 13.98797 | median_sv = 3.83210
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 154.64520 | spectral_norm = 12.25240 | median_sv = 4.35564
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 326.70560 | spectral_norm = 25.00453 | median_sv = 11.01129
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 168.47906 | spectral_norm = 16.41827 | median_sv = 5.51380
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 147.45166 | spectral_norm = 13.06444 | median_sv = 3.89032
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 145.96629 | spectral_norm = 13.05152 | median_sv = 3.90208
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 162.17558 | spectral_norm = 15.70557 | median_sv = 4.18606
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 165.83533 | spectral_norm = 11.51602 | median_sv = 4.93018
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 331.54697 | spectral_norm = 25.33972 | median_sv = 11.26053
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 168.04834 | spectral_norm = 15.58766 | median_sv = 5.58037
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 151.99149 | spectral_norm = 14.63813 | median_sv = 4.11408
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 149.16109 | spectral_norm = 13.63122 | median_sv = 4.08656
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 169.59195 | spectral_norm = 16.11649 | median_sv = 4.43608
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 164.55388 | spectral_norm = 11.72965 | median_sv = 4.92474
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 336.90952 | spectral_norm = 27.35941 | median_sv = 11.42055
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 167.27260 | spectral_norm = 14.58255 | median_sv = 5.50082
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 145.73856 | spectral_norm = 16.10001 | median_sv = 3.92603
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 143.26048 | spectral_norm = 15.56614 | median_sv = 3.92499
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 162.27534 | spectral_norm = 14.34197 | median_sv = 4.35630
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 161.67767 | spectral_norm = 12.66554 | median_sv = 4.59415
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 343.81067 | spectral_norm = 25.32529 | median_sv = 11.68292
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 169.70332 | spectral_norm = 15.03028 | median_sv = 5.57879
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 144.91438 | spectral_norm = 14.26626 | median_sv = 3.80186
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 144.74797 | spectral_norm = 14.06902 | median_sv = 3.82918
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 168.70226 | spectral_norm = 14.55103 | median_sv = 4.42766
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 165.19321 | spectral_norm = 12.13763 | median_sv = 4.82438
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 346.23697 | spectral_norm = 25.50236 | median_sv = 11.83698
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 168.40686 | spectral_norm = 14.25794 | median_sv = 5.55747
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 145.04605 | spectral_norm = 15.35567 | median_sv = 3.90821
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 143.33713 | spectral_norm = 14.67643 | median_sv = 3.95779
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 167.38538 | spectral_norm = 14.59377 | median_sv = 4.50290
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 162.46387 | spectral_norm = 12.71527 | median_sv = 4.65873
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 343.28693 | spectral_norm = 25.45566 | median_sv = 11.66899
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 170.48320 | spectral_norm = 14.60645 | median_sv = 5.61131
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 149.26126 | spectral_norm = 14.45865 | median_sv = 4.04428
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 147.41631 | spectral_norm = 13.79054 | median_sv = 4.02306
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 172.72601 | spectral_norm = 16.34300 | median_sv = 4.48314
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 167.27074 | spectral_norm = 12.40327 | median_sv = 5.05822
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 342.54788 | spectral_norm = 26.85581 | median_sv = 11.58564
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 171.06436 | spectral_norm = 15.00259 | median_sv = 5.64319
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 150.57948 | spectral_norm = 14.19015 | median_sv = 4.00989
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 149.42456 | spectral_norm = 13.58904 | median_sv = 3.97953
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 171.98048 | spectral_norm = 15.82397 | median_sv = 4.32673
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 167.68900 | spectral_norm = 11.98024 | median_sv = 4.96651
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 344.48798 | spectral_norm = 26.60458 | median_sv = 11.71153
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 171.93797 | spectral_norm = 16.04632 | median_sv = 5.72311
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 151.32288 | spectral_norm = 16.19965 | median_sv = 3.86520
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 151.51807 | spectral_norm = 14.61333 | median_sv = 3.75975
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 172.40692 | spectral_norm = 16.28434 | median_sv = 4.54647
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 169.26060 | spectral_norm = 11.49819 | median_sv = 5.09601
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 341.40839 | spectral_norm = 27.20527 | median_sv = 11.58684
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 171.36629 | spectral_norm = 17.40237 | median_sv = 5.74959
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 150.61827 | spectral_norm = 17.28840 | median_sv = 3.72113
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 147.90746 | spectral_norm = 16.44097 | median_sv = 3.54306
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 163.98213 | spectral_norm = 16.04900 | median_sv = 4.44483
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 169.70125 | spectral_norm = 11.65346 | median_sv = 4.99381
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 351.14877 | spectral_norm = 25.34599 | median_sv = 12.04653
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 163.15417 | spectral_norm = 19.51200 | median_sv = 5.43283
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 153.16316 | spectral_norm = 17.64481 | median_sv = 4.03023
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 149.36362 | spectral_norm = 16.95506 | median_sv = 3.90345
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 155.24641 | spectral_norm = 17.17527 | median_sv = 4.14061
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 176.37003 | spectral_norm = 12.67793 | median_sv = 5.18235
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 360.09448 | spectral_norm = 30.92722 | median_sv = 12.21077
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 169.83731 | spectral_norm = 20.97968 | median_sv = 5.57712
W name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 80584.56250 | spectral_norm = 6105.07080 | median_sv = 903.80157 | l1_to_l2_norm = 339.38882
W name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1114.58813 | spectral_norm = 174.47510 | median_sv = 34.62899
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | frobenius_norm = 0.00008 | spectral_norm = 0.00004 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 0.00086 | spectral_norm = 0.00047 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 0.00096 | spectral_norm = 0.00048 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 0.00303 | spectral_norm = 0.00272 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 0.00742 | spectral_norm = 0.00719 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 0.00533 | spectral_norm = 0.00507 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 0.00347 | spectral_norm = 0.00187 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 0.00109 | spectral_norm = 0.00094 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 0.00096 | spectral_norm = 0.00068 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 0.00808 | spectral_norm = 0.00798 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 0.00349 | spectral_norm = 0.00284 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 0.00306 | spectral_norm = 0.00268 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 0.00244 | spectral_norm = 0.00119 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 0.00236 | spectral_norm = 0.00217 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 0.00156 | spectral_norm = 0.00109 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 0.00762 | spectral_norm = 0.00747 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 0.00417 | spectral_norm = 0.00369 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 0.00394 | spectral_norm = 0.00351 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 0.00342 | spectral_norm = 0.00192 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 0.00146 | spectral_norm = 0.00129 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 0.00109 | spectral_norm = 0.00069 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 0.00704 | spectral_norm = 0.00694 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 0.00255 | spectral_norm = 0.00194 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 0.00451 | spectral_norm = 0.00397 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 0.00501 | spectral_norm = 0.00315 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 0.00085 | spectral_norm = 0.00064 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 0.00076 | spectral_norm = 0.00039 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 0.00707 | spectral_norm = 0.00686 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 0.00319 | spectral_norm = 0.00250 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 0.00453 | spectral_norm = 0.00396 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 0.00469 | spectral_norm = 0.00336 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 0.00152 | spectral_norm = 0.00127 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 0.00137 | spectral_norm = 0.00079 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 0.00697 | spectral_norm = 0.00674 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 0.00366 | spectral_norm = 0.00314 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 0.00429 | spectral_norm = 0.00373 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 0.00449 | spectral_norm = 0.00315 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 0.00103 | spectral_norm = 0.00080 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 0.00088 | spectral_norm = 0.00041 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 0.00640 | spectral_norm = 0.00617 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 0.00335 | spectral_norm = 0.00284 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 0.00368 | spectral_norm = 0.00312 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 0.00381 | spectral_norm = 0.00245 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 0.00119 | spectral_norm = 0.00096 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 0.00107 | spectral_norm = 0.00061 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 0.00505 | spectral_norm = 0.00490 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 0.00327 | spectral_norm = 0.00282 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 0.00366 | spectral_norm = 0.00308 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 0.00379 | spectral_norm = 0.00229 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 0.00204 | spectral_norm = 0.00175 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 0.00234 | spectral_norm = 0.00156 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 0.00695 | spectral_norm = 0.00679 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 0.00591 | spectral_norm = 0.00569 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 0.00411 | spectral_norm = 0.00361 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 0.00388 | spectral_norm = 0.00220 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 0.00277 | spectral_norm = 0.00257 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 0.00232 | spectral_norm = 0.00154 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 0.00389 | spectral_norm = 0.00379 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 0.01032 | spectral_norm = 0.01017 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 0.00496 | spectral_norm = 0.00459 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 0.00463 | spectral_norm = 0.00342 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 0.00339 | spectral_norm = 0.00321 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 0.00227 | spectral_norm = 0.00183 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 0.00301 | spectral_norm = 0.00295 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 0.01336 | spectral_norm = 0.01323 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 0.00787 | spectral_norm = 0.00758 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 0.00739 | spectral_norm = 0.00561 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 0.00482 | spectral_norm = 0.00470 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 0.00243 | spectral_norm = 0.00204 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 0.00478 | spectral_norm = 0.00470 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 0.01855 | spectral_norm = 0.01808 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 0.01583 | spectral_norm = 0.01530 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 0.02007 | spectral_norm = 0.01764 | median_sv = 0.00008
G name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 0.00022 | spectral_norm = 0.00017 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.14590 | spectral_norm = 0.14030 | median_sv = 0.00020
===========================================
step:876/1480 train_time:326060ms step_avg:376.51ms
step:877/1480 train_time:326370ms step_avg:376.44ms
step:878/1480 train_time:326688ms step_avg:376.37ms
step:879/1480 train_time:327010ms step_avg:376.31ms
step:880/1480 train_time:327333ms step_avg:376.24ms
step:881/1480 train_time:327657ms step_avg:376.18ms
step:882/1480 train_time:327975ms step_avg:376.12ms
step:883/1480 train_time:328306ms step_avg:376.07ms
step:884/1480 train_time:328629ms step_avg:376.01ms
step:885/1480 train_time:328951ms step_avg:375.94ms
step:886/1480 train_time:329281ms step_avg:375.89ms
step:887/1480 train_time:329610ms step_avg:375.84ms
step:888/1480 train_time:329930ms step_avg:375.77ms
step:889/1480 train_time:330255ms step_avg:375.72ms
step:890/1480 train_time:330590ms step_avg:375.67ms
step:891/1480 train_time:330910ms step_avg:375.61ms
step:892/1480 train_time:331234ms step_avg:375.55ms
step:893/1480 train_time:331561ms step_avg:375.49ms
step:894/1480 train_time:331884ms step_avg:375.43ms
step:895/1480 train_time:332207ms step_avg:375.37ms
step:896/1480 train_time:332537ms step_avg:375.32ms
step:897/1480 train_time:332865ms step_avg:375.27ms
step:898/1480 train_time:333192ms step_avg:375.22ms
step:899/1480 train_time:333517ms step_avg:375.16ms
step:900/1480 train_time:333843ms step_avg:375.10ms
step:901/1480 train_time:334164ms step_avg:375.04ms
step:902/1480 train_time:334491ms step_avg:374.99ms
step:903/1480 train_time:334813ms step_avg:374.93ms
step:904/1480 train_time:335142ms step_avg:374.88ms
step:905/1480 train_time:335471ms step_avg:374.83ms
step:906/1480 train_time:335800ms step_avg:374.78ms
step:907/1480 train_time:336119ms step_avg:374.72ms
step:908/1480 train_time:336456ms step_avg:374.67ms
step:909/1480 train_time:336779ms step_avg:374.62ms
step:910/1480 train_time:337105ms step_avg:374.56ms
step:911/1480 train_time:337438ms step_avg:374.51ms
step:912/1480 train_time:337761ms step_avg:374.46ms
step:913/1480 train_time:338083ms step_avg:374.40ms
step:914/1480 train_time:338411ms step_avg:374.35ms
step:915/1480 train_time:338735ms step_avg:374.29ms
step:916/1480 train_time:339065ms step_avg:374.24ms
step:917/1480 train_time:339388ms step_avg:374.19ms
step:918/1480 train_time:339717ms step_avg:374.14ms
step:919/1480 train_time:340047ms step_avg:374.09ms
step:920/1480 train_time:340374ms step_avg:374.04ms
step:921/1480 train_time:340704ms step_avg:373.99ms
step:922/1480 train_time:341029ms step_avg:373.94ms
step:923/1480 train_time:341354ms step_avg:373.88ms
step:924/1480 train_time:341677ms step_avg:373.83ms
step:925/1480 train_time:341998ms step_avg:373.77ms
step:926/1480 train_time:342328ms step_avg:373.72ms
step:927/1480 train_time:342653ms step_avg:373.67ms
step:928/1480 train_time:342977ms step_avg:373.61ms
step:929/1480 train_time:343298ms step_avg:373.56ms
step:930/1480 train_time:343630ms step_avg:373.51ms
step:931/1480 train_time:343951ms step_avg:373.45ms
step:932/1480 train_time:344273ms step_avg:373.40ms
step:933/1480 train_time:344598ms step_avg:373.35ms
step:934/1480 train_time:344928ms step_avg:373.30ms
step:935/1480 train_time:345250ms step_avg:373.24ms
step:936/1480 train_time:345577ms step_avg:373.19ms
step:937/1480 train_time:345916ms step_avg:373.16ms
step:938/1480 train_time:346237ms step_avg:373.10ms
step:939/1480 train_time:346560ms step_avg:373.05ms
step:940/1480 train_time:346881ms step_avg:372.99ms
step:941/1480 train_time:347212ms step_avg:372.95ms
step:942/1480 train_time:347541ms step_avg:372.90ms
step:943/1480 train_time:347874ms step_avg:372.85ms
step:944/1480 train_time:348199ms step_avg:372.80ms
step:945/1480 train_time:348526ms step_avg:372.76ms
step:946/1480 train_time:348858ms step_avg:372.71ms
step:947/1480 train_time:349181ms step_avg:372.66ms
step:948/1480 train_time:349510ms step_avg:372.61ms
step:949/1480 train_time:349837ms step_avg:372.56ms
step:950/1480 train_time:350167ms step_avg:372.52ms
step:951/1480 train_time:350489ms step_avg:372.46ms
step:952/1480 train_time:350815ms step_avg:372.41ms
step:953/1480 train_time:351135ms step_avg:372.36ms
step:954/1480 train_time:351465ms step_avg:372.32ms
step:955/1480 train_time:351797ms step_avg:372.27ms
step:956/1480 train_time:352126ms step_avg:372.23ms
step:957/1480 train_time:352444ms step_avg:372.17ms
step:958/1480 train_time:352769ms step_avg:372.12ms
step:959/1480 train_time:353103ms step_avg:372.08ms
step:960/1480 train_time:353433ms step_avg:372.03ms
step:961/1480 train_time:353755ms step_avg:371.98ms
step:962/1480 train_time:354087ms step_avg:371.94ms
step:963/1480 train_time:354414ms step_avg:371.89ms
step:964/1480 train_time:354735ms step_avg:371.84ms
step:965/1480 train_time:355061ms step_avg:371.79ms
step:966/1480 train_time:355389ms step_avg:371.75ms
step:967/1480 train_time:355712ms step_avg:371.69ms
step:968/1480 train_time:356038ms step_avg:371.65ms
step:969/1480 train_time:356356ms step_avg:371.59ms
step:970/1480 train_time:356678ms step_avg:371.54ms
step:971/1480 train_time:357009ms step_avg:371.50ms
step:972/1480 train_time:357330ms step_avg:371.45ms
step:973/1480 train_time:357663ms step_avg:371.40ms
step:974/1480 train_time:357982ms step_avg:371.35ms
step:975/1480 train_time:358308ms step_avg:371.30ms
step:976/1480 train_time:358632ms step_avg:371.26ms
step:977/1480 train_time:358959ms step_avg:371.21ms
step:978/1480 train_time:359282ms step_avg:371.16ms
step:979/1480 train_time:359604ms step_avg:371.11ms
step:980/1480 train_time:359929ms step_avg:371.06ms
step:981/1480 train_time:360250ms step_avg:371.01ms
step:982/1480 train_time:360570ms step_avg:370.96ms
step:983/1480 train_time:360889ms step_avg:370.90ms
step:984/1480 train_time:361212ms step_avg:370.85ms
step:985/1480 train_time:361548ms step_avg:370.82ms
step:986/1480 train_time:361873ms step_avg:370.77ms
step:987/1480 train_time:362198ms step_avg:370.73ms
step:988/1480 train_time:362527ms step_avg:370.68ms
step:989/1480 train_time:362849ms step_avg:370.63ms
step:990/1480 train_time:363179ms step_avg:370.59ms
step:991/1480 train_time:363515ms step_avg:370.56ms
step:992/1480 train_time:363857ms step_avg:370.53ms
step:993/1480 train_time:364180ms step_avg:370.48ms
step:994/1480 train_time:364508ms step_avg:370.44ms
step:995/1480 train_time:364856ms step_avg:370.41ms
step:996/1480 train_time:365180ms step_avg:370.36ms
step:997/1480 train_time:365505ms step_avg:370.32ms
step:998/1480 train_time:365837ms step_avg:370.28ms
step:999/1480 train_time:366161ms step_avg:370.23ms
step:1000/1480 train_time:366488ms step_avg:370.19ms
step:1000/1480 val_loss:3.4355 train_time:366504ms step_avg:370.21ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | frobenius_norm = 53074.97656 | spectral_norm = 12562.57617 | median_sv = 1482.45544 | l1_to_l2_norm = 229.20555
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 156.15533 | spectral_norm = 24.48860 | median_sv = 4.29698
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 147.95543 | spectral_norm = 31.18378 | median_sv = 3.94995
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 146.42134 | spectral_norm = 17.08308 | median_sv = 4.12289
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 149.32741 | spectral_norm = 13.19005 | median_sv = 4.22640
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 323.68954 | spectral_norm = 23.37580 | median_sv = 10.90331
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 166.63734 | spectral_norm = 15.96890 | median_sv = 5.42985
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 157.78529 | spectral_norm = 16.85847 | median_sv = 4.26136
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 156.06349 | spectral_norm = 17.36606 | median_sv = 4.15260
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 156.68344 | spectral_norm = 15.09869 | median_sv = 4.11093
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 165.71716 | spectral_norm = 13.18532 | median_sv = 4.65226
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 350.17715 | spectral_norm = 27.41472 | median_sv = 11.78838
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 180.75368 | spectral_norm = 17.83802 | median_sv = 5.91563
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 157.74261 | spectral_norm = 14.04514 | median_sv = 4.12908
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 156.17529 | spectral_norm = 14.07924 | median_sv = 4.15971
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 174.42729 | spectral_norm = 16.92546 | median_sv = 4.51707
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 177.75018 | spectral_norm = 12.30026 | median_sv = 5.28984
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 355.09998 | spectral_norm = 27.88626 | median_sv = 12.06642
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 180.24379 | spectral_norm = 16.95594 | median_sv = 5.98200
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 162.81450 | spectral_norm = 15.84221 | median_sv = 4.40704
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 159.77708 | spectral_norm = 14.64702 | median_sv = 4.33746
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 182.22061 | spectral_norm = 17.34582 | median_sv = 4.79863
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 176.56842 | spectral_norm = 12.44207 | median_sv = 5.28867
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 360.67392 | spectral_norm = 29.96717 | median_sv = 12.21682
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 179.30859 | spectral_norm = 15.84368 | median_sv = 5.89445
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 155.99829 | spectral_norm = 17.49359 | median_sv = 4.19024
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 153.37227 | spectral_norm = 16.75470 | median_sv = 4.18148
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 174.65405 | spectral_norm = 15.49971 | median_sv = 4.68010
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 173.97142 | spectral_norm = 13.66866 | median_sv = 4.94314
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 367.76981 | spectral_norm = 27.56789 | median_sv = 12.46706
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 181.94611 | spectral_norm = 16.22423 | median_sv = 5.97683
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 155.03178 | spectral_norm = 15.49172 | median_sv = 4.03729
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 154.80688 | spectral_norm = 15.22879 | median_sv = 4.05466
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 181.81900 | spectral_norm = 15.62441 | median_sv = 4.78900
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 177.66412 | spectral_norm = 12.94856 | median_sv = 5.20869
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 370.56641 | spectral_norm = 27.63255 | median_sv = 12.66416
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 180.51459 | spectral_norm = 15.42177 | median_sv = 5.94930
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 155.13774 | spectral_norm = 16.76885 | median_sv = 4.15674
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 153.22939 | spectral_norm = 16.01033 | median_sv = 4.19120
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 180.42703 | spectral_norm = 15.64144 | median_sv = 4.85962
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 174.69919 | spectral_norm = 13.77198 | median_sv = 5.00466
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 366.74899 | spectral_norm = 27.22287 | median_sv = 12.48348
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 182.70753 | spectral_norm = 15.94052 | median_sv = 6.01764
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 159.80734 | spectral_norm = 15.71417 | median_sv = 4.28020
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 157.74980 | spectral_norm = 14.75815 | median_sv = 4.28775
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 185.64471 | spectral_norm = 17.38883 | median_sv = 4.82487
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 179.64975 | spectral_norm = 13.29958 | median_sv = 5.44664
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 366.32465 | spectral_norm = 28.74307 | median_sv = 12.40066
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 183.57964 | spectral_norm = 16.27840 | median_sv = 6.06253
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 161.20143 | spectral_norm = 15.41738 | median_sv = 4.27351
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 159.82170 | spectral_norm = 14.73162 | median_sv = 4.25143
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 185.03935 | spectral_norm = 17.18670 | median_sv = 4.64348
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 179.76933 | spectral_norm = 12.89266 | median_sv = 5.30704
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 368.68457 | spectral_norm = 28.82993 | median_sv = 12.53047
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 184.52876 | spectral_norm = 17.37930 | median_sv = 6.13862
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 161.97345 | spectral_norm = 17.52873 | median_sv = 4.09754
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 162.31178 | spectral_norm = 15.76770 | median_sv = 3.97997
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 186.03487 | spectral_norm = 17.92667 | median_sv = 4.89974
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 181.21909 | spectral_norm = 12.28707 | median_sv = 5.45803
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 364.77811 | spectral_norm = 29.74769 | median_sv = 12.38467
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 183.93172 | spectral_norm = 18.91007 | median_sv = 6.17246
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 160.96870 | spectral_norm = 18.86120 | median_sv = 3.90185
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 158.15034 | spectral_norm = 17.85804 | median_sv = 3.73287
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 177.15776 | spectral_norm = 17.33780 | median_sv = 4.80227
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 181.43825 | spectral_norm = 12.39051 | median_sv = 5.34736
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 374.76718 | spectral_norm = 27.41742 | median_sv = 12.87335
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 174.82257 | spectral_norm = 21.38500 | median_sv = 5.81456
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 163.68115 | spectral_norm = 19.21772 | median_sv = 4.23471
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 159.51831 | spectral_norm = 18.49532 | median_sv = 4.11566
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 167.56218 | spectral_norm = 18.99301 | median_sv = 4.45388
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 188.89352 | spectral_norm = 13.65193 | median_sv = 5.55249
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 385.60809 | spectral_norm = 33.51766 | median_sv = 13.06430
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 182.54494 | spectral_norm = 23.14590 | median_sv = 5.98005
W name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 84095.62500 | spectral_norm = 6256.29736 | median_sv = 947.28149 | l1_to_l2_norm = 354.07684
W name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1180.00208 | spectral_norm = 174.21388 | median_sv = 36.92184
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | frobenius_norm = 0.00007 | spectral_norm = 0.00003 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 0.00086 | spectral_norm = 0.00056 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 0.00094 | spectral_norm = 0.00051 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 0.00290 | spectral_norm = 0.00260 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 0.00652 | spectral_norm = 0.00633 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 0.00466 | spectral_norm = 0.00443 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 0.00301 | spectral_norm = 0.00157 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 0.00115 | spectral_norm = 0.00104 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 0.00102 | spectral_norm = 0.00083 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 0.00675 | spectral_norm = 0.00666 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 0.00267 | spectral_norm = 0.00209 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 0.00240 | spectral_norm = 0.00203 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 0.00204 | spectral_norm = 0.00086 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 0.00235 | spectral_norm = 0.00219 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 0.00153 | spectral_norm = 0.00115 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 0.00545 | spectral_norm = 0.00532 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 0.00307 | spectral_norm = 0.00262 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 0.00312 | spectral_norm = 0.00273 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 0.00275 | spectral_norm = 0.00132 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 0.00122 | spectral_norm = 0.00106 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 0.00092 | spectral_norm = 0.00057 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 0.00487 | spectral_norm = 0.00478 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 0.00193 | spectral_norm = 0.00134 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 0.00352 | spectral_norm = 0.00301 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 0.00408 | spectral_norm = 0.00234 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 0.00074 | spectral_norm = 0.00054 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 0.00067 | spectral_norm = 0.00037 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 0.00507 | spectral_norm = 0.00488 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 0.00248 | spectral_norm = 0.00187 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 0.00356 | spectral_norm = 0.00305 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 0.00387 | spectral_norm = 0.00271 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 0.00109 | spectral_norm = 0.00083 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 0.00102 | spectral_norm = 0.00050 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 0.00538 | spectral_norm = 0.00519 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 0.00289 | spectral_norm = 0.00246 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 0.00345 | spectral_norm = 0.00294 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 0.00372 | spectral_norm = 0.00256 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 0.00102 | spectral_norm = 0.00086 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 0.00093 | spectral_norm = 0.00060 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 0.00475 | spectral_norm = 0.00454 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 0.00270 | spectral_norm = 0.00227 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 0.00303 | spectral_norm = 0.00254 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 0.00321 | spectral_norm = 0.00205 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 0.00119 | spectral_norm = 0.00103 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 0.00098 | spectral_norm = 0.00061 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 0.00396 | spectral_norm = 0.00383 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 0.00278 | spectral_norm = 0.00242 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 0.00306 | spectral_norm = 0.00256 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 0.00317 | spectral_norm = 0.00191 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 0.00191 | spectral_norm = 0.00173 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 0.00199 | spectral_norm = 0.00134 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 0.00604 | spectral_norm = 0.00590 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 0.00496 | spectral_norm = 0.00476 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 0.00342 | spectral_norm = 0.00297 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 0.00315 | spectral_norm = 0.00172 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 0.00181 | spectral_norm = 0.00160 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 0.00165 | spectral_norm = 0.00116 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 0.00318 | spectral_norm = 0.00309 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 0.00872 | spectral_norm = 0.00860 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 0.00427 | spectral_norm = 0.00395 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 0.00370 | spectral_norm = 0.00256 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 0.00217 | spectral_norm = 0.00199 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 0.00166 | spectral_norm = 0.00132 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 0.00275 | spectral_norm = 0.00271 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 0.01154 | spectral_norm = 0.01144 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 0.00749 | spectral_norm = 0.00725 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 0.00648 | spectral_norm = 0.00512 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 0.00363 | spectral_norm = 0.00350 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 0.00205 | spectral_norm = 0.00173 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 0.00459 | spectral_norm = 0.00452 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 0.01512 | spectral_norm = 0.01471 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 0.01512 | spectral_norm = 0.01456 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 0.01414 | spectral_norm = 0.01207 | median_sv = 0.00007
G name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 0.00020 | spectral_norm = 0.00017 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.13161 | spectral_norm = 0.12843 | median_sv = 0.00019
===========================================
step:1001/1480 train_time:375973ms step_avg:379.39ms
step:1002/1480 train_time:376281ms step_avg:379.32ms
step:1003/1480 train_time:376606ms step_avg:379.26ms
step:1004/1480 train_time:376934ms step_avg:379.21ms
step:1005/1480 train_time:377269ms step_avg:379.16ms
step:1006/1480 train_time:377604ms step_avg:379.12ms
step:1007/1480 train_time:377931ms step_avg:379.07ms
step:1008/1480 train_time:378259ms step_avg:379.02ms
step:1009/1480 train_time:378589ms step_avg:378.97ms
step:1010/1480 train_time:378917ms step_avg:378.92ms
step:1011/1480 train_time:379262ms step_avg:378.88ms
step:1012/1480 train_time:379591ms step_avg:378.83ms
step:1013/1480 train_time:379917ms step_avg:378.78ms
step:1014/1480 train_time:380246ms step_avg:378.73ms
step:1015/1480 train_time:380570ms step_avg:378.68ms
step:1016/1480 train_time:380894ms step_avg:378.62ms
step:1017/1480 train_time:381221ms step_avg:378.57ms
step:1018/1480 train_time:381560ms step_avg:378.53ms
step:1019/1480 train_time:381892ms step_avg:378.49ms
step:1020/1480 train_time:382214ms step_avg:378.43ms
step:1021/1480 train_time:382539ms step_avg:378.38ms
step:1022/1480 train_time:382866ms step_avg:378.33ms
step:1023/1480 train_time:383192ms step_avg:378.27ms
step:1024/1480 train_time:383520ms step_avg:378.22ms
step:1025/1480 train_time:383850ms step_avg:378.18ms
step:1026/1480 train_time:384178ms step_avg:378.13ms
step:1027/1480 train_time:384511ms step_avg:378.08ms
step:1028/1480 train_time:384837ms step_avg:378.03ms
step:1029/1480 train_time:385164ms step_avg:377.98ms
step:1030/1480 train_time:385509ms step_avg:377.95ms
step:1031/1480 train_time:385845ms step_avg:377.91ms
step:1032/1480 train_time:386169ms step_avg:377.86ms
step:1033/1480 train_time:386496ms step_avg:377.81ms
step:1034/1480 train_time:386832ms step_avg:377.77ms
step:1035/1480 train_time:387162ms step_avg:377.72ms
step:1036/1480 train_time:387497ms step_avg:377.68ms
step:1037/1480 train_time:387833ms step_avg:377.64ms
step:1038/1480 train_time:388160ms step_avg:377.59ms
step:1039/1480 train_time:388487ms step_avg:377.54ms
step:1040/1480 train_time:388810ms step_avg:377.49ms
step:1041/1480 train_time:389136ms step_avg:377.44ms
step:1042/1480 train_time:389464ms step_avg:377.39ms
step:1043/1480 train_time:389797ms step_avg:377.34ms
step:1044/1480 train_time:390129ms step_avg:377.30ms
step:1045/1480 train_time:390457ms step_avg:377.25ms
step:1046/1480 train_time:390784ms step_avg:377.20ms
step:1047/1480 train_time:391114ms step_avg:377.16ms
step:1048/1480 train_time:391443ms step_avg:377.11ms
step:1049/1480 train_time:391778ms step_avg:377.07ms
step:1050/1480 train_time:392110ms step_avg:377.03ms
step:1051/1480 train_time:392438ms step_avg:376.98ms
step:1052/1480 train_time:392763ms step_avg:376.93ms
step:1053/1480 train_time:393091ms step_avg:376.88ms
step:1054/1480 train_time:393418ms step_avg:376.84ms
step:1055/1480 train_time:393741ms step_avg:376.79ms
step:1056/1480 train_time:394076ms step_avg:376.75ms
step:1057/1480 train_time:394402ms step_avg:376.70ms
step:1058/1480 train_time:394735ms step_avg:376.66ms
step:1059/1480 train_time:395063ms step_avg:376.61ms
step:1060/1480 train_time:395398ms step_avg:376.57ms
step:1061/1480 train_time:395734ms step_avg:376.53ms
step:1062/1480 train_time:396059ms step_avg:376.48ms
step:1063/1480 train_time:396386ms step_avg:376.44ms
step:1064/1480 train_time:396713ms step_avg:376.39ms
step:1065/1480 train_time:397038ms step_avg:376.34ms
step:1066/1480 train_time:397360ms step_avg:376.29ms
step:1067/1480 train_time:397690ms step_avg:376.24ms
step:1068/1480 train_time:398021ms step_avg:376.20ms
step:1069/1480 train_time:398357ms step_avg:376.16ms
step:1070/1480 train_time:398678ms step_avg:376.11ms
step:1071/1480 train_time:399018ms step_avg:376.08ms
step:1072/1480 train_time:399342ms step_avg:376.03ms
step:1073/1480 train_time:399680ms step_avg:375.99ms
step:1074/1480 train_time:400008ms step_avg:375.95ms
step:1075/1480 train_time:400332ms step_avg:375.90ms
step:1076/1480 train_time:400664ms step_avg:375.86ms
step:1077/1480 train_time:400991ms step_avg:375.81ms
step:1078/1480 train_time:401315ms step_avg:375.76ms
step:1079/1480 train_time:401641ms step_avg:375.72ms
step:1080/1480 train_time:401991ms step_avg:375.69ms
step:1081/1480 train_time:402315ms step_avg:375.64ms
step:1082/1480 train_time:402650ms step_avg:375.61ms
step:1083/1480 train_time:402986ms step_avg:375.57ms
step:1084/1480 train_time:403318ms step_avg:375.53ms
step:1085/1480 train_time:403644ms step_avg:375.48ms
step:1086/1480 train_time:403972ms step_avg:375.44ms
step:1087/1480 train_time:404303ms step_avg:375.40ms
step:1088/1480 train_time:404639ms step_avg:375.36ms
step:1089/1480 train_time:404976ms step_avg:375.33ms
step:1090/1480 train_time:405304ms step_avg:375.28ms
step:1091/1480 train_time:405637ms step_avg:375.24ms
step:1092/1480 train_time:405966ms step_avg:375.20ms
step:1093/1480 train_time:406296ms step_avg:375.16ms
step:1094/1480 train_time:406618ms step_avg:375.11ms
step:1095/1480 train_time:406943ms step_avg:375.06ms
step:1096/1480 train_time:407272ms step_avg:375.02ms
step:1097/1480 train_time:407599ms step_avg:374.98ms
step:1098/1480 train_time:407937ms step_avg:374.94ms
step:1099/1480 train_time:408262ms step_avg:374.90ms
step:1100/1480 train_time:408601ms step_avg:374.86ms
step:1101/1480 train_time:408942ms step_avg:374.83ms
step:1102/1480 train_time:409279ms step_avg:374.80ms
step:1103/1480 train_time:409614ms step_avg:374.76ms
step:1104/1480 train_time:409954ms step_avg:374.73ms
step:1105/1480 train_time:410291ms step_avg:374.70ms
step:1106/1480 train_time:410621ms step_avg:374.65ms
step:1107/1480 train_time:410963ms step_avg:374.62ms
step:1108/1480 train_time:411295ms step_avg:374.59ms
step:1109/1480 train_time:411629ms step_avg:374.55ms
step:1110/1480 train_time:411957ms step_avg:374.51ms
step:1111/1480 train_time:412282ms step_avg:374.46ms
step:1112/1480 train_time:412611ms step_avg:374.42ms
step:1113/1480 train_time:412949ms step_avg:374.39ms
step:1114/1480 train_time:413281ms step_avg:374.35ms
step:1115/1480 train_time:413608ms step_avg:374.31ms
step:1116/1480 train_time:413942ms step_avg:374.27ms
step:1117/1480 train_time:414284ms step_avg:374.24ms
step:1118/1480 train_time:414617ms step_avg:374.20ms
step:1119/1480 train_time:414959ms step_avg:374.17ms
step:1120/1480 train_time:415290ms step_avg:374.14ms
step:1121/1480 train_time:415620ms step_avg:374.10ms
step:1122/1480 train_time:415953ms step_avg:374.06ms
step:1123/1480 train_time:416281ms step_avg:374.02ms
step:1124/1480 train_time:416604ms step_avg:373.97ms
step:1125/1480 train_time:416933ms step_avg:373.93ms
step:1125/1480 val_loss:3.3822 train_time:416957ms step_avg:373.95ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | frobenius_norm = 54055.39844 | spectral_norm = 12771.73047 | median_sv = 1508.39624 | l1_to_l2_norm = 233.30409
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 161.82454 | spectral_norm = 26.09951 | median_sv = 4.42228
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 153.17065 | spectral_norm = 32.91600 | median_sv = 4.08013
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 151.29427 | spectral_norm = 18.21806 | median_sv = 4.24146
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 154.63229 | spectral_norm = 13.82618 | median_sv = 4.38413
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 336.23495 | spectral_norm = 24.25832 | median_sv = 11.32684
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 173.03894 | spectral_norm = 16.73779 | median_sv = 5.63458
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 163.90411 | spectral_norm = 17.74092 | median_sv = 4.39272
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 162.16431 | spectral_norm = 18.27285 | median_sv = 4.30228
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 163.08681 | spectral_norm = 15.86901 | median_sv = 4.29084
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 172.39728 | spectral_norm = 13.78613 | median_sv = 4.84563
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 364.13422 | spectral_norm = 28.98181 | median_sv = 12.25212
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 187.93329 | spectral_norm = 18.70342 | median_sv = 6.15911
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 163.56151 | spectral_norm = 14.70677 | median_sv = 4.27718
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 162.01192 | spectral_norm = 14.78645 | median_sv = 4.29948
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 182.05775 | spectral_norm = 17.67463 | median_sv = 4.68907
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 184.91476 | spectral_norm = 12.86059 | median_sv = 5.53325
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 368.71042 | spectral_norm = 29.39309 | median_sv = 12.50743
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 187.34372 | spectral_norm = 17.73797 | median_sv = 6.21868
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 169.01065 | spectral_norm = 16.61286 | median_sv = 4.54134
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 165.88513 | spectral_norm = 15.22358 | median_sv = 4.49890
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 189.81529 | spectral_norm = 17.91766 | median_sv = 4.98645
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 183.70547 | spectral_norm = 12.82400 | median_sv = 5.50931
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 374.76221 | spectral_norm = 31.61291 | median_sv = 12.71240
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 186.46330 | spectral_norm = 16.64403 | median_sv = 6.12927
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 161.93759 | spectral_norm = 18.49388 | median_sv = 4.31620
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 159.13243 | spectral_norm = 17.59555 | median_sv = 4.32488
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 182.47632 | spectral_norm = 16.23414 | median_sv = 4.93217
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 181.64920 | spectral_norm = 14.26652 | median_sv = 5.19038
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 381.56644 | spectral_norm = 28.91700 | median_sv = 12.94310
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 189.12541 | spectral_norm = 16.98414 | median_sv = 6.21982
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 160.74928 | spectral_norm = 16.26727 | median_sv = 4.16786
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 160.66013 | spectral_norm = 15.85255 | median_sv = 4.18937
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 190.02068 | spectral_norm = 16.33027 | median_sv = 5.02983
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 185.37280 | spectral_norm = 13.41129 | median_sv = 5.44231
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 384.29541 | spectral_norm = 28.94709 | median_sv = 13.13107
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 187.58885 | spectral_norm = 16.15077 | median_sv = 6.19226
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 160.99257 | spectral_norm = 17.55549 | median_sv = 4.28178
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 159.06303 | spectral_norm = 16.81645 | median_sv = 4.34095
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 188.48433 | spectral_norm = 16.23685 | median_sv = 5.12244
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 182.24692 | spectral_norm = 14.43694 | median_sv = 5.22239
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 380.40268 | spectral_norm = 28.30105 | median_sv = 12.95238
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 189.88373 | spectral_norm = 16.84266 | median_sv = 6.25377
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 165.88336 | spectral_norm = 16.45439 | median_sv = 4.41159
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 163.76884 | spectral_norm = 15.48007 | median_sv = 4.41051
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 193.36588 | spectral_norm = 18.02522 | median_sv = 5.02438
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 187.11438 | spectral_norm = 13.73245 | median_sv = 5.66562
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 380.39865 | spectral_norm = 29.80554 | median_sv = 12.87396
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 190.97931 | spectral_norm = 17.03199 | median_sv = 6.30754
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 167.30783 | spectral_norm = 16.24941 | median_sv = 4.38756
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 165.86281 | spectral_norm = 15.51138 | median_sv = 4.38642
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 193.12280 | spectral_norm = 17.94139 | median_sv = 4.83552
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 187.07812 | spectral_norm = 13.49689 | median_sv = 5.53526
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 382.68988 | spectral_norm = 30.07677 | median_sv = 12.99302
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 191.84601 | spectral_norm = 18.20721 | median_sv = 6.38833
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 168.10400 | spectral_norm = 18.42895 | median_sv = 4.22441
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 168.57814 | spectral_norm = 16.54731 | median_sv = 4.07682
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 194.41208 | spectral_norm = 18.97020 | median_sv = 5.09966
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 187.99174 | spectral_norm = 12.84961 | median_sv = 5.65121
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 378.01688 | spectral_norm = 31.37974 | median_sv = 12.82285
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 191.34709 | spectral_norm = 19.88124 | median_sv = 6.43150
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 166.68225 | spectral_norm = 19.87885 | median_sv = 3.99312
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 163.84254 | spectral_norm = 18.85711 | median_sv = 3.80705
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 185.54701 | spectral_norm = 18.28448 | median_sv = 5.01322
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 188.36537 | spectral_norm = 12.87933 | median_sv = 5.53543
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 388.16553 | spectral_norm = 28.79479 | median_sv = 13.32570
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 181.87811 | spectral_norm = 22.54846 | median_sv = 6.04295
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 169.67044 | spectral_norm = 20.33927 | median_sv = 4.33338
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 165.34386 | spectral_norm = 19.58188 | median_sv = 4.23992
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 175.70709 | spectral_norm = 20.13939 | median_sv = 4.66791
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 196.25354 | spectral_norm = 14.18808 | median_sv = 5.75942
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 398.93481 | spectral_norm = 34.88141 | median_sv = 13.49815
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 189.63617 | spectral_norm = 24.45152 | median_sv = 6.20123
W name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 86013.89062 | spectral_norm = 6321.52295 | median_sv = 971.91437 | l1_to_l2_norm = 362.13217
W name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1213.36292 | spectral_norm = 172.92108 | median_sv = 38.15343
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | frobenius_norm = 0.00006 | spectral_norm = 0.00002 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 0.00072 | spectral_norm = 0.00033 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 0.00075 | spectral_norm = 0.00030 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 0.00226 | spectral_norm = 0.00198 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 0.00551 | spectral_norm = 0.00529 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 0.00455 | spectral_norm = 0.00431 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 0.00281 | spectral_norm = 0.00119 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 0.00103 | spectral_norm = 0.00090 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 0.00095 | spectral_norm = 0.00073 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 0.00615 | spectral_norm = 0.00605 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 0.00256 | spectral_norm = 0.00196 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 0.00257 | spectral_norm = 0.00219 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 0.00214 | spectral_norm = 0.00088 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 0.00226 | spectral_norm = 0.00211 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 0.00147 | spectral_norm = 0.00105 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 0.00561 | spectral_norm = 0.00547 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 0.00309 | spectral_norm = 0.00262 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 0.00326 | spectral_norm = 0.00284 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 0.00287 | spectral_norm = 0.00134 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 0.00106 | spectral_norm = 0.00086 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 0.00090 | spectral_norm = 0.00052 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 0.00481 | spectral_norm = 0.00471 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 0.00195 | spectral_norm = 0.00133 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 0.00360 | spectral_norm = 0.00307 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 0.00391 | spectral_norm = 0.00207 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 0.00074 | spectral_norm = 0.00053 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 0.00067 | spectral_norm = 0.00034 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 0.00511 | spectral_norm = 0.00490 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 0.00250 | spectral_norm = 0.00188 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 0.00331 | spectral_norm = 0.00273 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 0.00378 | spectral_norm = 0.00239 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 0.00114 | spectral_norm = 0.00086 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 0.00110 | spectral_norm = 0.00051 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 0.00516 | spectral_norm = 0.00495 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 0.00283 | spectral_norm = 0.00234 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 0.00358 | spectral_norm = 0.00303 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 0.00368 | spectral_norm = 0.00229 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 0.00086 | spectral_norm = 0.00065 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 0.00075 | spectral_norm = 0.00037 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 0.00462 | spectral_norm = 0.00439 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 0.00263 | spectral_norm = 0.00213 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 0.00315 | spectral_norm = 0.00261 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 0.00326 | spectral_norm = 0.00187 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 0.00122 | spectral_norm = 0.00104 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 0.00093 | spectral_norm = 0.00056 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 0.00359 | spectral_norm = 0.00343 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 0.00257 | spectral_norm = 0.00212 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 0.00317 | spectral_norm = 0.00263 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 0.00316 | spectral_norm = 0.00167 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 0.00174 | spectral_norm = 0.00155 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 0.00162 | spectral_norm = 0.00099 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 0.00537 | spectral_norm = 0.00520 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 0.00451 | spectral_norm = 0.00427 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 0.00372 | spectral_norm = 0.00326 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 0.00317 | spectral_norm = 0.00156 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 0.00232 | spectral_norm = 0.00214 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 0.00177 | spectral_norm = 0.00124 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 0.00324 | spectral_norm = 0.00313 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 0.00797 | spectral_norm = 0.00780 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 0.00440 | spectral_norm = 0.00405 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 0.00343 | spectral_norm = 0.00208 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 0.00235 | spectral_norm = 0.00218 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 0.00168 | spectral_norm = 0.00133 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 0.00258 | spectral_norm = 0.00253 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 0.01007 | spectral_norm = 0.00992 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 0.00749 | spectral_norm = 0.00721 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 0.00611 | spectral_norm = 0.00483 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 0.00309 | spectral_norm = 0.00294 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 0.00194 | spectral_norm = 0.00156 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 0.00368 | spectral_norm = 0.00362 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 0.01383 | spectral_norm = 0.01353 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 0.01216 | spectral_norm = 0.01184 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 0.01334 | spectral_norm = 0.01173 | median_sv = 0.00007
G name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 0.00018 | spectral_norm = 0.00014 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.11862 | spectral_norm = 0.11563 | median_sv = 0.00019
===========================================
step:1126/1480 train_time:426466ms step_avg:382.14ms
step:1127/1480 train_time:426790ms step_avg:382.09ms
step:1128/1480 train_time:427121ms step_avg:382.04ms
step:1129/1480 train_time:427454ms step_avg:382.00ms
step:1130/1480 train_time:427788ms step_avg:381.95ms
step:1131/1480 train_time:428124ms step_avg:381.91ms
step:1132/1480 train_time:428453ms step_avg:381.87ms
step:1133/1480 train_time:428786ms step_avg:381.82ms
step:1134/1480 train_time:429111ms step_avg:381.77ms
step:1135/1480 train_time:429457ms step_avg:381.74ms
step:1136/1480 train_time:429788ms step_avg:381.69ms
step:1137/1480 train_time:430119ms step_avg:381.65ms
step:1138/1480 train_time:430458ms step_avg:381.61ms
step:1139/1480 train_time:430790ms step_avg:381.57ms
step:1140/1480 train_time:431127ms step_avg:381.53ms
step:1141/1480 train_time:431461ms step_avg:381.49ms
step:1142/1480 train_time:431790ms step_avg:381.44ms
step:1143/1480 train_time:432123ms step_avg:381.40ms
step:1144/1480 train_time:432447ms step_avg:381.35ms
step:1145/1480 train_time:432786ms step_avg:381.31ms
step:1146/1480 train_time:433121ms step_avg:381.27ms
step:1147/1480 train_time:433454ms step_avg:381.23ms
step:1148/1480 train_time:433783ms step_avg:381.18ms
step:1149/1480 train_time:434109ms step_avg:381.13ms
step:1150/1480 train_time:434441ms step_avg:381.09ms
step:1151/1480 train_time:434775ms step_avg:381.05ms
step:1152/1480 train_time:435110ms step_avg:381.01ms
step:1153/1480 train_time:435452ms step_avg:380.97ms
step:1154/1480 train_time:435785ms step_avg:380.93ms
step:1155/1480 train_time:436122ms step_avg:380.89ms
step:1156/1480 train_time:436454ms step_avg:380.85ms
step:1157/1480 train_time:436778ms step_avg:380.80ms
step:1158/1480 train_time:437122ms step_avg:380.77ms
step:1159/1480 train_time:437462ms step_avg:380.73ms
step:1160/1480 train_time:437791ms step_avg:380.69ms
step:1161/1480 train_time:438121ms step_avg:380.64ms
step:1162/1480 train_time:438445ms step_avg:380.59ms
step:1163/1480 train_time:438776ms step_avg:380.55ms
step:1164/1480 train_time:439113ms step_avg:380.51ms
step:1165/1480 train_time:439444ms step_avg:380.47ms
step:1166/1480 train_time:439781ms step_avg:380.43ms
step:1167/1480 train_time:440110ms step_avg:380.39ms
step:1168/1480 train_time:440436ms step_avg:380.34ms
step:1169/1480 train_time:440767ms step_avg:380.30ms
step:1170/1480 train_time:441103ms step_avg:380.26ms
step:1171/1480 train_time:441431ms step_avg:380.22ms
step:1172/1480 train_time:441765ms step_avg:380.18ms
step:1173/1480 train_time:442102ms step_avg:380.14ms
step:1174/1480 train_time:442429ms step_avg:380.09ms
step:1175/1480 train_time:442757ms step_avg:380.05ms
step:1176/1480 train_time:443109ms step_avg:380.03ms
step:1177/1480 train_time:443444ms step_avg:379.99ms
step:1178/1480 train_time:443780ms step_avg:379.95ms
step:1179/1480 train_time:444123ms step_avg:379.92ms
step:1180/1480 train_time:444465ms step_avg:379.88ms
step:1181/1480 train_time:444798ms step_avg:379.84ms
step:1182/1480 train_time:445129ms step_avg:379.80ms
step:1183/1480 train_time:445466ms step_avg:379.77ms
step:1184/1480 train_time:445796ms step_avg:379.72ms
step:1185/1480 train_time:446131ms step_avg:379.69ms
step:1186/1480 train_time:446467ms step_avg:379.65ms
step:1187/1480 train_time:446800ms step_avg:379.61ms
step:1188/1480 train_time:447136ms step_avg:379.57ms
step:1189/1480 train_time:447488ms step_avg:379.55ms
step:1190/1480 train_time:447828ms step_avg:379.52ms
step:1191/1480 train_time:448163ms step_avg:379.48ms
step:1192/1480 train_time:448496ms step_avg:379.44ms
step:1193/1480 train_time:448826ms step_avg:379.40ms
step:1194/1480 train_time:449157ms step_avg:379.36ms
step:1195/1480 train_time:449483ms step_avg:379.31ms
step:1196/1480 train_time:449818ms step_avg:379.27ms
step:1197/1480 train_time:450157ms step_avg:379.24ms
step:1198/1480 train_time:450489ms step_avg:379.20ms
step:1199/1480 train_time:450818ms step_avg:379.16ms
step:1200/1480 train_time:451154ms step_avg:379.12ms
step:1201/1480 train_time:451513ms step_avg:379.10ms
step:1202/1480 train_time:451857ms step_avg:379.07ms
step:1203/1480 train_time:452184ms step_avg:379.03ms
step:1204/1480 train_time:452524ms step_avg:379.00ms
step:1205/1480 train_time:452868ms step_avg:378.97ms
step:1206/1480 train_time:453200ms step_avg:378.93ms
step:1207/1480 train_time:453540ms step_avg:378.90ms
step:1208/1480 train_time:453876ms step_avg:378.86ms
step:1209/1480 train_time:454215ms step_avg:378.83ms
step:1210/1480 train_time:454553ms step_avg:378.79ms
step:1211/1480 train_time:454884ms step_avg:378.75ms
step:1212/1480 train_time:455237ms step_avg:378.73ms
step:1213/1480 train_time:455569ms step_avg:378.69ms
step:1214/1480 train_time:455906ms step_avg:378.66ms
step:1215/1480 train_time:456242ms step_avg:378.62ms
step:1216/1480 train_time:456584ms step_avg:378.59ms
step:1217/1480 train_time:456926ms step_avg:378.56ms
step:1218/1480 train_time:457254ms step_avg:378.52ms
step:1219/1480 train_time:457589ms step_avg:378.49ms
step:1220/1480 train_time:457922ms step_avg:378.45ms
step:1221/1480 train_time:458255ms step_avg:378.41ms
step:1222/1480 train_time:458589ms step_avg:378.37ms
step:1223/1480 train_time:458920ms step_avg:378.33ms
step:1224/1480 train_time:459262ms step_avg:378.31ms
step:1225/1480 train_time:459612ms step_avg:378.28ms
step:1226/1480 train_time:459950ms step_avg:378.25ms
step:1227/1480 train_time:460292ms step_avg:378.22ms
step:1228/1480 train_time:460616ms step_avg:378.17ms
step:1229/1480 train_time:460956ms step_avg:378.14ms
step:1230/1480 train_time:461287ms step_avg:378.10ms
step:1231/1480 train_time:461621ms step_avg:378.07ms
step:1232/1480 train_time:461984ms step_avg:378.06ms
step:1233/1480 train_time:462325ms step_avg:378.03ms
step:1234/1480 train_time:462659ms step_avg:377.99ms
step:1235/1480 train_time:462989ms step_avg:377.95ms
step:1236/1480 train_time:463320ms step_avg:377.91ms
step:1237/1480 train_time:463660ms step_avg:377.88ms
step:1238/1480 train_time:463999ms step_avg:377.85ms
step:1239/1480 train_time:464334ms step_avg:377.81ms
step:1240/1480 train_time:464669ms step_avg:377.78ms
step:1241/1480 train_time:465019ms step_avg:377.76ms
step:1242/1480 train_time:465364ms step_avg:377.73ms
step:1243/1480 train_time:465699ms step_avg:377.70ms
step:1244/1480 train_time:466029ms step_avg:377.66ms
step:1245/1480 train_time:466362ms step_avg:377.62ms
step:1246/1480 train_time:466696ms step_avg:377.59ms
step:1247/1480 train_time:467027ms step_avg:377.55ms
step:1248/1480 train_time:467359ms step_avg:377.51ms
step:1249/1480 train_time:467692ms step_avg:377.48ms
step:1250/1480 train_time:468026ms step_avg:377.44ms
step:1250/1480 val_loss:3.3320 train_time:468042ms step_avg:377.45ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | frobenius_norm = 54466.69141 | spectral_norm = 12863.65430 | median_sv = 1521.92078 | l1_to_l2_norm = 235.01216
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 164.45009 | spectral_norm = 27.11458 | median_sv = 4.47560
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 155.74841 | spectral_norm = 33.92037 | median_sv = 4.12080
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 153.87102 | spectral_norm = 18.85859 | median_sv = 4.29854
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 157.50433 | spectral_norm = 14.17790 | median_sv = 4.46555
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 342.64774 | spectral_norm = 24.70792 | median_sv = 11.56065
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 176.27263 | spectral_norm = 17.12288 | median_sv = 5.75949
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 166.79195 | spectral_norm = 18.24993 | median_sv = 4.44609
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 165.21216 | spectral_norm = 18.69255 | median_sv = 4.35149
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 166.61299 | spectral_norm = 16.30542 | median_sv = 4.37117
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 176.06107 | spectral_norm = 14.08730 | median_sv = 4.93896
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 371.25430 | spectral_norm = 29.68575 | median_sv = 12.47185
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 191.58090 | spectral_norm = 19.16122 | median_sv = 6.27794
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 166.41415 | spectral_norm = 15.03634 | median_sv = 4.33181
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 164.93416 | spectral_norm = 15.16967 | median_sv = 4.36046
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 186.25363 | spectral_norm = 18.10850 | median_sv = 4.80729
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 188.76468 | spectral_norm = 13.15349 | median_sv = 5.65913
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 375.66071 | spectral_norm = 30.19626 | median_sv = 12.74423
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 190.93832 | spectral_norm = 18.09994 | median_sv = 6.34379
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 172.10301 | spectral_norm = 16.96030 | median_sv = 4.61368
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 168.99710 | spectral_norm = 15.52908 | median_sv = 4.56379
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 193.92424 | spectral_norm = 18.22196 | median_sv = 5.10177
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 187.51825 | spectral_norm = 12.98990 | median_sv = 5.66917
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 382.03748 | spectral_norm = 32.44384 | median_sv = 12.93337
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 190.15826 | spectral_norm = 17.06732 | median_sv = 6.25331
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 164.95291 | spectral_norm = 19.02948 | median_sv = 4.37878
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 162.07657 | spectral_norm = 18.09456 | median_sv = 4.39470
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 186.85010 | spectral_norm = 16.64096 | median_sv = 5.06223
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 185.92700 | spectral_norm = 14.59842 | median_sv = 5.32988
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 388.51401 | spectral_norm = 29.68039 | median_sv = 13.18557
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 192.75078 | spectral_norm = 17.41485 | median_sv = 6.34866
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 163.50462 | spectral_norm = 16.72041 | median_sv = 4.20418
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 163.48877 | spectral_norm = 16.18660 | median_sv = 4.25564
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 194.58154 | spectral_norm = 16.74618 | median_sv = 5.15570
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 189.64890 | spectral_norm = 13.69904 | median_sv = 5.60024
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 391.28400 | spectral_norm = 29.68989 | median_sv = 13.40101
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 191.18512 | spectral_norm = 16.52764 | median_sv = 6.32433
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 163.91399 | spectral_norm = 18.03495 | median_sv = 4.32995
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 161.97585 | spectral_norm = 17.25897 | median_sv = 4.40542
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 192.96008 | spectral_norm = 16.60966 | median_sv = 5.26352
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 186.42081 | spectral_norm = 14.67128 | median_sv = 5.36951
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 387.29355 | spectral_norm = 28.82011 | median_sv = 13.20105
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 193.50449 | spectral_norm = 17.28490 | median_sv = 6.37272
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 168.96147 | spectral_norm = 17.00349 | median_sv = 4.46757
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 166.81642 | spectral_norm = 15.89144 | median_sv = 4.47449
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 197.58806 | spectral_norm = 18.30303 | median_sv = 5.12426
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 191.10298 | spectral_norm = 13.97506 | median_sv = 5.80450
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 387.45398 | spectral_norm = 30.33412 | median_sv = 13.13135
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 194.67447 | spectral_norm = 17.41293 | median_sv = 6.42051
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 170.24687 | spectral_norm = 16.74209 | median_sv = 4.44714
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 168.82378 | spectral_norm = 15.87191 | median_sv = 4.43982
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 197.64087 | spectral_norm = 18.44348 | median_sv = 4.93689
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 190.92740 | spectral_norm = 13.89273 | median_sv = 5.65535
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 389.80136 | spectral_norm = 30.71319 | median_sv = 13.23116
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 195.48424 | spectral_norm = 18.64616 | median_sv = 6.51343
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 171.06761 | spectral_norm = 18.93056 | median_sv = 4.26180
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 171.65486 | spectral_norm = 16.88294 | median_sv = 4.10211
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 199.13850 | spectral_norm = 19.63671 | median_sv = 5.20730
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 191.47505 | spectral_norm = 13.07628 | median_sv = 5.75697
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 384.58081 | spectral_norm = 32.30202 | median_sv = 13.02886
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 195.10902 | spectral_norm = 20.34289 | median_sv = 6.55942
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 169.37158 | spectral_norm = 20.57244 | median_sv = 3.99674
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 166.55750 | spectral_norm = 19.32183 | median_sv = 3.83048
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 190.32893 | spectral_norm = 18.80603 | median_sv = 5.13977
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 191.91101 | spectral_norm = 13.11386 | median_sv = 5.63915
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 394.19846 | spectral_norm = 29.47524 | median_sv = 13.52895
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 185.55911 | spectral_norm = 23.08534 | median_sv = 6.17435
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 172.45970 | spectral_norm = 21.04405 | median_sv = 4.37028
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 168.01050 | spectral_norm = 20.18630 | median_sv = 4.25575
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 180.28403 | spectral_norm = 20.81142 | median_sv = 4.78819
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 200.17140 | spectral_norm = 14.54041 | median_sv = 5.88459
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 404.76437 | spectral_norm = 35.54537 | median_sv = 13.69516
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 193.14211 | spectral_norm = 25.04965 | median_sv = 6.30991
W name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 86858.90625 | spectral_norm = 6344.47900 | median_sv = 983.04944 | l1_to_l2_norm = 365.71484
W name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1225.88086 | spectral_norm = 170.80339 | median_sv = 38.68065
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | frobenius_norm = 0.00006 | spectral_norm = 0.00002 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 0.00067 | spectral_norm = 0.00030 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 0.00071 | spectral_norm = 0.00031 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 0.00186 | spectral_norm = 0.00156 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 0.00474 | spectral_norm = 0.00451 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 0.00413 | spectral_norm = 0.00389 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 0.00254 | spectral_norm = 0.00093 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 0.00099 | spectral_norm = 0.00087 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 0.00089 | spectral_norm = 0.00071 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 0.00453 | spectral_norm = 0.00442 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 0.00199 | spectral_norm = 0.00130 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 0.00220 | spectral_norm = 0.00181 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 0.00189 | spectral_norm = 0.00057 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 0.00128 | spectral_norm = 0.00104 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 0.00126 | spectral_norm = 0.00095 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 0.00355 | spectral_norm = 0.00338 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 0.00225 | spectral_norm = 0.00171 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 0.00266 | spectral_norm = 0.00221 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 0.00247 | spectral_norm = 0.00087 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 0.00093 | spectral_norm = 0.00074 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 0.00079 | spectral_norm = 0.00046 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 0.00346 | spectral_norm = 0.00335 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 0.00155 | spectral_norm = 0.00086 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 0.00281 | spectral_norm = 0.00222 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 0.00327 | spectral_norm = 0.00139 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 0.00065 | spectral_norm = 0.00045 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 0.00057 | spectral_norm = 0.00028 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 0.00338 | spectral_norm = 0.00314 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 0.00192 | spectral_norm = 0.00120 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 0.00262 | spectral_norm = 0.00198 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 0.00305 | spectral_norm = 0.00151 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 0.00089 | spectral_norm = 0.00058 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 0.00087 | spectral_norm = 0.00037 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 0.00314 | spectral_norm = 0.00287 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 0.00199 | spectral_norm = 0.00140 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 0.00261 | spectral_norm = 0.00199 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 0.00291 | spectral_norm = 0.00134 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 0.00067 | spectral_norm = 0.00045 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 0.00061 | spectral_norm = 0.00030 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 0.00277 | spectral_norm = 0.00249 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 0.00188 | spectral_norm = 0.00129 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 0.00234 | spectral_norm = 0.00172 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 0.00264 | spectral_norm = 0.00110 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 0.00072 | spectral_norm = 0.00045 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 0.00067 | spectral_norm = 0.00032 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 0.00228 | spectral_norm = 0.00208 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 0.00186 | spectral_norm = 0.00132 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 0.00244 | spectral_norm = 0.00182 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 0.00264 | spectral_norm = 0.00100 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 0.00108 | spectral_norm = 0.00084 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 0.00122 | spectral_norm = 0.00077 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 0.00314 | spectral_norm = 0.00293 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 0.00288 | spectral_norm = 0.00254 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 0.00287 | spectral_norm = 0.00235 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 0.00271 | spectral_norm = 0.00092 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 0.00150 | spectral_norm = 0.00127 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 0.00138 | spectral_norm = 0.00093 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 0.00233 | spectral_norm = 0.00222 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 0.00471 | spectral_norm = 0.00448 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 0.00350 | spectral_norm = 0.00312 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 0.00284 | spectral_norm = 0.00122 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 0.00190 | spectral_norm = 0.00171 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 0.00145 | spectral_norm = 0.00112 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 0.00181 | spectral_norm = 0.00176 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 0.00567 | spectral_norm = 0.00546 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 0.00539 | spectral_norm = 0.00509 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 0.00429 | spectral_norm = 0.00277 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 0.00276 | spectral_norm = 0.00264 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 0.00160 | spectral_norm = 0.00136 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 0.00260 | spectral_norm = 0.00253 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 0.00702 | spectral_norm = 0.00660 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 0.00818 | spectral_norm = 0.00777 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 0.00871 | spectral_norm = 0.00670 | median_sv = 0.00007
G name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 0.00015 | spectral_norm = 0.00012 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.06057 | spectral_norm = 0.05771 | median_sv = 0.00019
===========================================
step:1251/1480 train_time:477501ms step_avg:384.77ms
step:1252/1480 train_time:477823ms step_avg:384.72ms
step:1253/1480 train_time:478157ms step_avg:384.68ms
step:1254/1480 train_time:478508ms step_avg:384.65ms
step:1255/1480 train_time:478841ms step_avg:384.61ms
step:1256/1480 train_time:479168ms step_avg:384.56ms
step:1257/1480 train_time:479507ms step_avg:384.53ms
step:1258/1480 train_time:479846ms step_avg:384.49ms
step:1259/1480 train_time:480184ms step_avg:384.45ms
step:1260/1480 train_time:480515ms step_avg:384.41ms
step:1261/1480 train_time:480862ms step_avg:384.38ms
step:1262/1480 train_time:481195ms step_avg:384.34ms
step:1263/1480 train_time:481530ms step_avg:384.30ms
step:1264/1480 train_time:481872ms step_avg:384.27ms
step:1265/1480 train_time:482208ms step_avg:384.23ms
step:1266/1480 train_time:482547ms step_avg:384.19ms
step:1267/1480 train_time:482884ms step_avg:384.16ms
step:1268/1480 train_time:483226ms step_avg:384.12ms
step:1269/1480 train_time:483564ms step_avg:384.09ms
step:1270/1480 train_time:483899ms step_avg:384.05ms
step:1271/1480 train_time:484229ms step_avg:384.00ms
step:1272/1480 train_time:484574ms step_avg:383.97ms
step:1273/1480 train_time:484904ms step_avg:383.93ms
step:1274/1480 train_time:485238ms step_avg:383.89ms
step:1275/1480 train_time:485565ms step_avg:383.85ms
step:1276/1480 train_time:485896ms step_avg:383.80ms
step:1277/1480 train_time:486228ms step_avg:383.76ms
step:1278/1480 train_time:486559ms step_avg:383.72ms
step:1279/1480 train_time:486899ms step_avg:383.69ms
step:1280/1480 train_time:487245ms step_avg:383.66ms
step:1281/1480 train_time:487572ms step_avg:383.61ms
step:1282/1480 train_time:487912ms step_avg:383.58ms
step:1283/1480 train_time:488244ms step_avg:383.54ms
step:1284/1480 train_time:488575ms step_avg:383.50ms
step:1285/1480 train_time:488909ms step_avg:383.46ms
step:1286/1480 train_time:489259ms step_avg:383.43ms
step:1287/1480 train_time:489586ms step_avg:383.39ms
step:1288/1480 train_time:489916ms step_avg:383.35ms
step:1289/1480 train_time:490249ms step_avg:383.31ms
step:1290/1480 train_time:490593ms step_avg:383.28ms
step:1291/1480 train_time:490939ms step_avg:383.25ms
step:1292/1480 train_time:491294ms step_avg:383.22ms
step:1293/1480 train_time:491645ms step_avg:383.20ms
step:1294/1480 train_time:491970ms step_avg:383.15ms
step:1295/1480 train_time:492310ms step_avg:383.12ms
step:1296/1480 train_time:492659ms step_avg:383.09ms
step:1297/1480 train_time:492999ms step_avg:383.06ms
step:1298/1480 train_time:493330ms step_avg:383.02ms
step:1299/1480 train_time:493665ms step_avg:382.98ms
step:1300/1480 train_time:493994ms step_avg:382.94ms
step:1301/1480 train_time:494329ms step_avg:382.90ms
step:1302/1480 train_time:494663ms step_avg:382.87ms
step:1303/1480 train_time:494995ms step_avg:382.83ms
step:1304/1480 train_time:495328ms step_avg:382.79ms
step:1305/1480 train_time:495669ms step_avg:382.76ms
step:1306/1480 train_time:496020ms step_avg:382.73ms
step:1307/1480 train_time:496359ms step_avg:382.70ms
step:1308/1480 train_time:496689ms step_avg:382.66ms
step:1309/1480 train_time:497028ms step_avg:382.62ms
step:1310/1480 train_time:497358ms step_avg:382.58ms
step:1311/1480 train_time:497691ms step_avg:382.55ms
step:1312/1480 train_time:498030ms step_avg:382.51ms
step:1313/1480 train_time:498363ms step_avg:382.47ms
step:1314/1480 train_time:498697ms step_avg:382.44ms
step:1315/1480 train_time:499034ms step_avg:382.40ms
step:1316/1480 train_time:499367ms step_avg:382.36ms
step:1317/1480 train_time:499718ms step_avg:382.34ms
step:1318/1480 train_time:500051ms step_avg:382.30ms
step:1319/1480 train_time:500382ms step_avg:382.26ms
step:1320/1480 train_time:500713ms step_avg:382.22ms
step:1321/1480 train_time:501067ms step_avg:382.20ms
step:1322/1480 train_time:501398ms step_avg:382.16ms
step:1323/1480 train_time:501737ms step_avg:382.13ms
step:1324/1480 train_time:502085ms step_avg:382.10ms
step:1325/1480 train_time:502428ms step_avg:382.07ms
step:1326/1480 train_time:502771ms step_avg:382.04ms
step:1327/1480 train_time:503105ms step_avg:382.01ms
step:1328/1480 train_time:503450ms step_avg:381.98ms
step:1329/1480 train_time:503791ms step_avg:381.95ms
step:1330/1480 train_time:504135ms step_avg:381.92ms
step:1331/1480 train_time:504499ms step_avg:381.91ms
step:1332/1480 train_time:504840ms step_avg:381.88ms
step:1333/1480 train_time:505176ms step_avg:381.84ms
step:1334/1480 train_time:505506ms step_avg:381.80ms
step:1335/1480 train_time:505852ms step_avg:381.78ms
step:1336/1480 train_time:506191ms step_avg:381.74ms
step:1337/1480 train_time:506530ms step_avg:381.71ms
step:1338/1480 train_time:506867ms step_avg:381.68ms
step:1339/1480 train_time:507213ms step_avg:381.65ms
step:1340/1480 train_time:507560ms step_avg:381.62ms
step:1341/1480 train_time:507900ms step_avg:381.59ms
step:1342/1480 train_time:508240ms step_avg:381.56ms
step:1343/1480 train_time:508571ms step_avg:381.52ms
step:1344/1480 train_time:508909ms step_avg:381.49ms
step:1345/1480 train_time:509250ms step_avg:381.46ms
step:1346/1480 train_time:509586ms step_avg:381.43ms
step:1347/1480 train_time:509919ms step_avg:381.39ms
step:1348/1480 train_time:510256ms step_avg:381.36ms
step:1349/1480 train_time:510593ms step_avg:381.32ms
step:1350/1480 train_time:510931ms step_avg:381.29ms
step:1351/1480 train_time:511273ms step_avg:381.26ms
step:1352/1480 train_time:511620ms step_avg:381.24ms
step:1353/1480 train_time:511956ms step_avg:381.20ms
step:1354/1480 train_time:512287ms step_avg:381.17ms
step:1355/1480 train_time:512619ms step_avg:381.13ms
step:1356/1480 train_time:512963ms step_avg:381.10ms
step:1357/1480 train_time:513309ms step_avg:381.08ms
step:1358/1480 train_time:513644ms step_avg:381.04ms
step:1359/1480 train_time:513980ms step_avg:381.01ms
step:1360/1480 train_time:514316ms step_avg:380.98ms
step:1361/1480 train_time:514650ms step_avg:380.94ms
step:1362/1480 train_time:514993ms step_avg:380.91ms
step:1363/1480 train_time:515335ms step_avg:380.88ms
step:1364/1480 train_time:515684ms step_avg:380.86ms
step:1365/1480 train_time:516017ms step_avg:380.82ms
step:1366/1480 train_time:516364ms step_avg:380.80ms
step:1367/1480 train_time:516695ms step_avg:380.76ms
step:1368/1480 train_time:517033ms step_avg:380.73ms
step:1369/1480 train_time:517371ms step_avg:380.70ms
step:1370/1480 train_time:517708ms step_avg:380.67ms
step:1371/1480 train_time:518053ms step_avg:380.64ms
step:1372/1480 train_time:518411ms step_avg:380.63ms
step:1373/1480 train_time:518753ms step_avg:380.60ms
step:1374/1480 train_time:519085ms step_avg:380.56ms
step:1375/1480 train_time:519429ms step_avg:380.53ms
step:1375/1480 val_loss:3.2929 train_time:519443ms step_avg:380.54ms
============== Weight norms: ==============
W name = 'module._orig_mod.embed.weight' | frobenius_norm = 54555.75391 | spectral_norm = 12888.72266 | median_sv = 1524.65527 | l1_to_l2_norm = 235.37973
W name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 165.20332 | spectral_norm = 27.64606 | median_sv = 4.49825
W name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 156.56660 | spectral_norm = 34.33731 | median_sv = 4.15239
W name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 154.92995 | spectral_norm = 19.07531 | median_sv = 4.33589
W name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 158.75232 | spectral_norm = 14.33230 | median_sv = 4.50195
W name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 345.18927 | spectral_norm = 24.89432 | median_sv = 11.65924
W name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 177.50694 | spectral_norm = 17.26548 | median_sv = 5.80373
W name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 167.82922 | spectral_norm = 18.51201 | median_sv = 4.44179
W name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 166.35280 | spectral_norm = 18.82594 | median_sv = 4.38056
W name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 168.10396 | spectral_norm = 16.46080 | median_sv = 4.41868
W name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 177.61943 | spectral_norm = 14.19288 | median_sv = 4.99332
W name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 374.10580 | spectral_norm = 29.98288 | median_sv = 12.56914
W name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 192.98901 | spectral_norm = 19.34051 | median_sv = 6.32999
W name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 167.39203 | spectral_norm = 15.22110 | median_sv = 4.34166
W name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 165.92502 | spectral_norm = 15.28988 | median_sv = 4.39790
W name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 187.97673 | spectral_norm = 18.29676 | median_sv = 4.86045
W name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 190.31300 | spectral_norm = 13.27174 | median_sv = 5.70522
W name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 378.34348 | spectral_norm = 30.50882 | median_sv = 12.83335
W name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 192.28609 | spectral_norm = 18.24015 | median_sv = 6.37976
W name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 173.27165 | spectral_norm = 17.05717 | median_sv = 4.62499
W name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 170.13441 | spectral_norm = 15.61035 | median_sv = 4.58839
W name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 195.64407 | spectral_norm = 18.34084 | median_sv = 5.13739
W name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 189.06999 | spectral_norm = 13.08196 | median_sv = 5.70890
W name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 384.86526 | spectral_norm = 32.77052 | median_sv = 13.04748
W name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 191.55563 | spectral_norm = 17.24843 | median_sv = 6.30762
W name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 166.04413 | spectral_norm = 19.28709 | median_sv = 4.39172
W name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 163.13234 | spectral_norm = 18.32603 | median_sv = 4.41061
W name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 188.74017 | spectral_norm = 16.79009 | median_sv = 5.10945
W name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 187.76587 | spectral_norm = 14.76564 | median_sv = 5.39881
W name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 391.10156 | spectral_norm = 29.97042 | median_sv = 13.27907
W name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 194.09355 | spectral_norm = 17.61267 | median_sv = 6.38405
W name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 164.42664 | spectral_norm = 16.93230 | median_sv = 4.21928
W name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 164.50714 | spectral_norm = 16.35695 | median_sv = 4.26980
W name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 196.61772 | spectral_norm = 16.96390 | median_sv = 5.23481
W name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 191.52776 | spectral_norm = 13.81309 | median_sv = 5.66248
W name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 393.93457 | spectral_norm = 29.98543 | median_sv = 13.49829
W name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 192.52133 | spectral_norm = 16.64111 | median_sv = 6.36805
W name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 164.96590 | spectral_norm = 18.23885 | median_sv = 4.34296
W name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 163.06181 | spectral_norm = 17.41118 | median_sv = 4.43305
W name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 194.96455 | spectral_norm = 16.74707 | median_sv = 5.35020
W name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 188.26297 | spectral_norm = 14.77709 | median_sv = 5.40413
W name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 389.86639 | spectral_norm = 28.96745 | median_sv = 13.29394
W name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 194.78842 | spectral_norm = 17.44058 | median_sv = 6.41751
W name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 170.06253 | spectral_norm = 17.22478 | median_sv = 4.47899
W name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 167.95930 | spectral_norm = 16.04866 | median_sv = 4.49053
W name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 199.41602 | spectral_norm = 18.41104 | median_sv = 5.18037
W name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 192.77997 | spectral_norm = 14.05926 | median_sv = 5.85194
W name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 390.11624 | spectral_norm = 30.54687 | median_sv = 13.23817
W name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 195.99864 | spectral_norm = 17.55310 | median_sv = 6.46898
W name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 171.31085 | spectral_norm = 16.92767 | median_sv = 4.45656
W name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 169.89021 | spectral_norm = 16.02088 | median_sv = 4.44654
W name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 199.64607 | spectral_norm = 18.62946 | median_sv = 4.97564
W name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 192.48476 | spectral_norm = 14.03989 | median_sv = 5.70019
W name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 392.48987 | spectral_norm = 30.96677 | median_sv = 13.33745
W name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 196.75644 | spectral_norm = 18.79985 | median_sv = 6.55654
W name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 172.02136 | spectral_norm = 19.12723 | median_sv = 4.27446
W name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 172.72067 | spectral_norm = 17.03422 | median_sv = 4.10401
W name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 201.20407 | spectral_norm = 19.94843 | median_sv = 5.26890
W name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 192.86592 | spectral_norm = 13.17546 | median_sv = 5.78821
W name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 387.03159 | spectral_norm = 32.70018 | median_sv = 13.11207
W name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 196.46887 | spectral_norm = 20.49990 | median_sv = 6.59674
W name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 170.19905 | spectral_norm = 20.93067 | median_sv = 3.98076
W name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 167.39670 | spectral_norm = 19.49922 | median_sv = 3.80329
W name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 192.26305 | spectral_norm = 19.03320 | median_sv = 5.18463
W name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 193.33621 | spectral_norm = 13.17750 | median_sv = 5.66826
W name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 396.17667 | spectral_norm = 29.78235 | median_sv = 13.61445
W name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 186.95955 | spectral_norm = 23.23995 | median_sv = 6.23101
W name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 173.36198 | spectral_norm = 21.36876 | median_sv = 4.38060
W name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 168.85194 | spectral_norm = 20.48340 | median_sv = 4.24833
W name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 182.22867 | spectral_norm = 21.10409 | median_sv = 4.84005
W name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 201.87317 | spectral_norm = 14.69096 | median_sv = 5.92527
W name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 406.49927 | spectral_norm = 35.74519 | median_sv = 13.76258
W name = 'module._orig_mod.blocks.11.mlp.c_proj.weight' | frobenius_norm = 194.48224 | spectral_norm = 25.21937 | median_sv = 6.35954
W name = 'module._orig_mod.value_embeds.weight' | frobenius_norm = 87062.94531 | spectral_norm = 6347.32666 | median_sv = 986.46155 | l1_to_l2_norm = 366.60913
W name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1226.64575 | spectral_norm = 168.76015 | median_sv = 38.81096
===========================================
============== Gradient norms: ==============
G name = 'module._orig_mod.embed.weight' | frobenius_norm = 0.00006 | spectral_norm = 0.00002 | median_sv = 0.00000 | l1_to_l2_norm = 0.00000
G name = 'module._orig_mod.blocks.0.attn.c_q.weight' | frobenius_norm = 0.00065 | spectral_norm = 0.00025 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_k.weight' | frobenius_norm = 0.00068 | spectral_norm = 0.00025 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_v.weight' | frobenius_norm = 0.00150 | spectral_norm = 0.00117 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.0.attn.c_proj.weight' | frobenius_norm = 0.00368 | spectral_norm = 0.00339 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.0.mlp.c_fc.weight' | frobenius_norm = 0.00396 | spectral_norm = 0.00370 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.0.mlp.c_proj.weight' | frobenius_norm = 0.00253 | spectral_norm = 0.00094 | median_sv = 0.00005
G name = 'module._orig_mod.blocks.1.attn.c_q.weight' | frobenius_norm = 0.00083 | spectral_norm = 0.00069 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.1.attn.c_k.weight' | frobenius_norm = 0.00078 | spectral_norm = 0.00059 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.1.attn.c_v.weight' | frobenius_norm = 0.00392 | spectral_norm = 0.00380 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.1.attn.c_proj.weight' | frobenius_norm = 0.00185 | spectral_norm = 0.00112 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.1.mlp.c_fc.weight' | frobenius_norm = 0.00207 | spectral_norm = 0.00165 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.1.mlp.c_proj.weight' | frobenius_norm = 0.00190 | spectral_norm = 0.00053 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.2.attn.c_q.weight' | frobenius_norm = 0.00121 | spectral_norm = 0.00093 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_k.weight' | frobenius_norm = 0.00130 | spectral_norm = 0.00098 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_v.weight' | frobenius_norm = 0.00310 | spectral_norm = 0.00292 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.2.attn.c_proj.weight' | frobenius_norm = 0.00205 | spectral_norm = 0.00146 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.2.mlp.c_fc.weight' | frobenius_norm = 0.00246 | spectral_norm = 0.00198 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.2.mlp.c_proj.weight' | frobenius_norm = 0.00244 | spectral_norm = 0.00074 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.3.attn.c_q.weight' | frobenius_norm = 0.00086 | spectral_norm = 0.00066 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_k.weight' | frobenius_norm = 0.00073 | spectral_norm = 0.00042 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_v.weight' | frobenius_norm = 0.00280 | spectral_norm = 0.00267 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.3.attn.c_proj.weight' | frobenius_norm = 0.00147 | spectral_norm = 0.00068 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.3.mlp.c_fc.weight' | frobenius_norm = 0.00264 | spectral_norm = 0.00200 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.3.mlp.c_proj.weight' | frobenius_norm = 0.00323 | spectral_norm = 0.00121 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.4.attn.c_q.weight' | frobenius_norm = 0.00063 | spectral_norm = 0.00042 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_k.weight' | frobenius_norm = 0.00056 | spectral_norm = 0.00026 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_v.weight' | frobenius_norm = 0.00295 | spectral_norm = 0.00267 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.4.attn.c_proj.weight' | frobenius_norm = 0.00184 | spectral_norm = 0.00102 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.4.mlp.c_fc.weight' | frobenius_norm = 0.00256 | spectral_norm = 0.00187 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.4.mlp.c_proj.weight' | frobenius_norm = 0.00300 | spectral_norm = 0.00136 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.5.attn.c_q.weight' | frobenius_norm = 0.00087 | spectral_norm = 0.00055 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_k.weight' | frobenius_norm = 0.00086 | spectral_norm = 0.00036 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_v.weight' | frobenius_norm = 0.00310 | spectral_norm = 0.00282 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.5.attn.c_proj.weight' | frobenius_norm = 0.00194 | spectral_norm = 0.00132 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.5.mlp.c_fc.weight' | frobenius_norm = 0.00257 | spectral_norm = 0.00191 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.5.mlp.c_proj.weight' | frobenius_norm = 0.00296 | spectral_norm = 0.00135 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.6.attn.c_q.weight' | frobenius_norm = 0.00072 | spectral_norm = 0.00050 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_k.weight' | frobenius_norm = 0.00062 | spectral_norm = 0.00033 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_v.weight' | frobenius_norm = 0.00271 | spectral_norm = 0.00243 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.6.attn.c_proj.weight' | frobenius_norm = 0.00184 | spectral_norm = 0.00122 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.6.mlp.c_fc.weight' | frobenius_norm = 0.00234 | spectral_norm = 0.00171 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.6.mlp.c_proj.weight' | frobenius_norm = 0.00259 | spectral_norm = 0.00098 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.7.attn.c_q.weight' | frobenius_norm = 0.00072 | spectral_norm = 0.00046 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_k.weight' | frobenius_norm = 0.00067 | spectral_norm = 0.00033 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_v.weight' | frobenius_norm = 0.00205 | spectral_norm = 0.00183 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.7.attn.c_proj.weight' | frobenius_norm = 0.00174 | spectral_norm = 0.00117 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.7.mlp.c_fc.weight' | frobenius_norm = 0.00233 | spectral_norm = 0.00168 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.7.mlp.c_proj.weight' | frobenius_norm = 0.00256 | spectral_norm = 0.00085 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.8.attn.c_q.weight' | frobenius_norm = 0.00107 | spectral_norm = 0.00083 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_k.weight' | frobenius_norm = 0.00099 | spectral_norm = 0.00056 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_v.weight' | frobenius_norm = 0.00271 | spectral_norm = 0.00247 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.8.attn.c_proj.weight' | frobenius_norm = 0.00261 | spectral_norm = 0.00224 | median_sv = 0.00002
G name = 'module._orig_mod.blocks.8.mlp.c_fc.weight' | frobenius_norm = 0.00274 | spectral_norm = 0.00220 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.8.mlp.c_proj.weight' | frobenius_norm = 0.00265 | spectral_norm = 0.00079 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.9.attn.c_q.weight' | frobenius_norm = 0.00153 | spectral_norm = 0.00131 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_k.weight' | frobenius_norm = 0.00140 | spectral_norm = 0.00101 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.9.attn.c_v.weight' | frobenius_norm = 0.00214 | spectral_norm = 0.00200 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.9.attn.c_proj.weight' | frobenius_norm = 0.00425 | spectral_norm = 0.00400 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.9.mlp.c_fc.weight' | frobenius_norm = 0.00346 | spectral_norm = 0.00306 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.9.mlp.c_proj.weight' | frobenius_norm = 0.00276 | spectral_norm = 0.00108 | median_sv = 0.00006
G name = 'module._orig_mod.blocks.10.attn.c_q.weight' | frobenius_norm = 0.00184 | spectral_norm = 0.00166 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.10.attn.c_k.weight' | frobenius_norm = 0.00151 | spectral_norm = 0.00123 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.10.attn.c_v.weight' | frobenius_norm = 0.00169 | spectral_norm = 0.00163 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.10.attn.c_proj.weight' | frobenius_norm = 0.00506 | spectral_norm = 0.00484 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.10.mlp.c_fc.weight' | frobenius_norm = 0.00509 | spectral_norm = 0.00478 | median_sv = 0.00004
G name = 'module._orig_mod.blocks.10.mlp.c_proj.weight' | frobenius_norm = 0.00395 | spectral_norm = 0.00229 | median_sv = 0.00007
G name = 'module._orig_mod.blocks.11.attn.c_q.weight' | frobenius_norm = 0.00205 | spectral_norm = 0.00189 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_k.weight' | frobenius_norm = 0.00140 | spectral_norm = 0.00117 | median_sv = 0.00001
G name = 'module._orig_mod.blocks.11.attn.c_v.weight' | frobenius_norm = 0.00239 | spectral_norm = 0.00232 | median_sv = 0.00000
G name = 'module._orig_mod.blocks.11.attn.c_proj.weight' | frobenius_norm = 0.00607 | spectral_norm = 0.00566 | median_sv = 0.00003
G name = 'module._orig_mod.blocks.11.mlp.c_fc.weight' | frobenius_norm = 0.00682 | spectral_norm = 0.00637 | median_sv = 0.00004

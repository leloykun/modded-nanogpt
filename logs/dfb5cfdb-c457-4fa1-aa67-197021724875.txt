====================================================================================================
import os
import sys
with open(sys.argv[0]) as f:
    code = f.read() # read the code of this file ASAP, for logging
import uuid
import glob
import time
from dataclasses import dataclass

import numpy as np
import torch
from torch import nn
import torch.nn.functional as F
import torch.distributed as dist
import torch._inductor.config as config
from torch.nn.parallel import DistributedDataParallel as DDP
# Use of FlexAttention contributed by @KoszarskyB
from torch.nn.attention.flex_attention import flex_attention, create_block_mask, BlockMask, _score_mod_signature
from torch._inductor.lowering import make_pointwise, register_lowering
# Some internal torch.compile details
from torch._inductor.virtualized import ops
from functools import partial
flex_attention = torch.compile(flex_attention, dynamic=False)
create_block_mask = torch.compile(create_block_mask, dynamic=False)

# -----------------------------------------------------------------------------
# Muon optimizer

def zeropower_via_svd(G, steps=None):
    U, S, V = G.svd()
    return U @ V.T

@torch.compile
def zeropower_via_newtonschulz5(G, steps=10, eps=1e-7):
    """
    Newton-Schulz iteration to compute the zeroth power / orthogonalization of G. We opt to use a
    quintic iteration whose coefficients are selected to maximize the slope at zero. For the purpose
    of minimizing steps, it turns out to be empirically effective to keep increasing the slope at
    zero even beyond the point where the iteration no longer converges all the way to one everywhere
    on the interval. This iteration therefore does not produce UV^T but rather something like US'V^T
    where S' is diagonal with S_{ii}' ~ Uniform(0.5, 1.5), which turns out not to hurt model
    performance at all relative to UV^T, where USV^T = G is the SVD.
    """
    assert len(G.shape) == 2
    a, b, c = (3.4445, -4.7750,  2.0315)
    X = G.bfloat16()
    X /= (X.norm() + eps) # ensure top singular value <= 1
    if G.size(0) > G.size(1):
        X = X.T
    for _ in range(steps):
        A = X @ X.T
        B = b * A + c * A @ A # adapted from suggestion by @jxbz, @leloykun, and @YouJiacheng
        X = a * X + B @ X
    if G.size(0) > G.size(1):
        X = X.T
    return X

zeropower_backends = dict(svd=zeropower_via_svd, newtonschulz5=zeropower_via_newtonschulz5)

class Muon(torch.optim.Optimizer):
    """
    Muon - MomentUm Orthogonalized by Newton-schulz

    Muon internally runs standard SGD-momentum, and then performs an orthogonalization post-
    processing step, in which each 2D parameter's update is replaced with the nearest orthogonal
    matrix. To efficiently orthogonalize each update, we use a Newton-Schulz iteration, which has
    the advantage that it can be stably run in bfloat16 on the GPU.

    Some warnings:
    - This optimizer assumes that all parameters passed in are 2D.
    - It should not be used for the embedding layer, the final fully connected layer, or any {0,1}-D
    parameters; those should all be optimized by a standard method (e.g., AdamW).
    - To use it with 4D convolutional filters, it works well to just flatten their last 3 dimensions.
    - We believe it is unlikely to work well for training with small batch size.
    - We believe it may not work well for finetuning pretrained models, but we haven't tested this.
    - We have not yet tried this optimizer for training scenarios larger than NanoGPT (124M).

    Arguments:
        lr: The learning rate used by the internal SGD.
        momentum: The momentum used by the internal SGD.
        nesterov: Whether to use Nesterov-style momentum in the internal SGD. (recommended)
        backend: The chosen backend for the orthogonalization step. (recommended: 'newtonschulz5')
        backend_steps: The number of iteration steps to use in the backend, if it is iterative.
    """
    def __init__(self, params, lr=0.02, momentum=0.95, nesterov=True,
                 backend='newtonschulz5', backend_steps=5):
        defaults = dict(lr=lr, momentum=momentum, nesterov=nesterov, backend=backend, backend_steps=backend_steps)
        super().__init__(params, defaults)

    def step(self):

        for group in self.param_groups:

            lr = group['lr']
            momentum = group['momentum']
            zeropower_backend = zeropower_backends[group['backend']]

            # generate weight updates in distributed fashion
            total_params = sum(p.numel() for p in group['params'])
            updates_flat = torch.zeros(total_params, device='cuda', dtype=torch.bfloat16)
            curr_idx = 0
            for i, p in enumerate(group['params']):
                # luckily this will perfectly distribute a transformer with multiple of 4 layers to 8 GPUs
                if i % int(os.environ['WORLD_SIZE']) == int(os.environ['RANK']):
                    g = p.grad
                    assert g is not None
                    state = self.state[p]
                    if 'momentum_buffer' not in state:
                        state['momentum_buffer'] = torch.zeros_like(g)
                    buf = state['momentum_buffer']
                    buf.mul_(momentum).add_(g)
                    if group['nesterov']:
                        g = g.add(buf, alpha=momentum)
                    g = zeropower_backend(g, steps=group['backend_steps'])
                    g *= max(1, g.size(0)/g.size(1))**0.5
                    updates_flat[curr_idx:curr_idx+p.numel()] = g.flatten()
                curr_idx += p.numel()

            # sync updates across devices. we are not memory-constrained so can do this simple deserialization
            dist.all_reduce(updates_flat, op=dist.ReduceOp.SUM)

            # deserialize and apply updates
            curr_idx = 0
            for p in group['params']:
                g = updates_flat[curr_idx:curr_idx+p.numel()].view_as(p.data).type_as(p.data)
                p.data.add_(g, alpha=-lr)
                curr_idx += p.numel()

# -----------------------------------------------------------------------------
# Attention Tanh softcapping

@torch.library.custom_op("approx::tanh", mutates_args=())
def _tanh_approx(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

@_tanh_approx.register_fake
def _(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

def _tanh_approx_lowering(inp):
    fn = partial(ops.inline_asm_elementwise, asm="tanh.approx.f32 $0, $1;")
    return make_pointwise(fn)(inp)

register_lowering(torch.ops.approx.tanh)(_tanh_approx_lowering)

class _TanhApprox(torch.autograd.Function):
    @staticmethod
    def forward(x):
        return torch.ops.approx.tanh(x)

    @staticmethod
    def setup_context(ctx, inputs, output):
        (x,) = inputs
        result = output
        ctx.save_for_backward(result)

    @staticmethod
    def backward(ctx, grad_output):
        (result,) = ctx.saved_tensors
        return grad_output * (1 - result * result)

    @staticmethod
    def vmap(info, in_dims, x):
        return torch.tanh(x), 0

_tanh_approx = _TanhApprox.apply

def generate_tanh_softcap(soft_cap: int, approx: bool=True) -> _score_mod_signature:
    tanh = _tanh_approx if approx else torch.tanh

    def tanh_softcap(score, b, h, q_idx, kv_idx):
        return soft_cap * tanh(score / soft_cap)

    prefix = "tanh_softcap_approx" if approx else "tanh_softcap"
    tanh_softcap.__name__ = f"{prefix}_{soft_cap}"

    return tanh_softcap

# -----------------------------------------------------------------------------
# PyTorch nn.Module definitions for the GPT-2 model

class Rotary(torch.nn.Module):

    def __init__(self, dim, base=10000):
        super().__init__()
        self.dim = dim
        self.base = base
        self.inv_freq = None
        self.seq_len_cached = None
        self.cos_cached = None
        self.sin_cached = None

    def forward(self, x):
        seq_len = x.shape[1]
        if seq_len != self.seq_len_cached:
            self.inv_freq = 1.0 / (self.base ** (torch.arange(0, self.dim, 2, device=x.device).float() / self.dim))
            self.seq_len_cached = seq_len
            t = torch.arange(seq_len, device=x.device).type_as(self.inv_freq)
            freqs = torch.outer(t, self.inv_freq)
            self.cos_cached = freqs.cos().bfloat16()
            self.sin_cached = freqs.sin().bfloat16()
        return self.cos_cached[None, :, None, :], self.sin_cached[None, :, None, :]

def apply_rotary_emb(x, cos, sin):
    assert x.ndim == 4 # multihead attention
    d = x.shape[3]//2
    x1 = x[..., :d]
    x2 = x[..., d:]
    y1 = x1 * cos + x2 * sin
    y2 = x1 * (-sin) + x2 * cos
    return torch.cat([y1, y2], 3).type_as(x)

class CastedLinear(nn.Linear):
    def forward(self, x):
        return F.linear(x, self.weight.to(x.dtype))

class CausalSelfAttention(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.n_head = config.n_head
        self.n_embd = config.n_embd
        self.head_dim = self.n_embd // self.n_head
        assert self.n_embd % self.n_head == 0
        self.c_q = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_k = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_v = CastedLinear(self.n_embd, self.n_embd, bias=False)
        # output projection
        self.c_proj = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977
        self.rotary = Rotary(self.head_dim)
        self.lamb = nn.Parameter(torch.tensor(0.5)) # @Grad62304977

    def forward(self, x, v1, block_mask: BlockMask, score_mod: _score_mod_signature):
        B, T, C = x.size() # batch size, sequence length, embedding dimensionality (n_embd)
        q = self.c_q(x).view(B, T, self.n_head, self.head_dim)
        k = self.c_k(x).view(B, T, self.n_head, self.head_dim)
        v = self.c_v(x).view(B, T, self.n_head, self.head_dim)
        if v1 is None:
            v1 = v # This happens if we are in the first block. v needs to be accessed by subsequent blocks
        v = (1 - self.lamb) * v + self.lamb * v1.view_as(v) # @Grad62304977
        cos, sin = self.rotary(q)
        q, k = F.rms_norm(q, (q.size(-1),)), F.rms_norm(k, (k.size(-1),)) # QK norm suggested by @Grad62304977
        q, k = apply_rotary_emb(q, cos, sin), apply_rotary_emb(k, cos, sin)
        y = flex_attention(q.transpose(1, 2), k.transpose(1, 2), v.transpose(1, 2), score_mod=score_mod, block_mask=block_mask)
        y = y.transpose(1, 2).contiguous().view_as(x) # re-assemble all head outputs side by side
        y = self.c_proj(y)
        return y, v1

class MLP(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.c_fc    = CastedLinear(config.n_embd, 4 * config.n_embd, bias=False)
        self.c_proj  = CastedLinear(4 * config.n_embd, config.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977

    def forward(self, x):
        x = self.c_fc(x)
        x = F.relu(x).square() # https://arxiv.org/abs/2109.08668v2; ~1-2% better than GELU; suggested by @SKYLINEZ007 and @Grad62304977
        x = self.c_proj(x)
        return x

class Block(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.attn = CausalSelfAttention(config)
        self.mlp = MLP(config)
        self.lambdas = nn.Parameter(torch.tensor([1., 0.]))

    def forward(self, x, v1, x0, block_mask: BlockMask, score_mod: _score_mod_signature):
        x = self.lambdas[0] * x + self.lambdas[1] * x0
        x1, v1 = self.attn(F.rms_norm(x, (x.size(-1),)), v1, block_mask, score_mod)
        x = x + x1
        x = x + self.mlp(F.rms_norm(x, (x.size(-1),)))
        return x, v1

# -----------------------------------------------------------------------------
# The main GPT-2 model

@dataclass
class GPTConfig:
    vocab_size : int = 50304
    n_layer : int = 12
    n_head : int = 6 # head dim 128 suggested by @Grad62304977
    n_embd : int = 768
    attention_soft_cap : int = 50
    lm_head_soft_cap : int = 30

class GPT(nn.Module):

    def __init__(self, config: GPTConfig):
        super().__init__()
        self.attention_soft_cap = config.attention_soft_cap
        self.lm_head_soft_cap = config.lm_head_soft_cap

        # U-net design by @brendanh0gan
        self.num_encoder_layers = config.n_layer // 2 # Half of the layers for encoder
        self.num_decoder_layers = config.n_layer - self.num_encoder_layers # Remaining for decoder
        # Add learnable skip connection weights for decoder layers
        self.skip_weights = nn.Parameter(torch.ones(self.num_decoder_layers))

        self.transformer = nn.ModuleDict(dict(
            wte = nn.Embedding(config.vocab_size, config.n_embd),
            h = nn.ModuleList([Block(config) for _ in range(config.n_layer)]),
        ))
        self.lm_head = CastedLinear(config.n_embd, config.vocab_size, bias=False)
        self.lm_head.weight.data.zero_() # @Grad62304977

    def forward(self, idx, target, attn_blocksize: int):

        docs = (idx == 50256).cumsum(0)
        def document_causal_mask(b, h, q_idx, kv_idx):
            causal_mask = q_idx >= kv_idx
            document_mask = docs[q_idx] == docs[kv_idx]
            window_mask = q_idx - kv_idx < attn_blocksize
            return causal_mask & document_mask & window_mask

        softcap_mod = generate_tanh_softcap(self.attention_soft_cap, approx=True)  # @leloykun

        S = len(idx)
        block_mask = create_block_mask(document_causal_mask, None, None, S, S, device="cuda", _compile=True)

        # forward the GPT model itself
        x = self.transformer.wte(idx[None]) # token embeddings of shape (b, t, n_embd)
        x = F.rms_norm(x, (x.size(-1),)) # @Grad62304977
        x0 = x
        v1 = None

        # Store outputs for U-Net skip connections
        skip_connections = []
        # Encoder pass - process only the first half of the blocks
        for i in range(self.num_encoder_layers):
            x, v1 = self.transformer.h[i](x, v1, x0, block_mask, softcap_mod)
            skip_connections.append(x)
        # Decoder pass - process the remaining blocks with weighted skip connections
        for i in range(self.num_decoder_layers):
            x = x + self.skip_weights[i] * skip_connections.pop()
            x, v1 = self.transformer.h[self.num_encoder_layers + i](x, v1, x0, block_mask, softcap_mod)

        x = F.rms_norm(x, (x.size(-1),))
        logits = self.lm_head(x)
        logits = self.lm_head_soft_cap * torch.tanh(logits / self.lm_head_soft_cap) # @Grad62304977
        logits = logits.float()
        loss = F.cross_entropy(logits.view(-1, logits.size(-1)), target.view(-1))
        return loss

# -----------------------------------------------------------------------------
# Our own simple Distributed Data Loader

def _peek_data_shard(filename):
    # only reads the header, returns header data
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
    if header[0] != 20240520:
        print("ERROR: magic number mismatch in the data .bin file!")
        print("---> HINT: Are you passing in a correct file with --input_bin?")
        print("---> HINT: Dataset encoding changed recently, re-run data prepro or refer again to README")
        print("---> HINT: For example re-run: `python dev/data/tinyshakespeare.py`, then re-try")
        exit(1)
    assert header[1] == 1, "unsupported version"
    ntok = header[2] # number of tokens (claimed)
    return ntok # for now just return the number of tokens

def _load_data_shard(filename):
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
        assert header[0] == 20240520, "magic number mismatch in the data .bin file"
        assert header[1] == 1, "unsupported version"
        ntok = header[2] # number of tokens (claimed)
        # the rest of it are tokens, stored as uint16
        tokens = np.frombuffer(f.read(), dtype=np.uint16)
    assert len(tokens) == ntok, "number of tokens read does not match header?"
    return tokens

class DistributedDataLoader:
    def __init__(self, filename_pattern, B, T, process_rank, num_processes):
        self.process_rank = process_rank
        self.num_processes = num_processes
        self.B = B
        self.T = T

        # glob files that match the pattern
        self.files = sorted(glob.glob(filename_pattern))
        assert len(self.files) > 0, f"did not find any files that match the pattern {filename_pattern}"

        # load and validate all data shards, count number of tokens in total
        ntok_total = 0
        for fname in self.files:
            shard_ntok = _peek_data_shard(fname)
            assert shard_ntok >= num_processes * B * T + 1
            ntok_total += int(shard_ntok)
        self.ntok_total = ntok_total

        self.reset()

    def reset(self):
        self.current_shard = -1
        self.advance()

    def advance(self): # advance to next data shard
        self.current_shard = (self.current_shard + 1) % len(self.files)
        self.current_position = self.process_rank * self.B * self.T
        self.tokens = _load_data_shard(self.files[self.current_shard])

    def next_batch(self):
        batch_size = self.B * self.T * self.num_processes
        buf = self.tokens[self.current_position:self.current_position+self.B*self.T+1]
        buf = torch.tensor(buf.astype(np.int32), dtype=torch.long)
        x = buf[:-1] # inputs
        y = buf[1:] # targets
        # advance current position and load next shard if necessary
        self.current_position += batch_size
        if self.current_position + batch_size >= len(self.tokens):
            self.advance()
        return x.cuda(), y.cuda()

# -----------------------------------------------------------------------------
# int main

@dataclass
class Hyperparameters:
    # data hyperparams
    input_bin : str = 'data/fineweb10B/fineweb_train_*.bin' # input .bin to train on
    input_val_bin : str = 'data/fineweb10B/fineweb_val_*.bin' # input .bin to eval validation loss on
    # optimization hyperparams
    batch_size : int = 8 # batch size, in sequences, across all devices
    device_batch_size : int = 1 # batch size, in sequences, per device
    sequence_length : int = 64*1024 # sequence length, in tokens
    num_iterations : int = 1750 # number of iterations to run
    warmup_iters : int = 0
    cooldown_iters : int = 640 # number of iterations of linear warmup/cooldown for triangular or trapezoidal schedule
    weight_decay : float = 0
    # evaluation and logging hyperparams
    val_loss_every : int = 125 # every how many steps to evaluate val loss? 0 for only at the end
    val_tokens : int = 10485760 # how many tokens of validation data? it's important to keep this fixed for consistent comparisons
    save_every : int = 0 # every how many steps to save the checkpoint? 0 for only at the end
args = Hyperparameters()

# set up DDP (distributed data parallel). torchrun sets this env variable
assert torch.cuda.is_available()
dist.init_process_group(backend='nccl')
ddp_rank = int(os.environ['RANK'])
ddp_local_rank = int(os.environ['LOCAL_RANK'])
ddp_world_size = int(os.environ['WORLD_SIZE'])
device = f'cuda:{ddp_local_rank}'
torch.cuda.set_device(device)
print(f"using device: {device}")
master_process = (ddp_rank == 0) # this process will do logging, checkpointing etc.

# begin logging
logfile = None
if master_process:
    run_id = str(uuid.uuid4())
    logdir = 'logs/%s/' % run_id
    os.makedirs(logdir, exist_ok=True)
    logfile = 'logs/%s.txt' % run_id
    # create the log file
    with open(logfile, "w") as f:
        # begin the log by printing this file (the Python code)
        f.write('='*100 + '\n')
        f.write(code)
        f.write('='*100 + '\n')
def print0(s, logonly=False):
    if master_process:
        with open(logfile, "a") as f:
            if not logonly:
                print(s)
            f.write(s+'\n')
# log information about the hardware/software environment this is running on
# and print the full `nvidia-smi` to file
print0(f"Running pytorch {torch.version.__version__} compiled for CUDA {torch.version.cuda}\nnvidia-smi:")
import subprocess
result = subprocess.run(['nvidia-smi'], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
print0(f'{result.stdout}', logonly=True)
print0('='*100, logonly=True)

# convenience variables
B, T = args.device_batch_size, args.sequence_length
# calculate the number of steps to take in the val loop.
assert args.val_tokens % (B * T * ddp_world_size) == 0
val_steps = args.val_tokens // (B * T * ddp_world_size)
# calculate the steps of gradient accumulation required to attain the desired global batch size.
assert args.batch_size % (B * ddp_world_size) == 0
train_accumulation_steps = args.batch_size // (B * ddp_world_size)

# load tokens
train_loader = DistributedDataLoader(args.input_bin, B, T, ddp_rank, ddp_world_size)
val_loader = DistributedDataLoader(args.input_val_bin, B, T, ddp_rank, ddp_world_size)
print0(f"Training DataLoader: total number of tokens: {train_loader.ntok_total} across {len(train_loader.files)} files")
print0(f"Validation DataLoader: total number of tokens: {val_loader.ntok_total} across {len(val_loader.files)} files")
print0('='*100, logonly=True)
x, y = train_loader.next_batch()

# there are only 50257 unique GPT-2 tokens; we extend to nearest multiple of 128 for efficiency. suggested to me by @Grad62304977.
# this originates from Karpathy's experiments.
num_vocab = 50304
model = GPT(GPTConfig(vocab_size=num_vocab, n_layer=12, n_head=6, n_embd=768))
model = model.cuda().bfloat16()
for m in model.modules():
    if isinstance(m, CastedLinear):
        m.float()
if hasattr(config, "coordinate_descent_tuning"):
    config.coordinate_descent_tuning = True # suggested by @Chillee
model = torch.compile(model)
# here we wrap model into DDP container
model = DDP(model, device_ids=[ddp_local_rank])
raw_model = model.module # always contains the "raw" unwrapped model

# CUDNN attention is ~4ms faster than Flash, but doesn't get selected by default in PyTorch 2.5.1
from torch.backends.cuda import enable_cudnn_sdp, enable_flash_sdp, enable_math_sdp, enable_mem_efficient_sdp
enable_cudnn_sdp(True)
enable_flash_sdp(False)
enable_mem_efficient_sdp(False)
enable_math_sdp(False)

# init the optimizer(s)
optimizer1 = torch.optim.Adam([raw_model.transformer.wte.weight], lr=0.6,   betas=(0.8, 0.95), fused=True)
optimizer2 = torch.optim.Adam([raw_model.lm_head.weight],         lr=0.008, betas=(0.8, 0.95), fused=True)
param_names = [name for name, _ in raw_model.named_parameters()]
params = list(raw_model.transformer.h.parameters())
qk_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and ("c_q" in n or "c_k" in n)]
matrix_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and "c_q" not in n and "c_k" not in n]
scalar_params = [p for p in params if p.ndim < 2] + [raw_model.skip_weights]
optimizer5 = Muon(qk_params, lr=0.1, momentum=0.95)
optimizer3 = Muon(matrix_params, lr=0.05, momentum=0.95)
optimizer4 = torch.optim.Adam(scalar_params, lr=0.04, betas=(0.8, 0.95), fused=True) # note that this learning rate is neither sensitive nor tuned
optimizers = [optimizer1, optimizer2, optimizer3, optimizer4, optimizer5]
# learning rate decay scheduler (linear warmup and cooldown)
def get_lr(it):
    assert it <= args.num_iterations
    # 1) linear warmup for warmup_iters steps
    if it < args.warmup_iters:
        return (it+1) / args.warmup_iters
    # 2) constant lr for a while
    elif it < args.num_iterations - args.cooldown_iters:
        return 1.0
    # 3) linear cooldown
    else:
        decay_ratio = (args.num_iterations - it) / args.cooldown_iters
        return decay_ratio
schedulers = [torch.optim.lr_scheduler.LambdaLR(opt, get_lr) for opt in optimizers]

# Start training loop
training_time_ms = 0
# start the clock
torch.cuda.synchronize()
t0 = time.time()
# begin training
for step in range(args.num_iterations + 1):
    last_step = (step == args.num_iterations)
    # Set the attention blocksize for the current step, in chunks of 64
    attn_blocksize = torch.tensor(64*((step/args.num_iterations * (1792 - 64) + 64)//64), dtype=torch.int, device='cuda')
    # This effectively ignores timing first 10 steps, which are slower for weird reasons.
    # Alternately, and slightly more correctly in terms of benchmarking, we could do 10
    # steps with dummy data first, and then re-initialize the model and reset the loader.
    if step == 10:
        training_time_ms = 0
        t0 = time.time()
    timed_steps = float('nan') if step <= 11 else (step - 10) + 1 # <= 11 to avoid bug in val

    # once in a while evaluate the validation dataset
    if (last_step or (args.val_loss_every > 0 and step % args.val_loss_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # run validation batches
        model.eval()
        val_loader.reset()
        val_loss = 0.0
        for _ in range(val_steps):
            with torch.no_grad():
                x_val, y_val = val_loader.next_batch()
                val_loss += model(x_val, y_val, attn_blocksize=attn_blocksize)
        dist.all_reduce(val_loss, op=dist.ReduceOp.AVG)
        val_loss /= val_steps
        # log val loss to console and to logfile
        print0(f'step:{step}/{args.num_iterations} val_loss:{val_loss:.4f} train_time:{training_time_ms:.0f}ms step_avg:{training_time_ms/(timed_steps-1):.2f}ms')
        if master_process:
            print("============== Weight norms: ==============")
            with open(logfile, "a") as f:
                f.write("============== Weight norms: ==============\n")
                for name, p in model.named_parameters():
                    if p.ndim != 2:
                        continue
                    if "transformer.wte" in name:
                        l1_to_l2_norm = torch.norm(p.data.float(), p=2, dim=1).mean().item()
                    frobenius_norm = torch.linalg.norm(p.data.float(), ord='fro').item()
                    spectral_norm = torch.linalg.matrix_norm(p.data.float(), ord=2).item()
                    nuclear_norm = torch.linalg.matrix_norm(p.data.float(), ord="nuc").item()
                    if "transformer.wte" in name:
                        print(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                    else:
                        print(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                f.write("===========================================\n")
            print("===========================================")
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    if master_process and (last_step or (args.save_every > 0 and step % args.save_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # save the state of the training process
        log = dict(step=step, code=code, model=raw_model.state_dict(), optimizers=[opt.state_dict() for opt in optimizers])
        torch.save(log, 'logs/%s/state_step%06d.pt' % (run_id, step))
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    # bit confusing: we want to make sure to eval on 0th iteration
    # but also after the very last iteration. so we loop for step <= num_iterations
    # instead of just < num_iterations (one extra due to <=), only to do
    # the validation/sampling one last time, and then we break right here as we're done.
    if last_step:
        break

    # --------------- TRAINING SECTION BEGIN -----------------
    model.train()
    for i in range(1, train_accumulation_steps+1):
        # forward pass
        loss = model(x, y, attn_blocksize=attn_blocksize)
        train_loss = loss.detach()
        # advance the dataset for the next batch
        x, y = train_loader.next_batch()
        # backward pass
        if i < train_accumulation_steps:
            with model.no_sync(): # there's no need to sync gradients every accumulation step
                loss.backward()
        else:
            loss.backward() # just sync on the last step
    for p in model.parameters():
        p.grad /= train_accumulation_steps
    # momentum warmup for Muon
    frac = min(step/300, 1)
    optimizer3.param_groups[0]['momentum'] = (1 - frac) * 0.85 + frac * 0.95
    # step the optimizers and schedulers
    for opt, sched in zip(optimizers, schedulers):
        opt.step()
        sched.step()
    # null the gradients
    model.zero_grad(set_to_none=True)
    # --------------- TRAINING SECTION END -------------------
    # everything that follows now is just diagnostics, prints, logging, etc.

    #dist.all_reduce(train_loss, op=dist.ReduceOp.AVG) # all-reducing the training loss would be more correct in terms of logging, but slower
    approx_time = training_time_ms + 1000 * (time.time() - t0)
    print0(f"step:{step+1}/{args.num_iterations} train_loss:{train_loss.item():.4f} train_time:{approx_time:.0f}ms step_avg:{approx_time/timed_steps:.2f}ms")

if master_process:
    print(f"peak memory consumption: {torch.cuda.max_memory_allocated() // 1024 // 1024} MiB")

# -------------------------------------------------------------------------
# clean up nice
dist.destroy_process_group()
====================================================================================================
Running pytorch 2.6.0.dev20241125+cu124 compiled for CUDA 12.4
nvidia-smi:
Mon Nov 25 14:00:43 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.12             Driver Version: 535.104.12   CUDA Version: 12.4     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  | 00000000:07:00.0 Off |                    0 |
| N/A   31C    P0              65W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  | 00000000:0A:00.0 Off |                    0 |
| N/A   28C    P0              62W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  | 00000000:45:00.0 Off |                    0 |
| N/A   29C    P0              70W / 400W |     24MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  | 00000000:4B:00.0 Off |                    0 |
| N/A   33C    P0              72W / 400W |     24MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   4  NVIDIA A100-SXM4-80GB          On  | 00000000:84:00.0 Off |                    0 |
| N/A   33C    P0              73W / 400W |     24MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   5  NVIDIA A100-SXM4-80GB          On  | 00000000:8A:00.0 Off |                    0 |
| N/A   28C    P0              70W / 400W |     29MiB / 81920MiB |      1%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   6  NVIDIA A100-SXM4-80GB          On  | 00000000:C0:00.0 Off |                    0 |
| N/A   28C    P0              69W / 400W |     35MiB / 81920MiB |      1%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   7  NVIDIA A100-SXM4-80GB          On  | 00000000:C3:00.0 Off |                    0 |
| N/A   32C    P0              72W / 400W |    427MiB / 81920MiB |      1%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
+---------------------------------------------------------------------------------------+

====================================================================================================
Training DataLoader: total number of tokens: 1100000000 across 11 files
Validation DataLoader: total number of tokens: 100000000 across 1 files
====================================================================================================
step:0/1750 val_loss:10.8258 train_time:0ms step_avg:nanms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 27.70255 | frobenius_norm = 6215.32422 | spectral_norm = 251.87186 | nuclear_norm = 171937.37500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 15.98731 | spectral_norm = 1.15641 | nuclear_norm = 375.92694
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 15.99033 | spectral_norm = 1.14127 | nuclear_norm = 376.14099
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 16.00159 | spectral_norm = 1.14786 | nuclear_norm = 376.52112
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 32.00273 | spectral_norm = 1.73733 | nuclear_norm = 858.32629
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 15.99410 | spectral_norm = 1.14612 | nuclear_norm = 376.38330
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 15.99511 | spectral_norm = 1.15895 | nuclear_norm = 376.31158
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 16.00208 | spectral_norm = 1.13783 | nuclear_norm = 376.41620
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 32.00857 | spectral_norm = 1.72949 | nuclear_norm = 858.42236
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 16.00491 | spectral_norm = 1.15679 | nuclear_norm = 376.45197
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 15.99247 | spectral_norm = 1.13986 | nuclear_norm = 376.26086
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 16.00326 | spectral_norm = 1.14314 | nuclear_norm = 376.67599
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 32.00002 | spectral_norm = 1.72397 | nuclear_norm = 858.25446
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 16.01141 | spectral_norm = 1.14281 | nuclear_norm = 376.78656
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 16.01808 | spectral_norm = 1.13961 | nuclear_norm = 376.91583
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 16.00021 | spectral_norm = 1.14006 | nuclear_norm = 376.09586
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 32.00473 | spectral_norm = 1.72386 | nuclear_norm = 858.51526
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 15.99672 | spectral_norm = 1.14295 | nuclear_norm = 376.38245
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 15.99550 | spectral_norm = 1.14909 | nuclear_norm = 376.33218
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 15.99719 | spectral_norm = 1.15066 | nuclear_norm = 376.28610
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 31.98657 | spectral_norm = 1.71695 | nuclear_norm = 857.95776
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 15.99659 | spectral_norm = 1.14510 | nuclear_norm = 376.40259
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 16.00523 | spectral_norm = 1.15269 | nuclear_norm = 376.43866
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 16.00003 | spectral_norm = 1.14696 | nuclear_norm = 376.38409
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 32.00785 | spectral_norm = 1.72055 | nuclear_norm = 858.49731
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 16.00306 | spectral_norm = 1.14799 | nuclear_norm = 376.50674
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 16.00080 | spectral_norm = 1.15448 | nuclear_norm = 376.42346
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 15.99875 | spectral_norm = 1.14628 | nuclear_norm = 376.29288
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 32.01210 | spectral_norm = 1.72773 | nuclear_norm = 858.49512
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 16.00014 | spectral_norm = 1.14876 | nuclear_norm = 376.29550
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 15.99617 | spectral_norm = 1.14358 | nuclear_norm = 376.40973
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 16.01652 | spectral_norm = 1.16084 | nuclear_norm = 376.76251
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 31.99299 | spectral_norm = 1.72533 | nuclear_norm = 858.09961
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 16.00188 | spectral_norm = 1.14772 | nuclear_norm = 376.43619
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 16.01046 | spectral_norm = 1.15388 | nuclear_norm = 376.52692
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 15.98010 | spectral_norm = 1.14700 | nuclear_norm = 375.79285
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 32.01352 | spectral_norm = 1.72549 | nuclear_norm = 858.62512
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 15.99552 | spectral_norm = 1.15324 | nuclear_norm = 376.01810
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 15.99931 | spectral_norm = 1.14472 | nuclear_norm = 376.43896
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 15.99221 | spectral_norm = 1.15183 | nuclear_norm = 376.05371
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 31.99011 | spectral_norm = 1.72713 | nuclear_norm = 857.99548
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 15.99433 | spectral_norm = 1.14268 | nuclear_norm = 376.31049
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 16.00766 | spectral_norm = 1.14387 | nuclear_norm = 376.66455
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 16.00085 | spectral_norm = 1.14349 | nuclear_norm = 376.64804
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 31.99837 | spectral_norm = 1.73274 | nuclear_norm = 858.16028
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 16.00381 | spectral_norm = 1.15063 | nuclear_norm = 376.66132
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 16.00566 | spectral_norm = 1.14677 | nuclear_norm = 376.48407
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 16.00884 | spectral_norm = 1.15413 | nuclear_norm = 376.70682
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 31.99214 | spectral_norm = 1.71739 | nuclear_norm = 857.99146
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
===========================================
step:1/1750 train_loss:10.8258 train_time:33430ms step_avg:nanms
step:2/1750 train_loss:10.0817 train_time:34209ms step_avg:nanms
step:3/1750 train_loss:8.3286 train_time:34549ms step_avg:nanms
step:4/1750 train_loss:7.6256 train_time:34878ms step_avg:nanms
step:5/1750 train_loss:7.5168 train_time:35208ms step_avg:nanms
step:6/1750 train_loss:7.0098 train_time:35538ms step_avg:nanms
step:7/1750 train_loss:7.1661 train_time:35869ms step_avg:nanms
step:8/1750 train_loss:6.7252 train_time:36199ms step_avg:nanms
step:9/1750 train_loss:6.6217 train_time:36530ms step_avg:nanms
step:10/1750 train_loss:6.5226 train_time:36860ms step_avg:nanms
step:11/1750 train_loss:6.4776 train_time:248ms step_avg:nanms
step:12/1750 train_loss:6.3660 train_time:578ms step_avg:nanms
step:13/1750 train_loss:6.3023 train_time:907ms step_avg:302.45ms
step:14/1750 train_loss:6.2408 train_time:1240ms step_avg:309.99ms
step:15/1750 train_loss:6.1783 train_time:1571ms step_avg:314.21ms
step:16/1750 train_loss:6.1037 train_time:1902ms step_avg:317.08ms
step:17/1750 train_loss:6.1686 train_time:2232ms step_avg:318.90ms
step:18/1750 train_loss:5.9541 train_time:2563ms step_avg:320.44ms
step:19/1750 train_loss:6.0071 train_time:2895ms step_avg:321.67ms
step:20/1750 train_loss:5.6869 train_time:3226ms step_avg:322.56ms
step:21/1750 train_loss:5.9707 train_time:3557ms step_avg:323.40ms
step:22/1750 train_loss:6.1942 train_time:3888ms step_avg:324.03ms
step:23/1750 train_loss:5.8838 train_time:4219ms step_avg:324.54ms
step:24/1750 train_loss:6.0554 train_time:4551ms step_avg:325.10ms
step:25/1750 train_loss:5.7255 train_time:4882ms step_avg:325.47ms
step:26/1750 train_loss:5.6373 train_time:5213ms step_avg:325.82ms
step:27/1750 train_loss:5.8310 train_time:5545ms step_avg:326.19ms
step:28/1750 train_loss:5.4217 train_time:5877ms step_avg:326.51ms
step:29/1750 train_loss:5.6874 train_time:6208ms step_avg:326.73ms
step:30/1750 train_loss:5.4881 train_time:6539ms step_avg:326.96ms
step:31/1750 train_loss:5.4638 train_time:6871ms step_avg:327.17ms
step:32/1750 train_loss:5.3178 train_time:7203ms step_avg:327.41ms
step:33/1750 train_loss:5.6238 train_time:7533ms step_avg:327.53ms
step:34/1750 train_loss:5.5209 train_time:7865ms step_avg:327.70ms
step:35/1750 train_loss:5.6432 train_time:8197ms step_avg:327.87ms
step:36/1750 train_loss:5.5633 train_time:8527ms step_avg:327.98ms
step:37/1750 train_loss:5.4898 train_time:8860ms step_avg:328.14ms
step:38/1750 train_loss:5.3419 train_time:9191ms step_avg:328.24ms
step:39/1750 train_loss:5.3764 train_time:9522ms step_avg:328.35ms
step:40/1750 train_loss:5.2775 train_time:9854ms step_avg:328.46ms
step:41/1750 train_loss:5.2564 train_time:10186ms step_avg:328.57ms
step:42/1750 train_loss:5.2004 train_time:10517ms step_avg:328.67ms
step:43/1750 train_loss:5.3009 train_time:10849ms step_avg:328.75ms
step:44/1750 train_loss:5.2534 train_time:11181ms step_avg:328.84ms
step:45/1750 train_loss:5.4093 train_time:11513ms step_avg:328.94ms
step:46/1750 train_loss:5.2122 train_time:11845ms step_avg:329.03ms
step:47/1750 train_loss:5.0975 train_time:12176ms step_avg:329.09ms
step:48/1750 train_loss:5.2522 train_time:12509ms step_avg:329.19ms
step:49/1750 train_loss:5.1736 train_time:12842ms step_avg:329.27ms
step:50/1750 train_loss:5.2870 train_time:13175ms step_avg:329.38ms
step:51/1750 train_loss:5.1750 train_time:13507ms step_avg:329.44ms
step:52/1750 train_loss:5.0527 train_time:13839ms step_avg:329.51ms
step:53/1750 train_loss:5.1945 train_time:14172ms step_avg:329.58ms
step:54/1750 train_loss:5.0537 train_time:14504ms step_avg:329.64ms
step:55/1750 train_loss:5.4526 train_time:14836ms step_avg:329.69ms
step:56/1750 train_loss:5.0763 train_time:15168ms step_avg:329.73ms
step:57/1750 train_loss:4.9021 train_time:15500ms step_avg:329.79ms
step:58/1750 train_loss:5.0472 train_time:15833ms step_avg:329.85ms
step:59/1750 train_loss:5.0531 train_time:16165ms step_avg:329.90ms
step:60/1750 train_loss:5.1682 train_time:16497ms step_avg:329.95ms
step:61/1750 train_loss:4.8766 train_time:16830ms step_avg:330.00ms
step:62/1750 train_loss:5.0072 train_time:17163ms step_avg:330.06ms
step:63/1750 train_loss:4.9953 train_time:17496ms step_avg:330.11ms
step:64/1750 train_loss:5.1300 train_time:17829ms step_avg:330.16ms
step:65/1750 train_loss:4.8390 train_time:18161ms step_avg:330.21ms
step:66/1750 train_loss:5.0015 train_time:18495ms step_avg:330.26ms
step:67/1750 train_loss:4.8609 train_time:18827ms step_avg:330.31ms
step:68/1750 train_loss:5.0976 train_time:19160ms step_avg:330.35ms
step:69/1750 train_loss:4.7542 train_time:19493ms step_avg:330.38ms
step:70/1750 train_loss:4.8471 train_time:19827ms step_avg:330.44ms
step:71/1750 train_loss:4.9816 train_time:20160ms step_avg:330.50ms
step:72/1750 train_loss:4.8948 train_time:20494ms step_avg:330.55ms
step:73/1750 train_loss:4.7897 train_time:20828ms step_avg:330.60ms
step:74/1750 train_loss:4.9425 train_time:21161ms step_avg:330.64ms
step:75/1750 train_loss:4.8752 train_time:21494ms step_avg:330.67ms
step:76/1750 train_loss:4.8134 train_time:21828ms step_avg:330.72ms
step:77/1750 train_loss:4.9310 train_time:22161ms step_avg:330.77ms
step:78/1750 train_loss:5.1200 train_time:22495ms step_avg:330.80ms
step:79/1750 train_loss:4.8486 train_time:22828ms step_avg:330.84ms
step:80/1750 train_loss:4.8631 train_time:23162ms step_avg:330.88ms
step:81/1750 train_loss:4.6456 train_time:23495ms step_avg:330.92ms
step:82/1750 train_loss:4.8182 train_time:23829ms step_avg:330.96ms
step:83/1750 train_loss:4.7610 train_time:24163ms step_avg:330.99ms
step:84/1750 train_loss:4.7542 train_time:24496ms step_avg:331.03ms
step:85/1750 train_loss:4.6279 train_time:24829ms step_avg:331.06ms
step:86/1750 train_loss:4.8465 train_time:25163ms step_avg:331.10ms
step:87/1750 train_loss:4.7382 train_time:25497ms step_avg:331.12ms
step:88/1750 train_loss:4.7214 train_time:25831ms step_avg:331.16ms
step:89/1750 train_loss:4.6740 train_time:26165ms step_avg:331.20ms
step:90/1750 train_loss:4.6307 train_time:26499ms step_avg:331.23ms
step:91/1750 train_loss:4.6156 train_time:26833ms step_avg:331.27ms
step:92/1750 train_loss:4.7708 train_time:27166ms step_avg:331.29ms
step:93/1750 train_loss:4.5805 train_time:27500ms step_avg:331.33ms
step:94/1750 train_loss:4.6376 train_time:27834ms step_avg:331.36ms
step:95/1750 train_loss:4.6736 train_time:28167ms step_avg:331.38ms
step:96/1750 train_loss:4.5850 train_time:28502ms step_avg:331.42ms
step:97/1750 train_loss:4.6287 train_time:28836ms step_avg:331.45ms
step:98/1750 train_loss:4.5801 train_time:29170ms step_avg:331.48ms
step:99/1750 train_loss:4.6580 train_time:29504ms step_avg:331.50ms
step:100/1750 train_loss:4.6756 train_time:29841ms step_avg:331.57ms
step:101/1750 train_loss:4.5138 train_time:30172ms step_avg:331.56ms
step:102/1750 train_loss:4.6907 train_time:30506ms step_avg:331.59ms
step:103/1750 train_loss:4.5540 train_time:30840ms step_avg:331.62ms
step:104/1750 train_loss:4.5314 train_time:31174ms step_avg:331.64ms
step:105/1750 train_loss:4.5505 train_time:31508ms step_avg:331.66ms
step:106/1750 train_loss:4.5765 train_time:31842ms step_avg:331.69ms
step:107/1750 train_loss:4.5038 train_time:32176ms step_avg:331.71ms
step:108/1750 train_loss:4.3601 train_time:32510ms step_avg:331.73ms
step:109/1750 train_loss:4.4937 train_time:32844ms step_avg:331.76ms
step:110/1750 train_loss:4.4664 train_time:33178ms step_avg:331.78ms
step:111/1750 train_loss:4.4121 train_time:33512ms step_avg:331.81ms
step:112/1750 train_loss:4.5739 train_time:33846ms step_avg:331.82ms
step:113/1750 train_loss:4.4885 train_time:34182ms step_avg:331.87ms
step:114/1750 train_loss:4.3642 train_time:34516ms step_avg:331.89ms
step:115/1750 train_loss:4.5096 train_time:34852ms step_avg:331.92ms
step:116/1750 train_loss:4.4714 train_time:35188ms step_avg:331.97ms
step:117/1750 train_loss:4.3744 train_time:35523ms step_avg:331.99ms
step:118/1750 train_loss:4.6116 train_time:35857ms step_avg:332.01ms
step:119/1750 train_loss:4.4766 train_time:36192ms step_avg:332.04ms
step:120/1750 train_loss:4.3647 train_time:36528ms step_avg:332.07ms
step:121/1750 train_loss:4.3140 train_time:36864ms step_avg:332.11ms
step:122/1750 train_loss:4.4669 train_time:37200ms step_avg:332.14ms
step:123/1750 train_loss:4.3081 train_time:37536ms step_avg:332.18ms
step:124/1750 train_loss:4.6055 train_time:37872ms step_avg:332.21ms
step:125/1750 train_loss:4.4879 train_time:38208ms step_avg:332.24ms
step:125/1750 val_loss:4.4249 train_time:38293ms step_avg:332.98ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 119.54897 | frobenius_norm = 27249.42383 | spectral_norm = 6670.23877 | nuclear_norm = 665088.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 39.43507 | spectral_norm = 3.16498 | nuclear_norm = 929.41754
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 37.18879 | spectral_norm = 4.71978 | nuclear_norm = 872.39587
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 97.87459 | spectral_norm = 6.60237 | nuclear_norm = 2303.98901
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 100.03524 | spectral_norm = 10.99967 | nuclear_norm = 2372.70630
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 79.87727 | spectral_norm = 5.25862 | nuclear_norm = 2122.03516
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 41.98927 | spectral_norm = 2.77160 | nuclear_norm = 1115.71704
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 36.60121 | spectral_norm = 3.26663 | nuclear_norm = 860.51990
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 35.72303 | spectral_norm = 3.86627 | nuclear_norm = 838.81036
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 111.48012 | spectral_norm = 9.83014 | nuclear_norm = 2568.86255
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 116.34243 | spectral_norm = 11.28788 | nuclear_norm = 2774.07129
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 86.17236 | spectral_norm = 5.50410 | nuclear_norm = 2289.55176
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 44.44437 | spectral_norm = 3.04189 | nuclear_norm = 1179.84326
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 35.34197 | spectral_norm = 2.93133 | nuclear_norm = 820.43689
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 35.74995 | spectral_norm = 3.52127 | nuclear_norm = 831.77930
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 110.15730 | spectral_norm = 10.38429 | nuclear_norm = 2506.44287
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 118.23975 | spectral_norm = 10.93116 | nuclear_norm = 2819.43359
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 88.18238 | spectral_norm = 5.56935 | nuclear_norm = 2340.74170
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 44.74869 | spectral_norm = 3.11135 | nuclear_norm = 1185.80396
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 35.75285 | spectral_norm = 2.99067 | nuclear_norm = 838.30408
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 35.79468 | spectral_norm = 3.49560 | nuclear_norm = 839.01111
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 106.73695 | spectral_norm = 10.37134 | nuclear_norm = 2384.56079
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 112.99545 | spectral_norm = 10.04869 | nuclear_norm = 2671.20557
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 88.09925 | spectral_norm = 5.60985 | nuclear_norm = 2335.06104
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 44.54128 | spectral_norm = 3.17783 | nuclear_norm = 1177.47974
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 35.54471 | spectral_norm = 2.98923 | nuclear_norm = 832.45868
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 35.94139 | spectral_norm = 3.24686 | nuclear_norm = 842.72021
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 105.08361 | spectral_norm = 10.37520 | nuclear_norm = 2324.27808
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 107.71917 | spectral_norm = 10.11524 | nuclear_norm = 2532.80762
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 88.11463 | spectral_norm = 5.55323 | nuclear_norm = 2335.14868
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 44.39953 | spectral_norm = 3.19324 | nuclear_norm = 1172.62695
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 34.77689 | spectral_norm = 2.90687 | nuclear_norm = 812.92474
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 35.41348 | spectral_norm = 3.01063 | nuclear_norm = 829.20569
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 100.63564 | spectral_norm = 10.45758 | nuclear_norm = 2200.83130
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 102.04572 | spectral_norm = 10.01232 | nuclear_norm = 2402.74634
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 84.70284 | spectral_norm = 5.33380 | nuclear_norm = 2240.70117
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 43.12347 | spectral_norm = 3.13104 | nuclear_norm = 1134.95630
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 33.95103 | spectral_norm = 2.95779 | nuclear_norm = 792.21191
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 34.59045 | spectral_norm = 2.92096 | nuclear_norm = 808.03503
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 96.57463 | spectral_norm = 9.60128 | nuclear_norm = 2113.46167
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 105.35441 | spectral_norm = 10.04213 | nuclear_norm = 2489.45068
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 84.91460 | spectral_norm = 5.48337 | nuclear_norm = 2244.08276
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 42.67664 | spectral_norm = 2.98356 | nuclear_norm = 1121.48413
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 34.30888 | spectral_norm = 2.82592 | nuclear_norm = 800.46106
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 35.06255 | spectral_norm = 2.88016 | nuclear_norm = 818.32727
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 103.78749 | spectral_norm = 10.64664 | nuclear_norm = 2248.74731
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 107.40185 | spectral_norm = 10.21192 | nuclear_norm = 2547.75830
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 83.90713 | spectral_norm = 5.52616 | nuclear_norm = 2214.39893
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 42.14106 | spectral_norm = 2.99405 | nuclear_norm = 1105.30151
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 34.27832 | spectral_norm = 2.86135 | nuclear_norm = 796.36487
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 35.02246 | spectral_norm = 2.83317 | nuclear_norm = 814.07794
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 103.64580 | spectral_norm = 10.43646 | nuclear_norm = 2294.32324
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 112.17527 | spectral_norm = 10.47774 | nuclear_norm = 2685.79443
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 83.70854 | spectral_norm = 5.60999 | nuclear_norm = 2209.55664
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 41.88010 | spectral_norm = 2.97551 | nuclear_norm = 1098.80762
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 34.40834 | spectral_norm = 2.84201 | nuclear_norm = 799.50354
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 34.97401 | spectral_norm = 2.86342 | nuclear_norm = 812.73431
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 113.98274 | spectral_norm = 10.83113 | nuclear_norm = 2533.21899
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 113.65780 | spectral_norm = 10.36970 | nuclear_norm = 2728.88379
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 84.36360 | spectral_norm = 5.96661 | nuclear_norm = 2229.16528
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 41.87342 | spectral_norm = 2.92600 | nuclear_norm = 1099.63647
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 34.62489 | spectral_norm = 2.87148 | nuclear_norm = 801.38916
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 35.10997 | spectral_norm = 2.96687 | nuclear_norm = 813.67279
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 103.96077 | spectral_norm = 9.96846 | nuclear_norm = 2341.08057
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 115.55575 | spectral_norm = 9.49103 | nuclear_norm = 2787.16626
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 83.42580 | spectral_norm = 5.97266 | nuclear_norm = 2205.17407
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 41.20158 | spectral_norm = 2.88303 | nuclear_norm = 1080.00012
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 34.53811 | spectral_norm = 2.85491 | nuclear_norm = 798.38934
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 34.86686 | spectral_norm = 3.00428 | nuclear_norm = 804.24829
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 96.25464 | spectral_norm = 9.84641 | nuclear_norm = 2145.32715
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 111.11001 | spectral_norm = 8.61038 | nuclear_norm = 2672.93408
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 83.21380 | spectral_norm = 6.41199 | nuclear_norm = 2199.09717
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 40.36447 | spectral_norm = 2.90815 | nuclear_norm = 1055.11011
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 387.24524 | spectral_norm = 131.57622 | nuclear_norm = 9270.55273
===========================================
step:126/1750 train_loss:4.4401 train_time:38543ms step_avg:332.26ms
step:127/1750 train_loss:4.4667 train_time:38874ms step_avg:332.26ms
step:128/1750 train_loss:4.3964 train_time:39207ms step_avg:332.26ms
step:129/1750 train_loss:4.7135 train_time:39539ms step_avg:332.26ms
step:130/1750 train_loss:4.3907 train_time:39871ms step_avg:332.26ms
step:131/1750 train_loss:4.4102 train_time:40210ms step_avg:332.31ms
step:132/1750 train_loss:4.3547 train_time:40554ms step_avg:332.41ms
step:133/1750 train_loss:4.4613 train_time:40896ms step_avg:332.49ms
step:134/1750 train_loss:4.2659 train_time:41242ms step_avg:332.59ms
step:135/1750 train_loss:4.4434 train_time:41585ms step_avg:332.68ms
step:136/1750 train_loss:4.2042 train_time:41929ms step_avg:332.77ms
step:137/1750 train_loss:4.3726 train_time:42273ms step_avg:332.86ms
step:138/1750 train_loss:4.2805 train_time:42616ms step_avg:332.94ms
step:139/1750 train_loss:4.3780 train_time:42959ms step_avg:333.02ms
step:140/1750 train_loss:4.4746 train_time:43303ms step_avg:333.10ms
step:141/1750 train_loss:4.2980 train_time:43648ms step_avg:333.19ms
step:142/1750 train_loss:4.2937 train_time:43995ms step_avg:333.29ms
step:143/1750 train_loss:4.2480 train_time:44339ms step_avg:333.38ms
step:144/1750 train_loss:4.3520 train_time:44685ms step_avg:333.47ms
step:145/1750 train_loss:4.2990 train_time:45029ms step_avg:333.55ms
step:146/1750 train_loss:4.1683 train_time:45373ms step_avg:333.62ms
step:147/1750 train_loss:4.3255 train_time:45717ms step_avg:333.70ms
step:148/1750 train_loss:4.3615 train_time:46061ms step_avg:333.78ms
step:149/1750 train_loss:4.2985 train_time:46408ms step_avg:333.87ms
step:150/1750 train_loss:4.4408 train_time:46754ms step_avg:333.95ms
step:151/1750 train_loss:4.2570 train_time:47098ms step_avg:334.03ms
step:152/1750 train_loss:4.2597 train_time:47443ms step_avg:334.11ms
step:153/1750 train_loss:4.3646 train_time:47790ms step_avg:334.19ms
step:154/1750 train_loss:4.3557 train_time:48134ms step_avg:334.27ms
step:155/1750 train_loss:4.2776 train_time:48481ms step_avg:334.35ms
step:156/1750 train_loss:4.3451 train_time:48827ms step_avg:334.43ms
step:157/1750 train_loss:4.4015 train_time:49172ms step_avg:334.50ms
step:158/1750 train_loss:4.2397 train_time:49517ms step_avg:334.58ms
step:159/1750 train_loss:4.3108 train_time:49861ms step_avg:334.64ms
step:160/1750 train_loss:4.1248 train_time:50205ms step_avg:334.70ms
step:161/1750 train_loss:4.3481 train_time:50550ms step_avg:334.77ms
step:162/1750 train_loss:4.3529 train_time:50895ms step_avg:334.84ms
step:163/1750 train_loss:4.3253 train_time:51240ms step_avg:334.90ms
step:164/1750 train_loss:4.1841 train_time:51584ms step_avg:334.96ms
step:165/1750 train_loss:4.2836 train_time:51929ms step_avg:335.02ms
step:166/1750 train_loss:4.3470 train_time:52273ms step_avg:335.08ms
step:167/1750 train_loss:4.1895 train_time:52617ms step_avg:335.14ms
step:168/1750 train_loss:4.2777 train_time:52962ms step_avg:335.20ms
step:169/1750 train_loss:4.1572 train_time:53306ms step_avg:335.26ms
step:170/1750 train_loss:4.0254 train_time:53651ms step_avg:335.32ms
step:171/1750 train_loss:4.2180 train_time:53997ms step_avg:335.38ms
step:172/1750 train_loss:4.2225 train_time:54341ms step_avg:335.44ms
step:173/1750 train_loss:4.2776 train_time:54686ms step_avg:335.49ms
step:174/1750 train_loss:4.4359 train_time:55029ms step_avg:335.55ms
step:175/1750 train_loss:4.2539 train_time:55374ms step_avg:335.60ms
step:176/1750 train_loss:4.0979 train_time:55718ms step_avg:335.65ms
step:177/1750 train_loss:4.0763 train_time:56064ms step_avg:335.71ms
step:178/1750 train_loss:4.1923 train_time:56409ms step_avg:335.77ms
step:179/1750 train_loss:4.1375 train_time:56754ms step_avg:335.82ms
step:180/1750 train_loss:4.1186 train_time:57099ms step_avg:335.88ms
step:181/1750 train_loss:4.2974 train_time:57444ms step_avg:335.93ms
step:182/1750 train_loss:4.1669 train_time:57788ms step_avg:335.98ms
step:183/1750 train_loss:4.1294 train_time:58131ms step_avg:336.02ms
step:184/1750 train_loss:4.1263 train_time:58476ms step_avg:336.07ms
step:185/1750 train_loss:4.2132 train_time:58822ms step_avg:336.13ms
step:186/1750 train_loss:4.1791 train_time:59166ms step_avg:336.17ms
step:187/1750 train_loss:4.2438 train_time:59513ms step_avg:336.23ms
step:188/1750 train_loss:4.1789 train_time:59907ms step_avg:336.56ms
step:189/1750 train_loss:4.1172 train_time:60581ms step_avg:338.44ms
step:190/1750 train_loss:4.2109 train_time:60928ms step_avg:338.49ms
step:191/1750 train_loss:4.0915 train_time:61274ms step_avg:338.53ms
step:192/1750 train_loss:4.0338 train_time:61619ms step_avg:338.57ms
step:193/1750 train_loss:4.2650 train_time:61963ms step_avg:338.60ms
step:194/1750 train_loss:4.1826 train_time:62307ms step_avg:338.62ms
step:195/1750 train_loss:4.3690 train_time:62651ms step_avg:338.66ms
step:196/1750 train_loss:4.1834 train_time:62997ms step_avg:338.69ms
step:197/1750 train_loss:4.0454 train_time:63341ms step_avg:338.72ms
step:198/1750 train_loss:4.1746 train_time:63686ms step_avg:338.76ms
step:199/1750 train_loss:4.0319 train_time:64030ms step_avg:338.79ms
step:200/1750 train_loss:4.1144 train_time:64376ms step_avg:338.82ms
step:201/1750 train_loss:4.0259 train_time:64717ms step_avg:338.83ms
step:202/1750 train_loss:4.2650 train_time:65063ms step_avg:338.87ms
step:203/1750 train_loss:4.0625 train_time:65406ms step_avg:338.89ms
step:204/1750 train_loss:4.1988 train_time:65748ms step_avg:338.91ms
step:205/1750 train_loss:4.2519 train_time:66090ms step_avg:338.92ms
step:206/1750 train_loss:3.9459 train_time:66433ms step_avg:338.94ms
step:207/1750 train_loss:4.0788 train_time:66775ms step_avg:338.96ms
step:208/1750 train_loss:4.0835 train_time:67118ms step_avg:338.98ms
step:209/1750 train_loss:4.2314 train_time:67463ms step_avg:339.01ms
step:210/1750 train_loss:4.1762 train_time:67808ms step_avg:339.04ms
step:211/1750 train_loss:4.0584 train_time:68152ms step_avg:339.06ms
step:212/1750 train_loss:4.1194 train_time:68495ms step_avg:339.08ms
step:213/1750 train_loss:4.0388 train_time:68838ms step_avg:339.10ms
step:214/1750 train_loss:4.1062 train_time:69181ms step_avg:339.12ms
step:215/1750 train_loss:3.9504 train_time:69526ms step_avg:339.15ms
step:216/1750 train_loss:4.0103 train_time:69869ms step_avg:339.17ms
step:217/1750 train_loss:4.0059 train_time:70212ms step_avg:339.19ms
step:218/1750 train_loss:4.0850 train_time:70555ms step_avg:339.21ms
step:219/1750 train_loss:4.0753 train_time:70899ms step_avg:339.23ms
step:220/1750 train_loss:4.0726 train_time:71242ms step_avg:339.25ms
step:221/1750 train_loss:4.0948 train_time:71585ms step_avg:339.27ms
step:222/1750 train_loss:3.9902 train_time:71928ms step_avg:339.28ms
step:223/1750 train_loss:3.9865 train_time:72272ms step_avg:339.31ms
step:224/1750 train_loss:4.2979 train_time:72615ms step_avg:339.32ms
step:225/1750 train_loss:3.8833 train_time:72957ms step_avg:339.34ms
step:226/1750 train_loss:3.9855 train_time:73300ms step_avg:339.35ms
step:227/1750 train_loss:3.9805 train_time:73644ms step_avg:339.37ms
step:228/1750 train_loss:4.1426 train_time:73986ms step_avg:339.39ms
step:229/1750 train_loss:3.9236 train_time:74329ms step_avg:339.40ms
step:230/1750 train_loss:4.0549 train_time:74673ms step_avg:339.42ms
step:231/1750 train_loss:3.9029 train_time:75017ms step_avg:339.45ms
step:232/1750 train_loss:3.9707 train_time:75362ms step_avg:339.47ms
step:233/1750 train_loss:4.0843 train_time:75706ms step_avg:339.49ms
step:234/1750 train_loss:4.0257 train_time:76050ms step_avg:339.51ms
step:235/1750 train_loss:3.9053 train_time:76393ms step_avg:339.53ms
step:236/1750 train_loss:4.0873 train_time:76736ms step_avg:339.54ms
step:237/1750 train_loss:4.0940 train_time:77081ms step_avg:339.56ms
step:238/1750 train_loss:3.9519 train_time:77425ms step_avg:339.58ms
step:239/1750 train_loss:4.0931 train_time:77769ms step_avg:339.60ms
step:240/1750 train_loss:4.1238 train_time:78113ms step_avg:339.62ms
step:241/1750 train_loss:3.9764 train_time:78456ms step_avg:339.63ms
step:242/1750 train_loss:4.1520 train_time:78801ms step_avg:339.66ms
step:243/1750 train_loss:4.0291 train_time:79143ms step_avg:339.67ms
step:244/1750 train_loss:4.0875 train_time:79487ms step_avg:339.69ms
step:245/1750 train_loss:4.1470 train_time:79831ms step_avg:339.71ms
step:246/1750 train_loss:4.0615 train_time:80175ms step_avg:339.73ms
step:247/1750 train_loss:4.0056 train_time:80518ms step_avg:339.74ms
step:248/1750 train_loss:4.1080 train_time:80861ms step_avg:339.75ms
step:249/1750 train_loss:3.9219 train_time:81204ms step_avg:339.76ms
step:250/1750 train_loss:3.9758 train_time:81546ms step_avg:339.78ms
step:250/1750 val_loss:4.0078 train_time:81632ms step_avg:340.13ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 157.98029 | frobenius_norm = 36086.62109 | spectral_norm = 7487.83594 | nuclear_norm = 889981.12500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 60.17100 | spectral_norm = 6.56065 | nuclear_norm = 1410.75623
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 57.60154 | spectral_norm = 8.66557 | nuclear_norm = 1342.53516
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 145.51373 | spectral_norm = 9.51495 | nuclear_norm = 3467.95337
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 137.60283 | spectral_norm = 12.80917 | nuclear_norm = 3228.37256
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 124.29874 | spectral_norm = 9.14324 | nuclear_norm = 3298.96387
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 63.96664 | spectral_norm = 4.67524 | nuclear_norm = 1694.90063
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 57.82589 | spectral_norm = 5.30018 | nuclear_norm = 1354.13745
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 56.63812 | spectral_norm = 6.27529 | nuclear_norm = 1326.15894
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 169.85806 | spectral_norm = 13.64671 | nuclear_norm = 3931.34155
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 168.76076 | spectral_norm = 14.18501 | nuclear_norm = 3965.96167
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 134.36899 | spectral_norm = 9.21023 | nuclear_norm = 3563.96436
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 67.88025 | spectral_norm = 5.32350 | nuclear_norm = 1795.37305
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 56.01943 | spectral_norm = 4.90864 | nuclear_norm = 1281.48486
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 56.32542 | spectral_norm = 5.33561 | nuclear_norm = 1294.44287
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 171.34436 | spectral_norm = 14.03673 | nuclear_norm = 3949.81079
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 176.02061 | spectral_norm = 13.98182 | nuclear_norm = 4169.22559
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 137.82741 | spectral_norm = 9.12119 | nuclear_norm = 3657.88867
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 68.26855 | spectral_norm = 5.32752 | nuclear_norm = 1804.34900
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 57.08212 | spectral_norm = 5.02327 | nuclear_norm = 1336.82227
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 56.39663 | spectral_norm = 5.92814 | nuclear_norm = 1320.13647
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 169.90724 | spectral_norm = 14.21046 | nuclear_norm = 3885.30615
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 174.07863 | spectral_norm = 13.28710 | nuclear_norm = 4101.50684
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 140.53046 | spectral_norm = 9.79066 | nuclear_norm = 3724.53760
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 69.06289 | spectral_norm = 5.42632 | nuclear_norm = 1823.79724
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 56.89713 | spectral_norm = 5.02376 | nuclear_norm = 1331.48291
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 57.01734 | spectral_norm = 5.40216 | nuclear_norm = 1336.02722
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 171.58340 | spectral_norm = 14.27254 | nuclear_norm = 3919.34766
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 170.46230 | spectral_norm = 13.30233 | nuclear_norm = 4015.30200
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 139.57524 | spectral_norm = 9.60392 | nuclear_norm = 3701.27832
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 68.77177 | spectral_norm = 5.34572 | nuclear_norm = 1815.98450
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 56.19686 | spectral_norm = 4.69815 | nuclear_norm = 1309.87476
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 56.57812 | spectral_norm = 4.81257 | nuclear_norm = 1321.58240
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 168.51437 | spectral_norm = 14.43775 | nuclear_norm = 3824.61499
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 163.79082 | spectral_norm = 13.18573 | nuclear_norm = 3855.28345
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 137.07401 | spectral_norm = 8.98482 | nuclear_norm = 3637.39258
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 67.75113 | spectral_norm = 5.30222 | nuclear_norm = 1785.55298
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 55.40234 | spectral_norm = 5.01721 | nuclear_norm = 1292.38293
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 55.03174 | spectral_norm = 4.79106 | nuclear_norm = 1286.15747
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 164.42966 | spectral_norm = 13.86435 | nuclear_norm = 3753.62231
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 166.52057 | spectral_norm = 12.31528 | nuclear_norm = 3924.46509
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 137.27373 | spectral_norm = 9.49135 | nuclear_norm = 3639.43604
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 67.49556 | spectral_norm = 5.22711 | nuclear_norm = 1776.41736
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 56.82141 | spectral_norm = 4.74094 | nuclear_norm = 1326.00562
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 57.09652 | spectral_norm = 4.80747 | nuclear_norm = 1332.63269
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 173.69382 | spectral_norm = 14.44946 | nuclear_norm = 3967.37671
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 170.31740 | spectral_norm = 12.68768 | nuclear_norm = 4022.61279
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 136.30087 | spectral_norm = 9.75853 | nuclear_norm = 3612.65405
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 67.19313 | spectral_norm = 5.31506 | nuclear_norm = 1768.69348
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 56.80125 | spectral_norm = 4.80002 | nuclear_norm = 1319.36108
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 57.24439 | spectral_norm = 4.53123 | nuclear_norm = 1327.12732
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 173.53311 | spectral_norm = 14.16283 | nuclear_norm = 3985.63403
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 177.61226 | spectral_norm = 12.86657 | nuclear_norm = 4230.43457
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 135.64641 | spectral_norm = 9.63818 | nuclear_norm = 3593.53271
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 66.83305 | spectral_norm = 5.33858 | nuclear_norm = 1761.02100
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 57.15747 | spectral_norm = 4.95113 | nuclear_norm = 1327.16870
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 57.23223 | spectral_norm = 4.75398 | nuclear_norm = 1327.52441
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 180.08188 | spectral_norm = 14.94651 | nuclear_norm = 4156.89551
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 178.66806 | spectral_norm = 12.37636 | nuclear_norm = 4254.48145
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 135.34695 | spectral_norm = 9.60278 | nuclear_norm = 3588.46436
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 66.95708 | spectral_norm = 5.35070 | nuclear_norm = 1767.89087
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 57.30402 | spectral_norm = 5.03356 | nuclear_norm = 1324.23584
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 57.17535 | spectral_norm = 4.81115 | nuclear_norm = 1318.39697
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 172.92642 | spectral_norm = 13.50535 | nuclear_norm = 4003.56348
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 183.02365 | spectral_norm = 12.46296 | nuclear_norm = 4354.74512
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 135.53394 | spectral_norm = 9.48217 | nuclear_norm = 3596.54053
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 67.26727 | spectral_norm = 5.28902 | nuclear_norm = 1776.16223
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 57.12164 | spectral_norm = 5.37081 | nuclear_norm = 1314.23035
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 56.65065 | spectral_norm = 5.30158 | nuclear_norm = 1292.96045
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 156.55180 | spectral_norm = 13.06513 | nuclear_norm = 3598.64355
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 176.20067 | spectral_norm = 12.34297 | nuclear_norm = 4157.15479
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 136.31029 | spectral_norm = 9.84135 | nuclear_norm = 3615.83984
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 66.07691 | spectral_norm = 5.43719 | nuclear_norm = 1737.35352
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 554.79254 | spectral_norm = 154.37715 | nuclear_norm = 13835.02734
===========================================
step:251/1750 train_loss:4.0744 train_time:81885ms step_avg:339.77ms
step:252/1750 train_loss:4.1639 train_time:82224ms step_avg:339.77ms
step:253/1750 train_loss:3.9345 train_time:82565ms step_avg:339.77ms
step:254/1750 train_loss:3.8747 train_time:82907ms step_avg:339.78ms
step:255/1750 train_loss:4.0722 train_time:83248ms step_avg:339.79ms
step:256/1750 train_loss:3.9898 train_time:83590ms step_avg:339.80ms
step:257/1750 train_loss:3.9954 train_time:83932ms step_avg:339.80ms
step:258/1750 train_loss:3.9936 train_time:84275ms step_avg:339.82ms
step:259/1750 train_loss:4.0341 train_time:84617ms step_avg:339.83ms
step:260/1750 train_loss:4.0590 train_time:84960ms step_avg:339.84ms
step:261/1750 train_loss:4.0172 train_time:85307ms step_avg:339.87ms
step:262/1750 train_loss:3.9948 train_time:85659ms step_avg:339.92ms
step:263/1750 train_loss:3.8817 train_time:86012ms step_avg:339.97ms
step:264/1750 train_loss:3.9804 train_time:86364ms step_avg:340.02ms
step:265/1750 train_loss:3.8639 train_time:86719ms step_avg:340.07ms
step:266/1750 train_loss:3.9190 train_time:87071ms step_avg:340.12ms
step:267/1750 train_loss:3.9178 train_time:87426ms step_avg:340.18ms
step:268/1750 train_loss:3.9458 train_time:87779ms step_avg:340.23ms
step:269/1750 train_loss:3.8563 train_time:88132ms step_avg:340.28ms
step:270/1750 train_loss:4.0927 train_time:88484ms step_avg:340.32ms
step:271/1750 train_loss:3.9629 train_time:88836ms step_avg:340.37ms
step:272/1750 train_loss:3.9222 train_time:89190ms step_avg:340.42ms
step:273/1750 train_loss:3.9462 train_time:89540ms step_avg:340.46ms
step:274/1750 train_loss:4.0459 train_time:89893ms step_avg:340.50ms
step:275/1750 train_loss:4.0556 train_time:90245ms step_avg:340.55ms
step:276/1750 train_loss:4.2184 train_time:90597ms step_avg:340.59ms
step:277/1750 train_loss:4.0276 train_time:90948ms step_avg:340.63ms
step:278/1750 train_loss:4.0844 train_time:91299ms step_avg:340.67ms
step:279/1750 train_loss:3.9952 train_time:91651ms step_avg:340.71ms
step:280/1750 train_loss:4.1820 train_time:92005ms step_avg:340.76ms
step:281/1750 train_loss:3.9617 train_time:92361ms step_avg:340.81ms
step:282/1750 train_loss:3.9341 train_time:92715ms step_avg:340.86ms
step:283/1750 train_loss:3.9088 train_time:93067ms step_avg:340.91ms
step:284/1750 train_loss:4.0496 train_time:93419ms step_avg:340.95ms
step:285/1750 train_loss:4.0673 train_time:93771ms step_avg:340.98ms
step:286/1750 train_loss:4.0879 train_time:94125ms step_avg:341.03ms
step:287/1750 train_loss:3.9071 train_time:94477ms step_avg:341.07ms
step:288/1750 train_loss:4.0108 train_time:94831ms step_avg:341.12ms
step:289/1750 train_loss:3.8855 train_time:95182ms step_avg:341.15ms
step:290/1750 train_loss:3.8549 train_time:95535ms step_avg:341.20ms
step:291/1750 train_loss:3.9142 train_time:95888ms step_avg:341.24ms
step:292/1750 train_loss:3.8656 train_time:96240ms step_avg:341.28ms
step:293/1750 train_loss:3.9132 train_time:96592ms step_avg:341.31ms
step:294/1750 train_loss:3.9480 train_time:96942ms step_avg:341.35ms
step:295/1750 train_loss:3.8355 train_time:97296ms step_avg:341.39ms
step:296/1750 train_loss:3.8624 train_time:97650ms step_avg:341.43ms
step:297/1750 train_loss:3.8726 train_time:98003ms step_avg:341.47ms
step:298/1750 train_loss:3.9703 train_time:98354ms step_avg:341.51ms
step:299/1750 train_loss:3.8205 train_time:98706ms step_avg:341.54ms
step:300/1750 train_loss:3.9625 train_time:99064ms step_avg:341.60ms
step:301/1750 train_loss:3.9801 train_time:99413ms step_avg:341.63ms
step:302/1750 train_loss:3.9375 train_time:99765ms step_avg:341.66ms
step:303/1750 train_loss:3.9825 train_time:100117ms step_avg:341.70ms
step:304/1750 train_loss:3.9652 train_time:100468ms step_avg:341.73ms
step:305/1750 train_loss:4.4632 train_time:100819ms step_avg:341.76ms
step:306/1750 train_loss:3.9370 train_time:101169ms step_avg:341.79ms
step:307/1750 train_loss:3.8416 train_time:101521ms step_avg:341.82ms
step:308/1750 train_loss:3.9808 train_time:101874ms step_avg:341.86ms
step:309/1750 train_loss:3.8673 train_time:102225ms step_avg:341.89ms
step:310/1750 train_loss:4.0853 train_time:102578ms step_avg:341.93ms
step:311/1750 train_loss:3.9314 train_time:102933ms step_avg:341.97ms
step:312/1750 train_loss:3.8623 train_time:103285ms step_avg:342.00ms
step:313/1750 train_loss:3.9383 train_time:103639ms step_avg:342.04ms
step:314/1750 train_loss:4.0645 train_time:103994ms step_avg:342.08ms
step:315/1750 train_loss:3.9472 train_time:104346ms step_avg:342.12ms
step:316/1750 train_loss:3.7933 train_time:104698ms step_avg:342.15ms
step:317/1750 train_loss:3.8685 train_time:105052ms step_avg:342.19ms
step:318/1750 train_loss:3.9215 train_time:105403ms step_avg:342.22ms
step:319/1750 train_loss:3.8901 train_time:105756ms step_avg:342.25ms
step:320/1750 train_loss:4.0166 train_time:106108ms step_avg:342.28ms
step:321/1750 train_loss:3.9563 train_time:106461ms step_avg:342.32ms
step:322/1750 train_loss:3.9330 train_time:106815ms step_avg:342.36ms
step:323/1750 train_loss:4.0076 train_time:107166ms step_avg:342.38ms
step:324/1750 train_loss:3.9624 train_time:107518ms step_avg:342.42ms
step:325/1750 train_loss:4.0171 train_time:107869ms step_avg:342.44ms
step:326/1750 train_loss:3.8878 train_time:108221ms step_avg:342.47ms
step:327/1750 train_loss:4.3890 train_time:108573ms step_avg:342.50ms
step:328/1750 train_loss:4.0687 train_time:108925ms step_avg:342.53ms
step:329/1750 train_loss:3.7939 train_time:109276ms step_avg:342.56ms
step:330/1750 train_loss:3.7468 train_time:109627ms step_avg:342.59ms
step:331/1750 train_loss:3.9782 train_time:109977ms step_avg:342.61ms
step:332/1750 train_loss:3.9032 train_time:110326ms step_avg:342.63ms
step:333/1750 train_loss:3.8782 train_time:110676ms step_avg:342.65ms
step:334/1750 train_loss:3.8431 train_time:111027ms step_avg:342.68ms
step:335/1750 train_loss:4.0072 train_time:111379ms step_avg:342.70ms
step:336/1750 train_loss:3.9646 train_time:111728ms step_avg:342.72ms
step:337/1750 train_loss:4.4130 train_time:112078ms step_avg:342.75ms
step:338/1750 train_loss:3.9370 train_time:112427ms step_avg:342.77ms
step:339/1750 train_loss:3.8612 train_time:112779ms step_avg:342.79ms
step:340/1750 train_loss:3.9288 train_time:113130ms step_avg:342.82ms
step:341/1750 train_loss:3.8489 train_time:113480ms step_avg:342.84ms
step:342/1750 train_loss:3.8096 train_time:113829ms step_avg:342.86ms
step:343/1750 train_loss:3.8293 train_time:114179ms step_avg:342.88ms
step:344/1750 train_loss:3.9953 train_time:114528ms step_avg:342.90ms
step:345/1750 train_loss:3.8125 train_time:114880ms step_avg:342.93ms
step:346/1750 train_loss:3.7680 train_time:115231ms step_avg:342.95ms
step:347/1750 train_loss:3.7996 train_time:115581ms step_avg:342.97ms
step:348/1750 train_loss:3.8530 train_time:115931ms step_avg:342.99ms
step:349/1750 train_loss:3.8372 train_time:116283ms step_avg:343.02ms
step:350/1750 train_loss:3.5680 train_time:116632ms step_avg:343.03ms
step:351/1750 train_loss:3.8194 train_time:116981ms step_avg:343.05ms
step:352/1750 train_loss:4.2044 train_time:117330ms step_avg:343.07ms
step:353/1750 train_loss:3.6546 train_time:117681ms step_avg:343.09ms
step:354/1750 train_loss:3.9251 train_time:118031ms step_avg:343.11ms
step:355/1750 train_loss:3.7871 train_time:118383ms step_avg:343.14ms
step:356/1750 train_loss:3.8842 train_time:118733ms step_avg:343.16ms
step:357/1750 train_loss:3.7537 train_time:119086ms step_avg:343.19ms
step:358/1750 train_loss:3.8615 train_time:119436ms step_avg:343.21ms
step:359/1750 train_loss:3.8075 train_time:119787ms step_avg:343.23ms
step:360/1750 train_loss:3.4214 train_time:120139ms step_avg:343.25ms
step:361/1750 train_loss:4.0297 train_time:120491ms step_avg:343.28ms
step:362/1750 train_loss:3.9237 train_time:120841ms step_avg:343.30ms
step:363/1750 train_loss:3.8445 train_time:121190ms step_avg:343.32ms
step:364/1750 train_loss:3.7388 train_time:121541ms step_avg:343.34ms
step:365/1750 train_loss:3.9171 train_time:121892ms step_avg:343.36ms
step:366/1750 train_loss:3.8706 train_time:122243ms step_avg:343.38ms
step:367/1750 train_loss:3.8601 train_time:122594ms step_avg:343.40ms
step:368/1750 train_loss:3.8504 train_time:122943ms step_avg:343.42ms
step:369/1750 train_loss:3.7466 train_time:123294ms step_avg:343.44ms
step:370/1750 train_loss:3.8891 train_time:123645ms step_avg:343.46ms
step:371/1750 train_loss:3.7403 train_time:123996ms step_avg:343.48ms
step:372/1750 train_loss:3.6948 train_time:124347ms step_avg:343.50ms
step:373/1750 train_loss:3.9133 train_time:124696ms step_avg:343.51ms
step:374/1750 train_loss:3.8277 train_time:125047ms step_avg:343.54ms
step:375/1750 train_loss:3.8010 train_time:125399ms step_avg:343.56ms
step:375/1750 val_loss:3.8278 train_time:125489ms step_avg:343.81ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 185.62651 | frobenius_norm = 42490.26953 | spectral_norm = 8208.21973 | nuclear_norm = 1053118.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 85.39511 | spectral_norm = 10.80229 | nuclear_norm = 1999.30176
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 82.31022 | spectral_norm = 12.67739 | nuclear_norm = 1915.45386
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 189.34021 | spectral_norm = 12.17797 | nuclear_norm = 4542.96094
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 170.85948 | spectral_norm = 14.58396 | nuclear_norm = 4000.86230
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 176.74655 | spectral_norm = 13.47567 | nuclear_norm = 4696.45020
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 90.06434 | spectral_norm = 6.79958 | nuclear_norm = 2385.21973
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 83.55914 | spectral_norm = 7.77957 | nuclear_norm = 1955.96899
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 82.08804 | spectral_norm = 8.66194 | nuclear_norm = 1921.04749
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 209.38028 | spectral_norm = 17.39554 | nuclear_norm = 4824.66992
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 208.61417 | spectral_norm = 15.88566 | nuclear_norm = 4878.20703
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 186.87236 | spectral_norm = 13.17713 | nuclear_norm = 4958.03857
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 93.11545 | spectral_norm = 7.96239 | nuclear_norm = 2455.79663
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 80.46253 | spectral_norm = 7.19526 | nuclear_norm = 1834.96155
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 80.89352 | spectral_norm = 7.33211 | nuclear_norm = 1853.19385
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 213.82863 | spectral_norm = 18.21552 | nuclear_norm = 4911.87646
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 218.81866 | spectral_norm = 16.30894 | nuclear_norm = 5159.40527
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 191.32454 | spectral_norm = 13.22839 | nuclear_norm = 5082.22656
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 93.09800 | spectral_norm = 7.95979 | nuclear_norm = 2454.44800
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 82.63486 | spectral_norm = 7.35408 | nuclear_norm = 1934.31018
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 81.71951 | spectral_norm = 8.46713 | nuclear_norm = 1911.09131
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 215.48871 | spectral_norm = 18.24902 | nuclear_norm = 4922.97705
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 219.20131 | spectral_norm = 16.51581 | nuclear_norm = 5144.13086
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 195.99062 | spectral_norm = 14.36009 | nuclear_norm = 5196.91992
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 94.96107 | spectral_norm = 7.97160 | nuclear_norm = 2500.35938
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 82.30766 | spectral_norm = 7.45651 | nuclear_norm = 1924.14453
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 82.50493 | spectral_norm = 7.82603 | nuclear_norm = 1932.45557
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 220.70915 | spectral_norm = 18.37323 | nuclear_norm = 5042.25000
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 217.91257 | spectral_norm = 16.31514 | nuclear_norm = 5118.77539
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 194.93652 | spectral_norm = 14.03473 | nuclear_norm = 5175.07910
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 94.92130 | spectral_norm = 7.71472 | nuclear_norm = 2501.34326
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 81.36094 | spectral_norm = 6.96370 | nuclear_norm = 1892.25623
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 81.69545 | spectral_norm = 7.06370 | nuclear_norm = 1903.63745
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 219.34540 | spectral_norm = 18.74879 | nuclear_norm = 4980.01562
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 211.61195 | spectral_norm = 17.02430 | nuclear_norm = 4971.20361
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 193.55443 | spectral_norm = 12.92234 | nuclear_norm = 5146.24951
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 93.80600 | spectral_norm = 7.45217 | nuclear_norm = 2468.14990
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 80.41166 | spectral_norm = 7.42992 | nuclear_norm = 1872.57739
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 79.16730 | spectral_norm = 7.16535 | nuclear_norm = 1849.04956
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 213.47269 | spectral_norm = 17.97360 | nuclear_norm = 4893.33203
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 211.89299 | spectral_norm = 15.65491 | nuclear_norm = 4974.11426
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 192.95505 | spectral_norm = 13.47474 | nuclear_norm = 5126.03711
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 94.10377 | spectral_norm = 7.71379 | nuclear_norm = 2475.20752
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 83.04377 | spectral_norm = 6.99061 | nuclear_norm = 1935.54016
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 83.04345 | spectral_norm = 7.19201 | nuclear_norm = 1937.11230
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 227.56619 | spectral_norm = 18.98274 | nuclear_norm = 5214.04248
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 218.41531 | spectral_norm = 16.79090 | nuclear_norm = 5140.34619
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 190.64384 | spectral_norm = 14.55346 | nuclear_norm = 5064.26074
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 94.00362 | spectral_norm = 7.69946 | nuclear_norm = 2476.72974
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 82.62493 | spectral_norm = 7.32535 | nuclear_norm = 1914.65625
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 83.04122 | spectral_norm = 6.74004 | nuclear_norm = 1917.36304
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 227.31711 | spectral_norm = 18.22183 | nuclear_norm = 5228.06592
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 227.13600 | spectral_norm = 16.49418 | nuclear_norm = 5383.57422
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 190.20500 | spectral_norm = 14.54055 | nuclear_norm = 5049.35254
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 93.93675 | spectral_norm = 7.82429 | nuclear_norm = 2479.69116
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 83.71806 | spectral_norm = 7.33784 | nuclear_norm = 1939.55371
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 83.42168 | spectral_norm = 7.29406 | nuclear_norm = 1927.45190
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 232.70967 | spectral_norm = 18.23323 | nuclear_norm = 5387.91406
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 227.50090 | spectral_norm = 15.61410 | nuclear_norm = 5389.96484
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 189.29633 | spectral_norm = 13.84990 | nuclear_norm = 5031.19287
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 93.93123 | spectral_norm = 8.10258 | nuclear_norm = 2484.94409
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 83.92706 | spectral_norm = 7.48978 | nuclear_norm = 1937.88330
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 83.06509 | spectral_norm = 7.29616 | nuclear_norm = 1908.83862
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 222.09413 | spectral_norm = 17.51406 | nuclear_norm = 5145.91162
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 228.44286 | spectral_norm = 15.65703 | nuclear_norm = 5397.60742
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 191.58801 | spectral_norm = 13.24040 | nuclear_norm = 5097.31787
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 93.58943 | spectral_norm = 8.33785 | nuclear_norm = 2476.03467
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 83.43477 | spectral_norm = 8.27839 | nuclear_norm = 1916.02869
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 82.20847 | spectral_norm = 7.96843 | nuclear_norm = 1871.34985
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 197.55251 | spectral_norm = 17.32443 | nuclear_norm = 4539.28711
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 219.98456 | spectral_norm = 15.77620 | nuclear_norm = 5140.15137
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 197.19684 | spectral_norm = 14.65281 | nuclear_norm = 5244.00439
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 95.43287 | spectral_norm = 8.51101 | nuclear_norm = 2517.86377
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 697.33807 | spectral_norm = 171.23561 | nuclear_norm = 17681.50000
===========================================
step:376/1750 train_loss:3.8751 train_time:125746ms step_avg:343.57ms
step:377/1750 train_loss:3.7966 train_time:126113ms step_avg:343.63ms
step:378/1750 train_loss:3.8557 train_time:126568ms step_avg:343.93ms
step:379/1750 train_loss:3.8661 train_time:127054ms step_avg:344.32ms
step:380/1750 train_loss:3.9599 train_time:127402ms step_avg:344.33ms
step:381/1750 train_loss:3.8429 train_time:127749ms step_avg:344.34ms
step:382/1750 train_loss:3.8163 train_time:128098ms step_avg:344.35ms
step:383/1750 train_loss:3.8010 train_time:128449ms step_avg:344.37ms
step:384/1750 train_loss:3.8698 train_time:128798ms step_avg:344.38ms
step:385/1750 train_loss:3.7926 train_time:129149ms step_avg:344.40ms
step:386/1750 train_loss:3.8939 train_time:129497ms step_avg:344.41ms
step:387/1750 train_loss:4.0611 train_time:129847ms step_avg:344.42ms
step:388/1750 train_loss:3.7967 train_time:130197ms step_avg:344.44ms
step:389/1750 train_loss:3.7978 train_time:130547ms step_avg:344.45ms
step:390/1750 train_loss:3.8934 train_time:130903ms step_avg:344.48ms
step:391/1750 train_loss:3.8112 train_time:131260ms step_avg:344.51ms
step:392/1750 train_loss:3.9223 train_time:131616ms step_avg:344.55ms
step:393/1750 train_loss:3.7597 train_time:131974ms step_avg:344.58ms
step:394/1750 train_loss:3.8860 train_time:132334ms step_avg:344.62ms
step:395/1750 train_loss:3.6248 train_time:132692ms step_avg:344.65ms
step:396/1750 train_loss:3.8355 train_time:133052ms step_avg:344.69ms
step:397/1750 train_loss:3.8606 train_time:133411ms step_avg:344.73ms
step:398/1750 train_loss:3.8770 train_time:133767ms step_avg:344.76ms
step:399/1750 train_loss:3.7736 train_time:134123ms step_avg:344.79ms
step:400/1750 train_loss:3.8292 train_time:134486ms step_avg:344.83ms
step:401/1750 train_loss:3.9075 train_time:134841ms step_avg:344.86ms
step:402/1750 train_loss:3.8396 train_time:135199ms step_avg:344.90ms
step:403/1750 train_loss:3.9561 train_time:135556ms step_avg:344.93ms
step:404/1750 train_loss:3.6803 train_time:135913ms step_avg:344.96ms
step:405/1750 train_loss:3.7828 train_time:136270ms step_avg:344.99ms
step:406/1750 train_loss:4.0977 train_time:136627ms step_avg:345.02ms
step:407/1750 train_loss:3.7796 train_time:136985ms step_avg:345.05ms
step:408/1750 train_loss:3.8191 train_time:137340ms step_avg:345.08ms
step:409/1750 train_loss:3.8653 train_time:137699ms step_avg:345.11ms
step:410/1750 train_loss:3.7590 train_time:138057ms step_avg:345.14ms
step:411/1750 train_loss:3.7561 train_time:138415ms step_avg:345.17ms
step:412/1750 train_loss:4.1885 train_time:138774ms step_avg:345.21ms
step:413/1750 train_loss:3.6272 train_time:139130ms step_avg:345.23ms
step:414/1750 train_loss:4.0131 train_time:139485ms step_avg:345.26ms
step:415/1750 train_loss:3.7574 train_time:139841ms step_avg:345.29ms
step:416/1750 train_loss:3.7569 train_time:140200ms step_avg:345.32ms
step:417/1750 train_loss:3.9614 train_time:140559ms step_avg:345.35ms
step:418/1750 train_loss:3.6880 train_time:140917ms step_avg:345.38ms
step:419/1750 train_loss:3.8108 train_time:141273ms step_avg:345.41ms
step:420/1750 train_loss:3.7071 train_time:141632ms step_avg:345.44ms
step:421/1750 train_loss:3.6517 train_time:141990ms step_avg:345.48ms
step:422/1750 train_loss:3.7889 train_time:142347ms step_avg:345.50ms
step:423/1750 train_loss:3.8734 train_time:142704ms step_avg:345.53ms
step:424/1750 train_loss:3.6187 train_time:143064ms step_avg:345.56ms
step:425/1750 train_loss:3.7987 train_time:143422ms step_avg:345.60ms
step:426/1750 train_loss:3.6620 train_time:143780ms step_avg:345.62ms
step:427/1750 train_loss:3.8986 train_time:144137ms step_avg:345.65ms
step:428/1750 train_loss:3.8102 train_time:144496ms step_avg:345.69ms
step:429/1750 train_loss:3.7574 train_time:144854ms step_avg:345.71ms
step:430/1750 train_loss:3.7174 train_time:145210ms step_avg:345.74ms
step:431/1750 train_loss:3.6191 train_time:145567ms step_avg:345.77ms
step:432/1750 train_loss:3.7694 train_time:145923ms step_avg:345.79ms
step:433/1750 train_loss:3.8299 train_time:146280ms step_avg:345.82ms
step:434/1750 train_loss:3.7763 train_time:146637ms step_avg:345.84ms
step:435/1750 train_loss:3.8134 train_time:146995ms step_avg:345.87ms
step:436/1750 train_loss:3.8350 train_time:147352ms step_avg:345.90ms
step:437/1750 train_loss:3.7264 train_time:147710ms step_avg:345.93ms
step:438/1750 train_loss:3.7093 train_time:148068ms step_avg:345.95ms
step:439/1750 train_loss:3.7154 train_time:148427ms step_avg:345.98ms
step:440/1750 train_loss:3.9003 train_time:148782ms step_avg:346.01ms
step:441/1750 train_loss:3.7623 train_time:149141ms step_avg:346.03ms
step:442/1750 train_loss:3.7403 train_time:149498ms step_avg:346.06ms
step:443/1750 train_loss:3.6222 train_time:149855ms step_avg:346.09ms
step:444/1750 train_loss:3.9299 train_time:150214ms step_avg:346.12ms
step:445/1750 train_loss:3.8493 train_time:150573ms step_avg:346.14ms
step:446/1750 train_loss:3.8417 train_time:150931ms step_avg:346.17ms
step:447/1750 train_loss:3.7512 train_time:151289ms step_avg:346.20ms
step:448/1750 train_loss:3.8512 train_time:151649ms step_avg:346.23ms
step:449/1750 train_loss:3.6982 train_time:152009ms step_avg:346.26ms
step:450/1750 train_loss:3.7257 train_time:152366ms step_avg:346.29ms
step:451/1750 train_loss:3.5857 train_time:152724ms step_avg:346.31ms
step:452/1750 train_loss:3.7172 train_time:153081ms step_avg:346.34ms
step:453/1750 train_loss:3.6808 train_time:153438ms step_avg:346.36ms
step:454/1750 train_loss:3.6371 train_time:153797ms step_avg:346.39ms
step:455/1750 train_loss:3.8432 train_time:154155ms step_avg:346.42ms
step:456/1750 train_loss:3.7276 train_time:154511ms step_avg:346.44ms
step:457/1750 train_loss:3.7846 train_time:154866ms step_avg:346.46ms
step:458/1750 train_loss:3.8359 train_time:155222ms step_avg:346.48ms
step:459/1750 train_loss:3.6321 train_time:155580ms step_avg:346.50ms
step:460/1750 train_loss:3.7958 train_time:155935ms step_avg:346.52ms
step:461/1750 train_loss:3.6915 train_time:156293ms step_avg:346.55ms
step:462/1750 train_loss:3.7418 train_time:156649ms step_avg:346.57ms
step:463/1750 train_loss:3.7753 train_time:157003ms step_avg:346.59ms
step:464/1750 train_loss:3.7171 train_time:157358ms step_avg:346.60ms
step:465/1750 train_loss:3.7197 train_time:157713ms step_avg:346.62ms
step:466/1750 train_loss:3.7998 train_time:158069ms step_avg:346.64ms
step:467/1750 train_loss:3.8259 train_time:158426ms step_avg:346.66ms
step:468/1750 train_loss:3.7995 train_time:158781ms step_avg:346.68ms
step:469/1750 train_loss:3.6870 train_time:159135ms step_avg:346.70ms
step:470/1750 train_loss:3.7709 train_time:159488ms step_avg:346.71ms
step:471/1750 train_loss:3.8239 train_time:159844ms step_avg:346.73ms
step:472/1750 train_loss:3.7779 train_time:160201ms step_avg:346.76ms
step:473/1750 train_loss:3.7223 train_time:160556ms step_avg:346.77ms
step:474/1750 train_loss:3.5916 train_time:160913ms step_avg:346.79ms
step:475/1750 train_loss:4.0185 train_time:161266ms step_avg:346.81ms
step:476/1750 train_loss:3.7586 train_time:161624ms step_avg:346.83ms
step:477/1750 train_loss:3.5900 train_time:161982ms step_avg:346.86ms
step:478/1750 train_loss:3.8277 train_time:162338ms step_avg:346.88ms
step:479/1750 train_loss:3.7752 train_time:162696ms step_avg:346.90ms
step:480/1750 train_loss:3.9219 train_time:163051ms step_avg:346.92ms
step:481/1750 train_loss:3.7299 train_time:163408ms step_avg:346.94ms
step:482/1750 train_loss:3.5276 train_time:163763ms step_avg:346.96ms
step:483/1750 train_loss:3.8188 train_time:164119ms step_avg:346.97ms
step:484/1750 train_loss:3.6746 train_time:164477ms step_avg:347.00ms
step:485/1750 train_loss:3.6576 train_time:164833ms step_avg:347.02ms
step:486/1750 train_loss:3.5786 train_time:165189ms step_avg:347.04ms
step:487/1750 train_loss:3.6811 train_time:165545ms step_avg:347.05ms
step:488/1750 train_loss:3.8861 train_time:165899ms step_avg:347.07ms
step:489/1750 train_loss:3.7213 train_time:166256ms step_avg:347.09ms
step:490/1750 train_loss:3.5964 train_time:166611ms step_avg:347.11ms
step:491/1750 train_loss:3.6173 train_time:166966ms step_avg:347.12ms
step:492/1750 train_loss:3.7356 train_time:167323ms step_avg:347.14ms
step:493/1750 train_loss:3.5783 train_time:167682ms step_avg:347.17ms
step:494/1750 train_loss:3.7093 train_time:168039ms step_avg:347.19ms
step:495/1750 train_loss:3.6635 train_time:168395ms step_avg:347.21ms
step:496/1750 train_loss:3.5267 train_time:168752ms step_avg:347.23ms
step:497/1750 train_loss:3.7432 train_time:169106ms step_avg:347.24ms
step:498/1750 train_loss:3.7988 train_time:169461ms step_avg:347.26ms
step:499/1750 train_loss:3.8250 train_time:169818ms step_avg:347.28ms
step:500/1750 train_loss:3.7381 train_time:170178ms step_avg:347.30ms
step:500/1750 val_loss:3.7126 train_time:170268ms step_avg:347.49ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 207.52835 | frobenius_norm = 47586.90625 | spectral_norm = 8849.76074 | nuclear_norm = 1183410.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 107.09373 | spectral_norm = 14.96265 | nuclear_norm = 2495.44629
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 103.12344 | spectral_norm = 16.60696 | nuclear_norm = 2390.07178
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 231.44974 | spectral_norm = 14.78179 | nuclear_norm = 5582.78027
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 200.37375 | spectral_norm = 17.56504 | nuclear_norm = 4679.60303
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 221.62575 | spectral_norm = 17.62295 | nuclear_norm = 5886.53369
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 113.23136 | spectral_norm = 8.96292 | nuclear_norm = 2997.31738
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 105.38551 | spectral_norm = 10.07782 | nuclear_norm = 2457.59448
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 103.16984 | spectral_norm = 10.60980 | nuclear_norm = 2408.27100
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 243.40984 | spectral_norm = 20.50792 | nuclear_norm = 5594.98486
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 243.93866 | spectral_norm = 18.49816 | nuclear_norm = 5692.36328
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 231.12685 | spectral_norm = 16.77886 | nuclear_norm = 6133.72412
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 115.07715 | spectral_norm = 10.47614 | nuclear_norm = 3030.77588
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 100.89539 | spectral_norm = 9.34056 | nuclear_norm = 2280.11304
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 101.51730 | spectral_norm = 8.99641 | nuclear_norm = 2304.71826
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 250.98314 | spectral_norm = 21.83807 | nuclear_norm = 5753.66406
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 257.02356 | spectral_norm = 19.64614 | nuclear_norm = 6047.43555
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 235.97478 | spectral_norm = 16.98073 | nuclear_norm = 6271.32617
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 114.57893 | spectral_norm = 10.40480 | nuclear_norm = 3016.81665
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 103.97089 | spectral_norm = 9.62255 | nuclear_norm = 2423.87817
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 103.12746 | spectral_norm = 10.65265 | nuclear_norm = 2403.59863
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 254.88626 | spectral_norm = 21.74325 | nuclear_norm = 5821.29785
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 258.82126 | spectral_norm = 19.94178 | nuclear_norm = 6061.39160
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 241.79308 | spectral_norm = 18.63072 | nuclear_norm = 6411.07324
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 117.13040 | spectral_norm = 10.40067 | nuclear_norm = 3079.68604
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 103.66101 | spectral_norm = 9.72379 | nuclear_norm = 2412.88770
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 103.72398 | spectral_norm = 9.92242 | nuclear_norm = 2419.99438
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 262.47415 | spectral_norm = 22.06989 | nuclear_norm = 5997.79590
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 259.15009 | spectral_norm = 19.47810 | nuclear_norm = 6085.32129
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 240.56644 | spectral_norm = 17.99442 | nuclear_norm = 6387.09766
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 117.28323 | spectral_norm = 10.02181 | nuclear_norm = 3086.38110
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 102.08566 | spectral_norm = 9.16383 | nuclear_norm = 2358.10205
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 102.42466 | spectral_norm = 9.14640 | nuclear_norm = 2373.04736
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 262.57968 | spectral_norm = 22.65489 | nuclear_norm = 5960.28711
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 253.22787 | spectral_norm = 20.19343 | nuclear_norm = 5952.68652
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 240.51740 | spectral_norm = 16.48364 | nuclear_norm = 6400.84131
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 115.96702 | spectral_norm = 9.45058 | nuclear_norm = 3048.80713
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 100.88654 | spectral_norm = 9.73733 | nuclear_norm = 2336.38623
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 99.03018 | spectral_norm = 9.47798 | nuclear_norm = 2301.55811
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 254.52403 | spectral_norm = 21.49497 | nuclear_norm = 5843.69141
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 251.74530 | spectral_norm = 18.81369 | nuclear_norm = 5900.65918
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 239.00780 | spectral_norm = 16.76725 | nuclear_norm = 6355.12695
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 116.92986 | spectral_norm = 9.82634 | nuclear_norm = 3076.00586
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 104.60162 | spectral_norm = 9.12043 | nuclear_norm = 2423.69775
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 104.43933 | spectral_norm = 9.43416 | nuclear_norm = 2424.82764
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 273.00269 | spectral_norm = 22.89216 | nuclear_norm = 6244.66895
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 260.66748 | spectral_norm = 20.20665 | nuclear_norm = 6125.19678
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 235.52150 | spectral_norm = 18.78744 | nuclear_norm = 6261.03516
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 117.09803 | spectral_norm = 9.73112 | nuclear_norm = 3087.35547
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 103.99416 | spectral_norm = 9.50375 | nuclear_norm = 2395.19067
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 104.36855 | spectral_norm = 8.79707 | nuclear_norm = 2392.10205
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 272.29260 | spectral_norm = 22.26504 | nuclear_norm = 6251.15137
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 269.74619 | spectral_norm = 19.75151 | nuclear_norm = 6375.64941
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 235.13002 | spectral_norm = 18.87323 | nuclear_norm = 6245.41650
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 117.53777 | spectral_norm = 10.11554 | nuclear_norm = 3106.36621
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 105.83482 | spectral_norm = 9.54431 | nuclear_norm = 2437.25244
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 105.30131 | spectral_norm = 9.53500 | nuclear_norm = 2414.31714
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 277.80634 | spectral_norm = 22.40745 | nuclear_norm = 6426.55566
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 270.35236 | spectral_norm = 18.64387 | nuclear_norm = 6395.04785
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 233.70595 | spectral_norm = 17.79499 | nuclear_norm = 6216.10742
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 117.63976 | spectral_norm = 10.62348 | nuclear_norm = 3116.94800
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 106.07415 | spectral_norm = 9.78854 | nuclear_norm = 2433.43262
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 104.90432 | spectral_norm = 9.67910 | nuclear_norm = 2392.22363
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 262.84100 | spectral_norm = 21.26777 | nuclear_norm = 6084.24316
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 267.67117 | spectral_norm = 18.51281 | nuclear_norm = 6305.59668
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 238.41231 | spectral_norm = 16.85569 | nuclear_norm = 6349.25391
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 115.90182 | spectral_norm = 11.44411 | nuclear_norm = 3067.87891
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 105.24752 | spectral_norm = 11.25819 | nuclear_norm = 2401.01465
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 103.45444 | spectral_norm = 10.63925 | nuclear_norm = 2336.47803
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 233.85782 | spectral_norm = 22.20311 | nuclear_norm = 5359.74805
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 259.44003 | spectral_norm = 18.82071 | nuclear_norm = 6031.39746
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 248.64972 | spectral_norm = 19.18426 | nuclear_norm = 6615.33789
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 119.17689 | spectral_norm = 11.76345 | nuclear_norm = 3141.93652
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 817.69220 | spectral_norm = 182.31281 | nuclear_norm = 20947.08984
===========================================
step:501/1750 train_loss:3.8176 train_time:170527ms step_avg:347.30ms
step:502/1750 train_loss:3.7579 train_time:170877ms step_avg:347.31ms
step:503/1750 train_loss:3.7859 train_time:171232ms step_avg:347.33ms
step:504/1750 train_loss:3.7341 train_time:171584ms step_avg:347.34ms
step:505/1750 train_loss:3.8146 train_time:171937ms step_avg:347.35ms
step:506/1750 train_loss:3.6611 train_time:172289ms step_avg:347.36ms
step:507/1750 train_loss:3.7708 train_time:172642ms step_avg:347.37ms
step:508/1750 train_loss:3.8389 train_time:172998ms step_avg:347.39ms
step:509/1750 train_loss:3.7791 train_time:173351ms step_avg:347.40ms
step:510/1750 train_loss:3.5893 train_time:173705ms step_avg:347.41ms
step:511/1750 train_loss:3.7872 train_time:174062ms step_avg:347.43ms
step:512/1750 train_loss:3.7335 train_time:174421ms step_avg:347.45ms
step:513/1750 train_loss:3.6718 train_time:174776ms step_avg:347.47ms
step:514/1750 train_loss:3.8473 train_time:175133ms step_avg:347.49ms
step:515/1750 train_loss:3.7451 train_time:175489ms step_avg:347.50ms
step:516/1750 train_loss:4.0861 train_time:175845ms step_avg:347.52ms
step:517/1750 train_loss:3.6928 train_time:176199ms step_avg:347.53ms
step:518/1750 train_loss:3.7881 train_time:176554ms step_avg:347.55ms
step:519/1750 train_loss:3.6651 train_time:176910ms step_avg:347.56ms
step:520/1750 train_loss:3.6902 train_time:177270ms step_avg:347.59ms
step:521/1750 train_loss:3.6742 train_time:177632ms step_avg:347.62ms
step:522/1750 train_loss:3.6617 train_time:177996ms step_avg:347.65ms
step:523/1750 train_loss:4.2892 train_time:178359ms step_avg:347.68ms
step:524/1750 train_loss:3.7510 train_time:178719ms step_avg:347.70ms
step:525/1750 train_loss:3.6900 train_time:179082ms step_avg:347.73ms
step:526/1750 train_loss:3.7043 train_time:179445ms step_avg:347.76ms
step:527/1750 train_loss:3.6645 train_time:179808ms step_avg:347.79ms
step:528/1750 train_loss:3.6334 train_time:180171ms step_avg:347.82ms
step:529/1750 train_loss:3.8591 train_time:180535ms step_avg:347.85ms
step:530/1750 train_loss:3.6555 train_time:180900ms step_avg:347.88ms
step:531/1750 train_loss:3.9266 train_time:181264ms step_avg:347.92ms
step:532/1750 train_loss:3.7432 train_time:181624ms step_avg:347.94ms
step:533/1750 train_loss:3.6635 train_time:181985ms step_avg:347.96ms
step:534/1750 train_loss:3.6737 train_time:182345ms step_avg:347.99ms
step:535/1750 train_loss:3.6121 train_time:182707ms step_avg:348.01ms
step:536/1750 train_loss:3.7628 train_time:183072ms step_avg:348.05ms
step:537/1750 train_loss:3.7325 train_time:183438ms step_avg:348.08ms
step:538/1750 train_loss:3.6324 train_time:183806ms step_avg:348.12ms
step:539/1750 train_loss:4.1219 train_time:184175ms step_avg:348.16ms
step:540/1750 train_loss:3.6792 train_time:184538ms step_avg:348.18ms
step:541/1750 train_loss:3.7938 train_time:184900ms step_avg:348.21ms
step:542/1750 train_loss:3.6037 train_time:185265ms step_avg:348.24ms
step:543/1750 train_loss:3.5946 train_time:185628ms step_avg:348.27ms
step:544/1750 train_loss:3.6496 train_time:185991ms step_avg:348.30ms
step:545/1750 train_loss:3.5957 train_time:186355ms step_avg:348.33ms
step:546/1750 train_loss:3.6365 train_time:186719ms step_avg:348.36ms
step:547/1750 train_loss:3.6501 train_time:187082ms step_avg:348.38ms
step:548/1750 train_loss:3.6232 train_time:187447ms step_avg:348.41ms
step:549/1750 train_loss:3.7351 train_time:187810ms step_avg:348.44ms
step:550/1750 train_loss:3.6242 train_time:188174ms step_avg:348.47ms
step:551/1750 train_loss:3.6368 train_time:188535ms step_avg:348.49ms
step:552/1750 train_loss:3.9407 train_time:188899ms step_avg:348.52ms
step:553/1750 train_loss:3.7679 train_time:189263ms step_avg:348.55ms
step:554/1750 train_loss:3.7281 train_time:189624ms step_avg:348.57ms
step:555/1750 train_loss:3.6393 train_time:189987ms step_avg:348.60ms
step:556/1750 train_loss:3.7029 train_time:190345ms step_avg:348.62ms
step:557/1750 train_loss:3.3327 train_time:190708ms step_avg:348.64ms
step:558/1750 train_loss:3.6244 train_time:191071ms step_avg:348.67ms
step:559/1750 train_loss:3.6564 train_time:191430ms step_avg:348.69ms
step:560/1750 train_loss:3.6977 train_time:191792ms step_avg:348.71ms
step:561/1750 train_loss:3.6218 train_time:192153ms step_avg:348.73ms
step:562/1750 train_loss:3.5617 train_time:192516ms step_avg:348.76ms
step:563/1750 train_loss:3.7666 train_time:192882ms step_avg:348.79ms
step:564/1750 train_loss:3.5802 train_time:193249ms step_avg:348.82ms
step:565/1750 train_loss:3.6957 train_time:193610ms step_avg:348.85ms
step:566/1750 train_loss:3.6327 train_time:193995ms step_avg:348.91ms
step:567/1750 train_loss:3.6113 train_time:194452ms step_avg:349.11ms
step:568/1750 train_loss:3.7044 train_time:194817ms step_avg:349.13ms
step:569/1750 train_loss:3.6562 train_time:195318ms step_avg:349.41ms
step:570/1750 train_loss:3.7007 train_time:195681ms step_avg:349.43ms
step:571/1750 train_loss:3.7658 train_time:196040ms step_avg:349.45ms
step:572/1750 train_loss:3.7323 train_time:196403ms step_avg:349.47ms
step:573/1750 train_loss:3.7451 train_time:196770ms step_avg:349.50ms
step:574/1750 train_loss:3.7927 train_time:197137ms step_avg:349.53ms
step:575/1750 train_loss:3.7409 train_time:197499ms step_avg:349.56ms
step:576/1750 train_loss:3.7694 train_time:197859ms step_avg:349.57ms
step:577/1750 train_loss:3.6861 train_time:198220ms step_avg:349.59ms
step:578/1750 train_loss:3.6870 train_time:198583ms step_avg:349.62ms
step:579/1750 train_loss:3.6787 train_time:198943ms step_avg:349.64ms
step:580/1750 train_loss:3.6049 train_time:199305ms step_avg:349.66ms
step:581/1750 train_loss:3.6465 train_time:199670ms step_avg:349.68ms
step:582/1750 train_loss:3.8596 train_time:200032ms step_avg:349.71ms
step:583/1750 train_loss:3.6377 train_time:200395ms step_avg:349.73ms
step:584/1750 train_loss:3.6009 train_time:200760ms step_avg:349.76ms
step:585/1750 train_loss:3.8027 train_time:201121ms step_avg:349.78ms
step:586/1750 train_loss:3.5246 train_time:201481ms step_avg:349.79ms
step:587/1750 train_loss:3.6820 train_time:201843ms step_avg:349.81ms
step:588/1750 train_loss:3.6658 train_time:202205ms step_avg:349.83ms
step:589/1750 train_loss:4.0073 train_time:202567ms step_avg:349.86ms
step:590/1750 train_loss:3.7877 train_time:202927ms step_avg:349.87ms
step:591/1750 train_loss:3.5224 train_time:203290ms step_avg:349.90ms
step:592/1750 train_loss:3.5459 train_time:203654ms step_avg:349.92ms
step:593/1750 train_loss:3.5104 train_time:204018ms step_avg:349.95ms
step:594/1750 train_loss:3.5621 train_time:204378ms step_avg:349.96ms
step:595/1750 train_loss:3.9300 train_time:204741ms step_avg:349.98ms
step:596/1750 train_loss:3.6574 train_time:205104ms step_avg:350.01ms
step:597/1750 train_loss:3.5946 train_time:205463ms step_avg:350.02ms
step:598/1750 train_loss:3.6716 train_time:205824ms step_avg:350.04ms
step:599/1750 train_loss:3.4820 train_time:206185ms step_avg:350.06ms
step:600/1750 train_loss:3.6085 train_time:206550ms step_avg:350.08ms
step:601/1750 train_loss:3.6488 train_time:206910ms step_avg:350.10ms
step:602/1750 train_loss:3.6757 train_time:207273ms step_avg:350.12ms
step:603/1750 train_loss:3.7912 train_time:207635ms step_avg:350.14ms
step:604/1750 train_loss:3.6219 train_time:207995ms step_avg:350.16ms
step:605/1750 train_loss:3.6190 train_time:208356ms step_avg:350.18ms
step:606/1750 train_loss:3.5835 train_time:208719ms step_avg:350.20ms
step:607/1750 train_loss:3.8435 train_time:209080ms step_avg:350.22ms
step:608/1750 train_loss:3.6498 train_time:209440ms step_avg:350.23ms
step:609/1750 train_loss:3.6217 train_time:209801ms step_avg:350.25ms
step:610/1750 train_loss:3.7170 train_time:210158ms step_avg:350.26ms
step:611/1750 train_loss:3.6170 train_time:210519ms step_avg:350.28ms
step:612/1750 train_loss:3.5763 train_time:210882ms step_avg:350.30ms
step:613/1750 train_loss:3.7678 train_time:211244ms step_avg:350.32ms
step:614/1750 train_loss:3.7076 train_time:211607ms step_avg:350.34ms
step:615/1750 train_loss:3.6970 train_time:211968ms step_avg:350.36ms
step:616/1750 train_loss:3.6423 train_time:212328ms step_avg:350.38ms
step:617/1750 train_loss:3.5609 train_time:212689ms step_avg:350.39ms
step:618/1750 train_loss:3.6968 train_time:213050ms step_avg:350.41ms
step:619/1750 train_loss:3.5671 train_time:213413ms step_avg:350.43ms
step:620/1750 train_loss:3.5921 train_time:213774ms step_avg:350.45ms
step:621/1750 train_loss:3.9378 train_time:214138ms step_avg:350.47ms
step:622/1750 train_loss:3.5754 train_time:214502ms step_avg:350.49ms
step:623/1750 train_loss:3.6147 train_time:214866ms step_avg:350.52ms
step:624/1750 train_loss:3.7051 train_time:215224ms step_avg:350.53ms
step:625/1750 train_loss:3.7188 train_time:215586ms step_avg:350.55ms
step:625/1750 val_loss:3.6350 train_time:215683ms step_avg:350.70ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 225.93587 | frobenius_norm = 51883.15234 | spectral_norm = 9423.02148 | nuclear_norm = 1293690.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 124.24763 | spectral_norm = 18.91444 | nuclear_norm = 2885.25610
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 119.76388 | spectral_norm = 20.71081 | nuclear_norm = 2766.28784
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 267.28235 | spectral_norm = 16.94606 | nuclear_norm = 6474.29834
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 220.04723 | spectral_norm = 20.38509 | nuclear_norm = 5123.93799
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 259.16592 | spectral_norm = 21.20643 | nuclear_norm = 6882.47656
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 132.22305 | spectral_norm = 10.91499 | nuclear_norm = 3497.48682
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 123.48190 | spectral_norm = 12.00292 | nuclear_norm = 2870.54736
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 120.80165 | spectral_norm = 12.06426 | nuclear_norm = 2812.48389
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 272.64899 | spectral_norm = 23.29981 | nuclear_norm = 6255.07178
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 273.88919 | spectral_norm = 20.96975 | nuclear_norm = 6383.09570
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 267.84491 | spectral_norm = 19.73446 | nuclear_norm = 7111.24463
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 133.17122 | spectral_norm = 12.73319 | nuclear_norm = 3504.09619
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 117.48520 | spectral_norm = 11.00259 | nuclear_norm = 2635.82959
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 118.18144 | spectral_norm = 10.41979 | nuclear_norm = 2664.14355
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 283.52237 | spectral_norm = 25.49165 | nuclear_norm = 6486.78369
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 290.22293 | spectral_norm = 22.65494 | nuclear_norm = 6819.44824
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 273.13989 | spectral_norm = 20.48106 | nuclear_norm = 7261.38135
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 132.53029 | spectral_norm = 12.55213 | nuclear_norm = 3487.30005
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 121.20405 | spectral_norm = 11.70255 | nuclear_norm = 2815.56494
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 120.34180 | spectral_norm = 12.41324 | nuclear_norm = 2795.50635
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 290.23099 | spectral_norm = 24.94180 | nuclear_norm = 6627.81445
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 294.28973 | spectral_norm = 22.90915 | nuclear_norm = 6885.22168
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 279.43430 | spectral_norm = 22.52176 | nuclear_norm = 7409.35303
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 135.56378 | spectral_norm = 12.51195 | nuclear_norm = 3561.33618
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 120.81367 | spectral_norm = 11.71693 | nuclear_norm = 2799.90137
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 120.85987 | spectral_norm = 11.76093 | nuclear_norm = 2810.14819
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 299.56985 | spectral_norm = 25.29627 | nuclear_norm = 6845.35156
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 296.12738 | spectral_norm = 22.17802 | nuclear_norm = 6952.67090
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 278.15851 | spectral_norm = 21.29017 | nuclear_norm = 7386.20459
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 135.88148 | spectral_norm = 12.00927 | nuclear_norm = 3573.81982
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 118.93674 | spectral_norm = 11.06350 | nuclear_norm = 2732.39111
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 119.05575 | spectral_norm = 10.86999 | nuclear_norm = 2745.24805
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 301.02017 | spectral_norm = 26.08012 | nuclear_norm = 6834.41992
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 290.87701 | spectral_norm = 23.07833 | nuclear_norm = 6846.15137
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 279.39468 | spectral_norm = 19.59196 | nuclear_norm = 7440.59912
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 134.38928 | spectral_norm = 11.37706 | nuclear_norm = 3532.82568
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 117.53970 | spectral_norm = 11.70565 | nuclear_norm = 2707.81787
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 114.97601 | spectral_norm = 11.50341 | nuclear_norm = 2662.07373
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 291.52649 | spectral_norm = 24.37694 | nuclear_norm = 6702.11621
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 287.70801 | spectral_norm = 21.48574 | nuclear_norm = 6739.76074
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 277.27893 | spectral_norm = 19.41997 | nuclear_norm = 7377.81445
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 135.86957 | spectral_norm = 11.81919 | nuclear_norm = 3574.86572
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 122.00799 | spectral_norm = 11.05346 | nuclear_norm = 2814.26880
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 121.59379 | spectral_norm = 11.27311 | nuclear_norm = 2809.69336
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 313.12424 | spectral_norm = 26.32564 | nuclear_norm = 7146.85840
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 298.37085 | spectral_norm = 23.28293 | nuclear_norm = 7005.77197
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 272.84186 | spectral_norm = 22.20628 | nuclear_norm = 7256.36133
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 136.29984 | spectral_norm = 11.80191 | nuclear_norm = 3595.05737
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 121.14349 | spectral_norm = 11.52330 | nuclear_norm = 2772.33057
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 121.21790 | spectral_norm = 10.61945 | nuclear_norm = 2760.05518
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 311.62213 | spectral_norm = 25.72023 | nuclear_norm = 7135.56738
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 307.41791 | spectral_norm = 22.45337 | nuclear_norm = 7251.29492
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 272.83597 | spectral_norm = 22.46116 | nuclear_norm = 7249.80957
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 137.21147 | spectral_norm = 12.29878 | nuclear_norm = 3627.42920
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 123.93198 | spectral_norm = 11.46663 | nuclear_norm = 2836.58447
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 123.00926 | spectral_norm = 11.47890 | nuclear_norm = 2801.45947
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 318.01797 | spectral_norm = 26.73546 | nuclear_norm = 7347.46436
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 308.62097 | spectral_norm = 21.33974 | nuclear_norm = 7295.76562
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 270.67627 | spectral_norm = 21.23073 | nuclear_norm = 7200.51904
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 137.36731 | spectral_norm = 12.80651 | nuclear_norm = 3642.15161
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 123.98444 | spectral_norm = 11.72691 | nuclear_norm = 2827.56006
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 122.63686 | spectral_norm = 11.71691 | nuclear_norm = 2777.11621
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 298.85971 | spectral_norm = 25.21192 | nuclear_norm = 6907.00879
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 302.23972 | spectral_norm = 21.13416 | nuclear_norm = 7109.26367
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 277.90277 | spectral_norm = 20.06318 | nuclear_norm = 7403.71387
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 134.62134 | spectral_norm = 14.06718 | nuclear_norm = 3564.26147
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 122.75125 | spectral_norm = 13.80691 | nuclear_norm = 2781.86670
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 120.37782 | spectral_norm = 12.95343 | nuclear_norm = 2703.26562
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 266.05948 | spectral_norm = 26.81793 | nuclear_norm = 6081.32812
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 295.34326 | spectral_norm = 21.44168 | nuclear_norm = 6850.04688
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 291.15302 | spectral_norm = 22.80399 | nuclear_norm = 7746.85742
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 138.61160 | spectral_norm = 14.74103 | nuclear_norm = 3651.40210
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 922.18011 | spectral_norm = 188.39247 | nuclear_norm = 23800.82617
===========================================
step:626/1750 train_loss:3.7547 train_time:215945ms step_avg:350.56ms
step:627/1750 train_loss:3.7292 train_time:216301ms step_avg:350.57ms
step:628/1750 train_loss:3.7774 train_time:216658ms step_avg:350.58ms
step:629/1750 train_loss:3.6069 train_time:217014ms step_avg:350.59ms
step:630/1750 train_loss:3.7354 train_time:217373ms step_avg:350.60ms
step:631/1750 train_loss:3.7532 train_time:217731ms step_avg:350.61ms
step:632/1750 train_loss:3.6564 train_time:218092ms step_avg:350.63ms
step:633/1750 train_loss:3.6110 train_time:218454ms step_avg:350.65ms
step:634/1750 train_loss:3.7054 train_time:218812ms step_avg:350.66ms
step:635/1750 train_loss:3.9630 train_time:219169ms step_avg:350.67ms
step:636/1750 train_loss:3.5532 train_time:219531ms step_avg:350.69ms
step:637/1750 train_loss:3.3650 train_time:219894ms step_avg:350.71ms
step:638/1750 train_loss:3.6020 train_time:220252ms step_avg:350.72ms
step:639/1750 train_loss:3.6421 train_time:220610ms step_avg:350.73ms
step:640/1750 train_loss:3.5775 train_time:220970ms step_avg:350.75ms
step:641/1750 train_loss:3.5955 train_time:221330ms step_avg:350.76ms
step:642/1750 train_loss:3.6442 train_time:221690ms step_avg:350.78ms
step:643/1750 train_loss:3.6158 train_time:222049ms step_avg:350.79ms
step:644/1750 train_loss:3.5662 train_time:222408ms step_avg:350.80ms
step:645/1750 train_loss:3.7969 train_time:222771ms step_avg:350.82ms
step:646/1750 train_loss:3.6899 train_time:223131ms step_avg:350.83ms
step:647/1750 train_loss:3.6806 train_time:223491ms step_avg:350.85ms
step:648/1750 train_loss:3.7178 train_time:223856ms step_avg:350.87ms
step:649/1750 train_loss:3.7819 train_time:224215ms step_avg:350.88ms
step:650/1750 train_loss:3.6308 train_time:224580ms step_avg:350.91ms
step:651/1750 train_loss:3.7812 train_time:224950ms step_avg:350.94ms
step:652/1750 train_loss:3.5946 train_time:225318ms step_avg:350.96ms
step:653/1750 train_loss:3.6773 train_time:225686ms step_avg:350.99ms
step:654/1750 train_loss:3.4444 train_time:226055ms step_avg:351.02ms
step:655/1750 train_loss:3.5896 train_time:226418ms step_avg:351.04ms
step:656/1750 train_loss:3.5879 train_time:226783ms step_avg:351.06ms
step:657/1750 train_loss:3.5126 train_time:227149ms step_avg:351.08ms
step:658/1750 train_loss:3.7008 train_time:227516ms step_avg:351.10ms
step:659/1750 train_loss:3.5974 train_time:227881ms step_avg:351.13ms
step:660/1750 train_loss:3.6954 train_time:228246ms step_avg:351.15ms
step:661/1750 train_loss:3.7596 train_time:228617ms step_avg:351.18ms
step:662/1750 train_loss:3.6813 train_time:228981ms step_avg:351.20ms
step:663/1750 train_loss:3.5610 train_time:229346ms step_avg:351.22ms
step:664/1750 train_loss:3.6262 train_time:229715ms step_avg:351.25ms
step:665/1750 train_loss:3.5043 train_time:230082ms step_avg:351.27ms
step:666/1750 train_loss:3.7923 train_time:230449ms step_avg:351.29ms
step:667/1750 train_loss:3.6203 train_time:230816ms step_avg:351.32ms
step:668/1750 train_loss:3.6530 train_time:231188ms step_avg:351.35ms
step:669/1750 train_loss:3.4993 train_time:231560ms step_avg:351.38ms
step:670/1750 train_loss:3.6109 train_time:231926ms step_avg:351.40ms
step:671/1750 train_loss:3.5729 train_time:232297ms step_avg:351.43ms
step:672/1750 train_loss:3.5863 train_time:232665ms step_avg:351.46ms
step:673/1750 train_loss:3.8594 train_time:233032ms step_avg:351.48ms
step:674/1750 train_loss:3.6392 train_time:233400ms step_avg:351.51ms
step:675/1750 train_loss:3.7209 train_time:233767ms step_avg:351.53ms
step:676/1750 train_loss:3.4946 train_time:234135ms step_avg:351.55ms
step:677/1750 train_loss:3.6071 train_time:234503ms step_avg:351.58ms
step:678/1750 train_loss:3.5658 train_time:234872ms step_avg:351.61ms
step:679/1750 train_loss:3.6953 train_time:235242ms step_avg:351.63ms
step:680/1750 train_loss:3.5998 train_time:235610ms step_avg:351.66ms
step:681/1750 train_loss:3.6283 train_time:235980ms step_avg:351.68ms
step:682/1750 train_loss:3.6728 train_time:236352ms step_avg:351.71ms
step:683/1750 train_loss:3.7459 train_time:236719ms step_avg:351.74ms
step:684/1750 train_loss:3.6623 train_time:237084ms step_avg:351.76ms
step:685/1750 train_loss:3.7023 train_time:237450ms step_avg:351.78ms
step:686/1750 train_loss:3.6512 train_time:237817ms step_avg:351.80ms
step:687/1750 train_loss:3.6777 train_time:238180ms step_avg:351.82ms
step:688/1750 train_loss:3.2178 train_time:238553ms step_avg:351.85ms
step:689/1750 train_loss:3.4172 train_time:238925ms step_avg:351.88ms
step:690/1750 train_loss:3.5556 train_time:239297ms step_avg:351.91ms
step:691/1750 train_loss:3.4244 train_time:239661ms step_avg:351.92ms
step:692/1750 train_loss:3.6341 train_time:240026ms step_avg:351.94ms
step:693/1750 train_loss:3.6595 train_time:240393ms step_avg:351.97ms
step:694/1750 train_loss:3.5594 train_time:240760ms step_avg:351.99ms
step:695/1750 train_loss:3.5487 train_time:241122ms step_avg:352.00ms
step:696/1750 train_loss:3.8680 train_time:241488ms step_avg:352.02ms
step:697/1750 train_loss:3.5974 train_time:241854ms step_avg:352.04ms
step:698/1750 train_loss:3.6571 train_time:242220ms step_avg:352.06ms
step:699/1750 train_loss:3.7816 train_time:242589ms step_avg:352.09ms
step:700/1750 train_loss:3.5788 train_time:242959ms step_avg:352.11ms
step:701/1750 train_loss:3.5533 train_time:243323ms step_avg:352.13ms
step:702/1750 train_loss:3.5284 train_time:243692ms step_avg:352.16ms
step:703/1750 train_loss:3.5120 train_time:244059ms step_avg:352.18ms
step:704/1750 train_loss:3.5863 train_time:244425ms step_avg:352.20ms
step:705/1750 train_loss:3.5739 train_time:244800ms step_avg:352.23ms
step:706/1750 train_loss:3.5961 train_time:245176ms step_avg:352.26ms
step:707/1750 train_loss:3.6606 train_time:245542ms step_avg:352.28ms
step:708/1750 train_loss:3.6125 train_time:245907ms step_avg:352.30ms
step:709/1750 train_loss:3.6046 train_time:246273ms step_avg:352.32ms
step:710/1750 train_loss:3.5600 train_time:246640ms step_avg:352.34ms
step:711/1750 train_loss:3.6044 train_time:247011ms step_avg:352.37ms
step:712/1750 train_loss:3.6591 train_time:247383ms step_avg:352.40ms
step:713/1750 train_loss:3.6689 train_time:247755ms step_avg:352.43ms
step:714/1750 train_loss:3.5738 train_time:248120ms step_avg:352.44ms
step:715/1750 train_loss:3.5879 train_time:248485ms step_avg:352.46ms
step:716/1750 train_loss:3.5931 train_time:248849ms step_avg:352.48ms
step:717/1750 train_loss:3.7252 train_time:249218ms step_avg:352.50ms
step:718/1750 train_loss:3.6101 train_time:249582ms step_avg:352.52ms
step:719/1750 train_loss:3.6885 train_time:249944ms step_avg:352.53ms
step:720/1750 train_loss:3.8578 train_time:250314ms step_avg:352.55ms
step:721/1750 train_loss:3.4813 train_time:250680ms step_avg:352.57ms
step:722/1750 train_loss:3.7472 train_time:251046ms step_avg:352.59ms
step:723/1750 train_loss:3.7841 train_time:251410ms step_avg:352.61ms
step:724/1750 train_loss:3.5753 train_time:251778ms step_avg:352.63ms
step:725/1750 train_loss:3.6611 train_time:252142ms step_avg:352.65ms
step:726/1750 train_loss:3.5477 train_time:252510ms step_avg:352.67ms
step:727/1750 train_loss:3.5880 train_time:252881ms step_avg:352.69ms
step:728/1750 train_loss:3.7447 train_time:253248ms step_avg:352.71ms
step:729/1750 train_loss:3.6802 train_time:253614ms step_avg:352.73ms
step:730/1750 train_loss:3.6758 train_time:253982ms step_avg:352.75ms
step:731/1750 train_loss:3.5720 train_time:254346ms step_avg:352.77ms
step:732/1750 train_loss:3.6053 train_time:254710ms step_avg:352.78ms
step:733/1750 train_loss:3.8442 train_time:255080ms step_avg:352.81ms
step:734/1750 train_loss:3.5765 train_time:255450ms step_avg:352.83ms
step:735/1750 train_loss:3.6158 train_time:255816ms step_avg:352.85ms
step:736/1750 train_loss:3.7463 train_time:256180ms step_avg:352.87ms
step:737/1750 train_loss:3.6841 train_time:256543ms step_avg:352.88ms
step:738/1750 train_loss:3.6153 train_time:256907ms step_avg:352.89ms
step:739/1750 train_loss:3.5163 train_time:257274ms step_avg:352.91ms
step:740/1750 train_loss:4.1213 train_time:257648ms step_avg:352.94ms
step:741/1750 train_loss:3.5095 train_time:258013ms step_avg:352.96ms
step:742/1750 train_loss:3.5685 train_time:258377ms step_avg:352.97ms
step:743/1750 train_loss:3.5936 train_time:258742ms step_avg:352.99ms
step:744/1750 train_loss:3.6627 train_time:259109ms step_avg:353.01ms
step:745/1750 train_loss:3.5961 train_time:259478ms step_avg:353.03ms
step:746/1750 train_loss:3.6070 train_time:259841ms step_avg:353.04ms
step:747/1750 train_loss:3.6609 train_time:260211ms step_avg:353.07ms
step:748/1750 train_loss:3.5872 train_time:260585ms step_avg:353.10ms
step:749/1750 train_loss:3.5758 train_time:260951ms step_avg:353.11ms
step:750/1750 train_loss:3.6207 train_time:261315ms step_avg:353.13ms
step:750/1750 val_loss:3.5816 train_time:261412ms step_avg:353.26ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 242.00243 | frobenius_norm = 55636.91797 | spectral_norm = 9958.05273 | nuclear_norm = 1390462.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 139.10059 | spectral_norm = 22.69281 | nuclear_norm = 3220.47852
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 134.33273 | spectral_norm = 24.77268 | nuclear_norm = 3093.68726
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 297.89636 | spectral_norm = 19.11179 | nuclear_norm = 7241.80811
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 234.47432 | spectral_norm = 22.90001 | nuclear_norm = 5439.77930
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 292.71317 | spectral_norm = 24.51476 | nuclear_norm = 7774.73096
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 148.67657 | spectral_norm = 12.69597 | nuclear_norm = 3930.61719
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 139.22511 | spectral_norm = 13.83161 | nuclear_norm = 3228.35059
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 136.12962 | spectral_norm = 13.42432 | nuclear_norm = 3163.09424
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 299.07086 | spectral_norm = 26.11716 | nuclear_norm = 6850.53906
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 300.79483 | spectral_norm = 23.23058 | nuclear_norm = 7006.78516
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 299.90073 | spectral_norm = 22.38288 | nuclear_norm = 7966.50684
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 148.89047 | spectral_norm = 14.70027 | nuclear_norm = 3915.26758
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 131.75615 | spectral_norm = 12.58658 | nuclear_norm = 2939.33667
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 132.48012 | spectral_norm = 11.77392 | nuclear_norm = 2969.26318
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 313.23947 | spectral_norm = 28.55772 | nuclear_norm = 7159.36621
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 320.17029 | spectral_norm = 25.03401 | nuclear_norm = 7514.39697
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 305.53070 | spectral_norm = 23.85428 | nuclear_norm = 8124.30371
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 148.31543 | spectral_norm = 14.45473 | nuclear_norm = 3901.96387
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 136.20267 | spectral_norm = 13.50614 | nuclear_norm = 3153.99756
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 135.22801 | spectral_norm = 13.84520 | nuclear_norm = 3133.84326
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 322.06677 | spectral_norm = 27.74072 | nuclear_norm = 7355.98096
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 326.10812 | spectral_norm = 25.45763 | nuclear_norm = 7625.10742
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 311.90100 | spectral_norm = 26.18740 | nuclear_norm = 8271.77051
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 151.73038 | spectral_norm = 14.38142 | nuclear_norm = 3985.25317
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 135.82637 | spectral_norm = 13.51043 | nuclear_norm = 3140.39990
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 135.86353 | spectral_norm = 13.33399 | nuclear_norm = 3153.91602
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 333.21097 | spectral_norm = 28.31659 | nuclear_norm = 7617.12451
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 329.30957 | spectral_norm = 24.58551 | nuclear_norm = 7732.74170
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 310.43396 | spectral_norm = 24.35754 | nuclear_norm = 8244.82617
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 152.06833 | spectral_norm = 13.82791 | nuclear_norm = 3998.92676
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 133.56709 | spectral_norm = 12.72935 | nuclear_norm = 3058.02832
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 133.36296 | spectral_norm = 12.39118 | nuclear_norm = 3062.91943
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 335.87598 | spectral_norm = 29.18451 | nuclear_norm = 7632.16992
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 324.74789 | spectral_norm = 25.47933 | nuclear_norm = 7654.68604
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 312.90524 | spectral_norm = 22.40597 | nuclear_norm = 8337.97461
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 150.45287 | spectral_norm = 13.01855 | nuclear_norm = 3956.15186
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 131.76019 | spectral_norm = 13.52215 | nuclear_norm = 3022.25781
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 128.73199 | spectral_norm = 13.26673 | nuclear_norm = 2970.20654
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 324.79755 | spectral_norm = 27.01733 | nuclear_norm = 7477.35059
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 320.08026 | spectral_norm = 23.85880 | nuclear_norm = 7500.88037
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 310.43365 | spectral_norm = 21.63994 | nuclear_norm = 8266.13672
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 152.40007 | spectral_norm = 13.72516 | nuclear_norm = 4010.88184
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 136.97374 | spectral_norm = 12.84066 | nuclear_norm = 3145.92554
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 136.19200 | spectral_norm = 12.91909 | nuclear_norm = 3136.92676
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 349.17957 | spectral_norm = 29.90301 | nuclear_norm = 7951.81934
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 332.08411 | spectral_norm = 25.93664 | nuclear_norm = 7798.37402
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 305.17563 | spectral_norm = 25.12810 | nuclear_norm = 8119.32129
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 153.03189 | spectral_norm = 13.74308 | nuclear_norm = 4036.04785
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 135.92632 | spectral_norm = 13.18777 | nuclear_norm = 3097.15454
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 135.75032 | spectral_norm = 12.09539 | nuclear_norm = 3074.95654
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 346.45663 | spectral_norm = 28.97624 | nuclear_norm = 7914.20850
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 340.70990 | spectral_norm = 24.70116 | nuclear_norm = 8024.83984
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 305.61536 | spectral_norm = 25.66080 | nuclear_norm = 8120.33252
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 154.38173 | spectral_norm = 14.34929 | nuclear_norm = 4081.79102
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 139.30434 | spectral_norm = 13.30018 | nuclear_norm = 3173.08838
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 138.31848 | spectral_norm = 13.17955 | nuclear_norm = 3133.48755
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 354.54834 | spectral_norm = 31.13614 | nuclear_norm = 8179.66455
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 342.68289 | spectral_norm = 23.98482 | nuclear_norm = 8095.29150
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 302.56808 | spectral_norm = 24.22963 | nuclear_norm = 8048.57324
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 154.74680 | spectral_norm = 14.75507 | nuclear_norm = 4105.45361
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 139.24168 | spectral_norm = 13.59150 | nuclear_norm = 3159.49316
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 137.93042 | spectral_norm = 13.57508 | nuclear_norm = 3105.31934
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 332.25500 | spectral_norm = 29.01485 | nuclear_norm = 7664.55518
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 333.76685 | spectral_norm = 23.47827 | nuclear_norm = 7847.07568
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 312.34314 | spectral_norm = 22.82497 | nuclear_norm = 8323.06445
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 151.16985 | spectral_norm = 16.43569 | nuclear_norm = 4002.73682
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 137.78853 | spectral_norm = 16.20737 | nuclear_norm = 3104.19849
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 134.93367 | spectral_norm = 15.11854 | nuclear_norm = 3014.43115
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 295.83939 | spectral_norm = 31.38277 | nuclear_norm = 6745.40430
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 328.43817 | spectral_norm = 23.74684 | nuclear_norm = 7614.89648
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 327.83472 | spectral_norm = 25.91778 | nuclear_norm = 8721.37793
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 155.57785 | spectral_norm = 17.44640 | nuclear_norm = 4094.18262
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1014.87964 | spectral_norm = 190.84592 | nuclear_norm = 26348.72656
===========================================
step:751/1750 train_loss:3.5848 train_time:261679ms step_avg:353.14ms
step:752/1750 train_loss:3.6250 train_time:262037ms step_avg:353.15ms
step:753/1750 train_loss:3.6267 train_time:262400ms step_avg:353.16ms
step:754/1750 train_loss:3.6078 train_time:262766ms step_avg:353.18ms
step:755/1750 train_loss:3.6922 train_time:263178ms step_avg:353.26ms
step:756/1750 train_loss:3.4728 train_time:263617ms step_avg:353.37ms
step:757/1750 train_loss:3.7405 train_time:263984ms step_avg:353.39ms
step:758/1750 train_loss:3.6667 train_time:264347ms step_avg:353.40ms
step:759/1750 train_loss:3.6058 train_time:264850ms step_avg:353.60ms
step:760/1750 train_loss:3.7216 train_time:265212ms step_avg:353.62ms
step:761/1750 train_loss:3.4147 train_time:265578ms step_avg:353.63ms
step:762/1750 train_loss:3.5704 train_time:265944ms step_avg:353.65ms
step:763/1750 train_loss:3.6818 train_time:266308ms step_avg:353.66ms
step:764/1750 train_loss:3.3298 train_time:266673ms step_avg:353.68ms
step:765/1750 train_loss:3.7443 train_time:267042ms step_avg:353.70ms
step:766/1750 train_loss:3.5826 train_time:267411ms step_avg:353.72ms
step:767/1750 train_loss:3.5797 train_time:267774ms step_avg:353.73ms
step:768/1750 train_loss:3.5857 train_time:268142ms step_avg:353.75ms
step:769/1750 train_loss:3.6006 train_time:268511ms step_avg:353.77ms
step:770/1750 train_loss:3.6599 train_time:268877ms step_avg:353.79ms
step:771/1750 train_loss:3.8914 train_time:269241ms step_avg:353.80ms
step:772/1750 train_loss:3.4679 train_time:269603ms step_avg:353.81ms
step:773/1750 train_loss:3.6514 train_time:269968ms step_avg:353.82ms
step:774/1750 train_loss:3.6590 train_time:270332ms step_avg:353.84ms
step:775/1750 train_loss:3.6210 train_time:270696ms step_avg:353.85ms
step:776/1750 train_loss:3.4205 train_time:271063ms step_avg:353.87ms
step:777/1750 train_loss:3.4092 train_time:271431ms step_avg:353.89ms
step:778/1750 train_loss:3.5059 train_time:271794ms step_avg:353.90ms
step:779/1750 train_loss:3.5948 train_time:272165ms step_avg:353.92ms
step:780/1750 train_loss:3.6049 train_time:272538ms step_avg:353.94ms
step:781/1750 train_loss:3.6855 train_time:272906ms step_avg:353.96ms
step:782/1750 train_loss:3.6012 train_time:273277ms step_avg:353.99ms
step:783/1750 train_loss:3.5860 train_time:273648ms step_avg:354.01ms
step:784/1750 train_loss:3.6130 train_time:274021ms step_avg:354.03ms
step:785/1750 train_loss:3.5787 train_time:274388ms step_avg:354.05ms
step:786/1750 train_loss:3.4508 train_time:274758ms step_avg:354.07ms
step:787/1750 train_loss:3.7312 train_time:275133ms step_avg:354.10ms
step:788/1750 train_loss:3.5108 train_time:275507ms step_avg:354.12ms
step:789/1750 train_loss:3.5672 train_time:275877ms step_avg:354.14ms
step:790/1750 train_loss:3.6428 train_time:276251ms step_avg:354.17ms
step:791/1750 train_loss:3.7892 train_time:276630ms step_avg:354.20ms
step:792/1750 train_loss:3.7800 train_time:277001ms step_avg:354.22ms
step:793/1750 train_loss:3.4812 train_time:277368ms step_avg:354.24ms
step:794/1750 train_loss:3.6090 train_time:277739ms step_avg:354.26ms
step:795/1750 train_loss:3.6814 train_time:278114ms step_avg:354.28ms
step:796/1750 train_loss:3.7417 train_time:278490ms step_avg:354.31ms
step:797/1750 train_loss:3.5413 train_time:278861ms step_avg:354.33ms
step:798/1750 train_loss:3.6640 train_time:279238ms step_avg:354.36ms
step:799/1750 train_loss:3.5614 train_time:279618ms step_avg:354.40ms
step:800/1750 train_loss:3.5414 train_time:279992ms step_avg:354.42ms
step:801/1750 train_loss:3.6482 train_time:280360ms step_avg:354.44ms
step:802/1750 train_loss:3.5077 train_time:280734ms step_avg:354.46ms
step:803/1750 train_loss:3.5152 train_time:281101ms step_avg:354.48ms
step:804/1750 train_loss:3.6420 train_time:281472ms step_avg:354.50ms
step:805/1750 train_loss:3.5375 train_time:281847ms step_avg:354.52ms
step:806/1750 train_loss:3.5708 train_time:282215ms step_avg:354.54ms
step:807/1750 train_loss:3.6583 train_time:282586ms step_avg:354.56ms
step:808/1750 train_loss:3.5604 train_time:282957ms step_avg:354.58ms
step:809/1750 train_loss:3.5034 train_time:283324ms step_avg:354.60ms
step:810/1750 train_loss:3.5753 train_time:283693ms step_avg:354.62ms
step:811/1750 train_loss:3.6013 train_time:284063ms step_avg:354.64ms
step:812/1750 train_loss:3.6102 train_time:284430ms step_avg:354.65ms
step:813/1750 train_loss:3.6448 train_time:284796ms step_avg:354.67ms
step:814/1750 train_loss:3.5878 train_time:285168ms step_avg:354.69ms
step:815/1750 train_loss:3.5769 train_time:285540ms step_avg:354.71ms
step:816/1750 train_loss:3.7015 train_time:285915ms step_avg:354.73ms
step:817/1750 train_loss:3.7857 train_time:286285ms step_avg:354.75ms
step:818/1750 train_loss:3.5426 train_time:286655ms step_avg:354.77ms
step:819/1750 train_loss:3.7348 train_time:287029ms step_avg:354.79ms
step:820/1750 train_loss:3.5147 train_time:287402ms step_avg:354.82ms
step:821/1750 train_loss:3.5715 train_time:287773ms step_avg:354.84ms
step:822/1750 train_loss:3.7094 train_time:288146ms step_avg:354.86ms
step:823/1750 train_loss:3.5933 train_time:288518ms step_avg:354.88ms
step:824/1750 train_loss:3.5252 train_time:288888ms step_avg:354.90ms
step:825/1750 train_loss:3.6315 train_time:289262ms step_avg:354.92ms
step:826/1750 train_loss:3.4954 train_time:289637ms step_avg:354.95ms
step:827/1750 train_loss:3.7474 train_time:290012ms step_avg:354.97ms
step:828/1750 train_loss:3.6348 train_time:290385ms step_avg:354.99ms
step:829/1750 train_loss:3.6430 train_time:290759ms step_avg:355.02ms
step:830/1750 train_loss:3.5420 train_time:291130ms step_avg:355.04ms
step:831/1750 train_loss:3.6113 train_time:291499ms step_avg:355.05ms
step:832/1750 train_loss:3.5296 train_time:291869ms step_avg:355.07ms
step:833/1750 train_loss:3.6656 train_time:292241ms step_avg:355.09ms
step:834/1750 train_loss:3.4910 train_time:292615ms step_avg:355.11ms
step:835/1750 train_loss:3.4749 train_time:292990ms step_avg:355.14ms
step:836/1750 train_loss:3.7325 train_time:293367ms step_avg:355.17ms
step:837/1750 train_loss:3.4215 train_time:293738ms step_avg:355.19ms
step:838/1750 train_loss:3.6056 train_time:294108ms step_avg:355.20ms
step:839/1750 train_loss:3.4264 train_time:294478ms step_avg:355.22ms
step:840/1750 train_loss:3.4863 train_time:294847ms step_avg:355.24ms
step:841/1750 train_loss:3.5714 train_time:295221ms step_avg:355.26ms
step:842/1750 train_loss:3.5975 train_time:295594ms step_avg:355.28ms
step:843/1750 train_loss:3.5819 train_time:295963ms step_avg:355.30ms
step:844/1750 train_loss:3.4483 train_time:296333ms step_avg:355.31ms
step:845/1750 train_loss:3.6750 train_time:296702ms step_avg:355.33ms
step:846/1750 train_loss:3.5317 train_time:297072ms step_avg:355.35ms
step:847/1750 train_loss:3.5072 train_time:297445ms step_avg:355.37ms
step:848/1750 train_loss:3.6563 train_time:297817ms step_avg:355.39ms
step:849/1750 train_loss:3.5114 train_time:298188ms step_avg:355.41ms
step:850/1750 train_loss:3.4570 train_time:298560ms step_avg:355.43ms
step:851/1750 train_loss:3.7539 train_time:298929ms step_avg:355.44ms
step:852/1750 train_loss:3.4591 train_time:299295ms step_avg:355.46ms
step:853/1750 train_loss:3.5770 train_time:299664ms step_avg:355.47ms
step:854/1750 train_loss:3.6651 train_time:300037ms step_avg:355.49ms
step:855/1750 train_loss:3.5340 train_time:300405ms step_avg:355.51ms
step:856/1750 train_loss:3.5550 train_time:300772ms step_avg:355.52ms
step:857/1750 train_loss:3.6202 train_time:301145ms step_avg:355.54ms
step:858/1750 train_loss:3.4852 train_time:301519ms step_avg:355.57ms
step:859/1750 train_loss:3.5695 train_time:301889ms step_avg:355.58ms
step:860/1750 train_loss:3.6093 train_time:302255ms step_avg:355.59ms
step:861/1750 train_loss:3.6476 train_time:302633ms step_avg:355.62ms
step:862/1750 train_loss:3.6168 train_time:303011ms step_avg:355.65ms
step:863/1750 train_loss:3.5849 train_time:303384ms step_avg:355.67ms
step:864/1750 train_loss:3.4014 train_time:303755ms step_avg:355.68ms
step:865/1750 train_loss:3.6139 train_time:304121ms step_avg:355.70ms
step:866/1750 train_loss:3.8958 train_time:304493ms step_avg:355.72ms
step:867/1750 train_loss:3.4684 train_time:304863ms step_avg:355.73ms
step:868/1750 train_loss:3.6605 train_time:305231ms step_avg:355.75ms
step:869/1750 train_loss:3.6329 train_time:305603ms step_avg:355.77ms
step:870/1750 train_loss:3.4625 train_time:305975ms step_avg:355.79ms
step:871/1750 train_loss:3.4300 train_time:306342ms step_avg:355.80ms
step:872/1750 train_loss:3.6713 train_time:306710ms step_avg:355.81ms
step:873/1750 train_loss:3.4741 train_time:307077ms step_avg:355.83ms
step:874/1750 train_loss:3.2295 train_time:307455ms step_avg:355.85ms
step:875/1750 train_loss:3.6533 train_time:307826ms step_avg:355.87ms
step:875/1750 val_loss:3.5361 train_time:307923ms step_avg:355.98ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 256.24615 | frobenius_norm = 58972.46484 | spectral_norm = 10457.87695 | nuclear_norm = 1476593.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 152.49358 | spectral_norm = 26.29266 | nuclear_norm = 3520.05664
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 147.54355 | spectral_norm = 28.58975 | nuclear_norm = 3388.19165
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 325.59399 | spectral_norm = 21.10208 | nuclear_norm = 7938.13672
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 246.68983 | spectral_norm = 25.07442 | nuclear_norm = 5704.58887
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 325.00784 | spectral_norm = 27.68627 | nuclear_norm = 8632.41309
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 163.73599 | spectral_norm = 14.30390 | nuclear_norm = 4326.70166
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 153.55191 | spectral_norm = 15.70831 | nuclear_norm = 3554.21899
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 150.13673 | spectral_norm = 14.87849 | nuclear_norm = 3483.01953
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 324.17001 | spectral_norm = 28.86390 | nuclear_norm = 7416.81396
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 326.28726 | spectral_norm = 25.25837 | nuclear_norm = 7597.19141
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 329.29486 | spectral_norm = 24.77251 | nuclear_norm = 8751.71680
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 163.16946 | spectral_norm = 16.54836 | nuclear_norm = 4288.42383
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 144.79543 | spectral_norm = 14.03778 | nuclear_norm = 3214.59204
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 145.47371 | spectral_norm = 13.10245 | nuclear_norm = 3245.30029
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 341.48248 | spectral_norm = 31.49872 | nuclear_norm = 7795.29883
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 348.51297 | spectral_norm = 27.51451 | nuclear_norm = 8174.51807
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 335.19351 | spectral_norm = 27.34616 | nuclear_norm = 8914.82715
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 162.81042 | spectral_norm = 16.14389 | nuclear_norm = 4283.33105
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 149.80579 | spectral_norm = 15.18546 | nuclear_norm = 3461.63818
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 148.72633 | spectral_norm = 15.24659 | nuclear_norm = 3442.32471
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 352.11682 | spectral_norm = 30.20424 | nuclear_norm = 8042.63037
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 356.17551 | spectral_norm = 28.08611 | nuclear_norm = 8324.12891
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 341.62598 | spectral_norm = 29.45338 | nuclear_norm = 9061.13770
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 166.53577 | spectral_norm = 16.04078 | nuclear_norm = 4373.25293
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 149.47585 | spectral_norm = 15.16161 | nuclear_norm = 3447.25439
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 149.39301 | spectral_norm = 14.80641 | nuclear_norm = 3461.43359
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 364.81064 | spectral_norm = 30.99993 | nuclear_norm = 8343.07715
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 360.49954 | spectral_norm = 26.87763 | nuclear_norm = 8467.03516
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 340.10999 | spectral_norm = 27.03616 | nuclear_norm = 9034.36719
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 166.84059 | spectral_norm = 15.44102 | nuclear_norm = 4387.12354
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 146.70789 | spectral_norm = 14.28322 | nuclear_norm = 3345.48633
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 146.39215 | spectral_norm = 13.83690 | nuclear_norm = 3351.37085
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 368.79852 | spectral_norm = 31.91374 | nuclear_norm = 8382.78906
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 356.27344 | spectral_norm = 27.43422 | nuclear_norm = 8404.15723
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 343.55582 | spectral_norm = 25.01576 | nuclear_norm = 9157.97168
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 165.09258 | spectral_norm = 14.55886 | nuclear_norm = 4342.47314
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 144.64005 | spectral_norm = 15.29249 | nuclear_norm = 3305.48291
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 141.22171 | spectral_norm = 14.76676 | nuclear_norm = 3250.13843
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 355.77982 | spectral_norm = 29.71012 | nuclear_norm = 8205.64062
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 350.01685 | spectral_norm = 26.08066 | nuclear_norm = 8203.52441
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 340.56284 | spectral_norm = 23.66809 | nuclear_norm = 9074.26758
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 167.36993 | spectral_norm = 15.55269 | nuclear_norm = 4405.42432
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 150.44427 | spectral_norm = 14.37634 | nuclear_norm = 3445.05518
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 149.47345 | spectral_norm = 14.43580 | nuclear_norm = 3433.21777
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 382.14090 | spectral_norm = 33.26395 | nuclear_norm = 8686.80273
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 362.91537 | spectral_norm = 28.29222 | nuclear_norm = 8523.75000
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 334.70840 | spectral_norm = 27.70088 | nuclear_norm = 8907.25684
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 168.19821 | spectral_norm = 15.60664 | nuclear_norm = 4436.30566
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 149.34502 | spectral_norm = 14.75537 | nuclear_norm = 3390.25537
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 148.89616 | spectral_norm = 13.46160 | nuclear_norm = 3358.65723
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 378.28351 | spectral_norm = 32.14334 | nuclear_norm = 8624.92480
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 371.01541 | spectral_norm = 26.87594 | nuclear_norm = 8728.56641
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 336.05896 | spectral_norm = 28.54460 | nuclear_norm = 8928.21289
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 169.99857 | spectral_norm = 16.32625 | nuclear_norm = 4494.80518
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 153.36090 | spectral_norm = 14.86155 | nuclear_norm = 3479.21899
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 152.27084 | spectral_norm = 14.71627 | nuclear_norm = 3434.74463
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 388.26794 | spectral_norm = 35.66774 | nuclear_norm = 8939.88672
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 374.03867 | spectral_norm = 26.43160 | nuclear_norm = 8833.35840
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 331.80521 | spectral_norm = 26.88595 | nuclear_norm = 8826.02637
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 170.57077 | spectral_norm = 16.57672 | nuclear_norm = 4527.06592
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 153.30730 | spectral_norm = 15.17176 | nuclear_norm = 3462.01855
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 151.83920 | spectral_norm = 15.23905 | nuclear_norm = 3403.85498
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 363.17987 | spectral_norm = 32.65803 | nuclear_norm = 8369.70020
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 363.21661 | spectral_norm = 25.70026 | nuclear_norm = 8539.14844
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 344.21402 | spectral_norm = 25.39764 | nuclear_norm = 9173.13672
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 166.28757 | spectral_norm = 18.59634 | nuclear_norm = 4404.08691
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 151.51122 | spectral_norm = 18.35163 | nuclear_norm = 3394.40137
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 148.02411 | spectral_norm = 16.96735 | nuclear_norm = 3290.73486
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 323.20648 | spectral_norm = 35.69791 | nuclear_norm = 7353.99414
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 359.12543 | spectral_norm = 25.97906 | nuclear_norm = 8322.16797
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 361.24533 | spectral_norm = 28.67581 | nuclear_norm = 9608.34863
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 170.97011 | spectral_norm = 19.98828 | nuclear_norm = 4495.71240
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1098.28406 | spectral_norm = 191.21683 | nuclear_norm = 28646.66992
===========================================
step:876/1750 train_loss:3.4591 train_time:308187ms step_avg:355.87ms
step:877/1750 train_loss:3.6354 train_time:308546ms step_avg:355.88ms
step:878/1750 train_loss:3.4851 train_time:308916ms step_avg:355.89ms
step:879/1750 train_loss:3.6703 train_time:309284ms step_avg:355.91ms
step:880/1750 train_loss:3.3216 train_time:309651ms step_avg:355.92ms
step:881/1750 train_loss:3.5061 train_time:310018ms step_avg:355.93ms
step:882/1750 train_loss:3.7117 train_time:310387ms step_avg:355.95ms
step:883/1750 train_loss:3.8540 train_time:310753ms step_avg:355.96ms
step:884/1750 train_loss:3.5820 train_time:311122ms step_avg:355.98ms
step:885/1750 train_loss:3.5082 train_time:311490ms step_avg:355.99ms
step:886/1750 train_loss:3.5891 train_time:311859ms step_avg:356.00ms
step:887/1750 train_loss:4.1025 train_time:312229ms step_avg:356.02ms
step:888/1750 train_loss:3.8517 train_time:312609ms step_avg:356.05ms
step:889/1750 train_loss:3.5338 train_time:312978ms step_avg:356.06ms
step:890/1750 train_loss:3.5445 train_time:313343ms step_avg:356.07ms
step:891/1750 train_loss:3.3752 train_time:313712ms step_avg:356.09ms
step:892/1750 train_loss:3.7363 train_time:314080ms step_avg:356.10ms
step:893/1750 train_loss:3.4457 train_time:314446ms step_avg:356.11ms
step:894/1750 train_loss:3.6447 train_time:314820ms step_avg:356.13ms
step:895/1750 train_loss:3.6986 train_time:315192ms step_avg:356.15ms
step:896/1750 train_loss:3.5185 train_time:315560ms step_avg:356.16ms
step:897/1750 train_loss:3.5583 train_time:315931ms step_avg:356.18ms
step:898/1750 train_loss:3.6074 train_time:316300ms step_avg:356.19ms
step:899/1750 train_loss:3.4957 train_time:316668ms step_avg:356.21ms
step:900/1750 train_loss:3.4360 train_time:317040ms step_avg:356.22ms
step:901/1750 train_loss:3.6326 train_time:317406ms step_avg:356.24ms
step:902/1750 train_loss:3.6552 train_time:317776ms step_avg:356.25ms
step:903/1750 train_loss:3.5598 train_time:318149ms step_avg:356.27ms
step:904/1750 train_loss:3.5136 train_time:318519ms step_avg:356.29ms
step:905/1750 train_loss:3.5248 train_time:318886ms step_avg:356.30ms
step:906/1750 train_loss:3.7247 train_time:319259ms step_avg:356.32ms
step:907/1750 train_loss:3.5281 train_time:319633ms step_avg:356.34ms
step:908/1750 train_loss:3.5911 train_time:320000ms step_avg:356.35ms
step:909/1750 train_loss:3.4665 train_time:320380ms step_avg:356.37ms
step:910/1750 train_loss:3.5501 train_time:320765ms step_avg:356.41ms
step:911/1750 train_loss:3.6663 train_time:321138ms step_avg:356.42ms
step:912/1750 train_loss:3.6164 train_time:321516ms step_avg:356.45ms
step:913/1750 train_loss:3.4671 train_time:321895ms step_avg:356.47ms
step:914/1750 train_loss:3.7624 train_time:322275ms step_avg:356.50ms
step:915/1750 train_loss:3.5559 train_time:322658ms step_avg:356.53ms
step:916/1750 train_loss:3.6401 train_time:323033ms step_avg:356.55ms
step:917/1750 train_loss:3.6116 train_time:323408ms step_avg:356.57ms
step:918/1750 train_loss:4.8170 train_time:323791ms step_avg:356.60ms
step:919/1750 train_loss:3.5075 train_time:324173ms step_avg:356.63ms
step:920/1750 train_loss:3.6038 train_time:324545ms step_avg:356.64ms
step:921/1750 train_loss:3.5648 train_time:324923ms step_avg:356.67ms
step:922/1750 train_loss:3.6042 train_time:325303ms step_avg:356.69ms
step:923/1750 train_loss:3.6323 train_time:325677ms step_avg:356.71ms
step:924/1750 train_loss:3.6953 train_time:326053ms step_avg:356.73ms
step:925/1750 train_loss:3.6636 train_time:326428ms step_avg:356.75ms
step:926/1750 train_loss:3.5721 train_time:326799ms step_avg:356.77ms
step:927/1750 train_loss:3.5722 train_time:327170ms step_avg:356.78ms
step:928/1750 train_loss:3.7983 train_time:327545ms step_avg:356.80ms
step:929/1750 train_loss:3.6311 train_time:327921ms step_avg:356.82ms
step:930/1750 train_loss:3.4180 train_time:328297ms step_avg:356.84ms
step:931/1750 train_loss:3.5142 train_time:328666ms step_avg:356.86ms
step:932/1750 train_loss:3.6706 train_time:329040ms step_avg:356.88ms
step:933/1750 train_loss:3.4049 train_time:329416ms step_avg:356.90ms
step:934/1750 train_loss:3.6081 train_time:329793ms step_avg:356.92ms
step:935/1750 train_loss:3.4610 train_time:330172ms step_avg:356.94ms
step:936/1750 train_loss:3.5391 train_time:330550ms step_avg:356.97ms
step:937/1750 train_loss:3.6431 train_time:330930ms step_avg:356.99ms
step:938/1750 train_loss:3.5580 train_time:331303ms step_avg:357.01ms
step:939/1750 train_loss:3.6832 train_time:331688ms step_avg:357.04ms
step:940/1750 train_loss:3.5000 train_time:332064ms step_avg:357.06ms
step:941/1750 train_loss:3.5640 train_time:332437ms step_avg:357.08ms
step:942/1750 train_loss:3.3777 train_time:332812ms step_avg:357.09ms
step:943/1750 train_loss:3.7313 train_time:333194ms step_avg:357.12ms
step:944/1750 train_loss:3.4220 train_time:333627ms step_avg:357.20ms
step:945/1750 train_loss:3.4433 train_time:334074ms step_avg:357.30ms
step:946/1750 train_loss:5.0937 train_time:334458ms step_avg:357.33ms
step:947/1750 train_loss:3.6140 train_time:334834ms step_avg:357.35ms
step:948/1750 train_loss:3.5024 train_time:335211ms step_avg:357.37ms
step:949/1750 train_loss:3.4009 train_time:335734ms step_avg:357.54ms
step:950/1750 train_loss:3.4577 train_time:336111ms step_avg:357.56ms
step:951/1750 train_loss:3.4268 train_time:336490ms step_avg:357.59ms
step:952/1750 train_loss:3.4982 train_time:336862ms step_avg:357.60ms
step:953/1750 train_loss:3.5863 train_time:337244ms step_avg:357.63ms
step:954/1750 train_loss:3.4637 train_time:337626ms step_avg:357.65ms
step:955/1750 train_loss:3.4947 train_time:337996ms step_avg:357.67ms
step:956/1750 train_loss:3.4621 train_time:338373ms step_avg:357.69ms
step:957/1750 train_loss:3.5217 train_time:338760ms step_avg:357.72ms
step:958/1750 train_loss:3.5204 train_time:339143ms step_avg:357.75ms
step:959/1750 train_loss:3.5353 train_time:339517ms step_avg:357.76ms
step:960/1750 train_loss:3.4241 train_time:339894ms step_avg:357.78ms
step:961/1750 train_loss:3.6714 train_time:340268ms step_avg:357.80ms
step:962/1750 train_loss:3.6195 train_time:340641ms step_avg:357.82ms
step:963/1750 train_loss:3.6556 train_time:341018ms step_avg:357.84ms
step:964/1750 train_loss:3.4472 train_time:341398ms step_avg:357.86ms
step:965/1750 train_loss:3.5018 train_time:341771ms step_avg:357.87ms
step:966/1750 train_loss:3.7367 train_time:342143ms step_avg:357.89ms
step:967/1750 train_loss:3.5527 train_time:342515ms step_avg:357.91ms
step:968/1750 train_loss:3.5470 train_time:342891ms step_avg:357.92ms
step:969/1750 train_loss:3.6025 train_time:343269ms step_avg:357.94ms
step:970/1750 train_loss:3.3958 train_time:343643ms step_avg:357.96ms
step:971/1750 train_loss:3.5591 train_time:344019ms step_avg:357.98ms
step:972/1750 train_loss:3.5086 train_time:344389ms step_avg:357.99ms
step:973/1750 train_loss:3.5631 train_time:344760ms step_avg:358.01ms
step:974/1750 train_loss:3.6164 train_time:345136ms step_avg:358.02ms
step:975/1750 train_loss:3.4936 train_time:345510ms step_avg:358.04ms
step:976/1750 train_loss:3.6948 train_time:345881ms step_avg:358.05ms
step:977/1750 train_loss:3.5963 train_time:346252ms step_avg:358.07ms
step:978/1750 train_loss:3.3852 train_time:346624ms step_avg:358.08ms
step:979/1750 train_loss:3.6510 train_time:346999ms step_avg:358.10ms
step:980/1750 train_loss:3.4475 train_time:347379ms step_avg:358.12ms
step:981/1750 train_loss:3.6005 train_time:347757ms step_avg:358.14ms
step:982/1750 train_loss:3.5723 train_time:348130ms step_avg:358.16ms
step:983/1750 train_loss:3.5465 train_time:348507ms step_avg:358.18ms
step:984/1750 train_loss:3.5241 train_time:348881ms step_avg:358.19ms
step:985/1750 train_loss:3.6068 train_time:349259ms step_avg:358.21ms
step:986/1750 train_loss:3.4418 train_time:349633ms step_avg:358.23ms
step:987/1750 train_loss:3.5164 train_time:350001ms step_avg:358.24ms
step:988/1750 train_loss:3.5289 train_time:350373ms step_avg:358.25ms
step:989/1750 train_loss:3.4441 train_time:350742ms step_avg:358.27ms
step:990/1750 train_loss:3.6818 train_time:351116ms step_avg:358.28ms
step:991/1750 train_loss:3.4989 train_time:351490ms step_avg:358.30ms
step:992/1750 train_loss:3.4669 train_time:351879ms step_avg:358.33ms
step:993/1750 train_loss:3.5389 train_time:352264ms step_avg:358.36ms
step:994/1750 train_loss:3.6243 train_time:352635ms step_avg:358.37ms
step:995/1750 train_loss:3.5632 train_time:353004ms step_avg:358.38ms
step:996/1750 train_loss:3.4854 train_time:353373ms step_avg:358.39ms
step:997/1750 train_loss:3.8044 train_time:353744ms step_avg:358.40ms
step:998/1750 train_loss:3.4783 train_time:354114ms step_avg:358.42ms
step:999/1750 train_loss:3.6156 train_time:354488ms step_avg:358.43ms
step:1000/1750 train_loss:3.4739 train_time:354867ms step_avg:358.45ms
step:1000/1750 val_loss:3.4996 train_time:354961ms step_avg:358.55ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 269.08102 | frobenius_norm = 61983.46094 | spectral_norm = 10937.50586 | nuclear_norm = 1554448.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 164.57582 | spectral_norm = 29.65825 | nuclear_norm = 3790.45117
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 159.70279 | spectral_norm = 31.90764 | nuclear_norm = 3662.25293
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 350.97086 | spectral_norm = 22.84001 | nuclear_norm = 8579.99805
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 257.55948 | spectral_norm = 27.00427 | nuclear_norm = 5932.19580
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 355.51352 | spectral_norm = 30.68753 | nuclear_norm = 9441.17480
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 177.36327 | spectral_norm = 15.80651 | nuclear_norm = 4683.35010
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 166.72015 | spectral_norm = 17.43655 | nuclear_norm = 3852.01123
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 163.08931 | spectral_norm = 16.27552 | nuclear_norm = 3780.27344
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 347.53085 | spectral_norm = 31.58230 | nuclear_norm = 7939.82471
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 350.55878 | spectral_norm = 27.56742 | nuclear_norm = 8163.72656
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 356.54861 | spectral_norm = 27.30405 | nuclear_norm = 9480.09766
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 176.18269 | spectral_norm = 18.14899 | nuclear_norm = 4628.85938
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 156.54674 | spectral_norm = 15.40149 | nuclear_norm = 3461.67285
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 157.50681 | spectral_norm = 14.32676 | nuclear_norm = 3499.44995
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 368.33701 | spectral_norm = 34.25599 | nuclear_norm = 8400.72461
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 375.53653 | spectral_norm = 29.75014 | nuclear_norm = 8803.94336
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 362.29782 | spectral_norm = 30.60829 | nuclear_norm = 9636.53906
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 176.12509 | spectral_norm = 17.70756 | nuclear_norm = 4633.89941
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 162.39262 | spectral_norm = 16.75351 | nuclear_norm = 3744.66138
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 161.26357 | spectral_norm = 16.43653 | nuclear_norm = 3727.20947
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 380.90689 | spectral_norm = 32.68737 | nuclear_norm = 8704.12109
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 384.80731 | spectral_norm = 30.46629 | nuclear_norm = 8992.25391
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 368.77335 | spectral_norm = 32.59236 | nuclear_norm = 9782.73633
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 180.12756 | spectral_norm = 17.65185 | nuclear_norm = 4730.00146
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 162.09766 | spectral_norm = 16.55548 | nuclear_norm = 3729.34717
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 161.72435 | spectral_norm = 16.07104 | nuclear_norm = 3740.28467
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 394.79767 | spectral_norm = 33.56285 | nuclear_norm = 9033.28809
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 389.90375 | spectral_norm = 29.01942 | nuclear_norm = 9160.30469
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 366.96075 | spectral_norm = 29.52363 | nuclear_norm = 9747.62500
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 180.41016 | spectral_norm = 16.98853 | nuclear_norm = 4744.17969
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 158.70183 | spectral_norm = 15.68337 | nuclear_norm = 3609.35205
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 158.34155 | spectral_norm = 15.04716 | nuclear_norm = 3615.03125
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 399.50272 | spectral_norm = 34.58234 | nuclear_norm = 9090.26660
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 385.54300 | spectral_norm = 29.22528 | nuclear_norm = 9103.05078
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 371.40482 | spectral_norm = 27.62337 | nuclear_norm = 9903.67969
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 178.50266 | spectral_norm = 15.98750 | nuclear_norm = 4696.67432
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 156.48999 | spectral_norm = 16.88299 | nuclear_norm = 3563.71753
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 152.73955 | spectral_norm = 16.23487 | nuclear_norm = 3507.53320
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 385.01019 | spectral_norm = 32.30738 | nuclear_norm = 8890.92578
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 378.39133 | spectral_norm = 28.13824 | nuclear_norm = 8873.60352
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 368.24780 | spectral_norm = 25.63984 | nuclear_norm = 9818.05469
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 181.13737 | spectral_norm = 17.18042 | nuclear_norm = 4768.31445
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 162.81616 | spectral_norm = 15.71362 | nuclear_norm = 3717.52051
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 161.57774 | spectral_norm = 15.72630 | nuclear_norm = 3702.52319
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 412.87067 | spectral_norm = 36.26011 | nuclear_norm = 9373.45410
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 391.56723 | spectral_norm = 30.50914 | nuclear_norm = 9199.06445
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 362.11581 | spectral_norm = 29.86539 | nuclear_norm = 9639.03125
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 182.12766 | spectral_norm = 17.37178 | nuclear_norm = 4802.88086
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 161.68478 | spectral_norm = 16.30180 | nuclear_norm = 3658.66650
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 160.92267 | spectral_norm = 14.79595 | nuclear_norm = 3618.58838
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 407.61826 | spectral_norm = 34.98451 | nuclear_norm = 9278.51367
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 398.92007 | spectral_norm = 28.77502 | nuclear_norm = 9369.76953
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 364.63919 | spectral_norm = 31.08669 | nuclear_norm = 9685.84570
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 184.33591 | spectral_norm = 18.12809 | nuclear_norm = 4873.47070
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 166.16713 | spectral_norm = 16.35388 | nuclear_norm = 3758.26978
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 165.13445 | spectral_norm = 16.15911 | nuclear_norm = 3710.23071
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 418.99533 | spectral_norm = 39.88889 | nuclear_norm = 9632.47168
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 402.55814 | spectral_norm = 28.44397 | nuclear_norm = 9498.37793
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 358.86642 | spectral_norm = 29.54681 | nuclear_norm = 9543.36914
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 184.98343 | spectral_norm = 18.25080 | nuclear_norm = 4910.37109
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 166.17798 | spectral_norm = 16.75018 | nuclear_norm = 3741.71387
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 164.63603 | spectral_norm = 16.81072 | nuclear_norm = 3676.65112
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 392.20822 | spectral_norm = 36.16625 | nuclear_norm = 9024.89941
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 390.72626 | spectral_norm = 27.50870 | nuclear_norm = 9180.30957
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 373.56842 | spectral_norm = 27.96774 | nuclear_norm = 9955.04590
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 180.28963 | spectral_norm = 20.53007 | nuclear_norm = 4775.71826
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 164.02289 | spectral_norm = 20.39190 | nuclear_norm = 3653.90186
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 159.89305 | spectral_norm = 18.71291 | nuclear_norm = 3538.88403
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 349.47147 | spectral_norm = 39.90968 | nuclear_norm = 7939.34912
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 390.24109 | spectral_norm = 28.16529 | nuclear_norm = 9037.58887
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 392.23605 | spectral_norm = 31.16148 | nuclear_norm = 10431.44629
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 185.31654 | spectral_norm = 22.39183 | nuclear_norm = 4869.31445
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1175.02234 | spectral_norm = 190.14236 | nuclear_norm = 30762.50000
===========================================
step:1001/1750 train_loss:3.5359 train_time:355229ms step_avg:358.45ms
step:1002/1750 train_loss:3.4156 train_time:355593ms step_avg:358.46ms
step:1003/1750 train_loss:3.5917 train_time:355971ms step_avg:358.48ms
step:1004/1750 train_loss:3.6391 train_time:356346ms step_avg:358.50ms
step:1005/1750 train_loss:3.4203 train_time:356717ms step_avg:358.51ms
step:1006/1750 train_loss:3.4969 train_time:357091ms step_avg:358.52ms
step:1007/1750 train_loss:3.4705 train_time:357461ms step_avg:358.54ms
step:1008/1750 train_loss:3.5953 train_time:357837ms step_avg:358.55ms
step:1009/1750 train_loss:3.6972 train_time:358217ms step_avg:358.58ms
step:1010/1750 train_loss:3.5939 train_time:358587ms step_avg:358.59ms
step:1011/1750 train_loss:3.5644 train_time:358958ms step_avg:358.60ms
step:1012/1750 train_loss:3.4277 train_time:359328ms step_avg:358.61ms
step:1013/1750 train_loss:3.5677 train_time:359704ms step_avg:358.63ms
step:1014/1750 train_loss:3.6552 train_time:360081ms step_avg:358.65ms
step:1015/1750 train_loss:3.3623 train_time:360461ms step_avg:358.67ms
step:1016/1750 train_loss:3.4517 train_time:360832ms step_avg:358.68ms
step:1017/1750 train_loss:3.4395 train_time:361207ms step_avg:358.70ms
step:1018/1750 train_loss:3.4288 train_time:361586ms step_avg:358.72ms
step:1019/1750 train_loss:3.5545 train_time:361960ms step_avg:358.73ms
step:1020/1750 train_loss:3.4214 train_time:362333ms step_avg:358.75ms
step:1021/1750 train_loss:3.3865 train_time:362702ms step_avg:358.76ms
step:1022/1750 train_loss:3.5131 train_time:363077ms step_avg:358.77ms
step:1023/1750 train_loss:3.5428 train_time:363450ms step_avg:358.79ms
step:1024/1750 train_loss:3.5107 train_time:363824ms step_avg:358.80ms
step:1025/1750 train_loss:3.5143 train_time:364196ms step_avg:358.81ms
step:1026/1750 train_loss:3.6642 train_time:364565ms step_avg:358.82ms
step:1027/1750 train_loss:3.3592 train_time:364936ms step_avg:358.84ms
step:1028/1750 train_loss:3.4348 train_time:365313ms step_avg:358.85ms
step:1029/1750 train_loss:3.3591 train_time:365694ms step_avg:358.88ms
step:1030/1750 train_loss:3.5691 train_time:366068ms step_avg:358.89ms
step:1031/1750 train_loss:3.5553 train_time:366444ms step_avg:358.91ms
step:1032/1750 train_loss:3.7378 train_time:366824ms step_avg:358.93ms
step:1033/1750 train_loss:3.5315 train_time:367193ms step_avg:358.94ms
step:1034/1750 train_loss:3.4521 train_time:367564ms step_avg:358.95ms
step:1035/1750 train_loss:3.4833 train_time:367937ms step_avg:358.96ms
step:1036/1750 train_loss:3.5319 train_time:368309ms step_avg:358.98ms
step:1037/1750 train_loss:3.8280 train_time:368680ms step_avg:358.99ms
step:1038/1750 train_loss:3.6610 train_time:369054ms step_avg:359.00ms
step:1039/1750 train_loss:3.5534 train_time:369437ms step_avg:359.03ms
step:1040/1750 train_loss:3.4539 train_time:369814ms step_avg:359.04ms
step:1041/1750 train_loss:3.5255 train_time:370192ms step_avg:359.06ms
step:1042/1750 train_loss:3.5643 train_time:370562ms step_avg:359.07ms
step:1043/1750 train_loss:3.4806 train_time:370936ms step_avg:359.09ms
step:1044/1750 train_loss:3.4986 train_time:371313ms step_avg:359.10ms
step:1045/1750 train_loss:3.5631 train_time:371692ms step_avg:359.12ms
step:1046/1750 train_loss:3.4642 train_time:372067ms step_avg:359.14ms
step:1047/1750 train_loss:3.6837 train_time:372446ms step_avg:359.16ms
step:1048/1750 train_loss:3.5440 train_time:372824ms step_avg:359.18ms
step:1049/1750 train_loss:3.4449 train_time:373205ms step_avg:359.20ms
step:1050/1750 train_loss:3.4387 train_time:373591ms step_avg:359.22ms
step:1051/1750 train_loss:3.5456 train_time:373974ms step_avg:359.25ms
step:1052/1750 train_loss:3.3984 train_time:374356ms step_avg:359.27ms
step:1053/1750 train_loss:3.7357 train_time:374737ms step_avg:359.29ms
step:1054/1750 train_loss:3.5859 train_time:375117ms step_avg:359.31ms
step:1055/1750 train_loss:3.4248 train_time:375493ms step_avg:359.32ms
step:1056/1750 train_loss:3.5392 train_time:375869ms step_avg:359.34ms
step:1057/1750 train_loss:3.6259 train_time:376250ms step_avg:359.36ms
step:1058/1750 train_loss:3.3508 train_time:376630ms step_avg:359.38ms
step:1059/1750 train_loss:3.4136 train_time:377016ms step_avg:359.41ms
step:1060/1750 train_loss:3.4867 train_time:377396ms step_avg:359.42ms
step:1061/1750 train_loss:3.4673 train_time:377771ms step_avg:359.44ms
step:1062/1750 train_loss:3.4291 train_time:378145ms step_avg:359.45ms
step:1063/1750 train_loss:3.5138 train_time:378518ms step_avg:359.47ms
step:1064/1750 train_loss:3.4277 train_time:378890ms step_avg:359.48ms
step:1065/1750 train_loss:3.4026 train_time:379273ms step_avg:359.50ms
step:1066/1750 train_loss:3.4546 train_time:379655ms step_avg:359.52ms
step:1067/1750 train_loss:3.3261 train_time:380035ms step_avg:359.54ms
step:1068/1750 train_loss:3.4723 train_time:380415ms step_avg:359.56ms
step:1069/1750 train_loss:3.3517 train_time:380801ms step_avg:359.59ms
step:1070/1750 train_loss:3.6160 train_time:381178ms step_avg:359.60ms
step:1071/1750 train_loss:3.5612 train_time:381561ms step_avg:359.62ms
step:1072/1750 train_loss:3.4920 train_time:381935ms step_avg:359.64ms
step:1073/1750 train_loss:3.5724 train_time:382308ms step_avg:359.65ms
step:1074/1750 train_loss:3.4878 train_time:382687ms step_avg:359.67ms
step:1075/1750 train_loss:3.4455 train_time:383065ms step_avg:359.69ms
step:1076/1750 train_loss:3.8463 train_time:383438ms step_avg:359.70ms
step:1077/1750 train_loss:3.4883 train_time:383814ms step_avg:359.71ms
step:1078/1750 train_loss:3.1487 train_time:384211ms step_avg:359.75ms
step:1079/1750 train_loss:3.5840 train_time:384596ms step_avg:359.77ms
step:1080/1750 train_loss:3.4805 train_time:384977ms step_avg:359.79ms
step:1081/1750 train_loss:3.5561 train_time:385351ms step_avg:359.80ms
step:1082/1750 train_loss:3.6431 train_time:385727ms step_avg:359.82ms
step:1083/1750 train_loss:3.5590 train_time:386102ms step_avg:359.83ms
step:1084/1750 train_loss:3.5217 train_time:386482ms step_avg:359.85ms
step:1085/1750 train_loss:3.4808 train_time:386861ms step_avg:359.87ms
step:1086/1750 train_loss:3.6836 train_time:387243ms step_avg:359.89ms
step:1087/1750 train_loss:3.5699 train_time:387621ms step_avg:359.91ms
step:1088/1750 train_loss:3.4184 train_time:388006ms step_avg:359.93ms
step:1089/1750 train_loss:3.4327 train_time:388396ms step_avg:359.96ms
step:1090/1750 train_loss:3.5380 train_time:388783ms step_avg:359.98ms
step:1091/1750 train_loss:3.3380 train_time:389164ms step_avg:360.00ms
step:1092/1750 train_loss:3.5442 train_time:389547ms step_avg:360.03ms
step:1093/1750 train_loss:3.6661 train_time:389928ms step_avg:360.04ms
step:1094/1750 train_loss:3.4972 train_time:390304ms step_avg:360.06ms
step:1095/1750 train_loss:3.4683 train_time:390681ms step_avg:360.07ms
step:1096/1750 train_loss:3.4851 train_time:391066ms step_avg:360.10ms
step:1097/1750 train_loss:3.5365 train_time:391449ms step_avg:360.12ms
step:1098/1750 train_loss:3.6104 train_time:391828ms step_avg:360.14ms
step:1099/1750 train_loss:3.5804 train_time:392209ms step_avg:360.16ms
step:1100/1750 train_loss:3.4935 train_time:392598ms step_avg:360.18ms
step:1101/1750 train_loss:3.3431 train_time:392977ms step_avg:360.20ms
step:1102/1750 train_loss:3.3695 train_time:393363ms step_avg:360.22ms
step:1103/1750 train_loss:3.5035 train_time:393751ms step_avg:360.25ms
step:1104/1750 train_loss:3.3688 train_time:394126ms step_avg:360.26ms
step:1105/1750 train_loss:4.1120 train_time:394505ms step_avg:360.28ms
step:1106/1750 train_loss:3.2812 train_time:394880ms step_avg:360.29ms
step:1107/1750 train_loss:3.6239 train_time:395256ms step_avg:360.31ms
step:1108/1750 train_loss:3.3944 train_time:395629ms step_avg:360.32ms
step:1109/1750 train_loss:3.5571 train_time:396004ms step_avg:360.33ms
step:1110/1750 train_loss:3.4895 train_time:396381ms step_avg:360.35ms
step:1111/1750 train_loss:3.5406 train_time:396757ms step_avg:360.36ms
step:1112/1750 train_loss:3.6237 train_time:397144ms step_avg:360.38ms
step:1113/1750 train_loss:3.4968 train_time:397535ms step_avg:360.41ms
step:1114/1750 train_loss:3.4251 train_time:397914ms step_avg:360.43ms
step:1115/1750 train_loss:3.3086 train_time:398292ms step_avg:360.45ms
step:1116/1750 train_loss:3.4848 train_time:398666ms step_avg:360.46ms
step:1117/1750 train_loss:3.6524 train_time:399051ms step_avg:360.48ms
step:1118/1750 train_loss:3.6886 train_time:399432ms step_avg:360.50ms
step:1119/1750 train_loss:3.5387 train_time:399809ms step_avg:360.51ms
step:1120/1750 train_loss:3.5495 train_time:400188ms step_avg:360.53ms
step:1121/1750 train_loss:3.4472 train_time:400569ms step_avg:360.55ms
step:1122/1750 train_loss:3.5167 train_time:400944ms step_avg:360.56ms
step:1123/1750 train_loss:3.6449 train_time:401321ms step_avg:360.58ms
step:1124/1750 train_loss:3.4136 train_time:401699ms step_avg:360.59ms
step:1125/1750 train_loss:3.2810 train_time:402078ms step_avg:360.61ms
step:1125/1750 val_loss:3.4718 train_time:402178ms step_avg:360.70ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 280.78439 | frobenius_norm = 64730.79688 | spectral_norm = 11388.72656 | nuclear_norm = 1625714.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 175.74402 | spectral_norm = 32.85900 | nuclear_norm = 4038.85229
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 170.88864 | spectral_norm = 35.09113 | nuclear_norm = 3913.63550
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 373.95511 | spectral_norm = 24.65946 | nuclear_norm = 9167.58984
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 267.90683 | spectral_norm = 29.02208 | nuclear_norm = 6151.98535
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 384.37393 | spectral_norm = 33.41004 | nuclear_norm = 10205.22461
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 190.05235 | spectral_norm = 17.21272 | nuclear_norm = 5015.63379
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 178.90475 | spectral_norm = 19.15582 | nuclear_norm = 4128.07471
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 175.17900 | spectral_norm = 17.63297 | nuclear_norm = 4055.77197
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 369.80331 | spectral_norm = 33.98156 | nuclear_norm = 8438.51953
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 373.31360 | spectral_norm = 29.40589 | nuclear_norm = 8695.99609
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 381.79834 | spectral_norm = 29.70631 | nuclear_norm = 10154.21094
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 188.27226 | spectral_norm = 19.70132 | nuclear_norm = 4945.70703
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 167.42323 | spectral_norm = 16.51463 | nuclear_norm = 3691.47583
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 168.64238 | spectral_norm = 15.54147 | nuclear_norm = 3734.65918
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 393.39545 | spectral_norm = 36.87459 | nuclear_norm = 8968.29883
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 400.72070 | spectral_norm = 31.95882 | nuclear_norm = 9392.24219
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 387.48849 | spectral_norm = 33.80077 | nuclear_norm = 10306.63379
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 188.49533 | spectral_norm = 19.16377 | nuclear_norm = 4959.89404
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 173.95782 | spectral_norm = 18.23274 | nuclear_norm = 4003.91162
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 172.77219 | spectral_norm = 17.57768 | nuclear_norm = 3988.26074
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 408.15015 | spectral_norm = 34.99002 | nuclear_norm = 9330.86230
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 411.95715 | spectral_norm = 32.91547 | nuclear_norm = 9625.11133
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 393.79370 | spectral_norm = 35.60771 | nuclear_norm = 10446.32617
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 192.76799 | spectral_norm = 19.09422 | nuclear_norm = 5062.03174
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 173.73726 | spectral_norm = 18.05756 | nuclear_norm = 3988.20630
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 173.17546 | spectral_norm = 17.35765 | nuclear_norm = 3999.77979
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 423.19528 | spectral_norm = 36.05697 | nuclear_norm = 9686.77539
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 417.54224 | spectral_norm = 31.06255 | nuclear_norm = 9815.37305
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 391.84399 | spectral_norm = 31.98424 | nuclear_norm = 10408.99707
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 192.99533 | spectral_norm = 18.46713 | nuclear_norm = 5076.67188
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 170.02007 | spectral_norm = 16.89563 | nuclear_norm = 3855.60156
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 169.51976 | spectral_norm = 16.29610 | nuclear_norm = 3861.32886
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 428.44556 | spectral_norm = 37.35553 | nuclear_norm = 9758.64648
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 412.85336 | spectral_norm = 31.11051 | nuclear_norm = 9757.59668
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 397.20554 | spectral_norm = 30.05451 | nuclear_norm = 10595.38965
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 190.96634 | spectral_norm = 17.37654 | nuclear_norm = 5026.52246
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 167.53783 | spectral_norm = 18.42229 | nuclear_norm = 3804.82153
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 163.52875 | spectral_norm = 17.62310 | nuclear_norm = 3748.86060
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 412.27267 | spectral_norm = 34.67730 | nuclear_norm = 9533.55469
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 404.85242 | spectral_norm = 29.88316 | nuclear_norm = 9499.24219
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 394.14047 | spectral_norm = 27.78675 | nuclear_norm = 10512.51270
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 193.97581 | spectral_norm = 18.71600 | nuclear_norm = 5107.70996
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 174.38631 | spectral_norm = 16.97317 | nuclear_norm = 3972.18481
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 172.86151 | spectral_norm = 16.93981 | nuclear_norm = 3954.05859
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 441.58295 | spectral_norm = 39.26315 | nuclear_norm = 10014.57031
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 418.59802 | spectral_norm = 32.63810 | nuclear_norm = 9835.64160
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 387.55301 | spectral_norm = 31.85313 | nuclear_norm = 10316.50781
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 195.03323 | spectral_norm = 19.02238 | nuclear_norm = 5142.42822
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 173.00340 | spectral_norm = 17.68083 | nuclear_norm = 3903.56055
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 172.13460 | spectral_norm = 15.97683 | nuclear_norm = 3858.48486
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 434.10544 | spectral_norm = 37.64344 | nuclear_norm = 9864.70312
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 423.98972 | spectral_norm = 30.48983 | nuclear_norm = 9950.98828
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 391.16699 | spectral_norm = 33.71477 | nuclear_norm = 10387.21387
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 197.59822 | spectral_norm = 19.88610 | nuclear_norm = 5223.37451
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 178.15021 | spectral_norm = 17.77131 | nuclear_norm = 4017.60034
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 177.30934 | spectral_norm = 17.47374 | nuclear_norm = 3972.51636
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 447.17316 | spectral_norm = 43.85991 | nuclear_norm = 10267.24902
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 428.73651 | spectral_norm = 30.50626 | nuclear_norm = 10109.92188
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 384.01297 | spectral_norm = 32.07515 | nuclear_norm = 10209.06445
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 198.44498 | spectral_norm = 19.91238 | nuclear_norm = 5269.04639
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 178.18982 | spectral_norm = 18.15074 | nuclear_norm = 4001.15479
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 176.53239 | spectral_norm = 18.25639 | nuclear_norm = 3930.14111
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 419.89713 | spectral_norm = 39.66329 | nuclear_norm = 9648.92188
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 416.78268 | spectral_norm = 29.56096 | nuclear_norm = 9787.23340
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 401.40213 | spectral_norm = 30.28159 | nuclear_norm = 10696.29395
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 193.48380 | spectral_norm = 22.47769 | nuclear_norm = 5125.27734
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 175.88467 | spectral_norm = 22.29783 | nuclear_norm = 3900.76270
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 171.26971 | spectral_norm = 20.44765 | nuclear_norm = 3777.84277
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 374.36124 | spectral_norm = 43.93930 | nuclear_norm = 8494.40234
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 418.60931 | spectral_norm = 30.27589 | nuclear_norm = 9693.31250
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 420.80380 | spectral_norm = 33.40472 | nuclear_norm = 11190.34375
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 198.47810 | spectral_norm = 24.67823 | nuclear_norm = 5211.52637
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1245.50024 | spectral_norm = 188.44955 | nuclear_norm = 32713.09180
===========================================
step:1126/1750 train_loss:3.5379 train_time:402448ms step_avg:360.62ms
step:1127/1750 train_loss:3.7426 train_time:402814ms step_avg:360.62ms
step:1128/1750 train_loss:3.2913 train_time:403188ms step_avg:360.63ms
step:1129/1750 train_loss:3.6214 train_time:403566ms step_avg:360.65ms
step:1130/1750 train_loss:3.4450 train_time:403944ms step_avg:360.66ms
step:1131/1750 train_loss:3.4579 train_time:404330ms step_avg:360.69ms
step:1132/1750 train_loss:3.4268 train_time:404701ms step_avg:360.70ms
step:1133/1750 train_loss:3.5556 train_time:405134ms step_avg:360.76ms
step:1134/1750 train_loss:3.5152 train_time:405574ms step_avg:360.83ms
step:1135/1750 train_loss:3.5774 train_time:405950ms step_avg:360.84ms
step:1136/1750 train_loss:3.6190 train_time:406325ms step_avg:360.86ms
step:1137/1750 train_loss:3.5157 train_time:406700ms step_avg:360.87ms
step:1138/1750 train_loss:3.4109 train_time:407078ms step_avg:360.88ms
step:1139/1750 train_loss:3.7144 train_time:407590ms step_avg:361.02ms
step:1140/1750 train_loss:3.5269 train_time:407967ms step_avg:361.03ms
step:1141/1750 train_loss:3.6570 train_time:408350ms step_avg:361.05ms
step:1142/1750 train_loss:3.5281 train_time:408730ms step_avg:361.07ms
step:1143/1750 train_loss:3.4276 train_time:409113ms step_avg:361.09ms
step:1144/1750 train_loss:3.5039 train_time:409489ms step_avg:361.10ms
step:1145/1750 train_loss:3.6565 train_time:409861ms step_avg:361.11ms
step:1146/1750 train_loss:3.6135 train_time:410244ms step_avg:361.13ms
step:1147/1750 train_loss:3.5396 train_time:410622ms step_avg:361.14ms
step:1148/1750 train_loss:3.5645 train_time:410994ms step_avg:361.15ms
step:1149/1750 train_loss:3.3935 train_time:411373ms step_avg:361.17ms
step:1150/1750 train_loss:3.4304 train_time:411746ms step_avg:361.18ms
step:1151/1750 train_loss:3.3838 train_time:412124ms step_avg:361.20ms
step:1152/1750 train_loss:3.4644 train_time:412507ms step_avg:361.21ms
step:1153/1750 train_loss:3.4919 train_time:412888ms step_avg:361.23ms
step:1154/1750 train_loss:3.5790 train_time:413261ms step_avg:361.24ms
step:1155/1750 train_loss:3.3914 train_time:413643ms step_avg:361.26ms
step:1156/1750 train_loss:3.6017 train_time:414031ms step_avg:361.28ms
step:1157/1750 train_loss:3.5599 train_time:414411ms step_avg:361.30ms
step:1158/1750 train_loss:3.3267 train_time:414787ms step_avg:361.31ms
step:1159/1750 train_loss:3.4053 train_time:415163ms step_avg:361.33ms
step:1160/1750 train_loss:3.3973 train_time:415532ms step_avg:361.33ms
step:1161/1750 train_loss:3.1505 train_time:415911ms step_avg:361.35ms
step:1162/1750 train_loss:3.4869 train_time:416287ms step_avg:361.36ms
step:1163/1750 train_loss:3.4550 train_time:416664ms step_avg:361.37ms
step:1164/1750 train_loss:3.3500 train_time:417039ms step_avg:361.39ms
step:1165/1750 train_loss:3.3155 train_time:417413ms step_avg:361.40ms
step:1166/1750 train_loss:3.4434 train_time:417789ms step_avg:361.41ms
step:1167/1750 train_loss:3.4640 train_time:418162ms step_avg:361.42ms
step:1168/1750 train_loss:3.7885 train_time:418539ms step_avg:361.43ms
step:1169/1750 train_loss:3.4401 train_time:418922ms step_avg:361.45ms
step:1170/1750 train_loss:3.4478 train_time:419304ms step_avg:361.47ms
step:1171/1750 train_loss:3.3750 train_time:419685ms step_avg:361.49ms
step:1172/1750 train_loss:3.4883 train_time:420065ms step_avg:361.50ms
step:1173/1750 train_loss:3.6063 train_time:420456ms step_avg:361.53ms
step:1174/1750 train_loss:3.4486 train_time:420855ms step_avg:361.56ms
step:1175/1750 train_loss:3.4372 train_time:421241ms step_avg:361.58ms
step:1176/1750 train_loss:3.4848 train_time:421634ms step_avg:361.61ms
step:1177/1750 train_loss:3.5124 train_time:422028ms step_avg:361.64ms
step:1178/1750 train_loss:3.5608 train_time:422407ms step_avg:361.65ms
step:1179/1750 train_loss:3.4728 train_time:422790ms step_avg:361.67ms
step:1180/1750 train_loss:3.4165 train_time:423192ms step_avg:361.70ms
step:1181/1750 train_loss:3.3973 train_time:423574ms step_avg:361.72ms
step:1182/1750 train_loss:3.4686 train_time:423956ms step_avg:361.74ms
step:1183/1750 train_loss:3.3906 train_time:424337ms step_avg:361.75ms
step:1184/1750 train_loss:3.5710 train_time:424721ms step_avg:361.77ms
step:1185/1750 train_loss:3.6077 train_time:425109ms step_avg:361.80ms
step:1186/1750 train_loss:3.4232 train_time:425496ms step_avg:361.82ms
step:1187/1750 train_loss:3.4734 train_time:425896ms step_avg:361.85ms
step:1188/1750 train_loss:3.5077 train_time:426275ms step_avg:361.86ms
step:1189/1750 train_loss:3.3333 train_time:426661ms step_avg:361.88ms
step:1190/1750 train_loss:3.5138 train_time:427048ms step_avg:361.91ms
step:1191/1750 train_loss:3.6451 train_time:427438ms step_avg:361.93ms
step:1192/1750 train_loss:3.4573 train_time:427818ms step_avg:361.94ms
step:1193/1750 train_loss:3.3372 train_time:428199ms step_avg:361.96ms
step:1194/1750 train_loss:3.6203 train_time:428581ms step_avg:361.98ms
step:1195/1750 train_loss:3.4376 train_time:428974ms step_avg:362.00ms
step:1196/1750 train_loss:3.4512 train_time:429381ms step_avg:362.04ms
step:1197/1750 train_loss:3.3555 train_time:429770ms step_avg:362.06ms
step:1198/1750 train_loss:3.3649 train_time:430168ms step_avg:362.09ms
step:1199/1750 train_loss:3.3999 train_time:430554ms step_avg:362.11ms
step:1200/1750 train_loss:3.5018 train_time:430939ms step_avg:362.13ms
step:1201/1750 train_loss:3.5460 train_time:431319ms step_avg:362.15ms
step:1202/1750 train_loss:3.6979 train_time:431727ms step_avg:362.19ms
step:1203/1750 train_loss:3.4719 train_time:432117ms step_avg:362.21ms
step:1204/1750 train_loss:3.3796 train_time:432504ms step_avg:362.23ms
step:1205/1750 train_loss:3.4966 train_time:432886ms step_avg:362.25ms
step:1206/1750 train_loss:3.5317 train_time:433265ms step_avg:362.26ms
step:1207/1750 train_loss:3.5896 train_time:433643ms step_avg:362.28ms
step:1208/1750 train_loss:3.4620 train_time:434018ms step_avg:362.29ms
step:1209/1750 train_loss:3.3005 train_time:434404ms step_avg:362.31ms
step:1210/1750 train_loss:3.3740 train_time:434794ms step_avg:362.33ms
step:1211/1750 train_loss:3.4627 train_time:435174ms step_avg:362.34ms
step:1212/1750 train_loss:3.4550 train_time:435552ms step_avg:362.36ms
step:1213/1750 train_loss:3.4734 train_time:435938ms step_avg:362.38ms
step:1214/1750 train_loss:3.3301 train_time:436328ms step_avg:362.40ms
step:1215/1750 train_loss:3.4529 train_time:436707ms step_avg:362.41ms
step:1216/1750 train_loss:3.3887 train_time:437088ms step_avg:362.43ms
step:1217/1750 train_loss:3.3834 train_time:437473ms step_avg:362.45ms
step:1218/1750 train_loss:3.4763 train_time:437859ms step_avg:362.47ms
step:1219/1750 train_loss:3.3318 train_time:438252ms step_avg:362.49ms
step:1220/1750 train_loss:3.5352 train_time:438632ms step_avg:362.51ms
step:1221/1750 train_loss:3.5730 train_time:439011ms step_avg:362.52ms
step:1222/1750 train_loss:3.5076 train_time:439390ms step_avg:362.53ms
step:1223/1750 train_loss:3.3566 train_time:439773ms step_avg:362.55ms
step:1224/1750 train_loss:3.3213 train_time:440163ms step_avg:362.57ms
step:1225/1750 train_loss:3.4380 train_time:440547ms step_avg:362.59ms
step:1226/1750 train_loss:3.3830 train_time:440935ms step_avg:362.61ms
step:1227/1750 train_loss:3.3365 train_time:441323ms step_avg:362.63ms
step:1228/1750 train_loss:3.5151 train_time:441701ms step_avg:362.64ms
step:1229/1750 train_loss:3.4292 train_time:442086ms step_avg:362.66ms
step:1230/1750 train_loss:3.4663 train_time:442480ms step_avg:362.69ms
step:1231/1750 train_loss:3.6421 train_time:442870ms step_avg:362.71ms
step:1232/1750 train_loss:3.5526 train_time:443256ms step_avg:362.73ms
step:1233/1750 train_loss:3.4893 train_time:443632ms step_avg:362.74ms
step:1234/1750 train_loss:3.6548 train_time:444013ms step_avg:362.76ms
step:1235/1750 train_loss:3.3891 train_time:444400ms step_avg:362.78ms
step:1236/1750 train_loss:3.3573 train_time:444778ms step_avg:362.79ms
step:1237/1750 train_loss:3.3374 train_time:445160ms step_avg:362.80ms
step:1238/1750 train_loss:3.3554 train_time:445553ms step_avg:362.83ms
step:1239/1750 train_loss:3.3886 train_time:445934ms step_avg:362.84ms
step:1240/1750 train_loss:3.4473 train_time:446321ms step_avg:362.86ms
step:1241/1750 train_loss:3.4949 train_time:446708ms step_avg:362.88ms
step:1242/1750 train_loss:3.3646 train_time:447085ms step_avg:362.89ms
step:1243/1750 train_loss:3.4757 train_time:447469ms step_avg:362.91ms
step:1244/1750 train_loss:3.4784 train_time:447845ms step_avg:362.92ms
step:1245/1750 train_loss:3.4833 train_time:448224ms step_avg:362.93ms
step:1246/1750 train_loss:3.3046 train_time:448608ms step_avg:362.95ms
step:1247/1750 train_loss:3.4393 train_time:448987ms step_avg:362.96ms
step:1248/1750 train_loss:3.5007 train_time:449363ms step_avg:362.97ms
step:1249/1750 train_loss:3.4820 train_time:449741ms step_avg:362.99ms
step:1250/1750 train_loss:3.3664 train_time:450120ms step_avg:363.00ms
step:1250/1750 val_loss:3.4193 train_time:450224ms step_avg:363.08ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 289.19446 | frobenius_norm = 66711.14062 | spectral_norm = 11741.10742 | nuclear_norm = 1677424.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 183.93454 | spectral_norm = 35.60705 | nuclear_norm = 4217.74756
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 179.18524 | spectral_norm = 37.78640 | nuclear_norm = 4097.13770
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 391.94101 | spectral_norm = 25.74553 | nuclear_norm = 9632.08008
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 274.36896 | spectral_norm = 30.54465 | nuclear_norm = 6281.42822
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 406.20721 | spectral_norm = 35.65200 | nuclear_norm = 10781.58691
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 199.77708 | spectral_norm = 18.32771 | nuclear_norm = 5270.17920
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 188.13223 | spectral_norm = 20.45502 | nuclear_norm = 4334.71973
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 184.58920 | spectral_norm = 18.67384 | nuclear_norm = 4270.13916
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 387.33255 | spectral_norm = 36.09686 | nuclear_norm = 8832.10254
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 391.33630 | spectral_norm = 31.03849 | nuclear_norm = 9116.43262
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 400.99319 | spectral_norm = 31.67735 | nuclear_norm = 10665.80469
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 197.57129 | spectral_norm = 20.95908 | nuclear_norm = 5188.26855
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 175.68141 | spectral_norm = 17.42597 | nuclear_norm = 3861.82031
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 176.98788 | spectral_norm = 16.42999 | nuclear_norm = 3905.77344
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 413.48288 | spectral_norm = 38.83954 | nuclear_norm = 9424.65137
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 420.48022 | spectral_norm = 33.80566 | nuclear_norm = 9856.69531
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 406.47382 | spectral_norm = 36.51897 | nuclear_norm = 10811.16797
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 198.10669 | spectral_norm = 20.37575 | nuclear_norm = 5213.01172
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 182.83336 | spectral_norm = 19.43742 | nuclear_norm = 4201.63037
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 181.68719 | spectral_norm = 18.50224 | nuclear_norm = 4190.41699
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 429.88547 | spectral_norm = 36.88666 | nuclear_norm = 9831.52930
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 433.56369 | spectral_norm = 34.50534 | nuclear_norm = 10132.67090
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 412.71060 | spectral_norm = 38.14988 | nuclear_norm = 10947.86914
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 202.58447 | spectral_norm = 20.28346 | nuclear_norm = 5320.02051
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 182.73306 | spectral_norm = 19.31913 | nuclear_norm = 4188.16602
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 181.98199 | spectral_norm = 18.40320 | nuclear_norm = 4198.58838
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 445.60541 | spectral_norm = 38.38165 | nuclear_norm = 10207.51367
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 439.53247 | spectral_norm = 32.57215 | nuclear_norm = 10337.39453
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 410.67151 | spectral_norm = 33.90176 | nuclear_norm = 10907.42578
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 202.72864 | spectral_norm = 19.60324 | nuclear_norm = 5333.37939
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 178.58467 | spectral_norm = 17.84859 | nuclear_norm = 4039.48828
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 178.01053 | spectral_norm = 17.19194 | nuclear_norm = 4047.37891
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 451.44427 | spectral_norm = 39.43811 | nuclear_norm = 10291.70312
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 434.70978 | spectral_norm = 32.65057 | nuclear_norm = 10284.07617
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 416.71564 | spectral_norm = 31.94948 | nuclear_norm = 11118.23828
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 200.60500 | spectral_norm = 18.47837 | nuclear_norm = 5282.75098
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 175.94740 | spectral_norm = 19.58622 | nuclear_norm = 3987.76343
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 171.68130 | spectral_norm = 18.63421 | nuclear_norm = 3930.37500
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 434.02191 | spectral_norm = 36.69670 | nuclear_norm = 10051.70605
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 425.73837 | spectral_norm = 31.38421 | nuclear_norm = 9997.82520
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 413.83163 | spectral_norm = 29.43756 | nuclear_norm = 11040.26562
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 203.87355 | spectral_norm = 20.08873 | nuclear_norm = 5369.12793
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 183.04797 | spectral_norm = 18.03473 | nuclear_norm = 4159.72754
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 181.45361 | spectral_norm = 17.75711 | nuclear_norm = 4143.14893
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 464.18539 | spectral_norm = 41.48923 | nuclear_norm = 10524.82324
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 439.74792 | spectral_norm = 34.23192 | nuclear_norm = 10334.38086
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 406.99039 | spectral_norm = 33.48703 | nuclear_norm = 10833.82422
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 205.01564 | spectral_norm = 20.39421 | nuclear_norm = 5404.31445
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 181.65762 | spectral_norm = 18.85798 | nuclear_norm = 4087.34937
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 180.66264 | spectral_norm = 16.96861 | nuclear_norm = 4038.58228
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 455.01855 | spectral_norm = 39.76282 | nuclear_norm = 10332.08594
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 442.99719 | spectral_norm = 31.95044 | nuclear_norm = 10386.45312
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 411.72177 | spectral_norm = 35.79393 | nuclear_norm = 10928.95312
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 207.75670 | spectral_norm = 21.30393 | nuclear_norm = 5489.92236
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 187.13191 | spectral_norm = 18.95621 | nuclear_norm = 4204.78809
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 186.39583 | spectral_norm = 18.60234 | nuclear_norm = 4159.60059
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 469.95587 | spectral_norm = 47.40837 | nuclear_norm = 10778.33496
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 449.45618 | spectral_norm = 32.01196 | nuclear_norm = 10593.83594
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 403.42630 | spectral_norm = 34.16902 | nuclear_norm = 10721.20117
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 208.81447 | spectral_norm = 21.20677 | nuclear_norm = 5544.48193
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 187.14180 | spectral_norm = 19.28059 | nuclear_norm = 4188.53857
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 185.46075 | spectral_norm = 19.34387 | nuclear_norm = 4114.01514
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 442.21725 | spectral_norm = 42.33616 | nuclear_norm = 10153.18555
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 436.92163 | spectral_norm = 31.03755 | nuclear_norm = 10258.95703
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 422.09692 | spectral_norm = 32.07275 | nuclear_norm = 11245.78320
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 203.74820 | spectral_norm = 23.91983 | nuclear_norm = 5397.23535
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 184.57628 | spectral_norm = 23.85501 | nuclear_norm = 4078.21582
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 179.56291 | spectral_norm = 21.86583 | nuclear_norm = 3942.66748
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 395.62717 | spectral_norm = 47.57634 | nuclear_norm = 8969.37305
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 441.75864 | spectral_norm = 32.07977 | nuclear_norm = 10232.29590
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 441.60489 | spectral_norm = 35.08057 | nuclear_norm = 11740.46289
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 208.42155 | spectral_norm = 26.43876 | nuclear_norm = 5468.54443
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1295.44580 | spectral_norm = 186.01717 | nuclear_norm = 34111.19531
===========================================
step:1251/1750 train_loss:3.5611 train_time:450506ms step_avg:363.02ms
step:1252/1750 train_loss:3.4339 train_time:450878ms step_avg:363.03ms
step:1253/1750 train_loss:3.3680 train_time:451252ms step_avg:363.03ms
step:1254/1750 train_loss:3.4779 train_time:451632ms step_avg:363.05ms
step:1255/1750 train_loss:3.5872 train_time:452028ms step_avg:363.07ms
step:1256/1750 train_loss:3.3723 train_time:452412ms step_avg:363.09ms
step:1257/1750 train_loss:3.4313 train_time:452790ms step_avg:363.10ms
step:1258/1750 train_loss:3.4107 train_time:453178ms step_avg:363.12ms
step:1259/1750 train_loss:3.3992 train_time:453556ms step_avg:363.14ms
step:1260/1750 train_loss:3.2710 train_time:453930ms step_avg:363.14ms
step:1261/1750 train_loss:3.3641 train_time:454312ms step_avg:363.16ms
step:1262/1750 train_loss:3.3906 train_time:454702ms step_avg:363.18ms
step:1263/1750 train_loss:3.2938 train_time:455088ms step_avg:363.20ms
step:1264/1750 train_loss:3.5072 train_time:455461ms step_avg:363.21ms
step:1265/1750 train_loss:3.4936 train_time:455836ms step_avg:363.22ms
step:1266/1750 train_loss:3.5058 train_time:456215ms step_avg:363.23ms
step:1267/1750 train_loss:3.4313 train_time:456592ms step_avg:363.24ms
step:1268/1750 train_loss:3.4675 train_time:456970ms step_avg:363.25ms
step:1269/1750 train_loss:3.3199 train_time:457358ms step_avg:363.27ms
step:1270/1750 train_loss:3.1626 train_time:457736ms step_avg:363.28ms
step:1271/1750 train_loss:3.4645 train_time:458116ms step_avg:363.30ms
step:1272/1750 train_loss:3.4151 train_time:458493ms step_avg:363.31ms
step:1273/1750 train_loss:3.4542 train_time:458879ms step_avg:363.32ms
step:1274/1750 train_loss:3.4179 train_time:459263ms step_avg:363.34ms
step:1275/1750 train_loss:3.5029 train_time:459638ms step_avg:363.35ms
step:1276/1750 train_loss:3.5387 train_time:460009ms step_avg:363.36ms
step:1277/1750 train_loss:3.4702 train_time:460390ms step_avg:363.37ms
step:1278/1750 train_loss:3.4692 train_time:460763ms step_avg:363.38ms
step:1279/1750 train_loss:3.3242 train_time:461145ms step_avg:363.39ms
step:1280/1750 train_loss:3.4341 train_time:461534ms step_avg:363.41ms
step:1281/1750 train_loss:3.4848 train_time:461911ms step_avg:363.42ms
step:1282/1750 train_loss:3.5317 train_time:462284ms step_avg:363.43ms
step:1283/1750 train_loss:3.3998 train_time:462668ms step_avg:363.45ms
step:1284/1750 train_loss:3.4344 train_time:463049ms step_avg:363.46ms
step:1285/1750 train_loss:3.4231 train_time:463428ms step_avg:363.47ms
step:1286/1750 train_loss:3.3968 train_time:463807ms step_avg:363.49ms
step:1287/1750 train_loss:3.5558 train_time:464187ms step_avg:363.50ms
step:1288/1750 train_loss:3.3635 train_time:464571ms step_avg:363.51ms
step:1289/1750 train_loss:3.4481 train_time:464963ms step_avg:363.54ms
step:1290/1750 train_loss:3.5212 train_time:465355ms step_avg:363.56ms
step:1291/1750 train_loss:3.4403 train_time:465739ms step_avg:363.57ms
step:1292/1750 train_loss:3.5376 train_time:466122ms step_avg:363.59ms
step:1293/1750 train_loss:3.5829 train_time:466507ms step_avg:363.61ms
step:1294/1750 train_loss:3.5379 train_time:466889ms step_avg:363.62ms
step:1295/1750 train_loss:3.3472 train_time:467270ms step_avg:363.63ms
step:1296/1750 train_loss:3.4327 train_time:467652ms step_avg:363.65ms
step:1297/1750 train_loss:3.3415 train_time:468034ms step_avg:363.66ms
step:1298/1750 train_loss:3.3386 train_time:468419ms step_avg:363.68ms
step:1299/1750 train_loss:3.4529 train_time:468800ms step_avg:363.69ms
step:1300/1750 train_loss:3.4704 train_time:469185ms step_avg:363.71ms
step:1301/1750 train_loss:3.4684 train_time:469566ms step_avg:363.72ms
step:1302/1750 train_loss:3.6364 train_time:469960ms step_avg:363.75ms
step:1303/1750 train_loss:3.3658 train_time:470354ms step_avg:363.77ms
step:1304/1750 train_loss:3.5808 train_time:470744ms step_avg:363.79ms
step:1305/1750 train_loss:3.3342 train_time:471127ms step_avg:363.80ms
step:1306/1750 train_loss:3.5140 train_time:471520ms step_avg:363.83ms
step:1307/1750 train_loss:3.5225 train_time:471897ms step_avg:363.84ms
step:1308/1750 train_loss:3.3553 train_time:472280ms step_avg:363.85ms
step:1309/1750 train_loss:3.3720 train_time:472670ms step_avg:363.87ms
step:1310/1750 train_loss:3.3656 train_time:473054ms step_avg:363.89ms
step:1311/1750 train_loss:3.3595 train_time:473439ms step_avg:363.90ms
step:1312/1750 train_loss:3.4462 train_time:473830ms step_avg:363.92ms
step:1313/1750 train_loss:3.4091 train_time:474210ms step_avg:363.94ms
step:1314/1750 train_loss:3.1028 train_time:474602ms step_avg:363.96ms
step:1315/1750 train_loss:3.3423 train_time:474984ms step_avg:363.97ms
step:1316/1750 train_loss:3.4567 train_time:475361ms step_avg:363.98ms
step:1317/1750 train_loss:3.4798 train_time:475741ms step_avg:363.99ms
step:1318/1750 train_loss:3.3556 train_time:476138ms step_avg:364.02ms
step:1319/1750 train_loss:3.4903 train_time:476531ms step_avg:364.04ms
step:1320/1750 train_loss:3.5192 train_time:476926ms step_avg:364.07ms
step:1321/1750 train_loss:3.4206 train_time:477314ms step_avg:364.08ms
step:1322/1750 train_loss:3.3824 train_time:477746ms step_avg:364.14ms
step:1323/1750 train_loss:3.3921 train_time:478200ms step_avg:364.20ms
step:1324/1750 train_loss:3.4929 train_time:478590ms step_avg:364.22ms
step:1325/1750 train_loss:3.5548 train_time:478989ms step_avg:364.25ms
step:1326/1750 train_loss:3.2843 train_time:479380ms step_avg:364.27ms
step:1327/1750 train_loss:3.2275 train_time:479759ms step_avg:364.28ms
step:1328/1750 train_loss:3.5521 train_time:480152ms step_avg:364.30ms
step:1329/1750 train_loss:3.3548 train_time:480708ms step_avg:364.45ms
step:1330/1750 train_loss:3.4912 train_time:481103ms step_avg:364.47ms
step:1331/1750 train_loss:3.3992 train_time:481482ms step_avg:364.48ms
step:1332/1750 train_loss:3.8042 train_time:481871ms step_avg:364.50ms
step:1333/1750 train_loss:3.5319 train_time:482260ms step_avg:364.52ms
step:1334/1750 train_loss:3.4307 train_time:482645ms step_avg:364.54ms
step:1335/1750 train_loss:3.3646 train_time:483029ms step_avg:364.55ms
step:1336/1750 train_loss:3.3555 train_time:483425ms step_avg:364.57ms
step:1337/1750 train_loss:3.6136 train_time:483812ms step_avg:364.59ms
step:1338/1750 train_loss:3.5824 train_time:484200ms step_avg:364.61ms
step:1339/1750 train_loss:3.4019 train_time:484593ms step_avg:364.63ms
step:1340/1750 train_loss:3.3431 train_time:484982ms step_avg:364.65ms
step:1341/1750 train_loss:3.6623 train_time:485365ms step_avg:364.66ms
step:1342/1750 train_loss:3.4154 train_time:485752ms step_avg:364.68ms
step:1343/1750 train_loss:3.4253 train_time:486133ms step_avg:364.69ms
step:1344/1750 train_loss:3.4826 train_time:486523ms step_avg:364.71ms
step:1345/1750 train_loss:3.4431 train_time:486918ms step_avg:364.73ms
step:1346/1750 train_loss:3.3639 train_time:487301ms step_avg:364.75ms
step:1347/1750 train_loss:3.3321 train_time:487687ms step_avg:364.76ms
step:1348/1750 train_loss:3.4054 train_time:488072ms step_avg:364.78ms
step:1349/1750 train_loss:3.3340 train_time:488459ms step_avg:364.79ms
step:1350/1750 train_loss:3.4537 train_time:488850ms step_avg:364.81ms
step:1351/1750 train_loss:3.3038 train_time:489231ms step_avg:364.83ms
step:1352/1750 train_loss:3.3618 train_time:489616ms step_avg:364.84ms
step:1353/1750 train_loss:3.4743 train_time:490009ms step_avg:364.86ms
step:1354/1750 train_loss:3.3149 train_time:490395ms step_avg:364.88ms
step:1355/1750 train_loss:3.2523 train_time:490779ms step_avg:364.89ms
step:1356/1750 train_loss:3.5770 train_time:491169ms step_avg:364.91ms
step:1357/1750 train_loss:3.4847 train_time:491559ms step_avg:364.93ms
step:1358/1750 train_loss:3.2420 train_time:491946ms step_avg:364.95ms
step:1359/1750 train_loss:3.5019 train_time:492335ms step_avg:364.96ms
step:1360/1750 train_loss:3.4154 train_time:492723ms step_avg:364.98ms
step:1361/1750 train_loss:3.1983 train_time:493114ms step_avg:365.00ms
step:1362/1750 train_loss:3.4548 train_time:493502ms step_avg:365.02ms
step:1363/1750 train_loss:3.3368 train_time:493896ms step_avg:365.04ms
step:1364/1750 train_loss:3.3694 train_time:494276ms step_avg:365.05ms
step:1365/1750 train_loss:3.3763 train_time:494659ms step_avg:365.06ms
step:1366/1750 train_loss:3.4817 train_time:495046ms step_avg:365.08ms
step:1367/1750 train_loss:3.4514 train_time:495429ms step_avg:365.09ms
step:1368/1750 train_loss:3.4079 train_time:495816ms step_avg:365.11ms
step:1369/1750 train_loss:3.3195 train_time:496215ms step_avg:365.13ms
step:1370/1750 train_loss:3.6682 train_time:496601ms step_avg:365.15ms
step:1371/1750 train_loss:3.3795 train_time:496991ms step_avg:365.17ms
step:1372/1750 train_loss:3.4221 train_time:497380ms step_avg:365.18ms
step:1373/1750 train_loss:3.4280 train_time:497762ms step_avg:365.20ms
step:1374/1750 train_loss:3.2182 train_time:498149ms step_avg:365.21ms
step:1375/1750 train_loss:3.6038 train_time:498532ms step_avg:365.22ms
step:1375/1750 val_loss:3.3729 train_time:498632ms step_avg:365.30ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 293.81549 | frobenius_norm = 67804.21094 | spectral_norm = 11946.12109 | nuclear_norm = 1706481.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 188.60056 | spectral_norm = 37.60278 | nuclear_norm = 4316.98828
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 184.09373 | spectral_norm = 39.58211 | nuclear_norm = 4203.20361
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 402.95969 | spectral_norm = 26.38047 | nuclear_norm = 9923.68652
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 277.43762 | spectral_norm = 31.52588 | nuclear_norm = 6336.76660
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 419.61050 | spectral_norm = 37.15147 | nuclear_norm = 11134.28320
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 205.74387 | spectral_norm = 19.00090 | nuclear_norm = 5426.77148
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 193.82285 | spectral_norm = 21.33775 | nuclear_norm = 4461.92676
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 190.06821 | spectral_norm = 19.37411 | nuclear_norm = 4393.94336
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 398.66666 | spectral_norm = 37.20781 | nuclear_norm = 9090.73047
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 402.60010 | spectral_norm = 31.86110 | nuclear_norm = 9381.62500
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 412.78912 | spectral_norm = 32.82186 | nuclear_norm = 10980.65723
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 203.32649 | spectral_norm = 21.74916 | nuclear_norm = 5338.64307
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 180.55475 | spectral_norm = 18.04339 | nuclear_norm = 3959.58496
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 181.95482 | spectral_norm = 17.04750 | nuclear_norm = 4002.89209
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 426.17352 | spectral_norm = 40.14762 | nuclear_norm = 9719.10254
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 433.01001 | spectral_norm = 34.82467 | nuclear_norm = 10154.67969
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 418.17615 | spectral_norm = 38.12557 | nuclear_norm = 11122.88770
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 204.08076 | spectral_norm = 21.11508 | nuclear_norm = 5371.78516
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 188.24892 | spectral_norm = 20.21531 | nuclear_norm = 4320.45361
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 186.98396 | spectral_norm = 19.13476 | nuclear_norm = 4309.84570
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 443.96869 | spectral_norm = 38.26640 | nuclear_norm = 10163.41895
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 447.22522 | spectral_norm = 35.75349 | nuclear_norm = 10455.92578
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 424.26584 | spectral_norm = 39.72028 | nuclear_norm = 11254.69141
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 208.58266 | spectral_norm = 20.97880 | nuclear_norm = 5478.06152
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 188.15421 | spectral_norm = 19.99955 | nuclear_norm = 4307.32422
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 187.34422 | spectral_norm = 18.98572 | nuclear_norm = 4318.67676
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 460.00415 | spectral_norm = 39.81110 | nuclear_norm = 10544.73340
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 453.43185 | spectral_norm = 33.61445 | nuclear_norm = 10669.82227
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 422.02344 | spectral_norm = 34.98891 | nuclear_norm = 11207.82422
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 208.70367 | spectral_norm = 20.34466 | nuclear_norm = 5491.37451
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 183.80862 | spectral_norm = 18.53404 | nuclear_norm = 4149.40430
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 183.10320 | spectral_norm = 17.75497 | nuclear_norm = 4157.28174
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 465.97791 | spectral_norm = 40.80685 | nuclear_norm = 10634.75586
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 448.41574 | spectral_norm = 33.33496 | nuclear_norm = 10618.11133
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 428.38580 | spectral_norm = 33.17850 | nuclear_norm = 11430.44727
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 206.49875 | spectral_norm = 19.13769 | nuclear_norm = 5440.61035
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 181.06377 | spectral_norm = 20.42402 | nuclear_norm = 4094.59619
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 176.70189 | spectral_norm = 19.29334 | nuclear_norm = 4038.84595
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 447.89877 | spectral_norm = 37.82631 | nuclear_norm = 10389.07422
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 439.10526 | spectral_norm = 32.36997 | nuclear_norm = 10320.61719
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 425.71436 | spectral_norm = 30.51976 | nuclear_norm = 11358.03711
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 209.93217 | spectral_norm = 20.97575 | nuclear_norm = 5528.97852
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 188.33574 | spectral_norm = 18.71564 | nuclear_norm = 4271.75537
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 186.70845 | spectral_norm = 18.27924 | nuclear_norm = 4255.26221
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 478.42029 | spectral_norm = 42.80689 | nuclear_norm = 10848.24121
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 452.99063 | spectral_norm = 35.20761 | nuclear_norm = 10647.04004
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 418.73404 | spectral_norm = 34.48404 | nuclear_norm = 11144.98438
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 211.04939 | spectral_norm = 21.22630 | nuclear_norm = 5562.44775
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 186.73218 | spectral_norm = 19.53587 | nuclear_norm = 4190.09912
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 185.73035 | spectral_norm = 17.60183 | nuclear_norm = 4141.62842
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 468.28699 | spectral_norm = 41.12782 | nuclear_norm = 10631.86035
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 454.72751 | spectral_norm = 32.80579 | nuclear_norm = 10651.74121
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 424.21274 | spectral_norm = 37.13257 | nuclear_norm = 11256.06152
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 213.89430 | spectral_norm = 22.17219 | nuclear_norm = 5650.57373
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 192.50641 | spectral_norm = 19.74049 | nuclear_norm = 4312.73389
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 191.84892 | spectral_norm = 19.24831 | nuclear_norm = 4266.26318
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 484.98920 | spectral_norm = 49.77157 | nuclear_norm = 11116.43359
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 462.24478 | spectral_norm = 32.93708 | nuclear_norm = 10889.76953
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 414.65311 | spectral_norm = 35.46987 | nuclear_norm = 11016.16992
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 215.20287 | spectral_norm = 22.00070 | nuclear_norm = 5714.25781
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 192.37206 | spectral_norm = 20.11313 | nuclear_norm = 4291.94678
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 190.72517 | spectral_norm = 20.20100 | nuclear_norm = 4216.87598
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 457.78723 | spectral_norm = 44.40584 | nuclear_norm = 10502.40625
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 449.20294 | spectral_norm = 31.89269 | nuclear_norm = 10544.34961
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 433.72687 | spectral_norm = 33.23478 | nuclear_norm = 11554.10449
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 210.13341 | spectral_norm = 24.78040 | nuclear_norm = 5566.54297
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 189.62509 | spectral_norm = 25.00468 | nuclear_norm = 4172.77490
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 184.37074 | spectral_norm = 22.91657 | nuclear_norm = 4030.58740
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 411.58289 | spectral_norm = 50.40304 | nuclear_norm = 9327.30371
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 456.57498 | spectral_norm = 33.24949 | nuclear_norm = 10577.36230
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 452.79791 | spectral_norm = 35.96009 | nuclear_norm = 12034.60840
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 214.29906 | spectral_norm = 27.50311 | nuclear_norm = 5619.79932
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1320.08606 | spectral_norm = 182.62865 | nuclear_norm = 34834.78906
===========================================
step:1376/1750 train_loss:3.4062 train_time:498906ms step_avg:365.23ms
step:1377/1750 train_loss:3.5413 train_time:499280ms step_avg:365.24ms
step:1378/1750 train_loss:3.5414 train_time:499660ms step_avg:365.25ms
step:1379/1750 train_loss:3.1900 train_time:500048ms step_avg:365.26ms
step:1380/1750 train_loss:3.3741 train_time:500430ms step_avg:365.28ms
step:1381/1750 train_loss:3.7744 train_time:500820ms step_avg:365.30ms
step:1382/1750 train_loss:3.2747 train_time:501199ms step_avg:365.31ms
step:1383/1750 train_loss:3.4529 train_time:501586ms step_avg:365.32ms
step:1384/1750 train_loss:3.5413 train_time:501971ms step_avg:365.34ms
step:1385/1750 train_loss:3.4655 train_time:502346ms step_avg:365.34ms
step:1386/1750 train_loss:3.3990 train_time:502728ms step_avg:365.35ms
step:1387/1750 train_loss:3.2592 train_time:503113ms step_avg:365.37ms
step:1388/1750 train_loss:3.4070 train_time:503492ms step_avg:365.38ms
step:1389/1750 train_loss:3.3816 train_time:503876ms step_avg:365.39ms
step:1390/1750 train_loss:3.6328 train_time:504254ms step_avg:365.40ms
step:1391/1750 train_loss:3.3498 train_time:504638ms step_avg:365.41ms
step:1392/1750 train_loss:3.3548 train_time:505020ms step_avg:365.43ms
step:1393/1750 train_loss:3.3070 train_time:505398ms step_avg:365.44ms
step:1394/1750 train_loss:3.5721 train_time:505775ms step_avg:365.44ms
step:1395/1750 train_loss:3.4604 train_time:506157ms step_avg:365.46ms
step:1396/1750 train_loss:3.4667 train_time:506536ms step_avg:365.47ms
step:1397/1750 train_loss:3.3653 train_time:506912ms step_avg:365.47ms
step:1398/1750 train_loss:3.3132 train_time:507293ms step_avg:365.49ms
step:1399/1750 train_loss:3.3911 train_time:507677ms step_avg:365.50ms
step:1400/1750 train_loss:3.3740 train_time:508072ms step_avg:365.52ms
step:1401/1750 train_loss:3.4044 train_time:508442ms step_avg:365.52ms
step:1402/1750 train_loss:3.3569 train_time:508821ms step_avg:365.53ms
step:1403/1750 train_loss:3.5589 train_time:509210ms step_avg:365.55ms
step:1404/1750 train_loss:3.3363 train_time:509590ms step_avg:365.56ms
step:1405/1750 train_loss:3.3660 train_time:509971ms step_avg:365.57ms
step:1406/1750 train_loss:3.3718 train_time:510354ms step_avg:365.58ms
step:1407/1750 train_loss:3.2346 train_time:510731ms step_avg:365.59ms
step:1408/1750 train_loss:3.3634 train_time:511116ms step_avg:365.60ms
step:1409/1750 train_loss:3.3548 train_time:511516ms step_avg:365.63ms
step:1410/1750 train_loss:3.3457 train_time:511894ms step_avg:365.64ms
step:1411/1750 train_loss:3.4265 train_time:512269ms step_avg:365.65ms
step:1412/1750 train_loss:3.3854 train_time:512648ms step_avg:365.66ms
step:1413/1750 train_loss:3.4217 train_time:513033ms step_avg:365.67ms
step:1414/1750 train_loss:3.3991 train_time:513417ms step_avg:365.68ms
step:1415/1750 train_loss:3.4702 train_time:513811ms step_avg:365.70ms
step:1416/1750 train_loss:3.2855 train_time:514217ms step_avg:365.73ms
step:1417/1750 train_loss:3.3453 train_time:514606ms step_avg:365.75ms
step:1418/1750 train_loss:3.4493 train_time:514991ms step_avg:365.76ms
step:1419/1750 train_loss:3.4037 train_time:515381ms step_avg:365.78ms
step:1420/1750 train_loss:3.4188 train_time:515770ms step_avg:365.79ms
step:1421/1750 train_loss:3.4322 train_time:516155ms step_avg:365.81ms
step:1422/1750 train_loss:3.3982 train_time:516535ms step_avg:365.82ms
step:1423/1750 train_loss:3.3762 train_time:516916ms step_avg:365.83ms
step:1424/1750 train_loss:3.3876 train_time:517308ms step_avg:365.85ms
step:1425/1750 train_loss:3.2403 train_time:517706ms step_avg:365.87ms
step:1426/1750 train_loss:3.3846 train_time:518089ms step_avg:365.88ms
step:1427/1750 train_loss:3.3357 train_time:518479ms step_avg:365.90ms
step:1428/1750 train_loss:3.4333 train_time:518861ms step_avg:365.91ms
step:1429/1750 train_loss:3.4177 train_time:519242ms step_avg:365.92ms
step:1430/1750 train_loss:3.3177 train_time:519633ms step_avg:365.94ms
step:1431/1750 train_loss:3.3742 train_time:520026ms step_avg:365.96ms
step:1432/1750 train_loss:3.3952 train_time:520421ms step_avg:365.98ms
step:1433/1750 train_loss:3.2050 train_time:520823ms step_avg:366.00ms
step:1434/1750 train_loss:3.3514 train_time:521224ms step_avg:366.03ms
step:1435/1750 train_loss:3.1783 train_time:521613ms step_avg:366.04ms
step:1436/1750 train_loss:3.2843 train_time:522000ms step_avg:366.06ms
step:1437/1750 train_loss:3.4661 train_time:522381ms step_avg:366.07ms
step:1438/1750 train_loss:3.4390 train_time:522767ms step_avg:366.08ms
step:1439/1750 train_loss:3.3759 train_time:523156ms step_avg:366.10ms
step:1440/1750 train_loss:3.2477 train_time:523537ms step_avg:366.11ms
step:1441/1750 train_loss:3.4009 train_time:523923ms step_avg:366.12ms
step:1442/1750 train_loss:3.4452 train_time:524319ms step_avg:366.14ms
step:1443/1750 train_loss:3.5377 train_time:524721ms step_avg:366.17ms
step:1444/1750 train_loss:3.5011 train_time:525105ms step_avg:366.18ms
step:1445/1750 train_loss:3.3912 train_time:525492ms step_avg:366.20ms
step:1446/1750 train_loss:3.2643 train_time:525888ms step_avg:366.22ms
step:1447/1750 train_loss:3.3502 train_time:526282ms step_avg:366.24ms
step:1448/1750 train_loss:3.3499 train_time:526666ms step_avg:366.25ms
step:1449/1750 train_loss:3.4580 train_time:527050ms step_avg:366.26ms
step:1450/1750 train_loss:3.4505 train_time:527437ms step_avg:366.28ms
step:1451/1750 train_loss:3.2636 train_time:527822ms step_avg:366.29ms
step:1452/1750 train_loss:3.3844 train_time:528211ms step_avg:366.30ms
step:1453/1750 train_loss:3.3120 train_time:528589ms step_avg:366.31ms
step:1454/1750 train_loss:3.3407 train_time:528973ms step_avg:366.32ms
step:1455/1750 train_loss:3.3819 train_time:529365ms step_avg:366.34ms
step:1456/1750 train_loss:3.3336 train_time:529746ms step_avg:366.35ms
step:1457/1750 train_loss:3.2146 train_time:530130ms step_avg:366.36ms
step:1458/1750 train_loss:3.4812 train_time:530516ms step_avg:366.38ms
step:1459/1750 train_loss:3.3272 train_time:530906ms step_avg:366.40ms
step:1460/1750 train_loss:3.3697 train_time:531292ms step_avg:366.41ms
step:1461/1750 train_loss:3.4903 train_time:531679ms step_avg:366.42ms
step:1462/1750 train_loss:3.3148 train_time:532061ms step_avg:366.43ms
step:1463/1750 train_loss:3.5236 train_time:532454ms step_avg:366.45ms
step:1464/1750 train_loss:3.4117 train_time:532844ms step_avg:366.47ms
step:1465/1750 train_loss:3.4103 train_time:533232ms step_avg:366.48ms
step:1466/1750 train_loss:3.3415 train_time:533616ms step_avg:366.49ms
step:1467/1750 train_loss:3.4458 train_time:534006ms step_avg:366.51ms
step:1468/1750 train_loss:3.3378 train_time:534389ms step_avg:366.52ms
step:1469/1750 train_loss:3.3244 train_time:534778ms step_avg:366.54ms
step:1470/1750 train_loss:3.3892 train_time:535177ms step_avg:366.56ms
step:1471/1750 train_loss:3.3059 train_time:535579ms step_avg:366.58ms
step:1472/1750 train_loss:3.2906 train_time:535979ms step_avg:366.61ms
step:1473/1750 train_loss:3.4898 train_time:536363ms step_avg:366.62ms
step:1474/1750 train_loss:3.3683 train_time:536759ms step_avg:366.64ms
step:1475/1750 train_loss:3.1980 train_time:537158ms step_avg:366.66ms
step:1476/1750 train_loss:3.3143 train_time:537542ms step_avg:366.67ms
step:1477/1750 train_loss:3.2941 train_time:537939ms step_avg:366.69ms
step:1478/1750 train_loss:3.3641 train_time:538336ms step_avg:366.71ms
step:1479/1750 train_loss:3.4486 train_time:538725ms step_avg:366.73ms
step:1480/1750 train_loss:3.3316 train_time:539105ms step_avg:366.74ms
step:1481/1750 train_loss:3.5068 train_time:539495ms step_avg:366.75ms
step:1482/1750 train_loss:3.4229 train_time:539897ms step_avg:366.78ms
step:1483/1750 train_loss:3.3299 train_time:540307ms step_avg:366.81ms
step:1484/1750 train_loss:3.3132 train_time:540705ms step_avg:366.83ms
step:1485/1750 train_loss:3.3312 train_time:541089ms step_avg:366.84ms
step:1486/1750 train_loss:3.2734 train_time:541483ms step_avg:366.86ms
step:1487/1750 train_loss:3.3896 train_time:541876ms step_avg:366.88ms
step:1488/1750 train_loss:3.2819 train_time:542271ms step_avg:366.90ms
step:1489/1750 train_loss:3.3748 train_time:542661ms step_avg:366.91ms
step:1490/1750 train_loss:3.3026 train_time:543050ms step_avg:366.93ms
step:1491/1750 train_loss:3.2170 train_time:543438ms step_avg:366.94ms
step:1492/1750 train_loss:3.3125 train_time:543824ms step_avg:366.95ms
step:1493/1750 train_loss:3.4841 train_time:544204ms step_avg:366.96ms
step:1494/1750 train_loss:3.3525 train_time:544585ms step_avg:366.97ms
step:1495/1750 train_loss:3.0817 train_time:544978ms step_avg:366.99ms
step:1496/1750 train_loss:3.4114 train_time:545368ms step_avg:367.00ms
step:1497/1750 train_loss:3.3644 train_time:545758ms step_avg:367.02ms
step:1498/1750 train_loss:3.3950 train_time:546154ms step_avg:367.04ms
step:1499/1750 train_loss:3.3666 train_time:546556ms step_avg:367.06ms
step:1500/1750 train_loss:3.3450 train_time:546970ms step_avg:367.09ms
step:1500/1750 val_loss:3.3389 train_time:547075ms step_avg:367.16ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 295.84836 | frobenius_norm = 68286.66406 | spectral_norm = 12046.95508 | nuclear_norm = 1719739.37500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 190.71715 | spectral_norm = 38.88979 | nuclear_norm = 4357.91895
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 186.37949 | spectral_norm = 40.69979 | nuclear_norm = 4249.93750
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 409.31369 | spectral_norm = 26.74869 | nuclear_norm = 10095.77832
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 278.61124 | spectral_norm = 32.09028 | nuclear_norm = 6350.23486
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 426.83917 | spectral_norm = 38.08760 | nuclear_norm = 11324.82031
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 208.97804 | spectral_norm = 19.39544 | nuclear_norm = 5512.53467
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 196.81586 | spectral_norm = 21.88142 | nuclear_norm = 4528.21387
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 193.06592 | spectral_norm = 19.87509 | nuclear_norm = 4461.06006
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 405.14743 | spectral_norm = 38.01502 | nuclear_norm = 9240.62305
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 408.92709 | spectral_norm = 32.44807 | nuclear_norm = 9532.12305
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 419.23102 | spectral_norm = 33.45140 | nuclear_norm = 11152.31250
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 206.43504 | spectral_norm = 22.22925 | nuclear_norm = 5419.40918
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 182.98932 | spectral_norm = 18.39548 | nuclear_norm = 4004.64648
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 184.49878 | spectral_norm = 17.41001 | nuclear_norm = 4049.04272
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 433.55478 | spectral_norm = 40.68086 | nuclear_norm = 9892.85938
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 440.10638 | spectral_norm = 35.41961 | nuclear_norm = 10326.55371
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 424.52368 | spectral_norm = 39.13707 | nuclear_norm = 11291.66895
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 207.30522 | spectral_norm = 21.48271 | nuclear_norm = 5457.83203
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 191.10912 | spectral_norm = 20.70080 | nuclear_norm = 4382.22021
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 189.81039 | spectral_norm = 19.53673 | nuclear_norm = 4373.18359
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 451.96860 | spectral_norm = 38.98687 | nuclear_norm = 10355.63574
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 455.00867 | spectral_norm = 36.39931 | nuclear_norm = 10644.04395
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 430.52536 | spectral_norm = 40.48244 | nuclear_norm = 11421.42480
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 211.81599 | spectral_norm = 21.41549 | nuclear_norm = 5563.48438
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 190.91104 | spectral_norm = 20.39619 | nuclear_norm = 4365.75879
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 190.16487 | spectral_norm = 19.33329 | nuclear_norm = 4380.76465
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 468.31430 | spectral_norm = 40.45124 | nuclear_norm = 10742.92578
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 461.50214 | spectral_norm = 34.05688 | nuclear_norm = 10867.04883
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 428.05228 | spectral_norm = 35.71193 | nuclear_norm = 11366.38672
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 211.86971 | spectral_norm = 20.76871 | nuclear_norm = 5575.61963
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 186.43329 | spectral_norm = 18.92619 | nuclear_norm = 4201.11377
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 185.80760 | spectral_norm = 18.19167 | nuclear_norm = 4213.08643
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 474.34515 | spectral_norm = 41.52315 | nuclear_norm = 10836.95996
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 456.32910 | spectral_norm = 33.72382 | nuclear_norm = 10813.32422
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 434.54355 | spectral_norm = 33.86973 | nuclear_norm = 11594.99414
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 209.67162 | spectral_norm = 19.55130 | nuclear_norm = 5526.73584
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 183.74774 | spectral_norm = 20.85710 | nuclear_norm = 4147.49463
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 179.29285 | spectral_norm = 19.66812 | nuclear_norm = 4094.92578
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 455.87097 | spectral_norm = 38.52731 | nuclear_norm = 10586.55859
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 446.78586 | spectral_norm = 32.89878 | nuclear_norm = 10509.67676
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 432.10553 | spectral_norm = 31.07745 | nuclear_norm = 11529.65625
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 213.18410 | spectral_norm = 21.47145 | nuclear_norm = 5615.63281
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 191.13445 | spectral_norm = 19.08095 | nuclear_norm = 4327.83643
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 189.45615 | spectral_norm = 18.53654 | nuclear_norm = 4312.62158
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 486.45602 | spectral_norm = 43.54760 | nuclear_norm = 11031.51855
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 460.36081 | spectral_norm = 35.69490 | nuclear_norm = 10822.12695
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 424.98175 | spectral_norm = 34.97887 | nuclear_norm = 11310.29688
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 214.22025 | spectral_norm = 21.69065 | nuclear_norm = 5645.26367
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 189.37495 | spectral_norm = 19.90481 | nuclear_norm = 4238.76172
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 188.39543 | spectral_norm = 17.93332 | nuclear_norm = 4191.77148
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 475.77582 | spectral_norm = 41.90076 | nuclear_norm = 10800.60938
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 461.08267 | spectral_norm = 33.41991 | nuclear_norm = 10794.09766
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 430.84933 | spectral_norm = 37.89518 | nuclear_norm = 11427.88965
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 217.07350 | spectral_norm = 22.63616 | nuclear_norm = 5733.10742
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 195.26498 | spectral_norm = 20.18734 | nuclear_norm = 4364.10645
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 194.65700 | spectral_norm = 19.57417 | nuclear_norm = 4317.04785
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 493.91251 | spectral_norm = 51.28746 | nuclear_norm = 11316.59277
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 469.32037 | spectral_norm = 33.57645 | nuclear_norm = 11049.59180
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 420.42294 | spectral_norm = 36.14197 | nuclear_norm = 11165.64062
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 218.53134 | spectral_norm = 22.40701 | nuclear_norm = 5802.61572
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 194.98708 | spectral_norm = 20.57775 | nuclear_norm = 4337.92529
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 193.43953 | spectral_norm = 20.60859 | nuclear_norm = 4263.82617
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 466.99893 | spectral_norm = 45.69999 | nuclear_norm = 10710.92188
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 456.00073 | spectral_norm = 32.40725 | nuclear_norm = 10701.25977
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 439.54822 | spectral_norm = 33.87079 | nuclear_norm = 11707.67676
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 213.64435 | spectral_norm = 25.21949 | nuclear_norm = 5659.71875
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 192.05937 | spectral_norm = 25.74489 | nuclear_norm = 4209.83496
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 186.69563 | spectral_norm = 23.59477 | nuclear_norm = 4065.22510
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 421.94971 | spectral_norm = 52.39082 | nuclear_norm = 9557.21387
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 465.26761 | spectral_norm = 33.96364 | nuclear_norm = 10777.82910
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 457.77887 | spectral_norm = 36.29163 | nuclear_norm = 12164.39941
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 217.32637 | spectral_norm = 28.01064 | nuclear_norm = 5697.02930
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1328.04785 | spectral_norm = 178.87489 | nuclear_norm = 35106.29297
===========================================
step:1501/1750 train_loss:3.1348 train_time:547354ms step_avg:367.11ms
step:1502/1750 train_loss:3.4084 train_time:547731ms step_avg:367.11ms
step:1503/1750 train_loss:3.2923 train_time:548111ms step_avg:367.12ms
step:1504/1750 train_loss:3.3013 train_time:548497ms step_avg:367.13ms
step:1505/1750 train_loss:3.2586 train_time:548878ms step_avg:367.14ms
step:1506/1750 train_loss:3.3273 train_time:549266ms step_avg:367.16ms
step:1507/1750 train_loss:3.2232 train_time:549675ms step_avg:367.18ms
step:1508/1750 train_loss:3.5308 train_time:550065ms step_avg:367.20ms
step:1509/1750 train_loss:3.3286 train_time:550445ms step_avg:367.21ms
step:1510/1750 train_loss:3.3254 train_time:550830ms step_avg:367.22ms
step:1511/1750 train_loss:3.4585 train_time:551260ms step_avg:367.26ms
step:1512/1750 train_loss:3.4679 train_time:551697ms step_avg:367.31ms
step:1513/1750 train_loss:3.3170 train_time:552086ms step_avg:367.32ms
step:1514/1750 train_loss:3.1375 train_time:552477ms step_avg:367.34ms
step:1515/1750 train_loss:3.2846 train_time:552865ms step_avg:367.35ms
step:1516/1750 train_loss:3.3005 train_time:553260ms step_avg:367.37ms
step:1517/1750 train_loss:3.3478 train_time:553647ms step_avg:367.38ms
step:1518/1750 train_loss:3.2587 train_time:554037ms step_avg:367.40ms
step:1519/1750 train_loss:3.5445 train_time:554559ms step_avg:367.50ms
step:1520/1750 train_loss:3.1704 train_time:554953ms step_avg:367.52ms
step:1521/1750 train_loss:3.2538 train_time:555337ms step_avg:367.53ms
step:1522/1750 train_loss:3.3950 train_time:555731ms step_avg:367.55ms
step:1523/1750 train_loss:3.2746 train_time:556114ms step_avg:367.56ms
step:1524/1750 train_loss:3.3901 train_time:556503ms step_avg:367.57ms
step:1525/1750 train_loss:3.3771 train_time:556905ms step_avg:367.59ms
step:1526/1750 train_loss:3.3197 train_time:557312ms step_avg:367.62ms
step:1527/1750 train_loss:3.3365 train_time:557700ms step_avg:367.63ms
step:1528/1750 train_loss:3.4537 train_time:558085ms step_avg:367.65ms
step:1529/1750 train_loss:3.4529 train_time:558466ms step_avg:367.65ms
step:1530/1750 train_loss:3.2803 train_time:558847ms step_avg:367.66ms
step:1531/1750 train_loss:3.2351 train_time:559237ms step_avg:367.68ms
step:1532/1750 train_loss:3.3873 train_time:559622ms step_avg:367.69ms
step:1533/1750 train_loss:3.3213 train_time:560022ms step_avg:367.71ms
step:1534/1750 train_loss:3.3199 train_time:560420ms step_avg:367.73ms
step:1535/1750 train_loss:3.3233 train_time:560808ms step_avg:367.74ms
step:1536/1750 train_loss:3.2715 train_time:561203ms step_avg:367.76ms
step:1537/1750 train_loss:3.3172 train_time:561592ms step_avg:367.77ms
step:1538/1750 train_loss:3.4670 train_time:561995ms step_avg:367.80ms
step:1539/1750 train_loss:3.4460 train_time:562390ms step_avg:367.82ms
step:1540/1750 train_loss:3.3160 train_time:562778ms step_avg:367.83ms
step:1541/1750 train_loss:3.2724 train_time:563169ms step_avg:367.84ms
step:1542/1750 train_loss:3.2941 train_time:563561ms step_avg:367.86ms
step:1543/1750 train_loss:3.1928 train_time:563949ms step_avg:367.87ms
step:1544/1750 train_loss:3.3333 train_time:564330ms step_avg:367.88ms
step:1545/1750 train_loss:3.3147 train_time:564722ms step_avg:367.90ms
step:1546/1750 train_loss:3.3035 train_time:565127ms step_avg:367.92ms
step:1547/1750 train_loss:3.2601 train_time:565523ms step_avg:367.94ms
step:1548/1750 train_loss:3.3041 train_time:565923ms step_avg:367.96ms
step:1549/1750 train_loss:3.3744 train_time:566305ms step_avg:367.97ms
step:1550/1750 train_loss:3.3380 train_time:566687ms step_avg:367.98ms
step:1551/1750 train_loss:3.2448 train_time:567078ms step_avg:367.99ms
step:1552/1750 train_loss:3.2649 train_time:567469ms step_avg:368.01ms
step:1553/1750 train_loss:3.2692 train_time:567851ms step_avg:368.02ms
step:1554/1750 train_loss:3.3968 train_time:568241ms step_avg:368.03ms
step:1555/1750 train_loss:3.3741 train_time:568634ms step_avg:368.05ms
step:1556/1750 train_loss:3.3235 train_time:569015ms step_avg:368.06ms
step:1557/1750 train_loss:3.3682 train_time:569394ms step_avg:368.06ms
step:1558/1750 train_loss:3.3017 train_time:569784ms step_avg:368.08ms
step:1559/1750 train_loss:3.1737 train_time:570188ms step_avg:368.10ms
step:1560/1750 train_loss:3.4735 train_time:570573ms step_avg:368.11ms
step:1561/1750 train_loss:3.2645 train_time:570960ms step_avg:368.12ms
step:1562/1750 train_loss:3.2563 train_time:571343ms step_avg:368.13ms
step:1563/1750 train_loss:3.3664 train_time:571730ms step_avg:368.15ms
step:1564/1750 train_loss:3.1957 train_time:572131ms step_avg:368.17ms
step:1565/1750 train_loss:3.2082 train_time:572529ms step_avg:368.19ms
step:1566/1750 train_loss:3.4066 train_time:572920ms step_avg:368.20ms
step:1567/1750 train_loss:3.2753 train_time:573307ms step_avg:368.21ms
step:1568/1750 train_loss:3.2853 train_time:573707ms step_avg:368.23ms
step:1569/1750 train_loss:3.3671 train_time:574127ms step_avg:368.27ms
step:1570/1750 train_loss:3.3247 train_time:574532ms step_avg:368.29ms
step:1571/1750 train_loss:3.2003 train_time:574930ms step_avg:368.31ms
step:1572/1750 train_loss:3.2416 train_time:575319ms step_avg:368.32ms
step:1573/1750 train_loss:3.3547 train_time:575711ms step_avg:368.34ms
step:1574/1750 train_loss:3.2108 train_time:576095ms step_avg:368.35ms
step:1575/1750 train_loss:3.3706 train_time:576482ms step_avg:368.36ms
step:1576/1750 train_loss:3.2715 train_time:576869ms step_avg:368.37ms
step:1577/1750 train_loss:3.3293 train_time:577268ms step_avg:368.39ms
step:1578/1750 train_loss:3.3149 train_time:577660ms step_avg:368.41ms
step:1579/1750 train_loss:3.2841 train_time:578058ms step_avg:368.42ms
step:1580/1750 train_loss:3.2463 train_time:578445ms step_avg:368.44ms
step:1581/1750 train_loss:3.4413 train_time:578843ms step_avg:368.46ms
step:1582/1750 train_loss:3.2675 train_time:579254ms step_avg:368.48ms
step:1583/1750 train_loss:3.4223 train_time:579661ms step_avg:368.51ms
step:1584/1750 train_loss:3.2362 train_time:580048ms step_avg:368.52ms
step:1585/1750 train_loss:3.4097 train_time:580446ms step_avg:368.54ms
step:1586/1750 train_loss:3.1920 train_time:580835ms step_avg:368.55ms
step:1587/1750 train_loss:3.3932 train_time:581222ms step_avg:368.56ms
step:1588/1750 train_loss:3.2719 train_time:581618ms step_avg:368.58ms
step:1589/1750 train_loss:3.4332 train_time:582008ms step_avg:368.59ms
step:1590/1750 train_loss:3.2775 train_time:582398ms step_avg:368.61ms
step:1591/1750 train_loss:3.2896 train_time:582790ms step_avg:368.62ms
step:1592/1750 train_loss:3.3600 train_time:583182ms step_avg:368.64ms
step:1593/1750 train_loss:3.3337 train_time:583585ms step_avg:368.66ms
step:1594/1750 train_loss:3.3096 train_time:583975ms step_avg:368.67ms
step:1595/1750 train_loss:3.4463 train_time:584366ms step_avg:368.69ms
step:1596/1750 train_loss:3.1519 train_time:584770ms step_avg:368.71ms
step:1597/1750 train_loss:3.3272 train_time:585171ms step_avg:368.73ms
step:1598/1750 train_loss:3.3820 train_time:585574ms step_avg:368.75ms
step:1599/1750 train_loss:3.4427 train_time:585980ms step_avg:368.77ms
step:1600/1750 train_loss:3.2627 train_time:586381ms step_avg:368.79ms
step:1601/1750 train_loss:3.5730 train_time:586767ms step_avg:368.80ms
step:1602/1750 train_loss:3.4515 train_time:587166ms step_avg:368.82ms
step:1603/1750 train_loss:3.2208 train_time:587572ms step_avg:368.85ms
step:1604/1750 train_loss:3.2622 train_time:587965ms step_avg:368.86ms
step:1605/1750 train_loss:3.1528 train_time:588375ms step_avg:368.89ms
step:1606/1750 train_loss:3.4715 train_time:588783ms step_avg:368.91ms
step:1607/1750 train_loss:3.3010 train_time:589175ms step_avg:368.93ms
step:1608/1750 train_loss:3.3018 train_time:589571ms step_avg:368.94ms
step:1609/1750 train_loss:3.2374 train_time:589968ms step_avg:368.96ms
step:1610/1750 train_loss:3.7437 train_time:590384ms step_avg:368.99ms
step:1611/1750 train_loss:3.5000 train_time:590788ms step_avg:369.01ms
step:1612/1750 train_loss:3.3911 train_time:591194ms step_avg:369.04ms
step:1613/1750 train_loss:3.2626 train_time:591610ms step_avg:369.06ms
step:1614/1750 train_loss:3.2897 train_time:592005ms step_avg:369.08ms
step:1615/1750 train_loss:3.3097 train_time:592410ms step_avg:369.10ms
step:1616/1750 train_loss:3.2775 train_time:592839ms step_avg:369.14ms
step:1617/1750 train_loss:3.3520 train_time:593254ms step_avg:369.17ms
step:1618/1750 train_loss:3.2764 train_time:593638ms step_avg:369.18ms
step:1619/1750 train_loss:3.1829 train_time:594033ms step_avg:369.19ms
step:1620/1750 train_loss:3.4549 train_time:594424ms step_avg:369.21ms
step:1621/1750 train_loss:3.3743 train_time:594827ms step_avg:369.23ms
step:1622/1750 train_loss:3.1569 train_time:595219ms step_avg:369.24ms
step:1623/1750 train_loss:3.2525 train_time:595612ms step_avg:369.26ms
step:1624/1750 train_loss:3.2077 train_time:595993ms step_avg:369.26ms
step:1625/1750 train_loss:3.3146 train_time:596377ms step_avg:369.27ms
step:1625/1750 val_loss:3.3010 train_time:596481ms step_avg:369.34ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.34424 | frobenius_norm = 68404.35156 | spectral_norm = 12080.60645 | nuclear_norm = 1723305.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 191.28821 | spectral_norm = 39.56950 | nuclear_norm = 4365.85010
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 187.12462 | spectral_norm = 41.22573 | nuclear_norm = 4263.82129
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 412.17313 | spectral_norm = 26.91504 | nuclear_norm = 10174.45801
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 278.58853 | spectral_norm = 32.28498 | nuclear_norm = 6340.13184
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 429.89352 | spectral_norm = 38.47517 | nuclear_norm = 11406.17676
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 210.33116 | spectral_norm = 19.57262 | nuclear_norm = 5548.85059
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 198.03194 | spectral_norm = 22.07966 | nuclear_norm = 4554.83691
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 194.24983 | spectral_norm = 20.09613 | nuclear_norm = 4487.34033
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 407.88889 | spectral_norm = 38.38736 | nuclear_norm = 9304.09570
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 411.60004 | spectral_norm = 32.65893 | nuclear_norm = 9597.40039
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 421.93668 | spectral_norm = 33.68803 | nuclear_norm = 11225.15820
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 207.70625 | spectral_norm = 22.39046 | nuclear_norm = 5452.46436
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 183.88187 | spectral_norm = 18.54518 | nuclear_norm = 4017.19287
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 185.43477 | spectral_norm = 17.51871 | nuclear_norm = 4063.13330
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 436.66733 | spectral_norm = 40.86473 | nuclear_norm = 9967.99902
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 443.13535 | spectral_norm = 35.64038 | nuclear_norm = 10401.23828
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 427.22778 | spectral_norm = 39.48823 | nuclear_norm = 11363.62500
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 208.63797 | spectral_norm = 21.64940 | nuclear_norm = 5493.91943
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 192.23447 | spectral_norm = 20.93049 | nuclear_norm = 4405.16406
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 190.93968 | spectral_norm = 19.73965 | nuclear_norm = 4397.75195
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 455.64819 | spectral_norm = 39.25800 | nuclear_norm = 10444.14844
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 458.53076 | spectral_norm = 36.62636 | nuclear_norm = 10729.54688
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 433.13080 | spectral_norm = 40.82403 | nuclear_norm = 11491.24512
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 213.13336 | spectral_norm = 21.59721 | nuclear_norm = 5598.67432
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 192.02655 | spectral_norm = 20.59789 | nuclear_norm = 4387.72900
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 191.30275 | spectral_norm = 19.51129 | nuclear_norm = 4405.68994
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 472.17261 | spectral_norm = 40.79862 | nuclear_norm = 10837.89648
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 465.15009 | spectral_norm = 34.31472 | nuclear_norm = 10956.62402
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 430.55429 | spectral_norm = 35.93467 | nuclear_norm = 11432.28125
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 213.15208 | spectral_norm = 20.96491 | nuclear_norm = 5609.82227
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 187.48607 | spectral_norm = 19.13663 | nuclear_norm = 4219.07080
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 186.87195 | spectral_norm = 18.32330 | nuclear_norm = 4233.34033
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 478.20190 | spectral_norm = 41.84818 | nuclear_norm = 10932.39062
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 459.98660 | spectral_norm = 33.91668 | nuclear_norm = 10905.84570
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 437.03357 | spectral_norm = 34.11774 | nuclear_norm = 11661.82617
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 210.95183 | spectral_norm = 19.70297 | nuclear_norm = 5562.12109
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 184.74150 | spectral_norm = 21.10689 | nuclear_norm = 4164.04932
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 180.31480 | spectral_norm = 19.90568 | nuclear_norm = 4115.73145
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 459.69174 | spectral_norm = 38.84460 | nuclear_norm = 10683.83594
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 450.40656 | spectral_norm = 33.11580 | nuclear_norm = 10600.91797
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 434.79681 | spectral_norm = 31.30880 | nuclear_norm = 11602.18750
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 214.48586 | spectral_norm = 21.68810 | nuclear_norm = 5650.58936
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 192.22620 | spectral_norm = 19.25293 | nuclear_norm = 4347.36719
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 190.53722 | spectral_norm = 18.56480 | nuclear_norm = 4333.65527
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 490.06873 | spectral_norm = 43.83459 | nuclear_norm = 11114.01758
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 463.63708 | spectral_norm = 35.87157 | nuclear_norm = 10899.77148
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 427.62500 | spectral_norm = 35.23146 | nuclear_norm = 11380.07812
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 215.47365 | spectral_norm = 21.87553 | nuclear_norm = 5677.65967
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 190.37387 | spectral_norm = 20.07622 | nuclear_norm = 4254.02295
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 189.37970 | spectral_norm = 18.13096 | nuclear_norm = 4206.68506
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 479.07404 | spectral_norm = 42.17451 | nuclear_norm = 10877.12305
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 463.82660 | spectral_norm = 33.65733 | nuclear_norm = 10853.80078
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 433.62231 | spectral_norm = 38.21544 | nuclear_norm = 11498.23730
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 218.30125 | spectral_norm = 22.82246 | nuclear_norm = 5764.61719
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 196.32826 | spectral_norm = 20.40160 | nuclear_norm = 4379.87598
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 195.70641 | spectral_norm = 19.70273 | nuclear_norm = 4331.09375
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 498.24072 | spectral_norm = 52.10032 | nuclear_norm = 11410.69238
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 472.51047 | spectral_norm = 33.82134 | nuclear_norm = 11119.69336
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 422.68155 | spectral_norm = 36.46602 | nuclear_norm = 11223.06055
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 219.80902 | spectral_norm = 22.55209 | nuclear_norm = 5836.67627
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 195.97444 | spectral_norm = 20.83892 | nuclear_norm = 4350.56836
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 194.42940 | spectral_norm = 20.79833 | nuclear_norm = 4276.25342
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 471.41641 | spectral_norm = 46.43169 | nuclear_norm = 10809.50586
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 458.96664 | spectral_norm = 32.68016 | nuclear_norm = 10768.19336
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 441.71848 | spectral_norm = 34.08639 | nuclear_norm = 11764.34375
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 215.05977 | spectral_norm = 25.33026 | nuclear_norm = 5697.39648
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 192.86507 | spectral_norm = 26.07616 | nuclear_norm = 4216.25293
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 187.43509 | spectral_norm = 23.96013 | nuclear_norm = 4069.78491
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 427.15955 | spectral_norm = 53.55283 | nuclear_norm = 9672.29395
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 469.35352 | spectral_norm = 34.39718 | nuclear_norm = 10869.49805
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 459.26508 | spectral_norm = 36.34709 | nuclear_norm = 12202.05664
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 218.53168 | spectral_norm = 28.18973 | nuclear_norm = 5727.22266
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1326.62830 | spectral_norm = 175.47758 | nuclear_norm = 35114.53125
===========================================
step:1626/1750 train_loss:3.2320 train_time:596763ms step_avg:369.28ms
step:1627/1750 train_loss:3.2298 train_time:597142ms step_avg:369.29ms
step:1628/1750 train_loss:3.3606 train_time:597530ms step_avg:369.30ms
step:1629/1750 train_loss:3.2446 train_time:597918ms step_avg:369.31ms
step:1630/1750 train_loss:3.3177 train_time:598316ms step_avg:369.33ms
step:1631/1750 train_loss:3.1732 train_time:598738ms step_avg:369.36ms
step:1632/1750 train_loss:3.1443 train_time:599125ms step_avg:369.37ms
step:1633/1750 train_loss:3.2949 train_time:599512ms step_avg:369.39ms
step:1634/1750 train_loss:3.3092 train_time:599897ms step_avg:369.39ms
step:1635/1750 train_loss:3.2481 train_time:600301ms step_avg:369.42ms
step:1636/1750 train_loss:3.3300 train_time:600692ms step_avg:369.43ms
step:1637/1750 train_loss:3.3700 train_time:601077ms step_avg:369.44ms
step:1638/1750 train_loss:3.3988 train_time:601470ms step_avg:369.45ms
step:1639/1750 train_loss:3.5691 train_time:601871ms step_avg:369.47ms
step:1640/1750 train_loss:3.3481 train_time:602268ms step_avg:369.49ms
step:1641/1750 train_loss:3.2952 train_time:602664ms step_avg:369.51ms
step:1642/1750 train_loss:3.4073 train_time:603055ms step_avg:369.52ms
step:1643/1750 train_loss:3.2686 train_time:603459ms step_avg:369.54ms
step:1644/1750 train_loss:3.3074 train_time:603849ms step_avg:369.55ms
step:1645/1750 train_loss:3.3122 train_time:604234ms step_avg:369.56ms
step:1646/1750 train_loss:3.0694 train_time:604623ms step_avg:369.57ms
step:1647/1750 train_loss:3.3163 train_time:605011ms step_avg:369.59ms
step:1648/1750 train_loss:3.2129 train_time:605402ms step_avg:369.60ms
step:1649/1750 train_loss:3.2829 train_time:605788ms step_avg:369.61ms
step:1650/1750 train_loss:3.2684 train_time:606175ms step_avg:369.62ms
step:1651/1750 train_loss:3.3447 train_time:606561ms step_avg:369.63ms
step:1652/1750 train_loss:3.2563 train_time:606951ms step_avg:369.64ms
step:1653/1750 train_loss:3.3848 train_time:607353ms step_avg:369.66ms
step:1654/1750 train_loss:3.3832 train_time:607742ms step_avg:369.67ms
step:1655/1750 train_loss:3.1747 train_time:608141ms step_avg:369.69ms
step:1656/1750 train_loss:3.3236 train_time:608551ms step_avg:369.72ms
step:1657/1750 train_loss:3.2471 train_time:608951ms step_avg:369.73ms
step:1658/1750 train_loss:3.2189 train_time:609338ms step_avg:369.74ms
step:1659/1750 train_loss:3.2994 train_time:609726ms step_avg:369.76ms
step:1660/1750 train_loss:3.3393 train_time:610115ms step_avg:369.77ms
step:1661/1750 train_loss:3.2458 train_time:610506ms step_avg:369.78ms
step:1662/1750 train_loss:3.3593 train_time:610892ms step_avg:369.79ms
step:1663/1750 train_loss:3.3441 train_time:611295ms step_avg:369.81ms
step:1664/1750 train_loss:3.4070 train_time:611719ms step_avg:369.84ms
step:1665/1750 train_loss:3.3266 train_time:612116ms step_avg:369.86ms
step:1666/1750 train_loss:3.4987 train_time:612508ms step_avg:369.87ms
step:1667/1750 train_loss:3.2018 train_time:612903ms step_avg:369.89ms
step:1668/1750 train_loss:3.2948 train_time:613299ms step_avg:369.90ms
step:1669/1750 train_loss:3.2022 train_time:613687ms step_avg:369.91ms
step:1670/1750 train_loss:3.2216 train_time:614080ms step_avg:369.93ms
step:1671/1750 train_loss:3.3688 train_time:614473ms step_avg:369.94ms
step:1672/1750 train_loss:3.5694 train_time:614865ms step_avg:369.95ms
step:1673/1750 train_loss:3.2709 train_time:615257ms step_avg:369.97ms
step:1674/1750 train_loss:3.2521 train_time:615649ms step_avg:369.98ms
step:1675/1750 train_loss:3.1284 train_time:616053ms step_avg:370.00ms
step:1676/1750 train_loss:3.3471 train_time:616453ms step_avg:370.02ms
step:1677/1750 train_loss:3.2738 train_time:616845ms step_avg:370.03ms
step:1678/1750 train_loss:3.2955 train_time:617239ms step_avg:370.05ms
step:1679/1750 train_loss:3.2958 train_time:617629ms step_avg:370.06ms
step:1680/1750 train_loss:3.0804 train_time:618046ms step_avg:370.09ms
step:1681/1750 train_loss:3.2969 train_time:618445ms step_avg:370.10ms
step:1682/1750 train_loss:3.2816 train_time:618845ms step_avg:370.12ms
step:1683/1750 train_loss:3.2971 train_time:619237ms step_avg:370.14ms
step:1684/1750 train_loss:3.3402 train_time:619625ms step_avg:370.15ms
step:1685/1750 train_loss:3.2379 train_time:620012ms step_avg:370.16ms
step:1686/1750 train_loss:3.3669 train_time:620407ms step_avg:370.17ms
step:1687/1750 train_loss:3.2385 train_time:620803ms step_avg:370.19ms
step:1688/1750 train_loss:3.3157 train_time:621212ms step_avg:370.21ms
step:1689/1750 train_loss:3.2203 train_time:621613ms step_avg:370.23ms
step:1690/1750 train_loss:3.0702 train_time:622014ms step_avg:370.25ms
step:1691/1750 train_loss:3.3037 train_time:622405ms step_avg:370.26ms
step:1692/1750 train_loss:3.2921 train_time:622794ms step_avg:370.27ms
step:1693/1750 train_loss:3.2082 train_time:623183ms step_avg:370.28ms
step:1694/1750 train_loss:3.6107 train_time:623586ms step_avg:370.30ms
step:1695/1750 train_loss:3.3294 train_time:623988ms step_avg:370.32ms
step:1696/1750 train_loss:3.3324 train_time:624381ms step_avg:370.33ms
step:1697/1750 train_loss:3.2508 train_time:624765ms step_avg:370.34ms
step:1698/1750 train_loss:3.1263 train_time:625154ms step_avg:370.35ms
step:1699/1750 train_loss:3.2294 train_time:625547ms step_avg:370.37ms
step:1700/1750 train_loss:3.2404 train_time:625986ms step_avg:370.41ms
step:1701/1750 train_loss:3.3173 train_time:626440ms step_avg:370.46ms
step:1702/1750 train_loss:3.2394 train_time:626827ms step_avg:370.46ms
step:1703/1750 train_loss:3.4153 train_time:627210ms step_avg:370.47ms
step:1704/1750 train_loss:3.2040 train_time:627595ms step_avg:370.48ms
step:1705/1750 train_loss:3.4317 train_time:627978ms step_avg:370.49ms
step:1706/1750 train_loss:3.2489 train_time:628361ms step_avg:370.50ms
step:1707/1750 train_loss:3.0513 train_time:628756ms step_avg:370.51ms
step:1708/1750 train_loss:3.3895 train_time:629145ms step_avg:370.52ms
step:1709/1750 train_loss:3.2972 train_time:629665ms step_avg:370.61ms
step:1710/1750 train_loss:3.2788 train_time:630078ms step_avg:370.63ms
step:1711/1750 train_loss:3.2794 train_time:630476ms step_avg:370.65ms
step:1712/1750 train_loss:3.3170 train_time:630873ms step_avg:370.67ms
step:1713/1750 train_loss:3.3304 train_time:631267ms step_avg:370.68ms
step:1714/1750 train_loss:3.2245 train_time:631671ms step_avg:370.70ms
step:1715/1750 train_loss:3.2831 train_time:632093ms step_avg:370.73ms
step:1716/1750 train_loss:3.0957 train_time:632480ms step_avg:370.74ms
step:1717/1750 train_loss:3.2437 train_time:632859ms step_avg:370.74ms
step:1718/1750 train_loss:3.2596 train_time:633249ms step_avg:370.75ms
step:1719/1750 train_loss:3.2136 train_time:633646ms step_avg:370.77ms
step:1720/1750 train_loss:3.3746 train_time:634055ms step_avg:370.79ms
step:1721/1750 train_loss:3.1587 train_time:634489ms step_avg:370.83ms
step:1722/1750 train_loss:3.3140 train_time:634884ms step_avg:370.84ms
step:1723/1750 train_loss:3.4015 train_time:635296ms step_avg:370.87ms
step:1724/1750 train_loss:3.2571 train_time:635690ms step_avg:370.88ms
step:1725/1750 train_loss:3.4836 train_time:636097ms step_avg:370.90ms
step:1726/1750 train_loss:3.2545 train_time:636505ms step_avg:370.92ms
step:1727/1750 train_loss:3.3317 train_time:636890ms step_avg:370.93ms
step:1728/1750 train_loss:3.2914 train_time:637282ms step_avg:370.94ms
step:1729/1750 train_loss:3.2711 train_time:637683ms step_avg:370.96ms
step:1730/1750 train_loss:3.6486 train_time:638083ms step_avg:370.98ms
step:1731/1750 train_loss:3.2926 train_time:638475ms step_avg:370.99ms
step:1732/1750 train_loss:3.4293 train_time:638870ms step_avg:371.00ms
step:1733/1750 train_loss:3.2034 train_time:639251ms step_avg:371.01ms
step:1734/1750 train_loss:3.2449 train_time:639640ms step_avg:371.02ms
step:1735/1750 train_loss:3.2722 train_time:640037ms step_avg:371.04ms
step:1736/1750 train_loss:3.2533 train_time:640438ms step_avg:371.05ms
step:1737/1750 train_loss:3.3864 train_time:640841ms step_avg:371.07ms
step:1738/1750 train_loss:3.2128 train_time:641260ms step_avg:371.10ms
step:1739/1750 train_loss:3.2847 train_time:641667ms step_avg:371.12ms
step:1740/1750 train_loss:3.3656 train_time:642066ms step_avg:371.14ms
step:1741/1750 train_loss:3.1629 train_time:642458ms step_avg:371.15ms
step:1742/1750 train_loss:3.0566 train_time:642855ms step_avg:371.16ms
step:1743/1750 train_loss:2.9519 train_time:643268ms step_avg:371.19ms
step:1744/1750 train_loss:3.2898 train_time:643658ms step_avg:371.20ms
step:1745/1750 train_loss:3.3116 train_time:644043ms step_avg:371.21ms
step:1746/1750 train_loss:3.2678 train_time:644430ms step_avg:371.22ms
step:1747/1750 train_loss:3.2927 train_time:644836ms step_avg:371.24ms
step:1748/1750 train_loss:3.4960 train_time:645259ms step_avg:371.26ms
step:1749/1750 train_loss:3.2281 train_time:645656ms step_avg:371.28ms
step:1750/1750 train_loss:3.2792 train_time:646064ms step_avg:371.30ms
step:1750/1750 val_loss:3.2787 train_time:646180ms step_avg:371.37ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.36914 | frobenius_norm = 68410.21094 | spectral_norm = 12085.99512 | nuclear_norm = 1723574.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 191.27422 | spectral_norm = 39.78389 | nuclear_norm = 4363.43213
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 187.17021 | spectral_norm = 41.36109 | nuclear_norm = 4263.62988
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 412.90265 | spectral_norm = 26.88121 | nuclear_norm = 10195.99414
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 278.39648 | spectral_norm = 32.34588 | nuclear_norm = 6332.41406
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 430.51688 | spectral_norm = 38.58761 | nuclear_norm = 11423.04590
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 210.60902 | spectral_norm = 19.60922 | nuclear_norm = 5556.54053
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 198.25946 | spectral_norm = 22.14097 | nuclear_norm = 4559.53320
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 194.45483 | spectral_norm = 20.16693 | nuclear_norm = 4491.80469
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 408.53784 | spectral_norm = 38.45802 | nuclear_norm = 9319.52930
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 412.21805 | spectral_norm = 32.70947 | nuclear_norm = 9612.68555
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 422.55634 | spectral_norm = 33.73230 | nuclear_norm = 11241.68945
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 207.96016 | spectral_norm = 22.43430 | nuclear_norm = 5458.99756
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 183.98946 | spectral_norm = 18.58748 | nuclear_norm = 4017.09619
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 185.56883 | spectral_norm = 17.56179 | nuclear_norm = 4063.12573
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 437.41241 | spectral_norm = 40.90441 | nuclear_norm = 9986.46582
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 443.82632 | spectral_norm = 35.71804 | nuclear_norm = 10419.00000
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 427.77591 | spectral_norm = 39.55608 | nuclear_norm = 11378.19629
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 208.89671 | spectral_norm = 21.69152 | nuclear_norm = 5501.15430
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 192.44003 | spectral_norm = 21.01059 | nuclear_norm = 4408.92090
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 191.16319 | spectral_norm = 19.80183 | nuclear_norm = 4402.22705
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 456.55600 | spectral_norm = 39.32854 | nuclear_norm = 10467.81055
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 459.38464 | spectral_norm = 36.67145 | nuclear_norm = 10751.65039
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 433.67633 | spectral_norm = 40.88432 | nuclear_norm = 11505.95215
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 213.38654 | spectral_norm = 21.64533 | nuclear_norm = 5605.48145
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 192.22583 | spectral_norm = 20.65179 | nuclear_norm = 4391.07715
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 191.52344 | spectral_norm = 19.55867 | nuclear_norm = 4410.22656
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 473.11285 | spectral_norm = 40.94595 | nuclear_norm = 10861.22070
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 466.03848 | spectral_norm = 34.37766 | nuclear_norm = 10979.70508
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 431.08374 | spectral_norm = 35.98356 | nuclear_norm = 11446.25977
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 213.39169 | spectral_norm = 21.01428 | nuclear_norm = 5616.26270
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 187.66164 | spectral_norm = 19.19526 | nuclear_norm = 4220.91211
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 187.05997 | spectral_norm = 18.35016 | nuclear_norm = 4235.76270
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 479.16116 | spectral_norm = 41.96134 | nuclear_norm = 10956.44824
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 460.88568 | spectral_norm = 33.99030 | nuclear_norm = 10929.74609
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 437.54141 | spectral_norm = 34.18586 | nuclear_norm = 11675.43750
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 211.19489 | spectral_norm = 19.73141 | nuclear_norm = 5569.07422
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 184.91542 | spectral_norm = 21.18046 | nuclear_norm = 4165.59375
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 180.49117 | spectral_norm = 19.94477 | nuclear_norm = 4118.81445
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 460.62805 | spectral_norm = 38.92578 | nuclear_norm = 10708.67676
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 451.31879 | spectral_norm = 33.17831 | nuclear_norm = 10624.50879
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 435.38272 | spectral_norm = 31.36304 | nuclear_norm = 11618.07324
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 214.72630 | spectral_norm = 21.74537 | nuclear_norm = 5656.99854
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 192.41699 | spectral_norm = 19.31761 | nuclear_norm = 4349.71143
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 190.73587 | spectral_norm = 18.58384 | nuclear_norm = 4337.18115
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 490.95200 | spectral_norm = 43.90828 | nuclear_norm = 11134.02734
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 464.43036 | spectral_norm = 35.92775 | nuclear_norm = 10918.62988
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 428.17780 | spectral_norm = 35.30185 | nuclear_norm = 11394.57617
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 215.69104 | spectral_norm = 21.92492 | nuclear_norm = 5683.05908
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 190.51003 | spectral_norm = 20.14523 | nuclear_norm = 4254.13281
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 189.53828 | spectral_norm = 18.18300 | nuclear_norm = 4207.34473
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 479.80981 | spectral_norm = 42.28001 | nuclear_norm = 10893.40430
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 464.37668 | spectral_norm = 33.72896 | nuclear_norm = 10864.73047
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 434.17462 | spectral_norm = 38.28603 | nuclear_norm = 11511.55664
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 218.50185 | spectral_norm = 22.85755 | nuclear_norm = 5769.46387
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 196.49191 | spectral_norm = 20.45759 | nuclear_norm = 4379.90625
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 195.89175 | spectral_norm = 19.74741 | nuclear_norm = 4331.24707
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 499.34836 | spectral_norm = 52.33819 | nuclear_norm = 11433.80469
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 473.26096 | spectral_norm = 33.89812 | nuclear_norm = 11135.38281
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 423.06958 | spectral_norm = 36.52145 | nuclear_norm = 11232.31445
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 220.02812 | spectral_norm = 22.57092 | nuclear_norm = 5842.42773
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 196.09853 | spectral_norm = 20.91579 | nuclear_norm = 4349.49512
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 194.57848 | spectral_norm = 20.84132 | nuclear_norm = 4275.50830
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 472.56433 | spectral_norm = 46.65171 | nuclear_norm = 10834.31543
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 459.70364 | spectral_norm = 32.73092 | nuclear_norm = 10783.93359
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 442.10391 | spectral_norm = 34.15304 | nuclear_norm = 11773.93555
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 215.33101 | spectral_norm = 25.33122 | nuclear_norm = 5704.58008
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 192.93727 | spectral_norm = 26.20560 | nuclear_norm = 4213.59863
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 187.49850 | spectral_norm = 24.04490 | nuclear_norm = 4066.36499
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 428.51108 | spectral_norm = 53.87095 | nuclear_norm = 9701.16016
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 470.41867 | spectral_norm = 34.52280 | nuclear_norm = 10892.44922
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 459.38007 | spectral_norm = 36.30548 | nuclear_norm = 12204.61719
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 218.74870 | spectral_norm = 28.21177 | nuclear_norm = 5732.38818
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1324.18250 | spectral_norm = 173.87061 | nuclear_norm = 35068.33594
===========================================

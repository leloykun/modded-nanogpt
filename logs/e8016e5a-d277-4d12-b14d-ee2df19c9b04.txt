====================================================================================================
import os
import sys
with open(sys.argv[0]) as f:
    code = f.read() # read the code of this file ASAP, for logging
import uuid
import glob
import time
from dataclasses import dataclass

import numpy as np
import torch
from torch import nn
import torch.nn.functional as F
import torch.distributed as dist
import torch._inductor.config as config
from torch.nn.parallel import DistributedDataParallel as DDP
# Use of FlexAttention contributed by @KoszarskyB
from torch.nn.attention.flex_attention import flex_attention, create_block_mask, BlockMask, _score_mod_signature
from torch._inductor.lowering import make_pointwise, register_lowering
# Some internal torch.compile details
from torch._inductor.virtualized import ops
from functools import partial
flex_attention = torch.compile(flex_attention, dynamic=False)
create_block_mask = torch.compile(create_block_mask, dynamic=False)

# -----------------------------------------------------------------------------
# Muon optimizer

def zeropower_via_svd(G, steps=None):
    U, S, V = G.svd()
    return U @ V.T

@torch.compile
def zeropower_via_newtonschulz5(G, steps=10, eps=1e-7):
    """
    Newton-Schulz iteration to compute the zeroth power / orthogonalization of G. We opt to use a
    quintic iteration whose coefficients are selected to maximize the slope at zero. For the purpose
    of minimizing steps, it turns out to be empirically effective to keep increasing the slope at
    zero even beyond the point where the iteration no longer converges all the way to one everywhere
    on the interval. This iteration therefore does not produce UV^T but rather something like US'V^T
    where S' is diagonal with S_{ii}' ~ Uniform(0.5, 1.5), which turns out not to hurt model
    performance at all relative to UV^T, where USV^T = G is the SVD.
    """
    assert len(G.shape) == 2
    a, b, c = (3.4445, -4.7750,  2.0315)
    X = G.bfloat16()
    X /= (X.norm() + eps) # ensure top singular value <= 1
    if G.size(0) > G.size(1):
        X = X.T
    for _ in range(steps):
        A = X @ X.T
        B = b * A + c * A @ A # adapted from suggestion by @jxbz, @leloykun, and @YouJiacheng
        X = a * X + B @ X
    if G.size(0) > G.size(1):
        X = X.T
    return X

zeropower_backends = dict(svd=zeropower_via_svd, newtonschulz5=zeropower_via_newtonschulz5)

class Muon(torch.optim.Optimizer):
    """
    Muon - MomentUm Orthogonalized by Newton-schulz

    Muon internally runs standard SGD-momentum, and then performs an orthogonalization post-
    processing step, in which each 2D parameter's update is replaced with the nearest orthogonal
    matrix. To efficiently orthogonalize each update, we use a Newton-Schulz iteration, which has
    the advantage that it can be stably run in bfloat16 on the GPU.

    Some warnings:
    - This optimizer assumes that all parameters passed in are 2D.
    - It should not be used for the embedding layer, the final fully connected layer, or any {0,1}-D
    parameters; those should all be optimized by a standard method (e.g., AdamW).
    - To use it with 4D convolutional filters, it works well to just flatten their last 3 dimensions.
    - We believe it is unlikely to work well for training with small batch size.
    - We believe it may not work well for finetuning pretrained models, but we haven't tested this.
    - We have not yet tried this optimizer for training scenarios larger than NanoGPT (124M).

    Arguments:
        lr: The learning rate used by the internal SGD.
        momentum: The momentum used by the internal SGD.
        nesterov: Whether to use Nesterov-style momentum in the internal SGD. (recommended)
        backend: The chosen backend for the orthogonalization step. (recommended: 'newtonschulz5')
        backend_steps: The number of iteration steps to use in the backend, if it is iterative.
    """
    def __init__(self, params, lr=0.02, momentum=0.95, nesterov=True,
                 backend='newtonschulz5', backend_steps=5):
        defaults = dict(lr=lr, momentum=momentum, nesterov=nesterov, backend=backend, backend_steps=backend_steps)
        super().__init__(params, defaults)

    def step(self):

        for group in self.param_groups:

            lr = group['lr']
            momentum = group['momentum']
            zeropower_backend = zeropower_backends[group['backend']]

            # generate weight updates in distributed fashion
            total_params = sum(p.numel() for p in group['params'])
            updates_flat = torch.zeros(total_params, device='cuda', dtype=torch.bfloat16)
            curr_idx = 0
            for i, p in enumerate(group['params']):
                # luckily this will perfectly distribute a transformer with multiple of 4 layers to 8 GPUs
                if i % int(os.environ['WORLD_SIZE']) == int(os.environ['RANK']):
                    g = p.grad
                    assert g is not None
                    state = self.state[p]
                    if 'momentum_buffer' not in state:
                        state['momentum_buffer'] = torch.zeros_like(g)
                    buf = state['momentum_buffer']
                    buf.mul_(momentum).add_(g)
                    if group['nesterov']:
                        g = g.add(buf, alpha=momentum)
                    g = zeropower_backend(g, steps=group['backend_steps'])
                    g *= max(1, g.size(0)/g.size(1))**0.5
                    updates_flat[curr_idx:curr_idx+p.numel()] = g.flatten()
                curr_idx += p.numel()

            # sync updates across devices. we are not memory-constrained so can do this simple deserialization
            dist.all_reduce(updates_flat, op=dist.ReduceOp.SUM)

            # deserialize and apply updates
            curr_idx = 0
            for p in group['params']:
                g = updates_flat[curr_idx:curr_idx+p.numel()].view_as(p.data).type_as(p.data)
                p.data.add_(g, alpha=-lr)
                curr_idx += p.numel()

# -----------------------------------------------------------------------------
# Attention Tanh softcapping

@torch.library.custom_op("approx::tanh", mutates_args=())
def _tanh_approx(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

@_tanh_approx.register_fake
def _(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

def _tanh_approx_lowering(inp):
    fn = partial(ops.inline_asm_elementwise, asm="tanh.approx.f32 $0, $1;")
    return make_pointwise(fn)(inp)

register_lowering(torch.ops.approx.tanh)(_tanh_approx_lowering)

class _TanhApprox(torch.autograd.Function):
    @staticmethod
    def forward(x):
        return torch.ops.approx.tanh(x)

    @staticmethod
    def setup_context(ctx, inputs, output):
        (x,) = inputs
        result = output
        ctx.save_for_backward(result)

    @staticmethod
    def backward(ctx, grad_output):
        (result,) = ctx.saved_tensors
        return grad_output * (1 - result * result)

    @staticmethod
    def vmap(info, in_dims, x):
        return torch.tanh(x), 0

_tanh_approx = _TanhApprox.apply

def generate_tanh_softcap(soft_cap: int, approx: bool=True) -> _score_mod_signature:
    tanh = _tanh_approx if approx else torch.tanh

    def tanh_softcap(score, b, h, q_idx, kv_idx):
        return soft_cap * tanh(score / soft_cap)

    prefix = "tanh_softcap_approx" if approx else "tanh_softcap"
    tanh_softcap.__name__ = f"{prefix}_{soft_cap}"

    return tanh_softcap

# -----------------------------------------------------------------------------
# PyTorch nn.Module definitions for the GPT-2 model

class Rotary(torch.nn.Module):

    def __init__(self, dim, base=10000):
        super().__init__()
        self.dim = dim
        self.base = base
        self.inv_freq = None
        self.seq_len_cached = None
        self.cos_cached = None
        self.sin_cached = None

    def forward(self, x):
        seq_len = x.shape[1]
        if seq_len != self.seq_len_cached:
            self.inv_freq = 1.0 / (self.base ** (torch.arange(0, self.dim, 2, device=x.device).float() / self.dim))
            self.seq_len_cached = seq_len
            t = torch.arange(seq_len, device=x.device).type_as(self.inv_freq)
            freqs = torch.outer(t, self.inv_freq)
            self.cos_cached = freqs.cos().bfloat16()
            self.sin_cached = freqs.sin().bfloat16()
        return self.cos_cached[None, :, None, :], self.sin_cached[None, :, None, :]

def apply_rotary_emb(x, cos, sin):
    assert x.ndim == 4 # multihead attention
    d = x.shape[3]//2
    x1 = x[..., :d]
    x2 = x[..., d:]
    y1 = x1 * cos + x2 * sin
    y2 = x1 * (-sin) + x2 * cos
    return torch.cat([y1, y2], 3).type_as(x)

class CastedLinear(nn.Linear):
    def forward(self, x):
        return F.linear(x, self.weight.to(x.dtype))

class CausalSelfAttention(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.n_head = config.n_head
        self.n_embd = config.n_embd
        self.head_dim = self.n_embd // self.n_head
        assert self.n_embd % self.n_head == 0
        self.c_q = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_k = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_v = CastedLinear(self.n_embd, self.n_embd, bias=False)
        # output projection
        self.c_proj = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977
        self.rotary = Rotary(self.head_dim)
        self.lamb = nn.Parameter(torch.tensor(0.5)) # @Grad62304977

    def forward(self, x, v1, block_mask: BlockMask, score_mod: _score_mod_signature):
        B, T, C = x.size() # batch size, sequence length, embedding dimensionality (n_embd)
        q = self.c_q(x).view(B, T, self.n_head, self.head_dim)
        k = self.c_k(x).view(B, T, self.n_head, self.head_dim)
        v = self.c_v(x).view(B, T, self.n_head, self.head_dim)
        if v1 is None:
            v1 = v # This happens if we are in the first block. v needs to be accessed by subsequent blocks
        v = (1 - self.lamb) * v + self.lamb * v1.view_as(v) # @Grad62304977
        cos, sin = self.rotary(q)
        q, k = F.rms_norm(q, (q.size(-1),)), F.rms_norm(k, (k.size(-1),)) # QK norm suggested by @Grad62304977
        q, k = apply_rotary_emb(q, cos, sin), apply_rotary_emb(k, cos, sin)
        y = flex_attention(q.transpose(1, 2), k.transpose(1, 2), v.transpose(1, 2), score_mod=score_mod, block_mask=block_mask)
        y = y.transpose(1, 2).contiguous().view_as(x) # re-assemble all head outputs side by side
        y = self.c_proj(y)
        return y, v1

class MLP(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.c_fc    = CastedLinear(config.n_embd, 4 * config.n_embd, bias=False)
        self.c_proj  = CastedLinear(4 * config.n_embd, config.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977

    def forward(self, x):
        x = self.c_fc(x)
        x = F.relu(x).square() # https://arxiv.org/abs/2109.08668v2; ~1-2% better than GELU; suggested by @SKYLINEZ007 and @Grad62304977
        x = self.c_proj(x)
        return x

class Block(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.attn = CausalSelfAttention(config)
        self.mlp = MLP(config)
        self.lambdas = nn.Parameter(torch.tensor([1., 0.]))

    def forward(self, x, v1, x0, block_mask: BlockMask, score_mod: _score_mod_signature):
        x = self.lambdas[0] * x + self.lambdas[1] * x0
        x1, v1 = self.attn(F.rms_norm(x, (x.size(-1),)), v1, block_mask, score_mod)
        x = x + x1
        x = x + self.mlp(F.rms_norm(x, (x.size(-1),)))
        return x, v1

# -----------------------------------------------------------------------------
# The main GPT-2 model

@dataclass
class GPTConfig:
    vocab_size : int = 50304
    n_layer : int = 12
    n_head : int = 6 # head dim 128 suggested by @Grad62304977
    n_embd : int = 768
    attention_soft_cap : int = 50
    lm_head_soft_cap : int = 30

class GPT(nn.Module):

    def __init__(self, config: GPTConfig):
        super().__init__()
        self.attention_soft_cap = config.attention_soft_cap
        self.lm_head_soft_cap = config.lm_head_soft_cap

        # U-net design by @brendanh0gan
        self.num_encoder_layers = config.n_layer // 2 # Half of the layers for encoder
        self.num_decoder_layers = config.n_layer - self.num_encoder_layers # Remaining for decoder
        # Add learnable skip connection weights for decoder layers
        self.skip_weights = nn.Parameter(torch.ones(self.num_decoder_layers))

        self.transformer = nn.ModuleDict(dict(
            wte = nn.Embedding(config.vocab_size, config.n_embd),
            h = nn.ModuleList([Block(config) for _ in range(config.n_layer)]),
        ))
        self.lm_head = CastedLinear(config.n_embd, config.vocab_size, bias=False)
        self.lm_head.weight.data.zero_() # @Grad62304977

    def forward(self, idx, target, attn_blocksize: int):

        docs = (idx == 50256).cumsum(0)
        def document_causal_mask(b, h, q_idx, kv_idx):
            causal_mask = q_idx >= kv_idx
            document_mask = docs[q_idx] == docs[kv_idx]
            window_mask = q_idx - kv_idx < attn_blocksize
            return causal_mask & document_mask & window_mask

        softcap_mod = generate_tanh_softcap(self.attention_soft_cap, approx=True)  # @leloykun

        S = len(idx)
        block_mask = create_block_mask(document_causal_mask, None, None, S, S, device="cuda", _compile=True)

        # forward the GPT model itself
        x = self.transformer.wte(idx[None]) # token embeddings of shape (b, t, n_embd)
        x = F.rms_norm(x, (x.size(-1),)) # @Grad62304977
        x0 = x
        v1 = None

        # Store outputs for U-Net skip connections
        skip_connections = []
        # Encoder pass - process only the first half of the blocks
        for i in range(self.num_encoder_layers):
            x, v1 = self.transformer.h[i](x, v1, x0, block_mask, softcap_mod)
            skip_connections.append(x)
        # Decoder pass - process the remaining blocks with weighted skip connections
        for i in range(self.num_decoder_layers):
            x = x + self.skip_weights[i] * skip_connections.pop()
            x, v1 = self.transformer.h[self.num_encoder_layers + i](x, v1, x0, block_mask, softcap_mod)

        x = F.rms_norm(x, (x.size(-1),))
        logits = self.lm_head(x)
        logits = self.lm_head_soft_cap * torch.tanh(logits / self.lm_head_soft_cap) # @Grad62304977
        logits = logits.float()
        loss = F.cross_entropy(logits.view(-1, logits.size(-1)), target.view(-1))
        return loss

# -----------------------------------------------------------------------------
# Our own simple Distributed Data Loader

def _peek_data_shard(filename):
    # only reads the header, returns header data
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
    if header[0] != 20240520:
        print("ERROR: magic number mismatch in the data .bin file!")
        print("---> HINT: Are you passing in a correct file with --input_bin?")
        print("---> HINT: Dataset encoding changed recently, re-run data prepro or refer again to README")
        print("---> HINT: For example re-run: `python dev/data/tinyshakespeare.py`, then re-try")
        exit(1)
    assert header[1] == 1, "unsupported version"
    ntok = header[2] # number of tokens (claimed)
    return ntok # for now just return the number of tokens

def _load_data_shard(filename):
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
        assert header[0] == 20240520, "magic number mismatch in the data .bin file"
        assert header[1] == 1, "unsupported version"
        ntok = header[2] # number of tokens (claimed)
        # the rest of it are tokens, stored as uint16
        tokens = np.frombuffer(f.read(), dtype=np.uint16)
    assert len(tokens) == ntok, "number of tokens read does not match header?"
    return tokens

class DistributedDataLoader:
    def __init__(self, filename_pattern, B, T, process_rank, num_processes):
        self.process_rank = process_rank
        self.num_processes = num_processes
        self.B = B
        self.T = T

        # glob files that match the pattern
        self.files = sorted(glob.glob(filename_pattern))
        assert len(self.files) > 0, f"did not find any files that match the pattern {filename_pattern}"

        # load and validate all data shards, count number of tokens in total
        ntok_total = 0
        for fname in self.files:
            shard_ntok = _peek_data_shard(fname)
            assert shard_ntok >= num_processes * B * T + 1
            ntok_total += int(shard_ntok)
        self.ntok_total = ntok_total

        self.reset()

    def reset(self):
        self.current_shard = -1
        self.advance()

    def advance(self): # advance to next data shard
        self.current_shard = (self.current_shard + 1) % len(self.files)
        self.current_position = self.process_rank * self.B * self.T
        self.tokens = _load_data_shard(self.files[self.current_shard])

    def next_batch(self):
        batch_size = self.B * self.T * self.num_processes
        buf = self.tokens[self.current_position:self.current_position+self.B*self.T+1]
        buf = torch.tensor(buf.astype(np.int32), dtype=torch.long)
        x = buf[:-1] # inputs
        y = buf[1:] # targets
        # advance current position and load next shard if necessary
        self.current_position += batch_size
        if self.current_position + batch_size >= len(self.tokens):
            self.advance()
        return x.cuda(), y.cuda()

# -----------------------------------------------------------------------------
# int main

@dataclass
class Hyperparameters:
    # data hyperparams
    input_bin : str = 'data/fineweb10B/fineweb_train_*.bin' # input .bin to train on
    input_val_bin : str = 'data/fineweb10B/fineweb_val_*.bin' # input .bin to eval validation loss on
    # optimization hyperparams
    batch_size : int = 8 # batch size, in sequences, across all devices
    device_batch_size : int = 1 # batch size, in sequences, per device
    sequence_length : int = 64*1024 # sequence length, in tokens
    num_iterations : int = 1750 # number of iterations to run
    warmup_iters : int = 0
    cooldown_iters : int = 640 # number of iterations of linear warmup/cooldown for triangular or trapezoidal schedule
    weight_decay : float = 0
    # evaluation and logging hyperparams
    val_loss_every : int = 125 # every how many steps to evaluate val loss? 0 for only at the end
    val_tokens : int = 10485760 # how many tokens of validation data? it's important to keep this fixed for consistent comparisons
    save_every : int = 0 # every how many steps to save the checkpoint? 0 for only at the end
args = Hyperparameters()

# set up DDP (distributed data parallel). torchrun sets this env variable
assert torch.cuda.is_available()
dist.init_process_group(backend='nccl')
ddp_rank = int(os.environ['RANK'])
ddp_local_rank = int(os.environ['LOCAL_RANK'])
ddp_world_size = int(os.environ['WORLD_SIZE'])
device = f'cuda:{ddp_local_rank}'
torch.cuda.set_device(device)
print(f"using device: {device}")
master_process = (ddp_rank == 0) # this process will do logging, checkpointing etc.

# begin logging
logfile = None
if master_process:
    run_id = str(uuid.uuid4())
    logdir = 'logs/%s/' % run_id
    os.makedirs(logdir, exist_ok=True)
    logfile = 'logs/%s.txt' % run_id
    # create the log file
    with open(logfile, "w") as f:
        # begin the log by printing this file (the Python code)
        f.write('='*100 + '\n')
        f.write(code)
        f.write('='*100 + '\n')
def print0(s, logonly=False):
    if master_process:
        with open(logfile, "a") as f:
            if not logonly:
                print(s)
            f.write(s+'\n')
# log information about the hardware/software environment this is running on
# and print the full `nvidia-smi` to file
print0(f"Running pytorch {torch.version.__version__} compiled for CUDA {torch.version.cuda}\nnvidia-smi:")
import subprocess
result = subprocess.run(['nvidia-smi'], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
print0(f'{result.stdout}', logonly=True)
print0('='*100, logonly=True)

# convenience variables
B, T = args.device_batch_size, args.sequence_length
# calculate the number of steps to take in the val loop.
assert args.val_tokens % (B * T * ddp_world_size) == 0
val_steps = args.val_tokens // (B * T * ddp_world_size)
# calculate the steps of gradient accumulation required to attain the desired global batch size.
assert args.batch_size % (B * ddp_world_size) == 0
train_accumulation_steps = args.batch_size // (B * ddp_world_size)

# load tokens
train_loader = DistributedDataLoader(args.input_bin, B, T, ddp_rank, ddp_world_size)
val_loader = DistributedDataLoader(args.input_val_bin, B, T, ddp_rank, ddp_world_size)
print0(f"Training DataLoader: total number of tokens: {train_loader.ntok_total} across {len(train_loader.files)} files")
print0(f"Validation DataLoader: total number of tokens: {val_loader.ntok_total} across {len(val_loader.files)} files")
print0('='*100, logonly=True)
x, y = train_loader.next_batch()

# there are only 50257 unique GPT-2 tokens; we extend to nearest multiple of 128 for efficiency. suggested to me by @Grad62304977.
# this originates from Karpathy's experiments.
num_vocab = 50304
model = GPT(GPTConfig(vocab_size=num_vocab, n_layer=12, n_head=6, n_embd=768))
model = model.cuda().bfloat16()
for m in model.modules():
    if isinstance(m, CastedLinear):
        m.float()
if hasattr(config, "coordinate_descent_tuning"):
    config.coordinate_descent_tuning = True # suggested by @Chillee
model = torch.compile(model)
# here we wrap model into DDP container
model = DDP(model, device_ids=[ddp_local_rank])
raw_model = model.module # always contains the "raw" unwrapped model

# CUDNN attention is ~4ms faster than Flash, but doesn't get selected by default in PyTorch 2.5.1
from torch.backends.cuda import enable_cudnn_sdp, enable_flash_sdp, enable_math_sdp, enable_mem_efficient_sdp
enable_cudnn_sdp(True)
enable_flash_sdp(False)
enable_mem_efficient_sdp(False)
enable_math_sdp(False)

# init the optimizer(s)
optimizer1 = torch.optim.Adam([raw_model.transformer.wte.weight], lr=0.6,   betas=(0.8, 0.95), fused=True)
optimizer2 = torch.optim.Adam([raw_model.lm_head.weight],         lr=0.008, betas=(0.8, 0.95), fused=True)
param_names = [name for name, _ in raw_model.named_parameters()]
params = list(raw_model.transformer.h.parameters())
qk_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and ("c_q" in n or "c_k" in n)]
matrix_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and "c_q" not in n and "c_k" not in n]
scalar_params = [p for p in params if p.ndim < 2] + [raw_model.skip_weights]
optimizer5 = Muon(qk_params, lr=0.065, momentum=0.95)
optimizer3 = Muon(matrix_params, lr=0.05, momentum=0.95)
optimizer4 = torch.optim.Adam(scalar_params, lr=0.04, betas=(0.8, 0.95), fused=True) # note that this learning rate is neither sensitive nor tuned
optimizers = [optimizer1, optimizer2, optimizer3, optimizer4, optimizer5]
# learning rate decay scheduler (linear warmup and cooldown)
def get_lr(it):
    assert it <= args.num_iterations
    # 1) linear warmup for warmup_iters steps
    if it < args.warmup_iters:
        return (it+1) / args.warmup_iters
    # 2) constant lr for a while
    elif it < args.num_iterations - args.cooldown_iters:
        return 1.0
    # 3) linear cooldown
    else:
        decay_ratio = (args.num_iterations - it) / args.cooldown_iters
        return decay_ratio
schedulers = [torch.optim.lr_scheduler.LambdaLR(opt, get_lr) for opt in optimizers]

# Start training loop
training_time_ms = 0
# start the clock
torch.cuda.synchronize()
t0 = time.time()
# begin training
for step in range(args.num_iterations + 1):
    last_step = (step == args.num_iterations)
    # Set the attention blocksize for the current step, in chunks of 64
    attn_blocksize = torch.tensor(64*((step/args.num_iterations * (1792 - 64) + 64)//64), dtype=torch.int, device='cuda')
    # This effectively ignores timing first 10 steps, which are slower for weird reasons.
    # Alternately, and slightly more correctly in terms of benchmarking, we could do 10
    # steps with dummy data first, and then re-initialize the model and reset the loader.
    if step == 10:
        training_time_ms = 0
        t0 = time.time()
    timed_steps = float('nan') if step <= 11 else (step - 10) + 1 # <= 11 to avoid bug in val

    # once in a while evaluate the validation dataset
    if (last_step or (args.val_loss_every > 0 and step % args.val_loss_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # run validation batches
        model.eval()
        val_loader.reset()
        val_loss = 0.0
        for _ in range(val_steps):
            with torch.no_grad():
                x_val, y_val = val_loader.next_batch()
                val_loss += model(x_val, y_val, attn_blocksize=attn_blocksize)
        dist.all_reduce(val_loss, op=dist.ReduceOp.AVG)
        val_loss /= val_steps
        # log val loss to console and to logfile
        print0(f'step:{step}/{args.num_iterations} val_loss:{val_loss:.4f} train_time:{training_time_ms:.0f}ms step_avg:{training_time_ms/(timed_steps-1):.2f}ms')
        if master_process:
            print("============== Weight norms: ==============")
            with open(logfile, "a") as f:
                f.write("============== Weight norms: ==============\n")
                for name, p in model.named_parameters():
                    if p.ndim != 2:
                        continue
                    if "transformer.wte" in name:
                        l1_to_l2_norm = torch.norm(p.data.float(), p=2, dim=1).mean().item()
                    frobenius_norm = torch.linalg.norm(p.data.float(), ord='fro').item()
                    spectral_norm = torch.linalg.matrix_norm(p.data.float(), ord=2).item()
                    nuclear_norm = torch.linalg.matrix_norm(p.data.float(), ord="nuc").item()
                    if "transformer.wte" in name:
                        print(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                    else:
                        print(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                f.write("===========================================\n")
            print("===========================================")
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    if master_process and (last_step or (args.save_every > 0 and step % args.save_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # save the state of the training process
        log = dict(step=step, code=code, model=raw_model.state_dict(), optimizers=[opt.state_dict() for opt in optimizers])
        torch.save(log, 'logs/%s/state_step%06d.pt' % (run_id, step))
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    # bit confusing: we want to make sure to eval on 0th iteration
    # but also after the very last iteration. so we loop for step <= num_iterations
    # instead of just < num_iterations (one extra due to <=), only to do
    # the validation/sampling one last time, and then we break right here as we're done.
    if last_step:
        break

    # --------------- TRAINING SECTION BEGIN -----------------
    model.train()
    for i in range(1, train_accumulation_steps+1):
        # forward pass
        loss = model(x, y, attn_blocksize=attn_blocksize)
        train_loss = loss.detach()
        # advance the dataset for the next batch
        x, y = train_loader.next_batch()
        # backward pass
        if i < train_accumulation_steps:
            with model.no_sync(): # there's no need to sync gradients every accumulation step
                loss.backward()
        else:
            loss.backward() # just sync on the last step
    for p in model.parameters():
        p.grad /= train_accumulation_steps
    # momentum warmup for Muon
    frac = min(step/300, 1)
    optimizer3.param_groups[0]['momentum'] = (1 - frac) * 0.85 + frac * 0.95
    # step the optimizers and schedulers
    for opt, sched in zip(optimizers, schedulers):
        opt.step()
        sched.step()
    # null the gradients
    model.zero_grad(set_to_none=True)
    # --------------- TRAINING SECTION END -------------------
    # everything that follows now is just diagnostics, prints, logging, etc.

    #dist.all_reduce(train_loss, op=dist.ReduceOp.AVG) # all-reducing the training loss would be more correct in terms of logging, but slower
    approx_time = training_time_ms + 1000 * (time.time() - t0)
    print0(f"step:{step+1}/{args.num_iterations} train_loss:{train_loss.item():.4f} train_time:{approx_time:.0f}ms step_avg:{approx_time/timed_steps:.2f}ms")

if master_process:
    print(f"peak memory consumption: {torch.cuda.max_memory_allocated() // 1024 // 1024} MiB")

# -------------------------------------------------------------------------
# clean up nice
dist.destroy_process_group()
====================================================================================================
Running pytorch 2.6.0.dev20241125+cu124 compiled for CUDA 12.4
nvidia-smi:
Mon Nov 25 14:17:33 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.12             Driver Version: 535.104.12   CUDA Version: 12.4     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  | 00000000:07:00.0 Off |                    0 |
| N/A   32C    P0              65W / 400W |      7MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  | 00000000:0A:00.0 Off |                    0 |
| N/A   29C    P0              68W / 400W |     37MiB / 81920MiB |      2%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  | 00000000:45:00.0 Off |                    0 |
| N/A   29C    P0              70W / 400W |    427MiB / 81920MiB |      1%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  | 00000000:4B:00.0 Off |                    0 |
| N/A   34C    P0              73W / 400W |    427MiB / 81920MiB |      3%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   4  NVIDIA A100-SXM4-80GB          On  | 00000000:84:00.0 Off |                    0 |
| N/A   34C    P0              72W / 400W |    427MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   5  NVIDIA A100-SXM4-80GB          On  | 00000000:8A:00.0 Off |                    0 |
| N/A   29C    P0              69W / 400W |    427MiB / 81920MiB |      2%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   6  NVIDIA A100-SXM4-80GB          On  | 00000000:C0:00.0 Off |                    0 |
| N/A   28C    P0              70W / 400W |    427MiB / 81920MiB |      1%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   7  NVIDIA A100-SXM4-80GB          On  | 00000000:C3:00.0 Off |                    0 |
| N/A   33C    P0              72W / 400W |    427MiB / 81920MiB |      1%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
+---------------------------------------------------------------------------------------+

====================================================================================================
Training DataLoader: total number of tokens: 1100000000 across 11 files
Validation DataLoader: total number of tokens: 100000000 across 1 files
====================================================================================================
step:0/1750 val_loss:10.8258 train_time:0ms step_avg:nanms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 27.70627 | frobenius_norm = 6216.15234 | spectral_norm = 251.61606 | nuclear_norm = 171959.18750
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 15.99451 | spectral_norm = 1.15061 | nuclear_norm = 376.23251
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 15.99167 | spectral_norm = 1.15573 | nuclear_norm = 375.96286
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 15.96612 | spectral_norm = 1.14763 | nuclear_norm = 375.61700
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 32.00156 | spectral_norm = 1.72431 | nuclear_norm = 858.35339
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 16.00692 | spectral_norm = 1.15273 | nuclear_norm = 376.50696
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 16.00254 | spectral_norm = 1.15239 | nuclear_norm = 376.38477
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 15.99264 | spectral_norm = 1.14707 | nuclear_norm = 376.34399
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 32.01458 | spectral_norm = 1.72268 | nuclear_norm = 858.60046
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 16.00483 | spectral_norm = 1.14149 | nuclear_norm = 376.71930
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 16.00044 | spectral_norm = 1.14971 | nuclear_norm = 376.53711
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 16.00834 | spectral_norm = 1.14466 | nuclear_norm = 376.66849
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 31.99455 | spectral_norm = 1.72271 | nuclear_norm = 858.11859
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 15.99440 | spectral_norm = 1.14450 | nuclear_norm = 376.32886
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 16.01114 | spectral_norm = 1.14880 | nuclear_norm = 376.61383
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 16.00313 | spectral_norm = 1.16236 | nuclear_norm = 376.57684
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 31.99350 | spectral_norm = 1.73640 | nuclear_norm = 858.11523
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 15.98816 | spectral_norm = 1.14652 | nuclear_norm = 376.05374
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 15.99710 | spectral_norm = 1.14525 | nuclear_norm = 376.29755
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 15.99871 | spectral_norm = 1.15139 | nuclear_norm = 376.33432
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 31.99239 | spectral_norm = 1.72929 | nuclear_norm = 858.05469
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 16.01461 | spectral_norm = 1.14955 | nuclear_norm = 376.81311
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 15.98047 | spectral_norm = 1.14386 | nuclear_norm = 376.15274
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 15.99487 | spectral_norm = 1.14398 | nuclear_norm = 376.25427
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 31.99157 | spectral_norm = 1.73153 | nuclear_norm = 858.05048
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 15.99123 | spectral_norm = 1.14550 | nuclear_norm = 376.25824
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 15.99072 | spectral_norm = 1.14145 | nuclear_norm = 376.02969
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 16.01693 | spectral_norm = 1.14760 | nuclear_norm = 376.70227
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 31.99243 | spectral_norm = 1.71897 | nuclear_norm = 858.06372
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 16.00313 | spectral_norm = 1.15814 | nuclear_norm = 376.59155
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 16.00467 | spectral_norm = 1.15355 | nuclear_norm = 376.44434
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 15.99660 | spectral_norm = 1.14842 | nuclear_norm = 376.28473
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 31.99133 | spectral_norm = 1.72445 | nuclear_norm = 858.08875
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 16.01282 | spectral_norm = 1.15251 | nuclear_norm = 376.46399
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 15.99402 | spectral_norm = 1.14809 | nuclear_norm = 376.14532
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 16.00342 | spectral_norm = 1.15311 | nuclear_norm = 376.45770
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 32.00145 | spectral_norm = 1.72967 | nuclear_norm = 858.31433
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 16.01192 | spectral_norm = 1.13984 | nuclear_norm = 376.70789
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 16.00256 | spectral_norm = 1.14447 | nuclear_norm = 376.43341
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 15.98606 | spectral_norm = 1.15132 | nuclear_norm = 376.28522
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 32.00650 | spectral_norm = 1.72541 | nuclear_norm = 858.19568
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 16.00789 | spectral_norm = 1.14546 | nuclear_norm = 376.75586
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 16.00618 | spectral_norm = 1.15159 | nuclear_norm = 376.61465
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 15.99678 | spectral_norm = 1.15201 | nuclear_norm = 376.43530
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 32.00154 | spectral_norm = 1.71225 | nuclear_norm = 858.40869
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 15.99576 | spectral_norm = 1.14670 | nuclear_norm = 376.24301
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 15.99763 | spectral_norm = 1.15573 | nuclear_norm = 376.41632
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 16.00724 | spectral_norm = 1.15088 | nuclear_norm = 376.63391
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 31.97764 | spectral_norm = 1.73024 | nuclear_norm = 857.54218
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
===========================================
step:1/1750 train_loss:10.8258 train_time:34465ms step_avg:nanms
step:2/1750 train_loss:10.0669 train_time:35253ms step_avg:nanms
step:3/1750 train_loss:8.3469 train_time:35581ms step_avg:nanms
step:4/1750 train_loss:7.6032 train_time:35911ms step_avg:nanms
step:5/1750 train_loss:7.4714 train_time:36241ms step_avg:nanms
step:6/1750 train_loss:6.9749 train_time:36571ms step_avg:nanms
step:7/1750 train_loss:7.1868 train_time:36902ms step_avg:nanms
step:8/1750 train_loss:6.7242 train_time:37233ms step_avg:nanms
step:9/1750 train_loss:6.6196 train_time:37563ms step_avg:nanms
step:10/1750 train_loss:6.4901 train_time:37894ms step_avg:nanms
step:11/1750 train_loss:6.4982 train_time:248ms step_avg:nanms
step:12/1750 train_loss:6.3316 train_time:579ms step_avg:nanms
step:13/1750 train_loss:6.2633 train_time:909ms step_avg:303.06ms
step:14/1750 train_loss:6.2071 train_time:1241ms step_avg:310.14ms
step:15/1750 train_loss:6.2040 train_time:1571ms step_avg:314.28ms
step:16/1750 train_loss:6.1158 train_time:1902ms step_avg:316.98ms
step:17/1750 train_loss:6.1785 train_time:2233ms step_avg:318.98ms
step:18/1750 train_loss:5.9744 train_time:2564ms step_avg:320.53ms
step:19/1750 train_loss:6.0333 train_time:2896ms step_avg:321.73ms
step:20/1750 train_loss:5.7166 train_time:3226ms step_avg:322.59ms
step:21/1750 train_loss:6.0110 train_time:3557ms step_avg:323.40ms
step:22/1750 train_loss:6.2664 train_time:3888ms step_avg:324.01ms
step:23/1750 train_loss:5.9294 train_time:4220ms step_avg:324.60ms
step:24/1750 train_loss:6.0726 train_time:4551ms step_avg:325.10ms
step:25/1750 train_loss:5.7761 train_time:4883ms step_avg:325.54ms
step:26/1750 train_loss:5.6890 train_time:5214ms step_avg:325.89ms
step:27/1750 train_loss:5.8633 train_time:5545ms step_avg:326.18ms
step:28/1750 train_loss:5.4898 train_time:5875ms step_avg:326.41ms
step:29/1750 train_loss:5.7628 train_time:6206ms step_avg:326.63ms
step:30/1750 train_loss:5.5550 train_time:6537ms step_avg:326.85ms
step:31/1750 train_loss:5.5364 train_time:6868ms step_avg:327.02ms
step:32/1750 train_loss:5.3636 train_time:7199ms step_avg:327.24ms
step:33/1750 train_loss:5.6655 train_time:7531ms step_avg:327.41ms
step:34/1750 train_loss:5.5700 train_time:7862ms step_avg:327.60ms
step:35/1750 train_loss:5.6910 train_time:8193ms step_avg:327.73ms
step:36/1750 train_loss:5.6102 train_time:8524ms step_avg:327.86ms
step:37/1750 train_loss:5.5349 train_time:8856ms step_avg:327.99ms
step:38/1750 train_loss:5.3971 train_time:9188ms step_avg:328.13ms
step:39/1750 train_loss:5.4147 train_time:9520ms step_avg:328.27ms
step:40/1750 train_loss:5.3213 train_time:9851ms step_avg:328.37ms
step:41/1750 train_loss:5.3050 train_time:10183ms step_avg:328.47ms
step:42/1750 train_loss:5.2515 train_time:10515ms step_avg:328.60ms
step:43/1750 train_loss:5.3398 train_time:10847ms step_avg:328.70ms
step:44/1750 train_loss:5.3048 train_time:11179ms step_avg:328.79ms
step:45/1750 train_loss:5.4383 train_time:11509ms step_avg:328.84ms
step:46/1750 train_loss:5.2293 train_time:11842ms step_avg:328.94ms
step:47/1750 train_loss:5.1343 train_time:12175ms step_avg:329.07ms
step:48/1750 train_loss:5.3063 train_time:12506ms step_avg:329.12ms
step:49/1750 train_loss:5.2406 train_time:12838ms step_avg:329.18ms
step:50/1750 train_loss:5.3035 train_time:13170ms step_avg:329.26ms
step:51/1750 train_loss:5.2080 train_time:13502ms step_avg:329.31ms
step:52/1750 train_loss:5.0879 train_time:13834ms step_avg:329.38ms
step:53/1750 train_loss:5.2302 train_time:14166ms step_avg:329.45ms
step:54/1750 train_loss:5.0741 train_time:14499ms step_avg:329.52ms
step:55/1750 train_loss:5.4577 train_time:14831ms step_avg:329.57ms
step:56/1750 train_loss:5.1114 train_time:15162ms step_avg:329.61ms
step:57/1750 train_loss:4.9559 train_time:15495ms step_avg:329.67ms
step:58/1750 train_loss:5.0848 train_time:15829ms step_avg:329.77ms
step:59/1750 train_loss:5.0808 train_time:16161ms step_avg:329.81ms
step:60/1750 train_loss:5.1836 train_time:16493ms step_avg:329.86ms
step:61/1750 train_loss:4.9079 train_time:16825ms step_avg:329.90ms
step:62/1750 train_loss:5.0498 train_time:17157ms step_avg:329.94ms
step:63/1750 train_loss:5.0273 train_time:17491ms step_avg:330.02ms
step:64/1750 train_loss:5.0071 train_time:17823ms step_avg:330.06ms
step:65/1750 train_loss:4.8598 train_time:18157ms step_avg:330.12ms
step:66/1750 train_loss:5.0214 train_time:18490ms step_avg:330.17ms
step:67/1750 train_loss:4.9008 train_time:18822ms step_avg:330.21ms
step:68/1750 train_loss:5.1718 train_time:19155ms step_avg:330.25ms
step:69/1750 train_loss:4.7875 train_time:19487ms step_avg:330.30ms
step:70/1750 train_loss:4.8804 train_time:19820ms step_avg:330.34ms
step:71/1750 train_loss:5.0238 train_time:20153ms step_avg:330.38ms
step:72/1750 train_loss:4.9473 train_time:20486ms step_avg:330.42ms
step:73/1750 train_loss:4.8502 train_time:20819ms step_avg:330.46ms
step:74/1750 train_loss:4.9695 train_time:21152ms step_avg:330.50ms
step:75/1750 train_loss:4.9219 train_time:21486ms step_avg:330.55ms
step:76/1750 train_loss:4.8525 train_time:21819ms step_avg:330.59ms
step:77/1750 train_loss:4.9572 train_time:22153ms step_avg:330.64ms
step:78/1750 train_loss:5.1368 train_time:22486ms step_avg:330.68ms
step:79/1750 train_loss:4.8618 train_time:22819ms step_avg:330.71ms
step:80/1750 train_loss:4.8900 train_time:23152ms step_avg:330.75ms
step:81/1750 train_loss:4.6872 train_time:23485ms step_avg:330.77ms
step:82/1750 train_loss:4.8519 train_time:23818ms step_avg:330.80ms
step:83/1750 train_loss:4.8104 train_time:24151ms step_avg:330.84ms
step:84/1750 train_loss:4.7977 train_time:24485ms step_avg:330.87ms
step:85/1750 train_loss:4.6593 train_time:24817ms step_avg:330.90ms
step:86/1750 train_loss:4.8632 train_time:25150ms step_avg:330.93ms
step:87/1750 train_loss:4.7665 train_time:25485ms step_avg:330.98ms
step:88/1750 train_loss:4.7605 train_time:25818ms step_avg:331.00ms
step:89/1750 train_loss:4.7064 train_time:26152ms step_avg:331.03ms
step:90/1750 train_loss:4.6657 train_time:26484ms step_avg:331.05ms
step:91/1750 train_loss:4.6618 train_time:26818ms step_avg:331.09ms
step:92/1750 train_loss:4.8097 train_time:27151ms step_avg:331.12ms
step:93/1750 train_loss:4.6261 train_time:27484ms step_avg:331.13ms
step:94/1750 train_loss:4.6470 train_time:27817ms step_avg:331.16ms
step:95/1750 train_loss:4.6798 train_time:28151ms step_avg:331.18ms
step:96/1750 train_loss:4.6053 train_time:28484ms step_avg:331.22ms
step:97/1750 train_loss:4.6484 train_time:28820ms step_avg:331.26ms
step:98/1750 train_loss:4.5884 train_time:29154ms step_avg:331.29ms
step:99/1750 train_loss:4.6565 train_time:29488ms step_avg:331.32ms
step:100/1750 train_loss:4.6766 train_time:29823ms step_avg:331.37ms
step:101/1750 train_loss:4.5214 train_time:30155ms step_avg:331.38ms
step:102/1750 train_loss:4.7223 train_time:30489ms step_avg:331.40ms
step:103/1750 train_loss:4.5932 train_time:30822ms step_avg:331.42ms
step:104/1750 train_loss:4.5370 train_time:31156ms step_avg:331.45ms
step:105/1750 train_loss:4.5514 train_time:31490ms step_avg:331.48ms
step:106/1750 train_loss:4.5965 train_time:31824ms step_avg:331.50ms
step:107/1750 train_loss:4.5255 train_time:32158ms step_avg:331.53ms
step:108/1750 train_loss:4.3774 train_time:32493ms step_avg:331.56ms
step:109/1750 train_loss:4.4908 train_time:32826ms step_avg:331.58ms
step:110/1750 train_loss:4.4870 train_time:33160ms step_avg:331.60ms
step:111/1750 train_loss:4.4276 train_time:33494ms step_avg:331.63ms
step:112/1750 train_loss:4.5764 train_time:33828ms step_avg:331.65ms
step:113/1750 train_loss:4.4896 train_time:34162ms step_avg:331.67ms
step:114/1750 train_loss:4.3687 train_time:34495ms step_avg:331.69ms
step:115/1750 train_loss:4.5114 train_time:34831ms step_avg:331.73ms
step:116/1750 train_loss:4.4852 train_time:35166ms step_avg:331.76ms
step:117/1750 train_loss:4.4120 train_time:35500ms step_avg:331.77ms
step:118/1750 train_loss:4.6301 train_time:35835ms step_avg:331.80ms
step:119/1750 train_loss:4.4702 train_time:36168ms step_avg:331.82ms
step:120/1750 train_loss:4.3893 train_time:36502ms step_avg:331.84ms
step:121/1750 train_loss:4.3338 train_time:36836ms step_avg:331.85ms
step:122/1750 train_loss:4.4613 train_time:37170ms step_avg:331.87ms
step:123/1750 train_loss:4.3012 train_time:37504ms step_avg:331.89ms
step:124/1750 train_loss:4.6121 train_time:37837ms step_avg:331.91ms
step:125/1750 train_loss:4.5062 train_time:38172ms step_avg:331.93ms
step:125/1750 val_loss:4.4298 train_time:38254ms step_avg:332.64ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 118.46201 | frobenius_norm = 27011.35742 | spectral_norm = 6865.51611 | nuclear_norm = 655719.87500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 37.55675 | spectral_norm = 3.28464 | nuclear_norm = 885.15637
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 36.08565 | spectral_norm = 4.36083 | nuclear_norm = 846.92896
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 72.83044 | spectral_norm = 4.97420 | nuclear_norm = 1692.75977
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 73.39466 | spectral_norm = 6.95436 | nuclear_norm = 1756.67749
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 75.29979 | spectral_norm = 5.38042 | nuclear_norm = 2001.59509
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 41.27875 | spectral_norm = 2.76725 | nuclear_norm = 1096.30933
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 35.70638 | spectral_norm = 3.05865 | nuclear_norm = 837.66992
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 34.95693 | spectral_norm = 3.80300 | nuclear_norm = 818.98499
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 75.47005 | spectral_norm = 6.14907 | nuclear_norm = 1735.23853
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 78.44250 | spectral_norm = 7.07355 | nuclear_norm = 1875.71777
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 82.16338 | spectral_norm = 5.36281 | nuclear_norm = 2185.09521
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 43.53958 | spectral_norm = 2.97655 | nuclear_norm = 1155.08008
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 34.72801 | spectral_norm = 3.07179 | nuclear_norm = 812.61725
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 34.48585 | spectral_norm = 3.62787 | nuclear_norm = 805.61804
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 70.04480 | spectral_norm = 5.88303 | nuclear_norm = 1585.66992
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 76.65034 | spectral_norm = 7.02813 | nuclear_norm = 1805.37134
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 85.26026 | spectral_norm = 5.39722 | nuclear_norm = 2266.12036
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 44.07633 | spectral_norm = 3.04260 | nuclear_norm = 1169.11877
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 34.64762 | spectral_norm = 3.02576 | nuclear_norm = 809.48853
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 35.15572 | spectral_norm = 3.17103 | nuclear_norm = 821.98004
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 71.92381 | spectral_norm = 6.28635 | nuclear_norm = 1613.77905
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 75.17364 | spectral_norm = 6.81127 | nuclear_norm = 1774.64087
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 85.09315 | spectral_norm = 5.33441 | nuclear_norm = 2259.43481
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 43.69775 | spectral_norm = 3.06039 | nuclear_norm = 1157.66248
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 34.28432 | spectral_norm = 2.95368 | nuclear_norm = 797.10193
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 34.82666 | spectral_norm = 2.85643 | nuclear_norm = 810.56256
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 72.79037 | spectral_norm = 6.68454 | nuclear_norm = 1618.42285
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 71.76566 | spectral_norm = 6.58526 | nuclear_norm = 1695.18982
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 84.07227 | spectral_norm = 5.28913 | nuclear_norm = 2230.20386
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 43.30031 | spectral_norm = 3.04310 | nuclear_norm = 1145.23547
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 34.38953 | spectral_norm = 2.91065 | nuclear_norm = 803.11829
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 34.73854 | spectral_norm = 2.92656 | nuclear_norm = 810.89691
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 67.66349 | spectral_norm = 6.40185 | nuclear_norm = 1496.57275
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 69.52764 | spectral_norm = 6.40085 | nuclear_norm = 1644.46875
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 82.98628 | spectral_norm = 5.32681 | nuclear_norm = 2199.37842
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 42.78895 | spectral_norm = 3.01229 | nuclear_norm = 1129.90625
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 33.15258 | spectral_norm = 2.92417 | nuclear_norm = 769.95593
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 33.38414 | spectral_norm = 2.86847 | nuclear_norm = 777.42883
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 65.01134 | spectral_norm = 5.82120 | nuclear_norm = 1432.92761
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 71.89465 | spectral_norm = 6.68996 | nuclear_norm = 1693.84351
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 81.92937 | spectral_norm = 5.52067 | nuclear_norm = 2166.44824
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 42.00914 | spectral_norm = 2.90128 | nuclear_norm = 1106.14832
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 33.21948 | spectral_norm = 2.91164 | nuclear_norm = 771.47314
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 33.88426 | spectral_norm = 2.91330 | nuclear_norm = 787.11145
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 75.58405 | spectral_norm = 6.58606 | nuclear_norm = 1693.38135
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 72.91069 | spectral_norm = 6.65739 | nuclear_norm = 1733.77100
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 81.52100 | spectral_norm = 5.60929 | nuclear_norm = 2154.26709
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 41.63081 | spectral_norm = 2.80582 | nuclear_norm = 1095.24890
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 33.07721 | spectral_norm = 2.90481 | nuclear_norm = 763.20569
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 33.78757 | spectral_norm = 2.95547 | nuclear_norm = 780.70898
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 69.50094 | spectral_norm = 6.07192 | nuclear_norm = 1547.05029
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 75.52731 | spectral_norm = 6.74354 | nuclear_norm = 1798.52319
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 81.59887 | spectral_norm = 5.75319 | nuclear_norm = 2155.17480
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 41.51036 | spectral_norm = 2.82096 | nuclear_norm = 1091.91260
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 33.56246 | spectral_norm = 2.95341 | nuclear_norm = 776.53711
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 34.32729 | spectral_norm = 2.88633 | nuclear_norm = 796.37390
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 71.15113 | spectral_norm = 6.20031 | nuclear_norm = 1591.31055
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 75.74702 | spectral_norm = 6.54321 | nuclear_norm = 1810.79248
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 82.12554 | spectral_norm = 5.83217 | nuclear_norm = 2170.77515
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 41.51749 | spectral_norm = 2.84089 | nuclear_norm = 1091.97974
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 33.16713 | spectral_norm = 2.78529 | nuclear_norm = 760.88208
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 33.79266 | spectral_norm = 2.79682 | nuclear_norm = 775.80103
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 76.19958 | spectral_norm = 6.20689 | nuclear_norm = 1745.06897
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 77.98341 | spectral_norm = 5.92596 | nuclear_norm = 1874.00500
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 79.82539 | spectral_norm = 5.87759 | nuclear_norm = 2112.63037
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 40.35244 | spectral_norm = 2.83070 | nuclear_norm = 1060.32568
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 33.55127 | spectral_norm = 2.83513 | nuclear_norm = 775.20361
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 33.77439 | spectral_norm = 2.88561 | nuclear_norm = 778.97119
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 66.99323 | spectral_norm = 5.71596 | nuclear_norm = 1509.03333
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 74.02826 | spectral_norm = 5.51367 | nuclear_norm = 1773.41577
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 78.91936 | spectral_norm = 6.11787 | nuclear_norm = 2089.58398
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 39.67043 | spectral_norm = 2.81994 | nuclear_norm = 1040.87317
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 384.49796 | spectral_norm = 133.71379 | nuclear_norm = 9154.12305
===========================================
step:126/1750 train_loss:4.4443 train_time:38503ms step_avg:331.92ms
step:127/1750 train_loss:4.4666 train_time:38834ms step_avg:331.91ms
step:128/1750 train_loss:4.4031 train_time:39166ms step_avg:331.91ms
step:129/1750 train_loss:4.7082 train_time:39498ms step_avg:331.92ms
step:130/1750 train_loss:4.3813 train_time:39830ms step_avg:331.92ms
step:131/1750 train_loss:4.4187 train_time:40170ms step_avg:331.98ms
step:132/1750 train_loss:4.3499 train_time:40514ms step_avg:332.09ms
step:133/1750 train_loss:4.4654 train_time:40858ms step_avg:332.18ms
step:134/1750 train_loss:4.2686 train_time:41200ms step_avg:332.25ms
step:135/1750 train_loss:4.4487 train_time:41543ms step_avg:332.35ms
step:136/1750 train_loss:4.2155 train_time:41887ms step_avg:332.44ms
step:137/1750 train_loss:4.3835 train_time:42229ms step_avg:332.51ms
step:138/1750 train_loss:4.2956 train_time:42573ms step_avg:332.60ms
step:139/1750 train_loss:4.3954 train_time:42918ms step_avg:332.69ms
step:140/1750 train_loss:4.4784 train_time:43264ms step_avg:332.80ms
step:141/1750 train_loss:4.3174 train_time:43607ms step_avg:332.88ms
step:142/1750 train_loss:4.3140 train_time:43952ms step_avg:332.97ms
step:143/1750 train_loss:4.2644 train_time:44296ms step_avg:333.05ms
step:144/1750 train_loss:4.3613 train_time:44642ms step_avg:333.15ms
step:145/1750 train_loss:4.3173 train_time:44985ms step_avg:333.22ms
step:146/1750 train_loss:4.1686 train_time:45330ms step_avg:333.31ms
step:147/1750 train_loss:4.3176 train_time:45675ms step_avg:333.40ms
step:148/1750 train_loss:4.3574 train_time:46020ms step_avg:333.48ms
step:149/1750 train_loss:4.3063 train_time:46365ms step_avg:333.56ms
step:150/1750 train_loss:4.4448 train_time:46707ms step_avg:333.62ms
step:151/1750 train_loss:4.2734 train_time:47050ms step_avg:333.69ms
step:152/1750 train_loss:4.2692 train_time:47397ms step_avg:333.78ms
step:153/1750 train_loss:4.3694 train_time:47742ms step_avg:333.86ms
step:154/1750 train_loss:4.3681 train_time:48086ms step_avg:333.93ms
step:155/1750 train_loss:4.2752 train_time:48429ms step_avg:333.99ms
step:156/1750 train_loss:4.3520 train_time:48774ms step_avg:334.07ms
step:157/1750 train_loss:4.4013 train_time:49117ms step_avg:334.13ms
step:158/1750 train_loss:4.2338 train_time:49460ms step_avg:334.19ms
step:159/1750 train_loss:4.3070 train_time:49804ms step_avg:334.25ms
step:160/1750 train_loss:4.1340 train_time:50149ms step_avg:334.33ms
step:161/1750 train_loss:4.3515 train_time:50493ms step_avg:334.39ms
step:162/1750 train_loss:4.3543 train_time:50838ms step_avg:334.46ms
step:163/1750 train_loss:4.3362 train_time:51182ms step_avg:334.52ms
step:164/1750 train_loss:4.1926 train_time:51527ms step_avg:334.59ms
step:165/1750 train_loss:4.2866 train_time:51873ms step_avg:334.67ms
step:166/1750 train_loss:4.3580 train_time:52217ms step_avg:334.73ms
step:167/1750 train_loss:4.2181 train_time:52562ms step_avg:334.79ms
step:168/1750 train_loss:4.2792 train_time:52907ms step_avg:334.86ms
step:169/1750 train_loss:4.1572 train_time:53252ms step_avg:334.92ms
step:170/1750 train_loss:4.0250 train_time:53598ms step_avg:334.99ms
step:171/1750 train_loss:4.2151 train_time:53944ms step_avg:335.05ms
step:172/1750 train_loss:4.2121 train_time:54289ms step_avg:335.11ms
step:173/1750 train_loss:4.2767 train_time:54634ms step_avg:335.18ms
step:174/1750 train_loss:4.4327 train_time:54979ms step_avg:335.24ms
step:175/1750 train_loss:4.2537 train_time:55324ms step_avg:335.30ms
step:176/1750 train_loss:4.0930 train_time:55669ms step_avg:335.35ms
step:177/1750 train_loss:4.0760 train_time:56014ms step_avg:335.41ms
step:178/1750 train_loss:4.1930 train_time:56358ms step_avg:335.46ms
step:179/1750 train_loss:4.1495 train_time:56703ms step_avg:335.52ms
step:180/1750 train_loss:4.1259 train_time:57048ms step_avg:335.58ms
step:181/1750 train_loss:4.3063 train_time:57393ms step_avg:335.63ms
step:182/1750 train_loss:4.1604 train_time:57739ms step_avg:335.69ms
step:183/1750 train_loss:4.1291 train_time:58087ms step_avg:335.76ms
step:184/1750 train_loss:4.1362 train_time:58431ms step_avg:335.81ms
step:185/1750 train_loss:4.2247 train_time:58776ms step_avg:335.87ms
step:186/1750 train_loss:4.1879 train_time:59122ms step_avg:335.92ms
step:187/1750 train_loss:4.2394 train_time:59468ms step_avg:335.98ms
step:188/1750 train_loss:4.1786 train_time:59860ms step_avg:336.29ms
step:189/1750 train_loss:4.1271 train_time:60481ms step_avg:337.88ms
step:190/1750 train_loss:4.2324 train_time:60829ms step_avg:337.94ms
step:191/1750 train_loss:4.1010 train_time:61172ms step_avg:337.97ms
step:192/1750 train_loss:4.0433 train_time:61517ms step_avg:338.00ms
step:193/1750 train_loss:4.2661 train_time:61861ms step_avg:338.04ms
step:194/1750 train_loss:4.1914 train_time:62204ms step_avg:338.07ms
step:195/1750 train_loss:4.3718 train_time:62547ms step_avg:338.09ms
step:196/1750 train_loss:4.1914 train_time:62891ms step_avg:338.12ms
step:197/1750 train_loss:4.0565 train_time:63234ms step_avg:338.15ms
step:198/1750 train_loss:4.1873 train_time:63578ms step_avg:338.18ms
step:199/1750 train_loss:4.0414 train_time:63921ms step_avg:338.21ms
step:200/1750 train_loss:4.1217 train_time:64266ms step_avg:338.24ms
step:201/1750 train_loss:4.0058 train_time:64607ms step_avg:338.25ms
step:202/1750 train_loss:4.2581 train_time:64950ms step_avg:338.28ms
step:203/1750 train_loss:4.0657 train_time:65293ms step_avg:338.30ms
step:204/1750 train_loss:4.1870 train_time:65637ms step_avg:338.33ms
step:205/1750 train_loss:4.2403 train_time:65981ms step_avg:338.36ms
step:206/1750 train_loss:3.9381 train_time:66325ms step_avg:338.39ms
step:207/1750 train_loss:4.0850 train_time:66667ms step_avg:338.41ms
step:208/1750 train_loss:4.0951 train_time:67010ms step_avg:338.43ms
step:209/1750 train_loss:4.2444 train_time:67353ms step_avg:338.46ms
step:210/1750 train_loss:4.1778 train_time:67697ms step_avg:338.49ms
step:211/1750 train_loss:4.0607 train_time:68039ms step_avg:338.50ms
step:212/1750 train_loss:4.1088 train_time:68384ms step_avg:338.53ms
step:213/1750 train_loss:4.0439 train_time:68728ms step_avg:338.56ms
step:214/1750 train_loss:4.1142 train_time:69070ms step_avg:338.58ms
step:215/1750 train_loss:3.9658 train_time:69412ms step_avg:338.60ms
step:216/1750 train_loss:4.0072 train_time:69757ms step_avg:338.62ms
step:217/1750 train_loss:4.0081 train_time:70101ms step_avg:338.65ms
step:218/1750 train_loss:4.0858 train_time:70443ms step_avg:338.67ms
step:219/1750 train_loss:4.0673 train_time:70788ms step_avg:338.70ms
step:220/1750 train_loss:4.0758 train_time:71131ms step_avg:338.72ms
step:221/1750 train_loss:4.0934 train_time:71475ms step_avg:338.75ms
step:222/1750 train_loss:4.0018 train_time:71818ms step_avg:338.76ms
step:223/1750 train_loss:3.9863 train_time:72161ms step_avg:338.78ms
step:224/1750 train_loss:4.3025 train_time:72504ms step_avg:338.80ms
step:225/1750 train_loss:3.8998 train_time:72848ms step_avg:338.83ms
step:226/1750 train_loss:3.9881 train_time:73191ms step_avg:338.85ms
step:227/1750 train_loss:3.9925 train_time:73534ms step_avg:338.87ms
step:228/1750 train_loss:4.1434 train_time:73878ms step_avg:338.89ms
step:229/1750 train_loss:3.9261 train_time:74221ms step_avg:338.91ms
step:230/1750 train_loss:4.0515 train_time:74564ms step_avg:338.93ms
step:231/1750 train_loss:3.8983 train_time:74907ms step_avg:338.95ms
step:232/1750 train_loss:3.9700 train_time:75252ms step_avg:338.97ms
step:233/1750 train_loss:4.1009 train_time:75595ms step_avg:338.99ms
step:234/1750 train_loss:4.0392 train_time:75939ms step_avg:339.01ms
step:235/1750 train_loss:3.9283 train_time:76283ms step_avg:339.04ms
step:236/1750 train_loss:4.1034 train_time:76626ms step_avg:339.05ms
step:237/1750 train_loss:4.0887 train_time:76970ms step_avg:339.07ms
step:238/1750 train_loss:3.9502 train_time:77314ms step_avg:339.10ms
step:239/1750 train_loss:4.0815 train_time:77657ms step_avg:339.11ms
step:240/1750 train_loss:4.1262 train_time:78002ms step_avg:339.14ms
step:241/1750 train_loss:3.9731 train_time:78345ms step_avg:339.16ms
step:242/1750 train_loss:4.1611 train_time:78689ms step_avg:339.18ms
step:243/1750 train_loss:4.0245 train_time:79033ms step_avg:339.20ms
step:244/1750 train_loss:4.0903 train_time:79378ms step_avg:339.22ms
step:245/1750 train_loss:4.1477 train_time:79720ms step_avg:339.24ms
step:246/1750 train_loss:4.0625 train_time:80064ms step_avg:339.25ms
step:247/1750 train_loss:4.0052 train_time:80406ms step_avg:339.26ms
step:248/1750 train_loss:4.1153 train_time:80748ms step_avg:339.28ms
step:249/1750 train_loss:3.9322 train_time:81092ms step_avg:339.30ms
step:250/1750 train_loss:3.9831 train_time:81436ms step_avg:339.32ms
step:250/1750 val_loss:4.0154 train_time:81523ms step_avg:339.68ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 157.39561 | frobenius_norm = 35961.38672 | spectral_norm = 7624.11279 | nuclear_norm = 885183.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 58.60844 | spectral_norm = 6.33978 | nuclear_norm = 1374.02417
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 56.79706 | spectral_norm = 8.18103 | nuclear_norm = 1322.97705
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 112.36689 | spectral_norm = 7.35868 | nuclear_norm = 2657.30225
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 103.50291 | spectral_norm = 8.61022 | nuclear_norm = 2444.08740
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 119.76907 | spectral_norm = 9.04144 | nuclear_norm = 3182.32153
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 62.89336 | spectral_norm = 4.53044 | nuclear_norm = 1668.38599
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 57.44637 | spectral_norm = 5.17241 | nuclear_norm = 1346.32300
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 56.06503 | spectral_norm = 6.04403 | nuclear_norm = 1311.73547
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 114.42545 | spectral_norm = 8.81104 | nuclear_norm = 2650.38330
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 113.87413 | spectral_norm = 8.80354 | nuclear_norm = 2693.39404
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 128.28244 | spectral_norm = 8.42671 | nuclear_norm = 3412.58350
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 65.57710 | spectral_norm = 4.96310 | nuclear_norm = 1734.48535
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 55.92311 | spectral_norm = 5.02792 | nuclear_norm = 1304.30151
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 55.33237 | spectral_norm = 5.95541 | nuclear_norm = 1287.13574
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 109.33864 | spectral_norm = 8.95701 | nuclear_norm = 2502.35840
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 114.38045 | spectral_norm = 8.86134 | nuclear_norm = 2678.92578
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 133.69453 | spectral_norm = 8.79754 | nuclear_norm = 3556.11084
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 66.84505 | spectral_norm = 5.31439 | nuclear_norm = 1768.60657
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 55.94823 | spectral_norm = 4.92124 | nuclear_norm = 1301.83276
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 55.99929 | spectral_norm = 5.06633 | nuclear_norm = 1303.73389
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 112.72116 | spectral_norm = 9.13211 | nuclear_norm = 2575.72974
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 116.24008 | spectral_norm = 8.74703 | nuclear_norm = 2743.19531
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 133.80331 | spectral_norm = 8.90342 | nuclear_norm = 3557.71411
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 66.31155 | spectral_norm = 5.13737 | nuclear_norm = 1754.12024
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 55.92360 | spectral_norm = 4.97453 | nuclear_norm = 1295.33203
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 56.02176 | spectral_norm = 4.54256 | nuclear_norm = 1299.21179
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 113.56422 | spectral_norm = 9.62525 | nuclear_norm = 2572.67480
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 113.13660 | spectral_norm = 8.51108 | nuclear_norm = 2672.30566
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 133.71660 | spectral_norm = 8.85799 | nuclear_norm = 3558.83765
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 65.94786 | spectral_norm = 5.13889 | nuclear_norm = 1743.42993
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 56.24280 | spectral_norm = 4.86691 | nuclear_norm = 1313.44922
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 55.99554 | spectral_norm = 4.74262 | nuclear_norm = 1309.00073
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 110.16457 | spectral_norm = 9.24387 | nuclear_norm = 2502.40332
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 110.53568 | spectral_norm = 8.30480 | nuclear_norm = 2613.05884
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 134.72487 | spectral_norm = 8.60222 | nuclear_norm = 3585.31763
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 66.11358 | spectral_norm = 5.18693 | nuclear_norm = 1744.64368
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 54.42454 | spectral_norm = 5.02434 | nuclear_norm = 1266.76074
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 53.71154 | spectral_norm = 4.96958 | nuclear_norm = 1253.11597
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 108.21111 | spectral_norm = 8.88183 | nuclear_norm = 2461.23779
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 113.45379 | spectral_norm = 8.54781 | nuclear_norm = 2664.10791
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 132.87146 | spectral_norm = 9.18649 | nuclear_norm = 3529.49170
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 65.35295 | spectral_norm = 5.17875 | nuclear_norm = 1722.59155
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 56.13104 | spectral_norm = 4.87921 | nuclear_norm = 1309.72656
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 55.92739 | spectral_norm = 4.84818 | nuclear_norm = 1304.42310
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 121.63349 | spectral_norm = 9.61840 | nuclear_norm = 2791.79492
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 115.72367 | spectral_norm = 8.23397 | nuclear_norm = 2750.05078
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 130.64520 | spectral_norm = 9.29564 | nuclear_norm = 3468.05615
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 65.03101 | spectral_norm = 5.01801 | nuclear_norm = 1715.27380
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 55.18260 | spectral_norm = 4.85315 | nuclear_norm = 1278.65186
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 55.16286 | spectral_norm = 4.80294 | nuclear_norm = 1276.43506
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 114.27159 | spectral_norm = 9.45692 | nuclear_norm = 2601.01025
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 120.29947 | spectral_norm = 8.88961 | nuclear_norm = 2846.60645
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 130.80307 | spectral_norm = 9.55335 | nuclear_norm = 3470.34326
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 64.93080 | spectral_norm = 5.03174 | nuclear_norm = 1714.03223
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 56.51101 | spectral_norm = 5.01932 | nuclear_norm = 1313.40576
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 56.32758 | spectral_norm = 4.84197 | nuclear_norm = 1310.73315
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 116.48775 | spectral_norm = 10.16062 | nuclear_norm = 2669.15430
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 117.52618 | spectral_norm = 9.36185 | nuclear_norm = 2792.14258
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 132.55260 | spectral_norm = 9.46677 | nuclear_norm = 3517.38037
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 65.43221 | spectral_norm = 5.16429 | nuclear_norm = 1726.67627
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 55.75011 | spectral_norm = 5.03427 | nuclear_norm = 1270.13354
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 55.93897 | spectral_norm = 4.71571 | nuclear_norm = 1272.54785
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 124.69536 | spectral_norm = 9.22755 | nuclear_norm = 2899.81689
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 126.47130 | spectral_norm = 8.35009 | nuclear_norm = 3016.91016
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 127.72176 | spectral_norm = 9.35822 | nuclear_norm = 3394.78149
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 63.80537 | spectral_norm = 5.27839 | nuclear_norm = 1684.77905
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 56.52480 | spectral_norm = 5.11882 | nuclear_norm = 1304.21533
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 56.07493 | spectral_norm = 5.10608 | nuclear_norm = 1288.90161
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 111.71311 | spectral_norm = 8.78745 | nuclear_norm = 2580.41162
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 121.29929 | spectral_norm = 8.22688 | nuclear_norm = 2880.21851
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 127.95165 | spectral_norm = 9.10035 | nuclear_norm = 3403.11523
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 64.33705 | spectral_norm = 5.42706 | nuclear_norm = 1693.44482
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 549.25122 | spectral_norm = 151.24216 | nuclear_norm = 13696.39551
===========================================
step:251/1750 train_loss:4.0844 train_time:81777ms step_avg:339.32ms
step:252/1750 train_loss:4.1727 train_time:82116ms step_avg:339.32ms
step:253/1750 train_loss:3.9396 train_time:82457ms step_avg:339.33ms
step:254/1750 train_loss:3.8837 train_time:82797ms step_avg:339.33ms
step:255/1750 train_loss:4.0757 train_time:83138ms step_avg:339.34ms
step:256/1750 train_loss:3.9901 train_time:83481ms step_avg:339.35ms
step:257/1750 train_loss:3.9930 train_time:83822ms step_avg:339.36ms
step:258/1750 train_loss:3.9972 train_time:84163ms step_avg:339.37ms
step:259/1750 train_loss:4.0320 train_time:84503ms step_avg:339.37ms
step:260/1750 train_loss:4.0579 train_time:84845ms step_avg:339.38ms
step:261/1750 train_loss:4.0150 train_time:85191ms step_avg:339.41ms
step:262/1750 train_loss:3.9976 train_time:85543ms step_avg:339.45ms
step:263/1750 train_loss:3.8973 train_time:85894ms step_avg:339.50ms
step:264/1750 train_loss:3.9885 train_time:86244ms step_avg:339.55ms
step:265/1750 train_loss:3.8699 train_time:86597ms step_avg:339.60ms
step:266/1750 train_loss:3.9214 train_time:86948ms step_avg:339.64ms
step:267/1750 train_loss:3.9270 train_time:87301ms step_avg:339.69ms
step:268/1750 train_loss:3.9619 train_time:87655ms step_avg:339.75ms
step:269/1750 train_loss:3.8622 train_time:88005ms step_avg:339.79ms
step:270/1750 train_loss:4.1032 train_time:88355ms step_avg:339.83ms
step:271/1750 train_loss:3.9682 train_time:88708ms step_avg:339.88ms
step:272/1750 train_loss:3.9169 train_time:89061ms step_avg:339.93ms
step:273/1750 train_loss:3.9429 train_time:89411ms step_avg:339.97ms
step:274/1750 train_loss:4.0301 train_time:89765ms step_avg:340.02ms
step:275/1750 train_loss:4.0510 train_time:90115ms step_avg:340.06ms
step:276/1750 train_loss:4.2159 train_time:90465ms step_avg:340.09ms
step:277/1750 train_loss:4.0324 train_time:90816ms step_avg:340.13ms
step:278/1750 train_loss:4.0852 train_time:91168ms step_avg:340.18ms
step:279/1750 train_loss:4.0007 train_time:91518ms step_avg:340.21ms
step:280/1750 train_loss:4.2001 train_time:91872ms step_avg:340.27ms
step:281/1750 train_loss:3.9668 train_time:92226ms step_avg:340.32ms
step:282/1750 train_loss:3.9289 train_time:92582ms step_avg:340.38ms
step:283/1750 train_loss:3.9061 train_time:92933ms step_avg:340.41ms
step:284/1750 train_loss:4.0513 train_time:93284ms step_avg:340.45ms
step:285/1750 train_loss:4.0639 train_time:93635ms step_avg:340.49ms
step:286/1750 train_loss:4.0927 train_time:93986ms step_avg:340.53ms
step:287/1750 train_loss:3.9159 train_time:94340ms step_avg:340.58ms
step:288/1750 train_loss:4.0181 train_time:94692ms step_avg:340.62ms
step:289/1750 train_loss:3.8846 train_time:95044ms step_avg:340.66ms
step:290/1750 train_loss:3.8592 train_time:95395ms step_avg:340.70ms
step:291/1750 train_loss:3.9181 train_time:95747ms step_avg:340.74ms
step:292/1750 train_loss:3.8620 train_time:96098ms step_avg:340.77ms
step:293/1750 train_loss:3.9179 train_time:96449ms step_avg:340.81ms
step:294/1750 train_loss:3.9457 train_time:96799ms step_avg:340.84ms
step:295/1750 train_loss:3.8393 train_time:97152ms step_avg:340.88ms
step:296/1750 train_loss:3.8613 train_time:97505ms step_avg:340.93ms
step:297/1750 train_loss:3.8662 train_time:97859ms step_avg:340.97ms
step:298/1750 train_loss:3.9781 train_time:98211ms step_avg:341.01ms
step:299/1750 train_loss:3.8162 train_time:98562ms step_avg:341.04ms
step:300/1750 train_loss:3.9687 train_time:98919ms step_avg:341.10ms
step:301/1750 train_loss:3.9701 train_time:99267ms step_avg:341.12ms
step:302/1750 train_loss:3.9423 train_time:99620ms step_avg:341.16ms
step:303/1750 train_loss:3.9834 train_time:99970ms step_avg:341.20ms
step:304/1750 train_loss:3.9725 train_time:100321ms step_avg:341.23ms
step:305/1750 train_loss:4.4571 train_time:100673ms step_avg:341.27ms
step:306/1750 train_loss:3.9333 train_time:101023ms step_avg:341.30ms
step:307/1750 train_loss:3.8392 train_time:101376ms step_avg:341.33ms
step:308/1750 train_loss:3.9817 train_time:101728ms step_avg:341.37ms
step:309/1750 train_loss:3.8712 train_time:102079ms step_avg:341.40ms
step:310/1750 train_loss:4.0929 train_time:102432ms step_avg:341.44ms
step:311/1750 train_loss:3.9342 train_time:102785ms step_avg:341.48ms
step:312/1750 train_loss:3.8685 train_time:103138ms step_avg:341.52ms
step:313/1750 train_loss:3.9378 train_time:103489ms step_avg:341.55ms
step:314/1750 train_loss:4.0713 train_time:103843ms step_avg:341.59ms
step:315/1750 train_loss:3.9465 train_time:104194ms step_avg:341.62ms
step:316/1750 train_loss:3.8031 train_time:104547ms step_avg:341.66ms
step:317/1750 train_loss:3.8829 train_time:104900ms step_avg:341.69ms
step:318/1750 train_loss:3.9258 train_time:105250ms step_avg:341.72ms
step:319/1750 train_loss:3.8961 train_time:105602ms step_avg:341.76ms
step:320/1750 train_loss:4.0244 train_time:105956ms step_avg:341.79ms
step:321/1750 train_loss:3.9622 train_time:106308ms step_avg:341.83ms
step:322/1750 train_loss:3.9356 train_time:106662ms step_avg:341.87ms
step:323/1750 train_loss:4.0031 train_time:107013ms step_avg:341.89ms
step:324/1750 train_loss:3.9503 train_time:107364ms step_avg:341.92ms
step:325/1750 train_loss:4.0281 train_time:107715ms step_avg:341.95ms
step:326/1750 train_loss:3.8923 train_time:108068ms step_avg:341.99ms
step:327/1750 train_loss:4.4063 train_time:108419ms step_avg:342.02ms
step:328/1750 train_loss:4.0778 train_time:108770ms step_avg:342.04ms
step:329/1750 train_loss:3.8010 train_time:109120ms step_avg:342.07ms
step:330/1750 train_loss:3.7577 train_time:109470ms step_avg:342.10ms
step:331/1750 train_loss:3.9738 train_time:109818ms step_avg:342.11ms
step:332/1750 train_loss:3.9074 train_time:110167ms step_avg:342.13ms
step:333/1750 train_loss:3.8771 train_time:110515ms step_avg:342.15ms
step:334/1750 train_loss:3.8420 train_time:110866ms step_avg:342.18ms
step:335/1750 train_loss:4.0104 train_time:111216ms step_avg:342.20ms
step:336/1750 train_loss:3.9623 train_time:111564ms step_avg:342.22ms
step:337/1750 train_loss:4.4191 train_time:111913ms step_avg:342.24ms
step:338/1750 train_loss:3.9434 train_time:112260ms step_avg:342.26ms
step:339/1750 train_loss:3.8606 train_time:112609ms step_avg:342.28ms
step:340/1750 train_loss:3.9352 train_time:112960ms step_avg:342.30ms
step:341/1750 train_loss:3.8551 train_time:113308ms step_avg:342.32ms
step:342/1750 train_loss:3.8147 train_time:113657ms step_avg:342.34ms
step:343/1750 train_loss:3.8428 train_time:114009ms step_avg:342.37ms
step:344/1750 train_loss:3.9942 train_time:114358ms step_avg:342.39ms
step:345/1750 train_loss:3.8176 train_time:114708ms step_avg:342.41ms
step:346/1750 train_loss:3.7739 train_time:115058ms step_avg:342.43ms
step:347/1750 train_loss:3.8060 train_time:115408ms step_avg:342.46ms
step:348/1750 train_loss:3.8591 train_time:115758ms step_avg:342.48ms
step:349/1750 train_loss:3.8361 train_time:116107ms step_avg:342.50ms
step:350/1750 train_loss:3.5718 train_time:116456ms step_avg:342.52ms
step:351/1750 train_loss:3.8293 train_time:116807ms step_avg:342.54ms
step:352/1750 train_loss:4.1893 train_time:117157ms step_avg:342.56ms
step:353/1750 train_loss:3.6627 train_time:117506ms step_avg:342.58ms
step:354/1750 train_loss:3.9315 train_time:117857ms step_avg:342.61ms
step:355/1750 train_loss:3.7848 train_time:118207ms step_avg:342.63ms
step:356/1750 train_loss:3.8793 train_time:118556ms step_avg:342.65ms
step:357/1750 train_loss:3.7730 train_time:118906ms step_avg:342.67ms
step:358/1750 train_loss:3.8556 train_time:119257ms step_avg:342.69ms
step:359/1750 train_loss:3.8023 train_time:119608ms step_avg:342.72ms
step:360/1750 train_loss:3.4341 train_time:119959ms step_avg:342.74ms
step:361/1750 train_loss:4.0301 train_time:120308ms step_avg:342.76ms
step:362/1750 train_loss:3.9315 train_time:120657ms step_avg:342.77ms
step:363/1750 train_loss:3.8466 train_time:121006ms step_avg:342.79ms
step:364/1750 train_loss:3.7455 train_time:121356ms step_avg:342.81ms
step:365/1750 train_loss:3.9192 train_time:121706ms step_avg:342.83ms
step:366/1750 train_loss:3.8781 train_time:122057ms step_avg:342.86ms
step:367/1750 train_loss:3.8521 train_time:122408ms step_avg:342.88ms
step:368/1750 train_loss:3.8513 train_time:122757ms step_avg:342.90ms
step:369/1750 train_loss:3.7457 train_time:123107ms step_avg:342.92ms
step:370/1750 train_loss:3.8986 train_time:123455ms step_avg:342.93ms
step:371/1750 train_loss:3.7426 train_time:123804ms step_avg:342.95ms
step:372/1750 train_loss:3.6982 train_time:124152ms step_avg:342.96ms
step:373/1750 train_loss:3.9272 train_time:124500ms step_avg:342.97ms
step:374/1750 train_loss:3.8378 train_time:124848ms step_avg:342.99ms
step:375/1750 train_loss:3.8092 train_time:125199ms step_avg:343.01ms
step:375/1750 val_loss:3.8332 train_time:125287ms step_avg:343.25ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 185.28224 | frobenius_norm = 42418.06250 | spectral_norm = 8331.41016 | nuclear_norm = 1050740.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 84.21875 | spectral_norm = 10.40038 | nuclear_norm = 1971.01501
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 81.58438 | spectral_norm = 12.33203 | nuclear_norm = 1896.97949
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 145.78839 | spectral_norm = 9.35979 | nuclear_norm = 3467.95068
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 127.69518 | spectral_norm = 10.86594 | nuclear_norm = 3000.68433
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 173.16069 | spectral_norm = 13.05608 | nuclear_norm = 4605.31250
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 89.70511 | spectral_norm = 6.63833 | nuclear_norm = 2382.13989
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 82.84625 | spectral_norm = 7.64706 | nuclear_norm = 1939.92627
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 81.08071 | spectral_norm = 8.44660 | nuclear_norm = 1895.28186
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 142.24400 | spectral_norm = 11.28765 | nuclear_norm = 3293.26367
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 140.85878 | spectral_norm = 10.54407 | nuclear_norm = 3316.29492
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 179.15381 | spectral_norm = 12.03794 | nuclear_norm = 4768.97266
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 90.05468 | spectral_norm = 7.43407 | nuclear_norm = 2376.72217
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 81.30487 | spectral_norm = 7.29356 | nuclear_norm = 1896.06470
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 80.54396 | spectral_norm = 8.30295 | nuclear_norm = 1873.57788
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 136.79253 | spectral_norm = 11.52149 | nuclear_norm = 3124.55005
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 141.98740 | spectral_norm = 10.94433 | nuclear_norm = 3310.53442
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 185.31757 | spectral_norm = 12.70635 | nuclear_norm = 4931.67725
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 92.03246 | spectral_norm = 7.96516 | nuclear_norm = 2428.67383
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 80.91086 | spectral_norm = 7.22875 | nuclear_norm = 1875.33386
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 80.76259 | spectral_norm = 7.17064 | nuclear_norm = 1874.75806
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 143.01245 | spectral_norm = 11.76285 | nuclear_norm = 3263.25610
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 146.96826 | spectral_norm = 11.12582 | nuclear_norm = 3454.99658
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 186.01353 | spectral_norm = 13.20712 | nuclear_norm = 4951.63037
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 91.48368 | spectral_norm = 7.71560 | nuclear_norm = 2415.58643
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 81.00609 | spectral_norm = 7.45668 | nuclear_norm = 1872.95898
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 80.66325 | spectral_norm = 6.70782 | nuclear_norm = 1865.43445
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 145.92899 | spectral_norm = 12.58950 | nuclear_norm = 3305.94629
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 145.54427 | spectral_norm = 10.82835 | nuclear_norm = 3422.40723
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 187.47119 | spectral_norm = 12.98587 | nuclear_norm = 4997.72461
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 91.23134 | spectral_norm = 7.26573 | nuclear_norm = 2409.12305
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 81.73701 | spectral_norm = 7.26898 | nuclear_norm = 1904.88977
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 80.96655 | spectral_norm = 6.99645 | nuclear_norm = 1889.42554
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 142.35738 | spectral_norm = 12.16555 | nuclear_norm = 3243.48096
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 142.34149 | spectral_norm = 10.60911 | nuclear_norm = 3358.51807
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 189.67941 | spectral_norm = 12.62206 | nuclear_norm = 5057.53516
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 91.42554 | spectral_norm = 7.31814 | nuclear_norm = 2408.78711
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 79.36195 | spectral_norm = 7.55121 | nuclear_norm = 1847.42090
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 77.94411 | spectral_norm = 7.44956 | nuclear_norm = 1818.62927
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 139.40479 | spectral_norm = 11.34074 | nuclear_norm = 3180.82520
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 142.35771 | spectral_norm = 11.20847 | nuclear_norm = 3314.37744
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 187.14484 | spectral_norm = 12.79492 | nuclear_norm = 4984.94434
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 91.32542 | spectral_norm = 7.53516 | nuclear_norm = 2407.78394
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 82.48984 | spectral_norm = 7.36798 | nuclear_norm = 1924.27600
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 81.59618 | spectral_norm = 7.52676 | nuclear_norm = 1900.22461
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 155.54758 | spectral_norm = 12.84452 | nuclear_norm = 3573.95703
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 149.12865 | spectral_norm = 10.57885 | nuclear_norm = 3536.24243
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 182.59569 | spectral_norm = 13.63395 | nuclear_norm = 4859.74463
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 91.89169 | spectral_norm = 7.42718 | nuclear_norm = 2429.84619
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 80.76678 | spectral_norm = 7.26830 | nuclear_norm = 1868.71460
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 80.19273 | spectral_norm = 7.07492 | nuclear_norm = 1852.37476
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 147.26306 | spectral_norm = 12.40697 | nuclear_norm = 3342.68140
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 152.13104 | spectral_norm = 11.70266 | nuclear_norm = 3574.91504
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 184.02948 | spectral_norm = 13.95996 | nuclear_norm = 4895.19580
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 92.10736 | spectral_norm = 7.50216 | nuclear_norm = 2437.51831
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 83.34258 | spectral_norm = 7.46168 | nuclear_norm = 1935.08386
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 82.22739 | spectral_norm = 7.28931 | nuclear_norm = 1910.88013
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 149.20837 | spectral_norm = 13.93194 | nuclear_norm = 3418.45605
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 148.07933 | spectral_norm = 12.59050 | nuclear_norm = 3499.06348
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 187.51808 | spectral_norm = 14.02436 | nuclear_norm = 4987.04590
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 92.39682 | spectral_norm = 7.89888 | nuclear_norm = 2442.37793
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 81.50523 | spectral_norm = 7.52867 | nuclear_norm = 1848.04138
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 81.16798 | spectral_norm = 7.12810 | nuclear_norm = 1828.41357
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 159.74646 | spectral_norm = 12.18058 | nuclear_norm = 3706.91382
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 160.50783 | spectral_norm = 10.67638 | nuclear_norm = 3803.71753
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 180.46039 | spectral_norm = 13.12555 | nuclear_norm = 4808.55029
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 88.92513 | spectral_norm = 8.28641 | nuclear_norm = 2350.73340
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 83.20423 | spectral_norm = 8.12948 | nuclear_norm = 1920.97375
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 81.77892 | spectral_norm = 7.95392 | nuclear_norm = 1878.52551
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 142.97246 | spectral_norm = 11.94139 | nuclear_norm = 3301.37744
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 155.51379 | spectral_norm = 10.73541 | nuclear_norm = 3665.98584
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 183.45639 | spectral_norm = 13.11064 | nuclear_norm = 4887.83740
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 90.70380 | spectral_norm = 8.52681 | nuclear_norm = 2385.81543
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 688.61328 | spectral_norm = 157.78201 | nuclear_norm = 17512.19922
===========================================
step:376/1750 train_loss:3.8740 train_time:125545ms step_avg:343.02ms
step:377/1750 train_loss:3.7977 train_time:125939ms step_avg:343.16ms
step:378/1750 train_loss:3.8572 train_time:126372ms step_avg:343.40ms
step:379/1750 train_loss:3.8739 train_time:126861ms step_avg:343.80ms
step:380/1750 train_loss:3.9583 train_time:127207ms step_avg:343.80ms
step:381/1750 train_loss:3.8430 train_time:127552ms step_avg:343.81ms
step:382/1750 train_loss:3.8234 train_time:127900ms step_avg:343.82ms
step:383/1750 train_loss:3.8074 train_time:128248ms step_avg:343.83ms
step:384/1750 train_loss:3.8779 train_time:128594ms step_avg:343.84ms
step:385/1750 train_loss:3.7925 train_time:128944ms step_avg:343.85ms
step:386/1750 train_loss:3.8951 train_time:129292ms step_avg:343.86ms
step:387/1750 train_loss:4.0698 train_time:129641ms step_avg:343.87ms
step:388/1750 train_loss:3.8032 train_time:129990ms step_avg:343.89ms
step:389/1750 train_loss:3.8079 train_time:130338ms step_avg:343.90ms
step:390/1750 train_loss:3.9041 train_time:130692ms step_avg:343.93ms
step:391/1750 train_loss:3.8177 train_time:131049ms step_avg:343.96ms
step:392/1750 train_loss:3.9337 train_time:131403ms step_avg:343.99ms
step:393/1750 train_loss:3.7596 train_time:131760ms step_avg:344.02ms
step:394/1750 train_loss:3.8915 train_time:132117ms step_avg:344.06ms
step:395/1750 train_loss:3.6371 train_time:132475ms step_avg:344.09ms
step:396/1750 train_loss:3.8388 train_time:132834ms step_avg:344.13ms
step:397/1750 train_loss:3.8680 train_time:133192ms step_avg:344.17ms
step:398/1750 train_loss:3.8796 train_time:133547ms step_avg:344.19ms
step:399/1750 train_loss:3.7757 train_time:133902ms step_avg:344.22ms
step:400/1750 train_loss:3.8278 train_time:134264ms step_avg:344.27ms
step:401/1750 train_loss:3.9147 train_time:134617ms step_avg:344.29ms
step:402/1750 train_loss:3.8455 train_time:134975ms step_avg:344.32ms
step:403/1750 train_loss:3.9587 train_time:135332ms step_avg:344.36ms
step:404/1750 train_loss:3.6888 train_time:135689ms step_avg:344.39ms
step:405/1750 train_loss:3.7938 train_time:136045ms step_avg:344.42ms
step:406/1750 train_loss:4.1036 train_time:136401ms step_avg:344.45ms
step:407/1750 train_loss:3.7790 train_time:136758ms step_avg:344.48ms
step:408/1750 train_loss:3.8242 train_time:137112ms step_avg:344.50ms
step:409/1750 train_loss:3.8681 train_time:137470ms step_avg:344.54ms
step:410/1750 train_loss:3.7631 train_time:137825ms step_avg:344.56ms
step:411/1750 train_loss:3.7664 train_time:138181ms step_avg:344.59ms
step:412/1750 train_loss:4.1946 train_time:138537ms step_avg:344.62ms
step:413/1750 train_loss:3.6521 train_time:138893ms step_avg:344.65ms
step:414/1750 train_loss:4.0233 train_time:139249ms step_avg:344.68ms
step:415/1750 train_loss:3.7645 train_time:139605ms step_avg:344.70ms
step:416/1750 train_loss:3.7727 train_time:139964ms step_avg:344.74ms
step:417/1750 train_loss:3.9554 train_time:140323ms step_avg:344.77ms
step:418/1750 train_loss:3.6940 train_time:140678ms step_avg:344.80ms
step:419/1750 train_loss:3.8077 train_time:141033ms step_avg:344.82ms
step:420/1750 train_loss:3.7084 train_time:141392ms step_avg:344.86ms
step:421/1750 train_loss:3.6576 train_time:141750ms step_avg:344.89ms
step:422/1750 train_loss:3.7920 train_time:142107ms step_avg:344.92ms
step:423/1750 train_loss:3.8816 train_time:142465ms step_avg:344.95ms
step:424/1750 train_loss:3.6251 train_time:142824ms step_avg:344.99ms
step:425/1750 train_loss:3.7906 train_time:143183ms step_avg:345.02ms
step:426/1750 train_loss:3.6729 train_time:143539ms step_avg:345.05ms
step:427/1750 train_loss:3.9042 train_time:143897ms step_avg:345.08ms
step:428/1750 train_loss:3.8203 train_time:144255ms step_avg:345.11ms
step:429/1750 train_loss:3.7645 train_time:144612ms step_avg:345.14ms
step:430/1750 train_loss:3.7192 train_time:144967ms step_avg:345.16ms
step:431/1750 train_loss:3.6330 train_time:145323ms step_avg:345.19ms
step:432/1750 train_loss:3.7794 train_time:145680ms step_avg:345.21ms
step:433/1750 train_loss:3.8260 train_time:146038ms step_avg:345.24ms
step:434/1750 train_loss:3.7775 train_time:146395ms step_avg:345.27ms
step:435/1750 train_loss:3.8168 train_time:146753ms step_avg:345.30ms
step:436/1750 train_loss:3.8404 train_time:147111ms step_avg:345.33ms
step:437/1750 train_loss:3.7267 train_time:147469ms step_avg:345.36ms
step:438/1750 train_loss:3.7160 train_time:147826ms step_avg:345.39ms
step:439/1750 train_loss:3.7222 train_time:148184ms step_avg:345.42ms
step:440/1750 train_loss:3.9021 train_time:148539ms step_avg:345.44ms
step:441/1750 train_loss:3.7649 train_time:148897ms step_avg:345.47ms
step:442/1750 train_loss:3.7451 train_time:149253ms step_avg:345.49ms
step:443/1750 train_loss:3.6329 train_time:149611ms step_avg:345.52ms
step:444/1750 train_loss:3.9306 train_time:149968ms step_avg:345.55ms
step:445/1750 train_loss:3.8606 train_time:150327ms step_avg:345.58ms
step:446/1750 train_loss:3.8392 train_time:150684ms step_avg:345.60ms
step:447/1750 train_loss:3.7638 train_time:151042ms step_avg:345.63ms
step:448/1750 train_loss:3.8580 train_time:151401ms step_avg:345.66ms
step:449/1750 train_loss:3.7061 train_time:151761ms step_avg:345.70ms
step:450/1750 train_loss:3.7203 train_time:152118ms step_avg:345.72ms
step:451/1750 train_loss:3.5885 train_time:152477ms step_avg:345.75ms
step:452/1750 train_loss:3.7243 train_time:152833ms step_avg:345.78ms
step:453/1750 train_loss:3.6816 train_time:153190ms step_avg:345.80ms
step:454/1750 train_loss:3.6409 train_time:153550ms step_avg:345.83ms
step:455/1750 train_loss:3.8490 train_time:153907ms step_avg:345.86ms
step:456/1750 train_loss:3.7385 train_time:154261ms step_avg:345.88ms
step:457/1750 train_loss:3.7911 train_time:154617ms step_avg:345.90ms
step:458/1750 train_loss:3.8401 train_time:154972ms step_avg:345.92ms
step:459/1750 train_loss:3.6447 train_time:155329ms step_avg:345.95ms
step:460/1750 train_loss:3.8089 train_time:155684ms step_avg:345.96ms
step:461/1750 train_loss:3.7004 train_time:156039ms step_avg:345.99ms
step:462/1750 train_loss:3.7536 train_time:156396ms step_avg:346.01ms
step:463/1750 train_loss:3.7839 train_time:156751ms step_avg:346.03ms
step:464/1750 train_loss:3.7228 train_time:157105ms step_avg:346.05ms
step:465/1750 train_loss:3.7348 train_time:157461ms step_avg:346.07ms
step:466/1750 train_loss:3.8060 train_time:157818ms step_avg:346.09ms
step:467/1750 train_loss:3.8279 train_time:158175ms step_avg:346.12ms
step:468/1750 train_loss:3.8010 train_time:158529ms step_avg:346.13ms
step:469/1750 train_loss:3.6912 train_time:158885ms step_avg:346.15ms
step:470/1750 train_loss:3.7820 train_time:159238ms step_avg:346.17ms
step:471/1750 train_loss:3.8325 train_time:159595ms step_avg:346.19ms
step:472/1750 train_loss:3.7934 train_time:159954ms step_avg:346.22ms
step:473/1750 train_loss:3.7338 train_time:160308ms step_avg:346.24ms
step:474/1750 train_loss:3.6045 train_time:160661ms step_avg:346.25ms
step:475/1750 train_loss:4.0133 train_time:161014ms step_avg:346.27ms
step:476/1750 train_loss:3.7657 train_time:161370ms step_avg:346.29ms
step:477/1750 train_loss:3.6007 train_time:161727ms step_avg:346.31ms
step:478/1750 train_loss:3.8350 train_time:162083ms step_avg:346.33ms
step:479/1750 train_loss:3.7798 train_time:162439ms step_avg:346.35ms
step:480/1750 train_loss:3.9233 train_time:162795ms step_avg:346.37ms
step:481/1750 train_loss:3.7376 train_time:163151ms step_avg:346.39ms
step:482/1750 train_loss:3.5395 train_time:163507ms step_avg:346.41ms
step:483/1750 train_loss:3.8214 train_time:163862ms step_avg:346.43ms
step:484/1750 train_loss:3.6710 train_time:164219ms step_avg:346.45ms
step:485/1750 train_loss:3.6727 train_time:164573ms step_avg:346.47ms
step:486/1750 train_loss:3.5889 train_time:164930ms step_avg:346.49ms
step:487/1750 train_loss:3.6920 train_time:165285ms step_avg:346.51ms
step:488/1750 train_loss:3.8925 train_time:165641ms step_avg:346.53ms
step:489/1750 train_loss:3.7178 train_time:165997ms step_avg:346.55ms
step:490/1750 train_loss:3.6050 train_time:166353ms step_avg:346.57ms
step:491/1750 train_loss:3.6241 train_time:166707ms step_avg:346.59ms
step:492/1750 train_loss:3.7390 train_time:167063ms step_avg:346.60ms
step:493/1750 train_loss:3.5839 train_time:167423ms step_avg:346.63ms
step:494/1750 train_loss:3.7194 train_time:167778ms step_avg:346.65ms
step:495/1750 train_loss:3.6668 train_time:168135ms step_avg:346.67ms
step:496/1750 train_loss:3.5243 train_time:168490ms step_avg:346.69ms
step:497/1750 train_loss:3.7423 train_time:168845ms step_avg:346.70ms
step:498/1750 train_loss:3.8019 train_time:169201ms step_avg:346.72ms
step:499/1750 train_loss:3.8352 train_time:169557ms step_avg:346.74ms
step:500/1750 train_loss:3.7432 train_time:169916ms step_avg:346.77ms
step:500/1750 val_loss:3.7176 train_time:170006ms step_avg:346.95ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 207.38066 | frobenius_norm = 47559.04297 | spectral_norm = 8977.30371 | nuclear_norm = 1182946.12500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 105.90670 | spectral_norm = 14.31216 | nuclear_norm = 2469.07715
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 102.12426 | spectral_norm = 16.31816 | nuclear_norm = 2364.08105
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 177.02794 | spectral_norm = 11.31140 | nuclear_norm = 4231.06055
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 148.00002 | spectral_norm = 13.27328 | nuclear_norm = 3467.14893
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 218.32097 | spectral_norm = 16.72765 | nuclear_norm = 5805.83789
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 113.28072 | spectral_norm = 9.08921 | nuclear_norm = 3007.53687
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 104.40034 | spectral_norm = 9.79557 | nuclear_norm = 2437.47485
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 101.99603 | spectral_norm = 10.39678 | nuclear_norm = 2375.15234
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 166.40424 | spectral_norm = 13.38747 | nuclear_norm = 3850.77051
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 164.73227 | spectral_norm = 12.51523 | nuclear_norm = 3873.42969
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 222.37807 | spectral_norm = 15.48473 | nuclear_norm = 5921.13135
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 111.41469 | spectral_norm = 9.83658 | nuclear_norm = 2936.75928
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 102.35655 | spectral_norm = 9.51174 | nuclear_norm = 2377.27393
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 101.31950 | spectral_norm = 10.29239 | nuclear_norm = 2348.24146
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 161.18291 | spectral_norm = 14.00830 | nuclear_norm = 3673.56787
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 166.76479 | spectral_norm = 13.37423 | nuclear_norm = 3874.73218
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 228.51268 | spectral_norm = 16.16307 | nuclear_norm = 6080.87500
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 113.95647 | spectral_norm = 10.45442 | nuclear_norm = 3003.20850
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 101.56647 | spectral_norm = 9.42446 | nuclear_norm = 2339.94434
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 101.26019 | spectral_norm = 9.04574 | nuclear_norm = 2338.00684
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 169.90292 | spectral_norm = 14.33262 | nuclear_norm = 3867.71387
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 174.00294 | spectral_norm = 13.36533 | nuclear_norm = 4077.57666
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 229.88989 | spectral_norm = 17.31699 | nuclear_norm = 6118.67139
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 113.29706 | spectral_norm = 10.19232 | nuclear_norm = 2988.95801
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 101.84560 | spectral_norm = 9.67835 | nuclear_norm = 2339.00171
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 101.04386 | spectral_norm = 8.71375 | nuclear_norm = 2322.79272
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 174.66216 | spectral_norm = 15.29554 | nuclear_norm = 3951.11108
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 174.48792 | spectral_norm = 12.90088 | nuclear_norm = 4098.07324
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 232.45656 | spectral_norm = 17.04544 | nuclear_norm = 6197.92041
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 113.11964 | spectral_norm = 9.47636 | nuclear_norm = 2985.81299
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 102.86022 | spectral_norm = 9.51915 | nuclear_norm = 2384.52002
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 101.48288 | spectral_norm = 9.04009 | nuclear_norm = 2356.83252
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 170.61613 | spectral_norm = 14.83059 | nuclear_norm = 3888.84595
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 170.70773 | spectral_norm = 12.67799 | nuclear_norm = 4027.87012
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 235.61343 | spectral_norm = 16.35298 | nuclear_norm = 6287.46387
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 113.11398 | spectral_norm = 9.47910 | nuclear_norm = 2978.17920
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 99.82681 | spectral_norm = 9.79954 | nuclear_norm = 2311.57886
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 97.85405 | spectral_norm = 9.67252 | nuclear_norm = 2272.62402
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 166.72893 | spectral_norm = 13.66920 | nuclear_norm = 3806.66943
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 167.93915 | spectral_norm = 13.78152 | nuclear_norm = 3889.74243
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 232.46935 | spectral_norm = 15.95378 | nuclear_norm = 6198.30713
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 113.73422 | spectral_norm = 9.64109 | nuclear_norm = 2998.92432
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 104.29624 | spectral_norm = 9.64167 | nuclear_norm = 2419.77344
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 102.97762 | spectral_norm = 9.94037 | nuclear_norm = 2385.36133
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 185.82619 | spectral_norm = 16.01110 | nuclear_norm = 4258.93213
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 178.91855 | spectral_norm = 12.77752 | nuclear_norm = 4242.08203
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 225.47676 | spectral_norm = 17.39543 | nuclear_norm = 6004.46973
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 115.20751 | spectral_norm = 9.64101 | nuclear_norm = 3049.46094
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 101.72809 | spectral_norm = 9.63084 | nuclear_norm = 2336.93628
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 100.81887 | spectral_norm = 9.18897 | nuclear_norm = 2314.40186
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 175.46785 | spectral_norm = 14.93945 | nuclear_norm = 3968.24341
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 179.92409 | spectral_norm = 14.20680 | nuclear_norm = 4209.91162
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 228.87935 | spectral_norm = 18.07919 | nuclear_norm = 6091.01758
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 115.94073 | spectral_norm = 10.05690 | nuclear_norm = 3071.10547
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 105.56407 | spectral_norm = 9.87260 | nuclear_norm = 2433.62720
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 103.62567 | spectral_norm = 9.54545 | nuclear_norm = 2394.80493
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 177.72258 | spectral_norm = 17.17392 | nuclear_norm = 4060.30664
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 175.24287 | spectral_norm = 15.33629 | nuclear_norm = 4128.87158
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 233.75041 | spectral_norm = 18.32589 | nuclear_norm = 6217.84082
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 116.18037 | spectral_norm = 10.47474 | nuclear_norm = 3072.99756
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 102.78790 | spectral_norm = 9.95921 | nuclear_norm = 2310.61792
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 102.62832 | spectral_norm = 9.26519 | nuclear_norm = 2285.83521
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 188.32251 | spectral_norm = 14.95149 | nuclear_norm = 4354.39307
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 189.34975 | spectral_norm = 12.72243 | nuclear_norm = 4470.13184
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 224.64255 | spectral_norm = 16.44782 | nuclear_norm = 5988.77490
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 110.77660 | spectral_norm = 11.12080 | nuclear_norm = 2929.20044
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 105.39596 | spectral_norm = 11.25689 | nuclear_norm = 2417.82178
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 103.00697 | spectral_norm = 10.73683 | nuclear_norm = 2352.43945
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 170.74084 | spectral_norm = 14.87907 | nuclear_norm = 3931.19604
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 186.25746 | spectral_norm = 13.06217 | nuclear_norm = 4375.06152
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 230.84044 | spectral_norm = 16.80392 | nuclear_norm = 6149.26562
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 112.85335 | spectral_norm = 11.95329 | nuclear_norm = 2961.97070
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 807.42786 | spectral_norm = 160.29039 | nuclear_norm = 20763.45508
===========================================
step:501/1750 train_loss:3.8149 train_time:170266ms step_avg:346.77ms
step:502/1750 train_loss:3.7591 train_time:170617ms step_avg:346.78ms
step:503/1750 train_loss:3.7894 train_time:170970ms step_avg:346.80ms
step:504/1750 train_loss:3.7389 train_time:171321ms step_avg:346.80ms
step:505/1750 train_loss:3.8112 train_time:171675ms step_avg:346.82ms
step:506/1750 train_loss:3.6664 train_time:172029ms step_avg:346.83ms
step:507/1750 train_loss:3.7735 train_time:172383ms step_avg:346.85ms
step:508/1750 train_loss:3.8457 train_time:172740ms step_avg:346.87ms
step:509/1750 train_loss:3.7895 train_time:173093ms step_avg:346.88ms
step:510/1750 train_loss:3.5872 train_time:173447ms step_avg:346.89ms
step:511/1750 train_loss:3.7929 train_time:173802ms step_avg:346.91ms
step:512/1750 train_loss:3.7451 train_time:174161ms step_avg:346.93ms
step:513/1750 train_loss:3.6745 train_time:174518ms step_avg:346.95ms
step:514/1750 train_loss:3.8466 train_time:174876ms step_avg:346.98ms
step:515/1750 train_loss:3.7465 train_time:175230ms step_avg:346.99ms
step:516/1750 train_loss:4.0923 train_time:175586ms step_avg:347.01ms
step:517/1750 train_loss:3.6980 train_time:175941ms step_avg:347.02ms
step:518/1750 train_loss:3.7863 train_time:176295ms step_avg:347.04ms
step:519/1750 train_loss:3.6760 train_time:176650ms step_avg:347.05ms
step:520/1750 train_loss:3.6985 train_time:177011ms step_avg:347.08ms
step:521/1750 train_loss:3.6710 train_time:177374ms step_avg:347.11ms
step:522/1750 train_loss:3.6655 train_time:177738ms step_avg:347.15ms
step:523/1750 train_loss:4.2912 train_time:178101ms step_avg:347.17ms
step:524/1750 train_loss:3.7542 train_time:178460ms step_avg:347.20ms
step:525/1750 train_loss:3.6928 train_time:178823ms step_avg:347.23ms
step:526/1750 train_loss:3.7075 train_time:179185ms step_avg:347.26ms
step:527/1750 train_loss:3.6724 train_time:179548ms step_avg:347.29ms
step:528/1750 train_loss:3.6384 train_time:179910ms step_avg:347.32ms
step:529/1750 train_loss:3.8652 train_time:180272ms step_avg:347.35ms
step:530/1750 train_loss:3.6533 train_time:180636ms step_avg:347.38ms
step:531/1750 train_loss:3.9326 train_time:181000ms step_avg:347.41ms
step:532/1750 train_loss:3.7444 train_time:181360ms step_avg:347.43ms
step:533/1750 train_loss:3.6688 train_time:181721ms step_avg:347.46ms
step:534/1750 train_loss:3.6793 train_time:182081ms step_avg:347.48ms
step:535/1750 train_loss:3.6189 train_time:182444ms step_avg:347.51ms
step:536/1750 train_loss:3.7636 train_time:182809ms step_avg:347.55ms
step:537/1750 train_loss:3.7413 train_time:183175ms step_avg:347.58ms
step:538/1750 train_loss:3.6363 train_time:183541ms step_avg:347.62ms
step:539/1750 train_loss:4.1287 train_time:183910ms step_avg:347.66ms
step:540/1750 train_loss:3.6879 train_time:184272ms step_avg:347.68ms
step:541/1750 train_loss:3.7993 train_time:184632ms step_avg:347.71ms
step:542/1750 train_loss:3.6151 train_time:184996ms step_avg:347.74ms
step:543/1750 train_loss:3.6007 train_time:185360ms step_avg:347.77ms
step:544/1750 train_loss:3.6519 train_time:185722ms step_avg:347.79ms
step:545/1750 train_loss:3.6026 train_time:186085ms step_avg:347.82ms
step:546/1750 train_loss:3.6344 train_time:186449ms step_avg:347.85ms
step:547/1750 train_loss:3.6552 train_time:186812ms step_avg:347.88ms
step:548/1750 train_loss:3.6305 train_time:187176ms step_avg:347.91ms
step:549/1750 train_loss:3.7408 train_time:187540ms step_avg:347.94ms
step:550/1750 train_loss:3.6317 train_time:187904ms step_avg:347.97ms
step:551/1750 train_loss:3.6419 train_time:188265ms step_avg:348.00ms
step:552/1750 train_loss:3.9481 train_time:188628ms step_avg:348.02ms
step:553/1750 train_loss:3.7756 train_time:188990ms step_avg:348.05ms
step:554/1750 train_loss:3.7248 train_time:189350ms step_avg:348.07ms
step:555/1750 train_loss:3.6421 train_time:189712ms step_avg:348.10ms
step:556/1750 train_loss:3.7109 train_time:190071ms step_avg:348.12ms
step:557/1750 train_loss:3.3294 train_time:190433ms step_avg:348.14ms
step:558/1750 train_loss:3.6291 train_time:190795ms step_avg:348.17ms
step:559/1750 train_loss:3.6612 train_time:191155ms step_avg:348.19ms
step:560/1750 train_loss:3.7101 train_time:191516ms step_avg:348.21ms
step:561/1750 train_loss:3.6235 train_time:191875ms step_avg:348.23ms
step:562/1750 train_loss:3.5626 train_time:192238ms step_avg:348.26ms
step:563/1750 train_loss:3.7705 train_time:192601ms step_avg:348.28ms
step:564/1750 train_loss:3.5842 train_time:192967ms step_avg:348.32ms
step:565/1750 train_loss:3.6997 train_time:193327ms step_avg:348.34ms
step:566/1750 train_loss:3.6378 train_time:193711ms step_avg:348.40ms
step:567/1750 train_loss:3.6149 train_time:194245ms step_avg:348.73ms
step:568/1750 train_loss:3.7041 train_time:194609ms step_avg:348.76ms
step:569/1750 train_loss:3.6638 train_time:195118ms step_avg:349.05ms
step:570/1750 train_loss:3.7047 train_time:195474ms step_avg:349.06ms
step:571/1750 train_loss:3.7736 train_time:195832ms step_avg:349.08ms
step:572/1750 train_loss:3.7426 train_time:196194ms step_avg:349.10ms
step:573/1750 train_loss:3.7510 train_time:196560ms step_avg:349.13ms
step:574/1750 train_loss:3.7853 train_time:196928ms step_avg:349.16ms
step:575/1750 train_loss:3.7376 train_time:197290ms step_avg:349.19ms
step:576/1750 train_loss:3.7758 train_time:197650ms step_avg:349.21ms
step:577/1750 train_loss:3.6866 train_time:198011ms step_avg:349.23ms
step:578/1750 train_loss:3.6861 train_time:198373ms step_avg:349.25ms
step:579/1750 train_loss:3.6880 train_time:198734ms step_avg:349.27ms
step:580/1750 train_loss:3.6088 train_time:199097ms step_avg:349.29ms
step:581/1750 train_loss:3.6521 train_time:199460ms step_avg:349.32ms
step:582/1750 train_loss:3.8749 train_time:199823ms step_avg:349.34ms
step:583/1750 train_loss:3.6422 train_time:200185ms step_avg:349.36ms
step:584/1750 train_loss:3.6066 train_time:200549ms step_avg:349.39ms
step:585/1750 train_loss:3.7971 train_time:200908ms step_avg:349.40ms
step:586/1750 train_loss:3.5297 train_time:201269ms step_avg:349.43ms
step:587/1750 train_loss:3.6848 train_time:201629ms step_avg:349.44ms
step:588/1750 train_loss:3.6620 train_time:201990ms step_avg:349.46ms
step:589/1750 train_loss:4.0131 train_time:202351ms step_avg:349.48ms
step:590/1750 train_loss:3.7910 train_time:202709ms step_avg:349.50ms
step:591/1750 train_loss:3.5246 train_time:203069ms step_avg:349.52ms
step:592/1750 train_loss:3.5514 train_time:203433ms step_avg:349.54ms
step:593/1750 train_loss:3.5162 train_time:203796ms step_avg:349.56ms
step:594/1750 train_loss:3.5731 train_time:204156ms step_avg:349.58ms
step:595/1750 train_loss:3.9363 train_time:204519ms step_avg:349.61ms
step:596/1750 train_loss:3.6590 train_time:204882ms step_avg:349.63ms
step:597/1750 train_loss:3.5987 train_time:205240ms step_avg:349.64ms
step:598/1750 train_loss:3.6758 train_time:205600ms step_avg:349.66ms
step:599/1750 train_loss:3.4888 train_time:205961ms step_avg:349.68ms
step:600/1750 train_loss:3.6135 train_time:206325ms step_avg:349.70ms
step:601/1750 train_loss:3.6517 train_time:206685ms step_avg:349.72ms
step:602/1750 train_loss:3.6867 train_time:207047ms step_avg:349.74ms
step:603/1750 train_loss:3.8009 train_time:207409ms step_avg:349.76ms
step:604/1750 train_loss:3.6237 train_time:207769ms step_avg:349.78ms
step:605/1750 train_loss:3.6227 train_time:208129ms step_avg:349.80ms
step:606/1750 train_loss:3.5859 train_time:208490ms step_avg:349.81ms
step:607/1750 train_loss:3.8513 train_time:208849ms step_avg:349.83ms
step:608/1750 train_loss:3.6602 train_time:209210ms step_avg:349.85ms
step:609/1750 train_loss:3.6262 train_time:209568ms step_avg:349.86ms
step:610/1750 train_loss:3.7210 train_time:209925ms step_avg:349.88ms
step:611/1750 train_loss:3.6103 train_time:210286ms step_avg:349.89ms
step:612/1750 train_loss:3.5860 train_time:210647ms step_avg:349.91ms
step:613/1750 train_loss:3.7772 train_time:211008ms step_avg:349.93ms
step:614/1750 train_loss:3.7167 train_time:211370ms step_avg:349.95ms
step:615/1750 train_loss:3.7057 train_time:211729ms step_avg:349.96ms
step:616/1750 train_loss:3.6450 train_time:212088ms step_avg:349.98ms
step:617/1750 train_loss:3.5694 train_time:212448ms step_avg:350.00ms
step:618/1750 train_loss:3.7065 train_time:212808ms step_avg:350.01ms
step:619/1750 train_loss:3.5707 train_time:213169ms step_avg:350.03ms
step:620/1750 train_loss:3.5995 train_time:213531ms step_avg:350.05ms
step:621/1750 train_loss:3.9433 train_time:213894ms step_avg:350.07ms
step:622/1750 train_loss:3.5829 train_time:214257ms step_avg:350.09ms
step:623/1750 train_loss:3.6145 train_time:214621ms step_avg:350.12ms
step:624/1750 train_loss:3.7085 train_time:214979ms step_avg:350.13ms
step:625/1750 train_loss:3.7227 train_time:215340ms step_avg:350.15ms
step:625/1750 val_loss:3.6371 train_time:215436ms step_avg:350.30ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 225.90170 | frobenius_norm = 51880.99609 | spectral_norm = 9560.99902 | nuclear_norm = 1294460.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 123.26353 | spectral_norm = 17.92254 | nuclear_norm = 2864.32275
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 118.56701 | spectral_norm = 20.07805 | nuclear_norm = 2735.03809
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 204.83821 | spectral_norm = 13.21690 | nuclear_norm = 4915.45117
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 165.95634 | spectral_norm = 15.52521 | nuclear_norm = 3878.88037
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 255.58589 | spectral_norm = 19.91648 | nuclear_norm = 6798.34473
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 132.80919 | spectral_norm = 11.27209 | nuclear_norm = 3524.50513
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 121.64024 | spectral_norm = 11.58080 | nuclear_norm = 2830.07910
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 118.64412 | spectral_norm = 12.04154 | nuclear_norm = 2753.49023
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 187.75259 | spectral_norm = 15.41506 | nuclear_norm = 4340.96631
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 186.01134 | spectral_norm = 14.23993 | nuclear_norm = 4369.79150
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 257.94891 | spectral_norm = 18.46103 | nuclear_norm = 6870.07129
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 129.08977 | spectral_norm = 12.01980 | nuclear_norm = 3398.95801
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 119.40411 | spectral_norm = 11.34385 | nuclear_norm = 2762.76782
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 118.29205 | spectral_norm = 11.91432 | nuclear_norm = 2731.24365
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 183.01204 | spectral_norm = 16.26226 | nuclear_norm = 4165.07520
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 188.94119 | spectral_norm = 15.61824 | nuclear_norm = 4381.98438
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 264.30603 | spectral_norm = 19.37837 | nuclear_norm = 7032.31592
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 132.36307 | spectral_norm = 12.68810 | nuclear_norm = 3484.44653
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 118.48573 | spectral_norm = 11.29292 | nuclear_norm = 2712.69702
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 117.97189 | spectral_norm = 10.66800 | nuclear_norm = 2711.79834
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 193.95982 | spectral_norm = 16.59680 | nuclear_norm = 4408.14648
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 198.07846 | spectral_norm = 15.47216 | nuclear_norm = 4631.41699
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 266.44135 | spectral_norm = 21.22649 | nuclear_norm = 7090.88281
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 131.46483 | spectral_norm = 12.40390 | nuclear_norm = 3465.45898
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 118.69254 | spectral_norm = 11.63795 | nuclear_norm = 2710.73291
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 117.38499 | spectral_norm = 10.36334 | nuclear_norm = 2684.46240
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 200.46866 | spectral_norm = 17.74028 | nuclear_norm = 4530.23096
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 200.26877 | spectral_norm = 14.71759 | nuclear_norm = 4703.02783
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 269.84357 | spectral_norm = 20.76170 | nuclear_norm = 7194.17920
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 131.32010 | spectral_norm = 11.47377 | nuclear_norm = 3465.58984
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 120.10638 | spectral_norm = 11.35447 | nuclear_norm = 2771.58545
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 118.12638 | spectral_norm = 10.82273 | nuclear_norm = 2735.04932
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 195.78549 | spectral_norm = 17.18292 | nuclear_norm = 4463.56885
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 195.96835 | spectral_norm = 14.55140 | nuclear_norm = 4627.01709
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 273.53799 | spectral_norm = 19.64744 | nuclear_norm = 7303.57617
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 131.07350 | spectral_norm = 11.46518 | nuclear_norm = 3450.68848
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 116.58579 | spectral_norm = 11.82818 | nuclear_norm = 2686.95557
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 113.90775 | spectral_norm = 11.55469 | nuclear_norm = 2635.63550
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 191.13817 | spectral_norm = 15.79717 | nuclear_norm = 4365.84961
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 190.66048 | spectral_norm = 15.91520 | nuclear_norm = 4404.57227
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 270.09616 | spectral_norm = 18.77059 | nuclear_norm = 7206.01416
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 132.25931 | spectral_norm = 12.03913 | nuclear_norm = 3485.74219
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 122.06532 | spectral_norm = 11.45643 | nuclear_norm = 2819.63208
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 120.43282 | spectral_norm = 11.97126 | nuclear_norm = 2775.56006
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 212.61166 | spectral_norm = 19.11065 | nuclear_norm = 4856.24170
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 205.32509 | spectral_norm = 14.66256 | nuclear_norm = 4869.41406
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 260.99609 | spectral_norm = 20.69399 | nuclear_norm = 6953.19971
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 134.44215 | spectral_norm = 11.93439 | nuclear_norm = 3559.01001
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 118.43040 | spectral_norm = 11.51512 | nuclear_norm = 2701.79639
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 117.38523 | spectral_norm = 10.83973 | nuclear_norm = 2679.93311
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 200.50401 | spectral_norm = 17.30339 | nuclear_norm = 4521.56250
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 204.52167 | spectral_norm = 16.35575 | nuclear_norm = 4772.95605
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 266.76913 | spectral_norm = 21.74250 | nuclear_norm = 7099.08105
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 135.64807 | spectral_norm = 12.49810 | nuclear_norm = 3592.92627
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 123.55673 | spectral_norm = 11.87248 | nuclear_norm = 2831.32690
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 120.99445 | spectral_norm = 11.47671 | nuclear_norm = 2780.64600
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 203.11345 | spectral_norm = 20.16222 | nuclear_norm = 4624.42480
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 199.69800 | spectral_norm = 17.67080 | nuclear_norm = 4698.97412
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 272.77438 | spectral_norm = 22.18171 | nuclear_norm = 7254.93604
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 136.24814 | spectral_norm = 12.88954 | nuclear_norm = 3603.63745
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 120.02460 | spectral_norm = 12.07466 | nuclear_norm = 2677.13330
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 120.16958 | spectral_norm = 11.19301 | nuclear_norm = 2648.35986
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 212.96471 | spectral_norm = 17.54390 | nuclear_norm = 4909.72314
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 214.31642 | spectral_norm = 14.46466 | nuclear_norm = 5051.50439
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 262.31638 | spectral_norm = 19.43168 | nuclear_norm = 6993.93945
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 129.06657 | spectral_norm = 13.65656 | nuclear_norm = 3413.00708
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 123.17278 | spectral_norm = 13.94455 | nuclear_norm = 2806.27002
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 120.03401 | spectral_norm = 13.19325 | nuclear_norm = 2724.76001
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 195.67517 | spectral_norm = 17.87507 | nuclear_norm = 4491.83594
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 214.23085 | spectral_norm = 15.06658 | nuclear_norm = 5022.67480
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 270.48849 | spectral_norm = 20.35623 | nuclear_norm = 7201.97607
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 131.82622 | spectral_norm = 15.18548 | nuclear_norm = 3453.68823
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 911.64374 | spectral_norm = 161.40927 | nuclear_norm = 23613.30078
===========================================
step:626/1750 train_loss:3.7495 train_time:215699ms step_avg:350.16ms
step:627/1750 train_loss:3.7295 train_time:216055ms step_avg:350.17ms
step:628/1750 train_loss:3.7795 train_time:216411ms step_avg:350.18ms
step:629/1750 train_loss:3.6148 train_time:216768ms step_avg:350.19ms
step:630/1750 train_loss:3.7405 train_time:217127ms step_avg:350.20ms
step:631/1750 train_loss:3.7597 train_time:217484ms step_avg:350.22ms
step:632/1750 train_loss:3.6653 train_time:217846ms step_avg:350.23ms
step:633/1750 train_loss:3.6139 train_time:218207ms step_avg:350.25ms
step:634/1750 train_loss:3.7219 train_time:218564ms step_avg:350.26ms
step:635/1750 train_loss:3.9671 train_time:218920ms step_avg:350.27ms
step:636/1750 train_loss:3.5642 train_time:219280ms step_avg:350.29ms
step:637/1750 train_loss:3.3692 train_time:219644ms step_avg:350.31ms
step:638/1750 train_loss:3.6041 train_time:220002ms step_avg:350.32ms
step:639/1750 train_loss:3.6462 train_time:220359ms step_avg:350.33ms
step:640/1750 train_loss:3.5812 train_time:220718ms step_avg:350.35ms
step:641/1750 train_loss:3.5941 train_time:221078ms step_avg:350.36ms
step:642/1750 train_loss:3.6500 train_time:221437ms step_avg:350.38ms
step:643/1750 train_loss:3.6221 train_time:221798ms step_avg:350.39ms
step:644/1750 train_loss:3.5705 train_time:222157ms step_avg:350.40ms
step:645/1750 train_loss:3.7959 train_time:222518ms step_avg:350.42ms
step:646/1750 train_loss:3.6926 train_time:222879ms step_avg:350.44ms
step:647/1750 train_loss:3.6854 train_time:223240ms step_avg:350.45ms
step:648/1750 train_loss:3.7298 train_time:223604ms step_avg:350.48ms
step:649/1750 train_loss:3.7828 train_time:223964ms step_avg:350.49ms
step:650/1750 train_loss:3.6381 train_time:224328ms step_avg:350.51ms
step:651/1750 train_loss:3.7867 train_time:224696ms step_avg:350.54ms
step:652/1750 train_loss:3.5968 train_time:225064ms step_avg:350.57ms
step:653/1750 train_loss:3.6777 train_time:225431ms step_avg:350.59ms
step:654/1750 train_loss:3.4421 train_time:225799ms step_avg:350.62ms
step:655/1750 train_loss:3.5942 train_time:226162ms step_avg:350.64ms
step:656/1750 train_loss:3.5947 train_time:226526ms step_avg:350.66ms
step:657/1750 train_loss:3.5164 train_time:226890ms step_avg:350.68ms
step:658/1750 train_loss:3.7015 train_time:227256ms step_avg:350.70ms
step:659/1750 train_loss:3.6019 train_time:227620ms step_avg:350.72ms
step:660/1750 train_loss:3.7025 train_time:227985ms step_avg:350.75ms
step:661/1750 train_loss:3.7665 train_time:228354ms step_avg:350.77ms
step:662/1750 train_loss:3.6797 train_time:228718ms step_avg:350.79ms
step:663/1750 train_loss:3.5653 train_time:229085ms step_avg:350.82ms
step:664/1750 train_loss:3.6310 train_time:229453ms step_avg:350.85ms
step:665/1750 train_loss:3.5057 train_time:229820ms step_avg:350.87ms
step:666/1750 train_loss:3.7929 train_time:230185ms step_avg:350.89ms
step:667/1750 train_loss:3.6258 train_time:230552ms step_avg:350.92ms
step:668/1750 train_loss:3.6590 train_time:230924ms step_avg:350.95ms
step:669/1750 train_loss:3.4974 train_time:231294ms step_avg:350.98ms
step:670/1750 train_loss:3.6157 train_time:231660ms step_avg:351.00ms
step:671/1750 train_loss:3.5773 train_time:232029ms step_avg:351.03ms
step:672/1750 train_loss:3.5799 train_time:232397ms step_avg:351.05ms
step:673/1750 train_loss:3.8607 train_time:232763ms step_avg:351.08ms
step:674/1750 train_loss:3.6418 train_time:233131ms step_avg:351.10ms
step:675/1750 train_loss:3.7249 train_time:233499ms step_avg:351.13ms
step:676/1750 train_loss:3.5079 train_time:233866ms step_avg:351.15ms
step:677/1750 train_loss:3.6132 train_time:234233ms step_avg:351.17ms
step:678/1750 train_loss:3.5680 train_time:234602ms step_avg:351.20ms
step:679/1750 train_loss:3.6884 train_time:234970ms step_avg:351.23ms
step:680/1750 train_loss:3.6033 train_time:235338ms step_avg:351.25ms
step:681/1750 train_loss:3.6307 train_time:235706ms step_avg:351.28ms
step:682/1750 train_loss:3.6802 train_time:236078ms step_avg:351.31ms
step:683/1750 train_loss:3.7568 train_time:236444ms step_avg:351.33ms
step:684/1750 train_loss:3.6606 train_time:236808ms step_avg:351.35ms
step:685/1750 train_loss:3.7079 train_time:237175ms step_avg:351.37ms
step:686/1750 train_loss:3.6475 train_time:237542ms step_avg:351.39ms
step:687/1750 train_loss:3.6860 train_time:237905ms step_avg:351.41ms
step:688/1750 train_loss:3.2514 train_time:238278ms step_avg:351.44ms
step:689/1750 train_loss:3.4226 train_time:238650ms step_avg:351.47ms
step:690/1750 train_loss:3.5607 train_time:239022ms step_avg:351.50ms
step:691/1750 train_loss:3.4334 train_time:239386ms step_avg:351.52ms
step:692/1750 train_loss:3.6456 train_time:239753ms step_avg:351.54ms
step:693/1750 train_loss:3.6654 train_time:240120ms step_avg:351.57ms
step:694/1750 train_loss:3.5695 train_time:240486ms step_avg:351.59ms
step:695/1750 train_loss:3.5552 train_time:240847ms step_avg:351.60ms
step:696/1750 train_loss:3.8736 train_time:241213ms step_avg:351.62ms
step:697/1750 train_loss:3.6024 train_time:241579ms step_avg:351.64ms
step:698/1750 train_loss:3.6597 train_time:241945ms step_avg:351.66ms
step:699/1750 train_loss:3.7875 train_time:242312ms step_avg:351.69ms
step:700/1750 train_loss:3.5869 train_time:242681ms step_avg:351.71ms
step:701/1750 train_loss:3.5626 train_time:243045ms step_avg:351.73ms
step:702/1750 train_loss:3.5340 train_time:243414ms step_avg:351.75ms
step:703/1750 train_loss:3.5108 train_time:243780ms step_avg:351.77ms
step:704/1750 train_loss:3.5852 train_time:244147ms step_avg:351.80ms
step:705/1750 train_loss:3.5752 train_time:244521ms step_avg:351.83ms
step:706/1750 train_loss:3.6038 train_time:244895ms step_avg:351.86ms
step:707/1750 train_loss:3.6694 train_time:245261ms step_avg:351.88ms
step:708/1750 train_loss:3.6184 train_time:245626ms step_avg:351.90ms
step:709/1750 train_loss:3.5947 train_time:245992ms step_avg:351.92ms
step:710/1750 train_loss:3.5608 train_time:246360ms step_avg:351.94ms
step:711/1750 train_loss:3.6108 train_time:246730ms step_avg:351.97ms
step:712/1750 train_loss:3.6709 train_time:247100ms step_avg:351.99ms
step:713/1750 train_loss:3.6702 train_time:247471ms step_avg:352.02ms
step:714/1750 train_loss:3.5784 train_time:247835ms step_avg:352.04ms
step:715/1750 train_loss:3.5860 train_time:248199ms step_avg:352.05ms
step:716/1750 train_loss:3.6002 train_time:248563ms step_avg:352.07ms
step:717/1750 train_loss:3.7347 train_time:248930ms step_avg:352.09ms
step:718/1750 train_loss:3.6166 train_time:249293ms step_avg:352.11ms
step:719/1750 train_loss:3.6947 train_time:249656ms step_avg:352.12ms
step:720/1750 train_loss:3.8601 train_time:250024ms step_avg:352.15ms
step:721/1750 train_loss:3.4840 train_time:250388ms step_avg:352.16ms
step:722/1750 train_loss:3.7505 train_time:250753ms step_avg:352.18ms
step:723/1750 train_loss:3.7898 train_time:251117ms step_avg:352.20ms
step:724/1750 train_loss:3.5827 train_time:251484ms step_avg:352.22ms
step:725/1750 train_loss:3.6668 train_time:251849ms step_avg:352.24ms
step:726/1750 train_loss:3.5510 train_time:252215ms step_avg:352.26ms
step:727/1750 train_loss:3.5903 train_time:252584ms step_avg:352.28ms
step:728/1750 train_loss:3.7522 train_time:252951ms step_avg:352.30ms
step:729/1750 train_loss:3.6912 train_time:253316ms step_avg:352.32ms
step:730/1750 train_loss:3.6824 train_time:253683ms step_avg:352.34ms
step:731/1750 train_loss:3.5745 train_time:254046ms step_avg:352.35ms
step:732/1750 train_loss:3.6122 train_time:254409ms step_avg:352.37ms
step:733/1750 train_loss:3.8540 train_time:254778ms step_avg:352.39ms
step:734/1750 train_loss:3.5844 train_time:255146ms step_avg:352.41ms
step:735/1750 train_loss:3.6316 train_time:255512ms step_avg:352.43ms
step:736/1750 train_loss:3.7605 train_time:255878ms step_avg:352.45ms
step:737/1750 train_loss:3.6918 train_time:256242ms step_avg:352.47ms
step:738/1750 train_loss:3.6160 train_time:256607ms step_avg:352.48ms
step:739/1750 train_loss:3.5165 train_time:256974ms step_avg:352.50ms
step:740/1750 train_loss:4.1267 train_time:257348ms step_avg:352.53ms
step:741/1750 train_loss:3.5088 train_time:257713ms step_avg:352.55ms
step:742/1750 train_loss:3.5681 train_time:258075ms step_avg:352.56ms
step:743/1750 train_loss:3.5958 train_time:258439ms step_avg:352.58ms
step:744/1750 train_loss:3.6632 train_time:258805ms step_avg:352.60ms
step:745/1750 train_loss:3.6051 train_time:259175ms step_avg:352.62ms
step:746/1750 train_loss:3.6143 train_time:259537ms step_avg:352.63ms
step:747/1750 train_loss:3.6672 train_time:259907ms step_avg:352.66ms
step:748/1750 train_loss:3.5921 train_time:260280ms step_avg:352.68ms
step:749/1750 train_loss:3.5807 train_time:260645ms step_avg:352.70ms
step:750/1750 train_loss:3.6175 train_time:261009ms step_avg:352.71ms
step:750/1750 val_loss:3.5849 train_time:261104ms step_avg:352.84ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 242.03725 | frobenius_norm = 55651.52734 | spectral_norm = 10091.20117 | nuclear_norm = 1392263.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 138.35399 | spectral_norm = 21.28502 | nuclear_norm = 3204.92261
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 132.90826 | spectral_norm = 23.82429 | nuclear_norm = 3055.93701
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 229.42813 | spectral_norm = 14.96649 | nuclear_norm = 5525.91895
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 180.95779 | spectral_norm = 17.41978 | nuclear_norm = 4221.88965
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 287.86716 | spectral_norm = 22.68758 | nuclear_norm = 7659.84668
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 149.67287 | spectral_norm = 13.13191 | nuclear_norm = 3970.76538
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 136.98944 | spectral_norm = 13.17939 | nuclear_norm = 3179.85718
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 133.38080 | spectral_norm = 13.42093 | nuclear_norm = 3089.08789
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 206.72597 | spectral_norm = 16.96287 | nuclear_norm = 4775.33594
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 204.73245 | spectral_norm = 15.80405 | nuclear_norm = 4808.53418
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 289.77609 | spectral_norm = 21.16766 | nuclear_norm = 7722.43359
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 144.43471 | spectral_norm = 13.98150 | nuclear_norm = 3799.55469
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 134.13123 | spectral_norm = 13.14573 | nuclear_norm = 3094.59277
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 132.97632 | spectral_norm = 13.28350 | nuclear_norm = 3059.68481
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 202.91948 | spectral_norm = 18.28402 | nuclear_norm = 4615.06055
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 209.02371 | spectral_norm = 17.80266 | nuclear_norm = 4842.12988
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 295.61642 | spectral_norm = 22.46173 | nuclear_norm = 7864.40186
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 148.36482 | spectral_norm = 14.80971 | nuclear_norm = 3902.58105
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 133.18306 | spectral_norm = 13.04048 | nuclear_norm = 3035.10400
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 132.50296 | spectral_norm = 12.05450 | nuclear_norm = 3033.92920
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 215.81480 | spectral_norm = 18.66702 | nuclear_norm = 4898.98828
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 219.75249 | spectral_norm = 17.53188 | nuclear_norm = 5133.88672
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 298.39062 | spectral_norm = 24.93022 | nuclear_norm = 7938.07520
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 147.19313 | spectral_norm = 14.40600 | nuclear_norm = 3877.54321
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 133.28561 | spectral_norm = 13.17230 | nuclear_norm = 3030.69727
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 131.49867 | spectral_norm = 11.89464 | nuclear_norm = 2994.20703
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 223.95341 | spectral_norm = 19.96203 | nuclear_norm = 5057.17627
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 223.25537 | spectral_norm = 16.34969 | nuclear_norm = 5245.87988
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 302.63211 | spectral_norm = 24.29599 | nuclear_norm = 8068.47314
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 147.21576 | spectral_norm = 13.31131 | nuclear_norm = 3884.38916
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 134.90247 | spectral_norm = 13.14743 | nuclear_norm = 3101.35254
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 132.59190 | spectral_norm = 12.32951 | nuclear_norm = 3062.34326
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 218.62834 | spectral_norm = 19.44646 | nuclear_norm = 4985.09375
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 218.74055 | spectral_norm = 16.14533 | nuclear_norm = 5169.45898
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 306.99518 | spectral_norm = 22.71453 | nuclear_norm = 8200.78906
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 146.78075 | spectral_norm = 13.28634 | nuclear_norm = 3864.10547
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 131.07132 | spectral_norm = 13.62317 | nuclear_norm = 3006.99170
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 127.90958 | spectral_norm = 13.10408 | nuclear_norm = 2951.10693
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 213.06407 | spectral_norm = 17.55635 | nuclear_norm = 4870.20361
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 211.22977 | spectral_norm = 17.68390 | nuclear_norm = 4872.97949
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 303.61603 | spectral_norm = 21.62422 | nuclear_norm = 8104.36523
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 148.47540 | spectral_norm = 14.26159 | nuclear_norm = 3911.87036
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 137.25000 | spectral_norm = 13.21179 | nuclear_norm = 3158.18481
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 135.57111 | spectral_norm = 13.73225 | nuclear_norm = 3113.85254
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 236.45755 | spectral_norm = 22.02314 | nuclear_norm = 5383.65625
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 228.68654 | spectral_norm = 16.24564 | nuclear_norm = 5427.27734
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 292.48819 | spectral_norm = 23.75386 | nuclear_norm = 7794.33203
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 151.13004 | spectral_norm = 14.03142 | nuclear_norm = 4000.29468
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 132.69104 | spectral_norm = 13.27304 | nuclear_norm = 3007.83057
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 131.69290 | spectral_norm = 12.39807 | nuclear_norm = 2993.88232
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 222.77599 | spectral_norm = 19.34303 | nuclear_norm = 5013.95703
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 226.26993 | spectral_norm = 18.08662 | nuclear_norm = 5269.42090
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 300.67999 | spectral_norm = 25.21831 | nuclear_norm = 7999.22266
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 152.84732 | spectral_norm = 14.72102 | nuclear_norm = 4048.07739
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 139.00227 | spectral_norm = 13.65971 | nuclear_norm = 3172.29639
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 136.16936 | spectral_norm = 13.22511 | nuclear_norm = 3117.54688
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 225.93805 | spectral_norm = 22.76911 | nuclear_norm = 5127.11133
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 221.76236 | spectral_norm = 19.62349 | nuclear_norm = 5211.86719
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 307.52121 | spectral_norm = 25.72747 | nuclear_norm = 8176.64746
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 153.89355 | spectral_norm = 15.04243 | nuclear_norm = 4069.69531
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 134.61060 | spectral_norm = 14.02738 | nuclear_norm = 2983.59937
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 135.13843 | spectral_norm = 12.86433 | nuclear_norm = 2956.34644
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 235.04582 | spectral_norm = 20.26005 | nuclear_norm = 5406.61963
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 236.91068 | spectral_norm = 16.13749 | nuclear_norm = 5578.67480
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 296.15891 | spectral_norm = 22.21421 | nuclear_norm = 7894.32227
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 145.29318 | spectral_norm = 15.91749 | nuclear_norm = 3843.11279
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 138.33711 | spectral_norm = 16.30407 | nuclear_norm = 3132.70142
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 134.42348 | spectral_norm = 15.34387 | nuclear_norm = 3035.04761
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 218.66443 | spectral_norm = 20.56437 | nuclear_norm = 5005.66602
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 240.59749 | spectral_norm = 16.90199 | nuclear_norm = 5635.53662
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 306.08630 | spectral_norm = 23.54183 | nuclear_norm = 8146.05078
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 149.35982 | spectral_norm = 18.08514 | nuclear_norm = 3909.63525
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1004.82874 | spectral_norm = 162.13702 | nuclear_norm = 26164.65625
===========================================
step:751/1750 train_loss:3.5867 train_time:261371ms step_avg:352.73ms
step:752/1750 train_loss:3.6341 train_time:261727ms step_avg:352.73ms
step:753/1750 train_loss:3.6348 train_time:262090ms step_avg:352.75ms
step:754/1750 train_loss:3.6101 train_time:262455ms step_avg:352.76ms
step:755/1750 train_loss:3.7018 train_time:262867ms step_avg:352.84ms
step:756/1750 train_loss:3.4766 train_time:263314ms step_avg:352.97ms
step:757/1750 train_loss:3.7429 train_time:263681ms step_avg:352.99ms
step:758/1750 train_loss:3.6679 train_time:264045ms step_avg:353.00ms
step:759/1750 train_loss:3.6090 train_time:264563ms step_avg:353.22ms
step:760/1750 train_loss:3.7210 train_time:264923ms step_avg:353.23ms
step:761/1750 train_loss:3.4201 train_time:265290ms step_avg:353.25ms
step:762/1750 train_loss:3.5607 train_time:265653ms step_avg:353.26ms
step:763/1750 train_loss:3.6872 train_time:266017ms step_avg:353.28ms
step:764/1750 train_loss:3.3380 train_time:266381ms step_avg:353.29ms
step:765/1750 train_loss:3.7495 train_time:266746ms step_avg:353.31ms
step:766/1750 train_loss:3.5889 train_time:267113ms step_avg:353.32ms
step:767/1750 train_loss:3.5830 train_time:267477ms step_avg:353.34ms
step:768/1750 train_loss:3.5910 train_time:267844ms step_avg:353.36ms
step:769/1750 train_loss:3.6067 train_time:268212ms step_avg:353.38ms
step:770/1750 train_loss:3.6651 train_time:268575ms step_avg:353.39ms
step:771/1750 train_loss:3.9064 train_time:268938ms step_avg:353.40ms
step:772/1750 train_loss:3.4700 train_time:269300ms step_avg:353.41ms
step:773/1750 train_loss:3.6553 train_time:269664ms step_avg:353.43ms
step:774/1750 train_loss:3.6596 train_time:270027ms step_avg:353.44ms
step:775/1750 train_loss:3.6276 train_time:270390ms step_avg:353.45ms
step:776/1750 train_loss:3.4115 train_time:270757ms step_avg:353.47ms
step:777/1750 train_loss:3.3974 train_time:271124ms step_avg:353.49ms
step:778/1750 train_loss:3.5087 train_time:271487ms step_avg:353.50ms
step:779/1750 train_loss:3.5938 train_time:271858ms step_avg:353.52ms
step:780/1750 train_loss:3.6128 train_time:272230ms step_avg:353.55ms
step:781/1750 train_loss:3.6863 train_time:272600ms step_avg:353.57ms
step:782/1750 train_loss:3.6053 train_time:272970ms step_avg:353.59ms
step:783/1750 train_loss:3.5871 train_time:273339ms step_avg:353.61ms
step:784/1750 train_loss:3.6145 train_time:273712ms step_avg:353.63ms
step:785/1750 train_loss:3.5782 train_time:274078ms step_avg:353.65ms
step:786/1750 train_loss:3.4553 train_time:274447ms step_avg:353.67ms
step:787/1750 train_loss:3.7278 train_time:274822ms step_avg:353.70ms
step:788/1750 train_loss:3.5175 train_time:275196ms step_avg:353.72ms
step:789/1750 train_loss:3.5672 train_time:275564ms step_avg:353.74ms
step:790/1750 train_loss:3.6452 train_time:275938ms step_avg:353.77ms
step:791/1750 train_loss:3.7910 train_time:276315ms step_avg:353.80ms
step:792/1750 train_loss:3.7781 train_time:276686ms step_avg:353.82ms
step:793/1750 train_loss:3.4934 train_time:277052ms step_avg:353.83ms
step:794/1750 train_loss:3.6104 train_time:277423ms step_avg:353.86ms
step:795/1750 train_loss:3.6825 train_time:277796ms step_avg:353.88ms
step:796/1750 train_loss:3.7373 train_time:278173ms step_avg:353.91ms
step:797/1750 train_loss:3.5497 train_time:278543ms step_avg:353.93ms
step:798/1750 train_loss:3.6625 train_time:278919ms step_avg:353.96ms
step:799/1750 train_loss:3.5650 train_time:279297ms step_avg:353.99ms
step:800/1750 train_loss:3.5478 train_time:279670ms step_avg:354.01ms
step:801/1750 train_loss:3.6510 train_time:280037ms step_avg:354.03ms
step:802/1750 train_loss:3.5080 train_time:280411ms step_avg:354.05ms
step:803/1750 train_loss:3.5202 train_time:280779ms step_avg:354.07ms
step:804/1750 train_loss:3.6415 train_time:281149ms step_avg:354.09ms
step:805/1750 train_loss:3.5456 train_time:281523ms step_avg:354.12ms
step:806/1750 train_loss:3.5807 train_time:281891ms step_avg:354.13ms
step:807/1750 train_loss:3.6662 train_time:282261ms step_avg:354.15ms
step:808/1750 train_loss:3.5754 train_time:282632ms step_avg:354.18ms
step:809/1750 train_loss:3.5148 train_time:282999ms step_avg:354.19ms
step:810/1750 train_loss:3.5839 train_time:283367ms step_avg:354.21ms
step:811/1750 train_loss:3.6076 train_time:283737ms step_avg:354.23ms
step:812/1750 train_loss:3.6130 train_time:284105ms step_avg:354.25ms
step:813/1750 train_loss:3.6505 train_time:284471ms step_avg:354.26ms
step:814/1750 train_loss:3.5933 train_time:284842ms step_avg:354.28ms
step:815/1750 train_loss:3.5870 train_time:285213ms step_avg:354.30ms
step:816/1750 train_loss:3.7033 train_time:285588ms step_avg:354.33ms
step:817/1750 train_loss:3.7860 train_time:285959ms step_avg:354.35ms
step:818/1750 train_loss:3.5420 train_time:286329ms step_avg:354.37ms
step:819/1750 train_loss:3.7383 train_time:286703ms step_avg:354.39ms
step:820/1750 train_loss:3.5155 train_time:287077ms step_avg:354.42ms
step:821/1750 train_loss:3.5792 train_time:287446ms step_avg:354.43ms
step:822/1750 train_loss:3.7118 train_time:287819ms step_avg:354.46ms
step:823/1750 train_loss:3.5965 train_time:288191ms step_avg:354.48ms
step:824/1750 train_loss:3.5268 train_time:288562ms step_avg:354.50ms
step:825/1750 train_loss:3.6326 train_time:288936ms step_avg:354.52ms
step:826/1750 train_loss:3.5048 train_time:289310ms step_avg:354.55ms
step:827/1750 train_loss:3.7555 train_time:289683ms step_avg:354.57ms
step:828/1750 train_loss:3.6416 train_time:290055ms step_avg:354.59ms
step:829/1750 train_loss:3.6565 train_time:290429ms step_avg:354.61ms
step:830/1750 train_loss:3.5475 train_time:290800ms step_avg:354.63ms
step:831/1750 train_loss:3.6182 train_time:291168ms step_avg:354.65ms
step:832/1750 train_loss:3.5313 train_time:291538ms step_avg:354.67ms
step:833/1750 train_loss:3.6702 train_time:291910ms step_avg:354.69ms
step:834/1750 train_loss:3.4979 train_time:292282ms step_avg:354.71ms
step:835/1750 train_loss:3.4785 train_time:292657ms step_avg:354.74ms
step:836/1750 train_loss:3.7309 train_time:293034ms step_avg:354.76ms
step:837/1750 train_loss:3.4201 train_time:293406ms step_avg:354.78ms
step:838/1750 train_loss:3.6062 train_time:293773ms step_avg:354.80ms
step:839/1750 train_loss:3.4348 train_time:294144ms step_avg:354.82ms
step:840/1750 train_loss:3.4879 train_time:294514ms step_avg:354.84ms
step:841/1750 train_loss:3.5823 train_time:294888ms step_avg:354.86ms
step:842/1750 train_loss:3.6031 train_time:295261ms step_avg:354.88ms
step:843/1750 train_loss:3.5800 train_time:295627ms step_avg:354.89ms
step:844/1750 train_loss:3.4444 train_time:295998ms step_avg:354.91ms
step:845/1750 train_loss:3.6800 train_time:296367ms step_avg:354.93ms
step:846/1750 train_loss:3.5310 train_time:296737ms step_avg:354.95ms
step:847/1750 train_loss:3.5090 train_time:297110ms step_avg:354.97ms
step:848/1750 train_loss:3.6538 train_time:297481ms step_avg:354.99ms
step:849/1750 train_loss:3.5150 train_time:297851ms step_avg:355.01ms
step:850/1750 train_loss:3.4587 train_time:298223ms step_avg:355.03ms
step:851/1750 train_loss:3.7608 train_time:298593ms step_avg:355.05ms
step:852/1750 train_loss:3.4619 train_time:298960ms step_avg:355.06ms
step:853/1750 train_loss:3.5862 train_time:299330ms step_avg:355.08ms
step:854/1750 train_loss:3.6690 train_time:299702ms step_avg:355.10ms
step:855/1750 train_loss:3.5407 train_time:300068ms step_avg:355.11ms
step:856/1750 train_loss:3.5625 train_time:300436ms step_avg:355.13ms
step:857/1750 train_loss:3.6268 train_time:300810ms step_avg:355.15ms
step:858/1750 train_loss:3.4904 train_time:301185ms step_avg:355.17ms
step:859/1750 train_loss:3.5821 train_time:301554ms step_avg:355.19ms
step:860/1750 train_loss:3.6130 train_time:301921ms step_avg:355.20ms
step:861/1750 train_loss:3.6529 train_time:302298ms step_avg:355.23ms
step:862/1750 train_loss:3.6178 train_time:302675ms step_avg:355.25ms
step:863/1750 train_loss:3.5912 train_time:303048ms step_avg:355.27ms
step:864/1750 train_loss:3.4055 train_time:303417ms step_avg:355.29ms
step:865/1750 train_loss:3.6148 train_time:303783ms step_avg:355.30ms
step:866/1750 train_loss:3.8950 train_time:304157ms step_avg:355.32ms
step:867/1750 train_loss:3.4692 train_time:304526ms step_avg:355.34ms
step:868/1750 train_loss:3.6553 train_time:304895ms step_avg:355.36ms
step:869/1750 train_loss:3.6361 train_time:305267ms step_avg:355.37ms
step:870/1750 train_loss:3.4673 train_time:305638ms step_avg:355.39ms
step:871/1750 train_loss:3.4305 train_time:306006ms step_avg:355.41ms
step:872/1750 train_loss:3.6751 train_time:306375ms step_avg:355.42ms
step:873/1750 train_loss:3.4746 train_time:306740ms step_avg:355.43ms
step:874/1750 train_loss:3.2381 train_time:307119ms step_avg:355.46ms
step:875/1750 train_loss:3.6558 train_time:307489ms step_avg:355.48ms
step:875/1750 val_loss:3.5413 train_time:307586ms step_avg:355.59ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 256.35574 | frobenius_norm = 59005.17578 | spectral_norm = 10576.27734 | nuclear_norm = 1479568.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 152.04601 | spectral_norm = 24.48738 | nuclear_norm = 3514.17456
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 146.18526 | spectral_norm = 27.60693 | nuclear_norm = 3353.19629
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 250.91850 | spectral_norm = 16.69698 | nuclear_norm = 6062.90918
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 191.83142 | spectral_norm = 19.02429 | nuclear_norm = 4466.73584
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 318.57126 | spectral_norm = 25.39124 | nuclear_norm = 8481.89844
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 165.04262 | spectral_norm = 14.88998 | nuclear_norm = 4377.39355
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 151.06334 | spectral_norm = 14.45315 | nuclear_norm = 3501.21924
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 147.06961 | spectral_norm = 14.73424 | nuclear_norm = 3400.03052
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 224.08983 | spectral_norm = 18.34148 | nuclear_norm = 5171.47852
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 221.53085 | spectral_norm = 17.25890 | nuclear_norm = 5202.25439
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 319.35355 | spectral_norm = 23.71052 | nuclear_norm = 8515.56055
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 158.44160 | spectral_norm = 15.75894 | nuclear_norm = 4165.72070
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 147.52696 | spectral_norm = 14.85300 | nuclear_norm = 3393.82812
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 146.56456 | spectral_norm = 14.46974 | nuclear_norm = 3363.41016
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 221.39307 | spectral_norm = 20.10418 | nuclear_norm = 5030.40234
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 227.58386 | spectral_norm = 19.71700 | nuclear_norm = 5268.38574
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 324.85757 | spectral_norm = 25.57500 | nuclear_norm = 8642.33789
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 163.12393 | spectral_norm = 16.68880 | nuclear_norm = 4287.54395
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 146.45853 | spectral_norm = 14.53040 | nuclear_norm = 3326.64966
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 145.71162 | spectral_norm = 13.43972 | nuclear_norm = 3327.68848
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 236.33278 | spectral_norm = 20.43616 | nuclear_norm = 5356.95752
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 239.94893 | spectral_norm = 19.46227 | nuclear_norm = 5599.32031
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 327.84650 | spectral_norm = 28.41248 | nuclear_norm = 8720.70703
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 161.72954 | spectral_norm = 16.19061 | nuclear_norm = 4258.10645
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 146.64165 | spectral_norm = 14.56421 | nuclear_norm = 3323.01660
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 144.41322 | spectral_norm = 13.32610 | nuclear_norm = 3276.60693
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 245.81062 | spectral_norm = 22.17005 | nuclear_norm = 5547.45215
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 244.45056 | spectral_norm = 17.88901 | nuclear_norm = 5745.39795
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 332.95535 | spectral_norm = 27.75830 | nuclear_norm = 8876.88477
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 161.87321 | spectral_norm = 15.08807 | nuclear_norm = 4270.37891
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 148.40771 | spectral_norm = 14.65386 | nuclear_norm = 3401.00464
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 145.82376 | spectral_norm = 13.76270 | nuclear_norm = 3360.27588
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 239.90164 | spectral_norm = 21.55618 | nuclear_norm = 5472.16895
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 239.65851 | spectral_norm = 17.68679 | nuclear_norm = 5667.51465
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 337.91605 | spectral_norm = 25.61457 | nuclear_norm = 9030.94141
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 161.15598 | spectral_norm = 15.01824 | nuclear_norm = 4243.29834
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 144.30560 | spectral_norm = 15.28474 | nuclear_norm = 3300.36401
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 140.86618 | spectral_norm = 14.54196 | nuclear_norm = 3243.20020
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 233.23213 | spectral_norm = 19.34387 | nuclear_norm = 5336.07568
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 230.26846 | spectral_norm = 19.38532 | nuclear_norm = 5306.71924
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 334.64752 | spectral_norm = 24.42431 | nuclear_norm = 8935.75977
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 163.23825 | spectral_norm = 16.42184 | nuclear_norm = 4299.23291
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 150.90175 | spectral_norm = 14.78711 | nuclear_norm = 3460.13062
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 149.39365 | spectral_norm = 15.38292 | nuclear_norm = 3420.04028
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 258.57239 | spectral_norm = 24.71881 | nuclear_norm = 5869.97852
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 250.12901 | spectral_norm = 17.79834 | nuclear_norm = 5939.94434
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 321.45041 | spectral_norm = 26.74839 | nuclear_norm = 8566.02246
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 166.25613 | spectral_norm = 16.03694 | nuclear_norm = 4400.01807
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 145.71075 | spectral_norm = 14.87683 | nuclear_norm = 3290.19995
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 144.94989 | spectral_norm = 13.88113 | nuclear_norm = 3282.43115
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 243.23071 | spectral_norm = 21.18319 | nuclear_norm = 5464.79590
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 246.07811 | spectral_norm = 19.69989 | nuclear_norm = 5718.37109
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 331.77499 | spectral_norm = 28.41910 | nuclear_norm = 8822.44531
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 168.44858 | spectral_norm = 16.77712 | nuclear_norm = 4460.67188
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 153.07150 | spectral_norm = 15.34683 | nuclear_norm = 3479.32764
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 149.90073 | spectral_norm = 14.74894 | nuclear_norm = 3421.95557
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 247.21251 | spectral_norm = 25.14235 | nuclear_norm = 5597.39551
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 242.37527 | spectral_norm = 21.42921 | nuclear_norm = 5690.51416
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 339.49780 | spectral_norm = 29.12644 | nuclear_norm = 9023.86523
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 169.96368 | spectral_norm = 17.07501 | nuclear_norm = 4493.67188
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 147.83432 | spectral_norm = 15.85973 | nuclear_norm = 3257.46582
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 148.81323 | spectral_norm = 14.44229 | nuclear_norm = 3235.19141
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 255.42209 | spectral_norm = 22.87387 | nuclear_norm = 5862.95312
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 257.93256 | spectral_norm = 17.47176 | nuclear_norm = 6070.52051
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 327.35907 | spectral_norm = 24.98328 | nuclear_norm = 8723.87012
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 160.11534 | spectral_norm = 18.00770 | nuclear_norm = 4236.39111
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 152.27127 | spectral_norm = 18.68457 | nuclear_norm = 3430.40503
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 147.68932 | spectral_norm = 17.34958 | nuclear_norm = 3319.98169
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 240.58302 | spectral_norm = 23.20144 | nuclear_norm = 5494.01318
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 265.45428 | spectral_norm = 18.72250 | nuclear_norm = 6213.95605
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 338.18207 | spectral_norm = 26.42459 | nuclear_norm = 8994.81641
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 165.84105 | spectral_norm = 20.86545 | nuclear_norm = 4338.63574
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1089.21558 | spectral_norm = 162.57628 | nuclear_norm = 28477.22266
===========================================
step:876/1750 train_loss:3.4649 train_time:307850ms step_avg:355.49ms
step:877/1750 train_loss:3.6393 train_time:308211ms step_avg:355.49ms
step:878/1750 train_loss:3.4874 train_time:308578ms step_avg:355.50ms
step:879/1750 train_loss:3.6673 train_time:308947ms step_avg:355.52ms
step:880/1750 train_loss:3.3288 train_time:309312ms step_avg:355.53ms
step:881/1750 train_loss:3.5136 train_time:309678ms step_avg:355.54ms
step:882/1750 train_loss:3.7081 train_time:310048ms step_avg:355.56ms
step:883/1750 train_loss:3.8570 train_time:310415ms step_avg:355.57ms
step:884/1750 train_loss:3.5886 train_time:310786ms step_avg:355.59ms
step:885/1750 train_loss:3.5036 train_time:311156ms step_avg:355.61ms
step:886/1750 train_loss:3.5883 train_time:311525ms step_avg:355.62ms
step:887/1750 train_loss:4.1108 train_time:311894ms step_avg:355.64ms
step:888/1750 train_loss:3.8539 train_time:312273ms step_avg:355.66ms
step:889/1750 train_loss:3.5434 train_time:312641ms step_avg:355.68ms
step:890/1750 train_loss:3.5503 train_time:313007ms step_avg:355.69ms
step:891/1750 train_loss:3.3860 train_time:313374ms step_avg:355.70ms
step:892/1750 train_loss:3.7454 train_time:313742ms step_avg:355.72ms
step:893/1750 train_loss:3.4463 train_time:314107ms step_avg:355.73ms
step:894/1750 train_loss:3.6612 train_time:314481ms step_avg:355.75ms
step:895/1750 train_loss:3.7017 train_time:314851ms step_avg:355.76ms
step:896/1750 train_loss:3.5278 train_time:315221ms step_avg:355.78ms
step:897/1750 train_loss:3.5608 train_time:315592ms step_avg:355.80ms
step:898/1750 train_loss:3.6128 train_time:315961ms step_avg:355.81ms
step:899/1750 train_loss:3.5050 train_time:316328ms step_avg:355.82ms
step:900/1750 train_loss:3.4437 train_time:316699ms step_avg:355.84ms
step:901/1750 train_loss:3.6446 train_time:317065ms step_avg:355.85ms
step:902/1750 train_loss:3.6575 train_time:317432ms step_avg:355.87ms
step:903/1750 train_loss:3.5621 train_time:317805ms step_avg:355.88ms
step:904/1750 train_loss:3.5157 train_time:318177ms step_avg:355.90ms
step:905/1750 train_loss:3.5280 train_time:318543ms step_avg:355.91ms
step:906/1750 train_loss:3.7317 train_time:318916ms step_avg:355.93ms
step:907/1750 train_loss:3.5358 train_time:319289ms step_avg:355.95ms
step:908/1750 train_loss:3.5906 train_time:319656ms step_avg:355.96ms
step:909/1750 train_loss:3.4744 train_time:320036ms step_avg:355.99ms
step:910/1750 train_loss:3.5473 train_time:320420ms step_avg:356.02ms
step:911/1750 train_loss:3.6639 train_time:320793ms step_avg:356.04ms
step:912/1750 train_loss:3.6197 train_time:321172ms step_avg:356.07ms
step:913/1750 train_loss:3.4813 train_time:321551ms step_avg:356.09ms
step:914/1750 train_loss:3.7690 train_time:321930ms step_avg:356.12ms
step:915/1750 train_loss:3.5524 train_time:322312ms step_avg:356.15ms
step:916/1750 train_loss:3.6389 train_time:322688ms step_avg:356.17ms
step:917/1750 train_loss:3.6211 train_time:323062ms step_avg:356.19ms
step:918/1750 train_loss:4.8475 train_time:323443ms step_avg:356.21ms
step:919/1750 train_loss:3.5134 train_time:323824ms step_avg:356.24ms
step:920/1750 train_loss:3.6066 train_time:324197ms step_avg:356.26ms
step:921/1750 train_loss:3.5670 train_time:324576ms step_avg:356.29ms
step:922/1750 train_loss:3.6081 train_time:324955ms step_avg:356.31ms
step:923/1750 train_loss:3.6338 train_time:325328ms step_avg:356.33ms
step:924/1750 train_loss:3.7041 train_time:325703ms step_avg:356.35ms
step:925/1750 train_loss:3.6693 train_time:326079ms step_avg:356.37ms
step:926/1750 train_loss:3.5785 train_time:326449ms step_avg:356.39ms
step:927/1750 train_loss:3.5738 train_time:326818ms step_avg:356.40ms
step:928/1750 train_loss:3.8089 train_time:327193ms step_avg:356.42ms
step:929/1750 train_loss:3.6329 train_time:327570ms step_avg:356.44ms
step:930/1750 train_loss:3.4195 train_time:327946ms step_avg:356.46ms
step:931/1750 train_loss:3.5202 train_time:328315ms step_avg:356.48ms
step:932/1750 train_loss:3.6729 train_time:328691ms step_avg:356.50ms
step:933/1750 train_loss:3.4165 train_time:329066ms step_avg:356.52ms
step:934/1750 train_loss:3.6081 train_time:329443ms step_avg:356.54ms
step:935/1750 train_loss:3.4651 train_time:329821ms step_avg:356.56ms
step:936/1750 train_loss:3.5414 train_time:330199ms step_avg:356.59ms
step:937/1750 train_loss:3.6416 train_time:330579ms step_avg:356.61ms
step:938/1750 train_loss:3.5640 train_time:330951ms step_avg:356.63ms
step:939/1750 train_loss:3.6942 train_time:331335ms step_avg:356.66ms
step:940/1750 train_loss:3.5021 train_time:331711ms step_avg:356.68ms
step:941/1750 train_loss:3.5724 train_time:332084ms step_avg:356.70ms
step:942/1750 train_loss:3.3827 train_time:332458ms step_avg:356.71ms
step:943/1750 train_loss:3.7310 train_time:332840ms step_avg:356.74ms
step:944/1750 train_loss:3.4257 train_time:333246ms step_avg:356.79ms
step:945/1750 train_loss:3.4444 train_time:333716ms step_avg:356.92ms
step:946/1750 train_loss:5.0937 train_time:334100ms step_avg:356.94ms
step:947/1750 train_loss:3.6205 train_time:334475ms step_avg:356.96ms
step:948/1750 train_loss:3.5062 train_time:334849ms step_avg:356.98ms
step:949/1750 train_loss:3.4061 train_time:335354ms step_avg:357.14ms
step:950/1750 train_loss:3.4644 train_time:335727ms step_avg:357.16ms
step:951/1750 train_loss:3.4292 train_time:336105ms step_avg:357.18ms
step:952/1750 train_loss:3.5006 train_time:336478ms step_avg:357.19ms
step:953/1750 train_loss:3.5914 train_time:336858ms step_avg:357.22ms
step:954/1750 train_loss:3.4672 train_time:337239ms step_avg:357.24ms
step:955/1750 train_loss:3.4955 train_time:337610ms step_avg:357.26ms
step:956/1750 train_loss:3.4618 train_time:337985ms step_avg:357.28ms
step:957/1750 train_loss:3.5216 train_time:338371ms step_avg:357.31ms
step:958/1750 train_loss:3.5248 train_time:338755ms step_avg:357.34ms
step:959/1750 train_loss:3.5363 train_time:339128ms step_avg:357.35ms
step:960/1750 train_loss:3.4260 train_time:339503ms step_avg:357.37ms
step:961/1750 train_loss:3.6705 train_time:339877ms step_avg:357.39ms
step:962/1750 train_loss:3.6271 train_time:340249ms step_avg:357.40ms
step:963/1750 train_loss:3.4221 train_time:340626ms step_avg:357.42ms
step:964/1750 train_loss:3.4557 train_time:341005ms step_avg:357.45ms
step:965/1750 train_loss:3.4998 train_time:341377ms step_avg:357.46ms
step:966/1750 train_loss:3.7400 train_time:341748ms step_avg:357.48ms
step:967/1750 train_loss:3.5422 train_time:342121ms step_avg:357.49ms
step:968/1750 train_loss:3.5409 train_time:342497ms step_avg:357.51ms
step:969/1750 train_loss:3.6108 train_time:342872ms step_avg:357.53ms
step:970/1750 train_loss:3.4022 train_time:343246ms step_avg:357.55ms
step:971/1750 train_loss:3.5621 train_time:343620ms step_avg:357.56ms
step:972/1750 train_loss:3.5079 train_time:343989ms step_avg:357.58ms
step:973/1750 train_loss:3.5643 train_time:344362ms step_avg:357.59ms
step:974/1750 train_loss:3.6176 train_time:344737ms step_avg:357.61ms
step:975/1750 train_loss:3.5007 train_time:345110ms step_avg:357.63ms
step:976/1750 train_loss:3.6981 train_time:345480ms step_avg:357.64ms
step:977/1750 train_loss:3.5938 train_time:345850ms step_avg:357.65ms
step:978/1750 train_loss:3.3833 train_time:346223ms step_avg:357.67ms
step:979/1750 train_loss:3.6558 train_time:346597ms step_avg:357.69ms
step:980/1750 train_loss:3.4390 train_time:346976ms step_avg:357.71ms
step:981/1750 train_loss:3.5968 train_time:347354ms step_avg:357.73ms
step:982/1750 train_loss:3.5675 train_time:347725ms step_avg:357.74ms
step:983/1750 train_loss:3.5456 train_time:348100ms step_avg:357.76ms
step:984/1750 train_loss:3.5255 train_time:348474ms step_avg:357.78ms
step:985/1750 train_loss:3.6050 train_time:348851ms step_avg:357.80ms
step:986/1750 train_loss:3.4448 train_time:349226ms step_avg:357.81ms
step:987/1750 train_loss:3.5174 train_time:349594ms step_avg:357.82ms
step:988/1750 train_loss:3.5347 train_time:349965ms step_avg:357.84ms
step:989/1750 train_loss:3.4454 train_time:350333ms step_avg:357.85ms
step:990/1750 train_loss:3.6860 train_time:350706ms step_avg:357.86ms
step:991/1750 train_loss:3.4976 train_time:351080ms step_avg:357.88ms
step:992/1750 train_loss:3.4684 train_time:351468ms step_avg:357.91ms
step:993/1750 train_loss:3.5375 train_time:351854ms step_avg:357.94ms
step:994/1750 train_loss:3.6272 train_time:352225ms step_avg:357.95ms
step:995/1750 train_loss:3.5586 train_time:352594ms step_avg:357.96ms
step:996/1750 train_loss:3.4914 train_time:352961ms step_avg:357.97ms
step:997/1750 train_loss:3.8047 train_time:353333ms step_avg:357.99ms
step:998/1750 train_loss:3.4771 train_time:353704ms step_avg:358.00ms
step:999/1750 train_loss:3.6205 train_time:354077ms step_avg:358.02ms
step:1000/1750 train_loss:3.4750 train_time:354456ms step_avg:358.04ms
step:1000/1750 val_loss:3.5016 train_time:354550ms step_avg:358.13ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 269.24850 | frobenius_norm = 62029.98828 | spectral_norm = 11038.19824 | nuclear_norm = 1558506.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 164.49992 | spectral_norm = 27.59961 | nuclear_norm = 3795.64746
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 158.51161 | spectral_norm = 31.07960 | nuclear_norm = 3629.92578
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 270.17630 | spectral_norm = 18.30576 | nuclear_norm = 6545.95361
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 200.30138 | spectral_norm = 20.60020 | nuclear_norm = 4653.51367
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 346.96924 | spectral_norm = 27.87280 | nuclear_norm = 9240.57422
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 179.18631 | spectral_norm = 16.55418 | nuclear_norm = 4751.41309
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 163.93562 | spectral_norm = 15.80889 | nuclear_norm = 3794.15527
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 159.68312 | spectral_norm = 15.95786 | nuclear_norm = 3688.31421
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 240.30984 | spectral_norm = 19.95246 | nuclear_norm = 5540.64648
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 237.08650 | spectral_norm = 18.63416 | nuclear_norm = 5567.69336
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 346.26779 | spectral_norm = 26.03922 | nuclear_norm = 9236.10938
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 171.24379 | spectral_norm = 17.32014 | nuclear_norm = 4499.07373
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 159.85573 | spectral_norm = 16.63433 | nuclear_norm = 3667.42871
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 159.12033 | spectral_norm = 15.61337 | nuclear_norm = 3644.64209
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 238.53711 | spectral_norm = 21.62329 | nuclear_norm = 5418.49609
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 244.78578 | spectral_norm = 21.48275 | nuclear_norm = 5662.81152
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 351.61475 | spectral_norm = 28.51325 | nuclear_norm = 9352.99512
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 176.61804 | spectral_norm = 18.46386 | nuclear_norm = 4638.65918
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 158.68600 | spectral_norm = 15.92832 | nuclear_norm = 3594.12402
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 158.01440 | spectral_norm = 14.60151 | nuclear_norm = 3602.50073
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 255.44022 | spectral_norm = 22.28372 | nuclear_norm = 5787.03906
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 258.54956 | spectral_norm = 21.25869 | nuclear_norm = 6028.31055
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 354.48465 | spectral_norm = 31.84776 | nuclear_norm = 9426.97949
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 175.07016 | spectral_norm = 17.90797 | nuclear_norm = 4606.90820
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 158.82083 | spectral_norm = 16.03189 | nuclear_norm = 3587.99976
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 156.37015 | spectral_norm = 14.48716 | nuclear_norm = 3538.59717
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 266.21890 | spectral_norm = 24.18175 | nuclear_norm = 6006.50781
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 264.10495 | spectral_norm = 19.29668 | nuclear_norm = 6205.86621
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 360.64935 | spectral_norm = 31.07155 | nuclear_norm = 9613.49316
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 175.27696 | spectral_norm = 16.70543 | nuclear_norm = 4623.19385
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 161.05742 | spectral_norm = 16.18207 | nuclear_norm = 3682.67334
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 158.03662 | spectral_norm = 15.09328 | nuclear_norm = 3635.00342
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 259.73813 | spectral_norm = 23.42609 | nuclear_norm = 5927.39209
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 259.13510 | spectral_norm = 19.09175 | nuclear_norm = 6133.17285
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 366.64697 | spectral_norm = 28.41803 | nuclear_norm = 9801.70996
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 174.40834 | spectral_norm = 16.68328 | nuclear_norm = 4592.97168
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 156.51480 | spectral_norm = 16.92871 | nuclear_norm = 3569.03223
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 152.61223 | spectral_norm = 16.01380 | nuclear_norm = 3506.45117
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 252.11554 | spectral_norm = 21.01670 | nuclear_norm = 5772.49268
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 248.09119 | spectral_norm = 20.91027 | nuclear_norm = 5715.06641
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 363.55386 | spectral_norm = 27.13729 | nuclear_norm = 9709.33203
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 176.91180 | spectral_norm = 18.46397 | nuclear_norm = 4657.23242
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 163.56360 | spectral_norm = 16.30077 | nuclear_norm = 3741.05200
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 162.03474 | spectral_norm = 16.85237 | nuclear_norm = 3700.81274
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 279.27435 | spectral_norm = 27.23760 | nuclear_norm = 6321.24951
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 269.91443 | spectral_norm = 19.14897 | nuclear_norm = 6413.59473
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 348.35129 | spectral_norm = 29.67095 | nuclear_norm = 9281.44922
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 180.11382 | spectral_norm = 17.82255 | nuclear_norm = 4766.10840
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 157.56459 | spectral_norm = 16.36310 | nuclear_norm = 3541.24170
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 157.01532 | spectral_norm = 15.16956 | nuclear_norm = 3545.28052
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 262.33444 | spectral_norm = 22.91398 | nuclear_norm = 5885.65771
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 264.19934 | spectral_norm = 21.26092 | nuclear_norm = 6131.57617
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 361.08902 | spectral_norm = 31.50917 | nuclear_norm = 9597.67188
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 182.80302 | spectral_norm = 18.69063 | nuclear_norm = 4839.68408
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 166.09940 | spectral_norm = 16.85021 | nuclear_norm = 3763.39502
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 162.54343 | spectral_norm = 16.21673 | nuclear_norm = 3699.00293
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 267.29114 | spectral_norm = 27.50057 | nuclear_norm = 6039.54199
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 261.60889 | spectral_norm = 23.00189 | nuclear_norm = 6137.24219
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 369.64127 | spectral_norm = 32.25039 | nuclear_norm = 9820.44727
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 184.74231 | spectral_norm = 18.96969 | nuclear_norm = 4883.55078
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 159.95534 | spectral_norm = 17.55140 | nuclear_norm = 3508.08740
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 161.33881 | spectral_norm = 15.86971 | nuclear_norm = 3489.14307
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 274.45206 | spectral_norm = 25.63221 | nuclear_norm = 6286.94629
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 277.50528 | spectral_norm = 18.95439 | nuclear_norm = 6526.74902
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 355.97794 | spectral_norm = 27.41106 | nuclear_norm = 9483.76270
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 173.69826 | spectral_norm = 20.04319 | nuclear_norm = 4595.91602
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 164.82062 | spectral_norm = 20.75013 | nuclear_norm = 3693.61572
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 159.70976 | spectral_norm = 19.20458 | nuclear_norm = 3575.66260
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 261.95557 | spectral_norm = 25.79247 | nuclear_norm = 5969.60303
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 289.15393 | spectral_norm = 20.52717 | nuclear_norm = 6763.40137
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 367.55893 | spectral_norm = 29.27711 | nuclear_norm = 9771.51270
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 181.68777 | spectral_norm = 23.56194 | nuclear_norm = 4751.65820
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1167.00293 | spectral_norm = 162.82210 | nuclear_norm = 30607.92969
===========================================
step:1001/1750 train_loss:3.5352 train_time:354816ms step_avg:358.04ms
step:1002/1750 train_loss:3.4112 train_time:355180ms step_avg:358.04ms
step:1003/1750 train_loss:3.5890 train_time:355558ms step_avg:358.06ms
step:1004/1750 train_loss:3.6375 train_time:355933ms step_avg:358.08ms
step:1005/1750 train_loss:3.4245 train_time:356302ms step_avg:358.09ms
step:1006/1750 train_loss:3.5024 train_time:356676ms step_avg:358.11ms
step:1007/1750 train_loss:3.4781 train_time:357047ms step_avg:358.12ms
step:1008/1750 train_loss:3.6014 train_time:357421ms step_avg:358.14ms
step:1009/1750 train_loss:3.6948 train_time:357803ms step_avg:358.16ms
step:1010/1750 train_loss:3.5903 train_time:358173ms step_avg:358.17ms
step:1011/1750 train_loss:3.5713 train_time:358543ms step_avg:358.18ms
step:1012/1750 train_loss:3.4251 train_time:358914ms step_avg:358.20ms
step:1013/1750 train_loss:3.5702 train_time:359290ms step_avg:358.21ms
step:1014/1750 train_loss:3.6643 train_time:359665ms step_avg:358.23ms
step:1015/1750 train_loss:3.3621 train_time:360041ms step_avg:358.25ms
step:1016/1750 train_loss:3.4479 train_time:360412ms step_avg:358.26ms
step:1017/1750 train_loss:3.4388 train_time:360787ms step_avg:358.28ms
step:1018/1750 train_loss:3.4278 train_time:361165ms step_avg:358.30ms
step:1019/1750 train_loss:3.5617 train_time:361539ms step_avg:358.31ms
step:1020/1750 train_loss:3.4259 train_time:361911ms step_avg:358.33ms
step:1021/1750 train_loss:3.3925 train_time:362280ms step_avg:358.34ms
step:1022/1750 train_loss:3.5179 train_time:362653ms step_avg:358.35ms
step:1023/1750 train_loss:3.5469 train_time:363026ms step_avg:358.37ms
step:1024/1750 train_loss:3.5150 train_time:363398ms step_avg:358.38ms
step:1025/1750 train_loss:3.5187 train_time:363772ms step_avg:358.40ms
step:1026/1750 train_loss:3.6710 train_time:364140ms step_avg:358.41ms
step:1027/1750 train_loss:3.3593 train_time:364509ms step_avg:358.42ms
step:1028/1750 train_loss:3.4303 train_time:364886ms step_avg:358.43ms
step:1029/1750 train_loss:3.3619 train_time:365264ms step_avg:358.45ms
step:1030/1750 train_loss:3.5777 train_time:365637ms step_avg:358.47ms
step:1031/1750 train_loss:3.5593 train_time:366011ms step_avg:358.48ms
step:1032/1750 train_loss:3.7366 train_time:366391ms step_avg:358.50ms
step:1033/1750 train_loss:3.5305 train_time:366759ms step_avg:358.51ms
step:1034/1750 train_loss:3.4490 train_time:367131ms step_avg:358.53ms
step:1035/1750 train_loss:3.4833 train_time:367504ms step_avg:358.54ms
step:1036/1750 train_loss:3.5249 train_time:367875ms step_avg:358.55ms
step:1037/1750 train_loss:3.8380 train_time:368247ms step_avg:358.57ms
step:1038/1750 train_loss:3.6653 train_time:368620ms step_avg:358.58ms
step:1039/1750 train_loss:3.5555 train_time:369002ms step_avg:358.60ms
step:1040/1750 train_loss:3.4507 train_time:369379ms step_avg:358.62ms
step:1041/1750 train_loss:3.5316 train_time:369756ms step_avg:358.64ms
step:1042/1750 train_loss:3.5652 train_time:370125ms step_avg:358.65ms
step:1043/1750 train_loss:3.4867 train_time:370498ms step_avg:358.66ms
step:1044/1750 train_loss:3.4979 train_time:370876ms step_avg:358.68ms
step:1045/1750 train_loss:3.5595 train_time:371254ms step_avg:358.70ms
step:1046/1750 train_loss:3.4609 train_time:371629ms step_avg:358.72ms
step:1047/1750 train_loss:3.6868 train_time:372006ms step_avg:358.73ms
step:1048/1750 train_loss:3.5441 train_time:372385ms step_avg:358.75ms
step:1049/1750 train_loss:3.4515 train_time:372765ms step_avg:358.77ms
step:1050/1750 train_loss:3.4332 train_time:373148ms step_avg:358.80ms
step:1051/1750 train_loss:3.5458 train_time:373529ms step_avg:358.82ms
step:1052/1750 train_loss:3.4003 train_time:373910ms step_avg:358.84ms
step:1053/1750 train_loss:3.7373 train_time:374289ms step_avg:358.86ms
step:1054/1750 train_loss:3.5873 train_time:374670ms step_avg:358.88ms
step:1055/1750 train_loss:3.4255 train_time:375044ms step_avg:358.89ms
step:1056/1750 train_loss:3.5443 train_time:375422ms step_avg:358.91ms
step:1057/1750 train_loss:3.6246 train_time:375803ms step_avg:358.93ms
step:1058/1750 train_loss:3.3476 train_time:376183ms step_avg:358.95ms
step:1059/1750 train_loss:3.4187 train_time:376567ms step_avg:358.98ms
step:1060/1750 train_loss:3.4928 train_time:376946ms step_avg:359.00ms
step:1061/1750 train_loss:3.4665 train_time:377321ms step_avg:359.01ms
step:1062/1750 train_loss:3.4316 train_time:377698ms step_avg:359.03ms
step:1063/1750 train_loss:3.5101 train_time:378073ms step_avg:359.04ms
step:1064/1750 train_loss:3.4352 train_time:378444ms step_avg:359.05ms
step:1065/1750 train_loss:3.4121 train_time:378827ms step_avg:359.08ms
step:1066/1750 train_loss:3.4543 train_time:379210ms step_avg:359.10ms
step:1067/1750 train_loss:3.3252 train_time:379590ms step_avg:359.12ms
step:1068/1750 train_loss:3.4827 train_time:379970ms step_avg:359.14ms
step:1069/1750 train_loss:3.3542 train_time:380357ms step_avg:359.17ms
step:1070/1750 train_loss:3.6149 train_time:380732ms step_avg:359.18ms
step:1071/1750 train_loss:3.5604 train_time:381115ms step_avg:359.20ms
step:1072/1750 train_loss:3.4919 train_time:381489ms step_avg:359.22ms
step:1073/1750 train_loss:3.5712 train_time:381862ms step_avg:359.23ms
step:1074/1750 train_loss:3.4928 train_time:382239ms step_avg:359.25ms
step:1075/1750 train_loss:3.4467 train_time:382617ms step_avg:359.26ms
step:1076/1750 train_loss:3.8434 train_time:382990ms step_avg:359.28ms
step:1077/1750 train_loss:3.4950 train_time:383364ms step_avg:359.29ms
step:1078/1750 train_loss:3.1349 train_time:383761ms step_avg:359.33ms
step:1079/1750 train_loss:3.5815 train_time:384147ms step_avg:359.35ms
step:1080/1750 train_loss:3.4814 train_time:384526ms step_avg:359.37ms
step:1081/1750 train_loss:3.5630 train_time:384900ms step_avg:359.38ms
step:1082/1750 train_loss:3.6460 train_time:385276ms step_avg:359.40ms
step:1083/1750 train_loss:3.5530 train_time:385650ms step_avg:359.41ms
step:1084/1750 train_loss:3.5286 train_time:386030ms step_avg:359.43ms
step:1085/1750 train_loss:3.4847 train_time:386409ms step_avg:359.45ms
step:1086/1750 train_loss:3.6880 train_time:386790ms step_avg:359.47ms
step:1087/1750 train_loss:3.5673 train_time:387168ms step_avg:359.49ms
step:1088/1750 train_loss:3.4173 train_time:387552ms step_avg:359.51ms
step:1089/1750 train_loss:3.4369 train_time:387943ms step_avg:359.54ms
step:1090/1750 train_loss:3.5385 train_time:388330ms step_avg:359.56ms
step:1091/1750 train_loss:3.3426 train_time:388713ms step_avg:359.59ms
step:1092/1750 train_loss:3.5476 train_time:389096ms step_avg:359.61ms
step:1093/1750 train_loss:3.6676 train_time:389476ms step_avg:359.63ms
step:1094/1750 train_loss:3.5057 train_time:389852ms step_avg:359.64ms
step:1095/1750 train_loss:3.4742 train_time:390231ms step_avg:359.66ms
step:1096/1750 train_loss:3.4860 train_time:390616ms step_avg:359.68ms
step:1097/1750 train_loss:3.5432 train_time:390998ms step_avg:359.70ms
step:1098/1750 train_loss:3.6213 train_time:391379ms step_avg:359.72ms
step:1099/1750 train_loss:3.5841 train_time:391758ms step_avg:359.74ms
step:1100/1750 train_loss:3.4915 train_time:392147ms step_avg:359.77ms
step:1101/1750 train_loss:3.3426 train_time:392526ms step_avg:359.79ms
step:1102/1750 train_loss:3.3714 train_time:392911ms step_avg:359.81ms
step:1103/1750 train_loss:3.5067 train_time:393297ms step_avg:359.83ms
step:1104/1750 train_loss:3.3793 train_time:393671ms step_avg:359.85ms
step:1105/1750 train_loss:4.1206 train_time:394049ms step_avg:359.86ms
step:1106/1750 train_loss:3.2891 train_time:394422ms step_avg:359.87ms
step:1107/1750 train_loss:3.6276 train_time:394798ms step_avg:359.89ms
step:1108/1750 train_loss:3.4010 train_time:395172ms step_avg:359.90ms
step:1109/1750 train_loss:3.5613 train_time:395547ms step_avg:359.91ms
step:1110/1750 train_loss:3.4968 train_time:395924ms step_avg:359.93ms
step:1111/1750 train_loss:3.5459 train_time:396301ms step_avg:359.95ms
step:1112/1750 train_loss:3.6278 train_time:396686ms step_avg:359.97ms
step:1113/1750 train_loss:3.4952 train_time:397077ms step_avg:360.00ms
step:1114/1750 train_loss:3.4322 train_time:397456ms step_avg:360.01ms
step:1115/1750 train_loss:3.3022 train_time:397831ms step_avg:360.03ms
step:1116/1750 train_loss:3.4860 train_time:398205ms step_avg:360.04ms
step:1117/1750 train_loss:3.6569 train_time:398588ms step_avg:360.06ms
step:1118/1750 train_loss:3.6875 train_time:398970ms step_avg:360.08ms
step:1119/1750 train_loss:3.5438 train_time:399345ms step_avg:360.09ms
step:1120/1750 train_loss:3.5562 train_time:399723ms step_avg:360.11ms
step:1121/1750 train_loss:3.4511 train_time:400102ms step_avg:360.13ms
step:1122/1750 train_loss:3.5204 train_time:400477ms step_avg:360.14ms
step:1123/1750 train_loss:3.6497 train_time:400854ms step_avg:360.16ms
step:1124/1750 train_loss:3.4143 train_time:401231ms step_avg:360.17ms
step:1125/1750 train_loss:3.2799 train_time:401608ms step_avg:360.19ms
step:1125/1750 val_loss:3.4745 train_time:401709ms step_avg:360.28ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 281.01721 | frobenius_norm = 64793.47266 | spectral_norm = 11487.16992 | nuclear_norm = 1630714.50000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 175.75514 | spectral_norm = 30.57065 | nuclear_norm = 4048.49194
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 169.83130 | spectral_norm = 34.31579 | nuclear_norm = 3883.49512
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 287.64359 | spectral_norm = 19.72715 | nuclear_norm = 6987.45508
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 207.86058 | spectral_norm = 22.16555 | nuclear_norm = 4818.76270
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 374.42255 | spectral_norm = 30.45511 | nuclear_norm = 9975.44531
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 192.23882 | spectral_norm = 18.08764 | nuclear_norm = 5096.51465
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 175.79749 | spectral_norm = 17.11367 | nuclear_norm = 4062.48193
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 171.24370 | spectral_norm = 17.12050 | nuclear_norm = 3950.27881
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 255.42426 | spectral_norm = 21.45248 | nuclear_norm = 5883.26660
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 251.52725 | spectral_norm = 20.01013 | nuclear_norm = 5907.50342
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 371.60443 | spectral_norm = 28.31651 | nuclear_norm = 9917.09180
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 183.09369 | spectral_norm = 18.76496 | nuclear_norm = 4808.14648
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 171.16359 | spectral_norm = 18.42989 | nuclear_norm = 3918.00439
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 170.78288 | spectral_norm = 16.77961 | nuclear_norm = 3906.84766
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 254.76469 | spectral_norm = 23.13534 | nuclear_norm = 5784.78369
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 261.00497 | spectral_norm = 23.25029 | nuclear_norm = 6035.40479
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 376.48523 | spectral_norm = 31.20376 | nuclear_norm = 10014.16309
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 189.13008 | spectral_norm = 20.19347 | nuclear_norm = 4964.09570
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 170.14883 | spectral_norm = 17.31728 | nuclear_norm = 3847.07568
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 169.49741 | spectral_norm = 15.80294 | nuclear_norm = 3858.24341
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 273.21198 | spectral_norm = 23.91795 | nuclear_norm = 6187.12891
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 275.75122 | spectral_norm = 23.04882 | nuclear_norm = 6426.86816
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 379.40536 | spectral_norm = 35.11264 | nuclear_norm = 10087.46875
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 187.35963 | spectral_norm = 19.52925 | nuclear_norm = 4927.87744
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 170.04463 | spectral_norm = 17.21413 | nuclear_norm = 3829.48535
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 167.49162 | spectral_norm = 15.73952 | nuclear_norm = 3782.95312
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 285.40146 | spectral_norm = 26.14481 | nuclear_norm = 6437.72754
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 282.62402 | spectral_norm = 20.67162 | nuclear_norm = 6643.45459
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 386.61240 | spectral_norm = 34.23784 | nuclear_norm = 10304.96875
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 187.75526 | spectral_norm = 18.24249 | nuclear_norm = 4952.32178
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 172.67422 | spectral_norm = 17.58115 | nuclear_norm = 3939.74658
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 169.41638 | spectral_norm = 16.26970 | nuclear_norm = 3891.14502
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 278.39154 | spectral_norm = 25.34150 | nuclear_norm = 6355.05176
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 277.22107 | spectral_norm = 20.40778 | nuclear_norm = 6565.54980
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 393.37674 | spectral_norm = 31.09204 | nuclear_norm = 10518.46777
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 186.68283 | spectral_norm = 18.26151 | nuclear_norm = 4916.85791
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 167.76958 | spectral_norm = 18.29419 | nuclear_norm = 3812.19873
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 163.55031 | spectral_norm = 17.34970 | nuclear_norm = 3750.45898
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 269.64563 | spectral_norm = 22.68802 | nuclear_norm = 6178.15088
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 264.64117 | spectral_norm = 22.23655 | nuclear_norm = 6095.59961
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 390.67062 | spectral_norm = 29.72290 | nuclear_norm = 10435.77637
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 189.56779 | spectral_norm = 20.34171 | nuclear_norm = 4989.13916
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 175.27885 | spectral_norm = 17.63713 | nuclear_norm = 4000.73145
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 173.83188 | spectral_norm = 18.17418 | nuclear_norm = 3962.06421
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 298.20847 | spectral_norm = 29.42941 | nuclear_norm = 6733.18066
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 288.08453 | spectral_norm = 20.44724 | nuclear_norm = 6849.42627
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 373.60092 | spectral_norm = 32.52345 | nuclear_norm = 9952.26562
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 193.01288 | spectral_norm = 19.50319 | nuclear_norm = 5106.59424
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 168.60040 | spectral_norm = 17.62799 | nuclear_norm = 3777.07471
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 168.28815 | spectral_norm = 16.36570 | nuclear_norm = 3789.27051
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 280.07507 | spectral_norm = 24.48365 | nuclear_norm = 6277.03857
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 281.10706 | spectral_norm = 22.65172 | nuclear_norm = 6515.23730
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 388.24020 | spectral_norm = 34.49541 | nuclear_norm = 10314.49512
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 196.03061 | spectral_norm = 20.44661 | nuclear_norm = 5188.11328
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 178.22632 | spectral_norm = 18.32218 | nuclear_norm = 4026.30371
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 174.29413 | spectral_norm = 17.48012 | nuclear_norm = 3959.07617
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 285.67383 | spectral_norm = 29.75887 | nuclear_norm = 6442.32129
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 279.55685 | spectral_norm = 24.47884 | nuclear_norm = 6555.60693
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 397.56467 | spectral_norm = 35.08233 | nuclear_norm = 10557.63574
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 198.39421 | spectral_norm = 20.79766 | nuclear_norm = 5242.61377
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 171.15671 | spectral_norm = 19.16813 | nuclear_norm = 3740.25342
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 173.00874 | spectral_norm = 17.22512 | nuclear_norm = 3724.73975
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 291.90091 | spectral_norm = 28.34490 | nuclear_norm = 6674.79004
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 295.68698 | spectral_norm = 20.24060 | nuclear_norm = 6954.16162
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 382.51047 | spectral_norm = 29.82966 | nuclear_norm = 10187.44336
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 186.34312 | spectral_norm = 21.92705 | nuclear_norm = 4931.00488
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 176.51079 | spectral_norm = 22.67719 | nuclear_norm = 3939.44385
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 170.85242 | spectral_norm = 20.98414 | nuclear_norm = 3813.15674
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 282.18616 | spectral_norm = 28.30256 | nuclear_norm = 6415.65869
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 311.53931 | spectral_norm = 22.08430 | nuclear_norm = 7286.03125
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 394.49402 | spectral_norm = 31.95885 | nuclear_norm = 10482.51367
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 196.62224 | spectral_norm = 26.06337 | nuclear_norm = 5141.62207
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1238.96558 | spectral_norm = 162.83060 | nuclear_norm = 32585.20508
===========================================
step:1126/1750 train_loss:3.5398 train_time:401976ms step_avg:360.19ms
step:1127/1750 train_loss:3.7453 train_time:402343ms step_avg:360.20ms
step:1128/1750 train_loss:3.2973 train_time:402717ms step_avg:360.21ms
step:1129/1750 train_loss:3.6259 train_time:403095ms step_avg:360.23ms
step:1130/1750 train_loss:3.4400 train_time:403474ms step_avg:360.24ms
step:1131/1750 train_loss:3.4662 train_time:403860ms step_avg:360.27ms
step:1132/1750 train_loss:3.4321 train_time:404229ms step_avg:360.28ms
step:1133/1750 train_loss:3.5563 train_time:404636ms step_avg:360.32ms
step:1134/1750 train_loss:3.5174 train_time:405101ms step_avg:360.41ms
step:1135/1750 train_loss:3.5849 train_time:405477ms step_avg:360.42ms
step:1136/1750 train_loss:3.6231 train_time:405850ms step_avg:360.44ms
step:1137/1750 train_loss:3.5281 train_time:406224ms step_avg:360.45ms
step:1138/1750 train_loss:3.4148 train_time:406601ms step_avg:360.46ms
step:1139/1750 train_loss:3.7223 train_time:407102ms step_avg:360.59ms
step:1140/1750 train_loss:3.5298 train_time:407476ms step_avg:360.60ms
step:1141/1750 train_loss:3.6525 train_time:407859ms step_avg:360.62ms
step:1142/1750 train_loss:3.5206 train_time:408238ms step_avg:360.63ms
step:1143/1750 train_loss:3.4281 train_time:408620ms step_avg:360.65ms
step:1144/1750 train_loss:3.5080 train_time:408995ms step_avg:360.67ms
step:1145/1750 train_loss:3.6607 train_time:409366ms step_avg:360.67ms
step:1146/1750 train_loss:3.6188 train_time:409747ms step_avg:360.69ms
step:1147/1750 train_loss:3.5555 train_time:410124ms step_avg:360.71ms
step:1148/1750 train_loss:3.5674 train_time:410496ms step_avg:360.72ms
step:1149/1750 train_loss:3.3941 train_time:410873ms step_avg:360.73ms
step:1150/1750 train_loss:3.4346 train_time:411244ms step_avg:360.74ms
step:1151/1750 train_loss:3.3818 train_time:411622ms step_avg:360.76ms
step:1152/1750 train_loss:3.4693 train_time:412003ms step_avg:360.77ms
step:1153/1750 train_loss:3.4956 train_time:412383ms step_avg:360.79ms
step:1154/1750 train_loss:3.5802 train_time:412756ms step_avg:360.80ms
step:1155/1750 train_loss:3.3976 train_time:413136ms step_avg:360.82ms
step:1156/1750 train_loss:3.6033 train_time:413523ms step_avg:360.84ms
step:1157/1750 train_loss:3.5611 train_time:413903ms step_avg:360.86ms
step:1158/1750 train_loss:3.3266 train_time:414278ms step_avg:360.87ms
step:1159/1750 train_loss:3.4040 train_time:414653ms step_avg:360.88ms
step:1160/1750 train_loss:3.3984 train_time:415023ms step_avg:360.89ms
step:1161/1750 train_loss:3.1557 train_time:415401ms step_avg:360.90ms
step:1162/1750 train_loss:3.4880 train_time:415777ms step_avg:360.92ms
step:1163/1750 train_loss:3.4517 train_time:416154ms step_avg:360.93ms
step:1164/1750 train_loss:3.3517 train_time:416528ms step_avg:360.94ms
step:1165/1750 train_loss:3.3178 train_time:416901ms step_avg:360.95ms
step:1166/1750 train_loss:3.4467 train_time:417278ms step_avg:360.97ms
step:1167/1750 train_loss:3.4640 train_time:417651ms step_avg:360.98ms
step:1168/1750 train_loss:3.7884 train_time:418027ms step_avg:360.99ms
step:1169/1750 train_loss:3.4396 train_time:418409ms step_avg:361.01ms
step:1170/1750 train_loss:3.4574 train_time:418791ms step_avg:361.03ms
step:1171/1750 train_loss:3.3675 train_time:419173ms step_avg:361.04ms
step:1172/1750 train_loss:3.4863 train_time:419550ms step_avg:361.06ms
step:1173/1750 train_loss:3.6045 train_time:419939ms step_avg:361.08ms
step:1174/1750 train_loss:3.4464 train_time:420338ms step_avg:361.11ms
step:1175/1750 train_loss:3.4395 train_time:420722ms step_avg:361.13ms
step:1176/1750 train_loss:3.4888 train_time:421114ms step_avg:361.16ms
step:1177/1750 train_loss:3.5116 train_time:421507ms step_avg:361.19ms
step:1178/1750 train_loss:3.5633 train_time:421884ms step_avg:361.20ms
step:1179/1750 train_loss:3.4712 train_time:422268ms step_avg:361.22ms
step:1180/1750 train_loss:3.4166 train_time:422671ms step_avg:361.26ms
step:1181/1750 train_loss:3.4051 train_time:423054ms step_avg:361.28ms
step:1182/1750 train_loss:3.4568 train_time:423434ms step_avg:361.29ms
step:1183/1750 train_loss:3.3961 train_time:423815ms step_avg:361.31ms
step:1184/1750 train_loss:3.5760 train_time:424198ms step_avg:361.33ms
step:1185/1750 train_loss:3.6113 train_time:424588ms step_avg:361.35ms
step:1186/1750 train_loss:3.4260 train_time:424974ms step_avg:361.37ms
step:1187/1750 train_loss:3.4789 train_time:425375ms step_avg:361.41ms
step:1188/1750 train_loss:3.5058 train_time:425751ms step_avg:361.42ms
step:1189/1750 train_loss:3.3393 train_time:426136ms step_avg:361.44ms
step:1190/1750 train_loss:3.5098 train_time:426522ms step_avg:361.46ms
step:1191/1750 train_loss:3.6463 train_time:426910ms step_avg:361.48ms
step:1192/1750 train_loss:3.4577 train_time:427290ms step_avg:361.50ms
step:1193/1750 train_loss:3.3379 train_time:427670ms step_avg:361.51ms
step:1194/1750 train_loss:3.6246 train_time:428052ms step_avg:361.53ms
step:1195/1750 train_loss:3.4380 train_time:428445ms step_avg:361.56ms
step:1196/1750 train_loss:3.4548 train_time:428851ms step_avg:361.59ms
step:1197/1750 train_loss:3.3557 train_time:429239ms step_avg:361.62ms
step:1198/1750 train_loss:3.3649 train_time:429636ms step_avg:361.65ms
step:1199/1750 train_loss:3.4058 train_time:430020ms step_avg:361.67ms
step:1200/1750 train_loss:3.5075 train_time:430405ms step_avg:361.68ms
step:1201/1750 train_loss:3.5457 train_time:430785ms step_avg:361.70ms
step:1202/1750 train_loss:3.6684 train_time:431193ms step_avg:361.74ms
step:1203/1750 train_loss:3.4713 train_time:431583ms step_avg:361.76ms
step:1204/1750 train_loss:3.3807 train_time:431970ms step_avg:361.78ms
step:1205/1750 train_loss:3.4957 train_time:432351ms step_avg:361.80ms
step:1206/1750 train_loss:3.5411 train_time:432730ms step_avg:361.81ms
step:1207/1750 train_loss:3.5908 train_time:433109ms step_avg:361.83ms
step:1208/1750 train_loss:3.4663 train_time:433484ms step_avg:361.84ms
step:1209/1750 train_loss:3.3024 train_time:433871ms step_avg:361.86ms
step:1210/1750 train_loss:3.3744 train_time:434260ms step_avg:361.88ms
step:1211/1750 train_loss:3.4627 train_time:434639ms step_avg:361.90ms
step:1212/1750 train_loss:3.4568 train_time:435017ms step_avg:361.91ms
step:1213/1750 train_loss:3.4764 train_time:435402ms step_avg:361.93ms
step:1214/1750 train_loss:3.3289 train_time:435791ms step_avg:361.95ms
step:1215/1750 train_loss:3.4608 train_time:436171ms step_avg:361.97ms
step:1216/1750 train_loss:3.3899 train_time:436551ms step_avg:361.98ms
step:1217/1750 train_loss:3.3941 train_time:436935ms step_avg:362.00ms
step:1218/1750 train_loss:3.4799 train_time:437321ms step_avg:362.02ms
step:1219/1750 train_loss:3.3268 train_time:437713ms step_avg:362.05ms
step:1220/1750 train_loss:3.5344 train_time:438094ms step_avg:362.06ms
step:1221/1750 train_loss:3.5721 train_time:438472ms step_avg:362.07ms
step:1222/1750 train_loss:3.5122 train_time:438852ms step_avg:362.09ms
step:1223/1750 train_loss:3.3587 train_time:439235ms step_avg:362.11ms
step:1224/1750 train_loss:3.3232 train_time:439624ms step_avg:362.13ms
step:1225/1750 train_loss:3.4372 train_time:440008ms step_avg:362.15ms
step:1226/1750 train_loss:3.3889 train_time:440395ms step_avg:362.17ms
step:1227/1750 train_loss:3.3290 train_time:440781ms step_avg:362.19ms
step:1228/1750 train_loss:3.5132 train_time:441159ms step_avg:362.20ms
step:1229/1750 train_loss:3.4382 train_time:441543ms step_avg:362.22ms
step:1230/1750 train_loss:3.4628 train_time:441937ms step_avg:362.24ms
step:1231/1750 train_loss:3.6427 train_time:442326ms step_avg:362.27ms
step:1232/1750 train_loss:3.5561 train_time:442713ms step_avg:362.29ms
step:1233/1750 train_loss:3.4938 train_time:443090ms step_avg:362.30ms
step:1234/1750 train_loss:3.6474 train_time:443469ms step_avg:362.31ms
step:1235/1750 train_loss:3.3932 train_time:443855ms step_avg:362.33ms
step:1236/1750 train_loss:3.3593 train_time:444233ms step_avg:362.34ms
step:1237/1750 train_loss:3.3356 train_time:444614ms step_avg:362.36ms
step:1238/1750 train_loss:3.3575 train_time:445006ms step_avg:362.38ms
step:1239/1750 train_loss:3.3991 train_time:445387ms step_avg:362.40ms
step:1240/1750 train_loss:3.4505 train_time:445773ms step_avg:362.42ms
step:1241/1750 train_loss:3.4949 train_time:446159ms step_avg:362.44ms
step:1242/1750 train_loss:3.3642 train_time:446535ms step_avg:362.45ms
step:1243/1750 train_loss:3.4769 train_time:446917ms step_avg:362.46ms
step:1244/1750 train_loss:3.4799 train_time:447293ms step_avg:362.47ms
step:1245/1750 train_loss:3.4860 train_time:447671ms step_avg:362.49ms
step:1246/1750 train_loss:3.3056 train_time:448054ms step_avg:362.50ms
step:1247/1750 train_loss:3.4463 train_time:448432ms step_avg:362.52ms
step:1248/1750 train_loss:3.5069 train_time:448807ms step_avg:362.53ms
step:1249/1750 train_loss:3.4834 train_time:449183ms step_avg:362.54ms
step:1250/1750 train_loss:3.3616 train_time:449560ms step_avg:362.55ms
step:1250/1750 val_loss:3.4226 train_time:449665ms step_avg:362.63ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 289.49313 | frobenius_norm = 66789.59375 | spectral_norm = 11828.39160 | nuclear_norm = 1683273.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 184.07628 | spectral_norm = 33.10324 | nuclear_norm = 4233.87988
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 178.24251 | spectral_norm = 37.07092 | nuclear_norm = 4069.64941
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 301.21396 | spectral_norm = 20.89892 | nuclear_norm = 7332.98096
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 212.79449 | spectral_norm = 23.19391 | nuclear_norm = 4922.69922
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 395.66809 | spectral_norm = 32.58022 | nuclear_norm = 10542.22656
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 202.24135 | spectral_norm = 19.28230 | nuclear_norm = 5360.72363
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 184.81839 | spectral_norm = 18.22152 | nuclear_norm = 4266.54639
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 180.23677 | spectral_norm = 18.10007 | nuclear_norm = 4150.36621
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 267.04636 | spectral_norm = 22.59604 | nuclear_norm = 6149.03467
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 262.68579 | spectral_norm = 21.18170 | nuclear_norm = 6168.85400
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 391.08444 | spectral_norm = 29.98634 | nuclear_norm = 10440.18457
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 192.25632 | spectral_norm = 19.86547 | nuclear_norm = 5047.08105
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 179.78290 | spectral_norm = 19.86189 | nuclear_norm = 4108.27344
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 179.76949 | spectral_norm = 17.77322 | nuclear_norm = 4105.73730
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 267.76953 | spectral_norm = 24.51858 | nuclear_norm = 6080.30078
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 273.93893 | spectral_norm = 24.72085 | nuclear_norm = 6334.48242
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 395.53021 | spectral_norm = 33.34800 | nuclear_norm = 10518.82812
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 198.72224 | spectral_norm = 21.45505 | nuclear_norm = 5213.34277
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 178.84715 | spectral_norm = 18.35873 | nuclear_norm = 4037.21753
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 178.24416 | spectral_norm = 16.79006 | nuclear_norm = 4050.88428
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 287.24139 | spectral_norm = 25.16036 | nuclear_norm = 6504.89307
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 289.33032 | spectral_norm = 24.47865 | nuclear_norm = 6742.03662
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 398.47250 | spectral_norm = 37.77481 | nuclear_norm = 10591.15332
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 196.88814 | spectral_norm = 20.88880 | nuclear_norm = 5176.00879
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 178.73705 | spectral_norm = 18.35199 | nuclear_norm = 4015.85400
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 175.96721 | spectral_norm = 16.65381 | nuclear_norm = 3964.07422
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 300.69754 | spectral_norm = 27.64440 | nuclear_norm = 6784.44434
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 297.15381 | spectral_norm = 21.72170 | nuclear_norm = 6986.49707
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 406.36172 | spectral_norm = 36.80344 | nuclear_norm = 10828.40625
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 197.41949 | spectral_norm = 19.51240 | nuclear_norm = 5207.48438
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 181.61131 | spectral_norm = 18.69047 | nuclear_norm = 4135.38086
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 178.28918 | spectral_norm = 17.24350 | nuclear_norm = 4088.77344
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 293.19101 | spectral_norm = 26.77823 | nuclear_norm = 6698.38428
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 291.51233 | spectral_norm = 21.46260 | nuclear_norm = 6907.42041
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 413.72488 | spectral_norm = 33.32243 | nuclear_norm = 11064.16406
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 196.21426 | spectral_norm = 19.55101 | nuclear_norm = 5169.71777
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 176.38361 | spectral_norm = 19.54303 | nuclear_norm = 3997.17065
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 171.94080 | spectral_norm = 18.40889 | nuclear_norm = 3935.29028
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 283.75876 | spectral_norm = 24.07030 | nuclear_norm = 6509.05420
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 277.90494 | spectral_norm = 23.34436 | nuclear_norm = 6403.93359
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 411.36465 | spectral_norm = 31.81677 | nuclear_norm = 10988.09473
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 199.38881 | spectral_norm = 21.92624 | nuclear_norm = 5246.16016
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 184.10922 | spectral_norm = 18.83951 | nuclear_norm = 4190.14209
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 182.70912 | spectral_norm = 19.27751 | nuclear_norm = 4154.98438
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 313.62003 | spectral_norm = 31.03002 | nuclear_norm = 7068.85742
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 302.29831 | spectral_norm = 21.49459 | nuclear_norm = 7190.40430
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 392.67975 | spectral_norm = 34.76256 | nuclear_norm = 10458.28711
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 202.79610 | spectral_norm = 20.86561 | nuclear_norm = 5364.05029
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 177.16267 | spectral_norm = 18.69086 | nuclear_norm = 3960.15381
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 176.84712 | spectral_norm = 17.31626 | nuclear_norm = 3972.36719
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 294.47012 | spectral_norm = 25.78890 | nuclear_norm = 6599.77441
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 294.53384 | spectral_norm = 23.74555 | nuclear_norm = 6820.70361
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 409.18991 | spectral_norm = 36.94918 | nuclear_norm = 10864.38770
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 206.10683 | spectral_norm = 21.90461 | nuclear_norm = 5452.90039
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 187.39919 | spectral_norm = 19.43943 | nuclear_norm = 4222.62891
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 183.20047 | spectral_norm = 18.57826 | nuclear_norm = 4151.63379
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 300.90726 | spectral_norm = 31.30232 | nuclear_norm = 6777.56152
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 293.67407 | spectral_norm = 25.68560 | nuclear_norm = 6881.84473
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 418.79681 | spectral_norm = 37.44091 | nuclear_norm = 11115.59277
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 208.84317 | spectral_norm = 22.30070 | nuclear_norm = 5517.18701
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 179.58798 | spectral_norm = 20.40725 | nuclear_norm = 3907.77197
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 181.75446 | spectral_norm = 18.28174 | nuclear_norm = 3891.82080
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 306.42551 | spectral_norm = 30.62339 | nuclear_norm = 6997.94971
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 309.80630 | spectral_norm = 21.37231 | nuclear_norm = 7285.89844
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 402.23761 | spectral_norm = 31.75684 | nuclear_norm = 10708.42188
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 196.08293 | spectral_norm = 23.45743 | nuclear_norm = 5188.57910
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 185.32965 | spectral_norm = 24.37304 | nuclear_norm = 4121.46289
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 179.22221 | spectral_norm = 22.48114 | nuclear_norm = 3984.19189
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 299.28101 | spectral_norm = 30.54235 | nuclear_norm = 6794.61621
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 329.26981 | spectral_norm = 23.42368 | nuclear_norm = 7700.70605
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 414.62268 | spectral_norm = 33.97360 | nuclear_norm = 11010.91992
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 207.93881 | spectral_norm = 28.09682 | nuclear_norm = 5434.95117
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1289.78967 | spectral_norm = 162.34349 | nuclear_norm = 33994.79297
===========================================
step:1251/1750 train_loss:3.5642 train_time:449947ms step_avg:362.57ms
step:1252/1750 train_loss:3.4358 train_time:450319ms step_avg:362.58ms
step:1253/1750 train_loss:3.3671 train_time:450694ms step_avg:362.59ms
step:1254/1750 train_loss:3.4837 train_time:451073ms step_avg:362.60ms
step:1255/1750 train_loss:3.5876 train_time:451468ms step_avg:362.62ms
step:1256/1750 train_loss:3.3754 train_time:451851ms step_avg:362.64ms
step:1257/1750 train_loss:3.4397 train_time:452227ms step_avg:362.65ms
step:1258/1750 train_loss:3.4156 train_time:452614ms step_avg:362.67ms
step:1259/1750 train_loss:3.3963 train_time:452991ms step_avg:362.68ms
step:1260/1750 train_loss:3.2726 train_time:453364ms step_avg:362.69ms
step:1261/1750 train_loss:3.3606 train_time:453745ms step_avg:362.71ms
step:1262/1750 train_loss:3.3881 train_time:454134ms step_avg:362.73ms
step:1263/1750 train_loss:3.2929 train_time:454519ms step_avg:362.74ms
step:1264/1750 train_loss:3.5096 train_time:454892ms step_avg:362.75ms
step:1265/1750 train_loss:3.4953 train_time:455267ms step_avg:362.76ms
step:1266/1750 train_loss:3.5054 train_time:455646ms step_avg:362.78ms
step:1267/1750 train_loss:3.4287 train_time:456021ms step_avg:362.79ms
step:1268/1750 train_loss:3.4704 train_time:456400ms step_avg:362.80ms
step:1269/1750 train_loss:3.3178 train_time:456787ms step_avg:362.82ms
step:1270/1750 train_loss:3.1616 train_time:457165ms step_avg:362.83ms
step:1271/1750 train_loss:3.4656 train_time:457546ms step_avg:362.84ms
step:1272/1750 train_loss:3.4216 train_time:457924ms step_avg:362.86ms
step:1273/1750 train_loss:3.4524 train_time:458308ms step_avg:362.87ms
step:1274/1750 train_loss:3.4216 train_time:458692ms step_avg:362.89ms
step:1275/1750 train_loss:3.4969 train_time:459066ms step_avg:362.90ms
step:1276/1750 train_loss:3.5338 train_time:459436ms step_avg:362.90ms
step:1277/1750 train_loss:3.4784 train_time:459815ms step_avg:362.92ms
step:1278/1750 train_loss:3.4707 train_time:460189ms step_avg:362.92ms
step:1279/1750 train_loss:3.3218 train_time:460572ms step_avg:362.94ms
step:1280/1750 train_loss:3.4337 train_time:460960ms step_avg:362.96ms
step:1281/1750 train_loss:3.4923 train_time:461338ms step_avg:362.97ms
step:1282/1750 train_loss:3.5334 train_time:461712ms step_avg:362.98ms
step:1283/1750 train_loss:3.3969 train_time:462095ms step_avg:363.00ms
step:1284/1750 train_loss:3.4385 train_time:462475ms step_avg:363.01ms
step:1285/1750 train_loss:3.4232 train_time:462854ms step_avg:363.02ms
step:1286/1750 train_loss:3.3990 train_time:463233ms step_avg:363.03ms
step:1287/1750 train_loss:3.5551 train_time:463612ms step_avg:363.05ms
step:1288/1750 train_loss:3.3640 train_time:463995ms step_avg:363.06ms
step:1289/1750 train_loss:3.4524 train_time:464386ms step_avg:363.08ms
step:1290/1750 train_loss:3.5226 train_time:464777ms step_avg:363.11ms
step:1291/1750 train_loss:3.4444 train_time:465160ms step_avg:363.12ms
step:1292/1750 train_loss:3.5388 train_time:465543ms step_avg:363.14ms
step:1293/1750 train_loss:3.5799 train_time:465925ms step_avg:363.15ms
step:1294/1750 train_loss:3.5239 train_time:466307ms step_avg:363.17ms
step:1295/1750 train_loss:3.3495 train_time:466686ms step_avg:363.18ms
step:1296/1750 train_loss:3.4382 train_time:467068ms step_avg:363.19ms
step:1297/1750 train_loss:3.3435 train_time:467449ms step_avg:363.21ms
step:1298/1750 train_loss:3.3452 train_time:467832ms step_avg:363.22ms
step:1299/1750 train_loss:3.4574 train_time:468213ms step_avg:363.24ms
step:1300/1750 train_loss:3.4736 train_time:468597ms step_avg:363.25ms
step:1301/1750 train_loss:3.4677 train_time:468976ms step_avg:363.27ms
step:1302/1750 train_loss:3.6401 train_time:469369ms step_avg:363.29ms
step:1303/1750 train_loss:3.3682 train_time:469762ms step_avg:363.31ms
step:1304/1750 train_loss:3.5740 train_time:470150ms step_avg:363.33ms
step:1305/1750 train_loss:3.3361 train_time:470531ms step_avg:363.34ms
step:1306/1750 train_loss:3.5146 train_time:470923ms step_avg:363.37ms
step:1307/1750 train_loss:3.5222 train_time:471298ms step_avg:363.38ms
step:1308/1750 train_loss:3.3602 train_time:471680ms step_avg:363.39ms
step:1309/1750 train_loss:3.3696 train_time:472070ms step_avg:363.41ms
step:1310/1750 train_loss:3.3708 train_time:472453ms step_avg:363.43ms
step:1311/1750 train_loss:3.3604 train_time:472837ms step_avg:363.44ms
step:1312/1750 train_loss:3.4464 train_time:473226ms step_avg:363.46ms
step:1313/1750 train_loss:3.4098 train_time:473607ms step_avg:363.47ms
step:1314/1750 train_loss:3.1050 train_time:473997ms step_avg:363.49ms
step:1315/1750 train_loss:3.3443 train_time:474380ms step_avg:363.51ms
step:1316/1750 train_loss:3.4586 train_time:474754ms step_avg:363.52ms
step:1317/1750 train_loss:3.4851 train_time:475134ms step_avg:363.53ms
step:1318/1750 train_loss:3.3585 train_time:475531ms step_avg:363.56ms
step:1319/1750 train_loss:3.4938 train_time:475922ms step_avg:363.58ms
step:1320/1750 train_loss:3.5203 train_time:476316ms step_avg:363.60ms
step:1321/1750 train_loss:3.4270 train_time:476703ms step_avg:363.62ms
step:1322/1750 train_loss:3.3866 train_time:477144ms step_avg:363.68ms
step:1323/1750 train_loss:3.3952 train_time:477648ms step_avg:363.78ms
step:1324/1750 train_loss:3.4966 train_time:478036ms step_avg:363.80ms
step:1325/1750 train_loss:3.5542 train_time:478434ms step_avg:363.83ms
step:1326/1750 train_loss:3.2787 train_time:478823ms step_avg:363.85ms
step:1327/1750 train_loss:3.2284 train_time:479203ms step_avg:363.86ms
step:1328/1750 train_loss:3.5547 train_time:479594ms step_avg:363.88ms
step:1329/1750 train_loss:3.3567 train_time:480134ms step_avg:364.01ms
step:1330/1750 train_loss:3.4913 train_time:480527ms step_avg:364.04ms
step:1331/1750 train_loss:3.3980 train_time:480906ms step_avg:364.05ms
step:1332/1750 train_loss:3.8105 train_time:481295ms step_avg:364.07ms
step:1333/1750 train_loss:3.5363 train_time:481684ms step_avg:364.08ms
step:1334/1750 train_loss:3.4356 train_time:482067ms step_avg:364.10ms
step:1335/1750 train_loss:3.3639 train_time:482450ms step_avg:364.11ms
step:1336/1750 train_loss:3.3515 train_time:482845ms step_avg:364.14ms
step:1337/1750 train_loss:3.6165 train_time:483233ms step_avg:364.15ms
step:1338/1750 train_loss:3.5843 train_time:483620ms step_avg:364.17ms
step:1339/1750 train_loss:3.4016 train_time:484013ms step_avg:364.19ms
step:1340/1750 train_loss:3.3475 train_time:484402ms step_avg:364.21ms
step:1341/1750 train_loss:3.6557 train_time:484784ms step_avg:364.23ms
step:1342/1750 train_loss:3.4190 train_time:485170ms step_avg:364.24ms
step:1343/1750 train_loss:3.4265 train_time:485550ms step_avg:364.25ms
step:1344/1750 train_loss:3.4787 train_time:485940ms step_avg:364.27ms
step:1345/1750 train_loss:3.4459 train_time:486334ms step_avg:364.29ms
step:1346/1750 train_loss:3.3638 train_time:486716ms step_avg:364.31ms
step:1347/1750 train_loss:3.3328 train_time:487100ms step_avg:364.32ms
step:1348/1750 train_loss:3.4106 train_time:487485ms step_avg:364.34ms
step:1349/1750 train_loss:3.3358 train_time:487870ms step_avg:364.35ms
step:1350/1750 train_loss:3.4542 train_time:488259ms step_avg:364.37ms
step:1351/1750 train_loss:3.3073 train_time:488639ms step_avg:364.38ms
step:1352/1750 train_loss:3.3637 train_time:489022ms step_avg:364.40ms
step:1353/1750 train_loss:3.4702 train_time:489414ms step_avg:364.42ms
step:1354/1750 train_loss:3.3145 train_time:489799ms step_avg:364.43ms
step:1355/1750 train_loss:3.2553 train_time:490183ms step_avg:364.45ms
step:1356/1750 train_loss:3.5769 train_time:490572ms step_avg:364.47ms
step:1357/1750 train_loss:3.4922 train_time:490963ms step_avg:364.49ms
step:1358/1750 train_loss:3.2435 train_time:491350ms step_avg:364.50ms
step:1359/1750 train_loss:3.5074 train_time:491739ms step_avg:364.52ms
step:1360/1750 train_loss:3.4180 train_time:492127ms step_avg:364.54ms
step:1361/1750 train_loss:3.2043 train_time:492518ms step_avg:364.56ms
step:1362/1750 train_loss:3.4515 train_time:492905ms step_avg:364.58ms
step:1363/1750 train_loss:3.3387 train_time:493298ms step_avg:364.60ms
step:1364/1750 train_loss:3.3731 train_time:493678ms step_avg:364.61ms
step:1365/1750 train_loss:3.3740 train_time:494058ms step_avg:364.62ms
step:1366/1750 train_loss:3.4882 train_time:494445ms step_avg:364.64ms
step:1367/1750 train_loss:3.4644 train_time:494829ms step_avg:364.65ms
step:1368/1750 train_loss:3.4165 train_time:495217ms step_avg:364.67ms
step:1369/1750 train_loss:3.3298 train_time:495615ms step_avg:364.69ms
step:1370/1750 train_loss:3.6684 train_time:496003ms step_avg:364.71ms
step:1371/1750 train_loss:3.3792 train_time:496391ms step_avg:364.72ms
step:1372/1750 train_loss:3.4252 train_time:496780ms step_avg:364.74ms
step:1373/1750 train_loss:3.4282 train_time:497160ms step_avg:364.75ms
step:1374/1750 train_loss:3.2199 train_time:497545ms step_avg:364.77ms
step:1375/1750 train_loss:3.6014 train_time:497926ms step_avg:364.78ms
step:1375/1750 val_loss:3.3748 train_time:498026ms step_avg:364.85ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 294.15582 | frobenius_norm = 67893.05469 | spectral_norm = 12023.55566 | nuclear_norm = 1712782.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 188.70050 | spectral_norm = 34.94592 | nuclear_norm = 4332.71191
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 183.09100 | spectral_norm = 38.88507 | nuclear_norm = 4174.10645
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 309.63849 | spectral_norm = 21.52697 | nuclear_norm = 7551.19287
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 215.26936 | spectral_norm = 23.91079 | nuclear_norm = 4970.49707
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 409.19171 | spectral_norm = 34.01052 | nuclear_norm = 10902.22852
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 208.35329 | spectral_norm = 19.99686 | nuclear_norm = 5522.90674
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 190.24025 | spectral_norm = 18.97139 | nuclear_norm = 4386.93896
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 185.47525 | spectral_norm = 18.77658 | nuclear_norm = 4267.17041
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 274.50937 | spectral_norm = 23.15265 | nuclear_norm = 6321.86328
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 269.63919 | spectral_norm = 21.98270 | nuclear_norm = 6333.42920
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 403.16318 | spectral_norm = 31.03293 | nuclear_norm = 10765.89941
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 197.91701 | spectral_norm = 20.58307 | nuclear_norm = 5194.91553
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 184.99730 | spectral_norm = 20.80573 | nuclear_norm = 4222.25732
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 185.10634 | spectral_norm = 18.48983 | nuclear_norm = 4222.99023
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 276.31461 | spectral_norm = 25.23861 | nuclear_norm = 6278.35596
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 282.24023 | spectral_norm = 25.52086 | nuclear_norm = 6530.52148
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 407.26505 | spectral_norm = 34.70207 | nuclear_norm = 10829.96875
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 204.53366 | spectral_norm = 22.27432 | nuclear_norm = 5363.64062
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 184.01257 | spectral_norm = 19.05639 | nuclear_norm = 4145.86523
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 183.52852 | spectral_norm = 17.36691 | nuclear_norm = 4165.50000
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 296.44452 | spectral_norm = 25.99403 | nuclear_norm = 6719.46240
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 298.04910 | spectral_norm = 25.55138 | nuclear_norm = 6947.35596
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 410.21396 | spectral_norm = 39.49603 | nuclear_norm = 10900.29199
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 202.71284 | spectral_norm = 21.71507 | nuclear_norm = 5327.80371
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 183.89948 | spectral_norm = 18.91374 | nuclear_norm = 4122.47998
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 181.05226 | spectral_norm = 17.22090 | nuclear_norm = 4069.73779
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 310.45612 | spectral_norm = 28.62065 | nuclear_norm = 7011.11426
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 306.32721 | spectral_norm = 22.34037 | nuclear_norm = 7205.75000
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 418.14893 | spectral_norm = 38.42279 | nuclear_norm = 11140.43457
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 203.27151 | spectral_norm = 20.39371 | nuclear_norm = 5362.43555
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 187.05544 | spectral_norm = 19.39887 | nuclear_norm = 4252.24707
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 183.73543 | spectral_norm = 17.86328 | nuclear_norm = 4209.23340
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 302.73102 | spectral_norm = 27.69766 | nuclear_norm = 6922.31152
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 300.74066 | spectral_norm = 22.11488 | nuclear_norm = 7132.34033
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 425.98587 | spectral_norm = 34.64225 | nuclear_norm = 11393.66211
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 202.08406 | spectral_norm = 20.37157 | nuclear_norm = 5326.79248
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 181.69116 | spectral_norm = 20.42008 | nuclear_norm = 4107.00146
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 177.21407 | spectral_norm = 19.02386 | nuclear_norm = 4049.94946
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 292.87888 | spectral_norm = 24.99366 | nuclear_norm = 6729.49219
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 286.45508 | spectral_norm = 23.94622 | nuclear_norm = 6603.93750
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 423.98444 | spectral_norm = 33.15102 | nuclear_norm = 11324.97461
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 205.40689 | spectral_norm = 22.92707 | nuclear_norm = 5403.57324
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 189.45325 | spectral_norm = 19.52169 | nuclear_norm = 4304.39062
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 188.05748 | spectral_norm = 19.74716 | nuclear_norm = 4269.62695
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 323.52350 | spectral_norm = 32.02575 | nuclear_norm = 7284.91699
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 311.28668 | spectral_norm = 22.09954 | nuclear_norm = 7405.68311
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 404.04474 | spectral_norm = 36.16128 | nuclear_norm = 10758.20312
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 208.60356 | spectral_norm = 21.71083 | nuclear_norm = 5517.06982
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 182.09903 | spectral_norm = 19.31499 | nuclear_norm = 4060.60913
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 181.90250 | spectral_norm = 17.90759 | nuclear_norm = 4075.75659
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 303.94119 | spectral_norm = 26.51786 | nuclear_norm = 6816.57520
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 303.11664 | spectral_norm = 24.41329 | nuclear_norm = 7014.65381
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 421.79596 | spectral_norm = 38.57359 | nuclear_norm = 11193.36133
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 212.14996 | spectral_norm = 22.73918 | nuclear_norm = 5611.10645
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 192.93646 | spectral_norm = 20.14255 | nuclear_norm = 4336.11816
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 188.70749 | spectral_norm = 19.20020 | nuclear_norm = 4267.91357
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 311.04147 | spectral_norm = 32.35845 | nuclear_norm = 7005.74463
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 302.59570 | spectral_norm = 26.61838 | nuclear_norm = 7088.71826
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 431.38480 | spectral_norm = 38.90678 | nuclear_norm = 11443.94531
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 215.11069 | spectral_norm = 23.22050 | nuclear_norm = 5680.82227
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 184.51355 | spectral_norm = 21.20472 | nuclear_norm = 3997.03223
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 186.87250 | spectral_norm = 18.96700 | nuclear_norm = 3980.33984
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 316.37326 | spectral_norm = 32.17841 | nuclear_norm = 7220.36816
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 318.46375 | spectral_norm = 22.02908 | nuclear_norm = 7491.00098
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 413.75867 | spectral_norm = 32.95535 | nuclear_norm = 11011.61719
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 202.18524 | spectral_norm = 24.39288 | nuclear_norm = 5349.72168
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 190.60123 | spectral_norm = 25.54272 | nuclear_norm = 4224.36426
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 184.16109 | spectral_norm = 23.53327 | nuclear_norm = 4078.95239
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 311.47720 | spectral_norm = 31.89739 | nuclear_norm = 7064.92090
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 340.12918 | spectral_norm = 24.28235 | nuclear_norm = 7951.92871
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 425.79727 | spectral_norm = 35.21611 | nuclear_norm = 11302.02148
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 214.55402 | spectral_norm = 29.32208 | nuclear_norm = 5604.96777
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1314.89514 | spectral_norm = 160.98514 | nuclear_norm = 34722.69922
===========================================
step:1376/1750 train_loss:3.4063 train_time:498300ms step_avg:364.79ms
step:1377/1750 train_loss:3.5413 train_time:498674ms step_avg:364.79ms
step:1378/1750 train_loss:3.5422 train_time:499053ms step_avg:364.80ms
step:1379/1750 train_loss:3.1846 train_time:499440ms step_avg:364.82ms
step:1380/1750 train_loss:3.3698 train_time:499821ms step_avg:364.83ms
step:1381/1750 train_loss:3.7770 train_time:500212ms step_avg:364.85ms
step:1382/1750 train_loss:3.2824 train_time:500593ms step_avg:364.86ms
step:1383/1750 train_loss:3.4580 train_time:500978ms step_avg:364.88ms
step:1384/1750 train_loss:3.5414 train_time:501362ms step_avg:364.89ms
step:1385/1750 train_loss:3.4655 train_time:501737ms step_avg:364.90ms
step:1386/1750 train_loss:3.4068 train_time:502120ms step_avg:364.91ms
step:1387/1750 train_loss:3.2614 train_time:502505ms step_avg:364.93ms
step:1388/1750 train_loss:3.4061 train_time:502883ms step_avg:364.94ms
step:1389/1750 train_loss:3.3874 train_time:503267ms step_avg:364.95ms
step:1390/1750 train_loss:3.6387 train_time:503645ms step_avg:364.96ms
step:1391/1750 train_loss:3.3511 train_time:504028ms step_avg:364.97ms
step:1392/1750 train_loss:3.3535 train_time:504409ms step_avg:364.98ms
step:1393/1750 train_loss:3.3052 train_time:504787ms step_avg:364.99ms
step:1394/1750 train_loss:3.5692 train_time:505164ms step_avg:365.00ms
step:1395/1750 train_loss:3.4565 train_time:505546ms step_avg:365.01ms
step:1396/1750 train_loss:3.4705 train_time:505925ms step_avg:365.03ms
step:1397/1750 train_loss:3.3660 train_time:506301ms step_avg:365.03ms
step:1398/1750 train_loss:3.3207 train_time:506681ms step_avg:365.04ms
step:1399/1750 train_loss:3.3909 train_time:507064ms step_avg:365.06ms
step:1400/1750 train_loss:3.3752 train_time:507459ms step_avg:365.08ms
step:1401/1750 train_loss:3.4099 train_time:507829ms step_avg:365.08ms
step:1402/1750 train_loss:3.3582 train_time:508207ms step_avg:365.09ms
step:1403/1750 train_loss:3.5592 train_time:508596ms step_avg:365.11ms
step:1404/1750 train_loss:3.3373 train_time:508974ms step_avg:365.12ms
step:1405/1750 train_loss:3.3712 train_time:509355ms step_avg:365.13ms
step:1406/1750 train_loss:3.3738 train_time:509738ms step_avg:365.14ms
step:1407/1750 train_loss:3.2328 train_time:510116ms step_avg:365.15ms
step:1408/1750 train_loss:3.3636 train_time:510500ms step_avg:365.16ms
step:1409/1750 train_loss:3.3565 train_time:510901ms step_avg:365.19ms
step:1410/1750 train_loss:3.3453 train_time:511281ms step_avg:365.20ms
step:1411/1750 train_loss:3.4299 train_time:511657ms step_avg:365.21ms
step:1412/1750 train_loss:3.3882 train_time:512036ms step_avg:365.22ms
step:1413/1750 train_loss:3.4204 train_time:512420ms step_avg:365.23ms
step:1414/1750 train_loss:3.3988 train_time:512805ms step_avg:365.25ms
step:1415/1750 train_loss:3.4708 train_time:513199ms step_avg:365.27ms
step:1416/1750 train_loss:3.2881 train_time:513605ms step_avg:365.29ms
step:1417/1750 train_loss:3.3433 train_time:513993ms step_avg:365.31ms
step:1418/1750 train_loss:3.4526 train_time:514377ms step_avg:365.32ms
step:1419/1750 train_loss:3.4076 train_time:514765ms step_avg:365.34ms
step:1420/1750 train_loss:3.4178 train_time:515153ms step_avg:365.36ms
step:1421/1750 train_loss:3.4335 train_time:515537ms step_avg:365.37ms
step:1422/1750 train_loss:3.3961 train_time:515915ms step_avg:365.38ms
step:1423/1750 train_loss:3.3774 train_time:516295ms step_avg:365.39ms
step:1424/1750 train_loss:3.3901 train_time:516686ms step_avg:365.41ms
step:1425/1750 train_loss:3.2411 train_time:517084ms step_avg:365.43ms
step:1426/1750 train_loss:3.3877 train_time:517467ms step_avg:365.44ms
step:1427/1750 train_loss:3.3384 train_time:517856ms step_avg:365.46ms
step:1428/1750 train_loss:3.4354 train_time:518239ms step_avg:365.47ms
step:1429/1750 train_loss:3.4169 train_time:518620ms step_avg:365.48ms
step:1430/1750 train_loss:3.3186 train_time:519010ms step_avg:365.50ms
step:1431/1750 train_loss:3.3746 train_time:519403ms step_avg:365.52ms
step:1432/1750 train_loss:3.3997 train_time:519796ms step_avg:365.54ms
step:1433/1750 train_loss:3.1946 train_time:520197ms step_avg:365.56ms
step:1434/1750 train_loss:3.3472 train_time:520597ms step_avg:365.59ms
step:1435/1750 train_loss:3.1794 train_time:520986ms step_avg:365.60ms
step:1436/1750 train_loss:3.2796 train_time:521372ms step_avg:365.62ms
step:1437/1750 train_loss:3.4694 train_time:521753ms step_avg:365.63ms
step:1438/1750 train_loss:3.4407 train_time:522138ms step_avg:365.64ms
step:1439/1750 train_loss:3.3798 train_time:522527ms step_avg:365.66ms
step:1440/1750 train_loss:3.2503 train_time:522907ms step_avg:365.67ms
step:1441/1750 train_loss:3.4037 train_time:523293ms step_avg:365.68ms
step:1442/1750 train_loss:3.4415 train_time:523687ms step_avg:365.70ms
step:1443/1750 train_loss:3.5349 train_time:524091ms step_avg:365.73ms
step:1444/1750 train_loss:3.5114 train_time:524475ms step_avg:365.74ms
step:1445/1750 train_loss:3.3950 train_time:524862ms step_avg:365.76ms
step:1446/1750 train_loss:3.2616 train_time:525258ms step_avg:365.78ms
step:1447/1750 train_loss:3.3498 train_time:525653ms step_avg:365.80ms
step:1448/1750 train_loss:3.3499 train_time:526035ms step_avg:365.81ms
step:1449/1750 train_loss:3.4516 train_time:526419ms step_avg:365.82ms
step:1450/1750 train_loss:3.4480 train_time:526806ms step_avg:365.84ms
step:1451/1750 train_loss:3.2666 train_time:527190ms step_avg:365.85ms
step:1452/1750 train_loss:3.3831 train_time:527578ms step_avg:365.87ms
step:1453/1750 train_loss:3.3147 train_time:527956ms step_avg:365.87ms
step:1454/1750 train_loss:3.3407 train_time:528340ms step_avg:365.89ms
step:1455/1750 train_loss:3.3836 train_time:528731ms step_avg:365.90ms
step:1456/1750 train_loss:3.3359 train_time:529112ms step_avg:365.91ms
step:1457/1750 train_loss:3.2158 train_time:529496ms step_avg:365.93ms
step:1458/1750 train_loss:3.4811 train_time:529882ms step_avg:365.94ms
step:1459/1750 train_loss:3.3265 train_time:530273ms step_avg:365.96ms
step:1460/1750 train_loss:3.3715 train_time:530657ms step_avg:365.97ms
step:1461/1750 train_loss:3.4933 train_time:531043ms step_avg:365.98ms
step:1462/1750 train_loss:3.3188 train_time:531425ms step_avg:366.00ms
step:1463/1750 train_loss:3.5221 train_time:531819ms step_avg:366.01ms
step:1464/1750 train_loss:3.4152 train_time:532208ms step_avg:366.03ms
step:1465/1750 train_loss:3.4125 train_time:532594ms step_avg:366.04ms
step:1466/1750 train_loss:3.3423 train_time:532977ms step_avg:366.06ms
step:1467/1750 train_loss:3.4494 train_time:533368ms step_avg:366.07ms
step:1468/1750 train_loss:3.3412 train_time:533751ms step_avg:366.08ms
step:1469/1750 train_loss:3.3263 train_time:534141ms step_avg:366.10ms
step:1470/1750 train_loss:3.3848 train_time:534539ms step_avg:366.12ms
step:1471/1750 train_loss:3.3088 train_time:534941ms step_avg:366.15ms
step:1472/1750 train_loss:3.2894 train_time:535340ms step_avg:366.17ms
step:1473/1750 train_loss:3.4906 train_time:535723ms step_avg:366.18ms
step:1474/1750 train_loss:3.3636 train_time:536119ms step_avg:366.20ms
step:1475/1750 train_loss:3.1960 train_time:536517ms step_avg:366.22ms
step:1476/1750 train_loss:3.3158 train_time:536901ms step_avg:366.24ms
step:1477/1750 train_loss:3.2983 train_time:537299ms step_avg:366.26ms
step:1478/1750 train_loss:3.3683 train_time:537695ms step_avg:366.28ms
step:1479/1750 train_loss:3.4493 train_time:538083ms step_avg:366.29ms
step:1480/1750 train_loss:3.3297 train_time:538464ms step_avg:366.30ms
step:1481/1750 train_loss:3.5044 train_time:538852ms step_avg:366.32ms
step:1482/1750 train_loss:3.4241 train_time:539256ms step_avg:366.34ms
step:1483/1750 train_loss:3.3337 train_time:539666ms step_avg:366.37ms
step:1484/1750 train_loss:3.3135 train_time:540063ms step_avg:366.39ms
step:1485/1750 train_loss:3.3277 train_time:540446ms step_avg:366.40ms
step:1486/1750 train_loss:3.2767 train_time:540837ms step_avg:366.42ms
step:1487/1750 train_loss:3.3894 train_time:541229ms step_avg:366.44ms
step:1488/1750 train_loss:3.2832 train_time:541624ms step_avg:366.46ms
step:1489/1750 train_loss:3.3738 train_time:542013ms step_avg:366.47ms
step:1490/1750 train_loss:3.3017 train_time:542403ms step_avg:366.49ms
step:1491/1750 train_loss:3.2186 train_time:542791ms step_avg:366.50ms
step:1492/1750 train_loss:3.3176 train_time:543177ms step_avg:366.52ms
step:1493/1750 train_loss:3.4826 train_time:543557ms step_avg:366.53ms
step:1494/1750 train_loss:3.3508 train_time:543937ms step_avg:366.53ms
step:1495/1750 train_loss:3.0776 train_time:544329ms step_avg:366.55ms
step:1496/1750 train_loss:3.4126 train_time:544718ms step_avg:366.57ms
step:1497/1750 train_loss:3.3601 train_time:545109ms step_avg:366.58ms
step:1498/1750 train_loss:3.3911 train_time:545505ms step_avg:366.60ms
step:1499/1750 train_loss:3.3676 train_time:545907ms step_avg:366.63ms
step:1500/1750 train_loss:3.3448 train_time:546320ms step_avg:366.66ms
step:1500/1750 val_loss:3.3304 train_time:546425ms step_avg:366.73ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.20383 | frobenius_norm = 68379.15625 | spectral_norm = 12128.81250 | nuclear_norm = 1726168.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 190.85870 | spectral_norm = 36.23036 | nuclear_norm = 4375.68066
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 185.49863 | spectral_norm = 40.03998 | nuclear_norm = 4224.48047
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 314.52463 | spectral_norm = 21.85604 | nuclear_norm = 7680.21826
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 216.13373 | spectral_norm = 24.27711 | nuclear_norm = 4984.05908
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 416.32138 | spectral_norm = 34.69228 | nuclear_norm = 11092.02051
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 211.69365 | spectral_norm = 20.39266 | nuclear_norm = 5612.14551
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 193.05336 | spectral_norm = 19.32146 | nuclear_norm = 4449.03906
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 188.36069 | spectral_norm = 19.18375 | nuclear_norm = 4330.48047
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 278.69342 | spectral_norm = 23.46708 | nuclear_norm = 6419.46289
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 273.43436 | spectral_norm = 22.33047 | nuclear_norm = 6425.94824
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 409.60144 | spectral_norm = 31.58396 | nuclear_norm = 10940.15918
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 200.96373 | spectral_norm = 21.00129 | nuclear_norm = 5274.74902
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 187.71791 | spectral_norm = 21.32758 | nuclear_norm = 4281.49756
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 187.91245 | spectral_norm = 18.88775 | nuclear_norm = 4282.73340
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 281.26358 | spectral_norm = 25.69985 | nuclear_norm = 6395.44824
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 287.00308 | spectral_norm = 25.96470 | nuclear_norm = 6645.62793
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 413.55463 | spectral_norm = 35.42040 | nuclear_norm = 10996.53516
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 207.60410 | spectral_norm = 22.73628 | nuclear_norm = 5442.64258
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 186.71027 | spectral_norm = 19.44881 | nuclear_norm = 4199.81104
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 186.26718 | spectral_norm = 17.71436 | nuclear_norm = 4223.08350
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 301.93484 | spectral_norm = 26.53126 | nuclear_norm = 6849.22949
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 303.14316 | spectral_norm = 26.19930 | nuclear_norm = 7066.79785
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 416.40088 | spectral_norm = 40.51257 | nuclear_norm = 11062.18848
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 205.79352 | spectral_norm = 22.22455 | nuclear_norm = 5407.78516
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 186.52652 | spectral_norm = 19.27661 | nuclear_norm = 4172.29443
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 183.64566 | spectral_norm = 17.59611 | nuclear_norm = 4121.42578
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 316.22958 | spectral_norm = 29.15237 | nuclear_norm = 7149.25293
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 311.67795 | spectral_norm = 22.82157 | nuclear_norm = 7334.76855
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 424.43591 | spectral_norm = 39.22400 | nuclear_norm = 11305.94434
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 206.41457 | spectral_norm = 20.88322 | nuclear_norm = 5446.22461
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 189.88243 | spectral_norm = 19.83751 | nuclear_norm = 4310.40820
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 186.56613 | spectral_norm = 18.25592 | nuclear_norm = 4270.31299
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 308.28842 | spectral_norm = 28.25109 | nuclear_norm = 7055.64209
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 306.13730 | spectral_norm = 22.40089 | nuclear_norm = 7265.84277
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 432.51175 | spectral_norm = 35.40187 | nuclear_norm = 11568.54492
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 205.24884 | spectral_norm = 20.88787 | nuclear_norm = 5412.31055
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 184.43945 | spectral_norm = 20.98707 | nuclear_norm = 4161.68213
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 179.89240 | spectral_norm = 19.42111 | nuclear_norm = 4106.35596
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 298.29962 | spectral_norm = 25.40069 | nuclear_norm = 6865.08496
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 291.45966 | spectral_norm = 24.25686 | nuclear_norm = 6724.03711
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 430.72556 | spectral_norm = 33.88010 | nuclear_norm = 11505.12988
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 208.59564 | spectral_norm = 23.50050 | nuclear_norm = 5487.01855
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 192.31458 | spectral_norm = 19.92775 | nuclear_norm = 4363.71387
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 190.98953 | spectral_norm = 20.02153 | nuclear_norm = 4330.69531
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 329.44116 | spectral_norm = 32.60325 | nuclear_norm = 7414.57715
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 316.37061 | spectral_norm = 22.41619 | nuclear_norm = 7528.78223
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 410.02441 | spectral_norm = 36.97235 | nuclear_norm = 10914.69141
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 211.59479 | spectral_norm = 22.15121 | nuclear_norm = 5595.32227
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 184.63031 | spectral_norm = 19.71082 | nuclear_norm = 4106.98291
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 184.55739 | spectral_norm = 18.24437 | nuclear_norm = 4128.18701
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 309.64117 | spectral_norm = 26.93561 | nuclear_norm = 6951.54150
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 308.15240 | spectral_norm = 24.81009 | nuclear_norm = 7128.28564
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 428.48068 | spectral_norm = 39.54568 | nuclear_norm = 11365.54883
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 215.28281 | spectral_norm = 23.19018 | nuclear_norm = 5692.38086
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 195.84911 | spectral_norm = 20.67947 | nuclear_norm = 4392.95801
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 191.52921 | spectral_norm = 19.60254 | nuclear_norm = 4324.87402
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 317.14124 | spectral_norm = 32.97070 | nuclear_norm = 7144.49414
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 307.70557 | spectral_norm = 27.15279 | nuclear_norm = 7206.68652
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 437.89264 | spectral_norm = 39.72095 | nuclear_norm = 11612.25391
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 218.34044 | spectral_norm = 23.72583 | nuclear_norm = 5764.45801
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 187.04770 | spectral_norm = 21.67706 | nuclear_norm = 4035.33008
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 189.53421 | spectral_norm = 19.40931 | nuclear_norm = 4018.26367
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 322.52164 | spectral_norm = 33.16493 | nuclear_norm = 7358.70312
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 323.30154 | spectral_norm = 22.48150 | nuclear_norm = 7602.38965
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 419.22556 | spectral_norm = 33.65059 | nuclear_norm = 11153.70215
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 205.41797 | spectral_norm = 24.89119 | nuclear_norm = 5435.12500
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 193.42155 | spectral_norm = 26.28779 | nuclear_norm = 4273.98340
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 186.61121 | spectral_norm = 24.21390 | nuclear_norm = 4119.67578
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 319.67441 | spectral_norm = 32.74964 | nuclear_norm = 7247.96484
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 346.55835 | spectral_norm = 24.77621 | nuclear_norm = 8099.61572
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 431.06717 | spectral_norm = 35.79100 | nuclear_norm = 11438.12500
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 217.89008 | spectral_norm = 29.86566 | nuclear_norm = 5689.83936
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1323.19116 | spectral_norm = 158.85165 | nuclear_norm = 34997.13281
===========================================
step:1501/1750 train_loss:3.1388 train_time:546703ms step_avg:366.67ms
step:1502/1750 train_loss:3.4118 train_time:547082ms step_avg:366.68ms
step:1503/1750 train_loss:3.2953 train_time:547463ms step_avg:366.69ms
step:1504/1750 train_loss:3.2994 train_time:547846ms step_avg:366.70ms
step:1505/1750 train_loss:3.2573 train_time:548227ms step_avg:366.71ms
step:1506/1750 train_loss:3.3352 train_time:548615ms step_avg:366.72ms
step:1507/1750 train_loss:3.2242 train_time:549023ms step_avg:366.75ms
step:1508/1750 train_loss:3.5325 train_time:549412ms step_avg:366.76ms
step:1509/1750 train_loss:3.3272 train_time:549793ms step_avg:366.77ms
step:1510/1750 train_loss:3.3223 train_time:550177ms step_avg:366.78ms
step:1511/1750 train_loss:3.4574 train_time:550602ms step_avg:366.82ms
step:1512/1750 train_loss:3.4682 train_time:551045ms step_avg:366.87ms
step:1513/1750 train_loss:3.3155 train_time:551433ms step_avg:366.89ms
step:1514/1750 train_loss:3.1380 train_time:551824ms step_avg:366.90ms
step:1515/1750 train_loss:3.2834 train_time:552212ms step_avg:366.92ms
step:1516/1750 train_loss:3.2986 train_time:552607ms step_avg:366.94ms
step:1517/1750 train_loss:3.3540 train_time:552993ms step_avg:366.95ms
step:1518/1750 train_loss:3.2572 train_time:553382ms step_avg:366.96ms
step:1519/1750 train_loss:3.5500 train_time:553908ms step_avg:367.07ms
step:1520/1750 train_loss:3.1752 train_time:554301ms step_avg:367.09ms
step:1521/1750 train_loss:3.2585 train_time:554684ms step_avg:367.10ms
step:1522/1750 train_loss:3.3956 train_time:555073ms step_avg:367.11ms
step:1523/1750 train_loss:3.2726 train_time:555455ms step_avg:367.12ms
step:1524/1750 train_loss:3.3903 train_time:555843ms step_avg:367.14ms
step:1525/1750 train_loss:3.3766 train_time:556246ms step_avg:367.16ms
step:1526/1750 train_loss:3.3180 train_time:556656ms step_avg:367.19ms
step:1527/1750 train_loss:3.3346 train_time:557044ms step_avg:367.20ms
step:1528/1750 train_loss:3.4538 train_time:557430ms step_avg:367.21ms
step:1529/1750 train_loss:3.4527 train_time:557810ms step_avg:367.22ms
step:1530/1750 train_loss:3.2829 train_time:558191ms step_avg:367.23ms
step:1531/1750 train_loss:3.2339 train_time:558578ms step_avg:367.24ms
step:1532/1750 train_loss:3.3902 train_time:558964ms step_avg:367.26ms
step:1533/1750 train_loss:3.3192 train_time:559364ms step_avg:367.28ms
step:1534/1750 train_loss:3.3201 train_time:559762ms step_avg:367.30ms
step:1535/1750 train_loss:3.3239 train_time:560152ms step_avg:367.31ms
step:1536/1750 train_loss:3.2731 train_time:560543ms step_avg:367.33ms
step:1537/1750 train_loss:3.3171 train_time:560931ms step_avg:367.34ms
step:1538/1750 train_loss:3.4728 train_time:561333ms step_avg:367.36ms
step:1539/1750 train_loss:3.4424 train_time:561729ms step_avg:367.38ms
step:1540/1750 train_loss:3.3178 train_time:562117ms step_avg:367.40ms
step:1541/1750 train_loss:3.2673 train_time:562508ms step_avg:367.41ms
step:1542/1750 train_loss:3.2950 train_time:562900ms step_avg:367.43ms
step:1543/1750 train_loss:3.1936 train_time:563288ms step_avg:367.44ms
step:1544/1750 train_loss:3.3339 train_time:563667ms step_avg:367.45ms
step:1545/1750 train_loss:3.3109 train_time:564058ms step_avg:367.46ms
step:1546/1750 train_loss:3.3067 train_time:564463ms step_avg:367.49ms
step:1547/1750 train_loss:3.2599 train_time:564858ms step_avg:367.51ms
step:1548/1750 train_loss:3.3078 train_time:565257ms step_avg:367.53ms
step:1549/1750 train_loss:3.3763 train_time:565640ms step_avg:367.54ms
step:1550/1750 train_loss:3.3363 train_time:566021ms step_avg:367.55ms
step:1551/1750 train_loss:3.2416 train_time:566410ms step_avg:367.56ms
step:1552/1750 train_loss:3.2657 train_time:566800ms step_avg:367.57ms
step:1553/1750 train_loss:3.2731 train_time:567182ms step_avg:367.58ms
step:1554/1750 train_loss:3.4013 train_time:567571ms step_avg:367.60ms
step:1555/1750 train_loss:3.3823 train_time:567962ms step_avg:367.61ms
step:1556/1750 train_loss:3.3223 train_time:568341ms step_avg:367.62ms
step:1557/1750 train_loss:3.3650 train_time:568720ms step_avg:367.63ms
step:1558/1750 train_loss:3.3045 train_time:569108ms step_avg:367.64ms
step:1559/1750 train_loss:3.1715 train_time:569512ms step_avg:367.66ms
step:1560/1750 train_loss:3.4716 train_time:569896ms step_avg:367.67ms
step:1561/1750 train_loss:3.2662 train_time:570283ms step_avg:367.69ms
step:1562/1750 train_loss:3.2594 train_time:570666ms step_avg:367.70ms
step:1563/1750 train_loss:3.3658 train_time:571054ms step_avg:367.71ms
step:1564/1750 train_loss:3.1973 train_time:571455ms step_avg:367.73ms
step:1565/1750 train_loss:3.2075 train_time:571852ms step_avg:367.75ms
step:1566/1750 train_loss:3.4058 train_time:572244ms step_avg:367.77ms
step:1567/1750 train_loss:3.2746 train_time:572632ms step_avg:367.78ms
step:1568/1750 train_loss:3.2796 train_time:573033ms step_avg:367.80ms
step:1569/1750 train_loss:3.3713 train_time:573454ms step_avg:367.83ms
step:1570/1750 train_loss:3.3195 train_time:573861ms step_avg:367.86ms
step:1571/1750 train_loss:3.2029 train_time:574259ms step_avg:367.88ms
step:1572/1750 train_loss:3.2379 train_time:574648ms step_avg:367.89ms
step:1573/1750 train_loss:3.3577 train_time:575040ms step_avg:367.91ms
step:1574/1750 train_loss:3.2094 train_time:575424ms step_avg:367.92ms
step:1575/1750 train_loss:3.3718 train_time:575810ms step_avg:367.93ms
step:1576/1750 train_loss:3.2722 train_time:576197ms step_avg:367.94ms
step:1577/1750 train_loss:3.3262 train_time:576594ms step_avg:367.96ms
step:1578/1750 train_loss:3.3146 train_time:576987ms step_avg:367.98ms
step:1579/1750 train_loss:3.2882 train_time:577385ms step_avg:368.00ms
step:1580/1750 train_loss:3.2439 train_time:577770ms step_avg:368.01ms
step:1581/1750 train_loss:3.4512 train_time:578167ms step_avg:368.02ms
step:1582/1750 train_loss:3.2617 train_time:578577ms step_avg:368.05ms
step:1583/1750 train_loss:3.4187 train_time:578985ms step_avg:368.08ms
step:1584/1750 train_loss:3.2364 train_time:579374ms step_avg:368.09ms
step:1585/1750 train_loss:3.4081 train_time:579771ms step_avg:368.11ms
step:1586/1750 train_loss:3.1921 train_time:580159ms step_avg:368.12ms
step:1587/1750 train_loss:3.3895 train_time:580544ms step_avg:368.13ms
step:1588/1750 train_loss:3.2708 train_time:580940ms step_avg:368.15ms
step:1589/1750 train_loss:3.4347 train_time:581329ms step_avg:368.16ms
step:1590/1750 train_loss:3.2807 train_time:581717ms step_avg:368.18ms
step:1591/1750 train_loss:3.2877 train_time:582109ms step_avg:368.19ms
step:1592/1750 train_loss:3.3585 train_time:582499ms step_avg:368.20ms
step:1593/1750 train_loss:3.3339 train_time:582903ms step_avg:368.23ms
step:1594/1750 train_loss:3.3017 train_time:583292ms step_avg:368.24ms
step:1595/1750 train_loss:3.4498 train_time:583684ms step_avg:368.25ms
step:1596/1750 train_loss:3.1565 train_time:584088ms step_avg:368.28ms
step:1597/1750 train_loss:3.3279 train_time:584489ms step_avg:368.30ms
step:1598/1750 train_loss:3.3786 train_time:584892ms step_avg:368.32ms
step:1599/1750 train_loss:3.4423 train_time:585298ms step_avg:368.34ms
step:1600/1750 train_loss:3.2677 train_time:585698ms step_avg:368.36ms
step:1601/1750 train_loss:3.5714 train_time:586084ms step_avg:368.37ms
step:1602/1750 train_loss:3.4469 train_time:586484ms step_avg:368.39ms
step:1603/1750 train_loss:3.2173 train_time:586888ms step_avg:368.42ms
step:1604/1750 train_loss:3.2687 train_time:587283ms step_avg:368.43ms
step:1605/1750 train_loss:3.1536 train_time:587694ms step_avg:368.46ms
step:1606/1750 train_loss:3.4686 train_time:588101ms step_avg:368.48ms
step:1607/1750 train_loss:3.3055 train_time:588494ms step_avg:368.50ms
step:1608/1750 train_loss:3.3032 train_time:588891ms step_avg:368.52ms
step:1609/1750 train_loss:3.2400 train_time:589289ms step_avg:368.54ms
step:1610/1750 train_loss:3.7468 train_time:589703ms step_avg:368.56ms
step:1611/1750 train_loss:3.5000 train_time:590107ms step_avg:368.59ms
step:1612/1750 train_loss:3.3864 train_time:590512ms step_avg:368.61ms
step:1613/1750 train_loss:3.2642 train_time:590927ms step_avg:368.64ms
step:1614/1750 train_loss:3.2937 train_time:591320ms step_avg:368.65ms
step:1615/1750 train_loss:3.3097 train_time:591724ms step_avg:368.68ms
step:1616/1750 train_loss:3.2792 train_time:592153ms step_avg:368.71ms
step:1617/1750 train_loss:3.3459 train_time:592567ms step_avg:368.74ms
step:1618/1750 train_loss:3.2819 train_time:592950ms step_avg:368.75ms
step:1619/1750 train_loss:3.1859 train_time:593344ms step_avg:368.77ms
step:1620/1750 train_loss:3.4567 train_time:593734ms step_avg:368.78ms
step:1621/1750 train_loss:3.3779 train_time:594136ms step_avg:368.80ms
step:1622/1750 train_loss:3.1612 train_time:594531ms step_avg:368.82ms
step:1623/1750 train_loss:3.2540 train_time:594924ms step_avg:368.83ms
step:1624/1750 train_loss:3.2108 train_time:595306ms step_avg:368.84ms
step:1625/1750 train_loss:3.3148 train_time:595689ms step_avg:368.85ms
step:1625/1750 val_loss:3.2949 train_time:595794ms step_avg:368.91ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.70901 | frobenius_norm = 68499.20312 | spectral_norm = 12163.41406 | nuclear_norm = 1729761.87500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 191.47116 | spectral_norm = 36.90587 | nuclear_norm = 4385.18652
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 186.26903 | spectral_norm = 40.60361 | nuclear_norm = 4239.18311
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 316.80740 | spectral_norm = 21.95204 | nuclear_norm = 7742.09229
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 216.27185 | spectral_norm = 24.42246 | nuclear_norm = 4982.69531
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 419.21902 | spectral_norm = 35.03362 | nuclear_norm = 11170.02441
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 213.09177 | spectral_norm = 20.56757 | nuclear_norm = 5649.95605
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 194.10217 | spectral_norm = 19.47752 | nuclear_norm = 4470.73145
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 189.48621 | spectral_norm = 19.40662 | nuclear_norm = 4354.16064
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 280.50873 | spectral_norm = 23.59066 | nuclear_norm = 6462.19922
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 275.01459 | spectral_norm = 22.50699 | nuclear_norm = 6465.16992
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 412.25943 | spectral_norm = 31.79161 | nuclear_norm = 11012.42480
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 202.21655 | spectral_norm = 21.17932 | nuclear_norm = 5307.51514
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 188.71329 | spectral_norm = 21.58164 | nuclear_norm = 4301.57520
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 188.97290 | spectral_norm = 19.10268 | nuclear_norm = 4303.80371
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 283.50726 | spectral_norm = 25.88276 | nuclear_norm = 6449.21191
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 289.20056 | spectral_norm = 26.13804 | nuclear_norm = 6699.76123
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 416.14520 | spectral_norm = 35.71999 | nuclear_norm = 11065.01660
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 208.83466 | spectral_norm = 22.92459 | nuclear_norm = 5474.11426
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 187.70384 | spectral_norm = 19.59689 | nuclear_norm = 4217.62012
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 187.26709 | spectral_norm = 17.89586 | nuclear_norm = 4242.60742
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 304.49316 | spectral_norm = 26.77795 | nuclear_norm = 6911.37598
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 305.53363 | spectral_norm = 26.48352 | nuclear_norm = 7124.77930
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 418.82632 | spectral_norm = 40.90780 | nuclear_norm = 11124.87109
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 207.00391 | spectral_norm = 22.44180 | nuclear_norm = 5438.95361
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 187.51620 | spectral_norm = 19.41178 | nuclear_norm = 4188.62305
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 184.64165 | spectral_norm = 17.79644 | nuclear_norm = 4138.59570
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 318.91953 | spectral_norm = 29.39743 | nuclear_norm = 7214.91650
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 314.21106 | spectral_norm = 23.01285 | nuclear_norm = 7396.77539
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 426.93875 | spectral_norm = 39.62619 | nuclear_norm = 11371.23340
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 207.67276 | spectral_norm = 21.10821 | nuclear_norm = 5479.96777
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 190.97551 | spectral_norm = 20.02451 | nuclear_norm = 4330.93457
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 187.64580 | spectral_norm = 18.42186 | nuclear_norm = 4292.74072
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 310.86368 | spectral_norm = 28.50099 | nuclear_norm = 7118.46338
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 308.65060 | spectral_norm = 22.56573 | nuclear_norm = 7329.61035
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 435.20224 | spectral_norm = 35.75484 | nuclear_norm = 11640.73438
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 206.53537 | spectral_norm = 21.10397 | nuclear_norm = 5447.86621
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 185.48738 | spectral_norm = 21.18454 | nuclear_norm = 4179.56934
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 180.91595 | spectral_norm = 19.56702 | nuclear_norm = 4127.50000
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 300.92349 | spectral_norm = 25.58093 | nuclear_norm = 6932.63916
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 293.85394 | spectral_norm = 24.40562 | nuclear_norm = 6782.89941
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 433.54773 | spectral_norm = 34.16004 | nuclear_norm = 11580.12500
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 209.88000 | spectral_norm = 23.75252 | nuclear_norm = 5520.58496
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 193.43011 | spectral_norm = 20.10642 | nuclear_norm = 4385.48291
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 192.16199 | spectral_norm = 20.07779 | nuclear_norm = 4354.04639
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 332.23672 | spectral_norm = 32.86830 | nuclear_norm = 7475.66064
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 318.69684 | spectral_norm = 22.60247 | nuclear_norm = 7584.49902
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 412.40311 | spectral_norm = 37.31163 | nuclear_norm = 10976.29883
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 212.75041 | spectral_norm = 22.35644 | nuclear_norm = 5625.30566
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 185.53050 | spectral_norm = 19.92463 | nuclear_norm = 4120.02783
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 185.52245 | spectral_norm = 18.36079 | nuclear_norm = 4144.25000
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 312.29944 | spectral_norm = 27.13461 | nuclear_norm = 7016.13770
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 310.44302 | spectral_norm = 25.00795 | nuclear_norm = 7179.48145
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 431.25836 | spectral_norm = 39.95229 | nuclear_norm = 11435.25488
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 216.50508 | spectral_norm = 23.41378 | nuclear_norm = 5723.79004
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 196.93178 | spectral_norm = 20.92827 | nuclear_norm = 4410.98926
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 192.63707 | spectral_norm = 19.72235 | nuclear_norm = 4345.50830
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 320.01169 | spectral_norm = 33.20815 | nuclear_norm = 7210.71777
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 309.98828 | spectral_norm = 27.41705 | nuclear_norm = 7257.19434
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 440.53720 | spectral_norm = 40.05838 | nuclear_norm = 11678.91016
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 219.59808 | spectral_norm = 23.95911 | nuclear_norm = 5796.58887
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 187.96439 | spectral_norm = 21.89528 | nuclear_norm = 4043.58081
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 190.48315 | spectral_norm = 19.64247 | nuclear_norm = 4024.95312
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 325.57785 | spectral_norm = 33.65530 | nuclear_norm = 7426.15283
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 325.40573 | spectral_norm = 22.75547 | nuclear_norm = 7649.46240
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 421.26538 | spectral_norm = 33.92377 | nuclear_norm = 11205.93555
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 206.72774 | spectral_norm = 25.06096 | nuclear_norm = 5469.67236
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 194.42490 | spectral_norm = 26.63980 | nuclear_norm = 4287.61133
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 187.46597 | spectral_norm = 24.52847 | nuclear_norm = 4129.23828
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 323.73358 | spectral_norm = 33.11951 | nuclear_norm = 7338.36230
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 349.48129 | spectral_norm = 25.01161 | nuclear_norm = 8165.04492
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 432.75259 | spectral_norm = 35.99297 | nuclear_norm = 11480.35156
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 219.17525 | spectral_norm = 30.06063 | nuclear_norm = 5721.75977
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1321.93994 | spectral_norm = 156.67461 | nuclear_norm = 35005.63281
===========================================
step:1626/1750 train_loss:3.2381 train_time:596078ms step_avg:368.86ms
step:1627/1750 train_loss:3.2384 train_time:596457ms step_avg:368.87ms
step:1628/1750 train_loss:3.3572 train_time:596846ms step_avg:368.88ms
step:1629/1750 train_loss:3.2435 train_time:597237ms step_avg:368.89ms
step:1630/1750 train_loss:3.3192 train_time:597636ms step_avg:368.91ms
step:1631/1750 train_loss:3.1761 train_time:598058ms step_avg:368.94ms
step:1632/1750 train_loss:3.1454 train_time:598445ms step_avg:368.95ms
step:1633/1750 train_loss:3.2996 train_time:598834ms step_avg:368.97ms
step:1634/1750 train_loss:3.3036 train_time:599218ms step_avg:368.98ms
step:1635/1750 train_loss:3.2458 train_time:599620ms step_avg:369.00ms
step:1636/1750 train_loss:3.3291 train_time:600011ms step_avg:369.01ms
step:1637/1750 train_loss:3.3766 train_time:600397ms step_avg:369.02ms
step:1638/1750 train_loss:3.3973 train_time:600790ms step_avg:369.04ms
step:1639/1750 train_loss:3.5671 train_time:601193ms step_avg:369.06ms
step:1640/1750 train_loss:3.3456 train_time:601589ms step_avg:369.07ms
step:1641/1750 train_loss:3.3002 train_time:601984ms step_avg:369.09ms
step:1642/1750 train_loss:3.4042 train_time:602374ms step_avg:369.10ms
step:1643/1750 train_loss:3.2700 train_time:602777ms step_avg:369.12ms
step:1644/1750 train_loss:3.3113 train_time:603167ms step_avg:369.14ms
step:1645/1750 train_loss:3.3135 train_time:603551ms step_avg:369.14ms
step:1646/1750 train_loss:3.0705 train_time:603938ms step_avg:369.16ms
step:1647/1750 train_loss:3.3171 train_time:604326ms step_avg:369.17ms
step:1648/1750 train_loss:3.2117 train_time:604717ms step_avg:369.18ms
step:1649/1750 train_loss:3.2806 train_time:605101ms step_avg:369.19ms
step:1650/1750 train_loss:3.2655 train_time:605489ms step_avg:369.20ms
step:1651/1750 train_loss:3.3438 train_time:605874ms step_avg:369.21ms
step:1652/1750 train_loss:3.2531 train_time:606264ms step_avg:369.22ms
step:1653/1750 train_loss:3.3847 train_time:606664ms step_avg:369.24ms
step:1654/1750 train_loss:3.3811 train_time:607053ms step_avg:369.25ms
step:1655/1750 train_loss:3.1763 train_time:607452ms step_avg:369.27ms
step:1656/1750 train_loss:3.3321 train_time:607863ms step_avg:369.30ms
step:1657/1750 train_loss:3.2445 train_time:608261ms step_avg:369.31ms
step:1658/1750 train_loss:3.2189 train_time:608648ms step_avg:369.32ms
step:1659/1750 train_loss:3.3024 train_time:609036ms step_avg:369.34ms
step:1660/1750 train_loss:3.3412 train_time:609424ms step_avg:369.35ms
step:1661/1750 train_loss:3.2438 train_time:609816ms step_avg:369.36ms
step:1662/1750 train_loss:3.3553 train_time:610200ms step_avg:369.37ms
step:1663/1750 train_loss:3.3409 train_time:610604ms step_avg:369.39ms
step:1664/1750 train_loss:3.4043 train_time:611027ms step_avg:369.42ms
step:1665/1750 train_loss:3.3264 train_time:611423ms step_avg:369.44ms
step:1666/1750 train_loss:3.4964 train_time:611815ms step_avg:369.45ms
step:1667/1750 train_loss:3.2001 train_time:612210ms step_avg:369.47ms
step:1668/1750 train_loss:3.2885 train_time:612605ms step_avg:369.48ms
step:1669/1750 train_loss:3.2080 train_time:612992ms step_avg:369.50ms
step:1670/1750 train_loss:3.2181 train_time:613384ms step_avg:369.51ms
step:1671/1750 train_loss:3.3688 train_time:613779ms step_avg:369.52ms
step:1672/1750 train_loss:3.5721 train_time:614171ms step_avg:369.54ms
step:1673/1750 train_loss:3.2680 train_time:614562ms step_avg:369.55ms
step:1674/1750 train_loss:3.2561 train_time:614952ms step_avg:369.56ms
step:1675/1750 train_loss:3.1223 train_time:615356ms step_avg:369.58ms
step:1676/1750 train_loss:3.3451 train_time:615757ms step_avg:369.60ms
step:1677/1750 train_loss:3.2785 train_time:616149ms step_avg:369.62ms
step:1678/1750 train_loss:3.2910 train_time:616543ms step_avg:369.63ms
step:1679/1750 train_loss:3.2981 train_time:616934ms step_avg:369.64ms
step:1680/1750 train_loss:3.0816 train_time:617352ms step_avg:369.67ms
step:1681/1750 train_loss:3.2960 train_time:617749ms step_avg:369.69ms
step:1682/1750 train_loss:3.2855 train_time:618148ms step_avg:369.71ms
step:1683/1750 train_loss:3.3004 train_time:618540ms step_avg:369.72ms
step:1684/1750 train_loss:3.3379 train_time:618928ms step_avg:369.73ms
step:1685/1750 train_loss:3.2400 train_time:619315ms step_avg:369.74ms
step:1686/1750 train_loss:3.3619 train_time:619712ms step_avg:369.76ms
step:1687/1750 train_loss:3.2409 train_time:620106ms step_avg:369.77ms
step:1688/1750 train_loss:3.3041 train_time:620515ms step_avg:369.79ms
step:1689/1750 train_loss:3.2187 train_time:620916ms step_avg:369.81ms
step:1690/1750 train_loss:3.0706 train_time:621318ms step_avg:369.83ms
step:1691/1750 train_loss:3.3038 train_time:621709ms step_avg:369.84ms
step:1692/1750 train_loss:3.2943 train_time:622098ms step_avg:369.86ms
step:1693/1750 train_loss:3.2102 train_time:622486ms step_avg:369.87ms
step:1694/1750 train_loss:3.6049 train_time:622888ms step_avg:369.89ms
step:1695/1750 train_loss:3.3318 train_time:623290ms step_avg:369.91ms
step:1696/1750 train_loss:3.3328 train_time:623683ms step_avg:369.92ms
step:1697/1750 train_loss:3.2504 train_time:624068ms step_avg:369.93ms
step:1698/1750 train_loss:3.1232 train_time:624457ms step_avg:369.94ms
step:1699/1750 train_loss:3.2288 train_time:624850ms step_avg:369.95ms
step:1700/1750 train_loss:3.2410 train_time:625285ms step_avg:369.99ms
step:1701/1750 train_loss:3.3234 train_time:625738ms step_avg:370.04ms
step:1702/1750 train_loss:3.2393 train_time:626125ms step_avg:370.05ms
step:1703/1750 train_loss:3.4112 train_time:626507ms step_avg:370.06ms
step:1704/1750 train_loss:3.2126 train_time:626893ms step_avg:370.07ms
step:1705/1750 train_loss:3.4331 train_time:627277ms step_avg:370.07ms
step:1706/1750 train_loss:3.2486 train_time:627659ms step_avg:370.08ms
step:1707/1750 train_loss:3.0528 train_time:628053ms step_avg:370.10ms
step:1708/1750 train_loss:3.3887 train_time:628441ms step_avg:370.11ms
step:1709/1750 train_loss:3.2971 train_time:628957ms step_avg:370.19ms
step:1710/1750 train_loss:3.2753 train_time:629369ms step_avg:370.22ms
step:1711/1750 train_loss:3.2845 train_time:629765ms step_avg:370.23ms
step:1712/1750 train_loss:3.3132 train_time:630161ms step_avg:370.25ms
step:1713/1750 train_loss:3.3362 train_time:630555ms step_avg:370.26ms
step:1714/1750 train_loss:3.2236 train_time:630958ms step_avg:370.28ms
step:1715/1750 train_loss:3.2830 train_time:631382ms step_avg:370.31ms
step:1716/1750 train_loss:3.0956 train_time:631768ms step_avg:370.32ms
step:1717/1750 train_loss:3.2458 train_time:632147ms step_avg:370.33ms
step:1718/1750 train_loss:3.2618 train_time:632536ms step_avg:370.34ms
step:1719/1750 train_loss:3.2151 train_time:632934ms step_avg:370.35ms
step:1720/1750 train_loss:3.3748 train_time:633346ms step_avg:370.38ms
step:1721/1750 train_loss:3.1652 train_time:633774ms step_avg:370.41ms
step:1722/1750 train_loss:3.3128 train_time:634168ms step_avg:370.43ms
step:1723/1750 train_loss:3.4039 train_time:634579ms step_avg:370.45ms
step:1724/1750 train_loss:3.2560 train_time:634974ms step_avg:370.46ms
step:1725/1750 train_loss:3.4812 train_time:635381ms step_avg:370.48ms
step:1726/1750 train_loss:3.2560 train_time:635787ms step_avg:370.51ms
step:1727/1750 train_loss:3.3313 train_time:636172ms step_avg:370.51ms
step:1728/1750 train_loss:3.2943 train_time:636564ms step_avg:370.53ms
step:1729/1750 train_loss:3.2709 train_time:636966ms step_avg:370.54ms
step:1730/1750 train_loss:3.6482 train_time:637367ms step_avg:370.56ms
step:1731/1750 train_loss:3.2921 train_time:637759ms step_avg:370.57ms
step:1732/1750 train_loss:3.4303 train_time:638153ms step_avg:370.59ms
step:1733/1750 train_loss:3.2000 train_time:638533ms step_avg:370.59ms
step:1734/1750 train_loss:3.2440 train_time:638923ms step_avg:370.61ms
step:1735/1750 train_loss:3.2716 train_time:639321ms step_avg:370.62ms
step:1736/1750 train_loss:3.2544 train_time:639722ms step_avg:370.64ms
step:1737/1750 train_loss:3.3849 train_time:640125ms step_avg:370.66ms
step:1738/1750 train_loss:3.2156 train_time:640544ms step_avg:370.69ms
step:1739/1750 train_loss:3.2852 train_time:640949ms step_avg:370.71ms
step:1740/1750 train_loss:3.3680 train_time:641348ms step_avg:370.72ms
step:1741/1750 train_loss:3.1629 train_time:641740ms step_avg:370.73ms
step:1742/1750 train_loss:3.0616 train_time:642135ms step_avg:370.75ms
step:1743/1750 train_loss:2.9507 train_time:642545ms step_avg:370.77ms
step:1744/1750 train_loss:3.2861 train_time:642935ms step_avg:370.78ms
step:1745/1750 train_loss:3.3121 train_time:643319ms step_avg:370.79ms
step:1746/1750 train_loss:3.2659 train_time:643706ms step_avg:370.80ms
step:1747/1750 train_loss:3.2970 train_time:644112ms step_avg:370.82ms
step:1748/1750 train_loss:3.4956 train_time:644534ms step_avg:370.85ms
step:1749/1750 train_loss:3.2251 train_time:644932ms step_avg:370.86ms
step:1750/1750 train_loss:3.2707 train_time:645339ms step_avg:370.88ms
step:1750/1750 val_loss:3.2733 train_time:645454ms step_avg:370.95ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.73514 | frobenius_norm = 68505.39844 | spectral_norm = 12170.58887 | nuclear_norm = 1730014.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 191.43774 | spectral_norm = 37.14399 | nuclear_norm = 4382.42041
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 186.32899 | spectral_norm = 40.76116 | nuclear_norm = 4239.22510
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 317.37567 | spectral_norm = 21.97610 | nuclear_norm = 7758.07324
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 216.17546 | spectral_norm = 24.44051 | nuclear_norm = 4979.00781
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 419.84991 | spectral_norm = 35.11868 | nuclear_norm = 11187.14648
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 213.38730 | spectral_norm = 20.61603 | nuclear_norm = 5658.18018
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 194.29108 | spectral_norm = 19.52781 | nuclear_norm = 4474.38330
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 189.67790 | spectral_norm = 19.46193 | nuclear_norm = 4357.79736
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 280.91785 | spectral_norm = 23.61970 | nuclear_norm = 6472.26758
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 275.37762 | spectral_norm = 22.53090 | nuclear_norm = 6474.65723
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 412.81125 | spectral_norm = 31.81426 | nuclear_norm = 11027.75586
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 202.45320 | spectral_norm = 21.22455 | nuclear_norm = 5313.74365
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 188.85017 | spectral_norm = 21.63545 | nuclear_norm = 4303.97168
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 189.15820 | spectral_norm = 19.15711 | nuclear_norm = 4306.96729
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 284.06229 | spectral_norm = 25.94573 | nuclear_norm = 6463.16406
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 289.73135 | spectral_norm = 26.16599 | nuclear_norm = 6713.66602
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 416.67273 | spectral_norm = 35.79709 | nuclear_norm = 11078.73242
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 209.05435 | spectral_norm = 22.96992 | nuclear_norm = 5479.44385
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 187.85750 | spectral_norm = 19.61110 | nuclear_norm = 4219.59277
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 187.41991 | spectral_norm = 17.93715 | nuclear_norm = 4244.57129
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 305.11456 | spectral_norm = 26.84980 | nuclear_norm = 6926.82715
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 306.12149 | spectral_norm = 26.56059 | nuclear_norm = 7139.73340
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 419.30225 | spectral_norm = 40.98888 | nuclear_norm = 11136.98438
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 207.22090 | spectral_norm = 22.48629 | nuclear_norm = 5444.50781
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 187.65591 | spectral_norm = 19.45649 | nuclear_norm = 4188.99316
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 184.79567 | spectral_norm = 17.83141 | nuclear_norm = 4139.94434
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 319.60739 | spectral_norm = 29.49017 | nuclear_norm = 7232.16992
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 314.85193 | spectral_norm = 23.04712 | nuclear_norm = 7412.90820
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 427.42328 | spectral_norm = 39.68393 | nuclear_norm = 11383.86328
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 207.90413 | spectral_norm = 21.15314 | nuclear_norm = 5486.40527
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 191.17751 | spectral_norm = 20.06286 | nuclear_norm = 4334.00342
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 187.86586 | spectral_norm = 18.44498 | nuclear_norm = 4296.84375
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 311.52768 | spectral_norm = 28.55209 | nuclear_norm = 7135.37305
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 309.33133 | spectral_norm = 22.59528 | nuclear_norm = 7347.51904
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 435.76340 | spectral_norm = 35.83523 | nuclear_norm = 11656.09961
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 206.78458 | spectral_norm = 21.15337 | nuclear_norm = 5455.02637
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 185.67575 | spectral_norm = 21.25679 | nuclear_norm = 4181.74609
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 181.11623 | spectral_norm = 19.59767 | nuclear_norm = 4131.13086
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 301.61688 | spectral_norm = 25.61505 | nuclear_norm = 6951.32129
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 294.49606 | spectral_norm = 24.44734 | nuclear_norm = 6798.74902
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 434.15555 | spectral_norm = 34.23556 | nuclear_norm = 11596.41016
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 210.10811 | spectral_norm = 23.80257 | nuclear_norm = 5526.50684
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 193.62956 | spectral_norm = 20.14279 | nuclear_norm = 4388.10986
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 192.38026 | spectral_norm = 20.09444 | nuclear_norm = 4357.61963
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 332.98611 | spectral_norm = 32.94806 | nuclear_norm = 7491.74854
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 319.27078 | spectral_norm = 22.63709 | nuclear_norm = 7598.40137
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 412.83054 | spectral_norm = 37.37616 | nuclear_norm = 10987.01465
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 212.93320 | spectral_norm = 22.39840 | nuclear_norm = 5629.94824
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 185.67215 | spectral_norm = 19.96594 | nuclear_norm = 4120.40039
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 185.67139 | spectral_norm = 18.36965 | nuclear_norm = 4145.21143
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 312.96744 | spectral_norm = 27.21576 | nuclear_norm = 7032.82373
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 311.01868 | spectral_norm = 25.03246 | nuclear_norm = 7192.26465
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 431.79422 | spectral_norm = 40.04596 | nuclear_norm = 11448.05469
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 216.70642 | spectral_norm = 23.44509 | nuclear_norm = 5728.71973
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 197.12181 | spectral_norm = 21.01906 | nuclear_norm = 4412.52979
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 192.83269 | spectral_norm = 19.76943 | nuclear_norm = 4348.26904
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 320.78336 | spectral_norm = 33.26168 | nuclear_norm = 7228.52881
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 310.59073 | spectral_norm = 27.50634 | nuclear_norm = 7270.86914
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 441.08420 | spectral_norm = 40.13184 | nuclear_norm = 11692.10156
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 219.82468 | spectral_norm = 24.00722 | nuclear_norm = 5802.03027
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 188.07994 | spectral_norm = 21.95765 | nuclear_norm = 4040.92725
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 190.62000 | spectral_norm = 19.68554 | nuclear_norm = 4022.04688
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 326.37329 | spectral_norm = 33.81057 | nuclear_norm = 7443.49805
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 325.90054 | spectral_norm = 22.83147 | nuclear_norm = 7660.33545
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 421.53870 | spectral_norm = 33.97453 | nuclear_norm = 11212.27246
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 206.94572 | spectral_norm = 25.09277 | nuclear_norm = 5475.40430
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 194.58328 | spectral_norm = 26.77443 | nuclear_norm = 4287.25879
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 187.55858 | spectral_norm = 24.62817 | nuclear_norm = 4127.33105
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 324.84052 | spectral_norm = 33.21755 | nuclear_norm = 7362.95557
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 350.25650 | spectral_norm = 25.08238 | nuclear_norm = 8182.13135
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 432.94180 | spectral_norm = 36.03662 | nuclear_norm = 11484.40625
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 219.42368 | spectral_norm = 30.08066 | nuclear_norm = 5727.68018
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1319.52356 | spectral_norm = 155.51944 | nuclear_norm = 34958.54688
===========================================

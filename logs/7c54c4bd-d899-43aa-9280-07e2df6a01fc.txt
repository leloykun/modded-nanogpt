====================================================================================================
import os
import sys
with open(sys.argv[0]) as f:
    code = f.read() # read the code of this file ASAP, for logging
import uuid
import glob
import time
from dataclasses import dataclass

import numpy as np
import torch
from torch import nn
import torch.nn.functional as F
import torch.distributed as dist
import torch._inductor.config as config
from torch.nn.parallel import DistributedDataParallel as DDP
# Use of FlexAttention contributed by @KoszarskyB
from torch.nn.attention.flex_attention import flex_attention, create_block_mask, BlockMask, _score_mod_signature
from torch._inductor.lowering import make_pointwise, register_lowering
# Some internal torch.compile details
from torch._inductor.virtualized import ops
from functools import partial
flex_attention = torch.compile(flex_attention, dynamic=False)
create_block_mask = torch.compile(create_block_mask, dynamic=False)

# -----------------------------------------------------------------------------
# Muon optimizer

def zeropower_via_svd(G, steps=None):
    U, S, V = G.svd()
    return U @ V.T

@torch.compile
def zeropower_via_newtonschulz5(G, steps=10, eps=1e-7):
    """
    Newton-Schulz iteration to compute the zeroth power / orthogonalization of G. We opt to use a
    quintic iteration whose coefficients are selected to maximize the slope at zero. For the purpose
    of minimizing steps, it turns out to be empirically effective to keep increasing the slope at
    zero even beyond the point where the iteration no longer converges all the way to one everywhere
    on the interval. This iteration therefore does not produce UV^T but rather something like US'V^T
    where S' is diagonal with S_{ii}' ~ Uniform(0.5, 1.5), which turns out not to hurt model
    performance at all relative to UV^T, where USV^T = G is the SVD.
    """
    assert len(G.shape) == 2
    a, b, c = (3.4445, -4.7750,  2.0315)
    X = G.bfloat16()
    X /= (X.norm() + eps) # ensure top singular value <= 1
    if G.size(0) > G.size(1):
        X = X.T
    for _ in range(steps):
        A = X @ X.T
        B = b * A + c * A @ A # adapted from suggestion by @jxbz, @leloykun, and @YouJiacheng
        X = a * X + B @ X
    if G.size(0) > G.size(1):
        X = X.T
    return X

zeropower_backends = dict(svd=zeropower_via_svd, newtonschulz5=zeropower_via_newtonschulz5)

class Muon(torch.optim.Optimizer):
    """
    Muon - MomentUm Orthogonalized by Newton-schulz

    Muon internally runs standard SGD-momentum, and then performs an orthogonalization post-
    processing step, in which each 2D parameter's update is replaced with the nearest orthogonal
    matrix. To efficiently orthogonalize each update, we use a Newton-Schulz iteration, which has
    the advantage that it can be stably run in bfloat16 on the GPU.

    Some warnings:
    - This optimizer assumes that all parameters passed in are 2D.
    - It should not be used for the embedding layer, the final fully connected layer, or any {0,1}-D
    parameters; those should all be optimized by a standard method (e.g., AdamW).
    - To use it with 4D convolutional filters, it works well to just flatten their last 3 dimensions.
    - We believe it is unlikely to work well for training with small batch size.
    - We believe it may not work well for finetuning pretrained models, but we haven't tested this.
    - We have not yet tried this optimizer for training scenarios larger than NanoGPT (124M).

    Arguments:
        lr: The learning rate used by the internal SGD.
        momentum: The momentum used by the internal SGD.
        nesterov: Whether to use Nesterov-style momentum in the internal SGD. (recommended)
        backend: The chosen backend for the orthogonalization step. (recommended: 'newtonschulz5')
        backend_steps: The number of iteration steps to use in the backend, if it is iterative.
    """
    def __init__(self, params, lr=0.02, momentum=0.95, nesterov=True,
                 backend='newtonschulz5', backend_steps=5):
        defaults = dict(lr=lr, momentum=momentum, nesterov=nesterov, backend=backend, backend_steps=backend_steps)
        super().__init__(params, defaults)

    def step(self):

        for group in self.param_groups:

            lr = group['lr']
            momentum = group['momentum']
            zeropower_backend = zeropower_backends[group['backend']]

            # generate weight updates in distributed fashion
            total_params = sum(p.numel() for p in group['params'])
            updates_flat = torch.zeros(total_params, device='cuda', dtype=torch.bfloat16)
            curr_idx = 0
            for i, p in enumerate(group['params']):
                # luckily this will perfectly distribute a transformer with multiple of 4 layers to 8 GPUs
                if i % int(os.environ['WORLD_SIZE']) == int(os.environ['RANK']):
                    g = p.grad
                    assert g is not None
                    state = self.state[p]
                    if 'momentum_buffer' not in state:
                        state['momentum_buffer'] = torch.zeros_like(g)
                    buf = state['momentum_buffer']
                    buf.mul_(momentum).add_(g)
                    if group['nesterov']:
                        g = g.add(buf, alpha=momentum)
                    g = zeropower_backend(g, steps=group['backend_steps'])
                    g *= max(1, g.size(0)/g.size(1))**0.5
                    updates_flat[curr_idx:curr_idx+p.numel()] = g.flatten()
                curr_idx += p.numel()

            # sync updates across devices. we are not memory-constrained so can do this simple deserialization
            dist.all_reduce(updates_flat, op=dist.ReduceOp.SUM)

            # deserialize and apply updates
            curr_idx = 0
            for p in group['params']:
                g = updates_flat[curr_idx:curr_idx+p.numel()].view_as(p.data).type_as(p.data)
                p.data.add_(g, alpha=-lr)
                curr_idx += p.numel()

# -----------------------------------------------------------------------------
# Attention Tanh softcapping

@torch.library.custom_op("approx::tanh", mutates_args=())
def _tanh_approx(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

@_tanh_approx.register_fake
def _(inp: torch.Tensor) -> torch.Tensor:
    return torch.tanh(inp)

def _tanh_approx_lowering(inp):
    fn = partial(ops.inline_asm_elementwise, asm="tanh.approx.f32 $0, $1;")
    return make_pointwise(fn)(inp)

register_lowering(torch.ops.approx.tanh)(_tanh_approx_lowering)

class _TanhApprox(torch.autograd.Function):
    @staticmethod
    def forward(x):
        return torch.ops.approx.tanh(x)

    @staticmethod
    def setup_context(ctx, inputs, output):
        (x,) = inputs
        result = output
        ctx.save_for_backward(result)

    @staticmethod
    def backward(ctx, grad_output):
        (result,) = ctx.saved_tensors
        return grad_output * (1 - result * result)

    @staticmethod
    def vmap(info, in_dims, x):
        return torch.tanh(x), 0

_tanh_approx = _TanhApprox.apply

def generate_tanh_softcap(soft_cap: int, approx: bool=True) -> _score_mod_signature:
    tanh = _tanh_approx if approx else torch.tanh

    def tanh_softcap(score, b, h, q_idx, kv_idx):
        return soft_cap * tanh(score / soft_cap)

    prefix = "tanh_softcap_approx" if approx else "tanh_softcap"
    tanh_softcap.__name__ = f"{prefix}_{soft_cap}"

    return tanh_softcap

# -----------------------------------------------------------------------------
# PyTorch nn.Module definitions for the GPT-2 model

class Rotary(torch.nn.Module):

    def __init__(self, dim, base=10000):
        super().__init__()
        self.dim = dim
        self.base = base
        self.inv_freq = None
        self.seq_len_cached = None
        self.cos_cached = None
        self.sin_cached = None

    def forward(self, x):
        seq_len = x.shape[1]
        if seq_len != self.seq_len_cached:
            self.inv_freq = 1.0 / (self.base ** (torch.arange(0, self.dim, 2, device=x.device).float() / self.dim))
            self.seq_len_cached = seq_len
            t = torch.arange(seq_len, device=x.device).type_as(self.inv_freq)
            freqs = torch.outer(t, self.inv_freq)
            self.cos_cached = freqs.cos().bfloat16()
            self.sin_cached = freqs.sin().bfloat16()
        return self.cos_cached[None, :, None, :], self.sin_cached[None, :, None, :]

def apply_rotary_emb(x, cos, sin):
    assert x.ndim == 4 # multihead attention
    d = x.shape[3]//2
    x1 = x[..., :d]
    x2 = x[..., d:]
    y1 = x1 * cos + x2 * sin
    y2 = x1 * (-sin) + x2 * cos
    return torch.cat([y1, y2], 3).type_as(x)

class CastedLinear(nn.Linear):
    def forward(self, x):
        return F.linear(x, self.weight.to(x.dtype))

class CausalSelfAttention(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.n_head = config.n_head
        self.n_embd = config.n_embd
        self.head_dim = self.n_embd // self.n_head
        assert self.n_embd % self.n_head == 0
        self.c_q = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_k = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_v = CastedLinear(self.n_embd, self.n_embd, bias=False)
        # output projection
        self.c_proj = CastedLinear(self.n_embd, self.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977
        self.rotary = Rotary(self.head_dim)
        self.lamb = nn.Parameter(torch.tensor(0.5)) # @Grad62304977

    def forward(self, x, v1, block_mask: BlockMask, score_mod: _score_mod_signature):
        B, T, C = x.size() # batch size, sequence length, embedding dimensionality (n_embd)
        q = self.c_q(x).view(B, T, self.n_head, self.head_dim)
        k = self.c_k(x).view(B, T, self.n_head, self.head_dim)
        v = self.c_v(x).view(B, T, self.n_head, self.head_dim)
        if v1 is None:
            v1 = v # This happens if we are in the first block. v needs to be accessed by subsequent blocks
        v = (1 - self.lamb) * v + self.lamb * v1.view_as(v) # @Grad62304977
        cos, sin = self.rotary(q)
        q, k = F.rms_norm(q, (q.size(-1),)), F.rms_norm(k, (k.size(-1),)) # QK norm suggested by @Grad62304977
        q, k = apply_rotary_emb(q, cos, sin), apply_rotary_emb(k, cos, sin)
        y = flex_attention(q.transpose(1, 2), k.transpose(1, 2), v.transpose(1, 2), score_mod=score_mod, block_mask=block_mask)
        y = y.transpose(1, 2).contiguous().view_as(x) # re-assemble all head outputs side by side
        y = self.c_proj(y)
        return y, v1

class MLP(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.c_fc    = CastedLinear(config.n_embd, 4 * config.n_embd, bias=False)
        self.c_proj  = CastedLinear(4 * config.n_embd, config.n_embd, bias=False)
        self.c_proj.weight.data.zero_() # zero init suggested by @Grad62304977

    def forward(self, x):
        x = self.c_fc(x)
        x = F.relu(x).square() # https://arxiv.org/abs/2109.08668v2; ~1-2% better than GELU; suggested by @SKYLINEZ007 and @Grad62304977
        x = self.c_proj(x)
        return x

class Block(nn.Module):

    def __init__(self, config):
        super().__init__()
        self.attn = CausalSelfAttention(config)
        self.mlp = MLP(config)
        self.lambdas = nn.Parameter(torch.tensor([1., 0.]))

    def forward(self, x, v1, x0, block_mask: BlockMask, score_mod: _score_mod_signature):
        x = self.lambdas[0] * x + self.lambdas[1] * x0
        x1, v1 = self.attn(F.rms_norm(x, (x.size(-1),)), v1, block_mask, score_mod)
        x = x + x1
        x = x + self.mlp(F.rms_norm(x, (x.size(-1),)))
        return x, v1

# -----------------------------------------------------------------------------
# The main GPT-2 model

@dataclass
class GPTConfig:
    vocab_size : int = 50304
    n_layer : int = 12
    n_head : int = 6 # head dim 128 suggested by @Grad62304977
    n_embd : int = 768
    attention_soft_cap : int = 50
    lm_head_soft_cap : int = 30

class GPT(nn.Module):

    def __init__(self, config: GPTConfig):
        super().__init__()
        self.attention_soft_cap = config.attention_soft_cap
        self.lm_head_soft_cap = config.lm_head_soft_cap

        # U-net design by @brendanh0gan
        self.num_encoder_layers = config.n_layer // 2 # Half of the layers for encoder
        self.num_decoder_layers = config.n_layer - self.num_encoder_layers # Remaining for decoder
        # Add learnable skip connection weights for decoder layers
        self.skip_weights = nn.Parameter(torch.ones(self.num_decoder_layers))

        self.transformer = nn.ModuleDict(dict(
            wte = nn.Embedding(config.vocab_size, config.n_embd),
            h = nn.ModuleList([Block(config) for _ in range(config.n_layer)]),
        ))
        self.lm_head = CastedLinear(config.n_embd, config.vocab_size, bias=False)
        self.lm_head.weight.data.zero_() # @Grad62304977

    def forward(self, idx, target, attn_blocksize: int):

        docs = (idx == 50256).cumsum(0)
        def document_causal_mask(b, h, q_idx, kv_idx):
            causal_mask = q_idx >= kv_idx
            document_mask = docs[q_idx] == docs[kv_idx]
            window_mask = q_idx - kv_idx < attn_blocksize
            return causal_mask & document_mask & window_mask

        softcap_mod = generate_tanh_softcap(self.attention_soft_cap, approx=True)  # @leloykun

        S = len(idx)
        block_mask = create_block_mask(document_causal_mask, None, None, S, S, device="cuda", _compile=True)

        # forward the GPT model itself
        x = self.transformer.wte(idx[None]) # token embeddings of shape (b, t, n_embd)
        x = F.rms_norm(x, (x.size(-1),)) # @Grad62304977
        x0 = x
        v1 = None

        # Store outputs for U-Net skip connections
        skip_connections = []
        # Encoder pass - process only the first half of the blocks
        for i in range(self.num_encoder_layers):
            x, v1 = self.transformer.h[i](x, v1, x0, block_mask, softcap_mod)
            skip_connections.append(x)
        # Decoder pass - process the remaining blocks with weighted skip connections
        for i in range(self.num_decoder_layers):
            x = x + self.skip_weights[i] * skip_connections.pop()
            x, v1 = self.transformer.h[self.num_encoder_layers + i](x, v1, x0, block_mask, softcap_mod)

        x = F.rms_norm(x, (x.size(-1),))
        logits = self.lm_head(x)
        logits = self.lm_head_soft_cap * torch.tanh(logits / self.lm_head_soft_cap) # @Grad62304977
        logits = logits.float()
        loss = F.cross_entropy(logits.view(-1, logits.size(-1)), target.view(-1))
        return loss

# -----------------------------------------------------------------------------
# Our own simple Distributed Data Loader

def _peek_data_shard(filename):
    # only reads the header, returns header data
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
    if header[0] != 20240520:
        print("ERROR: magic number mismatch in the data .bin file!")
        print("---> HINT: Are you passing in a correct file with --input_bin?")
        print("---> HINT: Dataset encoding changed recently, re-run data prepro or refer again to README")
        print("---> HINT: For example re-run: `python dev/data/tinyshakespeare.py`, then re-try")
        exit(1)
    assert header[1] == 1, "unsupported version"
    ntok = header[2] # number of tokens (claimed)
    return ntok # for now just return the number of tokens

def _load_data_shard(filename):
    with open(filename, "rb") as f:
        # first read the header, which is 256 int32 integers (4 bytes each)
        header = np.frombuffer(f.read(256*4), dtype=np.int32)
        assert header[0] == 20240520, "magic number mismatch in the data .bin file"
        assert header[1] == 1, "unsupported version"
        ntok = header[2] # number of tokens (claimed)
        # the rest of it are tokens, stored as uint16
        tokens = np.frombuffer(f.read(), dtype=np.uint16)
    assert len(tokens) == ntok, "number of tokens read does not match header?"
    return tokens

class DistributedDataLoader:
    def __init__(self, filename_pattern, B, T, process_rank, num_processes):
        self.process_rank = process_rank
        self.num_processes = num_processes
        self.B = B
        self.T = T

        # glob files that match the pattern
        self.files = sorted(glob.glob(filename_pattern))
        assert len(self.files) > 0, f"did not find any files that match the pattern {filename_pattern}"

        # load and validate all data shards, count number of tokens in total
        ntok_total = 0
        for fname in self.files:
            shard_ntok = _peek_data_shard(fname)
            assert shard_ntok >= num_processes * B * T + 1
            ntok_total += int(shard_ntok)
        self.ntok_total = ntok_total

        self.reset()

    def reset(self):
        self.current_shard = -1
        self.advance()

    def advance(self): # advance to next data shard
        self.current_shard = (self.current_shard + 1) % len(self.files)
        self.current_position = self.process_rank * self.B * self.T
        self.tokens = _load_data_shard(self.files[self.current_shard])

    def next_batch(self):
        batch_size = self.B * self.T * self.num_processes
        buf = self.tokens[self.current_position:self.current_position+self.B*self.T+1]
        buf = torch.tensor(buf.astype(np.int32), dtype=torch.long)
        x = buf[:-1] # inputs
        y = buf[1:] # targets
        # advance current position and load next shard if necessary
        self.current_position += batch_size
        if self.current_position + batch_size >= len(self.tokens):
            self.advance()
        return x.cuda(), y.cuda()

# -----------------------------------------------------------------------------
# int main

@dataclass
class Hyperparameters:
    # data hyperparams
    input_bin : str = 'data/fineweb10B/fineweb_train_*.bin' # input .bin to train on
    input_val_bin : str = 'data/fineweb10B/fineweb_val_*.bin' # input .bin to eval validation loss on
    # optimization hyperparams
    batch_size : int = 8 # batch size, in sequences, across all devices
    device_batch_size : int = 1 # batch size, in sequences, per device
    sequence_length : int = 64*1024 # sequence length, in tokens
    num_iterations : int = 1750 # number of iterations to run
    warmup_iters : int = 0
    cooldown_iters : int = 640 # number of iterations of linear warmup/cooldown for triangular or trapezoidal schedule
    block_size_warmup_iters = 1000
    weight_decay : float = 0
    # evaluation and logging hyperparams
    val_loss_every : int = 125 # every how many steps to evaluate val loss? 0 for only at the end
    val_tokens : int = 10485760 # how many tokens of validation data? it's important to keep this fixed for consistent comparisons
    save_every : int = 0 # every how many steps to save the checkpoint? 0 for only at the end
args = Hyperparameters()

# set up DDP (distributed data parallel). torchrun sets this env variable
assert torch.cuda.is_available()
dist.init_process_group(backend='nccl')
ddp_rank = int(os.environ['RANK'])
ddp_local_rank = int(os.environ['LOCAL_RANK'])
ddp_world_size = int(os.environ['WORLD_SIZE'])
device = f'cuda:{ddp_local_rank}'
torch.cuda.set_device(device)
print(f"using device: {device}")
master_process = (ddp_rank == 0) # this process will do logging, checkpointing etc.

# begin logging
logfile = None
if master_process:
    run_id = str(uuid.uuid4())
    logdir = 'logs/%s/' % run_id
    os.makedirs(logdir, exist_ok=True)
    logfile = 'logs/%s.txt' % run_id
    # create the log file
    with open(logfile, "w") as f:
        # begin the log by printing this file (the Python code)
        f.write('='*100 + '\n')
        f.write(code)
        f.write('='*100 + '\n')
def print0(s, logonly=False):
    if master_process:
        with open(logfile, "a") as f:
            if not logonly:
                print(s)
            f.write(s+'\n')
# log information about the hardware/software environment this is running on
# and print the full `nvidia-smi` to file
print0(f"Running pytorch {torch.version.__version__} compiled for CUDA {torch.version.cuda}\nnvidia-smi:")
import subprocess
result = subprocess.run(['nvidia-smi'], stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
print0(f'{result.stdout}', logonly=True)
print0('='*100, logonly=True)

# convenience variables
B, T = args.device_batch_size, args.sequence_length
# calculate the number of steps to take in the val loop.
assert args.val_tokens % (B * T * ddp_world_size) == 0
val_steps = args.val_tokens // (B * T * ddp_world_size)
# calculate the steps of gradient accumulation required to attain the desired global batch size.
assert args.batch_size % (B * ddp_world_size) == 0
train_accumulation_steps = args.batch_size // (B * ddp_world_size)

# load tokens
train_loader = DistributedDataLoader(args.input_bin, B, T, ddp_rank, ddp_world_size)
val_loader = DistributedDataLoader(args.input_val_bin, B, T, ddp_rank, ddp_world_size)
print0(f"Training DataLoader: total number of tokens: {train_loader.ntok_total} across {len(train_loader.files)} files")
print0(f"Validation DataLoader: total number of tokens: {val_loader.ntok_total} across {len(val_loader.files)} files")
print0('='*100, logonly=True)
x, y = train_loader.next_batch()

# there are only 50257 unique GPT-2 tokens; we extend to nearest multiple of 128 for efficiency. suggested to me by @Grad62304977.
# this originates from Karpathy's experiments.
num_vocab = 50304
model = GPT(GPTConfig(vocab_size=num_vocab, n_layer=12, n_head=6, n_embd=768))
model = model.cuda().bfloat16()
for m in model.modules():
    if isinstance(m, CastedLinear):
        m.float()
if hasattr(config, "coordinate_descent_tuning"):
    config.coordinate_descent_tuning = True # suggested by @Chillee
model = torch.compile(model)
# here we wrap model into DDP container
model = DDP(model, device_ids=[ddp_local_rank])
raw_model = model.module # always contains the "raw" unwrapped model

# CUDNN attention is ~4ms faster than Flash, but doesn't get selected by default in PyTorch 2.5.1
from torch.backends.cuda import enable_cudnn_sdp, enable_flash_sdp, enable_math_sdp, enable_mem_efficient_sdp
enable_cudnn_sdp(True)
enable_flash_sdp(False)
enable_mem_efficient_sdp(False)
enable_math_sdp(False)

# init the optimizer(s)
optimizer1 = torch.optim.Adam([raw_model.transformer.wte.weight], lr=0.6,   betas=(0.8, 0.95), fused=True)
optimizer2 = torch.optim.Adam([raw_model.lm_head.weight],         lr=0.008, betas=(0.8, 0.95), fused=True)
param_names = [name for name, _ in raw_model.named_parameters()]
params = list(raw_model.transformer.h.parameters())
qk_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and ("c_q" in n or "c_k" in n)]
matrix_params = [p for n, p in zip(param_names, params) if p.ndim == 2 and "c_q" not in n and "c_k" not in n]
scalar_params = [p for p in params if p.ndim < 2] + [raw_model.skip_weights]
optimizer5 = Muon(qk_params, lr=0.08, momentum=0.95)
optimizer3 = Muon(matrix_params, lr=0.05, momentum=0.95)
optimizer4 = torch.optim.Adam(scalar_params, lr=0.04, betas=(0.8, 0.95), fused=True) # note that this learning rate is neither sensitive nor tuned
optimizers = [optimizer1, optimizer2, optimizer3, optimizer4, optimizer5]
# learning rate decay scheduler (linear warmup and cooldown)
def get_lr(it):
    assert it <= args.num_iterations
    # 1) linear warmup for warmup_iters steps
    if it < args.warmup_iters:
        return (it+1) / args.warmup_iters
    # 2) constant lr for a while
    elif it < args.num_iterations - args.cooldown_iters:
        return 1.0
    # 3) linear cooldown
    else:
        decay_ratio = (args.num_iterations - it) / args.cooldown_iters
        return decay_ratio
schedulers = [torch.optim.lr_scheduler.LambdaLR(opt, get_lr) for opt in optimizers]

# Start training loop
training_time_ms = 0
# start the clock
torch.cuda.synchronize()
t0 = time.time()
# begin training
for step in range(args.num_iterations + 1):
    last_step = (step == args.num_iterations)
    # Set the attention blocksize for the current step, in chunks of 64
    attn_blocksize = torch.tensor(64*((min(step/args.block_size_warmup_iters, 1) * (1792 - 64) + 64)//64), dtype=torch.int, device='cuda')
    # This effectively ignores timing first 10 steps, which are slower for weird reasons.
    # Alternately, and slightly more correctly in terms of benchmarking, we could do 10
    # steps with dummy data first, and then re-initialize the model and reset the loader.
    if step == 10:
        training_time_ms = 0
        t0 = time.time()
    timed_steps = float('nan') if step <= 11 else (step - 10) + 1 # <= 11 to avoid bug in val

    # once in a while evaluate the validation dataset
    if (last_step or (args.val_loss_every > 0 and step % args.val_loss_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # run validation batches
        model.eval()
        val_loader.reset()
        val_loss = 0.0
        for _ in range(val_steps):
            with torch.no_grad():
                x_val, y_val = val_loader.next_batch()
                val_loss += model(x_val, y_val, attn_blocksize=attn_blocksize)
        dist.all_reduce(val_loss, op=dist.ReduceOp.AVG)
        val_loss /= val_steps
        # log val loss to console and to logfile
        print0(f'step:{step}/{args.num_iterations} val_loss:{val_loss:.4f} train_time:{training_time_ms:.0f}ms step_avg:{training_time_ms/(timed_steps-1):.2f}ms')
        if master_process:
            print("============== Weight norms: ==============")
            with open(logfile, "a") as f:
                f.write("============== Weight norms: ==============\n")
                for name, p in model.named_parameters():
                    if p.ndim != 2:
                        continue
                    if "transformer.wte" in name:
                        l1_to_l2_norm = torch.norm(p.data.float(), p=2, dim=1).mean().item()
                    frobenius_norm = torch.linalg.norm(p.data.float(), ord='fro').item()
                    spectral_norm = torch.linalg.matrix_norm(p.data.float(), ord=2).item()
                    nuclear_norm = torch.linalg.matrix_norm(p.data.float(), ord="nuc").item()
                    if "transformer.wte" in name:
                        print(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {l1_to_l2_norm = :.5f} | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                    else:
                        print(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}")
                        f.write(f"{name = } | {frobenius_norm = :.5f} | {spectral_norm = :.5f} | {nuclear_norm = :.5f}\n")
                f.write("===========================================\n")
            print("===========================================")
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    if master_process and (last_step or (args.save_every > 0 and step % args.save_every == 0)):
        # stop the clock
        torch.cuda.synchronize()
        training_time_ms += 1000 * (time.time() - t0)
        # save the state of the training process
        log = dict(step=step, code=code, model=raw_model.state_dict(), optimizers=[opt.state_dict() for opt in optimizers])
        torch.save(log, 'logs/%s/state_step%06d.pt' % (run_id, step))
        # start the clock again
        torch.cuda.synchronize()
        t0 = time.time()

    # bit confusing: we want to make sure to eval on 0th iteration
    # but also after the very last iteration. so we loop for step <= num_iterations
    # instead of just < num_iterations (one extra due to <=), only to do
    # the validation/sampling one last time, and then we break right here as we're done.
    if last_step:
        break

    # --------------- TRAINING SECTION BEGIN -----------------
    model.train()
    for i in range(1, train_accumulation_steps+1):
        # forward pass
        loss = model(x, y, attn_blocksize=attn_blocksize)
        train_loss = loss.detach()
        # advance the dataset for the next batch
        x, y = train_loader.next_batch()
        # backward pass
        if i < train_accumulation_steps:
            with model.no_sync(): # there's no need to sync gradients every accumulation step
                loss.backward()
        else:
            loss.backward() # just sync on the last step
    for name, p in model.named_parameters():
        p.grad /= train_accumulation_steps
    # momentum warmup for Muon
    frac = min(step/300, 1)
    optimizer3.param_groups[0]['momentum'] = (1 - frac) * 0.85 + frac * 0.95
    # step the optimizers and schedulers
    for opt, sched in zip(optimizers, schedulers):
        opt.step()
        sched.step()
    # null the gradients
    model.zero_grad(set_to_none=True)
    # --------------- TRAINING SECTION END -------------------
    # everything that follows now is just diagnostics, prints, logging, etc.

    #dist.all_reduce(train_loss, op=dist.ReduceOp.AVG) # all-reducing the training loss would be more correct in terms of logging, but slower
    approx_time = training_time_ms + 1000 * (time.time() - t0)
    print0(f"step:{step+1}/{args.num_iterations} train_loss:{train_loss.item():.4f} train_time:{approx_time:.0f}ms step_avg:{approx_time/timed_steps:.2f}ms")

if master_process:
    print(f"peak memory consumption: {torch.cuda.max_memory_allocated() // 1024 // 1024} MiB")

# -------------------------------------------------------------------------
# clean up nice
dist.destroy_process_group()
====================================================================================================
Running pytorch 2.6.0.dev20241125+cu124 compiled for CUDA 12.4
nvidia-smi:
Tue Nov 26 00:41:41 2024       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.90.07              Driver Version: 550.90.07      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:07:00.0 Off |                    0 |
| N/A   31C    P0             62W /  400W |       4MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:4E:00.0 Off |                    0 |
| N/A   31C    P0             69W /  400W |   32924MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:87:00.0 Off |                    0 |
| N/A   38C    P0             71W /  400W |      21MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:90:00.0 Off |                    0 |
| N/A   33C    P0             68W /  400W |      25MiB /  81920MiB |      1%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
+-----------------------------------------------------------------------------------------+

====================================================================================================
Training DataLoader: total number of tokens: 1200000000 across 12 files
Validation DataLoader: total number of tokens: 100000000 across 1 files
====================================================================================================
step:0/1750 val_loss:10.8258 train_time:0ms step_avg:nanms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 27.69901 | frobenius_norm = 6214.50879 | spectral_norm = 251.82358 | nuclear_norm = 171915.10938
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 15.99524 | spectral_norm = 1.14922 | nuclear_norm = 376.24786
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 16.00474 | spectral_norm = 1.14327 | nuclear_norm = 376.41199
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 15.99138 | spectral_norm = 1.15317 | nuclear_norm = 376.35565
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 32.01652 | spectral_norm = 1.72613 | nuclear_norm = 858.75757
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 16.02310 | spectral_norm = 1.15249 | nuclear_norm = 377.07739
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 16.00878 | spectral_norm = 1.15217 | nuclear_norm = 376.57233
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 16.00207 | spectral_norm = 1.14838 | nuclear_norm = 376.39841
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 32.01278 | spectral_norm = 1.71991 | nuclear_norm = 858.56079
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 16.00448 | spectral_norm = 1.14568 | nuclear_norm = 376.75864
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 15.98742 | spectral_norm = 1.13792 | nuclear_norm = 375.87637
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 16.01252 | spectral_norm = 1.14614 | nuclear_norm = 376.66705
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 31.99432 | spectral_norm = 1.72672 | nuclear_norm = 858.15588
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 16.00437 | spectral_norm = 1.15950 | nuclear_norm = 376.67358
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 16.00639 | spectral_norm = 1.15558 | nuclear_norm = 376.70560
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 15.98893 | spectral_norm = 1.15333 | nuclear_norm = 375.83813
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 31.98521 | spectral_norm = 1.73335 | nuclear_norm = 857.94073
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 15.98999 | spectral_norm = 1.15298 | nuclear_norm = 376.32462
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 15.99518 | spectral_norm = 1.14559 | nuclear_norm = 376.31616
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 15.99563 | spectral_norm = 1.15779 | nuclear_norm = 376.25879
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 32.00148 | spectral_norm = 1.72835 | nuclear_norm = 858.27509
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 16.00974 | spectral_norm = 1.14626 | nuclear_norm = 376.66547
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 15.99034 | spectral_norm = 1.14179 | nuclear_norm = 376.08569
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 15.99504 | spectral_norm = 1.14270 | nuclear_norm = 376.29413
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 31.99589 | spectral_norm = 1.72919 | nuclear_norm = 858.09937
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 15.99775 | spectral_norm = 1.15260 | nuclear_norm = 376.43332
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 16.00846 | spectral_norm = 1.15138 | nuclear_norm = 376.52478
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 15.98517 | spectral_norm = 1.14556 | nuclear_norm = 375.96530
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 31.98135 | spectral_norm = 1.72435 | nuclear_norm = 857.75806
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 15.98910 | spectral_norm = 1.14781 | nuclear_norm = 376.15976
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 15.99057 | spectral_norm = 1.15283 | nuclear_norm = 376.26953
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 15.99188 | spectral_norm = 1.14946 | nuclear_norm = 376.33466
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 31.99446 | spectral_norm = 1.72639 | nuclear_norm = 858.14893
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 15.99128 | spectral_norm = 1.15235 | nuclear_norm = 376.20386
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 15.99582 | spectral_norm = 1.15575 | nuclear_norm = 376.24103
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 15.99308 | spectral_norm = 1.13941 | nuclear_norm = 376.30142
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 31.99818 | spectral_norm = 1.72270 | nuclear_norm = 858.30359
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 15.99364 | spectral_norm = 1.14007 | nuclear_norm = 376.41483
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 16.01592 | spectral_norm = 1.15240 | nuclear_norm = 376.57004
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 16.01056 | spectral_norm = 1.14587 | nuclear_norm = 376.68173
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 32.01918 | spectral_norm = 1.72939 | nuclear_norm = 858.67981
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 16.00437 | spectral_norm = 1.14381 | nuclear_norm = 376.42688
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 16.01962 | spectral_norm = 1.14612 | nuclear_norm = 376.90164
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 15.99624 | spectral_norm = 1.14814 | nuclear_norm = 376.19843
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 32.00030 | spectral_norm = 1.73168 | nuclear_norm = 858.32782
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 16.00504 | spectral_norm = 1.14969 | nuclear_norm = 376.63171
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 15.99775 | spectral_norm = 1.14722 | nuclear_norm = 376.57050
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 15.98530 | spectral_norm = 1.13653 | nuclear_norm = 376.23361
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 32.00603 | spectral_norm = 1.72803 | nuclear_norm = 858.35974
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 0.00000 | spectral_norm = 0.00000 | nuclear_norm = 0.00000
===========================================
step:1/1750 train_loss:10.8258 train_time:29853ms step_avg:nanms
step:2/1750 train_loss:10.1042 train_time:30988ms step_avg:nanms
step:3/1750 train_loss:8.3676 train_time:31640ms step_avg:nanms
step:4/1750 train_loss:7.6345 train_time:32294ms step_avg:nanms
step:5/1750 train_loss:7.4659 train_time:32947ms step_avg:nanms
step:6/1750 train_loss:7.0443 train_time:33600ms step_avg:nanms
step:7/1750 train_loss:7.0102 train_time:34255ms step_avg:nanms
step:8/1750 train_loss:6.4621 train_time:34910ms step_avg:nanms
step:9/1750 train_loss:6.7578 train_time:35566ms step_avg:nanms
step:10/1750 train_loss:6.5350 train_time:36221ms step_avg:nanms
step:11/1750 train_loss:6.5176 train_time:643ms step_avg:nanms
step:12/1750 train_loss:6.3072 train_time:1297ms step_avg:nanms
step:13/1750 train_loss:6.2930 train_time:1954ms step_avg:651.34ms
step:14/1750 train_loss:6.1889 train_time:2608ms step_avg:652.10ms
step:15/1750 train_loss:6.1843 train_time:3265ms step_avg:653.01ms
step:16/1750 train_loss:5.9948 train_time:3921ms step_avg:653.44ms
step:17/1750 train_loss:5.9620 train_time:4576ms step_avg:653.72ms
step:18/1750 train_loss:6.5199 train_time:5232ms step_avg:654.04ms
step:19/1750 train_loss:5.9556 train_time:5888ms step_avg:654.20ms
step:20/1750 train_loss:6.0609 train_time:6545ms step_avg:654.45ms
step:21/1750 train_loss:5.9826 train_time:7200ms step_avg:654.52ms
step:22/1750 train_loss:5.7517 train_time:7856ms step_avg:654.63ms
step:23/1750 train_loss:5.8071 train_time:8512ms step_avg:654.79ms
step:24/1750 train_loss:5.8324 train_time:9169ms step_avg:654.90ms
step:25/1750 train_loss:5.6313 train_time:9826ms step_avg:655.10ms
step:26/1750 train_loss:5.7559 train_time:10484ms step_avg:655.26ms
step:27/1750 train_loss:5.7098 train_time:11143ms step_avg:655.49ms
step:28/1750 train_loss:5.7132 train_time:11801ms step_avg:655.61ms
step:29/1750 train_loss:5.7408 train_time:12459ms step_avg:655.73ms
step:30/1750 train_loss:5.7327 train_time:13116ms step_avg:655.82ms
step:31/1750 train_loss:6.0932 train_time:13775ms step_avg:655.94ms
step:32/1750 train_loss:5.5510 train_time:14435ms step_avg:656.13ms
step:33/1750 train_loss:5.4022 train_time:15094ms step_avg:656.27ms
step:34/1750 train_loss:5.4314 train_time:15752ms step_avg:656.35ms
step:35/1750 train_loss:5.6595 train_time:16412ms step_avg:656.49ms
step:36/1750 train_loss:5.5726 train_time:17071ms step_avg:656.58ms
step:37/1750 train_loss:5.5686 train_time:17730ms step_avg:656.68ms
step:38/1750 train_loss:5.4071 train_time:18390ms step_avg:656.77ms
step:39/1750 train_loss:5.5232 train_time:19048ms step_avg:656.82ms
step:40/1750 train_loss:5.3098 train_time:19707ms step_avg:656.89ms
step:41/1750 train_loss:5.4477 train_time:20366ms step_avg:656.96ms
step:42/1750 train_loss:5.3183 train_time:21025ms step_avg:657.03ms
step:43/1750 train_loss:5.3464 train_time:21685ms step_avg:657.13ms
step:44/1750 train_loss:5.2365 train_time:22345ms step_avg:657.22ms
step:45/1750 train_loss:5.1164 train_time:23005ms step_avg:657.29ms
step:46/1750 train_loss:5.2155 train_time:23664ms step_avg:657.34ms
step:47/1750 train_loss:5.1281 train_time:24323ms step_avg:657.39ms
step:48/1750 train_loss:5.2749 train_time:24982ms step_avg:657.42ms
step:49/1750 train_loss:5.1177 train_time:25641ms step_avg:657.47ms
step:50/1750 train_loss:5.1648 train_time:26299ms step_avg:657.49ms
step:51/1750 train_loss:5.1284 train_time:26958ms step_avg:657.52ms
step:52/1750 train_loss:5.2647 train_time:27617ms step_avg:657.54ms
step:53/1750 train_loss:5.0927 train_time:28277ms step_avg:657.61ms
step:54/1750 train_loss:5.1385 train_time:28938ms step_avg:657.68ms
step:55/1750 train_loss:5.0395 train_time:29598ms step_avg:657.72ms
step:56/1750 train_loss:5.0695 train_time:30257ms step_avg:657.76ms
step:57/1750 train_loss:5.1067 train_time:30916ms step_avg:657.79ms
step:58/1750 train_loss:5.1252 train_time:31576ms step_avg:657.83ms
step:59/1750 train_loss:5.1097 train_time:32236ms step_avg:657.88ms
step:60/1750 train_loss:4.9878 train_time:32897ms step_avg:657.93ms
step:61/1750 train_loss:5.0869 train_time:33557ms step_avg:657.98ms
step:62/1750 train_loss:5.0876 train_time:34217ms step_avg:658.03ms
step:63/1750 train_loss:5.0201 train_time:34876ms step_avg:658.05ms
step:64/1750 train_loss:4.9915 train_time:35537ms step_avg:658.09ms
step:65/1750 train_loss:4.8311 train_time:36197ms step_avg:658.13ms
step:66/1750 train_loss:4.8778 train_time:36857ms step_avg:658.16ms
step:67/1750 train_loss:4.9989 train_time:37518ms step_avg:658.21ms
step:68/1750 train_loss:4.9786 train_time:38178ms step_avg:658.24ms
step:69/1750 train_loss:4.9922 train_time:38837ms step_avg:658.26ms
step:70/1750 train_loss:4.8460 train_time:39497ms step_avg:658.29ms
step:71/1750 train_loss:4.9235 train_time:40157ms step_avg:658.31ms
step:72/1750 train_loss:4.9251 train_time:40817ms step_avg:658.33ms
step:73/1750 train_loss:4.8882 train_time:41476ms step_avg:658.35ms
step:74/1750 train_loss:4.7625 train_time:42136ms step_avg:658.38ms
step:75/1750 train_loss:4.8021 train_time:42797ms step_avg:658.41ms
step:76/1750 train_loss:4.7239 train_time:43480ms step_avg:658.78ms
step:77/1750 train_loss:4.8908 train_time:44160ms step_avg:659.10ms
step:78/1750 train_loss:4.8265 train_time:44840ms step_avg:659.41ms
step:79/1750 train_loss:4.5255 train_time:45521ms step_avg:659.72ms
step:80/1750 train_loss:4.8098 train_time:46201ms step_avg:660.01ms
step:81/1750 train_loss:4.7560 train_time:46881ms step_avg:660.30ms
step:82/1750 train_loss:4.7866 train_time:47562ms step_avg:660.59ms
step:83/1750 train_loss:4.7900 train_time:48242ms step_avg:660.85ms
step:84/1750 train_loss:4.6743 train_time:48922ms step_avg:661.11ms
step:85/1750 train_loss:4.6634 train_time:49603ms step_avg:661.37ms
step:86/1750 train_loss:4.7782 train_time:50282ms step_avg:661.61ms
step:87/1750 train_loss:4.7617 train_time:50962ms step_avg:661.85ms
step:88/1750 train_loss:4.6176 train_time:51643ms step_avg:662.09ms
step:89/1750 train_loss:4.6436 train_time:52324ms step_avg:662.33ms
step:90/1750 train_loss:4.5260 train_time:53006ms step_avg:662.57ms
step:91/1750 train_loss:4.7283 train_time:53685ms step_avg:662.78ms
step:92/1750 train_loss:4.6765 train_time:54366ms step_avg:663.00ms
step:93/1750 train_loss:4.7424 train_time:55045ms step_avg:663.20ms
step:94/1750 train_loss:4.8795 train_time:55726ms step_avg:663.40ms
step:95/1750 train_loss:4.6135 train_time:56405ms step_avg:663.59ms
step:96/1750 train_loss:4.5090 train_time:57085ms step_avg:663.77ms
step:97/1750 train_loss:4.6661 train_time:57765ms step_avg:663.97ms
step:98/1750 train_loss:4.5123 train_time:58443ms step_avg:664.13ms
step:99/1750 train_loss:4.5105 train_time:59122ms step_avg:664.29ms
step:100/1750 train_loss:4.5420 train_time:59802ms step_avg:664.47ms
step:101/1750 train_loss:4.4128 train_time:60483ms step_avg:664.65ms
step:102/1750 train_loss:4.5877 train_time:61164ms step_avg:664.83ms
step:103/1750 train_loss:4.5328 train_time:61845ms step_avg:665.00ms
step:104/1750 train_loss:4.5735 train_time:62526ms step_avg:665.17ms
step:105/1750 train_loss:4.5718 train_time:63205ms step_avg:665.32ms
step:106/1750 train_loss:4.7289 train_time:63884ms step_avg:665.46ms
step:107/1750 train_loss:4.5133 train_time:64565ms step_avg:665.61ms
step:108/1750 train_loss:4.3679 train_time:65244ms step_avg:665.75ms
step:109/1750 train_loss:4.7518 train_time:65923ms step_avg:665.89ms
step:110/1750 train_loss:4.5248 train_time:66602ms step_avg:666.02ms
step:111/1750 train_loss:4.4376 train_time:67283ms step_avg:666.17ms
step:112/1750 train_loss:4.6769 train_time:67963ms step_avg:666.30ms
step:113/1750 train_loss:4.3334 train_time:68639ms step_avg:666.40ms
step:114/1750 train_loss:4.5433 train_time:69314ms step_avg:666.48ms
step:115/1750 train_loss:4.4757 train_time:69992ms step_avg:666.59ms
step:116/1750 train_loss:4.4907 train_time:70668ms step_avg:666.68ms
step:117/1750 train_loss:4.2897 train_time:71344ms step_avg:666.76ms
step:118/1750 train_loss:4.5243 train_time:72019ms step_avg:666.84ms
step:119/1750 train_loss:4.3346 train_time:72695ms step_avg:666.93ms
step:120/1750 train_loss:4.4384 train_time:73371ms step_avg:667.01ms
step:121/1750 train_loss:4.4132 train_time:74047ms step_avg:667.09ms
step:122/1750 train_loss:4.3034 train_time:74722ms step_avg:667.16ms
step:123/1750 train_loss:4.3892 train_time:75398ms step_avg:667.24ms
step:124/1750 train_loss:4.2576 train_time:76074ms step_avg:667.32ms
step:125/1750 train_loss:4.2870 train_time:76751ms step_avg:667.40ms
step:125/1750 val_loss:4.3818 train_time:76764ms step_avg:667.51ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 118.94965 | frobenius_norm = 27116.07227 | spectral_norm = 6835.34082 | nuclear_norm = 658000.81250
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 37.74472 | spectral_norm = 3.43116 | nuclear_norm = 889.14038
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 36.03609 | spectral_norm = 4.74233 | nuclear_norm = 843.93127
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 84.39333 | spectral_norm = 5.76106 | nuclear_norm = 1966.70630
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 85.49986 | spectral_norm = 8.64134 | nuclear_norm = 2036.56396
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 78.31499 | spectral_norm = 5.32508 | nuclear_norm = 2079.99292
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 41.93962 | spectral_norm = 2.73064 | nuclear_norm = 1114.23438
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 35.66805 | spectral_norm = 3.13741 | nuclear_norm = 837.12531
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 35.24126 | spectral_norm = 3.71563 | nuclear_norm = 825.00574
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 90.88953 | spectral_norm = 7.62173 | nuclear_norm = 2082.87646
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 96.58550 | spectral_norm = 8.67999 | nuclear_norm = 2312.59717
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 84.14359 | spectral_norm = 5.46925 | nuclear_norm = 2238.11084
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 43.99205 | spectral_norm = 2.89843 | nuclear_norm = 1168.17993
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 35.45000 | spectral_norm = 3.15539 | nuclear_norm = 830.27344
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 35.47902 | spectral_norm = 3.57092 | nuclear_norm = 830.38770
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 89.51263 | spectral_norm = 7.79435 | nuclear_norm = 2031.56042
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 94.77592 | spectral_norm = 8.71243 | nuclear_norm = 2252.89185
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 85.74832 | spectral_norm = 5.50926 | nuclear_norm = 2278.47168
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 44.10778 | spectral_norm = 3.10267 | nuclear_norm = 1169.39429
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 34.67785 | spectral_norm = 2.80647 | nuclear_norm = 805.14655
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 34.90429 | spectral_norm = 2.96195 | nuclear_norm = 810.62970
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 92.90290 | spectral_norm = 8.31016 | nuclear_norm = 2081.18701
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 92.19328 | spectral_norm = 8.40204 | nuclear_norm = 2184.25464
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 85.24041 | spectral_norm = 5.44244 | nuclear_norm = 2262.91406
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 43.74771 | spectral_norm = 3.08623 | nuclear_norm = 1157.85034
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 33.55146 | spectral_norm = 3.08617 | nuclear_norm = 779.13678
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 34.28612 | spectral_norm = 3.34284 | nuclear_norm = 797.32147
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 78.46601 | spectral_norm = 7.56399 | nuclear_norm = 1735.19360
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 87.89516 | spectral_norm = 8.02720 | nuclear_norm = 2064.42188
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 84.04241 | spectral_norm = 5.40898 | nuclear_norm = 2225.63672
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 42.88916 | spectral_norm = 3.03569 | nuclear_norm = 1132.40308
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 34.29639 | spectral_norm = 2.94873 | nuclear_norm = 801.58533
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 34.85375 | spectral_norm = 3.08705 | nuclear_norm = 815.23962
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 93.97733 | spectral_norm = 9.13787 | nuclear_norm = 2004.06445
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 83.97298 | spectral_norm = 7.99516 | nuclear_norm = 1980.57886
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 83.21434 | spectral_norm = 5.23560 | nuclear_norm = 2203.57666
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 42.90418 | spectral_norm = 3.06493 | nuclear_norm = 1132.61633
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 32.88322 | spectral_norm = 2.85437 | nuclear_norm = 761.23370
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 33.81315 | spectral_norm = 2.84543 | nuclear_norm = 784.42352
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 91.68279 | spectral_norm = 8.56422 | nuclear_norm = 2003.47852
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 86.79216 | spectral_norm = 8.05242 | nuclear_norm = 2050.15552
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 81.79878 | spectral_norm = 5.36181 | nuclear_norm = 2159.64331
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 42.09667 | spectral_norm = 2.96513 | nuclear_norm = 1106.01855
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 33.38884 | spectral_norm = 2.93915 | nuclear_norm = 773.72009
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 34.23111 | spectral_norm = 2.90876 | nuclear_norm = 795.59930
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 76.52737 | spectral_norm = 7.13826 | nuclear_norm = 1665.60022
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 88.48078 | spectral_norm = 8.38509 | nuclear_norm = 2094.32837
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 82.17929 | spectral_norm = 5.58661 | nuclear_norm = 2169.56592
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 42.02629 | spectral_norm = 2.88769 | nuclear_norm = 1104.62415
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 33.32669 | spectral_norm = 2.84956 | nuclear_norm = 769.80579
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 34.26428 | spectral_norm = 2.88171 | nuclear_norm = 793.09314
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 84.98734 | spectral_norm = 7.99970 | nuclear_norm = 1871.52344
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 89.95359 | spectral_norm = 8.22361 | nuclear_norm = 2142.23657
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 81.00238 | spectral_norm = 5.68972 | nuclear_norm = 2138.05200
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 41.52177 | spectral_norm = 2.82246 | nuclear_norm = 1091.14404
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 32.81577 | spectral_norm = 2.83684 | nuclear_norm = 749.66772
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 33.56048 | spectral_norm = 2.83980 | nuclear_norm = 767.80200
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 97.91413 | spectral_norm = 8.64470 | nuclear_norm = 2206.60107
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 94.03578 | spectral_norm = 8.00377 | nuclear_norm = 2252.94385
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 81.14323 | spectral_norm = 5.87399 | nuclear_norm = 2144.54639
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 41.48213 | spectral_norm = 2.76346 | nuclear_norm = 1090.74988
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 33.68916 | spectral_norm = 2.90108 | nuclear_norm = 774.96637
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 34.27289 | spectral_norm = 2.93198 | nuclear_norm = 788.42474
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 82.96972 | spectral_norm = 7.50377 | nuclear_norm = 1853.45044
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 93.63653 | spectral_norm = 7.64818 | nuclear_norm = 2249.73315
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 81.31338 | spectral_norm = 6.03738 | nuclear_norm = 2150.51587
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 41.21087 | spectral_norm = 2.79984 | nuclear_norm = 1081.70068
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 33.70799 | spectral_norm = 2.93727 | nuclear_norm = 782.04248
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 34.32748 | spectral_norm = 3.04990 | nuclear_norm = 793.82379
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 80.95722 | spectral_norm = 7.48405 | nuclear_norm = 1805.04126
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 90.59231 | spectral_norm = 6.90149 | nuclear_norm = 2176.90210
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 80.66500 | spectral_norm = 6.37615 | nuclear_norm = 2131.94238
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 40.52758 | spectral_norm = 2.80778 | nuclear_norm = 1060.29065
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 383.99841 | spectral_norm = 132.72028 | nuclear_norm = 9161.52832
===========================================
step:126/1750 train_loss:4.2199 train_time:77419ms step_avg:667.41ms
step:127/1750 train_loss:4.4251 train_time:78092ms step_avg:667.45ms
step:128/1750 train_loss:4.4190 train_time:78763ms step_avg:667.48ms
step:129/1750 train_loss:4.4285 train_time:79436ms step_avg:667.53ms
step:130/1750 train_loss:4.3554 train_time:80113ms step_avg:667.61ms
step:131/1750 train_loss:4.5179 train_time:80788ms step_avg:667.67ms
step:132/1750 train_loss:4.2923 train_time:81464ms step_avg:667.74ms
step:133/1750 train_loss:4.2551 train_time:82139ms step_avg:667.79ms
step:134/1750 train_loss:4.4037 train_time:82814ms step_avg:667.86ms
step:135/1750 train_loss:4.2444 train_time:83490ms step_avg:667.92ms
step:136/1750 train_loss:4.2558 train_time:84164ms step_avg:667.97ms
step:137/1750 train_loss:4.2917 train_time:84839ms step_avg:668.03ms
step:138/1750 train_loss:4.3403 train_time:85515ms step_avg:668.08ms
step:139/1750 train_loss:4.4473 train_time:86190ms step_avg:668.14ms
step:140/1750 train_loss:4.3409 train_time:86866ms step_avg:668.20ms
step:141/1750 train_loss:4.2225 train_time:87543ms step_avg:668.26ms
step:142/1750 train_loss:4.3606 train_time:88219ms step_avg:668.33ms
step:143/1750 train_loss:4.4280 train_time:88897ms step_avg:668.40ms
step:144/1750 train_loss:4.4652 train_time:89574ms step_avg:668.46ms
step:145/1750 train_loss:4.2649 train_time:90251ms step_avg:668.52ms
step:146/1750 train_loss:4.2897 train_time:90928ms step_avg:668.59ms
step:147/1750 train_loss:4.3348 train_time:91604ms step_avg:668.65ms
step:148/1750 train_loss:4.1199 train_time:92282ms step_avg:668.71ms
step:149/1750 train_loss:4.2687 train_time:92961ms step_avg:668.78ms
step:150/1750 train_loss:4.2394 train_time:93658ms step_avg:668.98ms
step:151/1750 train_loss:4.2446 train_time:94353ms step_avg:669.17ms
step:152/1750 train_loss:4.0931 train_time:95046ms step_avg:669.34ms
step:153/1750 train_loss:4.3278 train_time:95743ms step_avg:669.53ms
step:154/1750 train_loss:4.1245 train_time:96436ms step_avg:669.70ms
step:155/1750 train_loss:4.1153 train_time:97127ms step_avg:669.84ms
step:156/1750 train_loss:4.2276 train_time:97822ms step_avg:670.01ms
step:157/1750 train_loss:4.3186 train_time:98514ms step_avg:670.16ms
step:158/1750 train_loss:4.2245 train_time:99207ms step_avg:670.31ms
step:159/1750 train_loss:4.1898 train_time:99900ms step_avg:670.47ms
step:160/1750 train_loss:4.1392 train_time:100591ms step_avg:670.60ms
step:161/1750 train_loss:4.1822 train_time:101284ms step_avg:670.75ms
step:162/1750 train_loss:4.2048 train_time:101976ms step_avg:670.89ms
step:163/1750 train_loss:4.1613 train_time:102667ms step_avg:671.03ms
step:164/1750 train_loss:4.1289 train_time:103360ms step_avg:671.17ms
step:165/1750 train_loss:4.2034 train_time:104053ms step_avg:671.31ms
step:166/1750 train_loss:4.3333 train_time:104746ms step_avg:671.45ms
step:167/1750 train_loss:4.2413 train_time:105439ms step_avg:671.59ms
step:168/1750 train_loss:4.1621 train_time:106131ms step_avg:671.72ms
step:169/1750 train_loss:4.2285 train_time:106825ms step_avg:671.85ms
step:170/1750 train_loss:4.2779 train_time:107519ms step_avg:672.00ms
step:171/1750 train_loss:3.7559 train_time:108217ms step_avg:672.15ms
step:172/1750 train_loss:4.1097 train_time:108909ms step_avg:672.28ms
step:173/1750 train_loss:4.1090 train_time:109601ms step_avg:672.40ms
step:174/1750 train_loss:4.3274 train_time:110295ms step_avg:672.53ms
step:175/1750 train_loss:4.1387 train_time:110986ms step_avg:672.64ms
step:176/1750 train_loss:4.2025 train_time:111680ms step_avg:672.77ms
step:177/1750 train_loss:4.3200 train_time:112372ms step_avg:672.89ms
step:178/1750 train_loss:4.2073 train_time:113066ms step_avg:673.01ms
step:179/1750 train_loss:4.1527 train_time:113758ms step_avg:673.12ms
step:180/1750 train_loss:4.2054 train_time:114449ms step_avg:673.23ms
step:181/1750 train_loss:4.0746 train_time:115141ms step_avg:673.34ms
step:182/1750 train_loss:4.1369 train_time:115835ms step_avg:673.46ms
step:183/1750 train_loss:4.1056 train_time:116529ms step_avg:673.58ms
step:184/1750 train_loss:4.2464 train_time:117221ms step_avg:673.69ms
step:185/1750 train_loss:4.1610 train_time:117914ms step_avg:673.79ms
step:186/1750 train_loss:4.2510 train_time:118608ms step_avg:673.91ms
step:187/1750 train_loss:4.1622 train_time:119297ms step_avg:674.00ms
step:188/1750 train_loss:4.1292 train_time:119989ms step_avg:674.09ms
step:189/1750 train_loss:3.9644 train_time:120681ms step_avg:674.19ms
step:190/1750 train_loss:4.0840 train_time:121582ms step_avg:675.46ms
step:191/1750 train_loss:4.0672 train_time:122271ms step_avg:675.53ms
step:192/1750 train_loss:4.0199 train_time:122959ms step_avg:675.60ms
step:193/1750 train_loss:4.2386 train_time:123650ms step_avg:675.68ms
step:194/1750 train_loss:4.1543 train_time:124339ms step_avg:675.75ms
step:195/1750 train_loss:4.3432 train_time:125028ms step_avg:675.82ms
step:196/1750 train_loss:4.1637 train_time:125720ms step_avg:675.91ms
step:197/1750 train_loss:4.0174 train_time:126414ms step_avg:676.01ms
step:198/1750 train_loss:4.1556 train_time:127104ms step_avg:676.08ms
step:199/1750 train_loss:4.0145 train_time:127794ms step_avg:676.16ms
step:200/1750 train_loss:4.1092 train_time:128483ms step_avg:676.22ms
step:201/1750 train_loss:3.9705 train_time:129172ms step_avg:676.30ms
step:202/1750 train_loss:4.2207 train_time:129861ms step_avg:676.36ms
step:203/1750 train_loss:4.0437 train_time:130552ms step_avg:676.43ms
step:204/1750 train_loss:4.1863 train_time:131243ms step_avg:676.51ms
step:205/1750 train_loss:4.2221 train_time:131934ms step_avg:676.58ms
step:206/1750 train_loss:3.9329 train_time:132622ms step_avg:676.65ms
step:207/1750 train_loss:4.0756 train_time:133312ms step_avg:676.71ms
step:208/1750 train_loss:4.0692 train_time:134003ms step_avg:676.78ms
step:209/1750 train_loss:4.2241 train_time:134692ms step_avg:676.85ms
step:210/1750 train_loss:4.1517 train_time:135382ms step_avg:676.91ms
step:211/1750 train_loss:4.0385 train_time:136071ms step_avg:676.97ms
step:212/1750 train_loss:4.0682 train_time:136761ms step_avg:677.03ms
step:213/1750 train_loss:4.0244 train_time:137450ms step_avg:677.10ms
step:214/1750 train_loss:4.0966 train_time:138139ms step_avg:677.15ms
step:215/1750 train_loss:3.9120 train_time:138830ms step_avg:677.22ms
step:216/1750 train_loss:3.9710 train_time:139518ms step_avg:677.27ms
step:217/1750 train_loss:3.9812 train_time:140207ms step_avg:677.33ms
step:218/1750 train_loss:4.0680 train_time:140896ms step_avg:677.38ms
step:219/1750 train_loss:4.0556 train_time:141583ms step_avg:677.43ms
step:220/1750 train_loss:4.0666 train_time:142273ms step_avg:677.49ms
step:221/1750 train_loss:4.0703 train_time:142963ms step_avg:677.55ms
step:222/1750 train_loss:3.9717 train_time:143652ms step_avg:677.60ms
step:223/1750 train_loss:3.9408 train_time:144341ms step_avg:677.66ms
step:224/1750 train_loss:4.2744 train_time:145045ms step_avg:677.78ms
step:225/1750 train_loss:3.8723 train_time:145747ms step_avg:677.89ms
step:226/1750 train_loss:3.9745 train_time:146449ms step_avg:678.01ms
step:227/1750 train_loss:3.9627 train_time:147154ms step_avg:678.13ms
step:228/1750 train_loss:4.1217 train_time:147857ms step_avg:678.24ms
step:229/1750 train_loss:3.8982 train_time:148572ms step_avg:678.41ms
step:230/1750 train_loss:4.0274 train_time:149274ms step_avg:678.52ms
step:231/1750 train_loss:3.8726 train_time:149975ms step_avg:678.62ms
step:232/1750 train_loss:3.9487 train_time:150677ms step_avg:678.73ms
step:233/1750 train_loss:4.0612 train_time:151380ms step_avg:678.83ms
step:234/1750 train_loss:4.0199 train_time:152089ms step_avg:678.97ms
step:235/1750 train_loss:3.8637 train_time:152797ms step_avg:679.10ms
step:236/1750 train_loss:4.0537 train_time:153500ms step_avg:679.21ms
step:237/1750 train_loss:4.0654 train_time:154207ms step_avg:679.33ms
step:238/1750 train_loss:3.9249 train_time:154913ms step_avg:679.44ms
step:239/1750 train_loss:4.0427 train_time:155615ms step_avg:679.54ms
step:240/1750 train_loss:4.0920 train_time:156321ms step_avg:679.66ms
step:241/1750 train_loss:3.9507 train_time:157025ms step_avg:679.76ms
step:242/1750 train_loss:4.1295 train_time:157730ms step_avg:679.87ms
step:243/1750 train_loss:3.9967 train_time:158431ms step_avg:679.96ms
step:244/1750 train_loss:4.0654 train_time:159134ms step_avg:680.06ms
step:245/1750 train_loss:4.1274 train_time:159838ms step_avg:680.16ms
step:246/1750 train_loss:4.0375 train_time:160543ms step_avg:680.27ms
step:247/1750 train_loss:3.9826 train_time:161249ms step_avg:680.38ms
step:248/1750 train_loss:4.0824 train_time:161951ms step_avg:680.47ms
step:249/1750 train_loss:3.9047 train_time:162654ms step_avg:680.56ms
step:250/1750 train_loss:3.9583 train_time:163354ms step_avg:680.64ms
step:250/1750 val_loss:3.9878 train_time:163368ms step_avg:680.70ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 157.73917 | frobenius_norm = 36034.87891 | spectral_norm = 7676.07080 | nuclear_norm = 885790.87500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 58.15069 | spectral_norm = 6.69124 | nuclear_norm = 1362.61890
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 56.58667 | spectral_norm = 8.65829 | nuclear_norm = 1317.00391
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 129.23665 | spectral_norm = 8.36899 | nuclear_norm = 3061.10474
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 119.52194 | spectral_norm = 10.48733 | nuclear_norm = 2814.46704
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 122.45840 | spectral_norm = 8.81769 | nuclear_norm = 3248.82690
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 63.81818 | spectral_norm = 4.57700 | nuclear_norm = 1692.71191
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 57.04055 | spectral_norm = 5.01278 | nuclear_norm = 1336.31299
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 56.58432 | spectral_norm = 6.02236 | nuclear_norm = 1322.99719
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 139.97157 | spectral_norm = 11.27967 | nuclear_norm = 3242.17114
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 140.13989 | spectral_norm = 11.21232 | nuclear_norm = 3315.16943
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 131.72925 | spectral_norm = 8.60760 | nuclear_norm = 3502.08911
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 66.27326 | spectral_norm = 5.06282 | nuclear_norm = 1753.08765
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 56.53826 | spectral_norm = 5.26894 | nuclear_norm = 1323.37231
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 55.82884 | spectral_norm = 6.03000 | nuclear_norm = 1305.04639
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 136.96500 | spectral_norm = 11.19857 | nuclear_norm = 3152.01270
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 141.23779 | spectral_norm = 10.90025 | nuclear_norm = 3319.09473
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 134.77303 | spectral_norm = 8.70640 | nuclear_norm = 3580.51855
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 67.04659 | spectral_norm = 5.46585 | nuclear_norm = 1771.35608
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 56.15677 | spectral_norm = 4.65678 | nuclear_norm = 1293.76953
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 56.13188 | spectral_norm = 4.74152 | nuclear_norm = 1295.80225
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 140.53262 | spectral_norm = 11.52490 | nuclear_norm = 3204.26123
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 142.59862 | spectral_norm = 10.96059 | nuclear_norm = 3373.78906
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 134.76727 | spectral_norm = 9.36590 | nuclear_norm = 3580.45459
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 66.56769 | spectral_norm = 5.22293 | nuclear_norm = 1756.65308
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 54.41919 | spectral_norm = 4.94135 | nuclear_norm = 1256.19629
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 54.70031 | spectral_norm = 5.48556 | nuclear_norm = 1265.20850
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 131.13342 | spectral_norm = 10.93644 | nuclear_norm = 2989.61084
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 137.94714 | spectral_norm = 10.32386 | nuclear_norm = 3230.32056
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 137.10918 | spectral_norm = 8.99286 | nuclear_norm = 3636.49365
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 66.21136 | spectral_norm = 5.15144 | nuclear_norm = 1747.65881
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 57.07350 | spectral_norm = 4.77773 | nuclear_norm = 1333.82690
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 56.90950 | spectral_norm = 4.93386 | nuclear_norm = 1331.77515
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 140.48955 | spectral_norm = 12.75875 | nuclear_norm = 3170.57471
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 131.05548 | spectral_norm = 9.86122 | nuclear_norm = 3087.45068
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 134.75575 | spectral_norm = 8.67136 | nuclear_norm = 3577.57129
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 66.86971 | spectral_norm = 5.36346 | nuclear_norm = 1765.30969
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 54.91803 | spectral_norm = 4.81691 | nuclear_norm = 1273.33716
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 55.29759 | spectral_norm = 4.80412 | nuclear_norm = 1284.20557
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 138.46983 | spectral_norm = 11.59430 | nuclear_norm = 3147.71777
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 137.94972 | spectral_norm = 11.08013 | nuclear_norm = 3258.10156
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 132.51389 | spectral_norm = 9.46646 | nuclear_norm = 3513.88330
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 66.20387 | spectral_norm = 5.31172 | nuclear_norm = 1742.51807
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 55.51578 | spectral_norm = 4.96200 | nuclear_norm = 1294.28345
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 55.70529 | spectral_norm = 4.70641 | nuclear_norm = 1300.53662
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 130.42070 | spectral_norm = 11.00334 | nuclear_norm = 2946.68359
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 138.46577 | spectral_norm = 10.70041 | nuclear_norm = 3256.10156
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 133.97194 | spectral_norm = 9.74094 | nuclear_norm = 3550.77344
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 66.22623 | spectral_norm = 5.08953 | nuclear_norm = 1745.30237
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 55.53218 | spectral_norm = 4.95344 | nuclear_norm = 1286.21582
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 56.21945 | spectral_norm = 4.77939 | nuclear_norm = 1301.92114
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 139.40288 | spectral_norm = 11.76132 | nuclear_norm = 3178.39600
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 142.44910 | spectral_norm = 10.89725 | nuclear_norm = 3366.13721
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 132.35135 | spectral_norm = 9.42433 | nuclear_norm = 3508.38159
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 65.52480 | spectral_norm = 5.02779 | nuclear_norm = 1728.05981
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 54.74911 | spectral_norm = 5.08631 | nuclear_norm = 1245.02490
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 55.33641 | spectral_norm = 4.75862 | nuclear_norm = 1252.34204
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 155.70284 | spectral_norm = 12.53460 | nuclear_norm = 3610.01709
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 151.94328 | spectral_norm = 10.20154 | nuclear_norm = 3623.77490
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 129.42816 | spectral_norm = 9.63631 | nuclear_norm = 3435.76709
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 64.90348 | spectral_norm = 5.17390 | nuclear_norm = 1713.96167
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 55.99579 | spectral_norm = 5.19317 | nuclear_norm = 1289.21118
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 55.82064 | spectral_norm = 4.85202 | nuclear_norm = 1280.31006
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 139.80063 | spectral_norm = 11.20697 | nuclear_norm = 3219.64648
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 147.99985 | spectral_norm = 10.00200 | nuclear_norm = 3524.82910
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 131.10710 | spectral_norm = 9.54219 | nuclear_norm = 3482.90234
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 65.67190 | spectral_norm = 5.28325 | nuclear_norm = 1733.22949
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 56.84507 | spectral_norm = 5.39922 | nuclear_norm = 1317.72266
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 56.07646 | spectral_norm = 5.27309 | nuclear_norm = 1292.55432
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 133.62234 | spectral_norm = 10.72167 | nuclear_norm = 3083.69043
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 145.37190 | spectral_norm = 9.83669 | nuclear_norm = 3457.40576
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 131.39389 | spectral_norm = 9.29137 | nuclear_norm = 3487.52051
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 65.43330 | spectral_norm = 5.41668 | nuclear_norm = 1719.04175
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 547.93164 | spectral_norm = 151.53523 | nuclear_norm = 13683.81055
===========================================
step:251/1750 train_loss:4.0524 train_time:164049ms step_avg:680.70ms
step:252/1750 train_loss:4.1403 train_time:164750ms step_avg:680.79ms
step:253/1750 train_loss:3.9154 train_time:165450ms step_avg:680.86ms
step:254/1750 train_loss:3.8551 train_time:166151ms step_avg:680.95ms
step:255/1750 train_loss:4.0451 train_time:166851ms step_avg:681.02ms
step:256/1750 train_loss:3.9567 train_time:167551ms step_avg:681.10ms
step:257/1750 train_loss:3.9652 train_time:168252ms step_avg:681.18ms
step:258/1750 train_loss:3.9667 train_time:168955ms step_avg:681.27ms
step:259/1750 train_loss:4.0131 train_time:169654ms step_avg:681.34ms
step:260/1750 train_loss:4.0493 train_time:170355ms step_avg:681.42ms
step:261/1750 train_loss:3.9957 train_time:171063ms step_avg:681.53ms
step:262/1750 train_loss:3.9813 train_time:171761ms step_avg:681.59ms
step:263/1750 train_loss:3.8898 train_time:172459ms step_avg:681.66ms
step:264/1750 train_loss:3.9740 train_time:173154ms step_avg:681.71ms
step:265/1750 train_loss:3.8549 train_time:173853ms step_avg:681.77ms
step:266/1750 train_loss:3.9049 train_time:174550ms step_avg:681.84ms
step:267/1750 train_loss:3.9016 train_time:175249ms step_avg:681.90ms
step:268/1750 train_loss:3.9589 train_time:175946ms step_avg:681.96ms
step:269/1750 train_loss:3.8424 train_time:176646ms step_avg:682.03ms
step:270/1750 train_loss:4.0866 train_time:177341ms step_avg:682.08ms
step:271/1750 train_loss:3.9437 train_time:178037ms step_avg:682.14ms
step:272/1750 train_loss:3.8960 train_time:178736ms step_avg:682.20ms
step:273/1750 train_loss:3.9299 train_time:179432ms step_avg:682.25ms
step:274/1750 train_loss:4.0166 train_time:180130ms step_avg:682.31ms
step:275/1750 train_loss:4.0395 train_time:180832ms step_avg:682.39ms
step:276/1750 train_loss:4.1908 train_time:181535ms step_avg:682.46ms
step:277/1750 train_loss:4.0168 train_time:182232ms step_avg:682.52ms
step:278/1750 train_loss:4.0592 train_time:182930ms step_avg:682.57ms
step:279/1750 train_loss:3.9869 train_time:183630ms step_avg:682.64ms
step:280/1750 train_loss:4.1803 train_time:184330ms step_avg:682.70ms
step:281/1750 train_loss:3.9594 train_time:185030ms step_avg:682.77ms
step:282/1750 train_loss:3.9139 train_time:185729ms step_avg:682.83ms
step:283/1750 train_loss:3.8973 train_time:186425ms step_avg:682.88ms
step:284/1750 train_loss:4.0222 train_time:187125ms step_avg:682.94ms
step:285/1750 train_loss:4.0426 train_time:187826ms step_avg:683.00ms
step:286/1750 train_loss:4.0757 train_time:188523ms step_avg:683.05ms
step:287/1750 train_loss:3.8938 train_time:189222ms step_avg:683.11ms
step:288/1750 train_loss:4.0018 train_time:189921ms step_avg:683.17ms
step:289/1750 train_loss:3.8528 train_time:190624ms step_avg:683.24ms
step:290/1750 train_loss:3.8320 train_time:191324ms step_avg:683.30ms
step:291/1750 train_loss:3.9054 train_time:192024ms step_avg:683.36ms
step:292/1750 train_loss:3.8454 train_time:192720ms step_avg:683.40ms
step:293/1750 train_loss:3.8875 train_time:193420ms step_avg:683.46ms
step:294/1750 train_loss:3.9247 train_time:194121ms step_avg:683.53ms
step:295/1750 train_loss:3.8290 train_time:194821ms step_avg:683.58ms
step:296/1750 train_loss:3.8605 train_time:195522ms step_avg:683.64ms
step:297/1750 train_loss:3.8472 train_time:196222ms step_avg:683.70ms
step:298/1750 train_loss:3.9616 train_time:196934ms step_avg:683.80ms
step:299/1750 train_loss:3.8093 train_time:197655ms step_avg:683.93ms
step:300/1750 train_loss:3.9356 train_time:198371ms step_avg:684.04ms
step:301/1750 train_loss:3.9486 train_time:199081ms step_avg:684.13ms
step:302/1750 train_loss:3.9201 train_time:199791ms step_avg:684.22ms
step:303/1750 train_loss:3.9669 train_time:200503ms step_avg:684.31ms
step:304/1750 train_loss:3.9455 train_time:201214ms step_avg:684.40ms
step:305/1750 train_loss:4.4390 train_time:201927ms step_avg:684.50ms
step:306/1750 train_loss:3.9187 train_time:202640ms step_avg:684.59ms
step:307/1750 train_loss:3.8206 train_time:203355ms step_avg:684.70ms
step:308/1750 train_loss:3.9595 train_time:204069ms step_avg:684.79ms
step:309/1750 train_loss:3.8469 train_time:204779ms step_avg:684.88ms
step:310/1750 train_loss:4.0639 train_time:205490ms step_avg:684.97ms
step:311/1750 train_loss:3.8958 train_time:206204ms step_avg:685.06ms
step:312/1750 train_loss:3.8452 train_time:206914ms step_avg:685.14ms
step:313/1750 train_loss:3.9224 train_time:207630ms step_avg:685.25ms
step:314/1750 train_loss:4.0474 train_time:208341ms step_avg:685.33ms
step:315/1750 train_loss:3.9276 train_time:209052ms step_avg:685.42ms
step:316/1750 train_loss:3.7676 train_time:209763ms step_avg:685.50ms
step:317/1750 train_loss:3.8583 train_time:210478ms step_avg:685.59ms
step:318/1750 train_loss:3.9109 train_time:211196ms step_avg:685.70ms
step:319/1750 train_loss:3.8785 train_time:211908ms step_avg:685.79ms
step:320/1750 train_loss:4.0072 train_time:212624ms step_avg:685.88ms
step:321/1750 train_loss:3.9413 train_time:213333ms step_avg:685.96ms
step:322/1750 train_loss:3.9130 train_time:214043ms step_avg:686.03ms
step:323/1750 train_loss:3.9886 train_time:214754ms step_avg:686.11ms
step:324/1750 train_loss:3.9259 train_time:215466ms step_avg:686.20ms
step:325/1750 train_loss:3.9988 train_time:216185ms step_avg:686.30ms
step:326/1750 train_loss:3.8723 train_time:216897ms step_avg:686.38ms
step:327/1750 train_loss:4.3680 train_time:217616ms step_avg:686.48ms
step:328/1750 train_loss:4.0549 train_time:218339ms step_avg:686.60ms
step:329/1750 train_loss:3.7885 train_time:219063ms step_avg:686.72ms
step:330/1750 train_loss:3.7230 train_time:219773ms step_avg:686.79ms
step:331/1750 train_loss:3.9573 train_time:220484ms step_avg:686.87ms
step:332/1750 train_loss:3.8884 train_time:221195ms step_avg:686.94ms
step:333/1750 train_loss:3.8580 train_time:221903ms step_avg:687.01ms
step:334/1750 train_loss:3.8269 train_time:222614ms step_avg:687.08ms
step:335/1750 train_loss:3.9922 train_time:223324ms step_avg:687.15ms
step:336/1750 train_loss:3.9485 train_time:224031ms step_avg:687.21ms
step:337/1750 train_loss:4.3800 train_time:224751ms step_avg:687.31ms
step:338/1750 train_loss:3.9250 train_time:225464ms step_avg:687.39ms
step:339/1750 train_loss:3.8352 train_time:226173ms step_avg:687.46ms
step:340/1750 train_loss:3.9212 train_time:226881ms step_avg:687.52ms
step:341/1750 train_loss:3.8463 train_time:227588ms step_avg:687.58ms
step:342/1750 train_loss:3.7933 train_time:228292ms step_avg:687.63ms
step:343/1750 train_loss:3.8158 train_time:229005ms step_avg:687.70ms
step:344/1750 train_loss:3.9906 train_time:229711ms step_avg:687.76ms
step:345/1750 train_loss:3.7968 train_time:230420ms step_avg:687.82ms
step:346/1750 train_loss:3.7426 train_time:231133ms step_avg:687.90ms
step:347/1750 train_loss:3.7806 train_time:231848ms step_avg:687.98ms
step:348/1750 train_loss:3.8459 train_time:232555ms step_avg:688.03ms
step:349/1750 train_loss:3.8072 train_time:233262ms step_avg:688.09ms
step:350/1750 train_loss:3.5555 train_time:233975ms step_avg:688.16ms
step:351/1750 train_loss:3.8176 train_time:234683ms step_avg:688.22ms
step:352/1750 train_loss:4.1700 train_time:235389ms step_avg:688.27ms
step:353/1750 train_loss:3.6307 train_time:236098ms step_avg:688.33ms
step:354/1750 train_loss:3.9173 train_time:236815ms step_avg:688.42ms
step:355/1750 train_loss:3.7663 train_time:237529ms step_avg:688.49ms
step:356/1750 train_loss:3.8710 train_time:238235ms step_avg:688.54ms
step:357/1750 train_loss:3.7455 train_time:238948ms step_avg:688.61ms
step:358/1750 train_loss:3.8422 train_time:239658ms step_avg:688.67ms
step:359/1750 train_loss:3.7734 train_time:240371ms step_avg:688.74ms
step:360/1750 train_loss:3.4057 train_time:241083ms step_avg:688.81ms
step:361/1750 train_loss:3.9994 train_time:241792ms step_avg:688.87ms
step:362/1750 train_loss:3.8859 train_time:242503ms step_avg:688.93ms
step:363/1750 train_loss:3.8199 train_time:243208ms step_avg:688.97ms
step:364/1750 train_loss:3.7199 train_time:243925ms step_avg:689.05ms
step:365/1750 train_loss:3.8972 train_time:244635ms step_avg:689.11ms
step:366/1750 train_loss:3.8495 train_time:245345ms step_avg:689.17ms
step:367/1750 train_loss:3.8491 train_time:246057ms step_avg:689.23ms
step:368/1750 train_loss:3.8385 train_time:246769ms step_avg:689.30ms
step:369/1750 train_loss:3.7335 train_time:247476ms step_avg:689.35ms
step:370/1750 train_loss:3.8785 train_time:248184ms step_avg:689.40ms
step:371/1750 train_loss:3.7258 train_time:248889ms step_avg:689.44ms
step:372/1750 train_loss:3.6728 train_time:249612ms step_avg:689.54ms
step:373/1750 train_loss:3.8961 train_time:250328ms step_avg:689.61ms
step:374/1750 train_loss:3.8111 train_time:251046ms step_avg:689.69ms
step:375/1750 train_loss:3.7885 train_time:251767ms step_avg:689.77ms
step:375/1750 val_loss:3.8075 train_time:251780ms step_avg:689.81ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 185.50290 | frobenius_norm = 42465.26172 | spectral_norm = 8442.37598 | nuclear_norm = 1050001.37500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 83.31421 | spectral_norm = 11.14049 | nuclear_norm = 1949.04590
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 81.14977 | spectral_norm = 12.91075 | nuclear_norm = 1886.97034
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 167.42981 | spectral_norm = 10.69796 | nuclear_norm = 3993.38647
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 147.44815 | spectral_norm = 12.70242 | nuclear_norm = 3457.68091
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 175.29649 | spectral_norm = 12.78263 | nuclear_norm = 4654.37891
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 90.61874 | spectral_norm = 6.81450 | nuclear_norm = 2405.17236
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 82.39060 | spectral_norm = 7.19211 | nuclear_norm = 1928.49585
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 82.04495 | spectral_norm = 8.21441 | nuclear_norm = 1919.35034
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 174.70390 | spectral_norm = 14.53140 | nuclear_norm = 4039.80249
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 173.02846 | spectral_norm = 12.90567 | nuclear_norm = 4075.97729
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 183.64523 | spectral_norm = 12.08547 | nuclear_norm = 4885.56152
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 90.86721 | spectral_norm = 7.59100 | nuclear_norm = 2397.07397
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 81.49741 | spectral_norm = 7.75850 | nuclear_norm = 1904.59998
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 80.54225 | spectral_norm = 8.67383 | nuclear_norm = 1881.15198
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 170.86107 | spectral_norm = 14.15599 | nuclear_norm = 3921.98828
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 175.72537 | spectral_norm = 13.14205 | nuclear_norm = 4104.89209
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 187.83563 | spectral_norm = 12.62116 | nuclear_norm = 4992.41113
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 92.95451 | spectral_norm = 8.24125 | nuclear_norm = 2450.89600
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 80.84903 | spectral_norm = 6.93457 | nuclear_norm = 1856.88281
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 80.71626 | spectral_norm = 6.86500 | nuclear_norm = 1855.44141
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 176.78093 | spectral_norm = 15.12273 | nuclear_norm = 4021.97705
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 181.33673 | spectral_norm = 13.91044 | nuclear_norm = 4272.40137
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 188.45140 | spectral_norm = 13.90580 | nuclear_norm = 5010.41797
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 92.07330 | spectral_norm = 7.67542 | nuclear_norm = 2424.71558
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 79.21822 | spectral_norm = 7.24703 | nuclear_norm = 1823.82666
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 79.20790 | spectral_norm = 7.75596 | nuclear_norm = 1827.97217
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 170.05461 | spectral_norm = 14.48070 | nuclear_norm = 3875.60767
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 175.17281 | spectral_norm = 13.44467 | nuclear_norm = 4082.37598
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 193.47530 | spectral_norm = 13.06080 | nuclear_norm = 5139.90869
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 92.27843 | spectral_norm = 7.56918 | nuclear_norm = 2433.07227
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 83.19559 | spectral_norm = 7.03839 | nuclear_norm = 1943.11621
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 82.36282 | spectral_norm = 7.15400 | nuclear_norm = 1926.48755
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 177.58301 | spectral_norm = 15.11337 | nuclear_norm = 4033.74243
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 166.66315 | spectral_norm = 12.41476 | nuclear_norm = 3924.91992
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 192.81660 | spectral_norm = 12.71378 | nuclear_norm = 5127.46289
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 94.22350 | spectral_norm = 7.64922 | nuclear_norm = 2485.17651
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 80.10285 | spectral_norm = 7.13474 | nuclear_norm = 1854.08179
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 80.15639 | spectral_norm = 7.17277 | nuclear_norm = 1858.09045
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 178.94322 | spectral_norm = 15.64095 | nuclear_norm = 4078.77075
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 176.84531 | spectral_norm = 14.34419 | nuclear_norm = 4160.22754
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 186.63857 | spectral_norm = 13.80480 | nuclear_norm = 4961.96436
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 92.48131 | spectral_norm = 7.70241 | nuclear_norm = 2433.84912
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 80.87346 | spectral_norm = 7.46700 | nuclear_norm = 1884.28540
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 80.51212 | spectral_norm = 6.91431 | nuclear_norm = 1880.77063
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 169.44356 | spectral_norm = 14.19846 | nuclear_norm = 3837.59424
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 174.23161 | spectral_norm = 14.55769 | nuclear_norm = 4049.01709
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 189.31310 | spectral_norm = 14.18276 | nuclear_norm = 5029.94434
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 93.27576 | spectral_norm = 7.38423 | nuclear_norm = 2459.82471
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 81.29791 | spectral_norm = 7.48412 | nuclear_norm = 1879.87280
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 81.81165 | spectral_norm = 7.12511 | nuclear_norm = 1891.51147
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 182.62794 | spectral_norm = 16.04801 | nuclear_norm = 4154.87207
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 181.73897 | spectral_norm = 14.31740 | nuclear_norm = 4258.81934
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 187.27774 | spectral_norm = 13.55909 | nuclear_norm = 4977.21582
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 92.39098 | spectral_norm = 7.40714 | nuclear_norm = 2440.53955
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 80.05105 | spectral_norm = 7.86105 | nuclear_norm = 1814.15649
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 80.65273 | spectral_norm = 7.22715 | nuclear_norm = 1810.04907
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 198.66125 | spectral_norm = 15.41356 | nuclear_norm = 4606.94141
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 194.71765 | spectral_norm = 13.11373 | nuclear_norm = 4632.26221
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 181.76418 | spectral_norm = 13.54056 | nuclear_norm = 4836.85498
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 91.21169 | spectral_norm = 7.90806 | nuclear_norm = 2413.46729
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 82.04401 | spectral_norm = 7.89590 | nuclear_norm = 1883.81885
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 80.92174 | spectral_norm = 7.29421 | nuclear_norm = 1848.21521
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 180.72122 | spectral_norm = 15.00145 | nuclear_norm = 4162.56055
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 186.46146 | spectral_norm = 12.86256 | nuclear_norm = 4407.60938
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 185.59993 | spectral_norm = 13.21663 | nuclear_norm = 4943.29346
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 90.77661 | spectral_norm = 8.19773 | nuclear_norm = 2399.78369
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 84.05615 | spectral_norm = 8.41712 | nuclear_norm = 1947.38672
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 81.65430 | spectral_norm = 8.10131 | nuclear_norm = 1880.10205
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 172.18214 | spectral_norm = 14.28815 | nuclear_norm = 3977.05347
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 185.26445 | spectral_norm = 13.12885 | nuclear_norm = 4372.75732
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 188.97818 | spectral_norm = 13.62327 | nuclear_norm = 5028.48926
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 93.12862 | spectral_norm = 8.56332 | nuclear_norm = 2451.97681
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 689.12939 | spectral_norm = 162.20215 | nuclear_norm = 17531.95703
===========================================
step:376/1750 train_loss:3.8564 train_time:252479ms step_avg:689.83ms
step:377/1750 train_loss:3.7675 train_time:253206ms step_avg:689.93ms
step:378/1750 train_loss:3.8294 train_time:253933ms step_avg:690.04ms
step:379/1750 train_loss:3.8593 train_time:254649ms step_avg:690.11ms
step:380/1750 train_loss:3.9306 train_time:255581ms step_avg:690.76ms
step:381/1750 train_loss:3.6701 train_time:256529ms step_avg:691.45ms
step:382/1750 train_loss:3.7525 train_time:257262ms step_avg:691.57ms
step:383/1750 train_loss:3.7681 train_time:257984ms step_avg:691.65ms
step:384/1750 train_loss:3.8702 train_time:258710ms step_avg:691.74ms
step:385/1750 train_loss:3.6571 train_time:259428ms step_avg:691.81ms
step:386/1750 train_loss:3.8451 train_time:260146ms step_avg:691.88ms
step:387/1750 train_loss:3.7780 train_time:260866ms step_avg:691.95ms
step:388/1750 train_loss:3.9433 train_time:261583ms step_avg:692.02ms
step:389/1750 train_loss:3.7847 train_time:262295ms step_avg:692.07ms
step:390/1750 train_loss:3.8431 train_time:263023ms step_avg:692.17ms
step:391/1750 train_loss:3.6854 train_time:263746ms step_avg:692.25ms
step:392/1750 train_loss:3.7570 train_time:264463ms step_avg:692.31ms
step:393/1750 train_loss:3.8024 train_time:265179ms step_avg:692.37ms
step:394/1750 train_loss:3.7920 train_time:265897ms step_avg:692.44ms
step:395/1750 train_loss:3.7979 train_time:266615ms step_avg:692.51ms
step:396/1750 train_loss:3.6958 train_time:267342ms step_avg:692.60ms
step:397/1750 train_loss:3.5710 train_time:268066ms step_avg:692.68ms
step:398/1750 train_loss:3.8154 train_time:268783ms step_avg:692.74ms
step:399/1750 train_loss:3.7765 train_time:269504ms step_avg:692.81ms
step:400/1750 train_loss:3.7001 train_time:270224ms step_avg:692.88ms
step:401/1750 train_loss:3.7964 train_time:270945ms step_avg:692.95ms
step:402/1750 train_loss:3.6765 train_time:271662ms step_avg:693.02ms
step:403/1750 train_loss:3.9682 train_time:272389ms step_avg:693.10ms
step:404/1750 train_loss:3.8494 train_time:273107ms step_avg:693.16ms
step:405/1750 train_loss:3.8275 train_time:273830ms step_avg:693.24ms
step:406/1750 train_loss:3.8453 train_time:274545ms step_avg:693.29ms
step:407/1750 train_loss:3.8213 train_time:275267ms step_avg:693.37ms
step:408/1750 train_loss:3.7307 train_time:275992ms step_avg:693.45ms
step:409/1750 train_loss:3.7918 train_time:276701ms step_avg:693.49ms
step:410/1750 train_loss:3.7373 train_time:277422ms step_avg:693.55ms
step:411/1750 train_loss:3.7410 train_time:278136ms step_avg:693.61ms
step:412/1750 train_loss:3.7556 train_time:278848ms step_avg:693.65ms
step:413/1750 train_loss:3.7523 train_time:279564ms step_avg:693.71ms
step:414/1750 train_loss:3.8747 train_time:280284ms step_avg:693.77ms
step:415/1750 train_loss:3.7002 train_time:280997ms step_avg:693.82ms
step:416/1750 train_loss:3.7820 train_time:281718ms step_avg:693.89ms
step:417/1750 train_loss:3.8585 train_time:282435ms step_avg:693.94ms
step:418/1750 train_loss:3.6627 train_time:283152ms step_avg:694.00ms
step:419/1750 train_loss:3.9053 train_time:283866ms step_avg:694.05ms
step:420/1750 train_loss:3.9775 train_time:284583ms step_avg:694.10ms
step:421/1750 train_loss:3.7464 train_time:285293ms step_avg:694.14ms
step:422/1750 train_loss:3.8863 train_time:286008ms step_avg:694.19ms
step:423/1750 train_loss:3.5652 train_time:286726ms step_avg:694.25ms
step:424/1750 train_loss:3.7711 train_time:287440ms step_avg:694.30ms
step:425/1750 train_loss:3.6329 train_time:288159ms step_avg:694.36ms
step:426/1750 train_loss:3.8415 train_time:288876ms step_avg:694.41ms
step:427/1750 train_loss:3.8203 train_time:289595ms step_avg:694.47ms
step:428/1750 train_loss:3.7565 train_time:290313ms step_avg:694.53ms
step:429/1750 train_loss:3.8678 train_time:291041ms step_avg:694.61ms
step:430/1750 train_loss:3.6847 train_time:291763ms step_avg:694.67ms
step:431/1750 train_loss:3.6089 train_time:292491ms step_avg:694.75ms
step:432/1750 train_loss:3.8235 train_time:293208ms step_avg:694.81ms
step:433/1750 train_loss:3.8534 train_time:293930ms step_avg:694.87ms
step:434/1750 train_loss:3.8476 train_time:294651ms step_avg:694.93ms
step:435/1750 train_loss:3.7368 train_time:295368ms step_avg:694.98ms
step:436/1750 train_loss:3.8165 train_time:296080ms step_avg:695.02ms
step:437/1750 train_loss:3.8150 train_time:296792ms step_avg:695.06ms
step:438/1750 train_loss:3.7859 train_time:297507ms step_avg:695.11ms
step:439/1750 train_loss:3.8573 train_time:298228ms step_avg:695.17ms
step:440/1750 train_loss:3.6879 train_time:298946ms step_avg:695.22ms
step:441/1750 train_loss:3.7896 train_time:299673ms step_avg:695.30ms
step:442/1750 train_loss:3.7082 train_time:300397ms step_avg:695.36ms
step:443/1750 train_loss:3.6030 train_time:301112ms step_avg:695.41ms
step:444/1750 train_loss:3.7491 train_time:301826ms step_avg:695.45ms
step:445/1750 train_loss:4.0145 train_time:302545ms step_avg:695.50ms
step:446/1750 train_loss:3.6239 train_time:303269ms step_avg:695.57ms
step:447/1750 train_loss:3.8223 train_time:303996ms step_avg:695.64ms
step:448/1750 train_loss:3.8686 train_time:304736ms step_avg:695.75ms
step:449/1750 train_loss:3.6971 train_time:305473ms step_avg:695.84ms
step:450/1750 train_loss:3.6668 train_time:306198ms step_avg:695.90ms
step:451/1750 train_loss:3.6954 train_time:306931ms step_avg:695.99ms
step:452/1750 train_loss:4.0334 train_time:307669ms step_avg:696.08ms
step:453/1750 train_loss:3.9325 train_time:308402ms step_avg:696.17ms
step:454/1750 train_loss:3.7918 train_time:309140ms step_avg:696.26ms
step:455/1750 train_loss:3.6920 train_time:309869ms step_avg:696.34ms
step:456/1750 train_loss:3.8088 train_time:310595ms step_avg:696.40ms
step:457/1750 train_loss:3.7349 train_time:311322ms step_avg:696.47ms
step:458/1750 train_loss:3.7557 train_time:312045ms step_avg:696.53ms
step:459/1750 train_loss:3.8479 train_time:312772ms step_avg:696.60ms
step:460/1750 train_loss:3.6616 train_time:313508ms step_avg:696.69ms
step:461/1750 train_loss:3.7778 train_time:314239ms step_avg:696.76ms
step:462/1750 train_loss:3.7344 train_time:314975ms step_avg:696.85ms
step:463/1750 train_loss:3.5860 train_time:315703ms step_avg:696.92ms
step:464/1750 train_loss:3.7426 train_time:316428ms step_avg:696.98ms
step:465/1750 train_loss:3.8125 train_time:317153ms step_avg:697.04ms
step:466/1750 train_loss:3.6986 train_time:317889ms step_avg:697.12ms
step:467/1750 train_loss:3.7082 train_time:318612ms step_avg:697.18ms
step:468/1750 train_loss:3.6934 train_time:319347ms step_avg:697.26ms
step:469/1750 train_loss:3.8859 train_time:320069ms step_avg:697.32ms
step:470/1750 train_loss:3.7370 train_time:320793ms step_avg:697.38ms
step:471/1750 train_loss:3.5950 train_time:321544ms step_avg:697.49ms
step:472/1750 train_loss:3.8165 train_time:322263ms step_avg:697.54ms
step:473/1750 train_loss:3.6689 train_time:322987ms step_avg:697.60ms
step:474/1750 train_loss:3.7913 train_time:323723ms step_avg:697.68ms
step:475/1750 train_loss:3.8577 train_time:324450ms step_avg:697.74ms
step:476/1750 train_loss:4.0180 train_time:325178ms step_avg:697.81ms
step:477/1750 train_loss:3.7989 train_time:325902ms step_avg:697.86ms
step:478/1750 train_loss:3.7706 train_time:326631ms step_avg:697.93ms
step:479/1750 train_loss:3.7206 train_time:327357ms step_avg:697.99ms
step:480/1750 train_loss:3.6783 train_time:328089ms step_avg:698.06ms
step:481/1750 train_loss:3.7094 train_time:328814ms step_avg:698.12ms
step:482/1750 train_loss:3.8209 train_time:329542ms step_avg:698.18ms
step:483/1750 train_loss:3.7489 train_time:330275ms step_avg:698.26ms
step:484/1750 train_loss:3.8202 train_time:331004ms step_avg:698.32ms
step:485/1750 train_loss:3.7589 train_time:331735ms step_avg:698.39ms
step:486/1750 train_loss:3.5919 train_time:332456ms step_avg:698.44ms
step:487/1750 train_loss:3.7114 train_time:333182ms step_avg:698.49ms
step:488/1750 train_loss:3.7281 train_time:333908ms step_avg:698.55ms
step:489/1750 train_loss:3.7447 train_time:334627ms step_avg:698.60ms
step:490/1750 train_loss:3.9487 train_time:335362ms step_avg:698.67ms
step:491/1750 train_loss:3.6782 train_time:336082ms step_avg:698.71ms
step:492/1750 train_loss:3.6412 train_time:336800ms step_avg:698.76ms
step:493/1750 train_loss:3.7775 train_time:337523ms step_avg:698.80ms
step:494/1750 train_loss:3.5400 train_time:338255ms step_avg:698.87ms
step:495/1750 train_loss:3.7058 train_time:338983ms step_avg:698.93ms
step:496/1750 train_loss:3.8754 train_time:339715ms step_avg:699.00ms
step:497/1750 train_loss:3.7334 train_time:340452ms step_avg:699.08ms
step:498/1750 train_loss:3.7053 train_time:341179ms step_avg:699.14ms
step:499/1750 train_loss:3.6933 train_time:341897ms step_avg:699.18ms
step:500/1750 train_loss:3.7969 train_time:342621ms step_avg:699.23ms
step:500/1750 val_loss:3.6984 train_time:342635ms step_avg:699.26ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 207.49059 | frobenius_norm = 47581.45312 | spectral_norm = 9116.01074 | nuclear_norm = 1181054.75000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 104.51555 | spectral_norm = 15.27591 | nuclear_norm = 2434.19336
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 101.44420 | spectral_norm = 16.82140 | nuclear_norm = 2349.57104
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 203.49580 | spectral_norm = 12.98366 | nuclear_norm = 4881.42041
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 171.75583 | spectral_norm = 15.44983 | nuclear_norm = 4017.65552
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 220.19290 | spectral_norm = 16.62373 | nuclear_norm = 5845.81787
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 114.13106 | spectral_norm = 9.15142 | nuclear_norm = 3029.75366
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 103.69424 | spectral_norm = 9.22700 | nuclear_norm = 2417.95728
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 103.16721 | spectral_norm = 10.02799 | nuclear_norm = 2403.52832
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 204.38614 | spectral_norm = 17.28031 | nuclear_norm = 4718.42285
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 202.18579 | spectral_norm = 15.26453 | nuclear_norm = 4755.06250
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 227.06221 | spectral_norm = 15.06051 | nuclear_norm = 6041.12939
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 111.94176 | spectral_norm = 10.07306 | nuclear_norm = 2947.29346
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 102.38042 | spectral_norm = 9.95587 | nuclear_norm = 2377.45117
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 101.19289 | spectral_norm = 10.79295 | nuclear_norm = 2355.29395
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 200.14659 | spectral_norm = 16.94675 | nuclear_norm = 4583.62891
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 205.78745 | spectral_norm = 15.53444 | nuclear_norm = 4791.58691
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 231.86627 | spectral_norm = 16.18492 | nuclear_norm = 6162.92480
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 115.37499 | spectral_norm = 10.87535 | nuclear_norm = 3039.75122
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 101.29305 | spectral_norm = 8.92808 | nuclear_norm = 2307.80493
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 100.97503 | spectral_norm = 8.71556 | nuclear_norm = 2303.17725
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 208.77492 | spectral_norm = 18.23796 | nuclear_norm = 4731.60449
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 215.35558 | spectral_norm = 16.65097 | nuclear_norm = 5062.42676
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 233.16055 | spectral_norm = 18.18276 | nuclear_norm = 6198.36719
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 114.07135 | spectral_norm = 10.01851 | nuclear_norm = 3000.69727
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 99.62519 | spectral_norm = 9.44060 | nuclear_norm = 2279.24805
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 99.21067 | spectral_norm = 9.62305 | nuclear_norm = 2277.87549
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 203.86359 | spectral_norm = 17.50845 | nuclear_norm = 4638.75391
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 207.96259 | spectral_norm = 16.01812 | nuclear_norm = 4838.17676
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 239.71207 | spectral_norm = 16.78694 | nuclear_norm = 6370.25195
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 114.63922 | spectral_norm = 9.82478 | nuclear_norm = 3021.40381
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 104.61678 | spectral_norm = 9.16392 | nuclear_norm = 2432.54077
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 103.15937 | spectral_norm = 9.36710 | nuclear_norm = 2403.85449
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 210.90663 | spectral_norm = 19.33276 | nuclear_norm = 4789.09326
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 197.07327 | spectral_norm = 14.58261 | nuclear_norm = 4651.78174
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 242.24605 | spectral_norm = 16.24508 | nuclear_norm = 6445.40625
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 117.96473 | spectral_norm = 9.74598 | nuclear_norm = 3109.84644
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 100.39877 | spectral_norm = 9.40061 | nuclear_norm = 2305.53711
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 100.32079 | spectral_norm = 9.41032 | nuclear_norm = 2312.86377
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 214.25354 | spectral_norm = 18.91688 | nuclear_norm = 4881.00928
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 211.86731 | spectral_norm = 16.92017 | nuclear_norm = 4976.82568
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 231.56380 | spectral_norm = 17.42517 | nuclear_norm = 6164.37793
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 114.94830 | spectral_norm = 9.69263 | nuclear_norm = 3024.71826
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 101.76891 | spectral_norm = 9.72159 | nuclear_norm = 2358.84692
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 100.85766 | spectral_norm = 9.06466 | nuclear_norm = 2347.02832
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 203.53903 | spectral_norm = 17.17051 | nuclear_norm = 4605.44971
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 206.30054 | spectral_norm = 17.89977 | nuclear_norm = 4757.96875
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 235.02385 | spectral_norm = 17.95912 | nuclear_norm = 6248.35889
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 116.51411 | spectral_norm = 9.46153 | nuclear_norm = 3073.73096
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 102.58875 | spectral_norm = 9.89737 | nuclear_norm = 2355.43530
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 102.89399 | spectral_norm = 9.33469 | nuclear_norm = 2362.62793
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 219.55238 | spectral_norm = 19.58241 | nuclear_norm = 4971.16650
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 215.90852 | spectral_norm = 17.47892 | nuclear_norm = 5041.13574
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 232.82040 | spectral_norm = 17.35131 | nuclear_norm = 6192.78516
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 115.64118 | spectral_norm = 9.67673 | nuclear_norm = 3057.30273
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 101.20541 | spectral_norm = 10.24936 | nuclear_norm = 2272.48755
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 101.91313 | spectral_norm = 9.52741 | nuclear_norm = 2258.64990
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 235.09763 | spectral_norm = 18.64733 | nuclear_norm = 5438.58203
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 231.39290 | spectral_norm = 15.63535 | nuclear_norm = 5503.92871
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 225.22623 | spectral_norm = 17.14095 | nuclear_norm = 5997.31641
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 114.59700 | spectral_norm = 10.25301 | nuclear_norm = 3035.44019
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 103.58533 | spectral_norm = 10.33828 | nuclear_norm = 2359.43726
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 101.93237 | spectral_norm = 9.66947 | nuclear_norm = 2303.59619
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 215.32932 | spectral_norm = 18.30169 | nuclear_norm = 4949.33643
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 220.17552 | spectral_norm = 15.48363 | nuclear_norm = 5182.90527
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 231.20232 | spectral_norm = 16.40851 | nuclear_norm = 6161.98340
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 112.08746 | spectral_norm = 10.97070 | nuclear_norm = 2963.86328
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 106.64133 | spectral_norm = 11.38898 | nuclear_norm = 2453.70361
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 102.84141 | spectral_norm = 10.78951 | nuclear_norm = 2353.18896
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 205.90379 | spectral_norm = 18.03209 | nuclear_norm = 4747.70020
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 220.93111 | spectral_norm = 15.91170 | nuclear_norm = 5194.76758
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 238.43869 | spectral_norm = 17.52043 | nuclear_norm = 6346.29492
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 117.01875 | spectral_norm = 11.61886 | nuclear_norm = 3080.81299
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 810.01135 | spectral_norm = 167.73117 | nuclear_norm = 20828.04492
===========================================
step:501/1750 train_loss:3.6969 train_time:343345ms step_avg:699.28ms
step:502/1750 train_loss:3.6317 train_time:344067ms step_avg:699.32ms
step:503/1750 train_loss:3.7353 train_time:344785ms step_avg:699.36ms
step:504/1750 train_loss:3.5923 train_time:345512ms step_avg:699.42ms
step:505/1750 train_loss:4.0235 train_time:346229ms step_avg:699.45ms
step:506/1750 train_loss:3.6764 train_time:346949ms step_avg:699.49ms
step:507/1750 train_loss:3.7618 train_time:347672ms step_avg:699.54ms
step:508/1750 train_loss:3.9209 train_time:348396ms step_avg:699.59ms
step:509/1750 train_loss:3.6316 train_time:349119ms step_avg:699.64ms
step:510/1750 train_loss:3.7380 train_time:349845ms step_avg:699.69ms
step:511/1750 train_loss:3.7328 train_time:350581ms step_avg:699.76ms
step:512/1750 train_loss:3.5598 train_time:351304ms step_avg:699.81ms
step:513/1750 train_loss:3.5422 train_time:352038ms step_avg:699.88ms
step:514/1750 train_loss:3.7833 train_time:352758ms step_avg:699.92ms
step:515/1750 train_loss:3.8933 train_time:353492ms step_avg:699.98ms
step:516/1750 train_loss:3.7790 train_time:354212ms step_avg:700.02ms
step:517/1750 train_loss:3.6111 train_time:354941ms step_avg:700.08ms
step:518/1750 train_loss:3.7834 train_time:355663ms step_avg:700.12ms
step:519/1750 train_loss:3.5195 train_time:356382ms step_avg:700.16ms
step:520/1750 train_loss:3.7752 train_time:357117ms step_avg:700.23ms
step:521/1750 train_loss:3.6529 train_time:357856ms step_avg:700.30ms
step:522/1750 train_loss:3.5567 train_time:358588ms step_avg:700.37ms
step:523/1750 train_loss:3.8023 train_time:359328ms step_avg:700.44ms
step:524/1750 train_loss:3.5989 train_time:360061ms step_avg:700.51ms
step:525/1750 train_loss:3.6587 train_time:360795ms step_avg:700.57ms
step:526/1750 train_loss:3.7041 train_time:361536ms step_avg:700.65ms
step:527/1750 train_loss:3.9623 train_time:362269ms step_avg:700.71ms
step:528/1750 train_loss:3.6827 train_time:363000ms step_avg:700.77ms
step:529/1750 train_loss:3.6597 train_time:363730ms step_avg:700.83ms
step:530/1750 train_loss:3.6598 train_time:364468ms step_avg:700.90ms
step:531/1750 train_loss:3.7685 train_time:365202ms step_avg:700.96ms
step:532/1750 train_loss:3.7386 train_time:365953ms step_avg:701.06ms
step:533/1750 train_loss:3.7407 train_time:366696ms step_avg:701.14ms
step:534/1750 train_loss:3.8067 train_time:367427ms step_avg:701.20ms
step:535/1750 train_loss:3.7467 train_time:368186ms step_avg:701.31ms
step:536/1750 train_loss:3.6089 train_time:368918ms step_avg:701.36ms
step:537/1750 train_loss:3.6863 train_time:369664ms step_avg:701.45ms
step:538/1750 train_loss:3.6473 train_time:370412ms step_avg:701.54ms
step:539/1750 train_loss:3.6323 train_time:371156ms step_avg:701.62ms
step:540/1750 train_loss:3.7060 train_time:371913ms step_avg:701.72ms
step:541/1750 train_loss:3.6125 train_time:372649ms step_avg:701.79ms
step:542/1750 train_loss:3.6615 train_time:373388ms step_avg:701.86ms
step:543/1750 train_loss:3.7193 train_time:374122ms step_avg:701.92ms
step:544/1750 train_loss:3.6924 train_time:374858ms step_avg:701.98ms
step:545/1750 train_loss:3.7286 train_time:375589ms step_avg:702.04ms
step:546/1750 train_loss:3.7622 train_time:376318ms step_avg:702.09ms
step:547/1750 train_loss:3.6076 train_time:377065ms step_avg:702.17ms
step:548/1750 train_loss:3.8503 train_time:377801ms step_avg:702.23ms
step:549/1750 train_loss:3.2593 train_time:378541ms step_avg:702.30ms
step:550/1750 train_loss:3.7222 train_time:379292ms step_avg:702.39ms
step:551/1750 train_loss:3.7350 train_time:380023ms step_avg:702.44ms
step:552/1750 train_loss:3.6634 train_time:380748ms step_avg:702.49ms
step:553/1750 train_loss:3.7486 train_time:381491ms step_avg:702.56ms
step:554/1750 train_loss:3.6734 train_time:382223ms step_avg:702.61ms
step:555/1750 train_loss:3.6577 train_time:382959ms step_avg:702.68ms
step:556/1750 train_loss:3.7901 train_time:383694ms step_avg:702.74ms
step:557/1750 train_loss:3.6919 train_time:384425ms step_avg:702.79ms
step:558/1750 train_loss:3.6138 train_time:385153ms step_avg:702.83ms
step:559/1750 train_loss:3.7192 train_time:385885ms step_avg:702.89ms
step:560/1750 train_loss:3.6182 train_time:386609ms step_avg:702.93ms
step:561/1750 train_loss:3.6689 train_time:387341ms step_avg:702.98ms
step:562/1750 train_loss:3.6697 train_time:388065ms step_avg:703.02ms
step:563/1750 train_loss:3.4738 train_time:388794ms step_avg:703.06ms
step:564/1750 train_loss:3.7338 train_time:389526ms step_avg:703.12ms
step:565/1750 train_loss:3.6043 train_time:390264ms step_avg:703.18ms
step:566/1750 train_loss:3.6461 train_time:390999ms step_avg:703.24ms
step:567/1750 train_loss:3.7250 train_time:391733ms step_avg:703.29ms
step:568/1750 train_loss:3.6433 train_time:392470ms step_avg:703.35ms
step:569/1750 train_loss:3.9880 train_time:393201ms step_avg:703.40ms
step:570/1750 train_loss:3.6957 train_time:394142ms step_avg:703.83ms
step:571/1750 train_loss:3.6540 train_time:394881ms step_avg:703.89ms
step:572/1750 train_loss:3.7591 train_time:395617ms step_avg:703.94ms
step:573/1750 train_loss:3.7158 train_time:396349ms step_avg:703.99ms
step:574/1750 train_loss:3.7314 train_time:397081ms step_avg:704.04ms
step:575/1750 train_loss:3.7817 train_time:397835ms step_avg:704.13ms
step:576/1750 train_loss:3.7298 train_time:398566ms step_avg:704.18ms
step:577/1750 train_loss:3.7604 train_time:399292ms step_avg:704.22ms
step:578/1750 train_loss:3.6780 train_time:400019ms step_avg:704.26ms
step:579/1750 train_loss:3.6659 train_time:400757ms step_avg:704.32ms
step:580/1750 train_loss:3.6628 train_time:401496ms step_avg:704.38ms
step:581/1750 train_loss:3.5927 train_time:402228ms step_avg:704.43ms
step:582/1750 train_loss:3.6366 train_time:402959ms step_avg:704.47ms
step:583/1750 train_loss:3.8419 train_time:403694ms step_avg:704.53ms
step:584/1750 train_loss:3.6282 train_time:404424ms step_avg:704.57ms
step:585/1750 train_loss:3.5882 train_time:405160ms step_avg:704.63ms
step:586/1750 train_loss:3.7964 train_time:405892ms step_avg:704.67ms
step:587/1750 train_loss:3.5069 train_time:406627ms step_avg:704.73ms
step:588/1750 train_loss:3.6686 train_time:407353ms step_avg:704.76ms
step:589/1750 train_loss:3.6454 train_time:408094ms step_avg:704.83ms
step:590/1750 train_loss:4.0007 train_time:408833ms step_avg:704.88ms
step:591/1750 train_loss:3.7696 train_time:409569ms step_avg:704.94ms
step:592/1750 train_loss:3.5196 train_time:410299ms step_avg:704.98ms
step:593/1750 train_loss:3.5422 train_time:411033ms step_avg:705.03ms
step:594/1750 train_loss:3.4965 train_time:411791ms step_avg:705.12ms
step:595/1750 train_loss:3.5507 train_time:412540ms step_avg:705.20ms
step:596/1750 train_loss:3.9153 train_time:413298ms step_avg:705.29ms
step:597/1750 train_loss:3.6336 train_time:414042ms step_avg:705.35ms
step:598/1750 train_loss:3.5809 train_time:414776ms step_avg:705.40ms
step:599/1750 train_loss:3.6641 train_time:415521ms step_avg:705.47ms
step:600/1750 train_loss:3.4780 train_time:416263ms step_avg:705.53ms
step:601/1750 train_loss:3.6040 train_time:417007ms step_avg:705.60ms
step:602/1750 train_loss:3.6501 train_time:417740ms step_avg:705.64ms
step:603/1750 train_loss:3.6690 train_time:418489ms step_avg:705.71ms
step:604/1750 train_loss:3.7766 train_time:419248ms step_avg:705.81ms
step:605/1750 train_loss:3.6083 train_time:419977ms step_avg:705.84ms
step:606/1750 train_loss:3.6132 train_time:420720ms step_avg:705.91ms
step:607/1750 train_loss:3.5718 train_time:421484ms step_avg:706.00ms
step:608/1750 train_loss:3.8371 train_time:422213ms step_avg:706.04ms
step:609/1750 train_loss:3.6522 train_time:422952ms step_avg:706.10ms
step:610/1750 train_loss:3.6164 train_time:423680ms step_avg:706.13ms
step:611/1750 train_loss:3.7067 train_time:424423ms step_avg:706.20ms
step:612/1750 train_loss:3.6024 train_time:425166ms step_avg:706.26ms
step:613/1750 train_loss:3.5654 train_time:425899ms step_avg:706.30ms
step:614/1750 train_loss:3.7657 train_time:426644ms step_avg:706.36ms
step:615/1750 train_loss:3.7029 train_time:427378ms step_avg:706.41ms
step:616/1750 train_loss:3.6942 train_time:428111ms step_avg:706.45ms
step:617/1750 train_loss:3.6444 train_time:428847ms step_avg:706.50ms
step:618/1750 train_loss:3.5599 train_time:429585ms step_avg:706.55ms
step:619/1750 train_loss:3.6952 train_time:430326ms step_avg:706.61ms
step:620/1750 train_loss:3.5524 train_time:431075ms step_avg:706.68ms
step:621/1750 train_loss:3.5889 train_time:431825ms step_avg:706.75ms
step:622/1750 train_loss:3.9185 train_time:432563ms step_avg:706.80ms
step:623/1750 train_loss:3.5738 train_time:433322ms step_avg:706.89ms
step:624/1750 train_loss:3.6052 train_time:434057ms step_avg:706.93ms
step:625/1750 train_loss:3.6981 train_time:434805ms step_avg:707.00ms
step:625/1750 val_loss:3.6230 train_time:434818ms step_avg:707.02ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 225.95494 | frobenius_norm = 51890.90234 | spectral_norm = 9699.43652 | nuclear_norm = 1292160.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 121.67419 | spectral_norm = 19.02578 | nuclear_norm = 2822.60596
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 117.76512 | spectral_norm = 20.52073 | nuclear_norm = 2718.14771
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 235.06398 | spectral_norm = 15.23365 | nuclear_norm = 5666.22363
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 192.07089 | spectral_norm = 17.91331 | nuclear_norm = 4480.96533
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 257.35541 | spectral_norm = 20.01458 | nuclear_norm = 6832.48730
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 133.55373 | spectral_norm = 11.29454 | nuclear_norm = 3543.99219
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 121.31932 | spectral_norm = 10.91423 | nuclear_norm = 2822.22559
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 120.11747 | spectral_norm = 11.39795 | nuclear_norm = 2788.88013
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 230.86803 | spectral_norm = 19.54070 | nuclear_norm = 5325.11328
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 227.95613 | spectral_norm = 17.34505 | nuclear_norm = 5360.08203
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 263.04553 | spectral_norm = 17.54315 | nuclear_norm = 7001.23438
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 129.47694 | spectral_norm = 12.25144 | nuclear_norm = 3404.70752
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 119.53721 | spectral_norm = 11.99105 | nuclear_norm = 2764.82104
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 117.97666 | spectral_norm = 12.68218 | nuclear_norm = 2736.70020
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 226.55653 | spectral_norm = 19.53803 | nuclear_norm = 5183.74609
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 232.47478 | spectral_norm = 17.66750 | nuclear_norm = 5405.96240
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 268.10483 | spectral_norm = 19.57298 | nuclear_norm = 7124.58008
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 134.23235 | spectral_norm = 13.23257 | nuclear_norm = 3534.97876
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 117.75391 | spectral_norm = 10.72272 | nuclear_norm = 2661.94873
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 117.12048 | spectral_norm = 10.36248 | nuclear_norm = 2652.25000
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 237.67984 | spectral_norm = 20.97582 | nuclear_norm = 5378.12012
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 245.82269 | spectral_norm = 19.14129 | nuclear_norm = 5773.00977
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 270.23767 | spectral_norm = 21.94779 | nuclear_norm = 7183.30908
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 132.41542 | spectral_norm = 12.09645 | nuclear_norm = 3481.04932
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 115.95107 | spectral_norm = 11.39575 | nuclear_norm = 2635.42383
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 115.06220 | spectral_norm = 11.31162 | nuclear_norm = 2628.79224
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 234.42271 | spectral_norm = 20.10530 | nuclear_norm = 5332.96289
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 237.55519 | spectral_norm = 18.58129 | nuclear_norm = 5522.39404
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 277.61462 | spectral_norm = 20.35787 | nuclear_norm = 7377.58936
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 133.26889 | spectral_norm = 11.82220 | nuclear_norm = 3512.40405
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 121.97157 | spectral_norm = 10.92595 | nuclear_norm = 2823.86865
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 119.92677 | spectral_norm = 11.17197 | nuclear_norm = 2786.65967
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 241.22197 | spectral_norm = 22.42717 | nuclear_norm = 5473.92090
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 223.82019 | spectral_norm = 16.35010 | nuclear_norm = 5293.38477
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 283.56635 | spectral_norm = 19.29106 | nuclear_norm = 7546.46484
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 137.94431 | spectral_norm = 11.64223 | nuclear_norm = 3636.17456
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 116.73142 | spectral_norm = 11.43376 | nuclear_norm = 2662.98438
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 116.45412 | spectral_norm = 11.14509 | nuclear_norm = 2670.34326
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 245.82100 | spectral_norm = 21.59458 | nuclear_norm = 5597.63867
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 243.31590 | spectral_norm = 19.12306 | nuclear_norm = 5716.04883
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 268.67413 | spectral_norm = 20.45485 | nuclear_norm = 7158.92676
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 133.62592 | spectral_norm = 11.46554 | nuclear_norm = 3516.01221
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 118.58402 | spectral_norm = 11.79809 | nuclear_norm = 2735.10181
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 117.24812 | spectral_norm = 10.98016 | nuclear_norm = 2719.19434
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 234.47339 | spectral_norm = 19.58603 | nuclear_norm = 5304.87988
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 235.37927 | spectral_norm = 20.91259 | nuclear_norm = 5398.13672
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 272.80255 | spectral_norm = 20.92513 | nuclear_norm = 7254.49023
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 135.79353 | spectral_norm = 11.43144 | nuclear_norm = 3581.34082
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 119.74670 | spectral_norm = 11.97685 | nuclear_norm = 2732.31592
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 119.70081 | spectral_norm = 11.14430 | nuclear_norm = 2733.77344
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 252.19943 | spectral_norm = 22.62400 | nuclear_norm = 5690.61426
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 246.04198 | spectral_norm = 19.90150 | nuclear_norm = 5733.09570
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 270.68402 | spectral_norm = 20.61553 | nuclear_norm = 7201.35254
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 134.97246 | spectral_norm = 11.80016 | nuclear_norm = 3569.00781
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 118.39220 | spectral_norm = 12.36436 | nuclear_norm = 2638.16064
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 119.35930 | spectral_norm = 11.49469 | nuclear_norm = 2620.89917
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 267.40250 | spectral_norm = 21.86701 | nuclear_norm = 6169.88281
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 263.24963 | spectral_norm = 17.67808 | nuclear_norm = 6261.87012
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 260.96194 | spectral_norm = 20.36236 | nuclear_norm = 6948.02344
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 134.07870 | spectral_norm = 12.65447 | nuclear_norm = 3552.72559
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 120.94124 | spectral_norm = 12.52527 | nuclear_norm = 2732.90820
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 119.02596 | spectral_norm = 11.66917 | nuclear_norm = 2667.76904
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 245.93649 | spectral_norm = 21.52669 | nuclear_norm = 5637.42773
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 250.04973 | spectral_norm = 17.77313 | nuclear_norm = 5871.93848
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 269.44321 | spectral_norm = 19.41722 | nuclear_norm = 7181.95215
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 129.94351 | spectral_norm = 13.67286 | nuclear_norm = 3435.00073
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 124.81094 | spectral_norm = 13.87736 | nuclear_norm = 2852.16406
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 119.90831 | spectral_norm = 13.19205 | nuclear_norm = 2725.51514
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 236.20107 | spectral_norm = 21.60627 | nuclear_norm = 5433.42236
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 253.23759 | spectral_norm = 18.34503 | nuclear_norm = 5941.98975
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 279.79358 | spectral_norm = 20.80236 | nuclear_norm = 7446.24170
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 137.51637 | spectral_norm = 14.45968 | nuclear_norm = 3618.06592
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 915.77710 | spectral_norm = 170.31712 | nuclear_norm = 23717.42383
===========================================
step:626/1750 train_loss:3.7005 train_time:435540ms step_avg:707.05ms
step:627/1750 train_loss:3.7431 train_time:436284ms step_avg:707.11ms
step:628/1750 train_loss:3.7141 train_time:437037ms step_avg:707.18ms
step:629/1750 train_loss:3.7749 train_time:437765ms step_avg:707.21ms
step:630/1750 train_loss:3.5931 train_time:438496ms step_avg:707.25ms
step:631/1750 train_loss:3.7198 train_time:439226ms step_avg:707.29ms
step:632/1750 train_loss:3.7425 train_time:439965ms step_avg:707.34ms
step:633/1750 train_loss:3.6497 train_time:440706ms step_avg:707.39ms
step:634/1750 train_loss:3.6071 train_time:441449ms step_avg:707.45ms
step:635/1750 train_loss:3.7064 train_time:442194ms step_avg:707.51ms
step:636/1750 train_loss:3.9579 train_time:442923ms step_avg:707.54ms
step:637/1750 train_loss:3.5459 train_time:443652ms step_avg:707.58ms
step:638/1750 train_loss:3.3510 train_time:444389ms step_avg:707.63ms
step:639/1750 train_loss:3.5991 train_time:445134ms step_avg:707.68ms
step:640/1750 train_loss:3.6334 train_time:445867ms step_avg:707.73ms
step:641/1750 train_loss:3.5764 train_time:446599ms step_avg:707.76ms
step:642/1750 train_loss:3.5789 train_time:447337ms step_avg:707.81ms
step:643/1750 train_loss:3.6361 train_time:448073ms step_avg:707.86ms
step:644/1750 train_loss:3.6094 train_time:448812ms step_avg:707.91ms
step:645/1750 train_loss:3.5623 train_time:449538ms step_avg:707.93ms
step:646/1750 train_loss:3.7751 train_time:450271ms step_avg:707.97ms
step:647/1750 train_loss:3.6850 train_time:451021ms step_avg:708.04ms
step:648/1750 train_loss:3.6585 train_time:451754ms step_avg:708.08ms
step:649/1750 train_loss:3.7153 train_time:452513ms step_avg:708.16ms
step:650/1750 train_loss:3.7710 train_time:453248ms step_avg:708.20ms
step:651/1750 train_loss:3.6196 train_time:453994ms step_avg:708.26ms
step:652/1750 train_loss:3.7693 train_time:454737ms step_avg:708.31ms
step:653/1750 train_loss:3.5895 train_time:455479ms step_avg:708.37ms
step:654/1750 train_loss:3.6673 train_time:456214ms step_avg:708.41ms
step:655/1750 train_loss:3.4291 train_time:456950ms step_avg:708.45ms
step:656/1750 train_loss:3.5809 train_time:457680ms step_avg:708.48ms
step:657/1750 train_loss:3.5783 train_time:458423ms step_avg:708.54ms
step:658/1750 train_loss:3.4970 train_time:459162ms step_avg:708.58ms
step:659/1750 train_loss:3.6851 train_time:459905ms step_avg:708.64ms
step:660/1750 train_loss:3.5865 train_time:460648ms step_avg:708.69ms
step:661/1750 train_loss:3.6804 train_time:461387ms step_avg:708.74ms
step:662/1750 train_loss:3.7526 train_time:462128ms step_avg:708.79ms
step:663/1750 train_loss:3.6784 train_time:462871ms step_avg:708.84ms
step:664/1750 train_loss:3.5615 train_time:463607ms step_avg:708.88ms
step:665/1750 train_loss:3.6094 train_time:464347ms step_avg:708.93ms
step:666/1750 train_loss:3.4981 train_time:465089ms step_avg:708.98ms
step:667/1750 train_loss:3.7882 train_time:465825ms step_avg:709.02ms
step:668/1750 train_loss:3.6163 train_time:466585ms step_avg:709.10ms
step:669/1750 train_loss:3.6440 train_time:467338ms step_avg:709.16ms
step:670/1750 train_loss:3.4833 train_time:468094ms step_avg:709.23ms
step:671/1750 train_loss:3.6023 train_time:468849ms step_avg:709.30ms
step:672/1750 train_loss:3.5632 train_time:469590ms step_avg:709.35ms
step:673/1750 train_loss:3.5683 train_time:470342ms step_avg:709.41ms
step:674/1750 train_loss:3.8513 train_time:471096ms step_avg:709.48ms
step:675/1750 train_loss:3.6279 train_time:471845ms step_avg:709.54ms
step:676/1750 train_loss:3.7172 train_time:472599ms step_avg:709.61ms
step:677/1750 train_loss:3.4904 train_time:473341ms step_avg:709.66ms
step:678/1750 train_loss:3.6008 train_time:474088ms step_avg:709.71ms
step:679/1750 train_loss:3.5574 train_time:474833ms step_avg:709.77ms
step:680/1750 train_loss:3.6679 train_time:475594ms step_avg:709.84ms
step:681/1750 train_loss:3.5892 train_time:476358ms step_avg:709.92ms
step:682/1750 train_loss:3.6254 train_time:477104ms step_avg:709.98ms
step:683/1750 train_loss:3.6515 train_time:477861ms step_avg:710.05ms
step:684/1750 train_loss:3.7408 train_time:478624ms step_avg:710.12ms
step:685/1750 train_loss:3.6551 train_time:479390ms step_avg:710.21ms
step:686/1750 train_loss:3.6952 train_time:480139ms step_avg:710.26ms
step:687/1750 train_loss:3.6358 train_time:480891ms step_avg:710.33ms
step:688/1750 train_loss:3.6667 train_time:481654ms step_avg:710.40ms
step:689/1750 train_loss:3.1707 train_time:482440ms step_avg:710.52ms
step:690/1750 train_loss:3.4010 train_time:483179ms step_avg:710.56ms
step:691/1750 train_loss:3.5396 train_time:483923ms step_avg:710.61ms
step:692/1750 train_loss:3.4187 train_time:484662ms step_avg:710.65ms
step:693/1750 train_loss:3.6313 train_time:485413ms step_avg:710.71ms
step:694/1750 train_loss:3.6538 train_time:486158ms step_avg:710.76ms
step:695/1750 train_loss:3.5598 train_time:486899ms step_avg:710.80ms
step:696/1750 train_loss:3.5433 train_time:487644ms step_avg:710.85ms
step:697/1750 train_loss:3.8627 train_time:488403ms step_avg:710.92ms
step:698/1750 train_loss:3.5907 train_time:489153ms step_avg:710.98ms
step:699/1750 train_loss:3.6455 train_time:489902ms step_avg:711.03ms
step:700/1750 train_loss:3.7594 train_time:490656ms step_avg:711.10ms
step:701/1750 train_loss:3.5727 train_time:491392ms step_avg:711.13ms
step:702/1750 train_loss:3.5536 train_time:492128ms step_avg:711.17ms
step:703/1750 train_loss:3.5092 train_time:492885ms step_avg:711.23ms
step:704/1750 train_loss:3.5044 train_time:493637ms step_avg:711.29ms
step:705/1750 train_loss:3.5809 train_time:494413ms step_avg:711.39ms
step:706/1750 train_loss:3.5616 train_time:495153ms step_avg:711.43ms
step:707/1750 train_loss:3.5899 train_time:495918ms step_avg:711.50ms
step:708/1750 train_loss:3.6529 train_time:496675ms step_avg:711.57ms
step:709/1750 train_loss:3.6107 train_time:497442ms step_avg:711.65ms
step:710/1750 train_loss:3.5896 train_time:498189ms step_avg:711.70ms
step:711/1750 train_loss:3.5457 train_time:498945ms step_avg:711.76ms
step:712/1750 train_loss:3.5952 train_time:499709ms step_avg:711.84ms
step:713/1750 train_loss:3.6544 train_time:500450ms step_avg:711.88ms
step:714/1750 train_loss:3.6399 train_time:501211ms step_avg:711.95ms
step:715/1750 train_loss:3.5677 train_time:501966ms step_avg:712.01ms
step:716/1750 train_loss:3.5750 train_time:502716ms step_avg:712.06ms
step:717/1750 train_loss:3.5925 train_time:503465ms step_avg:712.11ms
step:718/1750 train_loss:3.7033 train_time:504206ms step_avg:712.16ms
step:719/1750 train_loss:3.6031 train_time:504951ms step_avg:712.20ms
step:720/1750 train_loss:3.6847 train_time:505689ms step_avg:712.24ms
step:721/1750 train_loss:3.8494 train_time:506447ms step_avg:712.30ms
step:722/1750 train_loss:3.4681 train_time:507187ms step_avg:712.34ms
step:723/1750 train_loss:3.7388 train_time:507931ms step_avg:712.39ms
step:724/1750 train_loss:3.7771 train_time:508661ms step_avg:712.41ms
step:725/1750 train_loss:3.5736 train_time:509414ms step_avg:712.47ms
step:726/1750 train_loss:3.6603 train_time:510185ms step_avg:712.55ms
step:727/1750 train_loss:3.5420 train_time:510928ms step_avg:712.59ms
step:728/1750 train_loss:3.5802 train_time:511669ms step_avg:712.63ms
step:729/1750 train_loss:3.7434 train_time:512407ms step_avg:712.67ms
step:730/1750 train_loss:3.6693 train_time:513159ms step_avg:712.72ms
step:731/1750 train_loss:3.6702 train_time:513916ms step_avg:712.78ms
step:732/1750 train_loss:3.5609 train_time:514662ms step_avg:712.83ms
step:733/1750 train_loss:3.6041 train_time:515393ms step_avg:712.85ms
step:734/1750 train_loss:3.8340 train_time:516135ms step_avg:712.89ms
step:735/1750 train_loss:3.5674 train_time:516873ms step_avg:712.93ms
step:736/1750 train_loss:3.6176 train_time:517639ms step_avg:713.00ms
step:737/1750 train_loss:3.7398 train_time:518377ms step_avg:713.04ms
step:738/1750 train_loss:3.6846 train_time:519116ms step_avg:713.07ms
step:739/1750 train_loss:3.5995 train_time:519850ms step_avg:713.10ms
step:740/1750 train_loss:3.5118 train_time:520595ms step_avg:713.14ms
step:741/1750 train_loss:4.1055 train_time:521375ms step_avg:713.24ms
step:742/1750 train_loss:3.5054 train_time:522133ms step_avg:713.30ms
step:743/1750 train_loss:3.5649 train_time:522896ms step_avg:713.36ms
step:744/1750 train_loss:3.5885 train_time:523680ms step_avg:713.46ms
step:745/1750 train_loss:3.6584 train_time:524446ms step_avg:713.53ms
step:746/1750 train_loss:3.5813 train_time:525193ms step_avg:713.58ms
step:747/1750 train_loss:3.6046 train_time:525931ms step_avg:713.61ms
step:748/1750 train_loss:3.6571 train_time:526689ms step_avg:713.67ms
step:749/1750 train_loss:3.5741 train_time:527460ms step_avg:713.75ms
step:750/1750 train_loss:3.5659 train_time:528237ms step_avg:713.83ms
step:750/1750 val_loss:3.5734 train_time:528251ms step_avg:713.85ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 242.07117 | frobenius_norm = 55656.88281 | spectral_norm = 10252.42773 | nuclear_norm = 1389713.37500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 136.51474 | spectral_norm = 22.53355 | nuclear_norm = 3157.53418
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 132.04773 | spectral_norm = 24.34958 | nuclear_norm = 3040.75439
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 261.46307 | spectral_norm = 17.18923 | nuclear_norm = 6329.50293
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 205.98196 | spectral_norm = 20.12731 | nuclear_norm = 4792.75781
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 289.88055 | spectral_norm = 23.14049 | nuclear_norm = 7697.45996
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 150.34023 | spectral_norm = 13.14052 | nuclear_norm = 3988.95752
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 136.55400 | spectral_norm = 12.54840 | nuclear_norm = 3168.17627
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 135.24359 | spectral_norm = 12.72647 | nuclear_norm = 3135.70508
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 254.21283 | spectral_norm = 21.60759 | nuclear_norm = 5855.05127
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 250.54219 | spectral_norm = 19.21665 | nuclear_norm = 5890.95459
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 294.92389 | spectral_norm = 20.16213 | nuclear_norm = 7855.17773
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 144.75919 | spectral_norm = 14.17198 | nuclear_norm = 3803.41602
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 134.28558 | spectral_norm = 13.83297 | nuclear_norm = 3094.98535
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 132.66975 | spectral_norm = 14.27110 | nuclear_norm = 3069.13574
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 250.28075 | spectral_norm = 21.75174 | nuclear_norm = 5724.29199
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 256.43759 | spectral_norm = 19.60372 | nuclear_norm = 5957.41357
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 300.00217 | spectral_norm = 22.69548 | nuclear_norm = 7971.84814
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 150.64117 | spectral_norm = 15.28479 | nuclear_norm = 3965.43457
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 131.79227 | spectral_norm = 12.24433 | nuclear_norm = 2959.88135
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 131.09529 | spectral_norm = 11.92261 | nuclear_norm = 2950.81641
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 264.18405 | spectral_norm = 23.47539 | nuclear_norm = 5968.40869
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 273.21985 | spectral_norm = 21.51704 | nuclear_norm = 6411.96094
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 302.56891 | spectral_norm = 25.56127 | nuclear_norm = 8041.50000
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 148.46104 | spectral_norm = 14.00372 | nuclear_norm = 3900.61450
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 130.28619 | spectral_norm = 13.02493 | nuclear_norm = 2945.97998
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 128.85483 | spectral_norm = 12.83561 | nuclear_norm = 2932.97168
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 262.25287 | spectral_norm = 22.55327 | nuclear_norm = 5966.56836
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 264.48044 | spectral_norm = 20.97227 | nuclear_norm = 6147.36572
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 310.71161 | spectral_norm = 23.60929 | nuclear_norm = 8257.97266
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 149.52783 | spectral_norm = 13.51182 | nuclear_norm = 3941.69214
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 136.92406 | spectral_norm = 12.63099 | nuclear_norm = 3160.48291
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 134.42213 | spectral_norm = 12.82684 | nuclear_norm = 3117.82812
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 268.79031 | spectral_norm = 24.80665 | nuclear_norm = 6096.86279
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 247.79160 | spectral_norm = 17.88581 | nuclear_norm = 5873.39014
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 319.41351 | spectral_norm = 22.00630 | nuclear_norm = 8502.97266
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 155.48888 | spectral_norm = 13.41296 | nuclear_norm = 4099.64160
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 130.72090 | spectral_norm = 13.24817 | nuclear_norm = 2966.83154
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 130.26999 | spectral_norm = 12.76807 | nuclear_norm = 2974.99780
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 274.56491 | spectral_norm = 24.09003 | nuclear_norm = 6257.09082
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 271.70898 | spectral_norm = 21.21822 | nuclear_norm = 6383.18848
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 300.93777 | spectral_norm = 22.99873 | nuclear_norm = 8023.53027
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 149.79935 | spectral_norm = 13.28783 | nuclear_norm = 3941.58984
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 133.16277 | spectral_norm = 13.62608 | nuclear_norm = 3059.11060
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 131.38905 | spectral_norm = 12.63366 | nuclear_norm = 3037.69092
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 262.05756 | spectral_norm = 21.78458 | nuclear_norm = 5932.24121
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 261.24182 | spectral_norm = 23.26399 | nuclear_norm = 5974.45459
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 305.76898 | spectral_norm = 23.46890 | nuclear_norm = 8134.12061
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 152.53198 | spectral_norm = 13.57355 | nuclear_norm = 4022.44678
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 134.61035 | spectral_norm = 13.70986 | nuclear_norm = 3057.29199
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 134.24365 | spectral_norm = 12.70820 | nuclear_norm = 3053.89136
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 281.06485 | spectral_norm = 25.29171 | nuclear_norm = 6326.18213
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 272.78519 | spectral_norm = 21.73596 | nuclear_norm = 6349.74902
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 304.40240 | spectral_norm = 23.56989 | nuclear_norm = 8098.77051
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 151.77899 | spectral_norm = 13.95927 | nuclear_norm = 4012.36450
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 133.18910 | spectral_norm = 14.18132 | nuclear_norm = 2950.87305
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 134.50237 | spectral_norm = 13.24605 | nuclear_norm = 2929.49951
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 296.06992 | spectral_norm = 24.90575 | nuclear_norm = 6816.47070
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 291.61218 | spectral_norm = 19.55087 | nuclear_norm = 6940.55762
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 292.57880 | spectral_norm = 23.41438 | nuclear_norm = 7788.33838
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 151.16847 | spectral_norm = 14.84786 | nuclear_norm = 4006.46631
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 135.70531 | spectral_norm = 14.52188 | nuclear_norm = 3046.51660
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 133.79939 | spectral_norm = 13.58596 | nuclear_norm = 2977.51758
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 272.71249 | spectral_norm = 24.63580 | nuclear_norm = 6239.15820
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 276.92688 | spectral_norm = 19.78056 | nuclear_norm = 6494.63525
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 303.38968 | spectral_norm = 22.14301 | nuclear_norm = 8085.91797
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 145.56819 | spectral_norm = 16.15287 | nuclear_norm = 3847.28516
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 140.32024 | spectral_norm = 16.20316 | nuclear_norm = 3188.14111
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 134.58385 | spectral_norm = 15.29282 | nuclear_norm = 3043.77979
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 263.42343 | spectral_norm = 24.73782 | nuclear_norm = 6046.94434
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 282.65778 | spectral_norm = 20.55112 | nuclear_norm = 6624.18701
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 316.19287 | spectral_norm = 23.74034 | nuclear_norm = 8412.45605
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 155.96748 | spectral_norm = 17.14173 | nuclear_norm = 4100.95215
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1010.02490 | spectral_norm = 171.17712 | nuclear_norm = 26300.20117
===========================================
step:751/1750 train_loss:3.6107 train_time:528980ms step_avg:713.87ms
step:752/1750 train_loss:3.5761 train_time:529734ms step_avg:713.93ms
step:753/1750 train_loss:3.6239 train_time:530484ms step_avg:713.98ms
step:754/1750 train_loss:3.6238 train_time:531247ms step_avg:714.04ms
step:755/1750 train_loss:3.6006 train_time:531983ms step_avg:714.07ms
step:756/1750 train_loss:3.6907 train_time:532745ms step_avg:714.13ms
step:757/1750 train_loss:3.4669 train_time:533512ms step_avg:714.21ms
step:758/1750 train_loss:3.7301 train_time:534301ms step_avg:714.31ms
step:759/1750 train_loss:3.6680 train_time:535037ms step_avg:714.33ms
step:760/1750 train_loss:3.5981 train_time:536004ms step_avg:714.67ms
step:761/1750 train_loss:3.7151 train_time:536751ms step_avg:714.72ms
step:762/1750 train_loss:3.6195 train_time:537707ms step_avg:715.04ms
step:763/1750 train_loss:3.4427 train_time:538470ms step_avg:715.10ms
step:764/1750 train_loss:3.4388 train_time:539224ms step_avg:715.15ms
step:765/1750 train_loss:3.5489 train_time:539979ms step_avg:715.20ms
step:766/1750 train_loss:3.5471 train_time:540727ms step_avg:715.25ms
step:767/1750 train_loss:4.5852 train_time:541509ms step_avg:715.34ms
step:768/1750 train_loss:3.5602 train_time:542272ms step_avg:715.40ms
step:769/1750 train_loss:3.5975 train_time:543027ms step_avg:715.45ms
step:770/1750 train_loss:3.6860 train_time:543782ms step_avg:715.50ms
step:771/1750 train_loss:4.1907 train_time:544532ms step_avg:715.55ms
step:772/1750 train_loss:3.6047 train_time:545306ms step_avg:715.62ms
step:773/1750 train_loss:3.6123 train_time:546055ms step_avg:715.67ms
step:774/1750 train_loss:3.5708 train_time:546816ms step_avg:715.73ms
step:775/1750 train_loss:3.7014 train_time:547561ms step_avg:715.77ms
step:776/1750 train_loss:3.4818 train_time:548314ms step_avg:715.81ms
step:777/1750 train_loss:3.6277 train_time:549060ms step_avg:715.85ms
step:778/1750 train_loss:3.6174 train_time:549821ms step_avg:715.91ms
step:779/1750 train_loss:3.5879 train_time:550584ms step_avg:715.97ms
step:780/1750 train_loss:3.5885 train_time:551341ms step_avg:716.03ms
step:781/1750 train_loss:3.4784 train_time:552098ms step_avg:716.08ms
step:782/1750 train_loss:3.6376 train_time:552845ms step_avg:716.12ms
step:783/1750 train_loss:3.5792 train_time:553603ms step_avg:716.18ms
step:784/1750 train_loss:3.5482 train_time:554351ms step_avg:716.22ms
step:785/1750 train_loss:3.5543 train_time:555112ms step_avg:716.27ms
step:786/1750 train_loss:3.5710 train_time:555861ms step_avg:716.32ms
step:787/1750 train_loss:3.5276 train_time:556613ms step_avg:716.36ms
step:788/1750 train_loss:3.5923 train_time:557358ms step_avg:716.40ms
step:789/1750 train_loss:3.5467 train_time:558105ms step_avg:716.44ms
step:790/1750 train_loss:3.4730 train_time:558854ms step_avg:716.48ms
step:791/1750 train_loss:3.5398 train_time:559628ms step_avg:716.55ms
step:792/1750 train_loss:3.6095 train_time:560372ms step_avg:716.59ms
step:793/1750 train_loss:3.6165 train_time:561126ms step_avg:716.64ms
step:794/1750 train_loss:3.6440 train_time:561899ms step_avg:716.71ms
step:795/1750 train_loss:3.5716 train_time:562657ms step_avg:716.76ms
step:796/1750 train_loss:3.6889 train_time:563423ms step_avg:716.82ms
step:797/1750 train_loss:3.5922 train_time:564176ms step_avg:716.87ms
step:798/1750 train_loss:3.3988 train_time:564935ms step_avg:716.92ms
step:799/1750 train_loss:3.4781 train_time:565687ms step_avg:716.97ms
step:800/1750 train_loss:4.2820 train_time:566468ms step_avg:717.05ms
step:801/1750 train_loss:3.7058 train_time:567218ms step_avg:717.09ms
step:802/1750 train_loss:3.5569 train_time:567960ms step_avg:717.12ms
step:803/1750 train_loss:3.6061 train_time:568720ms step_avg:717.17ms
step:804/1750 train_loss:3.5962 train_time:569482ms step_avg:717.23ms
step:805/1750 train_loss:3.5381 train_time:570238ms step_avg:717.28ms
step:806/1750 train_loss:3.5393 train_time:571003ms step_avg:717.34ms
step:807/1750 train_loss:3.5694 train_time:571761ms step_avg:717.39ms
step:808/1750 train_loss:3.6391 train_time:572503ms step_avg:717.42ms
step:809/1750 train_loss:3.8439 train_time:573264ms step_avg:717.48ms
step:810/1750 train_loss:3.6885 train_time:574001ms step_avg:717.50ms
step:811/1750 train_loss:3.4879 train_time:574762ms step_avg:717.56ms
step:812/1750 train_loss:3.6182 train_time:575509ms step_avg:717.59ms
step:813/1750 train_loss:3.6291 train_time:576253ms step_avg:717.63ms
step:814/1750 train_loss:3.5684 train_time:576998ms step_avg:717.66ms
step:815/1750 train_loss:3.4116 train_time:577759ms step_avg:717.71ms
step:816/1750 train_loss:3.7561 train_time:578510ms step_avg:717.75ms
step:817/1750 train_loss:3.5850 train_time:579256ms step_avg:717.79ms
step:818/1750 train_loss:3.5472 train_time:580029ms step_avg:717.86ms
step:819/1750 train_loss:3.5599 train_time:580789ms step_avg:717.91ms
step:820/1750 train_loss:3.5431 train_time:581533ms step_avg:717.94ms
step:821/1750 train_loss:3.4299 train_time:582291ms step_avg:717.99ms
step:822/1750 train_loss:3.5542 train_time:583048ms step_avg:718.04ms
step:823/1750 train_loss:3.6457 train_time:583796ms step_avg:718.08ms
step:824/1750 train_loss:3.3882 train_time:584550ms step_avg:718.12ms
step:825/1750 train_loss:3.5899 train_time:585314ms step_avg:718.18ms
step:826/1750 train_loss:3.6918 train_time:586070ms step_avg:718.22ms
step:827/1750 train_loss:3.4409 train_time:586861ms step_avg:718.31ms
step:828/1750 train_loss:3.5093 train_time:587632ms step_avg:718.38ms
step:829/1750 train_loss:3.5167 train_time:588388ms step_avg:718.42ms
step:830/1750 train_loss:3.6162 train_time:589138ms step_avg:718.46ms
step:831/1750 train_loss:3.4646 train_time:589900ms step_avg:718.51ms
step:832/1750 train_loss:3.5848 train_time:590666ms step_avg:718.57ms
step:833/1750 train_loss:3.6058 train_time:591435ms step_avg:718.63ms
step:834/1750 train_loss:3.6165 train_time:592185ms step_avg:718.67ms
step:835/1750 train_loss:3.4641 train_time:592981ms step_avg:718.76ms
step:836/1750 train_loss:3.6993 train_time:593738ms step_avg:718.81ms
step:837/1750 train_loss:3.4733 train_time:594491ms step_avg:718.85ms
step:838/1750 train_loss:3.3901 train_time:595238ms step_avg:718.89ms
step:839/1750 train_loss:3.6270 train_time:595989ms step_avg:718.92ms
step:840/1750 train_loss:3.5538 train_time:596742ms step_avg:718.97ms
step:841/1750 train_loss:3.6331 train_time:597494ms step_avg:719.01ms
step:842/1750 train_loss:3.5188 train_time:598246ms step_avg:719.05ms
step:843/1750 train_loss:3.5697 train_time:599010ms step_avg:719.10ms
step:844/1750 train_loss:3.5309 train_time:599759ms step_avg:719.14ms
step:845/1750 train_loss:3.5495 train_time:600528ms step_avg:719.20ms
step:846/1750 train_loss:3.5662 train_time:601289ms step_avg:719.25ms
step:847/1750 train_loss:3.6026 train_time:602052ms step_avg:719.30ms
step:848/1750 train_loss:3.5509 train_time:602813ms step_avg:719.35ms
step:849/1750 train_loss:3.3743 train_time:603572ms step_avg:719.39ms
step:850/1750 train_loss:3.5956 train_time:604330ms step_avg:719.44ms
step:851/1750 train_loss:3.4711 train_time:605090ms step_avg:719.49ms
step:852/1750 train_loss:3.5923 train_time:605867ms step_avg:719.56ms
step:853/1750 train_loss:3.3739 train_time:606609ms step_avg:719.58ms
step:854/1750 train_loss:3.6643 train_time:607359ms step_avg:719.62ms
step:855/1750 train_loss:3.5957 train_time:608096ms step_avg:719.64ms
step:856/1750 train_loss:3.3734 train_time:608845ms step_avg:719.68ms
step:857/1750 train_loss:3.6680 train_time:609626ms step_avg:719.75ms
step:858/1750 train_loss:3.6545 train_time:610391ms step_avg:719.80ms
step:859/1750 train_loss:3.3767 train_time:611157ms step_avg:719.85ms
step:860/1750 train_loss:3.5637 train_time:611918ms step_avg:719.90ms
step:861/1750 train_loss:3.6133 train_time:612682ms step_avg:719.95ms
step:862/1750 train_loss:3.4318 train_time:613436ms step_avg:719.99ms
step:863/1750 train_loss:3.5122 train_time:614208ms step_avg:720.06ms
step:864/1750 train_loss:3.8061 train_time:614987ms step_avg:720.13ms
step:865/1750 train_loss:3.7446 train_time:615785ms step_avg:720.22ms
step:866/1750 train_loss:3.5631 train_time:616536ms step_avg:720.25ms
step:867/1750 train_loss:3.5178 train_time:617278ms step_avg:720.28ms
step:868/1750 train_loss:3.7065 train_time:618046ms step_avg:720.33ms
step:869/1750 train_loss:3.4538 train_time:618821ms step_avg:720.40ms
step:870/1750 train_loss:3.4057 train_time:619587ms step_avg:720.45ms
step:871/1750 train_loss:3.5741 train_time:620336ms step_avg:720.48ms
step:872/1750 train_loss:3.5329 train_time:621095ms step_avg:720.53ms
step:873/1750 train_loss:3.4711 train_time:621848ms step_avg:720.57ms
step:874/1750 train_loss:3.6195 train_time:622599ms step_avg:720.60ms
step:875/1750 train_loss:3.5236 train_time:623364ms step_avg:720.65ms
step:875/1750 val_loss:3.5284 train_time:623378ms step_avg:720.67ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 256.37042 | frobenius_norm = 59005.98047 | spectral_norm = 10770.01465 | nuclear_norm = 1476730.87500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 149.87880 | spectral_norm = 25.86647 | nuclear_norm = 3459.01172
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 145.41425 | spectral_norm = 28.22353 | nuclear_norm = 3343.58838
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 285.23093 | spectral_norm = 19.06837 | nuclear_norm = 6929.44238
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 217.29276 | spectral_norm = 21.96916 | nuclear_norm = 5041.98486
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 321.64041 | spectral_norm = 26.15106 | nuclear_norm = 8544.95898
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 165.59521 | spectral_norm = 14.85875 | nuclear_norm = 4392.54004
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 150.71674 | spectral_norm = 13.97945 | nuclear_norm = 3490.85693
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 149.16579 | spectral_norm = 14.09640 | nuclear_norm = 3452.45190
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 276.12305 | spectral_norm = 23.58597 | nuclear_norm = 6353.95654
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 271.82098 | spectral_norm = 21.00578 | nuclear_norm = 6388.42871
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 324.71310 | spectral_norm = 22.81878 | nuclear_norm = 8654.78711
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 158.72794 | spectral_norm = 15.88692 | nuclear_norm = 4167.54102
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 147.81650 | spectral_norm = 15.79874 | nuclear_norm = 3396.50488
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 146.24223 | spectral_norm = 15.86171 | nuclear_norm = 3376.17969
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 273.02249 | spectral_norm = 23.80698 | nuclear_norm = 6239.46826
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 279.19400 | spectral_norm = 21.58156 | nuclear_norm = 6481.77344
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 329.33734 | spectral_norm = 25.70094 | nuclear_norm = 8751.95898
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 165.55959 | spectral_norm = 17.12945 | nuclear_norm = 4357.00879
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 144.82600 | spectral_norm = 13.70338 | nuclear_norm = 3236.65186
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 143.99634 | spectral_norm = 13.25286 | nuclear_norm = 3226.91211
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 289.68671 | spectral_norm = 26.15198 | nuclear_norm = 6542.03271
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 298.98511 | spectral_norm = 23.80772 | nuclear_norm = 7014.52051
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 332.26996 | spectral_norm = 28.82610 | nuclear_norm = 8830.61621
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 163.11853 | spectral_norm = 15.78465 | nuclear_norm = 4284.57812
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 143.33025 | spectral_norm = 14.68003 | nuclear_norm = 3229.22070
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 141.51570 | spectral_norm = 14.20525 | nuclear_norm = 3210.28857
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 288.77786 | spectral_norm = 24.88384 | nuclear_norm = 6572.96387
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 289.94556 | spectral_norm = 23.15269 | nuclear_norm = 6740.93262
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 340.75421 | spectral_norm = 26.59952 | nuclear_norm = 9057.39844
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 164.40868 | spectral_norm = 15.09546 | nuclear_norm = 4334.88379
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 150.67334 | spectral_norm = 14.14610 | nuclear_norm = 3469.29102
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 147.56496 | spectral_norm = 14.29678 | nuclear_norm = 3417.52344
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 294.81354 | spectral_norm = 27.13380 | nuclear_norm = 6683.64551
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 270.16248 | spectral_norm = 19.25159 | nuclear_norm = 6413.67139
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 352.08777 | spectral_norm = 24.48317 | nuclear_norm = 9376.01562
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 171.55533 | spectral_norm = 14.96939 | nuclear_norm = 4524.43359
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 143.39372 | spectral_norm = 14.84032 | nuclear_norm = 3238.27637
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 142.85065 | spectral_norm = 14.22501 | nuclear_norm = 3248.74072
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 301.45319 | spectral_norm = 26.17126 | nuclear_norm = 6875.59180
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 298.17615 | spectral_norm = 23.18069 | nuclear_norm = 7004.86621
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 330.45175 | spectral_norm = 25.20329 | nuclear_norm = 8815.41992
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 164.61317 | spectral_norm = 14.94600 | nuclear_norm = 4331.84619
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 146.45656 | spectral_norm = 15.28609 | nuclear_norm = 3354.22510
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 144.24719 | spectral_norm = 14.19477 | nuclear_norm = 3325.29443
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 288.33936 | spectral_norm = 23.75642 | nuclear_norm = 6531.75684
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 286.06522 | spectral_norm = 25.48063 | nuclear_norm = 6525.33691
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 336.19876 | spectral_norm = 25.74209 | nuclear_norm = 8945.10742
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 167.74718 | spectral_norm = 15.66996 | nuclear_norm = 4422.91504
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 147.99300 | spectral_norm = 15.30064 | nuclear_norm = 3348.42285
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 147.38461 | spectral_norm = 14.10645 | nuclear_norm = 3341.85547
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 308.18170 | spectral_norm = 27.68413 | nuclear_norm = 6927.67578
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 297.76593 | spectral_norm = 23.59132 | nuclear_norm = 6926.19824
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 335.58289 | spectral_norm = 26.40911 | nuclear_norm = 8926.54492
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 167.09860 | spectral_norm = 16.05500 | nuclear_norm = 4416.29395
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 146.54617 | spectral_norm = 15.83089 | nuclear_norm = 3229.58252
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 148.41051 | spectral_norm = 14.90347 | nuclear_norm = 3214.31641
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 322.64398 | spectral_norm = 27.72955 | nuclear_norm = 7414.75684
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 317.69397 | spectral_norm = 21.32428 | nuclear_norm = 7563.51367
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 322.00134 | spectral_norm = 26.27776 | nuclear_norm = 8568.53906
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 166.81245 | spectral_norm = 16.93347 | nuclear_norm = 4421.76562
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 149.06584 | spectral_norm = 16.39855 | nuclear_norm = 3326.83643
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 147.23666 | spectral_norm = 15.25282 | nuclear_norm = 3258.81152
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 297.83414 | spectral_norm = 27.57874 | nuclear_norm = 6802.03906
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 302.11002 | spectral_norm = 21.65535 | nuclear_norm = 7078.63867
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 335.24506 | spectral_norm = 24.82196 | nuclear_norm = 8933.47461
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 159.94241 | spectral_norm = 18.44897 | nuclear_norm = 4226.09375
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 154.42964 | spectral_norm = 18.30256 | nuclear_norm = 3490.60645
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 148.08801 | spectral_norm = 17.20261 | nuclear_norm = 3334.33496
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 289.03214 | spectral_norm = 27.60144 | nuclear_norm = 6620.74316
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 310.63092 | spectral_norm = 22.58132 | nuclear_norm = 7276.61328
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 349.42267 | spectral_norm = 26.36572 | nuclear_norm = 9294.68555
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 173.01517 | spectral_norm = 19.71872 | nuclear_norm = 4546.54492
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1094.83374 | spectral_norm = 171.72856 | nuclear_norm = 28625.20508
===========================================
step:876/1750 train_loss:3.6349 train_time:624130ms step_avg:720.70ms
step:877/1750 train_loss:3.4225 train_time:624882ms step_avg:720.74ms
step:878/1750 train_loss:3.6369 train_time:625642ms step_avg:720.79ms
step:879/1750 train_loss:3.5128 train_time:626385ms step_avg:720.81ms
step:880/1750 train_loss:3.8520 train_time:627139ms step_avg:720.85ms
step:881/1750 train_loss:3.5688 train_time:627884ms step_avg:720.88ms
step:882/1750 train_loss:3.3930 train_time:628627ms step_avg:720.90ms
step:883/1750 train_loss:3.7101 train_time:629392ms step_avg:720.95ms
step:884/1750 train_loss:3.4250 train_time:630147ms step_avg:720.99ms
step:885/1750 train_loss:3.6720 train_time:630890ms step_avg:721.02ms
step:886/1750 train_loss:3.5403 train_time:631665ms step_avg:721.08ms
step:887/1750 train_loss:3.5961 train_time:632436ms step_avg:721.14ms
step:888/1750 train_loss:3.5858 train_time:633186ms step_avg:721.17ms
step:889/1750 train_loss:3.6233 train_time:633941ms step_avg:721.21ms
step:890/1750 train_loss:3.5787 train_time:634737ms step_avg:721.29ms
step:891/1750 train_loss:3.4258 train_time:635494ms step_avg:721.33ms
step:892/1750 train_loss:3.5929 train_time:636257ms step_avg:721.38ms
step:893/1750 train_loss:3.5114 train_time:637021ms step_avg:721.43ms
step:894/1750 train_loss:3.5637 train_time:637774ms step_avg:721.46ms
step:895/1750 train_loss:3.4052 train_time:638529ms step_avg:721.50ms
step:896/1750 train_loss:3.2900 train_time:639316ms step_avg:721.58ms
step:897/1750 train_loss:3.4707 train_time:640096ms step_avg:721.64ms
step:898/1750 train_loss:3.6589 train_time:640879ms step_avg:721.71ms
step:899/1750 train_loss:3.5180 train_time:641636ms step_avg:721.75ms
step:900/1750 train_loss:3.5878 train_time:642414ms step_avg:721.81ms
step:901/1750 train_loss:3.7292 train_time:643167ms step_avg:721.85ms
step:902/1750 train_loss:3.5171 train_time:643936ms step_avg:721.90ms
step:903/1750 train_loss:3.4601 train_time:644695ms step_avg:721.94ms
step:904/1750 train_loss:3.6898 train_time:645484ms step_avg:722.02ms
step:905/1750 train_loss:3.6334 train_time:646234ms step_avg:722.05ms
step:906/1750 train_loss:3.4745 train_time:646997ms step_avg:722.10ms
step:907/1750 train_loss:3.4844 train_time:647759ms step_avg:722.14ms
step:908/1750 train_loss:3.7706 train_time:648556ms step_avg:722.22ms
step:909/1750 train_loss:3.4924 train_time:649322ms step_avg:722.27ms
step:910/1750 train_loss:3.6759 train_time:650084ms step_avg:722.32ms
step:911/1750 train_loss:3.8663 train_time:650876ms step_avg:722.39ms
step:912/1750 train_loss:3.3315 train_time:651623ms step_avg:722.42ms
step:913/1750 train_loss:3.6520 train_time:652385ms step_avg:722.46ms
step:914/1750 train_loss:3.4986 train_time:653172ms step_avg:722.54ms
step:915/1750 train_loss:3.5894 train_time:653959ms step_avg:722.61ms
step:916/1750 train_loss:3.7146 train_time:654743ms step_avg:722.67ms
step:917/1750 train_loss:3.4918 train_time:655506ms step_avg:722.72ms
step:918/1750 train_loss:3.4754 train_time:656306ms step_avg:722.80ms
step:919/1750 train_loss:3.5703 train_time:657078ms step_avg:722.86ms
step:920/1750 train_loss:3.4644 train_time:657859ms step_avg:722.92ms
step:921/1750 train_loss:3.5079 train_time:658648ms step_avg:722.99ms
step:922/1750 train_loss:3.4690 train_time:659401ms step_avg:723.03ms
step:923/1750 train_loss:3.6286 train_time:660165ms step_avg:723.07ms
step:924/1750 train_loss:3.4823 train_time:660915ms step_avg:723.10ms
step:925/1750 train_loss:3.4856 train_time:661671ms step_avg:723.14ms
step:926/1750 train_loss:3.6098 train_time:662454ms step_avg:723.20ms
step:927/1750 train_loss:3.4760 train_time:663218ms step_avg:723.25ms
step:928/1750 train_loss:3.6683 train_time:663993ms step_avg:723.30ms
step:929/1750 train_loss:3.5454 train_time:664740ms step_avg:723.33ms
step:930/1750 train_loss:3.3836 train_time:665513ms step_avg:723.38ms
step:931/1750 train_loss:3.6955 train_time:666270ms step_avg:723.42ms
step:932/1750 train_loss:3.3923 train_time:667026ms step_avg:723.46ms
step:933/1750 train_loss:3.3563 train_time:667792ms step_avg:723.50ms
step:934/1750 train_loss:3.5945 train_time:668570ms step_avg:723.56ms
step:935/1750 train_loss:3.5438 train_time:669328ms step_avg:723.60ms
step:936/1750 train_loss:3.3933 train_time:670142ms step_avg:723.70ms
step:937/1750 train_loss:3.3424 train_time:670916ms step_avg:723.75ms
step:938/1750 train_loss:3.5196 train_time:671675ms step_avg:723.79ms
step:939/1750 train_loss:3.3139 train_time:672437ms step_avg:723.83ms
step:940/1750 train_loss:3.5991 train_time:673186ms step_avg:723.86ms
step:941/1750 train_loss:3.4461 train_time:673977ms step_avg:723.93ms
step:942/1750 train_loss:3.4414 train_time:674761ms step_avg:723.99ms
step:943/1750 train_loss:3.5631 train_time:675554ms step_avg:724.07ms
step:944/1750 train_loss:3.4417 train_time:676312ms step_avg:724.10ms
step:945/1750 train_loss:3.4582 train_time:677083ms step_avg:724.15ms
step:946/1750 train_loss:3.6152 train_time:677864ms step_avg:724.21ms
step:947/1750 train_loss:3.5332 train_time:678632ms step_avg:724.26ms
step:948/1750 train_loss:3.6011 train_time:679415ms step_avg:724.32ms
step:949/1750 train_loss:3.7598 train_time:680182ms step_avg:724.37ms
step:950/1750 train_loss:3.3980 train_time:681159ms step_avg:724.64ms
step:951/1750 train_loss:3.4625 train_time:681918ms step_avg:724.67ms
step:952/1750 train_loss:3.6986 train_time:682684ms step_avg:724.72ms
step:953/1750 train_loss:3.4212 train_time:683428ms step_avg:724.74ms
step:954/1750 train_loss:3.4841 train_time:684213ms step_avg:724.80ms
step:955/1750 train_loss:3.5805 train_time:685006ms step_avg:724.87ms
step:956/1750 train_loss:3.4585 train_time:685771ms step_avg:724.92ms
step:957/1750 train_loss:3.4903 train_time:686521ms step_avg:724.94ms
step:958/1750 train_loss:3.4599 train_time:687316ms step_avg:725.02ms
step:959/1750 train_loss:3.5144 train_time:688098ms step_avg:725.08ms
step:960/1750 train_loss:3.5182 train_time:688861ms step_avg:725.12ms
step:961/1750 train_loss:3.5250 train_time:689628ms step_avg:725.16ms
step:962/1750 train_loss:3.4097 train_time:690426ms step_avg:725.24ms
step:963/1750 train_loss:3.6650 train_time:691191ms step_avg:725.28ms
step:964/1750 train_loss:3.6228 train_time:691944ms step_avg:725.31ms
step:965/1750 train_loss:3.4288 train_time:692710ms step_avg:725.35ms
step:966/1750 train_loss:3.4359 train_time:693496ms step_avg:725.41ms
step:967/1750 train_loss:3.4972 train_time:694248ms step_avg:725.44ms
step:968/1750 train_loss:3.7327 train_time:695017ms step_avg:725.49ms
step:969/1750 train_loss:3.5380 train_time:695782ms step_avg:725.53ms
step:970/1750 train_loss:3.5314 train_time:696533ms step_avg:725.55ms
step:971/1750 train_loss:3.5977 train_time:697319ms step_avg:725.62ms
step:972/1750 train_loss:3.3890 train_time:698091ms step_avg:725.67ms
step:973/1750 train_loss:3.5520 train_time:698858ms step_avg:725.71ms
step:974/1750 train_loss:3.4959 train_time:699619ms step_avg:725.75ms
step:975/1750 train_loss:3.5591 train_time:700396ms step_avg:725.80ms
step:976/1750 train_loss:3.6040 train_time:701156ms step_avg:725.83ms
step:977/1750 train_loss:3.4830 train_time:701923ms step_avg:725.88ms
step:978/1750 train_loss:3.6828 train_time:702676ms step_avg:725.90ms
step:979/1750 train_loss:3.5930 train_time:703431ms step_avg:725.93ms
step:980/1750 train_loss:3.3728 train_time:704189ms step_avg:725.97ms
step:981/1750 train_loss:3.6284 train_time:704951ms step_avg:726.00ms
step:982/1750 train_loss:3.4381 train_time:705710ms step_avg:726.04ms
step:983/1750 train_loss:3.5933 train_time:706460ms step_avg:726.06ms
step:984/1750 train_loss:3.5645 train_time:707236ms step_avg:726.12ms
step:985/1750 train_loss:3.5193 train_time:708043ms step_avg:726.20ms
step:986/1750 train_loss:3.5113 train_time:708811ms step_avg:726.24ms
step:987/1750 train_loss:3.6013 train_time:709589ms step_avg:726.29ms
step:988/1750 train_loss:3.4418 train_time:710348ms step_avg:726.33ms
step:989/1750 train_loss:3.5151 train_time:711120ms step_avg:726.37ms
step:990/1750 train_loss:3.5501 train_time:711875ms step_avg:726.40ms
step:991/1750 train_loss:3.4378 train_time:712670ms step_avg:726.47ms
step:992/1750 train_loss:3.6837 train_time:713473ms step_avg:726.55ms
step:993/1750 train_loss:3.4981 train_time:714226ms step_avg:726.58ms
step:994/1750 train_loss:3.4662 train_time:714985ms step_avg:726.61ms
step:995/1750 train_loss:3.5237 train_time:715806ms step_avg:726.71ms
step:996/1750 train_loss:3.6169 train_time:716561ms step_avg:726.74ms
step:997/1750 train_loss:3.5599 train_time:717311ms step_avg:726.76ms
step:998/1750 train_loss:3.4832 train_time:718071ms step_avg:726.79ms
step:999/1750 train_loss:3.7813 train_time:718825ms step_avg:726.82ms
step:1000/1750 train_loss:3.4643 train_time:719595ms step_avg:726.86ms
step:1000/1750 val_loss:3.4928 train_time:719609ms step_avg:726.88ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 269.25436 | frobenius_norm = 62028.78906 | spectral_norm = 11262.09961 | nuclear_norm = 1555375.12500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 162.05295 | spectral_norm = 29.06038 | nuclear_norm = 3731.30908
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 157.64496 | spectral_norm = 31.66174 | nuclear_norm = 3618.06421
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 306.46759 | spectral_norm = 20.78831 | nuclear_norm = 7469.61572
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 226.55255 | spectral_norm = 23.86352 | nuclear_norm = 5242.57178
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 350.49908 | spectral_norm = 28.84666 | nuclear_norm = 9313.71875
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 179.56981 | spectral_norm = 16.50921 | nuclear_norm = 4762.79639
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 163.77837 | spectral_norm = 15.43469 | nuclear_norm = 3787.17383
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 161.95798 | spectral_norm = 15.66561 | nuclear_norm = 3743.65869
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 296.49100 | spectral_norm = 25.40774 | nuclear_norm = 6818.39453
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 291.27710 | spectral_norm = 22.77716 | nuclear_norm = 6842.83691
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 351.30994 | spectral_norm = 25.23658 | nuclear_norm = 9369.08789
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 171.50766 | spectral_norm = 17.41423 | nuclear_norm = 4500.60938
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 160.15703 | spectral_norm = 17.62422 | nuclear_norm = 3670.12622
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 158.66931 | spectral_norm = 17.33234 | nuclear_norm = 3657.66357
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 294.26294 | spectral_norm = 25.76517 | nuclear_norm = 6725.20898
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 300.40765 | spectral_norm = 23.20572 | nuclear_norm = 6974.02832
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 355.80444 | spectral_norm = 28.88425 | nuclear_norm = 9453.23535
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 179.30489 | spectral_norm = 18.80478 | nuclear_norm = 4717.24512
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 156.71246 | spectral_norm = 15.02079 | nuclear_norm = 3486.47949
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 155.86768 | spectral_norm = 14.60004 | nuclear_norm = 3479.60815
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 313.09302 | spectral_norm = 28.63749 | nuclear_norm = 7066.82129
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 322.53067 | spectral_norm = 26.15454 | nuclear_norm = 7567.78027
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 358.96390 | spectral_norm = 32.21068 | nuclear_norm = 9539.00391
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 176.58069 | spectral_norm = 17.46967 | nuclear_norm = 4637.01367
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 155.23248 | spectral_norm = 16.13336 | nuclear_norm = 3487.08252
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 153.13368 | spectral_norm = 15.48168 | nuclear_norm = 3465.60156
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 313.27396 | spectral_norm = 27.03133 | nuclear_norm = 7134.81738
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 313.54987 | spectral_norm = 25.15616 | nuclear_norm = 7293.16016
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 367.92209 | spectral_norm = 29.67707 | nuclear_norm = 9778.01562
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 177.99483 | spectral_norm = 16.45498 | nuclear_norm = 4693.88037
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 163.19730 | spectral_norm = 15.58881 | nuclear_norm = 3749.36182
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 159.64854 | spectral_norm = 15.64239 | nuclear_norm = 3692.09521
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 319.09799 | spectral_norm = 29.12420 | nuclear_norm = 7230.83301
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 290.75232 | spectral_norm = 20.69504 | nuclear_norm = 6912.26074
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 381.79477 | spectral_norm = 26.59225 | nuclear_norm = 10169.25000
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 186.25974 | spectral_norm = 16.50145 | nuclear_norm = 4913.42090
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 155.06831 | spectral_norm = 16.46511 | nuclear_norm = 3489.21802
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 154.25175 | spectral_norm = 15.55418 | nuclear_norm = 3499.63525
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 326.49924 | spectral_norm = 28.03210 | nuclear_norm = 7453.06787
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 322.82104 | spectral_norm = 24.69093 | nuclear_norm = 7584.82178
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 357.41626 | spectral_norm = 27.25247 | nuclear_norm = 9538.97070
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 178.18822 | spectral_norm = 16.59490 | nuclear_norm = 4689.36523
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 158.62515 | spectral_norm = 16.83117 | nuclear_norm = 3621.66064
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 156.03099 | spectral_norm = 15.53048 | nuclear_norm = 3591.02832
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 312.60162 | spectral_norm = 25.67880 | nuclear_norm = 7087.33936
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 308.97650 | spectral_norm = 27.59506 | nuclear_norm = 7036.00488
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 363.91483 | spectral_norm = 27.97836 | nuclear_norm = 9683.29004
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 181.70639 | spectral_norm = 17.62415 | nuclear_norm = 4789.69824
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 160.33688 | spectral_norm = 16.79075 | nuclear_norm = 3618.26514
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 159.44928 | spectral_norm = 15.40014 | nuclear_norm = 3606.58276
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 332.75845 | spectral_norm = 30.03252 | nuclear_norm = 7475.70557
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 320.27130 | spectral_norm = 25.44312 | nuclear_norm = 7445.18359
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 364.49884 | spectral_norm = 29.29222 | nuclear_norm = 9692.86328
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 181.20772 | spectral_norm = 18.03818 | nuclear_norm = 4787.22461
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 158.80298 | spectral_norm = 17.50774 | nuclear_norm = 3484.56934
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 161.04915 | spectral_norm = 16.57084 | nuclear_norm = 3469.66992
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 347.77213 | spectral_norm = 30.73566 | nuclear_norm = 7978.65186
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 342.04684 | spectral_norm = 22.95551 | nuclear_norm = 8144.80078
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 349.63171 | spectral_norm = 29.05448 | nuclear_norm = 9299.58496
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 181.30641 | spectral_norm = 18.85278 | nuclear_norm = 4805.37012
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 161.33183 | spectral_norm = 18.10676 | nuclear_norm = 3585.91187
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 159.64685 | spectral_norm = 16.79251 | nuclear_norm = 3514.03076
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 320.96442 | spectral_norm = 30.52811 | nuclear_norm = 7318.80273
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 325.80872 | spectral_norm = 23.34635 | nuclear_norm = 7626.77979
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 364.56161 | spectral_norm = 27.42923 | nuclear_norm = 9712.45898
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 173.14378 | spectral_norm = 20.66609 | nuclear_norm = 4574.36328
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 167.37546 | spectral_norm = 20.27162 | nuclear_norm = 3765.25220
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 160.33615 | spectral_norm = 19.05933 | nuclear_norm = 3594.49219
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 313.37152 | spectral_norm = 30.50575 | nuclear_norm = 7166.72363
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 336.98422 | spectral_norm = 24.43017 | nuclear_norm = 7893.32324
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 379.81757 | spectral_norm = 28.95777 | nuclear_norm = 10099.92285
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 189.07570 | spectral_norm = 22.20868 | nuclear_norm = 4966.37646
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1172.87061 | spectral_norm = 171.99898 | nuclear_norm = 30764.76758
===========================================
step:1001/1750 train_loss:3.6111 train_time:720343ms step_avg:726.89ms
step:1002/1750 train_loss:3.4625 train_time:721086ms step_avg:726.90ms
step:1003/1750 train_loss:3.5329 train_time:721843ms step_avg:726.93ms
step:1004/1750 train_loss:3.4085 train_time:722631ms step_avg:726.99ms
step:1005/1750 train_loss:3.5728 train_time:723411ms step_avg:727.05ms
step:1006/1750 train_loss:3.6310 train_time:724194ms step_avg:727.10ms
step:1007/1750 train_loss:3.4169 train_time:724964ms step_avg:727.15ms
step:1008/1750 train_loss:3.4864 train_time:725727ms step_avg:727.18ms
step:1009/1750 train_loss:3.4640 train_time:726494ms step_avg:727.22ms
step:1010/1750 train_loss:3.5885 train_time:727279ms step_avg:727.28ms
step:1011/1750 train_loss:3.6902 train_time:728085ms step_avg:727.36ms
step:1012/1750 train_loss:3.5870 train_time:728859ms step_avg:727.40ms
step:1013/1750 train_loss:3.5654 train_time:729617ms step_avg:727.43ms
step:1014/1750 train_loss:3.4209 train_time:730399ms step_avg:727.49ms
step:1015/1750 train_loss:3.5634 train_time:731143ms step_avg:727.50ms
step:1016/1750 train_loss:3.6537 train_time:731896ms step_avg:727.53ms
step:1017/1750 train_loss:3.3535 train_time:732657ms step_avg:727.56ms
step:1018/1750 train_loss:3.4397 train_time:733447ms step_avg:727.63ms
step:1019/1750 train_loss:3.4265 train_time:734238ms step_avg:727.69ms
step:1020/1750 train_loss:3.4259 train_time:734991ms step_avg:727.71ms
step:1021/1750 train_loss:3.5507 train_time:735755ms step_avg:727.75ms
step:1022/1750 train_loss:3.4167 train_time:736523ms step_avg:727.79ms
step:1023/1750 train_loss:3.3810 train_time:737293ms step_avg:727.83ms
step:1024/1750 train_loss:3.5094 train_time:738058ms step_avg:727.87ms
step:1025/1750 train_loss:3.5347 train_time:738846ms step_avg:727.93ms
step:1026/1750 train_loss:3.5038 train_time:739631ms step_avg:727.98ms
step:1027/1750 train_loss:3.5077 train_time:740411ms step_avg:728.03ms
step:1028/1750 train_loss:3.6501 train_time:741165ms step_avg:728.06ms
step:1029/1750 train_loss:3.3536 train_time:741951ms step_avg:728.12ms
step:1030/1750 train_loss:3.4302 train_time:742768ms step_avg:728.20ms
step:1031/1750 train_loss:3.3453 train_time:743546ms step_avg:728.25ms
step:1032/1750 train_loss:3.5680 train_time:744292ms step_avg:728.27ms
step:1033/1750 train_loss:3.5520 train_time:745064ms step_avg:728.31ms
step:1034/1750 train_loss:3.7314 train_time:745854ms step_avg:728.37ms
step:1035/1750 train_loss:3.5254 train_time:746621ms step_avg:728.41ms
step:1036/1750 train_loss:3.4410 train_time:747419ms step_avg:728.48ms
step:1037/1750 train_loss:3.4813 train_time:748199ms step_avg:728.53ms
step:1038/1750 train_loss:3.5169 train_time:748963ms step_avg:728.56ms
step:1039/1750 train_loss:3.8110 train_time:749730ms step_avg:728.60ms
step:1040/1750 train_loss:3.6599 train_time:750499ms step_avg:728.64ms
step:1041/1750 train_loss:3.5480 train_time:751266ms step_avg:728.68ms
step:1042/1750 train_loss:3.4535 train_time:752033ms step_avg:728.71ms
step:1043/1750 train_loss:3.5235 train_time:752819ms step_avg:728.77ms
step:1044/1750 train_loss:3.5627 train_time:753608ms step_avg:728.83ms
step:1045/1750 train_loss:3.4801 train_time:754360ms step_avg:728.85ms
step:1046/1750 train_loss:3.4876 train_time:755117ms step_avg:728.88ms
step:1047/1750 train_loss:3.5509 train_time:755896ms step_avg:728.93ms
step:1048/1750 train_loss:3.4641 train_time:756664ms step_avg:728.96ms
step:1049/1750 train_loss:3.6700 train_time:757433ms step_avg:729.00ms
step:1050/1750 train_loss:3.5375 train_time:758215ms step_avg:729.05ms
step:1051/1750 train_loss:3.4414 train_time:758981ms step_avg:729.09ms
step:1052/1750 train_loss:3.4331 train_time:759752ms step_avg:729.13ms
step:1053/1750 train_loss:3.5439 train_time:760512ms step_avg:729.16ms
step:1054/1750 train_loss:3.3907 train_time:761279ms step_avg:729.19ms
step:1055/1750 train_loss:3.7299 train_time:762026ms step_avg:729.21ms
step:1056/1750 train_loss:3.5707 train_time:762797ms step_avg:729.25ms
step:1057/1750 train_loss:3.4141 train_time:763567ms step_avg:729.29ms
step:1058/1750 train_loss:3.5412 train_time:764345ms step_avg:729.34ms
step:1059/1750 train_loss:3.6235 train_time:765098ms step_avg:729.36ms
step:1060/1750 train_loss:3.3434 train_time:765884ms step_avg:729.41ms
step:1061/1750 train_loss:3.3951 train_time:766681ms step_avg:729.48ms
step:1062/1750 train_loss:3.4783 train_time:767440ms step_avg:729.51ms
step:1063/1750 train_loss:3.4593 train_time:768207ms step_avg:729.54ms
step:1064/1750 train_loss:3.4211 train_time:768970ms step_avg:729.57ms
step:1065/1750 train_loss:3.5063 train_time:769728ms step_avg:729.60ms
step:1066/1750 train_loss:3.4255 train_time:770491ms step_avg:729.63ms
step:1067/1750 train_loss:3.3925 train_time:771256ms step_avg:729.67ms
step:1068/1750 train_loss:3.4543 train_time:772030ms step_avg:729.71ms
step:1069/1750 train_loss:3.3258 train_time:772810ms step_avg:729.75ms
step:1070/1750 train_loss:3.4751 train_time:773565ms step_avg:729.78ms
step:1071/1750 train_loss:3.3467 train_time:774354ms step_avg:729.83ms
step:1072/1750 train_loss:3.6152 train_time:775103ms step_avg:729.85ms
step:1073/1750 train_loss:3.5567 train_time:775906ms step_avg:729.92ms
step:1074/1750 train_loss:3.4837 train_time:776668ms step_avg:729.95ms
step:1075/1750 train_loss:3.5719 train_time:777428ms step_avg:729.98ms
step:1076/1750 train_loss:3.4808 train_time:778212ms step_avg:730.03ms
step:1077/1750 train_loss:3.4409 train_time:778972ms step_avg:730.06ms
step:1078/1750 train_loss:3.8370 train_time:779723ms step_avg:730.08ms
step:1079/1750 train_loss:3.4758 train_time:780486ms step_avg:730.11ms
step:1080/1750 train_loss:3.1069 train_time:781309ms step_avg:730.19ms
step:1081/1750 train_loss:3.5757 train_time:782064ms step_avg:730.22ms
step:1082/1750 train_loss:3.4714 train_time:782840ms step_avg:730.26ms
step:1083/1750 train_loss:3.5618 train_time:783642ms step_avg:730.33ms
step:1084/1750 train_loss:3.6327 train_time:784412ms step_avg:730.36ms
step:1085/1750 train_loss:3.5455 train_time:785166ms step_avg:730.39ms
step:1086/1750 train_loss:3.5132 train_time:785929ms step_avg:730.42ms
step:1087/1750 train_loss:3.4782 train_time:786692ms step_avg:730.45ms
step:1088/1750 train_loss:3.6756 train_time:787484ms step_avg:730.50ms
step:1089/1750 train_loss:3.5637 train_time:788279ms step_avg:730.56ms
step:1090/1750 train_loss:3.4120 train_time:789041ms step_avg:730.59ms
step:1091/1750 train_loss:3.4332 train_time:789819ms step_avg:730.64ms
step:1092/1750 train_loss:3.5384 train_time:790589ms step_avg:730.67ms
step:1093/1750 train_loss:3.3341 train_time:791353ms step_avg:730.70ms
step:1094/1750 train_loss:3.5458 train_time:792110ms step_avg:730.73ms
step:1095/1750 train_loss:3.6492 train_time:792871ms step_avg:730.76ms
step:1096/1750 train_loss:3.4929 train_time:793653ms step_avg:730.80ms
step:1097/1750 train_loss:3.4645 train_time:794413ms step_avg:730.83ms
step:1098/1750 train_loss:3.4751 train_time:795193ms step_avg:730.88ms
step:1099/1750 train_loss:3.5398 train_time:795945ms step_avg:730.90ms
step:1100/1750 train_loss:3.6057 train_time:796740ms step_avg:730.95ms
step:1101/1750 train_loss:3.5812 train_time:797522ms step_avg:731.00ms
step:1102/1750 train_loss:3.4876 train_time:798304ms step_avg:731.05ms
step:1103/1750 train_loss:3.3425 train_time:799067ms step_avg:731.08ms
step:1104/1750 train_loss:3.3469 train_time:799857ms step_avg:731.13ms
step:1105/1750 train_loss:3.4948 train_time:800643ms step_avg:731.18ms
step:1106/1750 train_loss:3.3697 train_time:801399ms step_avg:731.20ms
step:1107/1750 train_loss:4.1117 train_time:802197ms step_avg:731.26ms
step:1108/1750 train_loss:3.2807 train_time:802961ms step_avg:731.29ms
step:1109/1750 train_loss:3.6158 train_time:803734ms step_avg:731.33ms
step:1110/1750 train_loss:3.3940 train_time:804491ms step_avg:731.36ms
step:1111/1750 train_loss:3.5530 train_time:805235ms step_avg:731.37ms
step:1112/1750 train_loss:3.4858 train_time:805992ms step_avg:731.39ms
step:1113/1750 train_loss:3.5406 train_time:806780ms step_avg:731.44ms
step:1114/1750 train_loss:3.6193 train_time:807549ms step_avg:731.48ms
step:1115/1750 train_loss:3.4972 train_time:808300ms step_avg:731.49ms
step:1116/1750 train_loss:3.4149 train_time:809071ms step_avg:731.53ms
step:1117/1750 train_loss:3.2894 train_time:809906ms step_avg:731.62ms
step:1118/1750 train_loss:3.4745 train_time:810646ms step_avg:731.63ms
step:1119/1750 train_loss:3.6518 train_time:811451ms step_avg:731.70ms
step:1120/1750 train_loss:3.6864 train_time:812212ms step_avg:731.72ms
step:1121/1750 train_loss:3.5394 train_time:812966ms step_avg:731.74ms
step:1122/1750 train_loss:3.5444 train_time:813733ms step_avg:731.77ms
step:1123/1750 train_loss:3.4398 train_time:814486ms step_avg:731.79ms
step:1124/1750 train_loss:3.5111 train_time:815226ms step_avg:731.80ms
step:1125/1750 train_loss:3.6460 train_time:816019ms step_avg:731.86ms
step:1125/1750 val_loss:3.4669 train_time:816032ms step_avg:731.87ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 281.01544 | frobenius_norm = 64790.47266 | spectral_norm = 11724.09668 | nuclear_norm = 1627497.12500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 173.26773 | spectral_norm = 32.01152 | nuclear_norm = 3982.59131
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 168.83676 | spectral_norm = 34.84774 | nuclear_norm = 3868.26758
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 326.18250 | spectral_norm = 22.44708 | nuclear_norm = 7972.68896
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 235.26759 | spectral_norm = 25.50881 | nuclear_norm = 5429.66309
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 378.51541 | spectral_norm = 31.51078 | nuclear_norm = 10059.41797
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 192.54439 | spectral_norm = 18.03342 | nuclear_norm = 5106.54150
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 175.78180 | spectral_norm = 16.57845 | nuclear_norm = 4059.64014
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 173.88086 | spectral_norm = 16.91118 | nuclear_norm = 4014.68140
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 315.54623 | spectral_norm = 27.24476 | nuclear_norm = 7247.72119
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 309.43219 | spectral_norm = 24.38028 | nuclear_norm = 7269.95605
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 376.52304 | spectral_norm = 27.41671 | nuclear_norm = 10047.13379
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 183.46231 | spectral_norm = 18.82754 | nuclear_norm = 4812.92334
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 171.81613 | spectral_norm = 19.24732 | nuclear_norm = 3929.59424
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 170.30965 | spectral_norm = 18.71898 | nuclear_norm = 3920.68213
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 314.44888 | spectral_norm = 27.63704 | nuclear_norm = 7185.91699
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 320.50134 | spectral_norm = 24.89359 | nuclear_norm = 7441.30273
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 380.71054 | spectral_norm = 31.74204 | nuclear_norm = 10113.87695
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 192.09528 | spectral_norm = 20.35389 | nuclear_norm = 5052.92969
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 167.78224 | spectral_norm = 16.29920 | nuclear_norm = 3720.94824
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 166.88829 | spectral_norm = 15.74782 | nuclear_norm = 3715.03760
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 335.47382 | spectral_norm = 30.87096 | nuclear_norm = 7568.53711
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 344.92719 | spectral_norm = 28.05559 | nuclear_norm = 8092.84863
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 384.10132 | spectral_norm = 35.34310 | nuclear_norm = 10206.48828
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 189.01216 | spectral_norm = 18.97047 | nuclear_norm = 4962.29395
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 166.34726 | spectral_norm = 17.51588 | nuclear_norm = 3727.25391
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 163.97447 | spectral_norm = 16.70109 | nuclear_norm = 3704.75635
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 336.49948 | spectral_norm = 29.18391 | nuclear_norm = 7666.98486
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 336.06995 | spectral_norm = 27.13858 | nuclear_norm = 7819.24170
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 393.54099 | spectral_norm = 32.51534 | nuclear_norm = 10459.25195
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 190.65932 | spectral_norm = 17.84178 | nuclear_norm = 5029.26270
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 174.95865 | spectral_norm = 16.93433 | nuclear_norm = 4013.10400
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 170.97186 | spectral_norm = 16.85854 | nuclear_norm = 3949.72363
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 341.81400 | spectral_norm = 31.06502 | nuclear_norm = 7746.81055
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 309.97763 | spectral_norm = 21.83326 | nuclear_norm = 7379.14941
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 409.67920 | spectral_norm = 28.64177 | nuclear_norm = 10914.40039
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 200.04280 | spectral_norm = 17.94779 | nuclear_norm = 5279.45264
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 165.92393 | spectral_norm = 17.80645 | nuclear_norm = 3722.95386
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 165.00807 | spectral_norm = 16.69980 | nuclear_norm = 3734.08936
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 350.32324 | spectral_norm = 30.11735 | nuclear_norm = 8003.75049
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 346.00995 | spectral_norm = 26.23818 | nuclear_norm = 8131.34570
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 382.65717 | spectral_norm = 29.17505 | nuclear_norm = 10215.97754
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 190.77119 | spectral_norm = 18.09471 | nuclear_norm = 5021.47656
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 170.11974 | spectral_norm = 18.35317 | nuclear_norm = 3875.05176
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 167.02600 | spectral_norm = 16.96062 | nuclear_norm = 3838.34668
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 335.60382 | spectral_norm = 27.57544 | nuclear_norm = 7612.42969
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 330.80508 | spectral_norm = 29.56872 | nuclear_norm = 7525.48242
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 390.20749 | spectral_norm = 30.04750 | nuclear_norm = 10382.78320
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 194.64600 | spectral_norm = 19.48366 | nuclear_norm = 5129.41553
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 171.63881 | spectral_norm = 18.18794 | nuclear_norm = 3862.51587
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 170.72714 | spectral_norm = 16.70229 | nuclear_norm = 3855.21631
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 355.21698 | spectral_norm = 32.23495 | nuclear_norm = 7973.83789
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 341.12338 | spectral_norm = 27.02945 | nuclear_norm = 7924.50879
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 392.03616 | spectral_norm = 32.05595 | nuclear_norm = 10422.41016
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 194.23987 | spectral_norm = 19.91666 | nuclear_norm = 5129.61719
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 170.22594 | spectral_norm = 19.07369 | nuclear_norm = 3725.11841
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 172.98474 | spectral_norm = 17.93034 | nuclear_norm = 3715.54370
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 370.71194 | spectral_norm = 33.69788 | nuclear_norm = 8493.64648
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 364.61899 | spectral_norm = 24.48359 | nuclear_norm = 8684.83594
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 375.79034 | spectral_norm = 31.78996 | nuclear_norm = 9991.38184
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 194.73567 | spectral_norm = 20.58523 | nuclear_norm = 5161.25000
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 172.55579 | spectral_norm = 19.78186 | nuclear_norm = 3817.28076
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 171.06271 | spectral_norm = 18.33223 | nuclear_norm = 3750.05371
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 343.24637 | spectral_norm = 33.15272 | nuclear_norm = 7816.00146
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 348.40869 | spectral_norm = 25.12137 | nuclear_norm = 8150.55469
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 392.01852 | spectral_norm = 29.88404 | nuclear_norm = 10441.75195
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 185.39407 | spectral_norm = 22.66798 | nuclear_norm = 4896.83301
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 179.17618 | spectral_norm = 22.24463 | nuclear_norm = 4014.43335
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 171.73524 | spectral_norm = 20.84083 | nuclear_norm = 3834.91650
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 336.19101 | spectral_norm = 33.34416 | nuclear_norm = 7677.69531
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 362.08859 | spectral_norm = 26.29860 | nuclear_norm = 8477.33594
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 407.88135 | spectral_norm = 31.21749 | nuclear_norm = 10843.78516
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 204.10519 | spectral_norm = 24.57226 | nuclear_norm = 5359.83496
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1244.85071 | spectral_norm = 171.90855 | nuclear_norm = 32744.27734
===========================================
step:1126/1750 train_loss:3.4015 train_time:816793ms step_avg:731.89ms
step:1127/1750 train_loss:3.2659 train_time:817574ms step_avg:731.94ms
step:1128/1750 train_loss:3.5363 train_time:818369ms step_avg:731.99ms
step:1129/1750 train_loss:3.7324 train_time:819134ms step_avg:732.02ms
step:1130/1750 train_loss:3.2921 train_time:819914ms step_avg:732.07ms
step:1131/1750 train_loss:3.6144 train_time:820685ms step_avg:732.10ms
step:1132/1750 train_loss:3.4348 train_time:821437ms step_avg:732.12ms
step:1133/1750 train_loss:3.4565 train_time:822198ms step_avg:732.14ms
step:1134/1750 train_loss:3.4185 train_time:822950ms step_avg:732.16ms
step:1135/1750 train_loss:3.5358 train_time:823763ms step_avg:732.23ms
step:1136/1750 train_loss:3.5056 train_time:824524ms step_avg:732.26ms
step:1137/1750 train_loss:3.5791 train_time:825297ms step_avg:732.30ms
step:1138/1750 train_loss:3.6134 train_time:826082ms step_avg:732.34ms
step:1139/1750 train_loss:3.5132 train_time:826865ms step_avg:732.39ms
step:1140/1750 train_loss:3.4095 train_time:827829ms step_avg:732.59ms
step:1141/1750 train_loss:3.7058 train_time:828595ms step_avg:732.62ms
step:1142/1750 train_loss:3.5232 train_time:829353ms step_avg:732.64ms
step:1143/1750 train_loss:3.5880 train_time:830310ms step_avg:732.84ms
step:1144/1750 train_loss:3.6235 train_time:831068ms step_avg:732.86ms
step:1145/1750 train_loss:3.2058 train_time:831848ms step_avg:732.91ms
step:1146/1750 train_loss:3.5516 train_time:832626ms step_avg:732.95ms
step:1147/1750 train_loss:3.4099 train_time:833392ms step_avg:732.97ms
step:1148/1750 train_loss:3.4523 train_time:834145ms step_avg:732.99ms
step:1149/1750 train_loss:3.5179 train_time:834904ms step_avg:733.01ms
step:1150/1750 train_loss:3.5919 train_time:835663ms step_avg:733.04ms
step:1151/1750 train_loss:3.5537 train_time:836423ms step_avg:733.06ms
step:1152/1750 train_loss:3.4470 train_time:837215ms step_avg:733.11ms
step:1153/1750 train_loss:3.4125 train_time:838006ms step_avg:733.16ms
step:1154/1750 train_loss:3.6400 train_time:838768ms step_avg:733.19ms
step:1155/1750 train_loss:3.6434 train_time:839545ms step_avg:733.23ms
step:1156/1750 train_loss:3.3531 train_time:840308ms step_avg:733.25ms
step:1157/1750 train_loss:3.3501 train_time:841058ms step_avg:733.27ms
step:1158/1750 train_loss:3.4981 train_time:841856ms step_avg:733.32ms
step:1159/1750 train_loss:3.5184 train_time:842630ms step_avg:733.36ms
step:1160/1750 train_loss:3.2840 train_time:843389ms step_avg:733.38ms
step:1161/1750 train_loss:3.3565 train_time:844144ms step_avg:733.40ms
step:1162/1750 train_loss:3.3443 train_time:844905ms step_avg:733.42ms
step:1163/1750 train_loss:3.5608 train_time:845672ms step_avg:733.45ms
step:1164/1750 train_loss:3.3690 train_time:846450ms step_avg:733.49ms
step:1165/1750 train_loss:3.4850 train_time:847222ms step_avg:733.53ms
step:1166/1750 train_loss:3.4516 train_time:847982ms step_avg:733.55ms
step:1167/1750 train_loss:3.4626 train_time:848755ms step_avg:733.58ms
step:1168/1750 train_loss:3.4484 train_time:849513ms step_avg:733.60ms
step:1169/1750 train_loss:3.4440 train_time:850274ms step_avg:733.63ms
step:1170/1750 train_loss:3.6521 train_time:851051ms step_avg:733.66ms
step:1171/1750 train_loss:3.4150 train_time:851826ms step_avg:733.70ms
step:1172/1750 train_loss:3.5053 train_time:852584ms step_avg:733.72ms
step:1173/1750 train_loss:3.4706 train_time:853365ms step_avg:733.76ms
step:1174/1750 train_loss:3.3801 train_time:854122ms step_avg:733.78ms
step:1175/1750 train_loss:3.4727 train_time:854878ms step_avg:733.80ms
step:1176/1750 train_loss:3.8121 train_time:855737ms step_avg:733.91ms
step:1177/1750 train_loss:3.4419 train_time:856510ms step_avg:733.94ms
step:1178/1750 train_loss:3.4451 train_time:857281ms step_avg:733.97ms
step:1179/1750 train_loss:3.3278 train_time:858090ms step_avg:734.04ms
step:1180/1750 train_loss:3.4741 train_time:858855ms step_avg:734.06ms
step:1181/1750 train_loss:3.4847 train_time:859611ms step_avg:734.08ms
step:1182/1750 train_loss:3.4170 train_time:860382ms step_avg:734.11ms
step:1183/1750 train_loss:3.3424 train_time:861163ms step_avg:734.15ms
step:1184/1750 train_loss:3.4728 train_time:861940ms step_avg:734.19ms
step:1185/1750 train_loss:3.5837 train_time:862714ms step_avg:734.22ms
step:1186/1750 train_loss:3.7585 train_time:863489ms step_avg:734.26ms
step:1187/1750 train_loss:3.5927 train_time:864257ms step_avg:734.29ms
step:1188/1750 train_loss:3.4372 train_time:865043ms step_avg:734.33ms
step:1189/1750 train_loss:3.2910 train_time:865863ms step_avg:734.40ms
step:1190/1750 train_loss:3.4241 train_time:866640ms step_avg:734.44ms
step:1191/1750 train_loss:3.4183 train_time:867399ms step_avg:734.46ms
step:1192/1750 train_loss:3.4720 train_time:868170ms step_avg:734.49ms
step:1193/1750 train_loss:3.3833 train_time:868933ms step_avg:734.52ms
step:1194/1750 train_loss:3.5544 train_time:869701ms step_avg:734.54ms
step:1195/1750 train_loss:3.4138 train_time:870458ms step_avg:734.56ms
step:1196/1750 train_loss:3.4031 train_time:871245ms step_avg:734.61ms
step:1197/1750 train_loss:3.3961 train_time:872028ms step_avg:734.65ms
step:1198/1750 train_loss:3.4744 train_time:872791ms step_avg:734.67ms
step:1199/1750 train_loss:3.4402 train_time:873547ms step_avg:734.69ms
step:1200/1750 train_loss:3.4093 train_time:874344ms step_avg:734.74ms
step:1201/1750 train_loss:3.8147 train_time:875173ms step_avg:734.82ms
step:1202/1750 train_loss:3.3515 train_time:875943ms step_avg:734.85ms
step:1203/1750 train_loss:3.4497 train_time:876705ms step_avg:734.87ms
step:1204/1750 train_loss:3.4419 train_time:877490ms step_avg:734.92ms
step:1205/1750 train_loss:3.5082 train_time:878320ms step_avg:735.00ms
step:1206/1750 train_loss:3.5134 train_time:879091ms step_avg:735.03ms
step:1207/1750 train_loss:3.4730 train_time:879884ms step_avg:735.07ms
step:1208/1750 train_loss:3.3974 train_time:880655ms step_avg:735.10ms
step:1209/1750 train_loss:3.4590 train_time:881417ms step_avg:735.13ms
step:1210/1750 train_loss:3.3996 train_time:882194ms step_avg:735.16ms
step:1211/1750 train_loss:3.4636 train_time:882963ms step_avg:735.19ms
step:1212/1750 train_loss:3.7033 train_time:883757ms step_avg:735.24ms
step:1213/1750 train_loss:3.3886 train_time:884519ms step_avg:735.26ms
step:1214/1750 train_loss:3.6337 train_time:885279ms step_avg:735.28ms
step:1215/1750 train_loss:3.4324 train_time:886039ms step_avg:735.30ms
step:1216/1750 train_loss:3.5175 train_time:886808ms step_avg:735.33ms
step:1217/1750 train_loss:3.4740 train_time:887584ms step_avg:735.36ms
step:1218/1750 train_loss:3.4771 train_time:888335ms step_avg:735.38ms
step:1219/1750 train_loss:3.5109 train_time:889110ms step_avg:735.41ms
step:1220/1750 train_loss:3.4295 train_time:889871ms step_avg:735.43ms
step:1221/1750 train_loss:3.4854 train_time:890625ms step_avg:735.45ms
step:1222/1750 train_loss:3.4915 train_time:891404ms step_avg:735.48ms
step:1223/1750 train_loss:3.4951 train_time:892167ms step_avg:735.50ms
step:1224/1750 train_loss:3.4607 train_time:892977ms step_avg:735.57ms
step:1225/1750 train_loss:3.4477 train_time:893738ms step_avg:735.59ms
step:1226/1750 train_loss:3.3405 train_time:894514ms step_avg:735.62ms
step:1227/1750 train_loss:3.4965 train_time:895290ms step_avg:735.65ms
step:1228/1750 train_loss:3.2909 train_time:896042ms step_avg:735.67ms
step:1229/1750 train_loss:3.5876 train_time:896819ms step_avg:735.70ms
step:1230/1750 train_loss:3.4027 train_time:897588ms step_avg:735.73ms
step:1231/1750 train_loss:3.4132 train_time:898390ms step_avg:735.78ms
step:1232/1750 train_loss:3.5710 train_time:899190ms step_avg:735.83ms
step:1233/1750 train_loss:3.3038 train_time:899968ms step_avg:735.87ms
step:1234/1750 train_loss:3.3771 train_time:900737ms step_avg:735.90ms
step:1235/1750 train_loss:3.4311 train_time:901501ms step_avg:735.92ms
step:1236/1750 train_loss:3.4450 train_time:902271ms step_avg:735.95ms
step:1237/1750 train_loss:3.4344 train_time:903058ms step_avg:735.99ms
step:1238/1750 train_loss:3.4024 train_time:903826ms step_avg:736.02ms
step:1239/1750 train_loss:3.6321 train_time:904585ms step_avg:736.03ms
step:1240/1750 train_loss:3.3907 train_time:905397ms step_avg:736.10ms
step:1241/1750 train_loss:3.2656 train_time:906155ms step_avg:736.11ms
step:1242/1750 train_loss:3.5316 train_time:906953ms step_avg:736.16ms
step:1243/1750 train_loss:3.2558 train_time:907730ms step_avg:736.20ms
step:1244/1750 train_loss:3.4476 train_time:908489ms step_avg:736.22ms
step:1245/1750 train_loss:3.6762 train_time:909250ms step_avg:736.23ms
step:1246/1750 train_loss:3.3629 train_time:910018ms step_avg:736.26ms
step:1247/1750 train_loss:3.4463 train_time:910768ms step_avg:736.27ms
step:1248/1750 train_loss:3.5397 train_time:911514ms step_avg:736.28ms
step:1249/1750 train_loss:3.2500 train_time:912280ms step_avg:736.30ms
step:1250/1750 train_loss:3.3635 train_time:913052ms step_avg:736.33ms
step:1250/1750 val_loss:3.4146 train_time:913065ms step_avg:736.34ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 289.47073 | frobenius_norm = 66781.63281 | spectral_norm = 12059.64746 | nuclear_norm = 1680001.37500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 181.86436 | spectral_norm = 34.42072 | nuclear_norm = 4171.81299
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 177.44591 | spectral_norm = 37.45845 | nuclear_norm = 4059.93506
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 341.27496 | spectral_norm = 23.57355 | nuclear_norm = 8362.52832
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 240.97762 | spectral_norm = 26.82413 | nuclear_norm = 5548.86328
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 399.75500 | spectral_norm = 33.53503 | nuclear_norm = 10622.82031
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 202.53232 | spectral_norm = 19.30120 | nuclear_norm = 5371.00195
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 185.09741 | spectral_norm = 17.63654 | nuclear_norm = 4273.28613
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 183.07739 | spectral_norm = 18.16386 | nuclear_norm = 4222.35449
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 330.29688 | spectral_norm = 28.59881 | nuclear_norm = 7583.69336
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 323.39981 | spectral_norm = 25.55330 | nuclear_norm = 7596.70361
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 395.53934 | spectral_norm = 29.10841 | nuclear_norm = 10558.56641
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 192.74217 | spectral_norm = 19.94625 | nuclear_norm = 5055.26465
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 180.81201 | spectral_norm = 20.76803 | nuclear_norm = 4129.09082
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 179.27827 | spectral_norm = 19.74670 | nuclear_norm = 4122.87109
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 330.68436 | spectral_norm = 29.20378 | nuclear_norm = 7557.70508
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 336.37234 | spectral_norm = 26.27232 | nuclear_norm = 7813.26123
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 399.53287 | spectral_norm = 34.14359 | nuclear_norm = 10612.42773
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 201.84344 | spectral_norm = 21.56899 | nuclear_norm = 5308.09668
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 176.13182 | spectral_norm = 17.26305 | nuclear_norm = 3893.94897
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 175.45432 | spectral_norm = 16.81836 | nuclear_norm = 3894.61768
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 353.15082 | spectral_norm = 32.64768 | nuclear_norm = 7972.77002
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 362.58572 | spectral_norm = 29.67809 | nuclear_norm = 8508.58203
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 402.83008 | spectral_norm = 37.76105 | nuclear_norm = 10701.18555
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 198.64055 | spectral_norm = 20.19044 | nuclear_norm = 5213.70850
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 174.90120 | spectral_norm = 18.59995 | nuclear_norm = 3910.56787
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 172.38458 | spectral_norm = 17.62909 | nuclear_norm = 3886.86768
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 354.85809 | spectral_norm = 30.80196 | nuclear_norm = 8092.33594
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 353.64047 | spectral_norm = 28.45464 | nuclear_norm = 8236.01074
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 412.57034 | spectral_norm = 34.88358 | nuclear_norm = 10964.30762
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 200.43105 | spectral_norm = 18.88780 | nuclear_norm = 5288.19531
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 183.93092 | spectral_norm = 17.91506 | nuclear_norm = 4213.25732
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 179.62259 | spectral_norm = 17.75774 | nuclear_norm = 4144.69922
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 360.11227 | spectral_norm = 32.75573 | nuclear_norm = 8165.00488
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 324.96866 | spectral_norm = 22.80519 | nuclear_norm = 7747.97510
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 430.77237 | spectral_norm = 30.21572 | nuclear_norm = 11476.74805
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 210.76042 | spectral_norm = 19.06497 | nuclear_norm = 5564.87598
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 174.30107 | spectral_norm = 18.93868 | nuclear_norm = 3899.16016
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 173.23195 | spectral_norm = 17.71167 | nuclear_norm = 3912.88818
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 368.89713 | spectral_norm = 31.58278 | nuclear_norm = 8439.86230
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 364.16278 | spectral_norm = 27.56092 | nuclear_norm = 8561.64844
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 401.49789 | spectral_norm = 30.70641 | nuclear_norm = 10720.28516
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 200.49136 | spectral_norm = 19.29765 | nuclear_norm = 5277.82812
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 178.88789 | spectral_norm = 19.44630 | nuclear_norm = 4066.15771
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 175.52576 | spectral_norm = 17.89668 | nuclear_norm = 4028.43945
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 353.93201 | spectral_norm = 29.07498 | nuclear_norm = 8039.51709
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 347.93448 | spectral_norm = 30.94025 | nuclear_norm = 7913.68457
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 409.95944 | spectral_norm = 31.88909 | nuclear_norm = 10907.77930
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 204.57603 | spectral_norm = 20.94390 | nuclear_norm = 5389.66895
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 180.44249 | spectral_norm = 19.35240 | nuclear_norm = 4052.76880
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 179.24341 | spectral_norm = 17.68580 | nuclear_norm = 4038.15698
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 373.40335 | spectral_norm = 34.18032 | nuclear_norm = 8384.91797
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 357.08359 | spectral_norm = 28.31479 | nuclear_norm = 8290.30469
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 412.83130 | spectral_norm = 34.20482 | nuclear_norm = 10971.60156
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 204.32689 | spectral_norm = 21.45913 | nuclear_norm = 5394.08691
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 179.03079 | spectral_norm = 20.25194 | nuclear_norm = 3905.21729
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 182.11624 | spectral_norm = 19.06494 | nuclear_norm = 3893.48828
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 389.36230 | spectral_norm = 36.08057 | nuclear_norm = 8913.81641
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 382.01028 | spectral_norm = 25.76661 | nuclear_norm = 9099.82617
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 395.30447 | spectral_norm = 33.98099 | nuclear_norm = 10505.33594
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 204.96674 | spectral_norm = 22.00851 | nuclear_norm = 5432.10938
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 181.19437 | spectral_norm = 21.03309 | nuclear_norm = 3991.56812
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 179.67360 | spectral_norm = 19.49091 | nuclear_norm = 3918.96069
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 361.70309 | spectral_norm = 35.44212 | nuclear_norm = 8230.49609
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 365.64883 | spectral_norm = 26.45578 | nuclear_norm = 8551.29492
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 411.67502 | spectral_norm = 31.84352 | nuclear_norm = 10962.83301
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 194.86177 | spectral_norm = 24.31406 | nuclear_norm = 5146.11426
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 188.33324 | spectral_norm = 23.81955 | nuclear_norm = 4203.57129
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 180.21597 | spectral_norm = 22.23026 | nuclear_norm = 4008.87109
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 356.00589 | spectral_norm = 36.04427 | nuclear_norm = 8123.50098
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 382.03412 | spectral_norm = 27.95536 | nuclear_norm = 8946.16992
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 428.46588 | spectral_norm = 33.02552 | nuclear_norm = 11387.36035
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 215.32843 | spectral_norm = 26.40955 | nuclear_norm = 5651.89160
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1295.40735 | spectral_norm = 171.18802 | nuclear_norm = 34149.67578
===========================================
step:1251/1750 train_loss:3.3669 train_time:913809ms step_avg:736.35ms
step:1252/1750 train_loss:3.2487 train_time:914566ms step_avg:736.37ms
step:1253/1750 train_loss:3.4986 train_time:915324ms step_avg:736.38ms
step:1254/1750 train_loss:3.6022 train_time:916145ms step_avg:736.45ms
step:1255/1750 train_loss:3.3366 train_time:916902ms step_avg:736.47ms
step:1256/1750 train_loss:3.5492 train_time:917654ms step_avg:736.48ms
step:1257/1750 train_loss:3.2914 train_time:918437ms step_avg:736.52ms
step:1258/1750 train_loss:3.4675 train_time:919212ms step_avg:736.55ms
step:1259/1750 train_loss:3.5521 train_time:919972ms step_avg:736.57ms
step:1260/1750 train_loss:3.4047 train_time:920731ms step_avg:736.59ms
step:1261/1750 train_loss:3.4551 train_time:921522ms step_avg:736.63ms
step:1262/1750 train_loss:3.5803 train_time:922293ms step_avg:736.66ms
step:1263/1750 train_loss:3.2435 train_time:923063ms step_avg:736.68ms
step:1264/1750 train_loss:3.4941 train_time:923836ms step_avg:736.71ms
step:1265/1750 train_loss:3.4281 train_time:924609ms step_avg:736.74ms
step:1266/1750 train_loss:3.4145 train_time:925382ms step_avg:736.77ms
step:1267/1750 train_loss:3.3334 train_time:926151ms step_avg:736.79ms
step:1268/1750 train_loss:3.3346 train_time:926943ms step_avg:736.84ms
step:1269/1750 train_loss:3.4503 train_time:927703ms step_avg:736.86ms
step:1270/1750 train_loss:3.3418 train_time:928477ms step_avg:736.89ms
step:1271/1750 train_loss:3.4619 train_time:929240ms step_avg:736.91ms
step:1272/1750 train_loss:3.4055 train_time:930015ms step_avg:736.94ms
step:1273/1750 train_loss:3.4466 train_time:930772ms step_avg:736.95ms
step:1274/1750 train_loss:3.3458 train_time:931544ms step_avg:736.98ms
step:1275/1750 train_loss:3.4788 train_time:932291ms step_avg:736.99ms
step:1276/1750 train_loss:3.4162 train_time:933044ms step_avg:737.00ms
step:1277/1750 train_loss:3.5077 train_time:933803ms step_avg:737.02ms
step:1278/1750 train_loss:3.4464 train_time:934564ms step_avg:737.04ms
step:1279/1750 train_loss:3.3717 train_time:935380ms step_avg:737.10ms
step:1280/1750 train_loss:3.3176 train_time:936143ms step_avg:737.12ms
step:1281/1750 train_loss:3.3966 train_time:936897ms step_avg:737.13ms
step:1282/1750 train_loss:3.3724 train_time:937671ms step_avg:737.16ms
step:1283/1750 train_loss:3.5442 train_time:938427ms step_avg:737.18ms
step:1284/1750 train_loss:3.3689 train_time:939191ms step_avg:737.20ms
step:1285/1750 train_loss:3.5222 train_time:939963ms step_avg:737.23ms
step:1286/1750 train_loss:3.3830 train_time:940738ms step_avg:737.26ms
step:1287/1750 train_loss:3.4652 train_time:941485ms step_avg:737.26ms
step:1288/1750 train_loss:3.4359 train_time:942238ms step_avg:737.28ms
step:1289/1750 train_loss:3.4331 train_time:943021ms step_avg:737.31ms
step:1290/1750 train_loss:3.4504 train_time:943803ms step_avg:737.35ms
step:1291/1750 train_loss:3.5870 train_time:944596ms step_avg:737.39ms
step:1292/1750 train_loss:3.4083 train_time:945386ms step_avg:737.43ms
step:1293/1750 train_loss:3.2091 train_time:946172ms step_avg:737.47ms
step:1294/1750 train_loss:3.4253 train_time:946924ms step_avg:737.48ms
step:1295/1750 train_loss:3.4108 train_time:947738ms step_avg:737.54ms
step:1296/1750 train_loss:3.4575 train_time:948505ms step_avg:737.56ms
step:1297/1750 train_loss:3.4952 train_time:949274ms step_avg:737.59ms
step:1298/1750 train_loss:3.4951 train_time:950032ms step_avg:737.60ms
step:1299/1750 train_loss:3.4378 train_time:950798ms step_avg:737.62ms
step:1300/1750 train_loss:3.4372 train_time:951548ms step_avg:737.63ms
step:1301/1750 train_loss:3.5732 train_time:952304ms step_avg:737.65ms
step:1302/1750 train_loss:3.4166 train_time:953063ms step_avg:737.66ms
step:1303/1750 train_loss:3.5075 train_time:953823ms step_avg:737.68ms
step:1304/1750 train_loss:3.4321 train_time:954573ms step_avg:737.69ms
step:1305/1750 train_loss:3.5212 train_time:955360ms step_avg:737.73ms
step:1306/1750 train_loss:3.6016 train_time:956149ms step_avg:737.77ms
step:1307/1750 train_loss:3.3901 train_time:956933ms step_avg:737.80ms
step:1308/1750 train_loss:3.3474 train_time:957696ms step_avg:737.82ms
step:1309/1750 train_loss:3.3673 train_time:958474ms step_avg:737.86ms
step:1310/1750 train_loss:3.4144 train_time:959235ms step_avg:737.87ms
step:1311/1750 train_loss:3.3541 train_time:960002ms step_avg:737.90ms
step:1312/1750 train_loss:3.5242 train_time:960758ms step_avg:737.91ms
step:1313/1750 train_loss:3.4090 train_time:961520ms step_avg:737.93ms
step:1314/1750 train_loss:3.4653 train_time:962282ms step_avg:737.95ms
step:1315/1750 train_loss:3.4473 train_time:963051ms step_avg:737.97ms
step:1316/1750 train_loss:3.4729 train_time:963814ms step_avg:737.99ms
step:1317/1750 train_loss:3.3108 train_time:964611ms step_avg:738.03ms
step:1318/1750 train_loss:3.5857 train_time:965356ms step_avg:738.04ms
step:1319/1750 train_loss:3.4973 train_time:966129ms step_avg:738.07ms
step:1320/1750 train_loss:3.3783 train_time:966882ms step_avg:738.08ms
step:1321/1750 train_loss:3.4892 train_time:967664ms step_avg:738.11ms
step:1322/1750 train_loss:3.4622 train_time:968413ms step_avg:738.12ms
step:1323/1750 train_loss:3.4409 train_time:969176ms step_avg:738.14ms
step:1324/1750 train_loss:3.6303 train_time:969970ms step_avg:738.18ms
step:1325/1750 train_loss:3.4892 train_time:970762ms step_avg:738.22ms
step:1326/1750 train_loss:3.5324 train_time:971523ms step_avg:738.24ms
step:1327/1750 train_loss:3.5527 train_time:972277ms step_avg:738.25ms
step:1328/1750 train_loss:3.2999 train_time:973057ms step_avg:738.28ms
step:1329/1750 train_loss:3.3809 train_time:973820ms step_avg:738.30ms
step:1330/1750 train_loss:3.4343 train_time:974813ms step_avg:738.49ms
step:1331/1750 train_loss:2.6367 train_time:975627ms step_avg:738.55ms
step:1332/1750 train_loss:3.4439 train_time:976409ms step_avg:738.58ms
step:1333/1750 train_loss:3.4162 train_time:977181ms step_avg:738.61ms
step:1334/1750 train_loss:3.3940 train_time:977937ms step_avg:738.62ms
step:1335/1750 train_loss:3.8031 train_time:978760ms step_avg:738.69ms
step:1336/1750 train_loss:3.5318 train_time:979516ms step_avg:738.70ms
step:1337/1750 train_loss:3.4276 train_time:980280ms step_avg:738.72ms
step:1338/1750 train_loss:3.3646 train_time:981064ms step_avg:738.75ms
step:1339/1750 train_loss:3.3515 train_time:981846ms step_avg:738.79ms
step:1340/1750 train_loss:3.6135 train_time:982627ms step_avg:738.82ms
step:1341/1750 train_loss:3.5830 train_time:983394ms step_avg:738.84ms
step:1342/1750 train_loss:3.4024 train_time:984176ms step_avg:738.87ms
step:1343/1750 train_loss:3.3372 train_time:984928ms step_avg:738.88ms
step:1344/1750 train_loss:3.6528 train_time:985702ms step_avg:738.91ms
step:1345/1750 train_loss:3.4112 train_time:986462ms step_avg:738.92ms
step:1346/1750 train_loss:3.4226 train_time:987236ms step_avg:738.95ms
step:1347/1750 train_loss:3.4810 train_time:987994ms step_avg:738.96ms
step:1348/1750 train_loss:3.4436 train_time:988761ms step_avg:738.98ms
step:1349/1750 train_loss:3.3572 train_time:989508ms step_avg:738.99ms
step:1350/1750 train_loss:3.3317 train_time:990268ms step_avg:739.01ms
step:1351/1750 train_loss:3.3978 train_time:991056ms step_avg:739.04ms
step:1352/1750 train_loss:3.3322 train_time:991830ms step_avg:739.07ms
step:1353/1750 train_loss:3.4502 train_time:992589ms step_avg:739.08ms
step:1354/1750 train_loss:3.2978 train_time:993346ms step_avg:739.10ms
step:1355/1750 train_loss:3.3616 train_time:994098ms step_avg:739.11ms
step:1356/1750 train_loss:3.4699 train_time:994875ms step_avg:739.13ms
step:1357/1750 train_loss:3.3096 train_time:995650ms step_avg:739.16ms
step:1358/1750 train_loss:3.2536 train_time:996407ms step_avg:739.17ms
step:1359/1750 train_loss:3.5715 train_time:997178ms step_avg:739.20ms
step:1360/1750 train_loss:3.4763 train_time:997950ms step_avg:739.22ms
step:1361/1750 train_loss:3.2347 train_time:998720ms step_avg:739.25ms
step:1362/1750 train_loss:3.5056 train_time:999516ms step_avg:739.29ms
step:1363/1750 train_loss:3.4142 train_time:1000293ms step_avg:739.31ms
step:1364/1750 train_loss:3.1895 train_time:1001081ms step_avg:739.35ms
step:1365/1750 train_loss:3.4570 train_time:1001852ms step_avg:739.37ms
step:1366/1750 train_loss:3.3363 train_time:1002633ms step_avg:739.40ms
step:1367/1750 train_loss:3.3712 train_time:1003394ms step_avg:739.42ms
step:1368/1750 train_loss:3.3712 train_time:1004191ms step_avg:739.46ms
step:1369/1750 train_loss:3.4837 train_time:1004938ms step_avg:739.47ms
step:1370/1750 train_loss:3.4503 train_time:1005714ms step_avg:739.50ms
step:1371/1750 train_loss:3.4093 train_time:1006497ms step_avg:739.53ms
step:1372/1750 train_loss:3.3162 train_time:1007288ms step_avg:739.57ms
step:1373/1750 train_loss:3.6659 train_time:1008068ms step_avg:739.60ms
step:1374/1750 train_loss:3.3707 train_time:1008824ms step_avg:739.61ms
step:1375/1750 train_loss:3.4238 train_time:1009596ms step_avg:739.63ms
step:1375/1750 val_loss:3.3697 train_time:1009609ms step_avg:739.64ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 294.12827 | frobenius_norm = 67883.53906 | spectral_norm = 12248.27344 | nuclear_norm = 1709664.00000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 186.80502 | spectral_norm = 36.11088 | nuclear_norm = 4277.41309
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 182.52155 | spectral_norm = 39.29698 | nuclear_norm = 4171.87744
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 350.19046 | spectral_norm = 24.19715 | nuclear_norm = 8598.03516
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 243.62901 | spectral_norm = 27.66389 | nuclear_norm = 5596.42139
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 412.92819 | spectral_norm = 34.93886 | nuclear_norm = 10972.36621
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 208.63519 | spectral_norm = 20.05493 | nuclear_norm = 5533.86523
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 190.76048 | spectral_norm = 18.30792 | nuclear_norm = 4400.45605
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 188.64737 | spectral_norm = 18.95481 | nuclear_norm = 4347.75146
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 339.57336 | spectral_norm = 29.24562 | nuclear_norm = 7797.91602
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 331.90042 | spectral_norm = 26.19520 | nuclear_norm = 7798.57812
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 407.28159 | spectral_norm = 30.25430 | nuclear_norm = 10874.80469
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 198.51102 | spectral_norm = 20.64793 | nuclear_norm = 5206.49219
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 186.41052 | spectral_norm = 21.64175 | nuclear_norm = 4251.71094
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 184.83342 | spectral_norm = 20.49034 | nuclear_norm = 4248.59424
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 340.97177 | spectral_norm = 30.07606 | nuclear_norm = 7798.38770
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 346.46097 | spectral_norm = 27.09648 | nuclear_norm = 8050.32666
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 411.13919 | spectral_norm = 35.58393 | nuclear_norm = 10919.65625
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 207.71922 | spectral_norm = 22.29941 | nuclear_norm = 5461.22168
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 181.14670 | spectral_norm = 17.88145 | nuclear_norm = 3993.57544
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 180.47110 | spectral_norm = 17.37774 | nuclear_norm = 3996.13818
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 364.69717 | spectral_norm = 33.63915 | nuclear_norm = 8238.49902
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 373.82413 | spectral_norm = 30.59187 | nuclear_norm = 8774.92578
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 414.26358 | spectral_norm = 39.29314 | nuclear_norm = 11001.85938
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 204.54373 | spectral_norm = 20.96326 | nuclear_norm = 5367.36963
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 180.12549 | spectral_norm = 19.28478 | nuclear_norm = 4021.02271
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 177.45293 | spectral_norm = 18.22460 | nuclear_norm = 3995.80029
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 366.85864 | spectral_norm = 31.83728 | nuclear_norm = 8374.24609
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 364.94153 | spectral_norm = 29.35484 | nuclear_norm = 8504.86133
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 423.85938 | spectral_norm = 36.35048 | nuclear_norm = 11262.60547
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 206.38531 | spectral_norm = 19.50719 | nuclear_norm = 5446.90039
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 189.44475 | spectral_norm = 18.49043 | nuclear_norm = 4332.63281
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 184.87570 | spectral_norm = 18.40095 | nuclear_norm = 4263.36768
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 372.13461 | spectral_norm = 33.83450 | nuclear_norm = 8441.61328
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 334.14969 | spectral_norm = 23.43117 | nuclear_norm = 7974.88086
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 443.65997 | spectral_norm = 31.20860 | nuclear_norm = 11821.18359
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 217.48862 | spectral_norm = 19.77082 | nuclear_norm = 5745.28760
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 179.30231 | spectral_norm = 19.69799 | nuclear_norm = 4001.74780
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 178.24310 | spectral_norm = 18.35921 | nuclear_norm = 4018.38208
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 380.62445 | spectral_norm = 32.66254 | nuclear_norm = 8717.60645
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 375.59158 | spectral_norm = 28.30889 | nuclear_norm = 8834.33691
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 412.86630 | spectral_norm = 31.68173 | nuclear_norm = 11024.97070
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 206.44054 | spectral_norm = 20.11708 | nuclear_norm = 5434.79395
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 184.18951 | spectral_norm = 20.13778 | nuclear_norm = 4177.50293
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 180.55014 | spectral_norm = 18.57349 | nuclear_norm = 4137.40137
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 365.93256 | spectral_norm = 29.95354 | nuclear_norm = 8325.79297
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 358.98016 | spectral_norm = 31.91137 | nuclear_norm = 8164.85059
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 421.73685 | spectral_norm = 33.04251 | nuclear_norm = 11219.77441
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 210.59363 | spectral_norm = 21.86020 | nuclear_norm = 5546.62695
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 185.73964 | spectral_norm = 20.04783 | nuclear_norm = 4163.82812
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 184.50911 | spectral_norm = 18.29602 | nuclear_norm = 4150.82227
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 385.29590 | spectral_norm = 35.20527 | nuclear_norm = 8661.65430
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 366.98483 | spectral_norm = 29.11115 | nuclear_norm = 8516.27051
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 425.38409 | spectral_norm = 35.60098 | nuclear_norm = 11300.85742
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 210.40833 | spectral_norm = 22.42149 | nuclear_norm = 5553.06348
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 184.36790 | spectral_norm = 21.02160 | nuclear_norm = 4009.55713
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 187.64467 | spectral_norm = 19.77687 | nuclear_norm = 3994.76099
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 401.95306 | spectral_norm = 37.57573 | nuclear_norm = 9195.68359
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 392.82520 | spectral_norm = 26.50469 | nuclear_norm = 9358.55957
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 406.79407 | spectral_norm = 35.35997 | nuclear_norm = 10804.99902
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 211.06462 | spectral_norm = 22.80136 | nuclear_norm = 5593.11328
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 186.28426 | spectral_norm = 22.00195 | nuclear_norm = 4088.96558
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 184.84827 | spectral_norm = 20.24372 | nuclear_norm = 4013.35718
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 374.51181 | spectral_norm = 37.04001 | nuclear_norm = 8518.42969
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 376.10657 | spectral_norm = 27.41500 | nuclear_norm = 8794.51465
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 422.57806 | spectral_norm = 33.02267 | nuclear_norm = 11249.83984
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 200.75560 | spectral_norm = 25.29587 | nuclear_norm = 5301.54688
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 193.74606 | spectral_norm = 24.91236 | nuclear_norm = 4310.14209
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 185.17464 | spectral_norm = 23.27017 | nuclear_norm = 4105.80371
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 370.29398 | spectral_norm = 37.78223 | nuclear_norm = 8447.15234
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 394.38226 | spectral_norm = 28.97213 | nuclear_norm = 9232.09082
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 439.61783 | spectral_norm = 34.16150 | nuclear_norm = 11678.79883
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 221.72629 | spectral_norm = 27.54930 | nuclear_norm = 5817.06104
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1320.81738 | spectral_norm = 169.18883 | nuclear_norm = 34884.67969
===========================================
step:1376/1750 train_loss:3.4208 train_time:1010341ms step_avg:739.63ms
step:1377/1750 train_loss:3.2152 train_time:1011127ms step_avg:739.67ms
step:1378/1750 train_loss:3.5970 train_time:1011887ms step_avg:739.68ms
step:1379/1750 train_loss:3.4004 train_time:1012633ms step_avg:739.69ms
step:1380/1750 train_loss:3.5375 train_time:1013420ms step_avg:739.72ms
step:1381/1750 train_loss:3.5328 train_time:1014172ms step_avg:739.73ms
step:1382/1750 train_loss:3.1616 train_time:1014943ms step_avg:739.75ms
step:1383/1750 train_loss:3.3693 train_time:1015745ms step_avg:739.80ms
step:1384/1750 train_loss:3.7691 train_time:1016519ms step_avg:739.82ms
step:1385/1750 train_loss:3.2720 train_time:1017281ms step_avg:739.84ms
step:1386/1750 train_loss:3.4501 train_time:1018035ms step_avg:739.85ms
step:1387/1750 train_loss:3.5336 train_time:1018798ms step_avg:739.87ms
step:1388/1750 train_loss:3.4650 train_time:1019545ms step_avg:739.87ms
step:1389/1750 train_loss:3.3984 train_time:1020308ms step_avg:739.89ms
step:1390/1750 train_loss:3.2572 train_time:1021072ms step_avg:739.91ms
step:1391/1750 train_loss:3.3988 train_time:1021839ms step_avg:739.93ms
step:1392/1750 train_loss:3.3813 train_time:1022599ms step_avg:739.94ms
step:1393/1750 train_loss:3.6266 train_time:1023347ms step_avg:739.95ms
step:1394/1750 train_loss:3.3473 train_time:1024110ms step_avg:739.96ms
step:1395/1750 train_loss:3.3478 train_time:1024881ms step_avg:739.99ms
step:1396/1750 train_loss:3.3004 train_time:1025633ms step_avg:739.99ms
step:1397/1750 train_loss:3.5622 train_time:1026397ms step_avg:740.01ms
step:1398/1750 train_loss:3.4491 train_time:1027161ms step_avg:740.03ms
step:1399/1750 train_loss:3.4578 train_time:1027924ms step_avg:740.05ms
step:1400/1750 train_loss:3.3656 train_time:1028663ms step_avg:740.05ms
step:1401/1750 train_loss:3.3101 train_time:1029430ms step_avg:740.06ms
step:1402/1750 train_loss:3.3911 train_time:1030196ms step_avg:740.08ms
step:1403/1750 train_loss:3.3729 train_time:1030966ms step_avg:740.10ms
step:1404/1750 train_loss:3.4000 train_time:1031714ms step_avg:740.11ms
step:1405/1750 train_loss:3.3524 train_time:1032480ms step_avg:740.13ms
step:1406/1750 train_loss:3.5515 train_time:1033258ms step_avg:740.16ms
step:1407/1750 train_loss:3.3392 train_time:1034002ms step_avg:740.16ms
step:1408/1750 train_loss:3.3671 train_time:1034784ms step_avg:740.19ms
step:1409/1750 train_loss:3.3661 train_time:1035540ms step_avg:740.20ms
step:1410/1750 train_loss:3.2344 train_time:1036299ms step_avg:740.21ms
step:1411/1750 train_loss:3.3662 train_time:1037048ms step_avg:740.22ms
step:1412/1750 train_loss:3.3529 train_time:1037856ms step_avg:740.27ms
step:1413/1750 train_loss:3.3420 train_time:1038617ms step_avg:740.28ms
step:1414/1750 train_loss:3.4242 train_time:1039378ms step_avg:740.30ms
step:1415/1750 train_loss:3.3838 train_time:1040137ms step_avg:740.31ms
step:1416/1750 train_loss:3.4136 train_time:1040906ms step_avg:740.33ms
step:1417/1750 train_loss:3.3958 train_time:1041669ms step_avg:740.35ms
step:1418/1750 train_loss:3.4645 train_time:1042432ms step_avg:740.36ms
step:1419/1750 train_loss:3.2838 train_time:1043243ms step_avg:740.41ms
step:1420/1750 train_loss:3.3396 train_time:1044029ms step_avg:740.45ms
step:1421/1750 train_loss:3.4449 train_time:1044778ms step_avg:740.45ms
step:1422/1750 train_loss:3.3895 train_time:1045543ms step_avg:740.47ms
step:1423/1750 train_loss:3.4088 train_time:1046324ms step_avg:740.50ms
step:1424/1750 train_loss:3.4296 train_time:1047099ms step_avg:740.52ms
step:1425/1750 train_loss:3.3940 train_time:1047870ms step_avg:740.54ms
step:1426/1750 train_loss:3.3714 train_time:1048620ms step_avg:740.55ms
step:1427/1750 train_loss:3.3773 train_time:1049391ms step_avg:740.57ms
step:1428/1750 train_loss:3.2318 train_time:1050190ms step_avg:740.61ms
step:1429/1750 train_loss:3.3806 train_time:1050947ms step_avg:740.63ms
step:1430/1750 train_loss:3.3289 train_time:1051719ms step_avg:740.65ms
step:1431/1750 train_loss:3.4308 train_time:1052480ms step_avg:740.66ms
step:1432/1750 train_loss:3.4156 train_time:1053227ms step_avg:740.67ms
step:1433/1750 train_loss:3.3167 train_time:1053995ms step_avg:740.69ms
step:1434/1750 train_loss:3.3726 train_time:1054760ms step_avg:740.70ms
step:1435/1750 train_loss:3.3894 train_time:1055526ms step_avg:740.72ms
step:1436/1750 train_loss:3.1925 train_time:1056317ms step_avg:740.76ms
step:1437/1750 train_loss:3.3393 train_time:1057098ms step_avg:740.78ms
step:1438/1750 train_loss:3.1753 train_time:1057854ms step_avg:740.79ms
step:1439/1750 train_loss:3.2798 train_time:1058607ms step_avg:740.80ms
step:1440/1750 train_loss:3.4692 train_time:1059390ms step_avg:740.83ms
step:1441/1750 train_loss:3.4383 train_time:1060153ms step_avg:740.85ms
step:1442/1750 train_loss:3.3691 train_time:1060929ms step_avg:740.87ms
step:1443/1750 train_loss:3.2430 train_time:1061688ms step_avg:740.88ms
step:1444/1750 train_loss:3.3959 train_time:1062456ms step_avg:740.90ms
step:1445/1750 train_loss:3.4467 train_time:1063248ms step_avg:740.94ms
step:1446/1750 train_loss:3.5313 train_time:1064037ms step_avg:740.97ms
step:1447/1750 train_loss:3.5055 train_time:1064804ms step_avg:740.99ms
step:1448/1750 train_loss:3.3870 train_time:1065567ms step_avg:741.01ms
step:1449/1750 train_loss:3.2575 train_time:1066346ms step_avg:741.03ms
step:1450/1750 train_loss:3.3523 train_time:1067112ms step_avg:741.05ms
step:1451/1750 train_loss:3.3500 train_time:1067880ms step_avg:741.07ms
step:1452/1750 train_loss:3.4477 train_time:1068632ms step_avg:741.08ms
step:1453/1750 train_loss:3.4464 train_time:1069392ms step_avg:741.09ms
step:1454/1750 train_loss:3.2618 train_time:1070166ms step_avg:741.11ms
step:1455/1750 train_loss:3.3788 train_time:1070933ms step_avg:741.13ms
step:1456/1750 train_loss:3.3102 train_time:1071713ms step_avg:741.16ms
step:1457/1750 train_loss:3.3361 train_time:1072477ms step_avg:741.17ms
step:1458/1750 train_loss:3.3807 train_time:1073266ms step_avg:741.21ms
step:1459/1750 train_loss:3.3315 train_time:1074026ms step_avg:741.22ms
step:1460/1750 train_loss:3.2117 train_time:1074792ms step_avg:741.24ms
step:1461/1750 train_loss:3.4755 train_time:1075563ms step_avg:741.26ms
step:1462/1750 train_loss:3.3194 train_time:1076319ms step_avg:741.27ms
step:1463/1750 train_loss:3.3702 train_time:1077099ms step_avg:741.29ms
step:1464/1750 train_loss:3.4818 train_time:1077848ms step_avg:741.30ms
step:1465/1750 train_loss:3.3147 train_time:1078619ms step_avg:741.32ms
step:1466/1750 train_loss:3.5187 train_time:1079388ms step_avg:741.34ms
step:1467/1750 train_loss:3.4082 train_time:1080143ms step_avg:741.35ms
step:1468/1750 train_loss:3.4031 train_time:1080901ms step_avg:741.36ms
step:1469/1750 train_loss:3.3389 train_time:1081687ms step_avg:741.39ms
step:1470/1750 train_loss:3.4416 train_time:1082447ms step_avg:741.40ms
step:1471/1750 train_loss:3.3322 train_time:1083217ms step_avg:741.42ms
step:1472/1750 train_loss:3.3214 train_time:1083992ms step_avg:741.44ms
step:1473/1750 train_loss:3.3829 train_time:1084796ms step_avg:741.49ms
step:1474/1750 train_loss:3.3059 train_time:1085567ms step_avg:741.51ms
step:1475/1750 train_loss:3.2756 train_time:1086355ms step_avg:741.54ms
step:1476/1750 train_loss:3.4846 train_time:1087109ms step_avg:741.55ms
step:1477/1750 train_loss:3.3595 train_time:1087872ms step_avg:741.56ms
step:1478/1750 train_loss:3.1939 train_time:1088637ms step_avg:741.58ms
step:1479/1750 train_loss:3.3137 train_time:1089420ms step_avg:741.61ms
step:1480/1750 train_loss:3.2975 train_time:1090217ms step_avg:741.64ms
step:1481/1750 train_loss:3.3599 train_time:1091006ms step_avg:741.68ms
step:1482/1750 train_loss:3.4375 train_time:1091772ms step_avg:741.69ms
step:1483/1750 train_loss:3.3267 train_time:1092523ms step_avg:741.70ms
step:1484/1750 train_loss:3.5023 train_time:1093287ms step_avg:741.71ms
step:1485/1750 train_loss:3.4170 train_time:1094045ms step_avg:741.73ms
step:1486/1750 train_loss:3.3258 train_time:1094847ms step_avg:741.77ms
step:1487/1750 train_loss:3.3102 train_time:1095615ms step_avg:741.78ms
step:1488/1750 train_loss:3.3268 train_time:1096384ms step_avg:741.80ms
step:1489/1750 train_loss:3.2648 train_time:1097172ms step_avg:741.83ms
step:1490/1750 train_loss:3.3848 train_time:1097960ms step_avg:741.86ms
step:1491/1750 train_loss:3.2777 train_time:1098743ms step_avg:741.89ms
step:1492/1750 train_loss:3.3711 train_time:1099502ms step_avg:741.90ms
step:1493/1750 train_loss:3.2987 train_time:1100285ms step_avg:741.93ms
step:1494/1750 train_loss:3.2142 train_time:1101032ms step_avg:741.94ms
step:1495/1750 train_loss:3.3138 train_time:1101803ms step_avg:741.95ms
step:1496/1750 train_loss:3.4839 train_time:1102565ms step_avg:741.97ms
step:1497/1750 train_loss:3.3452 train_time:1103341ms step_avg:741.99ms
step:1498/1750 train_loss:3.0847 train_time:1104114ms step_avg:742.01ms
step:1499/1750 train_loss:3.4082 train_time:1104882ms step_avg:742.03ms
step:1500/1750 train_loss:3.3601 train_time:1105650ms step_avg:742.05ms
step:1500/1750 val_loss:3.3255 train_time:1105664ms step_avg:742.06ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.17773 | frobenius_norm = 68370.03906 | spectral_norm = 12342.67383 | nuclear_norm = 1723189.62500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 189.13211 | spectral_norm = 37.23074 | nuclear_norm = 4325.64355
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 185.09036 | spectral_norm = 40.41205 | nuclear_norm = 4226.66113
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 355.03894 | spectral_norm = 24.52167 | nuclear_norm = 8728.52734
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 244.56914 | spectral_norm = 28.13264 | nuclear_norm = 5607.55762
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 420.16638 | spectral_norm = 35.75861 | nuclear_norm = 11164.52734
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 211.92644 | spectral_norm = 20.48100 | nuclear_norm = 5622.09375
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 193.86494 | spectral_norm = 18.74300 | nuclear_norm = 4468.63867
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 191.69472 | spectral_norm = 19.53173 | nuclear_norm = 4416.01025
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 344.61893 | spectral_norm = 29.71101 | nuclear_norm = 7917.11914
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 336.49072 | spectral_norm = 26.65711 | nuclear_norm = 7909.23193
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 413.62720 | spectral_norm = 30.79078 | nuclear_norm = 11046.52734
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 201.61926 | spectral_norm = 21.04320 | nuclear_norm = 5288.87305
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 189.46317 | spectral_norm = 22.21063 | nuclear_norm = 4318.87109
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 187.79718 | spectral_norm = 20.88670 | nuclear_norm = 4314.49951
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 346.94458 | spectral_norm = 30.63621 | nuclear_norm = 7937.80859
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 352.27924 | spectral_norm = 27.62372 | nuclear_norm = 8191.11816
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 417.47189 | spectral_norm = 36.37981 | nuclear_norm = 11086.52148
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 210.83173 | spectral_norm = 22.72526 | nuclear_norm = 5542.14160
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 183.80296 | spectral_norm = 18.25751 | nuclear_norm = 4045.18213
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 183.21788 | spectral_norm = 17.72150 | nuclear_norm = 4049.05542
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 371.21323 | spectral_norm = 34.30864 | nuclear_norm = 8390.85547
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 380.06754 | spectral_norm = 31.11112 | nuclear_norm = 8926.80273
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 420.35129 | spectral_norm = 40.14104 | nuclear_norm = 11161.24219
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 207.64134 | spectral_norm = 21.34413 | nuclear_norm = 5448.09229
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 182.88861 | spectral_norm = 19.65166 | nuclear_norm = 4076.29053
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 180.02446 | spectral_norm = 18.64880 | nuclear_norm = 4048.04565
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 374.02567 | spectral_norm = 32.51831 | nuclear_norm = 8545.42773
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 371.58051 | spectral_norm = 29.98986 | nuclear_norm = 8664.22266
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 429.85620 | spectral_norm = 37.15350 | nuclear_norm = 11420.78125
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 209.56154 | spectral_norm = 19.86852 | nuclear_norm = 5531.93555
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 192.32240 | spectral_norm = 18.81414 | nuclear_norm = 4393.36768
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 187.77888 | spectral_norm = 18.74455 | nuclear_norm = 4328.15137
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 379.37576 | spectral_norm = 34.55016 | nuclear_norm = 8609.69238
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 339.18829 | spectral_norm = 23.82557 | nuclear_norm = 8099.62549
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 450.60062 | spectral_norm = 31.73102 | nuclear_norm = 12007.14258
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 221.15804 | spectral_norm = 20.17204 | nuclear_norm = 5844.55762
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 181.87039 | spectral_norm = 20.04234 | nuclear_norm = 4050.75781
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 180.86871 | spectral_norm = 18.68718 | nuclear_norm = 4072.18506
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 387.16827 | spectral_norm = 33.34314 | nuclear_norm = 8874.82617
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 382.09308 | spectral_norm = 28.83183 | nuclear_norm = 8990.70996
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 418.92749 | spectral_norm = 32.14496 | nuclear_norm = 11187.89551
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 209.57338 | spectral_norm = 20.55629 | nuclear_norm = 5517.77441
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 186.93639 | spectral_norm = 20.61336 | nuclear_norm = 4233.24121
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 183.23459 | spectral_norm = 18.86089 | nuclear_norm = 4195.00879
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 372.97821 | spectral_norm = 30.48462 | nuclear_norm = 8498.27930
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 365.53058 | spectral_norm = 32.42674 | nuclear_norm = 8315.42578
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 428.04483 | spectral_norm = 33.62585 | nuclear_norm = 11386.00586
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 213.74336 | spectral_norm = 22.36101 | nuclear_norm = 5628.42480
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 188.55019 | spectral_norm = 20.38678 | nuclear_norm = 4220.11475
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 187.33833 | spectral_norm = 18.59499 | nuclear_norm = 4208.60449
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 392.06848 | spectral_norm = 35.88255 | nuclear_norm = 8819.63086
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 372.36890 | spectral_norm = 29.58870 | nuclear_norm = 8638.35645
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 432.08524 | spectral_norm = 36.39792 | nuclear_norm = 11475.10156
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 213.57309 | spectral_norm = 22.95159 | nuclear_norm = 5634.85938
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 187.15211 | spectral_norm = 21.35997 | nuclear_norm = 4058.22046
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 190.58139 | spectral_norm = 20.21734 | nuclear_norm = 4042.14233
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 409.50513 | spectral_norm = 38.58463 | nuclear_norm = 9365.87891
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 398.93716 | spectral_norm = 26.82902 | nuclear_norm = 9504.74023
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 412.84540 | spectral_norm = 36.14885 | nuclear_norm = 10960.88867
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 214.26215 | spectral_norm = 23.23686 | nuclear_norm = 5677.35156
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 188.90747 | spectral_norm = 22.49993 | nuclear_norm = 4133.25293
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 187.52937 | spectral_norm = 20.75061 | nuclear_norm = 4055.11987
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 382.45285 | spectral_norm = 38.10536 | nuclear_norm = 8697.75586
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 382.02106 | spectral_norm = 27.84303 | nuclear_norm = 8930.38184
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 428.07004 | spectral_norm = 33.59631 | nuclear_norm = 11392.92383
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 204.02785 | spectral_norm = 25.72259 | nuclear_norm = 5388.16309
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 196.58182 | spectral_norm = 25.56250 | nuclear_norm = 4360.59375
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 187.73186 | spectral_norm = 23.89236 | nuclear_norm = 4150.22803
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 379.17569 | spectral_norm = 38.81265 | nuclear_norm = 8649.28125
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 401.59454 | spectral_norm = 29.64851 | nuclear_norm = 9398.96484
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 444.85065 | spectral_norm = 34.62564 | nuclear_norm = 11814.68750
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 224.83498 | spectral_norm = 28.11462 | nuclear_norm = 5896.55664
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1329.07837 | spectral_norm = 166.33247 | nuclear_norm = 35158.35547
===========================================
step:1501/1750 train_loss:3.3887 train_time:1106395ms step_avg:742.05ms
step:1502/1750 train_loss:3.3638 train_time:1107200ms step_avg:742.09ms
step:1503/1750 train_loss:3.3319 train_time:1107976ms step_avg:742.11ms
step:1504/1750 train_loss:3.1214 train_time:1108792ms step_avg:742.16ms
step:1505/1750 train_loss:3.4051 train_time:1109572ms step_avg:742.19ms
step:1506/1750 train_loss:3.2958 train_time:1110378ms step_avg:742.23ms
step:1507/1750 train_loss:3.2963 train_time:1111161ms step_avg:742.26ms
step:1508/1750 train_loss:3.2562 train_time:1111920ms step_avg:742.27ms
step:1509/1750 train_loss:3.3306 train_time:1112673ms step_avg:742.28ms
step:1510/1750 train_loss:3.2141 train_time:1113441ms step_avg:742.29ms
step:1511/1750 train_loss:3.5247 train_time:1114208ms step_avg:742.31ms
step:1512/1750 train_loss:3.3215 train_time:1114955ms step_avg:742.31ms
step:1513/1750 train_loss:3.3174 train_time:1115723ms step_avg:742.33ms
step:1514/1750 train_loss:3.4579 train_time:1116460ms step_avg:742.33ms
step:1515/1750 train_loss:3.4629 train_time:1117247ms step_avg:742.36ms
step:1516/1750 train_loss:3.3107 train_time:1118016ms step_avg:742.37ms
step:1517/1750 train_loss:3.1302 train_time:1118809ms step_avg:742.41ms
step:1518/1750 train_loss:3.2859 train_time:1119559ms step_avg:742.41ms
step:1519/1750 train_loss:3.2917 train_time:1120358ms step_avg:742.45ms
step:1520/1750 train_loss:3.3505 train_time:1121314ms step_avg:742.59ms
step:1521/1750 train_loss:3.2506 train_time:1122073ms step_avg:742.60ms
step:1522/1750 train_loss:3.5427 train_time:1122839ms step_avg:742.62ms
step:1523/1750 train_loss:3.1678 train_time:1123603ms step_avg:742.63ms
step:1524/1750 train_loss:3.2807 train_time:1124597ms step_avg:742.80ms
step:1525/1750 train_loss:3.3445 train_time:1125374ms step_avg:742.82ms
step:1526/1750 train_loss:3.3275 train_time:1126152ms step_avg:742.84ms
step:1527/1750 train_loss:3.3878 train_time:1126921ms step_avg:742.86ms
step:1528/1750 train_loss:3.2886 train_time:1127685ms step_avg:742.88ms
step:1529/1750 train_loss:3.2551 train_time:1128441ms step_avg:742.88ms
step:1530/1750 train_loss:3.3074 train_time:1129200ms step_avg:742.89ms
step:1531/1750 train_loss:3.3282 train_time:1129965ms step_avg:742.91ms
step:1532/1750 train_loss:3.3256 train_time:1130734ms step_avg:742.93ms
step:1533/1750 train_loss:3.2858 train_time:1131578ms step_avg:742.99ms
step:1534/1750 train_loss:3.4478 train_time:1132344ms step_avg:743.01ms
step:1535/1750 train_loss:3.2245 train_time:1133119ms step_avg:743.03ms
step:1536/1750 train_loss:3.3801 train_time:1133876ms step_avg:743.04ms
step:1537/1750 train_loss:3.2905 train_time:1134651ms step_avg:743.06ms
step:1538/1750 train_loss:3.1709 train_time:1135435ms step_avg:743.09ms
step:1539/1750 train_loss:3.1313 train_time:1136219ms step_avg:743.11ms
step:1540/1750 train_loss:3.2331 train_time:1136971ms step_avg:743.12ms
step:1541/1750 train_loss:3.2497 train_time:1137757ms step_avg:743.15ms
step:1542/1750 train_loss:3.1553 train_time:1138528ms step_avg:743.16ms
step:1543/1750 train_loss:3.4355 train_time:1139295ms step_avg:743.18ms
step:1544/1750 train_loss:3.2568 train_time:1140056ms step_avg:743.19ms
step:1545/1750 train_loss:3.1374 train_time:1140890ms step_avg:743.25ms
step:1546/1750 train_loss:3.3235 train_time:1141666ms step_avg:743.27ms
step:1547/1750 train_loss:3.3315 train_time:1142439ms step_avg:743.29ms
step:1548/1750 train_loss:3.1089 train_time:1143201ms step_avg:743.30ms
step:1549/1750 train_loss:3.4702 train_time:1143963ms step_avg:743.32ms
step:1550/1750 train_loss:3.4399 train_time:1144753ms step_avg:743.35ms
step:1551/1750 train_loss:3.2846 train_time:1145554ms step_avg:743.38ms
step:1552/1750 train_loss:3.4557 train_time:1146325ms step_avg:743.40ms
step:1553/1750 train_loss:3.3547 train_time:1147089ms step_avg:743.41ms
step:1554/1750 train_loss:3.2882 train_time:1147872ms step_avg:743.44ms
step:1555/1750 train_loss:3.4399 train_time:1148642ms step_avg:743.46ms
step:1556/1750 train_loss:3.4052 train_time:1149399ms step_avg:743.47ms
step:1557/1750 train_loss:3.2814 train_time:1150157ms step_avg:743.48ms
step:1558/1750 train_loss:3.2321 train_time:1150923ms step_avg:743.49ms
step:1559/1750 train_loss:3.2356 train_time:1151685ms step_avg:743.50ms
step:1560/1750 train_loss:3.2788 train_time:1152458ms step_avg:743.52ms
step:1561/1750 train_loss:3.3071 train_time:1153225ms step_avg:743.54ms
step:1562/1750 train_loss:3.3101 train_time:1154012ms step_avg:743.56ms
step:1563/1750 train_loss:3.3622 train_time:1154791ms step_avg:743.59ms
step:1564/1750 train_loss:3.2706 train_time:1155541ms step_avg:743.59ms
step:1565/1750 train_loss:3.3804 train_time:1156312ms step_avg:743.61ms
step:1566/1750 train_loss:3.2518 train_time:1157086ms step_avg:743.63ms
step:1567/1750 train_loss:3.4047 train_time:1157852ms step_avg:743.64ms
step:1568/1750 train_loss:3.2128 train_time:1158626ms step_avg:743.66ms
step:1569/1750 train_loss:3.2391 train_time:1159394ms step_avg:743.68ms
step:1570/1750 train_loss:3.1651 train_time:1160151ms step_avg:743.69ms
step:1571/1750 train_loss:3.1660 train_time:1160935ms step_avg:743.71ms
step:1572/1750 train_loss:3.2186 train_time:1161703ms step_avg:743.73ms
step:1573/1750 train_loss:3.2909 train_time:1162466ms step_avg:743.74ms
step:1574/1750 train_loss:3.0717 train_time:1163238ms step_avg:743.76ms
step:1575/1750 train_loss:3.2891 train_time:1164003ms step_avg:743.77ms
step:1576/1750 train_loss:3.3029 train_time:1164822ms step_avg:743.82ms
step:1577/1750 train_loss:3.2772 train_time:1165593ms step_avg:743.84ms
step:1578/1750 train_loss:3.3092 train_time:1166392ms step_avg:743.87ms
step:1579/1750 train_loss:3.3005 train_time:1167162ms step_avg:743.89ms
step:1580/1750 train_loss:3.2522 train_time:1167921ms step_avg:743.90ms
step:1581/1750 train_loss:3.4710 train_time:1168690ms step_avg:743.91ms
step:1582/1750 train_loss:3.3413 train_time:1169464ms step_avg:743.93ms
step:1583/1750 train_loss:3.3918 train_time:1170220ms step_avg:743.94ms
step:1584/1750 train_loss:3.1265 train_time:1171018ms step_avg:743.98ms
step:1585/1750 train_loss:3.2717 train_time:1171812ms step_avg:744.01ms
step:1586/1750 train_loss:3.2040 train_time:1172570ms step_avg:744.02ms
step:1587/1750 train_loss:3.3633 train_time:1173326ms step_avg:744.02ms
step:1588/1750 train_loss:3.2726 train_time:1174089ms step_avg:744.04ms
step:1589/1750 train_loss:3.2351 train_time:1174846ms step_avg:744.04ms
step:1590/1750 train_loss:3.2300 train_time:1175642ms step_avg:744.08ms
step:1591/1750 train_loss:3.2724 train_time:1176396ms step_avg:744.08ms
step:1592/1750 train_loss:3.0942 train_time:1177176ms step_avg:744.11ms
step:1593/1750 train_loss:3.2270 train_time:1177935ms step_avg:744.12ms
step:1594/1750 train_loss:3.5629 train_time:1178712ms step_avg:744.14ms
step:1595/1750 train_loss:3.2035 train_time:1179479ms step_avg:744.15ms
step:1596/1750 train_loss:3.1549 train_time:1180290ms step_avg:744.19ms
step:1597/1750 train_loss:3.3366 train_time:1181044ms step_avg:744.20ms
step:1598/1750 train_loss:3.2602 train_time:1181855ms step_avg:744.24ms
step:1599/1750 train_loss:3.1188 train_time:1182634ms step_avg:744.26ms
step:1600/1750 train_loss:3.2710 train_time:1183420ms step_avg:744.29ms
step:1601/1750 train_loss:3.2682 train_time:1184173ms step_avg:744.29ms
step:1602/1750 train_loss:3.3357 train_time:1184944ms step_avg:744.31ms
step:1603/1750 train_loss:3.2370 train_time:1185697ms step_avg:744.32ms
step:1604/1750 train_loss:3.1478 train_time:1186498ms step_avg:744.35ms
step:1605/1750 train_loss:3.3105 train_time:1187278ms step_avg:744.38ms
step:1606/1750 train_loss:3.0992 train_time:1188082ms step_avg:744.41ms
step:1607/1750 train_loss:3.3140 train_time:1188852ms step_avg:744.43ms
step:1608/1750 train_loss:3.1833 train_time:1189635ms step_avg:744.45ms
step:1609/1750 train_loss:3.2697 train_time:1190395ms step_avg:744.46ms
step:1610/1750 train_loss:3.2947 train_time:1191206ms step_avg:744.50ms
step:1611/1750 train_loss:3.1502 train_time:1191967ms step_avg:744.51ms
step:1612/1750 train_loss:3.2857 train_time:1192795ms step_avg:744.57ms
step:1613/1750 train_loss:3.2810 train_time:1193558ms step_avg:744.58ms
step:1614/1750 train_loss:3.1043 train_time:1194416ms step_avg:744.65ms
step:1615/1750 train_loss:3.3638 train_time:1195229ms step_avg:744.69ms
step:1616/1750 train_loss:3.3274 train_time:1196003ms step_avg:744.71ms
step:1617/1750 train_loss:3.2954 train_time:1196768ms step_avg:744.72ms
step:1618/1750 train_loss:3.1988 train_time:1197554ms step_avg:744.75ms
step:1619/1750 train_loss:3.4011 train_time:1198321ms step_avg:744.76ms
step:1620/1750 train_loss:3.3522 train_time:1199073ms step_avg:744.77ms
step:1621/1750 train_loss:3.2722 train_time:1199839ms step_avg:744.78ms
step:1622/1750 train_loss:3.5219 train_time:1200601ms step_avg:744.79ms
step:1623/1750 train_loss:3.2252 train_time:1201375ms step_avg:744.81ms
step:1624/1750 train_loss:3.5174 train_time:1202192ms step_avg:744.85ms
step:1625/1750 train_loss:3.2644 train_time:1202951ms step_avg:744.86ms
step:1625/1750 val_loss:3.2911 train_time:1202965ms step_avg:744.87ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.68124 | frobenius_norm = 68489.49219 | spectral_norm = 12370.95410 | nuclear_norm = 1726883.25000
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 189.88451 | spectral_norm = 37.84368 | nuclear_norm = 4338.79199
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 186.03752 | spectral_norm = 40.87268 | nuclear_norm = 4246.22217
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 357.06931 | spectral_norm = 24.62379 | nuclear_norm = 8786.47070
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 244.41199 | spectral_norm = 28.20613 | nuclear_norm = 5598.27344
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 423.07584 | spectral_norm = 36.14574 | nuclear_norm = 11242.17773
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 213.33211 | spectral_norm = 20.67507 | nuclear_norm = 5660.67822
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 195.11482 | spectral_norm = 18.96837 | nuclear_norm = 4496.88184
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 192.93736 | spectral_norm = 19.72383 | nuclear_norm = 4443.70605
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 346.87640 | spectral_norm = 29.92146 | nuclear_norm = 7970.59961
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 338.47635 | spectral_norm = 26.81939 | nuclear_norm = 7958.49902
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 416.20898 | spectral_norm = 31.01097 | nuclear_norm = 11117.73047
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 202.90326 | spectral_norm = 21.21820 | nuclear_norm = 5323.39160
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 190.68280 | spectral_norm = 22.47081 | nuclear_norm = 4344.55762
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 188.96288 | spectral_norm = 21.12672 | nuclear_norm = 4340.54297
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 349.65714 | spectral_norm = 30.83275 | nuclear_norm = 8003.89453
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 354.89685 | spectral_norm = 27.83377 | nuclear_norm = 8256.72852
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 420.09836 | spectral_norm = 36.70251 | nuclear_norm = 11155.45801
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 212.09604 | spectral_norm = 22.89223 | nuclear_norm = 5574.76270
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 184.77730 | spectral_norm = 18.45705 | nuclear_norm = 4060.91846
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 184.24049 | spectral_norm = 17.89639 | nuclear_norm = 4065.90283
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 374.26813 | spectral_norm = 34.55679 | nuclear_norm = 8465.03125
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 382.94220 | spectral_norm = 31.30926 | nuclear_norm = 8997.84570
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 422.80328 | spectral_norm = 40.45441 | nuclear_norm = 11224.32617
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 208.88472 | spectral_norm = 21.50544 | nuclear_norm = 5480.37939
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 183.95799 | spectral_norm = 19.81699 | nuclear_norm = 4095.14722
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 181.00316 | spectral_norm = 18.83410 | nuclear_norm = 4066.38940
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 377.32388 | spectral_norm = 32.76704 | nuclear_norm = 8626.64453
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 374.63217 | spectral_norm = 30.21386 | nuclear_norm = 8740.43555
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 432.17264 | spectral_norm = 37.49554 | nuclear_norm = 11481.40723
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 210.81949 | spectral_norm = 19.99567 | nuclear_norm = 5565.98975
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 193.48137 | spectral_norm = 19.00709 | nuclear_norm = 4416.68848
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 188.91171 | spectral_norm = 18.88012 | nuclear_norm = 4352.82324
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 383.06531 | spectral_norm = 34.84997 | nuclear_norm = 8695.94922
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 341.28275 | spectral_norm = 23.97077 | nuclear_norm = 8153.96484
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 453.56039 | spectral_norm = 31.93759 | nuclear_norm = 12086.90137
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 222.69650 | spectral_norm = 20.36446 | nuclear_norm = 5886.91357
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 182.87207 | spectral_norm = 20.22356 | nuclear_norm = 4066.75195
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 181.91949 | spectral_norm = 18.81891 | nuclear_norm = 4092.34814
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 390.16296 | spectral_norm = 33.65966 | nuclear_norm = 8948.95703
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 385.09143 | spectral_norm = 28.96562 | nuclear_norm = 9063.75000
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 421.41098 | spectral_norm = 32.40670 | nuclear_norm = 11254.95508
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 210.82501 | spectral_norm = 20.73745 | nuclear_norm = 5550.94727
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 188.02425 | spectral_norm = 20.84550 | nuclear_norm = 4253.07520
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 184.24416 | spectral_norm = 18.98357 | nuclear_norm = 4216.00391
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 376.26334 | spectral_norm = 30.74245 | nuclear_norm = 8581.17383
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 368.54410 | spectral_norm = 32.66575 | nuclear_norm = 8385.12012
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 430.63962 | spectral_norm = 33.90993 | nuclear_norm = 11454.07812
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 214.97525 | spectral_norm = 22.57024 | nuclear_norm = 5660.34863
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 189.61060 | spectral_norm = 20.58742 | nuclear_norm = 4238.00439
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 188.39301 | spectral_norm = 18.77792 | nuclear_norm = 4227.20752
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 395.18332 | spectral_norm = 36.11272 | nuclear_norm = 8894.39844
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 374.79871 | spectral_norm = 29.73569 | nuclear_norm = 8692.97461
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 434.93695 | spectral_norm = 36.73122 | nuclear_norm = 11548.09961
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 214.82372 | spectral_norm = 23.19589 | nuclear_norm = 5666.65430
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 188.25500 | spectral_norm = 21.51468 | nuclear_norm = 4073.39917
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 191.71138 | spectral_norm = 20.40416 | nuclear_norm = 4053.98340
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 413.09634 | spectral_norm = 39.11161 | nuclear_norm = 9445.52734
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 401.63882 | spectral_norm = 27.01283 | nuclear_norm = 9567.50195
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 415.15869 | spectral_norm = 36.50301 | nuclear_norm = 11019.17773
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 215.49466 | spectral_norm = 23.39810 | nuclear_norm = 5709.78271
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 189.83023 | spectral_norm = 22.80980 | nuclear_norm = 4143.41797
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 188.44865 | spectral_norm = 20.94794 | nuclear_norm = 4062.48096
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 386.29523 | spectral_norm = 38.66194 | nuclear_norm = 8785.48730
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 384.61026 | spectral_norm = 28.11053 | nuclear_norm = 8987.63867
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 429.99017 | spectral_norm = 33.84338 | nuclear_norm = 11442.10352
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 205.34918 | spectral_norm = 25.85374 | nuclear_norm = 5423.41602
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 197.63918 | spectral_norm = 25.87783 | nuclear_norm = 4373.81348
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 188.62437 | spectral_norm = 24.21811 | nuclear_norm = 4160.40918
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 383.59909 | spectral_norm = 39.42240 | nuclear_norm = 8749.92969
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 404.86462 | spectral_norm = 29.99214 | nuclear_norm = 9474.19531
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 446.64548 | spectral_norm = 34.73017 | nuclear_norm = 11860.61230
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 226.04968 | spectral_norm = 28.30627 | nuclear_norm = 5927.01562
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1327.86902 | spectral_norm = 163.38269 | nuclear_norm = 35167.71094
===========================================
step:1626/1750 train_loss:3.3438 train_time:1203692ms step_avg:744.86ms
step:1627/1750 train_loss:3.3613 train_time:1204455ms step_avg:744.87ms
step:1628/1750 train_loss:3.3918 train_time:1205214ms step_avg:744.88ms
step:1629/1750 train_loss:3.2412 train_time:1205984ms step_avg:744.89ms
step:1630/1750 train_loss:3.3023 train_time:1206756ms step_avg:744.91ms
step:1631/1750 train_loss:3.2714 train_time:1207524ms step_avg:744.93ms
step:1632/1750 train_loss:3.1576 train_time:1208291ms step_avg:744.94ms
step:1633/1750 train_loss:3.2789 train_time:1209053ms step_avg:744.95ms
step:1634/1750 train_loss:3.2884 train_time:1209816ms step_avg:744.96ms
step:1635/1750 train_loss:3.2747 train_time:1210596ms step_avg:744.98ms
step:1636/1750 train_loss:3.3584 train_time:1211357ms step_avg:744.99ms
step:1637/1750 train_loss:3.6270 train_time:1212140ms step_avg:745.02ms
step:1638/1750 train_loss:3.2535 train_time:1212978ms step_avg:745.07ms
step:1639/1750 train_loss:3.2185 train_time:1213751ms step_avg:745.09ms
step:1640/1750 train_loss:3.2469 train_time:1214521ms step_avg:745.11ms
step:1641/1750 train_loss:3.3543 train_time:1215266ms step_avg:745.10ms
step:1642/1750 train_loss:3.3120 train_time:1216026ms step_avg:745.11ms
step:1643/1750 train_loss:3.2902 train_time:1216812ms step_avg:745.14ms
step:1644/1750 train_loss:3.2049 train_time:1217566ms step_avg:745.14ms
step:1645/1750 train_loss:3.1964 train_time:1218338ms step_avg:745.16ms
step:1646/1750 train_loss:3.2856 train_time:1219111ms step_avg:745.18ms
step:1647/1750 train_loss:3.1576 train_time:1219911ms step_avg:745.21ms
step:1648/1750 train_loss:3.3165 train_time:1220671ms step_avg:745.22ms
step:1649/1750 train_loss:3.3466 train_time:1221423ms step_avg:745.22ms
step:1650/1750 train_loss:3.2442 train_time:1222192ms step_avg:745.24ms
step:1651/1750 train_loss:3.3182 train_time:1222957ms step_avg:745.25ms
step:1652/1750 train_loss:3.2917 train_time:1223734ms step_avg:745.27ms
step:1653/1750 train_loss:3.2255 train_time:1224485ms step_avg:745.27ms
step:1654/1750 train_loss:3.3486 train_time:1225256ms step_avg:745.29ms
step:1655/1750 train_loss:3.1976 train_time:1226017ms step_avg:745.30ms
step:1656/1750 train_loss:2.9718 train_time:1226809ms step_avg:745.33ms
step:1657/1750 train_loss:3.2999 train_time:1227570ms step_avg:745.34ms
step:1658/1750 train_loss:3.3282 train_time:1228330ms step_avg:745.35ms
step:1659/1750 train_loss:3.2707 train_time:1229096ms step_avg:745.36ms
step:1660/1750 train_loss:3.5216 train_time:1229897ms step_avg:745.39ms
step:1661/1750 train_loss:3.3579 train_time:1230664ms step_avg:745.41ms
step:1662/1750 train_loss:3.3332 train_time:1231425ms step_avg:745.41ms
step:1663/1750 train_loss:3.3081 train_time:1232207ms step_avg:745.44ms
step:1664/1750 train_loss:3.3368 train_time:1232962ms step_avg:745.44ms
step:1665/1750 train_loss:3.1531 train_time:1233730ms step_avg:745.46ms
step:1666/1750 train_loss:3.3117 train_time:1234491ms step_avg:745.47ms
step:1667/1750 train_loss:3.1007 train_time:1235263ms step_avg:745.48ms
step:1668/1750 train_loss:3.2716 train_time:1236028ms step_avg:745.49ms
step:1669/1750 train_loss:3.3016 train_time:1236789ms step_avg:745.50ms
step:1670/1750 train_loss:3.1156 train_time:1237554ms step_avg:745.51ms
step:1671/1750 train_loss:3.2757 train_time:1238394ms step_avg:745.57ms
step:1672/1750 train_loss:3.1667 train_time:1239177ms step_avg:745.59ms
step:1673/1750 train_loss:3.4517 train_time:1239944ms step_avg:745.61ms
step:1674/1750 train_loss:3.3199 train_time:1240708ms step_avg:745.62ms
step:1675/1750 train_loss:3.2826 train_time:1241462ms step_avg:745.62ms
step:1676/1750 train_loss:3.1612 train_time:1242243ms step_avg:745.64ms
step:1677/1750 train_loss:3.2289 train_time:1243032ms step_avg:745.67ms
step:1678/1750 train_loss:3.5665 train_time:1243799ms step_avg:745.68ms
step:1679/1750 train_loss:3.2850 train_time:1244568ms step_avg:745.70ms
step:1680/1750 train_loss:3.2733 train_time:1245344ms step_avg:745.71ms
step:1681/1750 train_loss:3.4016 train_time:1246114ms step_avg:745.73ms
step:1682/1750 train_loss:3.3236 train_time:1246887ms step_avg:745.75ms
step:1683/1750 train_loss:3.2377 train_time:1247690ms step_avg:745.78ms
step:1684/1750 train_loss:3.3352 train_time:1248459ms step_avg:745.79ms
step:1685/1750 train_loss:3.1670 train_time:1249227ms step_avg:745.81ms
step:1686/1750 train_loss:3.3243 train_time:1249996ms step_avg:745.82ms
step:1687/1750 train_loss:3.2237 train_time:1250802ms step_avg:745.86ms
step:1688/1750 train_loss:3.0366 train_time:1251573ms step_avg:745.87ms
step:1689/1750 train_loss:3.3478 train_time:1252361ms step_avg:745.90ms
step:1690/1750 train_loss:3.3179 train_time:1253125ms step_avg:745.91ms
step:1691/1750 train_loss:3.3114 train_time:1253895ms step_avg:745.92ms
step:1692/1750 train_loss:3.2131 train_time:1254718ms step_avg:745.97ms
step:1693/1750 train_loss:3.2094 train_time:1255489ms step_avg:745.98ms
step:1694/1750 train_loss:3.3048 train_time:1256252ms step_avg:745.99ms
step:1695/1750 train_loss:3.2297 train_time:1257017ms step_avg:746.00ms
step:1696/1750 train_loss:3.3199 train_time:1257793ms step_avg:746.02ms
step:1697/1750 train_loss:3.2624 train_time:1258575ms step_avg:746.04ms
step:1698/1750 train_loss:3.3740 train_time:1259336ms step_avg:746.05ms
step:1699/1750 train_loss:3.1982 train_time:1260123ms step_avg:746.08ms
step:1700/1750 train_loss:3.2595 train_time:1260895ms step_avg:746.09ms
step:1701/1750 train_loss:3.1839 train_time:1261653ms step_avg:746.10ms
step:1702/1750 train_loss:3.1986 train_time:1262421ms step_avg:746.11ms
step:1703/1750 train_loss:3.2873 train_time:1263176ms step_avg:746.12ms
step:1704/1750 train_loss:3.3019 train_time:1263933ms step_avg:746.12ms
step:1705/1750 train_loss:3.2745 train_time:1264688ms step_avg:746.13ms
step:1706/1750 train_loss:3.3107 train_time:1265460ms step_avg:746.14ms
step:1707/1750 train_loss:3.2627 train_time:1266240ms step_avg:746.16ms
step:1708/1750 train_loss:3.4196 train_time:1267004ms step_avg:746.17ms
step:1709/1750 train_loss:3.1261 train_time:1267769ms step_avg:746.19ms
step:1710/1750 train_loss:3.2293 train_time:1268724ms step_avg:746.31ms
step:1711/1750 train_loss:3.2245 train_time:1269515ms step_avg:746.33ms
step:1712/1750 train_loss:3.2302 train_time:1270273ms step_avg:746.34ms
step:1713/1750 train_loss:3.7017 train_time:1271067ms step_avg:746.37ms
step:1714/1750 train_loss:3.2761 train_time:1271860ms step_avg:746.40ms
step:1715/1750 train_loss:3.2847 train_time:1272625ms step_avg:746.41ms
step:1716/1750 train_loss:3.3152 train_time:1273389ms step_avg:746.42ms
step:1717/1750 train_loss:3.3318 train_time:1274151ms step_avg:746.43ms
step:1718/1750 train_loss:3.2195 train_time:1274924ms step_avg:746.44ms
step:1719/1750 train_loss:3.2789 train_time:1275717ms step_avg:746.47ms
step:1720/1750 train_loss:3.0900 train_time:1276478ms step_avg:746.48ms
step:1721/1750 train_loss:3.2388 train_time:1277232ms step_avg:746.48ms
step:1722/1750 train_loss:3.2559 train_time:1277987ms step_avg:746.49ms
step:1723/1750 train_loss:3.2138 train_time:1278739ms step_avg:746.49ms
step:1724/1750 train_loss:3.3750 train_time:1279512ms step_avg:746.51ms
step:1725/1750 train_loss:3.1581 train_time:1280327ms step_avg:746.55ms
step:1726/1750 train_loss:3.3104 train_time:1281118ms step_avg:746.57ms
step:1727/1750 train_loss:3.4006 train_time:1281880ms step_avg:746.58ms
step:1728/1750 train_loss:3.2543 train_time:1282650ms step_avg:746.59ms
step:1729/1750 train_loss:3.4832 train_time:1283436ms step_avg:746.62ms
step:1730/1750 train_loss:3.2526 train_time:1284210ms step_avg:746.63ms
step:1731/1750 train_loss:3.3234 train_time:1284960ms step_avg:746.64ms
step:1732/1750 train_loss:3.2917 train_time:1285727ms step_avg:746.65ms
step:1733/1750 train_loss:3.2642 train_time:1286499ms step_avg:746.66ms
step:1734/1750 train_loss:3.6458 train_time:1287290ms step_avg:746.69ms
step:1735/1750 train_loss:3.2937 train_time:1288063ms step_avg:746.70ms
step:1736/1750 train_loss:3.4260 train_time:1288834ms step_avg:746.72ms
step:1737/1750 train_loss:3.2001 train_time:1289618ms step_avg:746.74ms
step:1738/1750 train_loss:3.2434 train_time:1290382ms step_avg:746.75ms
step:1739/1750 train_loss:3.2704 train_time:1291137ms step_avg:746.75ms
step:1740/1750 train_loss:3.2526 train_time:1291908ms step_avg:746.77ms
step:1741/1750 train_loss:3.3779 train_time:1292672ms step_avg:746.78ms
step:1742/1750 train_loss:3.2125 train_time:1293450ms step_avg:746.80ms
step:1743/1750 train_loss:3.2837 train_time:1294240ms step_avg:746.82ms
step:1744/1750 train_loss:3.3609 train_time:1294992ms step_avg:746.82ms
step:1745/1750 train_loss:3.1561 train_time:1295760ms step_avg:746.84ms
step:1746/1750 train_loss:3.0561 train_time:1296518ms step_avg:746.84ms
step:1747/1750 train_loss:2.9445 train_time:1297333ms step_avg:746.88ms
step:1748/1750 train_loss:3.2857 train_time:1298102ms step_avg:746.89ms
step:1749/1750 train_loss:3.3071 train_time:1298854ms step_avg:746.90ms
step:1750/1750 train_loss:3.2668 train_time:1299608ms step_avg:746.90ms
step:1750/1750 val_loss:3.2701 train_time:1299621ms step_avg:746.91ms
============== Weight norms: ==============
name = 'module._orig_mod.transformer.wte.weight' | l1_to_l2_norm = 296.70767 | frobenius_norm = 68495.81250 | spectral_norm = 12374.40918 | nuclear_norm = 1727178.12500
name = 'module._orig_mod.transformer.h.0.attn.c_q.weight' | frobenius_norm = 189.94032 | spectral_norm = 38.03850 | nuclear_norm = 4338.51318
name = 'module._orig_mod.transformer.h.0.attn.c_k.weight' | frobenius_norm = 186.13452 | spectral_norm = 41.01477 | nuclear_norm = 4247.08301
name = 'module._orig_mod.transformer.h.0.attn.c_v.weight' | frobenius_norm = 357.52502 | spectral_norm = 24.60829 | nuclear_norm = 8800.65723
name = 'module._orig_mod.transformer.h.0.attn.c_proj.weight' | frobenius_norm = 244.19608 | spectral_norm = 28.23341 | nuclear_norm = 5590.86523
name = 'module._orig_mod.transformer.h.0.mlp.c_fc.weight' | frobenius_norm = 423.69418 | spectral_norm = 36.25090 | nuclear_norm = 11258.79785
name = 'module._orig_mod.transformer.h.0.mlp.c_proj.weight' | frobenius_norm = 213.62311 | spectral_norm = 20.72400 | nuclear_norm = 5668.86816
name = 'module._orig_mod.transformer.h.1.attn.c_q.weight' | frobenius_norm = 195.35895 | spectral_norm = 19.02668 | nuclear_norm = 4501.96924
name = 'module._orig_mod.transformer.h.1.attn.c_k.weight' | frobenius_norm = 193.18031 | spectral_norm = 19.79710 | nuclear_norm = 4448.89014
name = 'module._orig_mod.transformer.h.1.attn.c_v.weight' | frobenius_norm = 347.38773 | spectral_norm = 29.94635 | nuclear_norm = 7983.07861
name = 'module._orig_mod.transformer.h.1.attn.c_proj.weight' | frobenius_norm = 338.90192 | spectral_norm = 26.83777 | nuclear_norm = 7969.59961
name = 'module._orig_mod.transformer.h.1.mlp.c_fc.weight' | frobenius_norm = 416.75455 | spectral_norm = 31.04914 | nuclear_norm = 11133.09961
name = 'module._orig_mod.transformer.h.1.mlp.c_proj.weight' | frobenius_norm = 203.15854 | spectral_norm = 21.25607 | nuclear_norm = 5330.35840
name = 'module._orig_mod.transformer.h.2.attn.c_q.weight' | frobenius_norm = 190.94394 | spectral_norm = 22.53706 | nuclear_norm = 4349.79639
name = 'module._orig_mod.transformer.h.2.attn.c_k.weight' | frobenius_norm = 189.21344 | spectral_norm = 21.18354 | nuclear_norm = 4346.04639
name = 'module._orig_mod.transformer.h.2.attn.c_v.weight' | frobenius_norm = 350.30115 | spectral_norm = 30.92650 | nuclear_norm = 8020.31201
name = 'module._orig_mod.transformer.h.2.attn.c_proj.weight' | frobenius_norm = 355.51663 | spectral_norm = 27.87775 | nuclear_norm = 8272.71484
name = 'module._orig_mod.transformer.h.2.mlp.c_fc.weight' | frobenius_norm = 420.67819 | spectral_norm = 36.76288 | nuclear_norm = 11170.51953
name = 'module._orig_mod.transformer.h.2.mlp.c_proj.weight' | frobenius_norm = 212.32751 | spectral_norm = 22.93722 | nuclear_norm = 5580.60059
name = 'module._orig_mod.transformer.h.3.attn.c_q.weight' | frobenius_norm = 184.96002 | spectral_norm = 18.51451 | nuclear_norm = 4062.91431
name = 'module._orig_mod.transformer.h.3.attn.c_k.weight' | frobenius_norm = 184.43150 | spectral_norm = 17.93586 | nuclear_norm = 4068.02051
name = 'module._orig_mod.transformer.h.3.attn.c_v.weight' | frobenius_norm = 374.97806 | spectral_norm = 34.60765 | nuclear_norm = 8482.95605
name = 'module._orig_mod.transformer.h.3.attn.c_proj.weight' | frobenius_norm = 383.60175 | spectral_norm = 31.35694 | nuclear_norm = 9015.51562
name = 'module._orig_mod.transformer.h.3.mlp.c_fc.weight' | frobenius_norm = 423.26956 | spectral_norm = 40.52020 | nuclear_norm = 11236.12402
name = 'module._orig_mod.transformer.h.3.mlp.c_proj.weight' | frobenius_norm = 209.10597 | spectral_norm = 21.54463 | nuclear_norm = 5486.10449
name = 'module._orig_mod.transformer.h.4.attn.c_q.weight' | frobenius_norm = 184.16811 | spectral_norm = 19.83566 | nuclear_norm = 4097.93506
name = 'module._orig_mod.transformer.h.4.attn.c_k.weight' | frobenius_norm = 181.17285 | spectral_norm = 18.89470 | nuclear_norm = 4068.54663
name = 'module._orig_mod.transformer.h.4.attn.c_v.weight' | frobenius_norm = 378.12625 | spectral_norm = 32.83509 | nuclear_norm = 8647.24414
name = 'module._orig_mod.transformer.h.4.attn.c_proj.weight' | frobenius_norm = 375.37033 | spectral_norm = 30.29088 | nuclear_norm = 8759.17188
name = 'module._orig_mod.transformer.h.4.mlp.c_fc.weight' | frobenius_norm = 432.59155 | spectral_norm = 37.57103 | nuclear_norm = 11492.13281
name = 'module._orig_mod.transformer.h.4.mlp.c_proj.weight' | frobenius_norm = 211.04384 | spectral_norm = 20.00222 | nuclear_norm = 5572.22852
name = 'module._orig_mod.transformer.h.5.attn.c_q.weight' | frobenius_norm = 193.69383 | spectral_norm = 19.03485 | nuclear_norm = 4420.41211
name = 'module._orig_mod.transformer.h.5.attn.c_k.weight' | frobenius_norm = 189.14540 | spectral_norm = 18.88995 | nuclear_norm = 4357.82031
name = 'module._orig_mod.transformer.h.5.attn.c_v.weight' | frobenius_norm = 384.14099 | spectral_norm = 34.97288 | nuclear_norm = 8720.64844
name = 'module._orig_mod.transformer.h.5.attn.c_proj.weight' | frobenius_norm = 341.77679 | spectral_norm = 24.00401 | nuclear_norm = 8167.47998
name = 'module._orig_mod.transformer.h.5.mlp.c_fc.weight' | frobenius_norm = 454.17130 | spectral_norm = 31.97581 | nuclear_norm = 12103.66797
name = 'module._orig_mod.transformer.h.5.mlp.c_proj.weight' | frobenius_norm = 223.01120 | spectral_norm = 20.40341 | nuclear_norm = 5895.91406
name = 'module._orig_mod.transformer.h.6.attn.c_q.weight' | frobenius_norm = 183.05730 | spectral_norm = 20.28316 | nuclear_norm = 4068.51318
name = 'module._orig_mod.transformer.h.6.attn.c_k.weight' | frobenius_norm = 182.10347 | spectral_norm = 18.83734 | nuclear_norm = 4095.05176
name = 'module._orig_mod.transformer.h.6.attn.c_v.weight' | frobenius_norm = 390.90912 | spectral_norm = 33.73152 | nuclear_norm = 8967.89453
name = 'module._orig_mod.transformer.h.6.attn.c_proj.weight' | frobenius_norm = 385.85751 | spectral_norm = 28.97146 | nuclear_norm = 9082.63086
name = 'module._orig_mod.transformer.h.6.mlp.c_fc.weight' | frobenius_norm = 421.89566 | spectral_norm = 32.44395 | nuclear_norm = 11268.24023
name = 'module._orig_mod.transformer.h.6.mlp.c_proj.weight' | frobenius_norm = 211.04152 | spectral_norm = 20.78230 | nuclear_norm = 5556.73291
name = 'module._orig_mod.transformer.h.7.attn.c_q.weight' | frobenius_norm = 188.22156 | spectral_norm = 20.87975 | nuclear_norm = 4255.83936
name = 'module._orig_mod.transformer.h.7.attn.c_k.weight' | frobenius_norm = 184.40990 | spectral_norm = 19.00417 | nuclear_norm = 4219.14355
name = 'module._orig_mod.transformer.h.7.attn.c_v.weight' | frobenius_norm = 377.12393 | spectral_norm = 30.81035 | nuclear_norm = 8603.55176
name = 'module._orig_mod.transformer.h.7.attn.c_proj.weight' | frobenius_norm = 369.33661 | spectral_norm = 32.74945 | nuclear_norm = 8403.63477
name = 'module._orig_mod.transformer.h.7.mlp.c_fc.weight' | frobenius_norm = 431.15353 | spectral_norm = 33.97346 | nuclear_norm = 11467.22656
name = 'module._orig_mod.transformer.h.7.mlp.c_proj.weight' | frobenius_norm = 215.18501 | spectral_norm = 22.61334 | nuclear_norm = 5665.48242
name = 'module._orig_mod.transformer.h.8.attn.c_q.weight' | frobenius_norm = 189.81691 | spectral_norm = 20.63662 | nuclear_norm = 4240.05273
name = 'module._orig_mod.transformer.h.8.attn.c_k.weight' | frobenius_norm = 188.58487 | spectral_norm = 18.80575 | nuclear_norm = 4229.60693
name = 'module._orig_mod.transformer.h.8.attn.c_v.weight' | frobenius_norm = 395.96637 | spectral_norm = 36.16909 | nuclear_norm = 8913.16895
name = 'module._orig_mod.transformer.h.8.attn.c_proj.weight' | frobenius_norm = 375.39371 | spectral_norm = 29.78275 | nuclear_norm = 8705.94043
name = 'module._orig_mod.transformer.h.8.mlp.c_fc.weight' | frobenius_norm = 435.53458 | spectral_norm = 36.81401 | nuclear_norm = 11563.00000
name = 'module._orig_mod.transformer.h.8.mlp.c_proj.weight' | frobenius_norm = 215.03185 | spectral_norm = 23.24663 | nuclear_norm = 5671.70264
name = 'module._orig_mod.transformer.h.9.attn.c_q.weight' | frobenius_norm = 188.45345 | spectral_norm = 21.55730 | nuclear_norm = 4073.83008
name = 'module._orig_mod.transformer.h.9.attn.c_k.weight' | frobenius_norm = 191.92946 | spectral_norm = 20.47694 | nuclear_norm = 4053.86230
name = 'module._orig_mod.transformer.h.9.attn.c_v.weight' | frobenius_norm = 414.01862 | spectral_norm = 39.27546 | nuclear_norm = 9465.12695
name = 'module._orig_mod.transformer.h.9.attn.c_proj.weight' | frobenius_norm = 402.28693 | spectral_norm = 27.05373 | nuclear_norm = 9582.73242
name = 'module._orig_mod.transformer.h.9.mlp.c_fc.weight' | frobenius_norm = 415.53625 | spectral_norm = 36.57787 | nuclear_norm = 11028.03125
name = 'module._orig_mod.transformer.h.9.mlp.c_proj.weight' | frobenius_norm = 215.69438 | spectral_norm = 23.42018 | nuclear_norm = 5714.90723
name = 'module._orig_mod.transformer.h.10.attn.c_q.weight' | frobenius_norm = 189.95757 | spectral_norm = 22.87767 | nuclear_norm = 4141.59131
name = 'module._orig_mod.transformer.h.10.attn.c_k.weight' | frobenius_norm = 188.57957 | spectral_norm = 20.99351 | nuclear_norm = 4060.05981
name = 'module._orig_mod.transformer.h.10.attn.c_v.weight' | frobenius_norm = 387.26251 | spectral_norm = 38.81544 | nuclear_norm = 8807.28320
name = 'module._orig_mod.transformer.h.10.attn.c_proj.weight' | frobenius_norm = 385.23541 | spectral_norm = 28.20149 | nuclear_norm = 9001.02051
name = 'module._orig_mod.transformer.h.10.mlp.c_fc.weight' | frobenius_norm = 430.28180 | spectral_norm = 33.89034 | nuclear_norm = 11449.09863
name = 'module._orig_mod.transformer.h.10.mlp.c_proj.weight' | frobenius_norm = 205.59201 | spectral_norm = 25.87194 | nuclear_norm = 5429.75879
name = 'module._orig_mod.transformer.h.11.attn.c_q.weight' | frobenius_norm = 197.81258 | spectral_norm = 25.97969 | nuclear_norm = 4373.89746
name = 'module._orig_mod.transformer.h.11.attn.c_k.weight' | frobenius_norm = 188.75211 | spectral_norm = 24.31807 | nuclear_norm = 4159.45166
name = 'module._orig_mod.transformer.h.11.attn.c_v.weight' | frobenius_norm = 384.80893 | spectral_norm = 39.61366 | nuclear_norm = 8777.00000
name = 'module._orig_mod.transformer.h.11.attn.c_proj.weight' | frobenius_norm = 405.70071 | spectral_norm = 30.06478 | nuclear_norm = 9492.92578
name = 'module._orig_mod.transformer.h.11.mlp.c_fc.weight' | frobenius_norm = 446.84280 | spectral_norm = 34.75187 | nuclear_norm = 11865.28516
name = 'module._orig_mod.transformer.h.11.mlp.c_proj.weight' | frobenius_norm = 226.27390 | spectral_norm = 28.32527 | nuclear_norm = 5932.45020
name = 'module._orig_mod.lm_head.weight' | frobenius_norm = 1325.47717 | spectral_norm = 161.79756 | nuclear_norm = 35121.62500
===========================================
